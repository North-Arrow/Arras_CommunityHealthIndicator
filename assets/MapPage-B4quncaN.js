const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/request-D2uOsRWz.js","assets/index-BmYviIWw.js","assets/index-DydP-41E.css","assets/themeLevelStore-DZpgk8s7.js","assets/IdentityManager-BV7fJ-wC.js","assets/uuid-Cl_eusAm.js","assets/sanitizerUtils-DvKU1K2H.js","assets/QueueProcessor-CbnWEMZ1.js","assets/Queue-CZDCTrNx.js","assets/ReactiveMap-B4AU_I0M.js","assets/signal-Bwm2bj8I.js","assets/WhereClauseCache-BUlCZXcv.js","assets/LRUCache-D8cKMB2I.js","assets/WhereClause-C05Gbb1x.js","assets/TimeOnly-CHJM2LNG.js","assets/enum-BXmZ1Cih.js","assets/UnknownTimeZone-CBEcU3eF.js","assets/arcadeUtils-CXTTrxqJ.js","assets/aiServices-mlv-OxXJ.js","assets/Field-DtvnrFlE.js","assets/fieldType-DdV0pDVR.js","assets/number-CpQeVy41.js","assets/featureConversionUtils-DhuVzDkk.js","assets/OptimizedFeature-C4KIcQOE.js","assets/memoryEstimations-BrM_eZNu.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/FieldsIndex-CvkGjpK2.js","assets/timeZoneUtils-cueV68Kf.js","assets/streamLayerUtils-DFlbJ4P1.js","assets/unitConversion-B8tlrMw6.js","assets/isImageryGraphicOrigin-Ccuhb4eK.js","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/rasterFieldUtils-DvkS13au.js","assets/batchExec-HQK5TTZx.js","assets/PortalItem-B87a-lvs.js","assets/Basemap-2vIX0kFe.js","assets/loadAll-BkaJx_gI.js","assets/asyncUtils-o4QLGifX.js","assets/isBasemap-Cp_8tW2x.js","assets/writeUtils-DHA6_K1M.js","assets/ElevationLayer-9sI3qKWa.js","assets/MultiOriginJSONSupport-CeLx0Dni.js","assets/HeightModelInfo-BA25ksJM.js","assets/ArcGISCachedService-ClT6CpUz.js","assets/TileInfo-oi1YCVDQ.js","assets/TileInfoTilemapCache-Q2Vv4Krg.js","assets/TilemapCache-_w3gpdGG.js","assets/ArcGISService-DIGocNV2.js","assets/OperationalLayer-CK07lLUZ.js","assets/PortalLayer-BNzzTX0J.js","assets/portalItemUtils-BT2FG3J0.js","assets/projectionUtils-D4Tq2AKr.js","assets/workers-ij2eZR7n.js","assets/webStyleSymbolUtils-D_mE3Vw-.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/jsonUtils-DgoLov03.js","assets/defaults-CBMJTHMz.js","assets/defaultsJSON-GKolV7NZ.js","assets/styleUtils-CkgLfJjO.js","assets/portalLayers-D3ZnkbtC.js","assets/associatedFeatureServiceUtils-DD4hspcT.js","assets/fetchService-CZ-RRHo6.js","assets/loadUtils-mkWlFvyO.js","assets/lazyLayerLoader-DMt8KkZc.js","assets/arcgisLayers-BaE4bUqN.js"])))=>i.map(i=>d[i]);
var A9=Object.getPrototypeOf;var D9=Reflect.get;var jk=t=>{throw TypeError(t)};var lS=(t,e,i)=>e.has(t)||jk("Cannot "+i);var Mi=(t,e,i)=>(lS(t,e,"read from private field"),i?i.call(t):e.get(t)),ra=(t,e,i)=>e.has(t)?jk("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),na=(t,e,i,r)=>(lS(t,e,"write to private field"),r?r.call(t,i):e.set(t,i),i),qg=(t,e,i)=>(lS(t,e,"access private method"),i);var Uk=(t,e,i)=>D9(A9(t),i,e);import{b as Md,s as j1,c as xn,f as Lr,k as Hi,o as vi,h as Ct,v as cn,g as Vi,t as Ki,j as Vo,F as z9,l as O9,n as U1,w as va,m as kd,x as R9,y as L9,z as F9,d as N9,r as Ps,i as Go,e as Iu,A as cs,q as GI,p as FT,B as cS,C as Uz,D as hl,E as qI,G as HI,H as B9,_ as Kn}from"./index-BmYviIWw.js";import{u as Ef}from"./themeLevelStore-DZpgk8s7.js";function Vz(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rb={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.1/LICENSE.txt
 */var j9=rb.exports,Vk;function U9(){return Vk||(Vk=1,(function(t,e){(function(i,r){t.exports=r()})(j9,(function(){var i={},r={};function o(d,a,_){if(r[d]=_,d==="index"){var T="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",E={};return r.shared(E),r.index(i,E),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([T],{type:"text/javascript"}))),i}}o("shared",["exports"],(function(d){function a(c,s,l,p){return new(l||(l=Promise))((function(m,x){function w(A){try{I(p.next(A))}catch(D){x(D)}}function C(A){try{I(p.throw(A))}catch(D){x(D)}}function I(A){var D;A.done?m(A.value):(D=A.value,D instanceof l?D:new l((function(N){N(D)}))).then(w,C)}I((p=p.apply(c,s||[])).next())}))}function _(c,s){this.x=c,this.y=s}function T(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var E,k;typeof SuppressedError=="function"&&SuppressedError,_.prototype={clone(){return new _(this.x,this.y)},add(c){return this.clone()._add(c)},sub(c){return this.clone()._sub(c)},multByPoint(c){return this.clone()._multByPoint(c)},divByPoint(c){return this.clone()._divByPoint(c)},mult(c){return this.clone()._mult(c)},div(c){return this.clone()._div(c)},rotate(c){return this.clone()._rotate(c)},rotateAround(c,s){return this.clone()._rotateAround(c,s)},matMult(c){return this.clone()._matMult(c)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(c){return this.x===c.x&&this.y===c.y},dist(c){return Math.sqrt(this.distSqr(c))},distSqr(c){const s=c.x-this.x,l=c.y-this.y;return s*s+l*l},angle(){return Math.atan2(this.y,this.x)},angleTo(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith(c){return this.angleWithSep(c.x,c.y)},angleWithSep(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult(c){const s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add(c){return this.x+=c.x,this.y+=c.y,this},_sub(c){return this.x-=c.x,this.y-=c.y,this},_mult(c){return this.x*=c,this.y*=c,this},_div(c){return this.x/=c,this.y/=c,this},_multByPoint(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint(c){return this.x/=c.x,this.y/=c.y,this},_unit(){return this._div(this.mag()),this},_perp(){const c=this.y;return this.y=this.x,this.x=-c,this},_rotate(c){const s=Math.cos(c),l=Math.sin(c),p=l*this.x+s*this.y;return this.x=s*this.x-l*this.y,this.y=p,this},_rotateAround(c,s){const l=Math.cos(c),p=Math.sin(c),m=s.y+p*(this.x-s.x)+l*(this.y-s.y);return this.x=s.x+l*(this.x-s.x)-p*(this.y-s.y),this.y=m,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:_},_.convert=function(c){if(c instanceof _)return c;if(Array.isArray(c))return new _(+c[0],+c[1]);if(c.x!==void 0&&c.y!==void 0)return new _(+c.x,+c.y);throw new Error("Expected [x, y] or {x, y} point format")};var L=(function(){if(k)return E;function c(s,l,p,m){this.cx=3*s,this.bx=3*(p-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=l,this.p2x=p,this.p2y=m}return k=1,E=c,c.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,l){if(l===void 0&&(l=1e-6),s<0)return 0;if(s>1)return 1;for(var p=s,m=0;m<8;m++){var x=this.sampleCurveX(p)-s;if(Math.abs(x)<l)return p;var w=this.sampleCurveDerivativeX(p);if(Math.abs(w)<1e-6)break;p-=x/w}var C=0,I=1;for(p=s,m=0;m<20&&(x=this.sampleCurveX(p),!(Math.abs(x-s)<l));m++)s>x?C=p:I=p,p=.5*(I-C)+C;return p},solve:function(s,l){return this.sampleCurveY(this.solveCurveX(s,l))}},E})(),O=T(L);let H,re;function pe(){return H==null&&(H=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),H}function ge(){if(re==null&&(re=!1,pe())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let p=0;p<25;p++){const m=4*p;s.fillStyle=`rgb(${m},${m+1},${m+2})`,s.fillRect(p%5,Math.floor(p/5),1,1)}const l=s.getImageData(0,0,5,5).data;for(let p=0;p<100;p++)if(p%4!=3&&l[p]!==p){re=!0;break}}}return re||!1}var Se=1e-6,Pe=typeof Float32Array<"u"?Float32Array:Array;function Re(){var c=new Pe(9);return Pe!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function ze(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Je(){var c=new Pe(3);return Pe!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function Xe(c){var s=c[0],l=c[1],p=c[2];return Math.sqrt(s*s+l*l+p*p)}function yt(c,s,l){var p=new Pe(3);return p[0]=c,p[1]=s,p[2]=l,p}function mt(c,s,l){return c[0]=s[0]+l[0],c[1]=s[1]+l[1],c[2]=s[2]+l[2],c}function je(c,s,l){return c[0]=s[0]*l,c[1]=s[1]*l,c[2]=s[2]*l,c}function ke(c,s,l){var p=s[0],m=s[1],x=s[2],w=l[0],C=l[1],I=l[2];return c[0]=m*I-x*C,c[1]=x*w-p*I,c[2]=p*C-m*w,c}var We,Ce=Xe;function Ee(c,s,l){var p=s[0],m=s[1],x=s[2],w=s[3];return c[0]=l[0]*p+l[4]*m+l[8]*x+l[12]*w,c[1]=l[1]*p+l[5]*m+l[9]*x+l[13]*w,c[2]=l[2]*p+l[6]*m+l[10]*x+l[14]*w,c[3]=l[3]*p+l[7]*m+l[11]*x+l[15]*w,c}function st(){var c=new Pe(4);return Pe!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function _t(c,s,l,p){var m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",x=Math.PI/360;s*=x,p*=x,l*=x;var w=Math.sin(s),C=Math.cos(s),I=Math.sin(l),A=Math.cos(l),D=Math.sin(p),N=Math.cos(p);switch(m){case"xyz":c[0]=w*A*N+C*I*D,c[1]=C*I*N-w*A*D,c[2]=C*A*D+w*I*N,c[3]=C*A*N-w*I*D;break;case"xzy":c[0]=w*A*N-C*I*D,c[1]=C*I*N-w*A*D,c[2]=C*A*D+w*I*N,c[3]=C*A*N+w*I*D;break;case"yxz":c[0]=w*A*N+C*I*D,c[1]=C*I*N-w*A*D,c[2]=C*A*D-w*I*N,c[3]=C*A*N+w*I*D;break;case"yzx":c[0]=w*A*N+C*I*D,c[1]=C*I*N+w*A*D,c[2]=C*A*D-w*I*N,c[3]=C*A*N-w*I*D;break;case"zxy":c[0]=w*A*N-C*I*D,c[1]=C*I*N+w*A*D,c[2]=C*A*D+w*I*N,c[3]=C*A*N-w*I*D;break;case"zyx":c[0]=w*A*N-C*I*D,c[1]=C*I*N+w*A*D,c[2]=C*A*D-w*I*N,c[3]=C*A*N+w*I*D;break;default:throw new Error("Unknown angle order "+m)}return c}function ht(){var c=new Pe(2);return Pe!=Float32Array&&(c[0]=0,c[1]=0),c}function nt(c,s){var l=new Pe(2);return l[0]=c,l[1]=s,l}Je(),We=new Pe(4),Pe!=Float32Array&&(We[0]=0,We[1]=0,We[2]=0,We[3]=0),Je(),yt(1,0,0),yt(0,1,0),st(),st(),Re(),ht();const rt=8192;function Wt(c,s,l){return s*(rt/(c.tileSize*Math.pow(2,l-c.tileID.overscaledZ)))}function ei(c,s){return(c%s+s)%s}function en(c,s,l){return c*(1-l)+s*l}function hn(c){if(c<=0)return 0;if(c>=1)return 1;const s=c*c,l=s*c;return 4*(c<.5?l:3*(c-s)+l-.75)}function tn(c,s,l,p){const m=new O(c,s,l,p);return x=>m.solve(x)}const Qn=tn(.25,.1,.25,1);function rn(c,s,l){return Math.min(l,Math.max(s,c))}function _o(c,s,l){const p=l-s,m=((c-s)%p+p)%p+s;return m===s?l:m}function dn(c,...s){for(const l of s)for(const p in l)c[p]=l[p];return c}let Os=1;function wc(c,s,l){const p={};for(const m in c)p[m]=s.call(this,c[m],m,c);return p}function Sc(c,s,l){const p={};for(const m in c)s.call(this,c[m],m,c)&&(p[m]=c[m]);return p}function es(c){return Array.isArray(c)?c.map(es):typeof c=="object"&&c?wc(c,es):c}const Qi={};function lr(c){Qi[c]||(typeof console<"u"&&console.warn(c),Qi[c]=!0)}function Rs(c,s,l){return(l.y-c.y)*(s.x-c.x)>(s.y-c.y)*(l.x-c.x)}function vo(c){return typeof WorkerGlobalScope<"u"&&c!==void 0&&c instanceof WorkerGlobalScope}let Sl=null;function bo(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const xo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Tc(c,s,l,p,m){return a(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(c,{timestamp:0});try{const w=x?.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const C=w.startsWith("BGR"),I=new Uint8ClampedArray(p*m*4);if(yield x.copyTo(I,(function(A,D,N,U,G){const q=4*Math.max(-D,0),X=(Math.max(0,N)-N)*U*4+q,Q=4*U,ne=Math.max(0,D),ye=Math.max(0,N);return{rect:{x:ne,y:ye,width:Math.min(A.width,D+U)-ne,height:Math.min(A.height,N+G)-ye},layout:[{offset:X,stride:Q}]}})(c,s,l,p,m)),C)for(let A=0;A<I.length;A+=4){const D=I[A];I[A]=I[A+2],I[A+2]=D}return I}finally{x.close()}}))}let ka,Aa;function Da(c,s,l,p){return c.addEventListener(s,l,p),{unsubscribe:()=>{c.removeEventListener(s,l,p)}}}function Tl(c){return c*Math.PI/180}function za(c){return c/Math.PI*180}const Oa={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Ra={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Cc="AbortError";function ve(){return new Error(Cc)}const Y={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function J(c){return Y.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))]}const K="global-dispatcher";class le extends Error{constructor(s,l,p,m){super(`AJAXError: ${l} (${s}): ${p}`),this.status=s,this.statusText=l,this.url=p,this.body=m}}const fe=()=>vo(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,be=function(c,s){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){const p=J(c.url);if(p)return p(c,s);if(vo(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,targetMapId:K},s)}if(!(/^file:/.test(l=c.url)||/^file:/.test(fe())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(p,m){return a(this,void 0,void 0,(function*(){const x=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:fe(),signal:m.signal});let w,C;p.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");try{w=yield fetch(x)}catch(A){throw new le(0,A.message,p.url,new Blob)}if(!w.ok){const A=yield w.blob();throw new le(w.status,w.statusText,p.url,A)}C=p.type==="arrayBuffer"||p.type==="image"?w.arrayBuffer():p.type==="json"?w.json():w.text();const I=yield C;if(m.signal.aborted)throw ve();return{data:I,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}}))})(c,s);if(vo(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,mustQueue:!0,targetMapId:K},s)}var l;return(function(p,m){return new Promise(((x,w)=>{var C;const I=new XMLHttpRequest;I.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(I.responseType="arraybuffer");for(const A in p.headers)I.setRequestHeader(A,p.headers[A]);p.type==="json"&&(I.responseType="text",!((C=p.headers)===null||C===void 0)&&C.Accept||I.setRequestHeader("Accept","application/json")),I.withCredentials=p.credentials==="include",I.onerror=()=>{w(new Error(I.statusText))},I.onload=()=>{if(!m.signal.aborted)if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){let A=I.response;if(p.type==="json")try{A=JSON.parse(I.response)}catch(D){return void w(D)}x({data:A,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const A=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});w(new le(I.status,I.statusText,p.url,A))}},m.signal.addEventListener("abort",(()=>{I.abort(),w(ve())})),I.send(p.body)}))})(c,s)};function Ae(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const s=new URL(c),l=window.location;return s.protocol===l.protocol&&s.host===l.host}function we(c,s,l){l[c]&&l[c].indexOf(s)!==-1||(l[c]=l[c]||[],l[c].push(s))}function Be(c,s,l){if(l&&l[c]){const p=l[c].indexOf(s);p!==-1&&l[c].splice(p,1)}}class Ye{constructor(s,l={}){dn(this,l),this.type=s}}class qe extends Ye{constructor(s,l={}){super("error",dn({error:s},l))}}class St{on(s,l){return this._listeners=this._listeners||{},we(s,l,this._listeners),{unsubscribe:()=>{this.off(s,l)}}}off(s,l){return Be(s,l,this._listeners),Be(s,l,this._oneTimeListeners),this}once(s,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},we(s,l,this._oneTimeListeners),this):new Promise((p=>this.once(s,p)))}fire(s,l){typeof s=="string"&&(s=new Ye(s,l||{}));const p=s.type;if(this.listens(p)){s.target=this;const m=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const C of m)C.call(this,s);const x=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const C of x)Be(p,C,this._oneTimeListeners),C.call(this,s);const w=this._eventedParent;w&&(dn(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(s))}else s instanceof qe&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,l){return this._eventedParent=s,this._eventedParentData=l,this}}var Te={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Dt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Xt(c,s){const l={};for(const p in c)p!=="ref"&&(l[p]=c[p]);return Dt.forEach((p=>{p in s&&(l[p]=s[p])})),l}function It(c,s){if(Array.isArray(c)){if(!Array.isArray(s)||c.length!==s.length)return!1;for(let l=0;l<c.length;l++)if(!It(c[l],s[l]))return!1;return!0}if(typeof c=="object"&&c!==null&&s!==null){if(typeof s!="object"||Object.keys(c).length!==Object.keys(s).length)return!1;for(const l in c)if(!It(c[l],s[l]))return!1;return!0}return c===s}function Nt(c,s){c.push(s)}function Di(c,s,l){Nt(l,{command:"addSource",args:[c,s[c]]})}function Ir(c,s,l){Nt(s,{command:"removeSource",args:[c]}),l[c]=!0}function $r(c,s,l,p){Ir(c,l,p),Di(c,s,l)}function cr(c,s,l){let p;for(p in c[l])if(Object.prototype.hasOwnProperty.call(c[l],p)&&p!=="data"&&!It(c[l][p],s[l][p]))return!1;for(p in s[l])if(Object.prototype.hasOwnProperty.call(s[l],p)&&p!=="data"&&!It(c[l][p],s[l][p]))return!1;return!0}function ti(c,s,l,p,m,x){c=c||{},s=s||{};for(const w in c)Object.prototype.hasOwnProperty.call(c,w)&&(It(c[w],s[w])||l.push({command:x,args:[p,w,s[w],m]}));for(const w in s)Object.prototype.hasOwnProperty.call(s,w)&&!Object.prototype.hasOwnProperty.call(c,w)&&(It(c[w],s[w])||l.push({command:x,args:[p,w,s[w],m]}))}function li(c){return c.id}function mr(c,s){return c[s.id]=s,c}class Qe{constructor(s,l,p,m){this.message=(s?`${s}: `:"")+p,m&&(this.identifier=m),l!=null&&l.__line__&&(this.line=l.__line__)}}function pn(c,...s){for(const l of s)for(const p in l)c[p]=l[p];return c}class Zi extends Error{constructor(s,l){super(l),this.message=l,this.key=s}}class La{constructor(s,l=[]){this.parent=s,this.bindings={};for(const[p,m]of l)this.bindings[p]=m}concat(s){return new La(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Ec={kind:"null"},pt={kind:"number"},Jt={kind:"string"},Ht={kind:"boolean"},nn={kind:"color"},Cl={kind:"projectionDefinition"},Fa={kind:"object"},Vt={kind:"value"},Od={kind:"collator"},Na={kind:"formatted"},Rd={kind:"padding"},wo={kind:"colorArray"},Ic={kind:"numberArray"},er={kind:"resolvedImage"},Ld={kind:"variableAnchorOffsetCollection"};function Fn(c,s){return{kind:"array",itemType:c,N:s}}function Ii(c){if(c.kind==="array"){const s=Ii(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const g_=[Ec,pt,Jt,Ht,nn,Cl,Na,Fa,Fn(Vt),Rd,Ic,wo,er,Ld];function Yu(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!Yu(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const l of g_)if(!Yu(l,s))return null}}return`Expected ${Ii(c)} but found ${Ii(s)} instead.`}function Om(c,s){return s.some((l=>l.kind===c.kind))}function Ba(c,s){return s.some((l=>l==="null"?c===null:l==="array"?Array.isArray(c):l==="object"?c&&!Array.isArray(c)&&typeof c=="object":l===typeof c))}function ja(c,s){return c.kind==="array"&&s.kind==="array"?c.itemType.kind===s.itemType.kind&&typeof c.N=="number":c.kind===s.kind}const Rm=.96422,y_=.82521,__=4/29,$c=6/29,v_=3*$c*$c,Ww=$c*$c*$c,Yw=Math.PI/180,Xw=180/Math.PI;function Lm(c){return(c%=360)<0&&(c+=360),c}function Pc([c,s,l,p]){let m,x;const w=Nm((.2225045*(c=Fm(c))+.7168786*(s=Fm(s))+.0606169*(l=Fm(l)))/1);c===s&&s===l?m=x=w:(m=Nm((.4360747*c+.3850649*s+.1430804*l)/Rm),x=Nm((.0139322*c+.0971045*s+.7141733*l)/y_));const C=116*w-16;return[C<0?0:C,500*(m-w),200*(w-x),p]}function Fm(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Nm(c){return c>Ww?Math.pow(c,1/3):c/v_+__}function Mc([c,s,l,p]){let m=(c+16)/116,x=isNaN(s)?m:m+s/500,w=isNaN(l)?m:m-l/200;return m=1*jm(m),x=Rm*jm(x),w=y_*jm(w),[Bm(3.1338561*x-1.6168667*m-.4906146*w),Bm(-.9787684*x+1.9161415*m+.033454*w),Bm(.0719453*x-.2289914*m+1.4052427*w),p]}function Bm(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function jm(c){return c>$c?c*c*c:v_*(c-__)}const Jw=Object.hasOwn||function(c,s){return Object.prototype.hasOwnProperty.call(c,s)};function kc(c,s){return Jw(c,s)?c[s]:void 0}function Xu(c){return parseInt(c.padEnd(2,c),16)/255}function Ls(c,s){return Kt(s?c/100:c,0,1)}function Kt(c,s,l){return Math.min(Math.max(s,c),l)}function El(c){return!c.some(Number.isNaN)}const Ua={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Zo(c,s,l){return c+l*(s-c)}function Il(c,s,l){return c.map(((p,m)=>Zo(p,s[m],l)))}class Qt{constructor(s,l,p,m=1,x=!0){this.r=s,this.g=l,this.b=p,this.a=m,x||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[s,l,p,m]))}static parse(s){if(s instanceof Qt)return s;if(typeof s!="string")return;const l=(function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=kc(Ua,p);if(m){const[w,C,I]=m;return[w/255,C/255,I/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const w=p.length<6?1:2;let C=1;return[Xu(p.slice(C,C+=w)),Xu(p.slice(C,C+=w)),Xu(p.slice(C,C+=w)),Xu(p.slice(C,C+w)||"ff")]}if(p.startsWith("rgb")){const w=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[C,I,A,D,N,U,G,q,X,Q,ne,ye]=w,ue=[D||" ",G||" ",Q].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const de=[A,U,X].join(""),Me=de==="%%%"?100:de===""?255:0;if(Me){const Le=[Kt(+I/Me,0,1),Kt(+N/Me,0,1),Kt(+q/Me,0,1),ne?Ls(+ne,ye):1];if(El(Le))return Le}}return}}const x=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,C,I,A,D,N,U,G,q]=x,X=[I||" ",D||" ",U].join("");if(X==="  "||X==="  /"||X===",,"||X===",,,"){const Q=[+C,Kt(+A,0,100),Kt(+N,0,100),G?Ls(+G,q):1];if(El(Q))return(function([ne,ye,ue,de]){function Me(Le){const Ze=(Le+ne/30)%12,ct=ye*Math.min(ue,1-ue);return ue-ct*Math.max(-1,Math.min(Ze-3,9-Ze,1))}return ne=Lm(ne),ye/=100,ue/=100,[Me(0),Me(8),Me(4),de]})(Q)}}})(s);return l?new Qt(...l,!1):void 0}get rgb(){const{r:s,g:l,b:p,a:m}=this,x=m||1/0;return this.overwriteGetter("rgb",[s/x,l/x,p/x,m])}get hcl(){return this.overwriteGetter("hcl",(function(s){const[l,p,m,x]=Pc(s),w=Math.sqrt(p*p+m*m);return[Math.round(1e4*w)?Lm(Math.atan2(m,p)*Xw):NaN,w,l,x]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Pc(this.rgb))}overwriteGetter(s,l){return Object.defineProperty(this,s,{value:l}),l}toString(){const[s,l,p,m]=this.rgb;return`rgba(${[s,l,p].map((x=>Math.round(255*x))).join(",")},${m})`}static interpolate(s,l,p,m="rgb"){switch(m){case"rgb":{const[x,w,C,I]=Il(s.rgb,l.rgb,p);return new Qt(x,w,C,I,!1)}case"hcl":{const[x,w,C,I]=s.hcl,[A,D,N,U]=l.hcl;let G,q;if(isNaN(x)||isNaN(A))isNaN(x)?isNaN(A)?G=NaN:(G=A,C!==1&&C!==0||(q=D)):(G=x,N!==1&&N!==0||(q=w));else{let ue=A-x;A>x&&ue>180?ue-=360:A<x&&x-A>180&&(ue+=360),G=x+p*ue}const[X,Q,ne,ye]=(function([ue,de,Me,Le]){return ue=isNaN(ue)?0:ue*Yw,Mc([Me,Math.cos(ue)*de,Math.sin(ue)*de,Le])})([G,q??Zo(w,D,p),Zo(C,N,p),Zo(I,U,p)]);return new Qt(X,Q,ne,ye,!1)}case"lab":{const[x,w,C,I]=Mc(Il(s.lab,l.lab,p));return new Qt(x,w,C,I,!1)}}}}Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);class $l{constructor(s,l,p){this.sensitivity=s?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,l){return this.collator.compare(s,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Fd=["bottom","center","top"];class Nd{constructor(s,l,p,m,x,w){this.text=s,this.image=l,this.scale=p,this.fontStack=m,this.textColor=x,this.verticalAlign=w}}class Sn{constructor(s){this.sections=s}static fromString(s){return new Sn([new Nd(s,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((s=>s.text.length!==0||s.image&&s.image.name.length!==0))}static factory(s){return s instanceof Sn?s:Sn.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map((s=>s.text)).join("")}}class jr{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof jr)return s;if(typeof s=="number")return new jr([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const l of s)if(typeof l!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new jr(s)}}toString(){return JSON.stringify(this.values)}static interpolate(s,l,p){return new jr(Il(s.values,l.values,p))}}class Tn{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof Tn)return s;if(typeof s=="number")return new Tn([s]);if(Array.isArray(s)){for(const l of s)if(typeof l!="number")return;return new Tn(s)}}toString(){return JSON.stringify(this.values)}static interpolate(s,l,p){return new Tn(Il(s.values,l.values,p))}}class gr{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof gr)return s;if(typeof s=="string"){const p=Qt.parse(s);return p?new gr([p]):void 0}if(!Array.isArray(s))return;const l=[];for(const p of s){if(typeof p!="string")return;const m=Qt.parse(p);if(!m)return;l.push(m)}return new gr(l)}toString(){return JSON.stringify(this.values)}static interpolate(s,l,p,m="rgb"){const x=[];if(s.values.length!=l.values.length)throw new Error(`colorArray: Arrays have mismatched length (${s.values.length} vs. ${l.values.length}), cannot interpolate.`);for(let w=0;w<s.values.length;w++)x.push(Qt.interpolate(s.values[w],l.values[w],p,m));return new gr(x)}}class $i extends Error{constructor(s){super(s),this.name="RuntimeError"}toJSON(){return this.message}}const b_=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Cn{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof Cn)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let l=0;l<s.length;l+=2){const p=s[l],m=s[l+1];if(typeof p!="string"||!b_.has(p)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new Cn(s)}}toString(){return JSON.stringify(this.values)}static interpolate(s,l,p){const m=s.values,x=l.values;if(m.length!==x.length)throw new $i(`Cannot interpolate values of different length. from: ${s.toString()}, to: ${l.toString()}`);const w=[];for(let C=0;C<m.length;C+=2){if(m[C]!==x[C])throw new $i(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${m[C]}, to[${C}]: ${x[C]}`);w.push(m[C]);const[I,A]=m[C+1],[D,N]=x[C+1];w.push([Zo(I,D,p),Zo(A,N,p)])}return new Cn(w)}}class ts{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new ts({name:s,available:!1}):null}}class fn{constructor(s,l,p){this.from=s,this.to=l,this.transition=p}static interpolate(s,l,p){return new fn(s,l,p)}static parse(s){return s instanceof fn?s:Array.isArray(s)&&s.length===3&&typeof s[0]=="string"&&typeof s[1]=="string"&&typeof s[2]=="number"?new fn(s[0],s[1],s[2]):typeof s=="object"&&typeof s.from=="string"&&typeof s.to=="string"&&typeof s.transition=="number"?new fn(s.from,s.to,s.transition):typeof s=="string"?new fn(s,s,1):void 0}}function Li(c,s,l,p){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof l=="number"&&l>=0&&l<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[c,s,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[c,s,l,p]:[c,s,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Pl(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof fn||c instanceof Qt||c instanceof $l||c instanceof Sn||c instanceof jr||c instanceof Tn||c instanceof gr||c instanceof Cn||c instanceof ts)return!0;if(Array.isArray(c)){for(const s of c)if(!Pl(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!Pl(c[s]))return!1;return!0}return!1}function Mt(c){if(c===null)return Ec;if(typeof c=="string")return Jt;if(typeof c=="boolean")return Ht;if(typeof c=="number")return pt;if(c instanceof Qt)return nn;if(c instanceof fn)return Cl;if(c instanceof $l)return Od;if(c instanceof Sn)return Na;if(c instanceof jr)return Rd;if(c instanceof Tn)return Ic;if(c instanceof gr)return wo;if(c instanceof Cn)return Ld;if(c instanceof ts)return er;if(Array.isArray(c)){const s=c.length;let l;for(const p of c){const m=Mt(p);if(l){if(l===m)continue;l=Vt;break}l=m}return Fn(l||Vt,s)}return Fa}function Ft(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof Qt||c instanceof fn||c instanceof Sn||c instanceof jr||c instanceof Tn||c instanceof gr||c instanceof Cn||c instanceof ts?c.toString():JSON.stringify(c)}class Wo{constructor(s,l){this.type=s,this.value=l}static parse(s,l){if(s.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Pl(s[1]))return l.error("invalid value");const p=s[1];let m=Mt(p);const x=l.expectedType;return m.kind!=="array"||m.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(m=x),new Wo(m,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ci={string:Jt,number:pt,boolean:Ht,object:Fa};class is{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");let p,m=1;const x=s[0];if(x==="array"){let C,I;if(s.length>2){const A=s[1];if(typeof A!="string"||!(A in ci)||A==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);C=ci[A],m++}else C=Vt;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return l.error('The length argument to "array" must be a positive integer literal',2);I=s[2],m++}p=Fn(C,I)}else{if(!ci[x])throw new Error(`Types doesn't contain name = ${x}`);p=ci[x]}const w=[];for(;m<s.length;m++){const C=l.parse(s[m],m,Vt);if(!C)return null;w.push(C)}return new is(p,w)}evaluate(s){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(s);if(!Yu(this.type,Mt(p)))return p;if(l===this.args.length-1)throw new $i(`Expected value to be of type ${Ii(this.type)}, but found ${Ii(Mt(p))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every((s=>s.outputDefined()))}}const So={"to-boolean":Ht,"to-color":nn,"to-number":pt,"to-string":Jt};class To{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const p=s[0];if(!So[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&s.length!==2)return l.error("Expected one argument.");const m=So[p],x=[];for(let w=1;w<s.length;w++){const C=l.parse(s[w],w,Vt);if(!C)return null;x.push(C)}return new To(m,x)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let l,p;for(const m of this.args){if(l=m.evaluate(s),p=null,l instanceof Qt)return l;if(typeof l=="string"){const x=s.parseColor(l);if(x)return x}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rgba value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Li(l[0],l[1],l[2],l[3]),!p))return new Qt(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new $i(p||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const p of this.args){l=p.evaluate(s);const m=jr.parse(l);if(m)return m}throw new $i(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"numberArray":{let l;for(const p of this.args){l=p.evaluate(s);const m=Tn.parse(l);if(m)return m}throw new $i(`Could not parse numberArray from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"colorArray":{let l;for(const p of this.args){l=p.evaluate(s);const m=gr.parse(l);if(m)return m}throw new $i(`Could not parse colorArray from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const p of this.args){l=p.evaluate(s);const m=Cn.parse(l);if(m)return m}throw new $i(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const p of this.args){if(l=p.evaluate(s),l===null)return 0;const m=Number(l);if(!isNaN(m))return m}throw new $i(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return Sn.fromString(Ft(this.args[0].evaluate(s)));case"resolvedImage":return ts.fromString(Ft(this.args[0].evaluate(s)));case"projectionDefinition":return this.args[0].evaluate(s);default:return Ft(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every((s=>s.outputDefined()))}}const Bd=["Unknown","Point","LineString","Polygon"];class Um{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Bd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let l=this._parseColorCache.get(s);return l||(l=Qt.parse(s),this._parseColorCache.set(s,l)),l}}class Ac{constructor(s,l,p=[],m,x=new La,w=[]){this.registry=s,this.path=p,this.key=p.map((C=>`[${C}]`)).join(""),this.scope=x,this.errors=w,this.expectedType=m,this._isConstant=l}parse(s,l,p,m,x={}){return l?this.concat(l,p,m)._parse(s,x):this._parse(s,x)}_parse(s,l){function p(m,x,w){return w==="assert"?new is(x,[m]):w==="coerce"?new To(x,[m]):m}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=s[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[m];if(x){let w=x.parse(s,this);if(!w)return null;if(this.expectedType){const C=this.expectedType,I=w.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||I.kind!=="value"){if(C.kind==="projectionDefinition"&&["string","array"].includes(I.kind)||["color","formatted","resolvedImage"].includes(C.kind)&&["value","string"].includes(I.kind)||["padding","numberArray"].includes(C.kind)&&["value","number","array"].includes(I.kind)||C.kind==="colorArray"&&["value","string","array"].includes(I.kind)||C.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(I.kind))w=p(w,C,l.typeAnnotation||"coerce");else if(this.checkSubtype(C,I))return null}else w=p(w,C,l.typeAnnotation||"assert")}if(!(w instanceof Wo)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const C=new Um;try{w=new Wo(w.type,w.evaluate(C))}catch(I){return this.error(I.message),null}}return w}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,l,p){const m=typeof s=="number"?this.path.concat(s):this.path,x=p?this.scope.concat(p):this.scope;return new Ac(this.registry,this._isConstant,m,l||null,x,this.errors)}error(s,...l){const p=`${this.key}${l.map((m=>`[${m}]`)).join("")}`;this.errors.push(new Zi(p,s))}checkSubtype(s,l){const p=Yu(s,l);return p&&this.error(p),p}}class Ju{constructor(s,l){this.type=l.type,this.bindings=[].concat(s),this.result=l}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const l of this.bindings)s(l[1]);s(this.result)}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const p=[];for(let x=1;x<s.length-1;x+=2){const w=s[x];if(typeof w!="string")return l.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return l.error("Variable names must contain only alphanumeric characters or '_'.",x);const C=l.parse(s[x+1],x+1);if(!C)return null;p.push([w,C])}const m=l.parse(s[s.length-1],s.length-1,l.expectedType,p);return m?new Ju(p,m):null}outputDefined(){return this.result.outputDefined()}}class jd{constructor(s,l){this.type=l.type,this.name=s,this.boundExpression=l}static parse(s,l){if(s.length!==2||typeof s[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const p=s[1];return l.scope.has(p)?new jd(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class Ud{constructor(s,l,p){this.type=s,this.index=l,this.input=p}static parse(s,l){if(s.length!==3)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,pt),m=l.parse(s[2],2,Fn(l.expectedType||Vt));return p&&m?new Ud(m.type.itemType,p,m):null}evaluate(s){const l=this.index.evaluate(s),p=this.input.evaluate(s);if(l<0)throw new $i(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new $i(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new $i(`Array index must be an integer, but found ${l} instead.`);return p[l]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class Vd{constructor(s,l){this.type=Ht,this.needle=s,this.haystack=l}static parse(s,l){if(s.length!==3)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,Vt),m=l.parse(s[2],2,Vt);return p&&m?Om(p.type,[Ht,Jt,pt,Ec,Vt])?new Vd(p,m):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(p.type)} instead`):null}evaluate(s){const l=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!p)return!1;if(!Ba(l,["boolean","string","number","null"]))throw new $i(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(Mt(l))} instead.`);if(!Ba(p,["string","array"]))throw new $i(`Expected second argument to be of type array or string, but found ${Ii(Mt(p))} instead.`);return p.indexOf(l)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Fs{constructor(s,l,p){this.type=pt,this.needle=s,this.haystack=l,this.fromIndex=p}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,Vt),m=l.parse(s[2],2,Vt);if(!p||!m)return null;if(!Om(p.type,[Ht,Jt,pt,Ec,Vt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(p.type)} instead`);if(s.length===4){const x=l.parse(s[3],3,pt);return x?new Fs(p,m,x):null}return new Fs(p,m)}evaluate(s){const l=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!Ba(l,["boolean","string","number","null"]))throw new $i(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(Mt(l))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(s)),Ba(p,["string"])){const x=p.indexOf(l,m);return x===-1?-1:[...p.slice(0,x)].length}if(Ba(p,["array"]))return p.indexOf(l,m);throw new $i(`Expected second argument to be of type array or string, but found ${Ii(Mt(p))} instead.`)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class Ur{constructor(s,l,p,m,x,w){this.inputType=s,this.type=l,this.input=p,this.cases=m,this.outputs=x,this.otherwise=w}static parse(s,l){if(s.length<5)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return l.error("Expected an even number of arguments.");let p,m;l.expectedType&&l.expectedType.kind!=="value"&&(m=l.expectedType);const x={},w=[];for(let A=2;A<s.length-1;A+=2){let D=s[A];const N=s[A+1];Array.isArray(D)||(D=[D]);const U=l.concat(A);if(D.length===0)return U.error("Expected at least one branch label.");for(const q of D){if(typeof q!="number"&&typeof q!="string")return U.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return U.error("Numeric branch labels must be integer values.");if(p){if(U.checkSubtype(p,Mt(q)))return null}else p=Mt(q);if(x[String(q)]!==void 0)return U.error("Branch labels must be unique.");x[String(q)]=w.length}const G=l.parse(N,A,m);if(!G)return null;m=m||G.type,w.push(G)}const C=l.parse(s[1],1,Vt);if(!C)return null;const I=l.parse(s[s.length-1],s.length-1,m);return I?C.type.kind!=="value"&&l.concat(1).checkSubtype(p,C.type)?null:new Ur(p,m,C,x,w,I):null}evaluate(s){const l=this.input.evaluate(s);return(Mt(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every((s=>s.outputDefined()))&&this.otherwise.outputDefined()}}class Dc{constructor(s,l,p){this.type=s,this.branches=l,this.otherwise=p}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const m=[];for(let w=1;w<s.length-1;w+=2){const C=l.parse(s[w],w,Ht);if(!C)return null;const I=l.parse(s[w+1],w+1,p);if(!I)return null;m.push([C,I]),p=p||I.type}const x=l.parse(s[s.length-1],s.length-1,p);if(!x)return null;if(!p)throw new Error("Can't infer output type");return new Dc(p,m,x)}evaluate(s){for(const[l,p]of this.branches)if(l.evaluate(s))return p.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[l,p]of this.branches)s(l),s(p);s(this.otherwise)}outputDefined(){return this.branches.every((([s,l])=>l.outputDefined()))&&this.otherwise.outputDefined()}}class Ku{constructor(s,l,p,m){this.type=s,this.input=l,this.beginIndex=p,this.endIndex=m}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,Vt),m=l.parse(s[2],2,pt);if(!p||!m)return null;if(!Om(p.type,[Fn(Vt),Jt,Vt]))return l.error(`Expected first argument to be of type array or string, but found ${Ii(p.type)} instead`);if(s.length===4){const x=l.parse(s[3],3,pt);return x?new Ku(p.type,p,m,x):null}return new Ku(p.type,p,m)}evaluate(s){const l=this.input.evaluate(s),p=this.beginIndex.evaluate(s);let m;if(this.endIndex&&(m=this.endIndex.evaluate(s)),Ba(l,["string"]))return[...l].slice(p,m).join("");if(Ba(l,["array"]))return l.slice(p,m);throw new $i(`Expected first argument to be of type array or string, but found ${Ii(Mt(l))} instead.`)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function Ml(c,s){const l=c.length-1;let p,m,x=0,w=l,C=0;for(;x<=w;)if(C=Math.floor((x+w)/2),p=c[C],m=c[C+1],p<=s){if(C===l||s<m)return C;x=C+1}else{if(!(p>s))throw new $i("Input is not a number.");w=C-1}return 0}class tr{constructor(s,l,p){this.type=s,this.input=l,this.labels=[],this.outputs=[];for(const[m,x]of p)this.labels.push(m),this.outputs.push(x)}static parse(s,l){if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(s[1],1,pt);if(!p)return null;const m=[];let x=null;l.expectedType&&l.expectedType.kind!=="value"&&(x=l.expectedType);for(let w=1;w<s.length;w+=2){const C=w===1?-1/0:s[w],I=s[w+1],A=w,D=w+1;if(typeof C!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(m.length&&m[m.length-1][0]>=C)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const N=l.parse(I,D,x);if(!N)return null;x=x||N.type,m.push([C,N])}return new tr(x,p,m)}evaluate(s){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(s);const m=this.input.evaluate(s);if(m<=l[0])return p[0].evaluate(s);const x=l.length;return m>=l[x-1]?p[x-1].evaluate(s):p[Ml(l,m)].evaluate(s)}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every((s=>s.outputDefined()))}}function x_(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Qu,Vm,Kw=(function(){if(Vm)return Qu;function c(s,l,p,m){this.cx=3*s,this.bx=3*(p-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=l,this.p2x=p,this.p2y=m}return Vm=1,Qu=c,c.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,l){if(l===void 0&&(l=1e-6),s<0)return 0;if(s>1)return 1;for(var p=s,m=0;m<8;m++){var x=this.sampleCurveX(p)-s;if(Math.abs(x)<l)return p;var w=this.sampleCurveDerivativeX(p);if(Math.abs(w)<1e-6)break;p-=x/w}var C=0,I=1;for(p=s,m=0;m<20&&(x=this.sampleCurveX(p),!(Math.abs(x-s)<l));m++)s>x?C=p:I=p,p=.5*(I-C)+C;return p},solve:function(s,l){return this.sampleCurveY(this.solveCurveX(s,l))}},Qu})(),zc=x_(Kw);class sn{constructor(s,l,p,m,x){this.type=s,this.operator=l,this.interpolation=p,this.input=m,this.labels=[],this.outputs=[];for(const[w,C]of x)this.labels.push(w),this.outputs.push(C)}static interpolationFactor(s,l,p,m){let x=0;if(s.name==="exponential")x=eh(l,s.base,p,m);else if(s.name==="linear")x=eh(l,1,p,m);else if(s.name==="cubic-bezier"){const w=s.controlPoints;x=new zc(w[0],w[1],w[2],w[3]).solve(eh(l,1,p,m))}return x}static parse(s,l){let[p,m,x,...w]=s;if(!Array.isArray(m)||m.length===0)return l.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const A=m[1];if(typeof A!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:A}}else{if(m[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const A=m.slice(1);if(A.length!==4||A.some((D=>typeof D!="number"||D<0||D>1)))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:A}}}if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(x=l.parse(x,2,pt),!x)return null;const C=[];let I=null;p!=="interpolate-hcl"&&p!=="interpolate-lab"||l.expectedType==wo?l.expectedType&&l.expectedType.kind!=="value"&&(I=l.expectedType):I=nn;for(let A=0;A<w.length;A+=2){const D=w[A],N=w[A+1],U=A+3,G=A+4;if(typeof D!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(C.length&&C[C.length-1][0]>=D)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const q=l.parse(N,G,I);if(!q)return null;I=I||q.type,C.push([D,q])}return ja(I,pt)||ja(I,Cl)||ja(I,nn)||ja(I,Rd)||ja(I,Ic)||ja(I,wo)||ja(I,Ld)||ja(I,Fn(pt))?new sn(I,p,m,x,C):l.error(`Type ${Ii(I)} is not interpolatable.`)}evaluate(s){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(s);const m=this.input.evaluate(s);if(m<=l[0])return p[0].evaluate(s);const x=l.length;if(m>=l[x-1])return p[x-1].evaluate(s);const w=Ml(l,m),C=sn.interpolationFactor(this.interpolation,m,l[w],l[w+1]),I=p[w].evaluate(s),A=p[w+1].evaluate(s);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Zo(I,A,C);case"color":return Qt.interpolate(I,A,C);case"padding":return jr.interpolate(I,A,C);case"colorArray":return gr.interpolate(I,A,C);case"numberArray":return Tn.interpolate(I,A,C);case"variableAnchorOffsetCollection":return Cn.interpolate(I,A,C);case"array":return Il(I,A,C);case"projectionDefinition":return fn.interpolate(I,A,C)}case"interpolate-hcl":switch(this.type.kind){case"color":return Qt.interpolate(I,A,C,"hcl");case"colorArray":return gr.interpolate(I,A,C,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Qt.interpolate(I,A,C,"lab");case"colorArray":return gr.interpolate(I,A,C,"lab")}}}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every((s=>s.outputDefined()))}}function eh(c,s,l,p){const m=p-l,x=c-l;return m===0?0:s===1?x/m:(Math.pow(s,x)-1)/(Math.pow(s,m)-1)}const Co={color:Qt.interpolate,number:Zo,padding:jr.interpolate,numberArray:Tn.interpolate,colorArray:gr.interpolate,variableAnchorOffsetCollection:Cn.interpolate,array:Il};class th{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");let p=null;const m=l.expectedType;m&&m.kind!=="value"&&(p=m);const x=[];for(const C of s.slice(1)){const I=l.parse(C,1+x.length,p,void 0,{typeAnnotation:"omit"});if(!I)return null;p=p||I.type,x.push(I)}if(!p)throw new Error("No output type");const w=m&&x.some((C=>Yu(m,C.type)));return new th(w?Vt:p,x)}evaluate(s){let l,p=null,m=0;for(const x of this.args)if(m++,p=x.evaluate(s),p&&p instanceof ts&&!p.available&&(l||(l=p.name),p=null,m===this.args.length&&(p=l)),p!==null)break;return p}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every((s=>s.outputDefined()))}}function ih(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function rh(c,s,l,p){return p.compare(s,l)===0}function mn(c,s,l){const p=c!=="=="&&c!=="!=";return class Gz{constructor(x,w,C){this.type=Ht,this.lhs=x,this.rhs=w,this.collator=C,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const C=x[0];let I=w.parse(x[1],1,Vt);if(!I)return null;if(!ih(C,I.type))return w.concat(1).error(`"${C}" comparisons are not supported for type '${Ii(I.type)}'.`);let A=w.parse(x[2],2,Vt);if(!A)return null;if(!ih(C,A.type))return w.concat(2).error(`"${C}" comparisons are not supported for type '${Ii(A.type)}'.`);if(I.type.kind!==A.type.kind&&I.type.kind!=="value"&&A.type.kind!=="value")return w.error(`Cannot compare types '${Ii(I.type)}' and '${Ii(A.type)}'.`);p&&(I.type.kind==="value"&&A.type.kind!=="value"?I=new is(A.type,[I]):I.type.kind!=="value"&&A.type.kind==="value"&&(A=new is(I.type,[A])));let D=null;if(x.length===4){if(I.type.kind!=="string"&&A.type.kind!=="string"&&I.type.kind!=="value"&&A.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(D=w.parse(x[3],3,Od),!D)return null}return new Gz(I,A,D)}evaluate(x){const w=this.lhs.evaluate(x),C=this.rhs.evaluate(x);if(p&&this.hasUntypedArgument){const I=Mt(w),A=Mt(C);if(I.kind!==A.kind||I.kind!=="string"&&I.kind!=="number")throw new $i(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${I.kind}, ${A.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const I=Mt(w),A=Mt(C);if(I.kind!=="string"||A.kind!=="string")return s(x,w,C)}return this.collator?l(x,w,C,this.collator.evaluate(x)):s(x,w,C)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const w_=mn("==",(function(c,s,l){return s===l}),rh),Gd=mn("!=",(function(c,s,l){return s!==l}),(function(c,s,l,p){return!rh(0,s,l,p)})),Qw=mn("<",(function(c,s,l){return s<l}),(function(c,s,l,p){return p.compare(s,l)<0})),Gm=mn(">",(function(c,s,l){return s>l}),(function(c,s,l,p){return p.compare(s,l)>0})),e2=mn("<=",(function(c,s,l){return s<=l}),(function(c,s,l,p){return p.compare(s,l)<=0})),t2=mn(">=",(function(c,s,l){return s>=l}),(function(c,s,l,p){return p.compare(s,l)>=0}));class qd{constructor(s,l,p){this.type=Od,this.locale=p,this.caseSensitive=s,this.diacriticSensitive=l}static parse(s,l){if(s.length!==2)return l.error("Expected one argument.");const p=s[1];if(typeof p!="object"||Array.isArray(p))return l.error("Collator options argument must be an object.");const m=l.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Ht);if(!m)return null;const x=l.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Ht);if(!x)return null;let w=null;return p.locale&&(w=l.parse(p.locale,1,Jt),!w)?null:new qd(m,x,w)}evaluate(s){return new $l(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}class qm{constructor(s,l,p,m,x){this.type=Jt,this.number=s,this.locale=l,this.currency=p,this.minFractionDigits=m,this.maxFractionDigits=x}static parse(s,l){if(s.length!==3)return l.error("Expected two arguments.");const p=l.parse(s[1],1,pt);if(!p)return null;const m=s[2];if(typeof m!="object"||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");let x=null;if(m.locale&&(x=l.parse(m.locale,1,Jt),!x))return null;let w=null;if(m.currency&&(w=l.parse(m.currency,1,Jt),!w))return null;let C=null;if(m["min-fraction-digits"]&&(C=l.parse(m["min-fraction-digits"],1,pt),!C))return null;let I=null;return m["max-fraction-digits"]&&(I=l.parse(m["max-fraction-digits"],1,pt),!I)?null:new qm(p,x,w,C,I)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class kl{constructor(s){this.type=Na,this.sections=s}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const p=s[1];if(!Array.isArray(p)&&typeof p=="object")return l.error("First argument must be an image or text section.");const m=[];let x=!1;for(let w=1;w<=s.length-1;++w){const C=s[w];if(x&&typeof C=="object"&&!Array.isArray(C)){x=!1;let I=null;if(C["font-scale"]&&(I=l.parse(C["font-scale"],1,pt),!I))return null;let A=null;if(C["text-font"]&&(A=l.parse(C["text-font"],1,Fn(Jt)),!A))return null;let D=null;if(C["text-color"]&&(D=l.parse(C["text-color"],1,nn),!D))return null;let N=null;if(C["vertical-align"]){if(typeof C["vertical-align"]=="string"&&!Fd.includes(C["vertical-align"]))return l.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${C["vertical-align"]}' instead.`);if(N=l.parse(C["vertical-align"],1,Jt),!N)return null}const U=m[m.length-1];U.scale=I,U.font=A,U.textColor=D,U.verticalAlign=N}else{const I=l.parse(s[w],1,Vt);if(!I)return null;const A=I.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,m.push({content:I,scale:null,font:null,textColor:null,verticalAlign:null})}}return new kl(m)}evaluate(s){return new Sn(this.sections.map((l=>{const p=l.content.evaluate(s);return Mt(p)===er?new Nd("",p,null,null,null,l.verticalAlign?l.verticalAlign.evaluate(s):null):new Nd(Ft(p),null,l.scale?l.scale.evaluate(s):null,l.font?l.font.evaluate(s).join(","):null,l.textColor?l.textColor.evaluate(s):null,l.verticalAlign?l.verticalAlign.evaluate(s):null)})))}eachChild(s){for(const l of this.sections)s(l.content),l.scale&&s(l.scale),l.font&&s(l.font),l.textColor&&s(l.textColor),l.verticalAlign&&s(l.verticalAlign)}outputDefined(){return!1}}class Hm{constructor(s){this.type=er,this.input=s}static parse(s,l){if(s.length!==2)return l.error("Expected two arguments.");const p=l.parse(s[1],1,Jt);return p?new Hm(p):l.error("No image name provided.")}evaluate(s){const l=this.input.evaluate(s),p=ts.fromString(l);return p&&s.availableImages&&(p.available=s.availableImages.indexOf(l)>-1),p}eachChild(s){s(this.input)}outputDefined(){return!1}}class Hd{constructor(s){this.type=pt,this.input=s}static parse(s,l){if(s.length!==2)return l.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=l.parse(s[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${Ii(p.type)} instead.`):new Hd(p):null}evaluate(s){const l=this.input.evaluate(s);if(typeof l=="string")return[...l].length;if(Array.isArray(l))return l.length;throw new $i(`Expected value to be of type string or array, but found ${Ii(Mt(l))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const Ns=8192;function i2(c,s){const l=(180+c[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(l*m*Ns),Math.round(p*m*Ns)]}function Zd(c,s){const l=Math.pow(2,s.z);return[(m=(c[0]/Ns+s.x)/l,360*m-180),(p=(c[1]/Ns+s.y)/l,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,m}function nh(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function sh(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function r2(c,s,l){const p=c[0]-s[0],m=c[1]-s[1],x=c[0]-l[0],w=c[1]-l[1];return p*w-x*m==0&&p*x<=0&&m*w<=0}function Wd(c,s,l,p){return(m=[p[0]-l[0],p[1]-l[1]])[0]*(x=[s[0]-c[0],s[1]-c[1]])[1]-m[1]*x[0]!=0&&!(!T_(c,s,l,p)||!T_(l,p,c,s));var m,x}function n2(c,s,l){for(const p of l)for(let m=0;m<p.length-1;++m)if(Wd(c,s,p[m],p[m+1]))return!0;return!1}function Al(c,s,l=!1){let p=!1;for(const C of s)for(let I=0;I<C.length-1;I++){if(r2(c,C[I],C[I+1]))return l;(x=C[I])[1]>(m=c)[1]!=(w=C[I+1])[1]>m[1]&&m[0]<(w[0]-x[0])*(m[1]-x[1])/(w[1]-x[1])+x[0]&&(p=!p)}var m,x,w;return p}function S_(c,s){for(const l of s)if(Al(c,l))return!0;return!1}function Zm(c,s){for(const l of c)if(!Al(l,s))return!1;for(let l=0;l<c.length-1;++l)if(n2(c[l],c[l+1],s))return!1;return!0}function s2(c,s){for(const l of s)if(Zm(c,l))return!0;return!1}function T_(c,s,l,p){const m=p[0]-l[0],x=p[1]-l[1],w=(c[0]-l[0])*x-m*(c[1]-l[1]),C=(s[0]-l[0])*x-m*(s[1]-l[1]);return w>0&&C<0||w<0&&C>0}function Wm(c,s,l){const p=[];for(let m=0;m<c.length;m++){const x=[];for(let w=0;w<c[m].length;w++){const C=i2(c[m][w],l);nh(s,C),x.push(C)}p.push(x)}return p}function C_(c,s,l){const p=[];for(let m=0;m<c.length;m++){const x=Wm(c[m],s,l);p.push(x)}return p}function Yd(c,s,l,p){if(c[0]<l[0]||c[0]>l[2]){const m=.5*p;let x=c[0]-l[0]>m?-p:l[0]-c[0]>m?p:0;x===0&&(x=c[0]-l[2]>m?-p:l[2]-c[0]>m?p:0),c[0]+=x}nh(s,c)}function E_(c,s,l,p){const m=Math.pow(2,p.z)*Ns,x=[p.x*Ns,p.y*Ns],w=[];for(const C of c)for(const I of C){const A=[I.x+x[0],I.y+x[1]];Yd(A,s,l,m),w.push(A)}return w}function I_(c,s,l,p){const m=Math.pow(2,p.z)*Ns,x=[p.x*Ns,p.y*Ns],w=[];for(const I of c){const A=[];for(const D of I){const N=[D.x+x[0],D.y+x[1]];nh(s,N),A.push(N)}w.push(A)}if(s[2]-s[0]<=m/2){(C=s)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const I of w)for(const A of I)Yd(A,s,l,m)}var C;return w}class Dl{constructor(s,l){this.type=Ht,this.geojson=s,this.geometries=l}static parse(s,l){if(s.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Pl(s[1])){const p=s[1];if(p.type==="FeatureCollection"){const m=[];for(const x of p.features){const{type:w,coordinates:C}=x.geometry;w==="Polygon"&&m.push(C),w==="MultiPolygon"&&m.push(...C)}if(m.length)return new Dl(p,{type:"MultiPolygon",coordinates:m})}else if(p.type==="Feature"){const m=p.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Dl(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Dl(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return(function(l,p){const m=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(p.type==="Polygon"){const C=Wm(p.coordinates,x,w),I=E_(l.geometry(),m,x,w);if(!sh(m,x))return!1;for(const A of I)if(!Al(A,C))return!1}if(p.type==="MultiPolygon"){const C=C_(p.coordinates,x,w),I=E_(l.geometry(),m,x,w);if(!sh(m,x))return!1;for(const A of I)if(!S_(A,C))return!1}return!0})(s,this.geometries);if(s.geometryType()==="LineString")return(function(l,p){const m=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(p.type==="Polygon"){const C=Wm(p.coordinates,x,w),I=I_(l.geometry(),m,x,w);if(!sh(m,x))return!1;for(const A of I)if(!Zm(A,C))return!1}if(p.type==="MultiPolygon"){const C=C_(p.coordinates,x,w),I=I_(l.geometry(),m,x,w);if(!sh(m,x))return!1;for(const A of I)if(!s2(A,C))return!1}return!0})(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ym=class{constructor(c=[],s=(l,p)=>l<p?-1:l>p?1:0){if(this.data=c,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:s,compare:l}=this,p=s[c];for(;c>0;){const m=c-1>>1,x=s[m];if(l(p,x)>=0)break;s[c]=x,c=m}s[c]=p}_down(c){const{data:s,compare:l}=this,p=this.length>>1,m=s[c];for(;c<p;){let x=1+(c<<1);const w=x+1;if(w<this.length&&l(s[w],s[x])<0&&(x=w),l(s[x],m)>=0)break;s[c]=s[x],c=x}s[c]=m}};function Xm(c,s,l=0,p=c.length-1,m=o2){for(;p>l;){if(p-l>600){const I=p-l+1,A=s-l+1,D=Math.log(I),N=.5*Math.exp(2*D/3),U=.5*Math.sqrt(D*N*(I-N)/I)*(A-I/2<0?-1:1);Xm(c,s,Math.max(l,Math.floor(s-A*N/I+U)),Math.min(p,Math.floor(s+(I-A)*N/I+U)),m)}const x=c[s];let w=l,C=p;for(oh(c,l,s),m(c[p],x)>0&&oh(c,l,p);w<C;){for(oh(c,w,C),w++,C--;m(c[w],x)<0;)w++;for(;m(c[C],x)>0;)C--}m(c[l],x)===0?oh(c,l,C):(C++,oh(c,C,p)),C<=s&&(l=C+1),s<=C&&(p=C-1)}}function oh(c,s,l){const p=c[s];c[s]=c[l],c[l]=p}function o2(c,s){return c<s?-1:c>s?1:0}function ah(c,s){if(c.length<=1)return[c];const l=[];let p,m;for(const x of c){const w=a2(x);w!==0&&(x.area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(p&&l.push(p),p=[x]):p.push(x))}if(p&&l.push(p),s>1)for(let x=0;x<l.length;x++)l[x].length<=s||(Xm(l[x],s,1,l[x].length-1,$_),l[x]=l[x].slice(0,s));return l}function $_(c,s){return s.area-c.area}function a2(c){let s=0;for(let l,p,m=0,x=c.length,w=x-1;m<x;w=m++)l=c[m],p=c[w],s+=(p.x-l.x)*(l.y+p.y);return s}const P_=1/298.257223563,M_=P_*(2-P_),Jm=Math.PI/180;class Km{constructor(s){const l=6378.137*Jm*1e3,p=Math.cos(s*Jm),m=1/(1-M_*(1-p*p)),x=Math.sqrt(m);this.kx=l*x*p,this.ky=l*x*m*(1-M_)}distance(s,l){const p=this.wrap(s[0]-l[0])*this.kx,m=(s[1]-l[1])*this.ky;return Math.sqrt(p*p+m*m)}pointOnLine(s,l){let p,m,x,w,C=1/0;for(let I=0;I<s.length-1;I++){let A=s[I][0],D=s[I][1],N=this.wrap(s[I+1][0]-A)*this.kx,U=(s[I+1][1]-D)*this.ky,G=0;N===0&&U===0||(G=(this.wrap(l[0]-A)*this.kx*N+(l[1]-D)*this.ky*U)/(N*N+U*U),G>1?(A=s[I+1][0],D=s[I+1][1]):G>0&&(A+=N/this.kx*G,D+=U/this.ky*G)),N=this.wrap(l[0]-A)*this.kx,U=(l[1]-D)*this.ky;const q=N*N+U*U;q<C&&(C=q,p=A,m=D,x=I,w=G)}return{point:[p,m],index:x,t:Math.max(0,Math.min(1,w))}}wrap(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s}}function k_(c,s){return s[0]-c[0]}function Xd(c){return c[1]-c[0]+1}function Yo(c,s){return c[1]>=c[0]&&c[1]<s}function di(c,s){if(c[0]>c[1])return[null,null];const l=Xd(c);if(s){if(l===2)return[c,null];const m=Math.floor(l/2);return[[c[0],c[0]+m],[c[0]+m,c[1]]]}if(l===1)return[c,null];const p=Math.floor(l/2)-1;return[[c[0],c[0]+p],[c[0]+p+1,c[1]]]}function Qm(c,s){if(!Yo(s,c.length))return[1/0,1/0,-1/0,-1/0];const l=[1/0,1/0,-1/0,-1/0];for(let p=s[0];p<=s[1];++p)nh(l,c[p]);return l}function eg(c){const s=[1/0,1/0,-1/0,-1/0];for(const l of c)for(const p of l)nh(s,p);return s}function A_(c){return c[0]!==-1/0&&c[1]!==-1/0&&c[2]!==1/0&&c[3]!==1/0}function tg(c,s,l){if(!A_(c)||!A_(s))return NaN;let p=0,m=0;return c[2]<s[0]&&(p=s[0]-c[2]),c[0]>s[2]&&(p=c[0]-s[2]),c[1]>s[3]&&(m=c[1]-s[3]),c[3]<s[1]&&(m=s[1]-c[3]),l.distance([0,0],[p,m])}function zl(c,s,l){const p=l.pointOnLine(s,c);return l.distance(c,p.point)}function ig(c,s,l,p,m){const x=Math.min(zl(c,[l,p],m),zl(s,[l,p],m)),w=Math.min(zl(l,[c,s],m),zl(p,[c,s],m));return Math.min(x,w)}function l2(c,s,l,p,m){if(!Yo(s,c.length)||!Yo(p,l.length))return 1/0;let x=1/0;for(let w=s[0];w<s[1];++w){const C=c[w],I=c[w+1];for(let A=p[0];A<p[1];++A){const D=l[A],N=l[A+1];if(Wd(C,I,D,N))return 0;x=Math.min(x,ig(C,I,D,N,m))}}return x}function c2(c,s,l,p,m){if(!Yo(s,c.length)||!Yo(p,l.length))return NaN;let x=1/0;for(let w=s[0];w<=s[1];++w)for(let C=p[0];C<=p[1];++C)if(x=Math.min(x,m.distance(c[w],l[C])),x===0)return x;return x}function u2(c,s,l){if(Al(c,s,!0))return 0;let p=1/0;for(const m of s){const x=m[0],w=m[m.length-1];if(x!==w&&(p=Math.min(p,zl(c,[w,x],l)),p===0))return p;const C=l.pointOnLine(m,c);if(p=Math.min(p,l.distance(c,C.point)),p===0)return p}return p}function h2(c,s,l,p){if(!Yo(s,c.length))return NaN;for(let x=s[0];x<=s[1];++x)if(Al(c[x],l,!0))return 0;let m=1/0;for(let x=s[0];x<s[1];++x){const w=c[x],C=c[x+1];for(const I of l)for(let A=0,D=I.length,N=D-1;A<D;N=A++){const U=I[N],G=I[A];if(Wd(w,C,U,G))return 0;m=Math.min(m,ig(w,C,U,G,p))}}return m}function D_(c,s){for(const l of c)for(const p of l)if(Al(p,s,!0))return!0;return!1}function d2(c,s,l,p=1/0){const m=eg(c),x=eg(s);if(p!==1/0&&tg(m,x,l)>=p)return p;if(sh(m,x)){if(D_(c,s))return 0}else if(D_(s,c))return 0;let w=1/0;for(const C of c)for(let I=0,A=C.length,D=A-1;I<A;D=I++){const N=C[D],U=C[I];for(const G of s)for(let q=0,X=G.length,Q=X-1;q<X;Q=q++){const ne=G[Q],ye=G[q];if(Wd(N,U,ne,ye))return 0;w=Math.min(w,ig(N,U,ne,ye,l))}}return w}function z_(c,s,l,p,m,x){if(!x)return;const w=tg(Qm(p,x),m,l);w<s&&c.push([w,x,[0,0]])}function Jd(c,s,l,p,m,x,w){if(!x||!w)return;const C=tg(Qm(p,x),Qm(m,w),l);C<s&&c.push([C,x,w])}function Kd(c,s,l,p,m=1/0){let x=Math.min(p.distance(c[0],l[0][0]),m);if(x===0)return x;const w=new Ym([[0,[0,c.length-1],[0,0]]],k_),C=eg(l);for(;w.length>0;){const I=w.pop();if(I[0]>=x)continue;const A=I[1],D=s?50:100;if(Xd(A)<=D){if(!Yo(A,c.length))return NaN;if(s){const N=h2(c,A,l,p);if(isNaN(N)||N===0)return N;x=Math.min(x,N)}else for(let N=A[0];N<=A[1];++N){const U=u2(c[N],l,p);if(x=Math.min(x,U),x===0)return 0}}else{const N=di(A,s);z_(w,x,p,c,C,N[0]),z_(w,x,p,c,C,N[1])}}return x}function Qd(c,s,l,p,m,x=1/0){let w=Math.min(x,m.distance(c[0],l[0]));if(w===0)return w;const C=new Ym([[0,[0,c.length-1],[0,l.length-1]]],k_);for(;C.length>0;){const I=C.pop();if(I[0]>=w)continue;const A=I[1],D=I[2],N=s?50:100,U=p?50:100;if(Xd(A)<=N&&Xd(D)<=U){if(!Yo(A,c.length)&&Yo(D,l.length))return NaN;let G;if(s&&p)G=l2(c,A,l,D,m),w=Math.min(w,G);else if(s&&!p){const q=c.slice(A[0],A[1]+1);for(let X=D[0];X<=D[1];++X)if(G=zl(l[X],q,m),w=Math.min(w,G),w===0)return w}else if(!s&&p){const q=l.slice(D[0],D[1]+1);for(let X=A[0];X<=A[1];++X)if(G=zl(c[X],q,m),w=Math.min(w,G),w===0)return w}else G=c2(c,A,l,D,m),w=Math.min(w,G)}else{const G=di(A,s),q=di(D,p);Jd(C,w,m,c,l,G[0],q[0]),Jd(C,w,m,c,l,G[0],q[1]),Jd(C,w,m,c,l,G[1],q[0]),Jd(C,w,m,c,l,G[1],q[1])}}return w}function rg(c){return c.type==="MultiPolygon"?c.coordinates.map((s=>({type:"Polygon",coordinates:s}))):c.type==="MultiLineString"?c.coordinates.map((s=>({type:"LineString",coordinates:s}))):c.type==="MultiPoint"?c.coordinates.map((s=>({type:"Point",coordinates:s}))):[c]}class Ol{constructor(s,l){this.type=pt,this.geojson=s,this.geometries=l}static parse(s,l){if(s.length!==2)return l.error(`'distance' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Pl(s[1])){const p=s[1];if(p.type==="FeatureCollection")return new Ol(p,p.features.map((m=>rg(m.geometry))).flat());if(p.type==="Feature")return new Ol(p,rg(p.geometry));if("type"in p&&"coordinates"in p)return new Ol(p,rg(p))}return l.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return(function(l,p){const m=l.geometry(),x=m.flat().map((I=>Zd([I.x,I.y],l.canonical)));if(m.length===0)return NaN;const w=new Km(x[0][1]);let C=1/0;for(const I of p){switch(I.type){case"Point":C=Math.min(C,Qd(x,!1,[I.coordinates],!1,w,C));break;case"LineString":C=Math.min(C,Qd(x,!1,I.coordinates,!0,w,C));break;case"Polygon":C=Math.min(C,Kd(x,!1,I.coordinates,w,C))}if(C===0)return C}return C})(s,this.geometries);if(s.geometryType()==="LineString")return(function(l,p){const m=l.geometry(),x=m.flat().map((I=>Zd([I.x,I.y],l.canonical)));if(m.length===0)return NaN;const w=new Km(x[0][1]);let C=1/0;for(const I of p){switch(I.type){case"Point":C=Math.min(C,Qd(x,!0,[I.coordinates],!1,w,C));break;case"LineString":C=Math.min(C,Qd(x,!0,I.coordinates,!0,w,C));break;case"Polygon":C=Math.min(C,Kd(x,!0,I.coordinates,w,C))}if(C===0)return C}return C})(s,this.geometries);if(s.geometryType()==="Polygon")return(function(l,p){const m=l.geometry();if(m.length===0||m[0].length===0)return NaN;const x=ah(m,0).map((I=>I.map((A=>A.map((D=>Zd([D.x,D.y],l.canonical))))))),w=new Km(x[0][0][0][1]);let C=1/0;for(const I of p)for(const A of x){switch(I.type){case"Point":C=Math.min(C,Kd([I.coordinates],!1,A,w,C));break;case"LineString":C=Math.min(C,Kd(I.coordinates,!0,A,w,C));break;case"Polygon":C=Math.min(C,d2(A,I.coordinates,w,C))}if(C===0)return C}return C})(s,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class lh{constructor(s){this.type=Vt,this.key=s}static parse(s,l){if(s.length!==2)return l.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=s[1];return p==null?l.error("Global state property must be defined."):typeof p!="string"?l.error(`Global state property must be string, but found ${typeof s[1]} instead.`):new lh(p)}evaluate(s){var l;const p=(l=s.globals)===null||l===void 0?void 0:l.globalState;return p&&Object.keys(p).length!==0?kc(p,this.key):null}eachChild(){}outputDefined(){return!1}}const Oc={"==":w_,"!=":Gd,">":Gm,"<":Qw,">=":t2,"<=":e2,array:is,at:Ud,boolean:is,case:Dc,coalesce:th,collator:qd,format:kl,image:Hm,in:Vd,"index-of":Fs,interpolate:sn,"interpolate-hcl":sn,"interpolate-lab":sn,length:Hd,let:Ju,literal:Wo,match:Ur,number:is,"number-format":qm,object:is,slice:Ku,step:tr,string:is,"to-boolean":To,"to-color":To,"to-number":To,"to-string":To,var:jd,within:Dl,distance:Ol,"global-state":lh};class gs{constructor(s,l,p,m){this.name=s,this.type=l,this._evaluate=p,this.args=m}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,l){const p=s[0],m=gs.definitions[p];if(!m)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(m)?m[0]:m.type,w=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,C=w.filter((([A])=>!Array.isArray(A)||A.length===s.length-1));let I=null;for(const[A,D]of C){I=new Ac(l.registry,ep,l.path,null,l.scope);const N=[];let U=!1;for(let G=1;G<s.length;G++){const q=s[G],X=Array.isArray(A)?A[G-1]:A.type,Q=I.parse(q,1+N.length,X);if(!Q){U=!0;break}N.push(Q)}if(!U)if(Array.isArray(A)&&A.length!==N.length)I.error(`Expected ${A.length} arguments, but found ${N.length} instead.`);else{for(let G=0;G<N.length;G++){const q=Array.isArray(A)?A[G]:A.type,X=N[G];I.concat(G+1).checkSubtype(q,X.type)}if(I.errors.length===0)return new gs(p,x,D,N)}}if(C.length===1)l.errors.push(...I.errors);else{const A=(C.length?C:w).map((([N])=>{return U=N,Array.isArray(U)?`(${U.map(Ii).join(", ")})`:`(${Ii(U.type)}...)`;var U})).join(" | "),D=[];for(let N=1;N<s.length;N++){const U=l.parse(s[N],1+D.length);if(!U)return null;D.push(Ii(U.type))}l.error(`Expected arguments of type ${A}, but found (${D.join(", ")}) instead.`)}return null}static register(s,l){gs.definitions=l;for(const p in l)s[p]=gs}}function O_(c,[s,l,p,m]){s=s.evaluate(c),l=l.evaluate(c),p=p.evaluate(c);const x=m?m.evaluate(c):1,w=Li(s,l,p,x);if(w)throw new $i(w);return new Qt(s/255,l/255,p/255,x,!1)}function R_(c,s){return c in s}function ng(c,s){const l=s[c];return l===void 0?null:l}function Rl(c){return{type:c}}function ep(c){if(c instanceof jd)return ep(c.boundExpression);if(c instanceof gs&&c.name==="error"||c instanceof qd||c instanceof Dl||c instanceof Ol||c instanceof lh)return!1;const s=c instanceof To||c instanceof is;let l=!0;return c.eachChild((p=>{l=s?l&&ep(p):l&&p instanceof Wo})),!!l&&tp(c)&&ip(c,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function tp(c){if(c instanceof gs&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Dl||c instanceof Ol)return!1;let s=!0;return c.eachChild((l=>{s&&!tp(l)&&(s=!1)})),s}function ch(c){if(c instanceof gs&&c.name==="feature-state")return!1;let s=!0;return c.eachChild((l=>{s&&!ch(l)&&(s=!1)})),s}function ip(c,s){if(c instanceof gs&&s.indexOf(c.name)>=0)return!1;let l=!0;return c.eachChild((p=>{l&&!ip(p,s)&&(l=!1)})),l}function L_(c){return{result:"success",value:c}}function Rc(c){return{result:"error",value:c}}function Va(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function F_(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function sg(c){return!!c.expression&&c.expression.interpolated}function ii(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function uh(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)&&Mt(c)===Fa}function p2(c){return c}function N_(c,s){const l=c.stops&&typeof c.stops[0][0]=="object",p=l||!(l||c.property!==void 0),m=c.type||(sg(s)?"exponential":"interval"),x=(function(D){switch(D.type){case"color":return Qt.parse;case"padding":return jr.parse;case"numberArray":return Tn.parse;case"colorArray":return gr.parse;default:return null}})(s);if(x&&((c=pn({},c)).stops&&(c.stops=c.stops.map((D=>[D[0],x(D[1])]))),c.default=x(c.default?c.default:s.default)),c.colorSpace&&(w=c.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var w;const C=(function(D){switch(D){case"exponential":return j_;case"interval":return f2;case"categorical":return B_;case"identity":return m2;default:throw new Error(`Unknown function type "${D}"`)}})(m);let I,A;if(m==="categorical"){I=Object.create(null);for(const D of c.stops)I[D[0]]=D[1];A=typeof c.stops[0][0]}if(l){const D={},N=[];for(let q=0;q<c.stops.length;q++){const X=c.stops[q],Q=X[0].zoom;D[Q]===void 0&&(D[Q]={zoom:Q,type:c.type,property:c.property,default:c.default,stops:[]},N.push(Q)),D[Q].stops.push([X[0].value,X[1]])}const U=[];for(const q of N)U.push([D[q].zoom,N_(D[q],s)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:sn.interpolationFactor.bind(void 0,G),zoomStops:U.map((q=>q[0])),evaluate:({zoom:q},X)=>j_({stops:U,base:c.base},s,q).evaluate(q,X)}}if(p){const D=m==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:sn.interpolationFactor.bind(void 0,D),zoomStops:c.stops.map((N=>N[0])),evaluate:({zoom:N})=>C(c,s,N,I,A)}}return{kind:"source",evaluate(D,N){const U=N&&N.properties?N.properties[c.property]:void 0;return U===void 0?Ga(c.default,s.default):C(c,s,U,I,A)}}}function Ga(c,s,l){return c!==void 0?c:s!==void 0?s:l!==void 0?l:void 0}function B_(c,s,l,p,m){return Ga(typeof l===m?p[l]:void 0,c.default,s.default)}function f2(c,s,l){if(ii(l)!=="number")return Ga(c.default,s.default);const p=c.stops.length;if(p===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[p-1][0])return c.stops[p-1][1];const m=Ml(c.stops.map((x=>x[0])),l);return c.stops[m][1]}function j_(c,s,l){const p=c.base!==void 0?c.base:1;if(ii(l)!=="number")return Ga(c.default,s.default);const m=c.stops.length;if(m===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[m-1][0])return c.stops[m-1][1];const x=Ml(c.stops.map((D=>D[0])),l),w=(function(D,N,U,G){const q=G-U,X=D-U;return q===0?0:N===1?X/q:(Math.pow(N,X)-1)/(Math.pow(N,q)-1)})(l,p,c.stops[x][0],c.stops[x+1][0]),C=c.stops[x][1],I=c.stops[x+1][1],A=Co[s.type]||p2;return typeof C.evaluate=="function"?{evaluate(...D){const N=C.evaluate.apply(void 0,D),U=I.evaluate.apply(void 0,D);if(N!==void 0&&U!==void 0)return A(N,U,w,c.colorSpace)}}:A(C,I,w,c.colorSpace)}function m2(c,s,l){switch(s.type){case"color":l=Qt.parse(l);break;case"formatted":l=Sn.fromString(l.toString());break;case"resolvedImage":l=ts.fromString(l.toString());break;case"padding":l=jr.parse(l);break;case"colorArray":l=gr.parse(l);break;case"numberArray":l=Tn.parse(l);break;default:ii(l)===s.type||s.type==="enum"&&s.values[l]||(l=void 0)}return Ga(l,c.default,s.default)}gs.register(Oc,{error:[{kind:"error"},[Jt],(c,[s])=>{throw new $i(s.evaluate(c))}],typeof:[Jt,[Vt],(c,[s])=>Ii(Mt(s.evaluate(c)))],"to-rgba":[Fn(pt,4),[nn],(c,[s])=>{const[l,p,m,x]=s.evaluate(c).rgb;return[255*l,255*p,255*m,x]}],rgb:[nn,[pt,pt,pt],O_],rgba:[nn,[pt,pt,pt,pt],O_],has:{type:Ht,overloads:[[[Jt],(c,[s])=>R_(s.evaluate(c),c.properties())],[[Jt,Fa],(c,[s,l])=>R_(s.evaluate(c),l.evaluate(c))]]},get:{type:Vt,overloads:[[[Jt],(c,[s])=>ng(s.evaluate(c),c.properties())],[[Jt,Fa],(c,[s,l])=>ng(s.evaluate(c),l.evaluate(c))]]},"feature-state":[Vt,[Jt],(c,[s])=>ng(s.evaluate(c),c.featureState||{})],properties:[Fa,[],c=>c.properties()],"geometry-type":[Jt,[],c=>c.geometryType()],id:[Vt,[],c=>c.id()],zoom:[pt,[],c=>c.globals.zoom],"heatmap-density":[pt,[],c=>c.globals.heatmapDensity||0],elevation:[pt,[],c=>c.globals.elevation||0],"line-progress":[pt,[],c=>c.globals.lineProgress||0],accumulated:[Vt,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[pt,Rl(pt),(c,s)=>{let l=0;for(const p of s)l+=p.evaluate(c);return l}],"*":[pt,Rl(pt),(c,s)=>{let l=1;for(const p of s)l*=p.evaluate(c);return l}],"-":{type:pt,overloads:[[[pt,pt],(c,[s,l])=>s.evaluate(c)-l.evaluate(c)],[[pt],(c,[s])=>-s.evaluate(c)]]},"/":[pt,[pt,pt],(c,[s,l])=>s.evaluate(c)/l.evaluate(c)],"%":[pt,[pt,pt],(c,[s,l])=>s.evaluate(c)%l.evaluate(c)],ln2:[pt,[],()=>Math.LN2],pi:[pt,[],()=>Math.PI],e:[pt,[],()=>Math.E],"^":[pt,[pt,pt],(c,[s,l])=>Math.pow(s.evaluate(c),l.evaluate(c))],sqrt:[pt,[pt],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[pt,[pt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[pt,[pt],(c,[s])=>Math.log(s.evaluate(c))],log2:[pt,[pt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[pt,[pt],(c,[s])=>Math.sin(s.evaluate(c))],cos:[pt,[pt],(c,[s])=>Math.cos(s.evaluate(c))],tan:[pt,[pt],(c,[s])=>Math.tan(s.evaluate(c))],asin:[pt,[pt],(c,[s])=>Math.asin(s.evaluate(c))],acos:[pt,[pt],(c,[s])=>Math.acos(s.evaluate(c))],atan:[pt,[pt],(c,[s])=>Math.atan(s.evaluate(c))],min:[pt,Rl(pt),(c,s)=>Math.min(...s.map((l=>l.evaluate(c))))],max:[pt,Rl(pt),(c,s)=>Math.max(...s.map((l=>l.evaluate(c))))],abs:[pt,[pt],(c,[s])=>Math.abs(s.evaluate(c))],round:[pt,[pt],(c,[s])=>{const l=s.evaluate(c);return l<0?-Math.round(-l):Math.round(l)}],floor:[pt,[pt],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[pt,[pt],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[Ht,[Jt,Vt],(c,[s,l])=>c.properties()[s.value]===l.value],"filter-id-==":[Ht,[Vt],(c,[s])=>c.id()===s.value],"filter-type-==":[Ht,[Jt],(c,[s])=>c.geometryType()===s.value],"filter-<":[Ht,[Jt,Vt],(c,[s,l])=>{const p=c.properties()[s.value],m=l.value;return typeof p==typeof m&&p<m}],"filter-id-<":[Ht,[Vt],(c,[s])=>{const l=c.id(),p=s.value;return typeof l==typeof p&&l<p}],"filter->":[Ht,[Jt,Vt],(c,[s,l])=>{const p=c.properties()[s.value],m=l.value;return typeof p==typeof m&&p>m}],"filter-id->":[Ht,[Vt],(c,[s])=>{const l=c.id(),p=s.value;return typeof l==typeof p&&l>p}],"filter-<=":[Ht,[Jt,Vt],(c,[s,l])=>{const p=c.properties()[s.value],m=l.value;return typeof p==typeof m&&p<=m}],"filter-id-<=":[Ht,[Vt],(c,[s])=>{const l=c.id(),p=s.value;return typeof l==typeof p&&l<=p}],"filter->=":[Ht,[Jt,Vt],(c,[s,l])=>{const p=c.properties()[s.value],m=l.value;return typeof p==typeof m&&p>=m}],"filter-id->=":[Ht,[Vt],(c,[s])=>{const l=c.id(),p=s.value;return typeof l==typeof p&&l>=p}],"filter-has":[Ht,[Vt],(c,[s])=>s.value in c.properties()],"filter-has-id":[Ht,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Ht,[Fn(Jt)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[Ht,[Fn(Vt)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[Ht,[Jt,Fn(Vt)],(c,[s,l])=>l.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[Ht,[Jt,Fn(Vt)],(c,[s,l])=>(function(p,m,x,w){for(;x<=w;){const C=x+w>>1;if(m[C]===p)return!0;m[C]>p?w=C-1:x=C+1}return!1})(c.properties()[s.value],l.value,0,l.value.length-1)],all:{type:Ht,overloads:[[[Ht,Ht],(c,[s,l])=>s.evaluate(c)&&l.evaluate(c)],[Rl(Ht),(c,s)=>{for(const l of s)if(!l.evaluate(c))return!1;return!0}]]},any:{type:Ht,overloads:[[[Ht,Ht],(c,[s,l])=>s.evaluate(c)||l.evaluate(c)],[Rl(Ht),(c,s)=>{for(const l of s)if(l.evaluate(c))return!0;return!1}]]},"!":[Ht,[Ht],(c,[s])=>!s.evaluate(c)],"is-supported-script":[Ht,[Jt],(c,[s])=>{const l=c.globals&&c.globals.isSupportedScript;return!l||l(s.evaluate(c))}],upcase:[Jt,[Jt],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[Jt,[Jt],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[Jt,Rl(Vt),(c,s)=>s.map((l=>Ft(l.evaluate(c)))).join("")],"resolved-locale":[Jt,[Od],(c,[s])=>s.evaluate(c).resolvedLocale()]});class og{constructor(s,l){this.expression=s,this._warningHistory={},this._evaluator=new Um,this._defaultValue=l?(function(p){if(p.type==="color"&&uh(p.default))return new Qt(0,0,0,0);switch(p.type){case"color":return Qt.parse(p.default)||null;case"padding":return jr.parse(p.default)||null;case"numberArray":return Tn.parse(p.default)||null;case"colorArray":return gr.parse(p.default)||null;case"variableAnchorOffsetCollection":return Cn.parse(p.default)||null;case"projectionDefinition":return fn.parse(p.default)||null;default:return p.default===void 0?null:p.default}})(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(s,l,p,m,x,w){return this._evaluator.globals=s,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=m,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(s,l,p,m,x,w){this._evaluator.globals=s,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=m,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new $i(`Expected value to be one of ${Object.keys(this._enumValues).map((I=>JSON.stringify(I))).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function rp(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Oc}function hh(c,s){const l=new Ac(Oc,ep,[],s?(function(m){const x={color:nn,string:Jt,number:pt,enum:Jt,boolean:Ht,formatted:Na,padding:Rd,numberArray:Ic,colorArray:wo,projectionDefinition:Cl,resolvedImage:er,variableAnchorOffsetCollection:Ld};return m.type==="array"?Fn(x[m.value]||Vt,m.length):x[m.type]})(s):void 0),p=l.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?L_(new og(p,s)):Rc(l.errors)}class dh{constructor(s,l){this.kind=s,this._styleExpression=l,this.isStateDependent=s!=="constant"&&!ch(l.expression),this.globalStateRefs=mh(l.expression)}evaluateWithoutErrorHandling(s,l,p,m,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,l,p,m,x,w)}evaluate(s,l,p,m,x,w){return this._styleExpression.evaluate(s,l,p,m,x,w)}}class ag{constructor(s,l,p,m){this.kind=s,this.zoomStops=p,this._styleExpression=l,this.isStateDependent=s!=="camera"&&!ch(l.expression),this.globalStateRefs=mh(l.expression),this.interpolationType=m}evaluateWithoutErrorHandling(s,l,p,m,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,l,p,m,x,w)}evaluate(s,l,p,m,x,w){return this._styleExpression.evaluate(s,l,p,m,x,w)}interpolationFactor(s,l,p){return this.interpolationType?sn.interpolationFactor(this.interpolationType,s,l,p):0}}function U_(c,s){const l=hh(c,s);if(l.result==="error")return l;const p=l.value.expression,m=tp(p);if(!m&&!Va(s))return Rc([new Zi("","data expressions not supported")]);const x=ip(p,["zoom"]);if(!x&&!F_(s))return Rc([new Zi("","zoom expressions not supported")]);const w=fh(p);return w||x?w instanceof Zi?Rc([w]):w instanceof sn&&!sg(s)?Rc([new Zi("",'"interpolate" expressions cannot be used with this property')]):L_(w?new ag(m?"camera":"composite",l.value,w.labels,w instanceof sn?w.interpolation:void 0):new dh(m?"constant":"source",l.value)):Rc([new Zi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ph{constructor(s,l){this._parameters=s,this._specification=l,pn(this,N_(this._parameters,this._specification))}static deserialize(s){return new ph(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function fh(c){let s=null;if(c instanceof Ju)s=fh(c.result);else if(c instanceof th){for(const l of c.args)if(s=fh(l),s)break}else(c instanceof tr||c instanceof sn)&&c.input instanceof gs&&c.input.name==="zoom"&&(s=c);return s instanceof Zi||c.eachChild((l=>{const p=fh(l);p instanceof Zi?s=p:!s&&p?s=new Zi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&p&&s!==p&&(s=new Zi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),s}function mh(c,s=new Set){return c instanceof lh&&s.add(c.key),c.eachChild((l=>{mh(l,s)})),s}function np(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!np(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const lg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ll(c){if(c==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};np(c)||(c=Fl(c));const s=hh(c,lg);if(s.result==="error")throw new Error(s.value.map((l=>`${l.key}: ${l.message}`)).join(", "));return{filter:(l,p,m)=>s.value.evaluate(l,p,{},m),needGeometry:sp(c),getGlobalStateRefs:()=>mh(s.value.expression)}}function cg(c,s){return c<s?-1:c>s?1:0}function sp(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let s=1;s<c.length;s++)if(sp(c[s]))return!0;return!1}function Fl(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?ug(c[1],c[2],"=="):s==="!="?op(ug(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?ug(c[1],c[2],s):s==="any"?(l=c.slice(1),["any"].concat(l.map(Fl))):s==="all"?["all"].concat(c.slice(1).map(Fl)):s==="none"?["all"].concat(c.slice(1).map(Fl).map(op)):s==="in"?V_(c[1],c.slice(2)):s==="!in"?op(V_(c[1],c.slice(2))):s==="has"?G_(c[1]):s!=="!has"||op(G_(c[1]));var l}function ug(c,s,l){switch(c){case"$type":return[`filter-type-${l}`,s];case"$id":return[`filter-id-${l}`,s];default:return[`filter-${l}`,c,s]}}function V_(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some((l=>typeof l!=typeof s[0]))?["filter-in-large",c,["literal",s.sort(cg)]]:["filter-in-small",c,["literal",s]]}}function G_(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function op(c){return["!",c]}function hg(c){const s=typeof c;if(s==="number"||s==="boolean"||s==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let m="[";for(const x of c)m+=`${hg(x)},`;return`${m}]`}const l=Object.keys(c).sort();let p="{";for(let m=0;m<l.length;m++)p+=`${JSON.stringify(l[m])}:${hg(c[l[m]])},`;return`${p}}`}function g2(c){let s="";for(const l of Dt)s+=`/${hg(c[l])}`;return s}function dg(c){const s=c.value;return s?[new Qe(c.key,s,"constants have been deprecated as of v8")]:[]}function Wi(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Eo(c){if(Array.isArray(c))return c.map(Eo);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const l in c)s[l]=Eo(c[l]);return s}return Wi(c)}function ys(c){const s=c.key,l=c.value,p=c.valueSpec||{},m=c.objectElementValidators||{},x=c.style,w=c.styleSpec,C=c.validateSpec;let I=[];const A=ii(l);if(A!=="object")return[new Qe(s,l,`object expected, ${A} found`)];for(const D in l){const N=D.split(".")[0],U=kc(p,N)||p["*"];let G;if(kc(m,N))G=m[N];else if(kc(p,N))G=C;else if(m["*"])G=m["*"];else{if(!p["*"]){I.push(new Qe(s,l[D],`unknown property "${D}"`));continue}G=C}I=I.concat(G({key:(s&&`${s}.`)+D,value:l[D],valueSpec:U,style:x,styleSpec:w,object:l,objectKey:D,validateSpec:C},l))}for(const D in p)m[D]||p[D].required&&p[D].default===void 0&&l[D]===void 0&&I.push(new Qe(s,l,`missing required property "${D}"`));return I}function ap(c){const s=c.value,l=c.valueSpec,p=c.style,m=c.styleSpec,x=c.key,w=c.arrayElementValidator||c.validateSpec;if(ii(s)!=="array")return[new Qe(x,s,`array expected, ${ii(s)} found`)];if(l.length&&s.length!==l.length)return[new Qe(x,s,`array length ${l.length} expected, length ${s.length} found`)];if(l["min-length"]&&s.length<l["min-length"])return[new Qe(x,s,`array length at least ${l["min-length"]} expected, length ${s.length} found`)];let C={type:l.value,values:l.values};m.$version<7&&(C.function=l.function),ii(l.value)==="object"&&(C=l.value);let I=[];for(let A=0;A<s.length;A++)I=I.concat(w({array:s,arrayIndex:A,value:s[A],valueSpec:C,validateSpec:c.validateSpec,style:p,styleSpec:m,key:`${x}[${A}]`}));return I}function gh(c){const s=c.key,l=c.value,p=c.valueSpec;let m=ii(l);return m==="number"&&l!=l&&(m="NaN"),m!=="number"?[new Qe(s,l,`number expected, ${m} found`)]:"minimum"in p&&l<p.minimum?[new Qe(s,l,`${l} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&l>p.maximum?[new Qe(s,l,`${l} is greater than the maximum value ${p.maximum}`)]:[]}function q_(c){const s=c.valueSpec,l=Wi(c.value.type);let p,m,x,w={};const C=l!=="categorical"&&c.value.property===void 0,I=!C,A=ii(c.value.stops)==="array"&&ii(c.value.stops[0])==="array"&&ii(c.value.stops[0][0])==="object",D=ys({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(G){if(l==="identity")return[new Qe(G.key,G.value,'identity function may not have a "stops" property')];let q=[];const X=G.value;return q=q.concat(ap({key:G.key,value:X,valueSpec:G.valueSpec,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:N})),ii(X)==="array"&&X.length===0&&q.push(new Qe(G.key,X,"array must have at least one stop")),q},default:function(G){return G.validateSpec({key:G.key,value:G.value,valueSpec:s,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec})}}});return l==="identity"&&C&&D.push(new Qe(c.key,c.value,'missing required property "property"')),l==="identity"||c.value.stops||D.push(new Qe(c.key,c.value,'missing required property "stops"')),l==="exponential"&&c.valueSpec.expression&&!sg(c.valueSpec)&&D.push(new Qe(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(I&&!Va(c.valueSpec)?D.push(new Qe(c.key,c.value,"property functions not supported")):C&&!F_(c.valueSpec)&&D.push(new Qe(c.key,c.value,"zoom functions not supported"))),l!=="categorical"&&!A||c.value.property!==void 0||D.push(new Qe(c.key,c.value,'"property" property is required')),D;function N(G){let q=[];const X=G.value,Q=G.key;if(ii(X)!=="array")return[new Qe(Q,X,`array expected, ${ii(X)} found`)];if(X.length!==2)return[new Qe(Q,X,`array length 2 expected, length ${X.length} found`)];if(A){if(ii(X[0])!=="object")return[new Qe(Q,X,`object expected, ${ii(X[0])} found`)];if(X[0].zoom===void 0)return[new Qe(Q,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new Qe(Q,X,"object stop key must have value")];if(x&&x>Wi(X[0].zoom))return[new Qe(Q,X[0].zoom,"stop zoom values must appear in ascending order")];Wi(X[0].zoom)!==x&&(x=Wi(X[0].zoom),m=void 0,w={}),q=q.concat(ys({key:`${Q}[0]`,value:X[0],valueSpec:{zoom:{}},validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:gh,value:U}}))}else q=q.concat(U({key:`${Q}[0]`,value:X[0],validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec},X));return rp(Eo(X[1]))?q.concat([new Qe(`${Q}[1]`,X[1],"expressions are not allowed in function stops.")]):q.concat(G.validateSpec({key:`${Q}[1]`,value:X[1],valueSpec:s,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec}))}function U(G,q){const X=ii(G.value),Q=Wi(G.value),ne=G.value!==null?G.value:q;if(p){if(X!==p)return[new Qe(G.key,ne,`${X} stop domain type must match previous stop domain type ${p}`)]}else p=X;if(X!=="number"&&X!=="string"&&X!=="boolean")return[new Qe(G.key,ne,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&l!=="categorical"){let ye=`number expected, ${X} found`;return Va(s)&&l===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Qe(G.key,ne,ye)]}return l!=="categorical"||X!=="number"||isFinite(Q)&&Math.floor(Q)===Q?l!=="categorical"&&X==="number"&&m!==void 0&&Q<m?[new Qe(G.key,ne,"stop domain values must appear in ascending order")]:(m=Q,l==="categorical"&&Q in w?[new Qe(G.key,ne,"stop domain values must be unique")]:(w[Q]=!0,[])):[new Qe(G.key,ne,`integer expected, found ${Q}`)]}}function Nl(c){const s=(c.expressionContext==="property"?U_:hh)(Eo(c.value),c.valueSpec);if(s.result==="error")return s.value.map((p=>new Qe(`${c.key}${p.key}`,c.value,p.message)));const l=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!l.outputDefined())return[new Qe(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!ch(l))return[new Qe(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!ch(l))return[new Qe(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!ip(l,["zoom","feature-state"]))return[new Qe(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!tp(l))return[new Qe(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function lp(c){const s=c.key,l=c.value,p=ii(l);return p!=="string"?[new Qe(s,l,`color expected, ${p} found`)]:Qt.parse(String(l))?[]:[new Qe(s,l,`color expected, "${l}" found`)]}function Xo(c){const s=c.key,l=c.value,p=c.valueSpec,m=[];return Array.isArray(p.values)?p.values.indexOf(Wi(l))===-1&&m.push(new Qe(s,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(Wi(l))===-1&&m.push(new Qe(s,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),m}function pg(c){return np(Eo(c.value))?Nl(pn({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):H_(c)}function H_(c){const s=c.value,l=c.key;if(ii(s)!=="array")return[new Qe(l,s,`array expected, ${ii(s)} found`)];const p=c.styleSpec;let m,x=[];if(s.length<1)return[new Qe(l,s,"filter array must have at least 1 element")];switch(x=x.concat(Xo({key:`${l}[0]`,value:s[0],valueSpec:p.filter_operator,style:c.style,styleSpec:c.styleSpec})),Wi(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&Wi(s[1])==="$type"&&x.push(new Qe(l,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&x.push(new Qe(l,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(m=ii(s[1]),m!=="string"&&x.push(new Qe(`${l}[1]`,s[1],`string expected, ${m} found`)));for(let w=2;w<s.length;w++)m=ii(s[w]),Wi(s[1])==="$type"?x=x.concat(Xo({key:`${l}[${w}]`,value:s[w],valueSpec:p.geometry_type,style:c.style,styleSpec:c.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&x.push(new Qe(`${l}[${w}]`,s[w],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let w=1;w<s.length;w++)x=x.concat(H_({key:`${l}[${w}]`,value:s[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":m=ii(s[1]),s.length!==2?x.push(new Qe(l,s,`filter array for "${s[0]}" operator must have 2 elements`)):m!=="string"&&x.push(new Qe(`${l}[1]`,s[1],`string expected, ${m} found`))}return x}function Z_(c,s){const l=c.key,p=c.validateSpec,m=c.style,x=c.styleSpec,w=c.value,C=c.objectKey,I=x[`${s}_${c.layerType}`];if(!I)return[];const A=C.match(/^(.*)-transition$/);if(s==="paint"&&A&&I[A[1]]&&I[A[1]].transition)return p({key:l,value:w,valueSpec:x.transition,style:m,styleSpec:x});const D=c.valueSpec||I[C];if(!D)return[new Qe(l,w,`unknown property "${C}"`)];let N;if(ii(w)==="string"&&Va(D)&&!D.tokens&&(N=/^{([^}]+)}$/.exec(w)))return[new Qe(l,w,`"${C}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const U=[];return c.layerType==="symbol"&&(C==="text-field"&&m&&!m.glyphs&&U.push(new Qe(l,w,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&uh(Eo(w))&&Wi(w.type)==="identity"&&U.push(new Qe(l,w,'"text-font" does not support identity functions'))),U.concat(p({key:c.key,value:w,valueSpec:D,style:m,styleSpec:x,expressionContext:"property",propertyType:s,propertyKey:C}))}function W_(c){return Z_(c,"paint")}function Y_(c){return Z_(c,"layout")}function X_(c){let s=[];const l=c.value,p=c.key,m=c.style,x=c.styleSpec;if(ii(l)!=="object")return[new Qe(p,l,`object expected, ${ii(l)} found`)];l.type||l.ref||s.push(new Qe(p,l,'either "type" or "ref" is required'));let w=Wi(l.type);const C=Wi(l.ref);if(l.id){const I=Wi(l.id);for(let A=0;A<c.arrayIndex;A++){const D=m.layers[A];Wi(D.id)===I&&s.push(new Qe(p,l.id,`duplicate layer id "${l.id}", previously used at line ${D.id.__line__}`))}}if("ref"in l){let I;["type","source","source-layer","filter","layout"].forEach((A=>{A in l&&s.push(new Qe(p,l[A],`"${A}" is prohibited for ref layers`))})),m.layers.forEach((A=>{Wi(A.id)===C&&(I=A)})),I?I.ref?s.push(new Qe(p,l.ref,"ref cannot reference another ref layer")):w=Wi(I.type):s.push(new Qe(p,l.ref,`ref layer "${C}" not found`))}else if(w!=="background")if(l.source){const I=m.sources&&m.sources[l.source],A=I&&Wi(I.type);I?A==="vector"&&w==="raster"?s.push(new Qe(p,l.source,`layer "${l.id}" requires a raster source`)):A!=="raster-dem"&&w==="hillshade"||A!=="raster-dem"&&w==="color-relief"?s.push(new Qe(p,l.source,`layer "${l.id}" requires a raster-dem source`)):A==="raster"&&w!=="raster"?s.push(new Qe(p,l.source,`layer "${l.id}" requires a vector source`)):A!=="vector"||l["source-layer"]?A==="raster-dem"&&w!=="hillshade"&&w!=="color-relief"?s.push(new Qe(p,l.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):w!=="line"||!l.paint||!l.paint["line-gradient"]||A==="geojson"&&I.lineMetrics||s.push(new Qe(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Qe(p,l,`layer "${l.id}" must specify a "source-layer"`)):s.push(new Qe(p,l.source,`source "${l.source}" not found`))}else s.push(new Qe(p,l,'missing required property "source"'));return s=s.concat(ys({key:p,value:l,valueSpec:x.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${p}.type`,value:l.type,valueSpec:x.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:l,objectKey:"type"}),filter:pg,layout:I=>ys({layer:l,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":A=>Y_(pn({layerType:w},A))}}),paint:I=>ys({layer:l,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":A=>W_(pn({layerType:w},A))}})}})),s}function Bs(c){const s=c.value,l=c.key,p=ii(s);return p!=="string"?[new Qe(l,s,`string expected, ${p} found`)]:[]}const Lc={promoteId:function({key:c,value:s}){if(ii(s)==="string")return Bs({key:c,value:s});{const l=[];for(const p in s)l.push(...Bs({key:`${c}.${p}`,value:s[p]}));return l}}};function Nn(c){const s=c.value,l=c.key,p=c.styleSpec,m=c.style,x=c.validateSpec;if(!s.type)return[new Qe(l,s,'"type" is required')];const w=Wi(s.type);let C;switch(w){case"vector":case"raster":return C=ys({key:l,value:s,valueSpec:p[`source_${w.replace("-","_")}`],style:c.style,styleSpec:p,objectElementValidators:Lc,validateSpec:x}),C;case"raster-dem":return C=(function(I){var A;const D=(A=I.sourceName)!==null&&A!==void 0?A:"",N=I.value,U=I.styleSpec,G=U.source_raster_dem,q=I.style;let X=[];const Q=ii(N);if(N===void 0)return X;if(Q!=="object")return X.push(new Qe("source_raster_dem",N,`object expected, ${Q} found`)),X;const ne=Wi(N.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],ue=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const de in N)!ne&&ye.includes(de)?X.push(new Qe(de,N[de],`In "${D}": "${de}" is only valid when "encoding" is set to "custom". ${ue} encoding found`)):G[de]?X=X.concat(I.validateSpec({key:de,value:N[de],valueSpec:G[de],validateSpec:I.validateSpec,style:q,styleSpec:U})):X.push(new Qe(de,N[de],`unknown property "${de}"`));return X})({sourceName:l,value:s,style:c.style,styleSpec:p,validateSpec:x}),C;case"geojson":if(C=ys({key:l,value:s,valueSpec:p.source_geojson,style:m,styleSpec:p,validateSpec:x,objectElementValidators:Lc}),s.cluster)for(const I in s.clusterProperties){const[A,D]=s.clusterProperties[I],N=typeof A=="string"?[A,["accumulated"],["get",I]]:A;C.push(...Nl({key:`${l}.${I}.map`,value:D,expressionContext:"cluster-map"})),C.push(...Nl({key:`${l}.${I}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return C;case"video":return ys({key:l,value:s,valueSpec:p.source_video,style:m,validateSpec:x,styleSpec:p});case"image":return ys({key:l,value:s,valueSpec:p.source_image,style:m,validateSpec:x,styleSpec:p});case"canvas":return[new Qe(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xo({key:`${l}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Fc(c){const s=c.value,l=c.styleSpec,p=l.light,m=c.style;let x=[];const w=ii(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new Qe("light",s,`object expected, ${w} found`)]),x;for(const C in s){const I=C.match(/^(.*)-transition$/);x=x.concat(I&&p[I[1]]&&p[I[1]].transition?c.validateSpec({key:C,value:s[C],valueSpec:l.transition,validateSpec:c.validateSpec,style:m,styleSpec:l}):p[C]?c.validateSpec({key:C,value:s[C],valueSpec:p[C],validateSpec:c.validateSpec,style:m,styleSpec:l}):[new Qe(C,s[C],`unknown property "${C}"`)])}return x}function fg(c){const s=c.value,l=c.styleSpec,p=l.sky,m=c.style,x=ii(s);if(s===void 0)return[];if(x!=="object")return[new Qe("sky",s,`object expected, ${x} found`)];let w=[];for(const C in s)w=w.concat(p[C]?c.validateSpec({key:C,value:s[C],valueSpec:p[C],style:m,styleSpec:l}):[new Qe(C,s[C],`unknown property "${C}"`)]);return w}function J_(c){const s=c.value,l=c.styleSpec,p=l.terrain,m=c.style;let x=[];const w=ii(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new Qe("terrain",s,`object expected, ${w} found`)]),x;for(const C in s)x=x.concat(p[C]?c.validateSpec({key:C,value:s[C],valueSpec:p[C],validateSpec:c.validateSpec,style:m,styleSpec:l}):[new Qe(C,s[C],`unknown property "${C}"`)]);return x}function K_(c){let s=[];const l=c.value,p=c.key;if(Array.isArray(l)){const m=[],x=[];for(const w in l)l[w].id&&m.includes(l[w].id)&&s.push(new Qe(p,l,`all the sprites' ids must be unique, but ${l[w].id} is duplicated`)),m.push(l[w].id),l[w].url&&x.includes(l[w].url)&&s.push(new Qe(p,l,`all the sprites' URLs must be unique, but ${l[w].url} is duplicated`)),x.push(l[w].url),s=s.concat(ys({key:`${p}[${w}]`,value:l[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return s}return Bs({key:p,value:l})}function Nc(c){return s=c.value,s&&s.constructor===Object?[]:[new Qe(c.key,c.value,`object expected, ${ii(c.value)} found`)];var s}const mg={"*":()=>[],array:ap,boolean:function(c){const s=c.value,l=c.key,p=ii(s);return p!=="boolean"?[new Qe(l,s,`boolean expected, ${p} found`)]:[]},number:gh,color:lp,constants:dg,enum:Xo,filter:pg,function:q_,layer:X_,object:ys,source:Nn,light:Fc,sky:fg,terrain:J_,projection:function(c){const s=c.value,l=c.styleSpec,p=l.projection,m=c.style,x=ii(s);if(s===void 0)return[];if(x!=="object")return[new Qe("projection",s,`object expected, ${x} found`)];let w=[];for(const C in s)w=w.concat(p[C]?c.validateSpec({key:C,value:s[C],valueSpec:p[C],style:m,styleSpec:l}):[new Qe(C,s[C],`unknown property "${C}"`)]);return w},projectionDefinition:function(c){const s=c.key;let l=c.value;l=l instanceof String?l.valueOf():l;const p=ii(l);return p!=="array"||(function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"})(l)||(function(m){return!!["interpolate","step","literal"].includes(m[0])})(l)?["array","string"].includes(p)?[]:[new Qe(s,l,`projection expected, invalid type "${p}" found`)]:[new Qe(s,l,`projection expected, invalid array ${JSON.stringify(l)} found`)]},string:Bs,formatted:function(c){return Bs(c).length===0?[]:Nl(c)},resolvedImage:function(c){return Bs(c).length===0?[]:Nl(c)},padding:function(c){const s=c.key,l=c.value;if(ii(l)==="array"){if(l.length<1||l.length>4)return[new Qe(s,l,`padding requires 1 to 4 values; ${l.length} values found`)];const p={type:"number"};let m=[];for(let x=0;x<l.length;x++)m=m.concat(c.validateSpec({key:`${s}[${x}]`,value:l[x],validateSpec:c.validateSpec,valueSpec:p}));return m}return gh({key:s,value:l,valueSpec:{}})},numberArray:function(c){const s=c.key,l=c.value;if(ii(l)==="array"){const p={type:"number"};if(l.length<1)return[new Qe(s,l,"array length at least 1 expected, length 0 found")];let m=[];for(let x=0;x<l.length;x++)m=m.concat(c.validateSpec({key:`${s}[${x}]`,value:l[x],validateSpec:c.validateSpec,valueSpec:p}));return m}return gh({key:s,value:l,valueSpec:{}})},colorArray:function(c){const s=c.key,l=c.value;if(ii(l)==="array"){if(l.length<1)return[new Qe(s,l,"array length at least 1 expected, length 0 found")];let p=[];for(let m=0;m<l.length;m++)p=p.concat(lp({key:`${s}[${m}]`,value:l[m]}));return p}return lp({key:s,value:l})},variableAnchorOffsetCollection:function(c){const s=c.key,l=c.value,p=ii(l),m=c.styleSpec;if(p!=="array"||l.length<1||l.length%2!=0)return[new Qe(s,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let w=0;w<l.length;w+=2)x=x.concat(Xo({key:`${s}[${w}]`,value:l[w],valueSpec:m.layout_symbol["text-anchor"]})),x=x.concat(ap({key:`${s}[${w+1}]`,value:l[w+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:m}));return x},sprite:K_,state:Nc};function Bc(c){const s=c.value,l=c.valueSpec,p=c.styleSpec;return c.validateSpec=Bc,l.expression&&uh(Wi(s))?q_(c):l.expression&&rp(Eo(s))?Nl(c):l.type&&mg[l.type]?mg[l.type](c):ys(pn({},c,{valueSpec:l.type?p[l.type]:l}))}function Q_(c){const s=c.value,l=c.key,p=Bs(c);return p.length||(s.indexOf("{fontstack}")===-1&&p.push(new Qe(l,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&p.push(new Qe(l,s,'"glyphs" url must include a "{range}" token'))),p}function Bn(c,s=Te){let l=[];return l=l.concat(Bc({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,validateSpec:Bc,objectElementValidators:{glyphs:Q_,"*":()=>[]}})),c.constants&&(l=l.concat(dg({key:"constants",value:c.constants}))),jc(l)}function js(c){return function(s){return c({...s,validateSpec:Bc})}}function jc(c){return[].concat(c).sort(((s,l)=>s.line-l.line))}function Us(c){return function(...s){return jc(c.apply(this,s))}}Bn.source=Us(js(Nn)),Bn.sprite=Us(js(K_)),Bn.glyphs=Us(js(Q_)),Bn.light=Us(js(Fc)),Bn.sky=Us(js(fg)),Bn.terrain=Us(js(J_)),Bn.state=Us(js(Nc)),Bn.layer=Us(js(X_)),Bn.filter=Us(js(pg)),Bn.paintProperty=Us(js(W_)),Bn.layoutProperty=Us(js(Y_));const Uc=Bn,y2=Uc.light,yh=Uc.sky,_2=Uc.paintProperty,v2=Uc.layoutProperty;function _h(c,s){let l=!1;if(s&&s.length)for(const p of s)c.fire(new qe(new Error(p.message))),l=!0;return l}class vh{constructor(s,l,p){const m=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const w=new Int32Array(this.arrayBuffer);s=w[0],this.d=(l=w[1])+2*(p=w[2]);for(let I=0;I<this.d*this.d;I++){const A=w[3+I],D=w[3+I+1];m.push(A===D?null:w.subarray(A,D))}const C=w[3+m.length+1];this.keys=w.subarray(w[3+m.length],C),this.bboxes=w.subarray(C),this.insert=this._insertReadonly}else{this.d=l+2*p;for(let w=0;w<this.d*this.d;w++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=s,this.padding=p,this.scale=l/s,this.uid=0;const x=p/l*s;this.min=-x,this.max=s+x}insert(s,l,p,m,x){this._forEachCell(l,p,m,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(m),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,l,p,m,x,w){this.cells[x].push(w)}query(s,l,p,m,x){const w=this.min,C=this.max;if(s<=w&&l<=w&&C<=p&&C<=m&&!x)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(s,l,p,m,this._queryCell,I,{},x),I}}_queryCell(s,l,p,m,x,w,C,I){const A=this.cells[x];if(A!==null){const D=this.keys,N=this.bboxes;for(let U=0;U<A.length;U++){const G=A[U];if(C[G]===void 0){const q=4*G;(I?I(N[q+0],N[q+1],N[q+2],N[q+3]):s<=N[q+2]&&l<=N[q+3]&&p>=N[q+0]&&m>=N[q+1])?(C[G]=!0,w.push(D[G])):C[G]=!1}}}}_forEachCell(s,l,p,m,x,w,C,I){const A=this._convertToCellCoord(s),D=this._convertToCellCoord(l),N=this._convertToCellCoord(p),U=this._convertToCellCoord(m);for(let G=A;G<=N;G++)for(let q=D;q<=U;q++){const X=this.d*q+G;if((!I||I(this._convertFromCellCoord(G),this._convertFromCellCoord(q),this._convertFromCellCoord(G+1),this._convertFromCellCoord(q+1)))&&x.call(this,s,l,p,m,X,w,C,I))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,l=3+this.cells.length+1+1;let p=0;for(let w=0;w<this.cells.length;w++)p+=this.cells[w].length;const m=new Int32Array(l+p+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let x=l;for(let w=0;w<s.length;w++){const C=s[w];m[3+w]=x,m.set(C,x),x+=C.length}return m[3+s.length]=x,m.set(this.keys,x),x+=this.keys.length,m[3+s.length+1]=x,m.set(this.bboxes,x),x+=this.bboxes.length,m.buffer}static serialize(s,l){const p=s.toArrayBuffer();return l&&l.push(p),{buffer:p}}static deserialize(s){return new vh(s.buffer)}}const Vs={};function ft(c,s,l={}){if(Vs[c])throw new Error(`${c} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:c,writeable:!1}),Vs[c]={klass:s,omit:l.omit||[],shallow:l.shallow||[]}}ft("Object",Object),ft("Set",Set),ft("TransferableGridIndex",vh),ft("Color",Qt),ft("Error",Error),ft("AJAXError",le),ft("ResolvedImage",ts),ft("StylePropertyFunction",ph),ft("StyleExpression",og,{omit:["_evaluator"]}),ft("ZoomDependentExpression",ag),ft("ZoomConstantExpression",dh),ft("CompoundExpression",gs,{omit:["_evaluate"]});for(const c in Oc)Oc[c]._classRegistryKey||ft(`Expression_${c}`,Oc[c]);function gg(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function cp(c){return c.$name||c.constructor._classRegistryKey}function yg(c){return!(function(s){if(s===null||typeof s!="object")return!1;const l=cp(s);return!(!l||l==="Object")})(c)&&(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||c instanceof Error||gg(c)||bo(c)||ArrayBuffer.isView(c)||c instanceof ImageData)}function Vc(c,s){if(yg(c))return(gg(c)||bo(c))&&s&&s.push(c),ArrayBuffer.isView(c)&&s&&s.push(c.buffer),c instanceof ImageData&&s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const x=[];for(const w of c)x.push(Vc(w,s));return x}if(typeof c!="object")throw new Error("can't serialize object of type "+typeof c);const l=cp(c);if(!l)throw new Error(`can't serialize object of unregistered class ${c.constructor.name}`);if(!Vs[l])throw new Error(`${l} is not registered.`);const{klass:p}=Vs[l],m=p.serialize?p.serialize(c,s):{};if(p.serialize){if(s&&m===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in c){if(!c.hasOwnProperty(x)||Vs[l].omit.indexOf(x)>=0)continue;const w=c[x];m[x]=Vs[l].shallow.indexOf(x)>=0?w:Vc(w,s)}c instanceof Error&&(m.message=c.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(m.$name=l),m}function Bl(c){if(yg(c))return c;if(Array.isArray(c))return c.map(Bl);if(typeof c!="object")throw new Error("can't deserialize object of type "+typeof c);const s=cp(c)||"Object";if(!Vs[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:l}=Vs[s];if(!l)throw new Error(`can't deserialize unregistered class ${s}`);if(l.deserialize)return l.deserialize(c);const p=Object.create(l.prototype);for(const m of Object.keys(c)){if(m==="$name")continue;const x=c[m];p[m]=Vs[s].shallow.indexOf(m)>=0?x:Bl(x)}return p}class up{constructor(){this.first=!0}update(s,l){const p=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=l),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=p,!0))}}const ni={"Latin-1 Supplement":c=>c>=128&&c<=255,"Hangul Jamo":c=>c>=4352&&c<=4607,Khmer:c=>c>=6016&&c<=6143,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Kanbun:c=>c>=12688&&c<=12703,"CJK Strokes":c=>c>=12736&&c<=12783,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Hangul Syllables":c=>c>=44032&&c<=55215,"Private Use Area":c=>c>=57344&&c<=63743,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function hp(c){for(const s of c)if(vg(s.charCodeAt(0)))return!0;return!1}function b2(c){for(const s of c)if(!ev(s.charCodeAt(0)))return!1;return!0}function dp(c){const s=c.map((l=>{try{return new RegExp(`\\p{sc=${l}}`,"u").source}catch{return null}})).filter((l=>l));return new RegExp(s.join("|"),"u")}const x2=dp(["Arab","Dupl","Mong","Ougr","Syrc"]);function ev(c){return!x2.test(String.fromCodePoint(c))}const _g=dp(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function vg(c){return!(c!==746&&c!==747&&(c<4352||!(ni["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||ni["CJK Compatibility"](c)||ni["CJK Strokes"](c)||!(!ni["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||ni["Enclosed CJK Letters and Months"](c)||ni["Ideographic Description Characters"](c)||ni.Kanbun(c)||ni.Katakana(c)&&c!==12540||!(!ni["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!ni["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||ni["Vertical Forms"](c)||ni["Yijing Hexagram Symbols"](c)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(c))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(c))||_g.test(String.fromCodePoint(c)))))}function tv(c){return!(vg(c)||(function(s){return!!(ni["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||ni["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||ni["Letterlike Symbols"](s)||ni["Number Forms"](s)||ni["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||ni["Control Pictures"](s)&&s!==9251||ni["Optical Character Recognition"](s)||ni["Enclosed Alphanumerics"](s)||ni["Geometric Shapes"](s)||ni["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||ni["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||ni["CJK Symbols and Punctuation"](s)||ni.Katakana(s)||ni["Private Use Area"](s)||ni["CJK Compatibility Forms"](s)||ni["Small Form Variants"](s)||ni["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)})(c))}const iv=dp(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function bg(c){return iv.test(String.fromCodePoint(c))}function rv(c,s){return!(!s&&bg(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||ni.Khmer(c))}function nv(c){for(const s of c)if(bg(s.charCodeAt(0)))return!0;return!1}const Gs=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(c){this.pluginStatus=c.pluginStatus,this.pluginURL=c.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(c){if(Gs.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=c.applyArabicShaping,this.processBidirectionalText=c.processBidirectionalText,this.processStyledBidirectionalText=c.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(c,s){return a(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(c.pluginStatus!=="loading")return this.setState(c),c;const l=c.pluginURL,p=new Promise((x=>{this.loadScriptResolve=x}));s(l);const m=new Promise((x=>setTimeout((()=>x()),this.TIMEOUT)));if(yield Promise.race([p,m]),this.isParsed()){const x={pluginStatus:"loaded",pluginURL:l};return this.setState(x),x}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${l}`)}))}};class Pi{constructor(s,l){this.zoom=s,l?(this.now=l.now||0,this.fadeDuration=l.fadeDuration||0,this.zoomHistory=l.zoomHistory||new up,this.transition=l.transition||{},this.globalState=l.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new up,this.transition={},this.globalState={})}isSupportedScript(s){return(function(l,p){for(const m of l)if(!rv(m.charCodeAt(0),p))return!1;return!0})(s,Gs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,l=s-Math.floor(s),p=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*l}}}class Gc{constructor(s,l){this.property=s,this.value=l,this.expression=(function(p,m){if(uh(p))return new ph(p,m);if(rp(p)){const x=U_(p,m);if(x.result==="error")throw new Error(x.value.map((w=>`${w.key}: ${w.message}`)).join(", "));return x.value}{let x=p;return m.type==="color"&&typeof p=="string"?x=Qt.parse(p):m.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?m.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?m.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?x=Cn.parse(p):m.type==="projectionDefinition"&&typeof p=="string"&&(x=fn.parse(p)):x=gr.parse(p):x=Tn.parse(p):x=jr.parse(p),{globalStateRefs:new Set,kind:"constant",evaluate:()=>x}}})(l===void 0?s.specification.default:l,s.specification),this._evaluate=this.expression.evaluate}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(s,l,p){return this.property.possiblyEvaluate(this,s,l,p)}setGlobalState(s){this.expression.evaluate=(l,p,m,x,w,C)=>(l.globalState=s,this._evaluate.call(this.expression,l,p,m,x,w,C))}}class xg{constructor(s){this.property=s,this.value=new Gc(s,void 0)}transitioned(s,l){return new wg(this.property,this.value,l,dn({},s.transition,this.transition),s.now)}untransitioned(){return new wg(this.property,this.value,null,{},0)}}class sv{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return es(this._values[s].value.value)}setValue(s,l){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new xg(this._values[s].property)),this._values[s].value=new Gc(this._values[s].property,l===null?void 0:es(l))}getTransition(s){return es(this._values[s].transition)}setTransition(s,l){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new xg(this._values[s].property)),this._values[s].transition=es(l)||void 0}serialize(){const s={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(s[l]=p);const m=this.getTransition(l);m!==void 0&&(s[`${l}-transition`]=m)}return s}transitioned(s,l){const p=new Sg(this._properties);for(const m of Object.keys(this._values))p._values[m]=this._values[m].transitioned(s,l._values[m]);return p}untransitioned(){const s=new Sg(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].untransitioned();return s}}class wg{constructor(s,l,p,m,x){this.property=s,this.value=l,this.begin=x+m.delay||0,this.end=this.begin+m.duration||0,s.specification.transition&&(m.delay||m.duration)&&(this.prior=p)}possiblyEvaluate(s,l,p){const m=s.now||0,x=this.value.possiblyEvaluate(s,l,p),w=this.prior;if(w){if(m>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(m<this.begin)return w.possiblyEvaluate(s,l,p);{const C=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(s,l,p),x,hn(C))}}return x}}class Sg{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,l,p){const m=new pp(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].possiblyEvaluate(s,l,p);return m}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class ov{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues),this._globalState={}}hasValue(s){return this._values[s].value!==void 0}getValue(s){return es(this._values[s].value)}setValue(s,l){this._values[s]=new Gc(this._values[s].property,l===null?void 0:es(l)),this._values[s].setGlobalState(this._globalState)}serialize(){const s={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(s[l]=p)}return s}possiblyEvaluate(s,l,p){const m=new pp(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].possiblyEvaluate(s,l,p);return m}setGlobalState(s){this._globalState=s;for(const l of Object.values(this._values))l.setGlobalState(s)}}class Io{constructor(s,l,p){this.property=s,this.value=l,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,l,p,m){return this.property.evaluate(this.value,this.parameters,s,l,p,m)}}class pp{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Tt{constructor(s){this.specification=s}possiblyEvaluate(s,l){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(l)}interpolate(s,l,p){const m=Co[this.specification.type];return m?m(s,l,p):s}}class Pt{constructor(s,l){this.specification=s,this.overrides=l}possiblyEvaluate(s,l,p,m){return new Io(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(l,null,{},p,m)}:s.expression,l)}interpolate(s,l,p){if(s.value.kind!=="constant"||l.value.kind!=="constant")return s;if(s.value.value===void 0||l.value.value===void 0)return new Io(this,{kind:"constant",value:void 0},s.parameters);const m=Co[this.specification.type];if(m){const x=m(s.value.value,l.value.value,p);return new Io(this,{kind:"constant",value:x},s.parameters)}return s}evaluate(s,l,p,m,x,w){return s.kind==="constant"?s.value:s.evaluate(l,p,m,x,w)}}class fp extends Pt{possiblyEvaluate(s,l,p,m){if(s.value===void 0)return new Io(this,{kind:"constant",value:void 0},l);if(s.expression.kind==="constant"){const x=s.expression.evaluate(l,null,{},p,m),w=s.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,C=this._calculate(w,w,w,l);return new Io(this,{kind:"constant",value:C},l)}if(s.expression.kind==="camera"){const x=this._calculate(s.expression.evaluate({zoom:l.zoom-1}),s.expression.evaluate({zoom:l.zoom}),s.expression.evaluate({zoom:l.zoom+1}),l);return new Io(this,{kind:"constant",value:x},l)}return new Io(this,s.expression,l)}evaluate(s,l,p,m,x,w){if(s.kind==="source"){const C=s.evaluate(l,p,m,x,w);return this._calculate(C,C,C,l)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(l.zoom)-1},p,m),s.evaluate({zoom:Math.floor(l.zoom)},p,m),s.evaluate({zoom:Math.floor(l.zoom)+1},p,m),l):s.value}_calculate(s,l,p,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:p,to:l}}interpolate(s){return s}}class qa{constructor(s){this.specification=s}possiblyEvaluate(s,l,p,m){if(s.value!==void 0){if(s.expression.kind==="constant"){const x=s.expression.evaluate(l,null,{},p,m);return this._calculate(x,x,x,l)}return this._calculate(s.expression.evaluate(new Pi(Math.floor(l.zoom-1),l)),s.expression.evaluate(new Pi(Math.floor(l.zoom),l)),s.expression.evaluate(new Pi(Math.floor(l.zoom+1),l)),l)}}_calculate(s,l,p,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:p,to:l}}interpolate(s){return s}}class mp{constructor(s){this.specification=s}possiblyEvaluate(s,l,p,m){return!!s.expression.evaluate(l,null,{},p,m)}interpolate(){return!1}}class En{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in s){const p=s[l];p.specification.overridable&&this.overridableProperties.push(l);const m=this.defaultPropertyValues[l]=new Gc(p,void 0),x=this.defaultTransitionablePropertyValues[l]=new xg(p);this.defaultTransitioningPropertyValues[l]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}}}ft("DataDrivenProperty",Pt),ft("DataConstantProperty",Tt),ft("CrossFadedDataDrivenProperty",fp),ft("CrossFadedProperty",qa),ft("ColorRampProperty",mp);const av="-transition";class _s extends St{constructor(s,l){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,this._globalState={},s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter,this._featureFilter=Ll(s.filter)),l.layout&&(this._unevaluatedLayout=new ov(l.layout)),l.paint)){this._transitionablePaint=new sv(l.paint);for(const p in s.paint)this.setPaintProperty(p,s.paint[p],{validate:!1});for(const p in s.layout)this.setLayoutProperty(p,s.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pp(l.paint)}}setFilter(s){this.filter=s,this._featureFilter=Ll(s)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}getLayoutAffectingGlobalStateRefs(){const s=new Set;if(this._unevaluatedLayout)for(const l in this._unevaluatedLayout._values){const p=this._unevaluatedLayout._values[l];for(const m of p.getGlobalStateRefs())s.add(m)}for(const l of this._featureFilter.getGlobalStateRefs())s.add(l);return s}getPaintAffectingGlobalStateRefs(){var s;const l=new globalThis.Map;if(this._transitionablePaint)for(const p in this._transitionablePaint._values){const m=this._transitionablePaint._values[p].value;for(const x of m.getGlobalStateRefs()){const w=(s=l.get(x))!==null&&s!==void 0?s:[];w.push({name:p,value:m.value}),l.set(x,w)}}return l}setLayoutProperty(s,l,p={}){l!=null&&this._validate(v2,`layers.${this.id}.layout.${s}`,s,l,p)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,l):this.visibility=l)}getPaintProperty(s){return s.endsWith(av)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,l,p={}){if(l!=null&&this._validate(_2,`layers.${this.id}.paint.${s}`,s,l,p))return!1;if(s.endsWith(av))return this._transitionablePaint.setTransition(s.slice(0,-11),l||void 0),!1;{const m=this._transitionablePaint._values[s],x=m.property.specification["property-type"]==="cross-faded-data-driven",w=m.value.isDataDriven(),C=m.value;this._transitionablePaint.setValue(s,l),this._handleSpecialPaintPropertyUpdate(s);const I=this._transitionablePaint._values[s].value;return I.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(s,C,I)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,l,p){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,l){s.globalState=this._globalState,s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,l)}setGlobalState(s){this._globalState=s,this._unevaluatedLayout&&this._unevaluatedLayout.setGlobalState(s)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),Sc(s,((l,p)=>!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length)))}_validate(s,l,p,m,x={}){return(!x||x.validate!==!1)&&_h(this,s.call(Uc,{key:l,layerType:this.type,objectKey:p,value:m,styleSpec:Te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const l=this.paint.get(s);if(l instanceof Io&&Va(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const w2={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class bh{constructor(s,l){this._structArray=s,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Si{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,l){return s._trim(),l&&(s.isTransferred=!0,l.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const l=Object.create(this.prototype);return l.arrayBuffer=s.arrayBuffer,l.length=s.length,l.capacity=s.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ir(c,s=1){let l=0,p=0;return{members:c.map((m=>{const x=w2[m.type].BYTES_PER_ELEMENT,w=l=gp(l,Math.max(s,x)),C=m.components||1;return p=Math.max(p,x),l+=x*C,{name:m.name,type:m.type,components:C,offset:w}})),size:gp(l,Math.max(p,s)),alignment:s}}function gp(c,s){return Math.ceil(c/s)*s}class qc extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const m=2*s;return this.int16[m+0]=l,this.int16[m+1]=p,s}}qc.prototype.bytesPerElement=4,ft("StructArrayLayout2i4",qc);class Hc extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=3*s;return this.int16[x+0]=l,this.int16[x+1]=p,this.int16[x+2]=m,s}}Hc.prototype.bytesPerElement=6,ft("StructArrayLayout3i6",Hc);class Tg extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m){const x=this.length;return this.resize(x+1),this.emplace(x,s,l,p,m)}emplace(s,l,p,m,x){const w=4*s;return this.int16[w+0]=l,this.int16[w+1]=p,this.int16[w+2]=m,this.int16[w+3]=x,s}}Tg.prototype.bytesPerElement=8,ft("StructArrayLayout4i8",Tg);class Zc extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,p,m,x,w)}emplace(s,l,p,m,x,w,C){const I=6*s;return this.int16[I+0]=l,this.int16[I+1]=p,this.int16[I+2]=m,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=C,s}}Zc.prototype.bytesPerElement=12,ft("StructArrayLayout2i4i12",Zc);class jl extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,p,m,x,w)}emplace(s,l,p,m,x,w,C){const I=4*s,A=8*s;return this.int16[I+0]=l,this.int16[I+1]=p,this.uint8[A+4]=m,this.uint8[A+5]=x,this.uint8[A+6]=w,this.uint8[A+7]=C,s}}jl.prototype.bytesPerElement=8,ft("StructArrayLayout2i4ub8",jl);class xh extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const m=2*s;return this.float32[m+0]=l,this.float32[m+1]=p,s}}xh.prototype.bytesPerElement=8,ft("StructArrayLayout2f8",xh);class yp extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A,D){const N=this.length;return this.resize(N+1),this.emplace(N,s,l,p,m,x,w,C,I,A,D)}emplace(s,l,p,m,x,w,C,I,A,D,N){const U=10*s;return this.uint16[U+0]=l,this.uint16[U+1]=p,this.uint16[U+2]=m,this.uint16[U+3]=x,this.uint16[U+4]=w,this.uint16[U+5]=C,this.uint16[U+6]=I,this.uint16[U+7]=A,this.uint16[U+8]=D,this.uint16[U+9]=N,s}}yp.prototype.bytesPerElement=20,ft("StructArrayLayout10ui20",yp);class Ul extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A,D,N,U){const G=this.length;return this.resize(G+1),this.emplace(G,s,l,p,m,x,w,C,I,A,D,N,U)}emplace(s,l,p,m,x,w,C,I,A,D,N,U,G){const q=12*s;return this.int16[q+0]=l,this.int16[q+1]=p,this.int16[q+2]=m,this.int16[q+3]=x,this.uint16[q+4]=w,this.uint16[q+5]=C,this.uint16[q+6]=I,this.uint16[q+7]=A,this.int16[q+8]=D,this.int16[q+9]=N,this.int16[q+10]=U,this.int16[q+11]=G,s}}Ul.prototype.bytesPerElement=24,ft("StructArrayLayout4i4ui4i24",Ul);class Cg extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=3*s;return this.float32[x+0]=l,this.float32[x+1]=p,this.float32[x+2]=m,s}}Cg.prototype.bytesPerElement=12,ft("StructArrayLayout3f12",Cg);class Eg extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint32[1*s+0]=l,s}}Eg.prototype.bytesPerElement=4,ft("StructArrayLayout1ul4",Eg);class _p extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A){const D=this.length;return this.resize(D+1),this.emplace(D,s,l,p,m,x,w,C,I,A)}emplace(s,l,p,m,x,w,C,I,A,D){const N=10*s,U=5*s;return this.int16[N+0]=l,this.int16[N+1]=p,this.int16[N+2]=m,this.int16[N+3]=x,this.int16[N+4]=w,this.int16[N+5]=C,this.uint32[U+3]=I,this.uint16[N+8]=A,this.uint16[N+9]=D,s}}_p.prototype.bytesPerElement=20,ft("StructArrayLayout6i1ul2ui20",_p);class Ig extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,p,m,x,w)}emplace(s,l,p,m,x,w,C){const I=6*s;return this.int16[I+0]=l,this.int16[I+1]=p,this.int16[I+2]=m,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=C,s}}Ig.prototype.bytesPerElement=12,ft("StructArrayLayout2i2i2i12",Ig);class v extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x){const w=this.length;return this.resize(w+1),this.emplace(w,s,l,p,m,x)}emplace(s,l,p,m,x,w){const C=4*s,I=8*s;return this.float32[C+0]=l,this.float32[C+1]=p,this.float32[C+2]=m,this.int16[I+6]=x,this.int16[I+7]=w,s}}v.prototype.bytesPerElement=16,ft("StructArrayLayout2f1f2i16",v);class n extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,p,m,x,w)}emplace(s,l,p,m,x,w,C){const I=16*s,A=4*s,D=8*s;return this.uint8[I+0]=l,this.uint8[I+1]=p,this.float32[A+1]=m,this.float32[A+2]=x,this.int16[D+6]=w,this.int16[D+7]=C,s}}n.prototype.bytesPerElement=16,ft("StructArrayLayout2ub2f2i16",n);class u extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=3*s;return this.uint16[x+0]=l,this.uint16[x+1]=p,this.uint16[x+2]=m,s}}u.prototype.bytesPerElement=6,ft("StructArrayLayout3ui6",u);class f extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne){const ye=this.length;return this.resize(ye+1),this.emplace(ye,s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne)}emplace(s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye){const ue=24*s,de=12*s,Me=48*s;return this.int16[ue+0]=l,this.int16[ue+1]=p,this.uint16[ue+2]=m,this.uint16[ue+3]=x,this.uint32[de+2]=w,this.uint32[de+3]=C,this.uint32[de+4]=I,this.uint16[ue+10]=A,this.uint16[ue+11]=D,this.uint16[ue+12]=N,this.float32[de+7]=U,this.float32[de+8]=G,this.uint8[Me+36]=q,this.uint8[Me+37]=X,this.uint8[Me+38]=Q,this.uint32[de+10]=ne,this.int16[ue+22]=ye,s}}f.prototype.bytesPerElement=48,ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",f);class g extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye,ue,de,Me,Le,Ze,ct,et,at,Et,ot){const lt=this.length;return this.resize(lt+1),this.emplace(lt,s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye,ue,de,Me,Le,Ze,ct,et,at,Et,ot)}emplace(s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye,ue,de,Me,Le,Ze,ct,et,at,Et,ot,lt){const Ue=32*s,kt=16*s;return this.int16[Ue+0]=l,this.int16[Ue+1]=p,this.int16[Ue+2]=m,this.int16[Ue+3]=x,this.int16[Ue+4]=w,this.int16[Ue+5]=C,this.int16[Ue+6]=I,this.int16[Ue+7]=A,this.uint16[Ue+8]=D,this.uint16[Ue+9]=N,this.uint16[Ue+10]=U,this.uint16[Ue+11]=G,this.uint16[Ue+12]=q,this.uint16[Ue+13]=X,this.uint16[Ue+14]=Q,this.uint16[Ue+15]=ne,this.uint16[Ue+16]=ye,this.uint16[Ue+17]=ue,this.uint16[Ue+18]=de,this.uint16[Ue+19]=Me,this.uint16[Ue+20]=Le,this.uint16[Ue+21]=Ze,this.uint16[Ue+22]=ct,this.uint32[kt+12]=et,this.float32[kt+13]=at,this.float32[kt+14]=Et,this.uint16[Ue+30]=ot,this.uint16[Ue+31]=lt,s}}g.prototype.bytesPerElement=64,ft("StructArrayLayout8i15ui1ul2f2ui64",g);class b extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.float32[1*s+0]=l,s}}b.prototype.bytesPerElement=4,ft("StructArrayLayout1f4",b);class S extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=3*s;return this.uint16[6*s+0]=l,this.float32[x+1]=p,this.float32[x+2]=m,s}}S.prototype.bytesPerElement=12,ft("StructArrayLayout1ui2f12",S);class $ extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=4*s;return this.uint32[2*s+0]=l,this.uint16[x+2]=p,this.uint16[x+3]=m,s}}$.prototype.bytesPerElement=8,ft("StructArrayLayout1ul2ui8",$);class M extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const m=2*s;return this.uint16[m+0]=l,this.uint16[m+1]=p,s}}M.prototype.bytesPerElement=4,ft("StructArrayLayout2ui4",M);class z extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint16[1*s+0]=l,s}}z.prototype.bytesPerElement=2,ft("StructArrayLayout1ui2",z);class F extends Si{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,m){const x=this.length;return this.resize(x+1),this.emplace(x,s,l,p,m)}emplace(s,l,p,m,x){const w=4*s;return this.float32[w+0]=l,this.float32[w+1]=p,this.float32[w+2]=m,this.float32[w+3]=x,s}}F.prototype.bytesPerElement=16,ft("StructArrayLayout4f16",F);class j extends bh{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new _(this.anchorPointX,this.anchorPointY)}}j.prototype.size=20;class B extends _p{get(s){return new j(this,s)}}ft("CollisionBoxArray",B);class V extends bh{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}V.prototype.size=48;class W extends f{get(s){return new V(this,s)}}ft("PlacedSymbolArray",W);class te extends bh{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}te.prototype.size=64;class ee extends g{get(s){return new te(this,s)}}ft("SymbolInstanceArray",ee);class ie extends b{getoffsetX(s){return this.float32[1*s+0]}}ft("GlyphOffsetArray",ie);class se extends Hc{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}ft("SymbolLineVertexArray",se);class ce extends bh{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ce.prototype.size=12;class oe extends S{get(s){return new ce(this,s)}}ft("TextAnchorOffsetArray",oe);class he extends bh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}he.prototype.size=8;class me extends ${get(s){return new he(this,s)}}ft("FeatureIndexArray",me);class ae extends qc{}class xe extends qc{}class Oe extends qc{}class Ie extends Zc{}class $e extends jl{}class De extends xh{}class Ke extends yp{}class it extends Ul{}class He extends Cg{}class xt extends Eg{}class Gt extends Ig{}class gi extends n{}class Ti extends u{}class wi extends M{}const Gi=ir([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yi}=Gi;class Bt{constructor(s=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=s}prepareSegment(s,l,p,m){const x=this.segments[this.segments.length-1];return s>Bt.MAX_VERTEX_ARRAY_LENGTH&&lr(`Max vertices per segment is ${Bt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Bt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!x||x.vertexLength+s>Bt.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==m?this.createNewSegment(l,p,m):x}createNewSegment(s,l,p){const m={vertexOffset:s.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(m.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(s,l,p){return this.prepareSegment(0,s,l,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const s of this.segments)for(const l in s.vaos)s.vaos[l].destroy()}static simpleSegment(s,l,p,m){return new Bt([{vertexOffset:s,primitiveOffset:l,vertexLength:p,primitiveLength:m,vaos:{},sortKey:0}])}}function Ci(c,s){return 256*(c=rn(Math.floor(c),0,255))+rn(Math.floor(s),0,255)}Bt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ft("SegmentVector",Bt);const yr=ir([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Pr,Vr,In,qs={exports:{}},Ha={exports:{}},Za={exports:{}},Wc=(function(){if(In)return qs.exports;In=1;var c=(Pr||(Pr=1,Ha.exports=function(l,p){var m,x,w,C,I,A,D,N;for(x=l.length-(m=3&l.length),w=p,I=3432918353,A=461845907,N=0;N<x;)D=255&l.charCodeAt(N)|(255&l.charCodeAt(++N))<<8|(255&l.charCodeAt(++N))<<16|(255&l.charCodeAt(++N))<<24,++N,w=27492+(65535&(C=5*(65535&(w=(w^=D=(65535&(D=(D=(65535&D)*I+(((D>>>16)*I&65535)<<16)&4294967295)<<15|D>>>17))*A+(((D>>>16)*A&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(D=0,m){case 3:D^=(255&l.charCodeAt(N+2))<<16;case 2:D^=(255&l.charCodeAt(N+1))<<8;case 1:w^=D=(65535&(D=(D=(65535&(D^=255&l.charCodeAt(N)))*I+(((D>>>16)*I&65535)<<16)&4294967295)<<15|D>>>17))*A+(((D>>>16)*A&65535)<<16)&4294967295}return w^=l.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}),Ha.exports),s=(Vr||(Vr=1,Za.exports=function(l,p){for(var m,x=l.length,w=p^x,C=0;x>=4;)m=1540483477*(65535&(m=255&l.charCodeAt(C)|(255&l.charCodeAt(++C))<<8|(255&l.charCodeAt(++C))<<16|(255&l.charCodeAt(++C))<<24))+((1540483477*(m>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),x-=4,++C;switch(x){case 3:w^=(255&l.charCodeAt(C+2))<<16;case 2:w^=(255&l.charCodeAt(C+1))<<8;case 1:w=1540483477*(65535&(w^=255&l.charCodeAt(C)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}),Za.exports);return qs.exports=c,qs.exports.murmur3=c,qs.exports.murmur2=s,qs.exports})(),Yc=T(Wc);class Vl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,l,p,m){this.ids.push(Gl(s)),this.positions.push(l,p,m)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=Gl(s);let p=0,m=this.ids.length-1;for(;p<m;){const w=p+m>>1;this.ids[w]>=l?m=w:p=w+1}const x=[];for(;this.ids[p]===l;)x.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return x}static serialize(s,l){const p=new Float64Array(s.ids),m=new Uint32Array(s.positions);return jn(p,m,0,p.length-1),l&&l.push(p.buffer,m.buffer),{ids:p,positions:m}}static deserialize(s){const l=new Vl;return l.ids=s.ids,l.positions=s.positions,l.indexed=!0,l}}function Gl(c){const s=+c;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:Yc(String(c))}function jn(c,s,l,p){for(;l<p;){const m=c[l+p>>1];let x=l-1,w=p+1;for(;;){do x++;while(c[x]<m);do w--;while(c[w]>m);if(x>=w)break;Hs(c,x,w),Hs(s,3*x,3*w),Hs(s,3*x+1,3*w+1),Hs(s,3*x+2,3*w+2)}w-l<p-w?(jn(c,s,l,w),l=w+1):(jn(c,s,w+1,p),p=w)}}function Hs(c,s,l){const p=c[s];c[s]=c[l],c[l]=p}ft("FeaturePositionMap",Vl);class $n{constructor(s,l){this.gl=s.gl,this.location=l}}class Wa extends $n{constructor(s,l){super(s,l),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class _r extends $n{constructor(s,l){super(s,l),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class Mr extends $n{constructor(s,l){super(s,l),this.current=Qt.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const vs=new Float32Array(16);function vr(c){return[Ci(255*c.r,255*c.g),Ci(255*c.b,255*c.a)]}class wh{constructor(s,l,p){this.value=s,this.uniformNames=l.map((m=>`u_${m}`)),this.type=p}setUniform(s,l,p){s.set(p.constantOr(this.value))}getBinding(s,l,p){return this.type==="color"?new Mr(s,l):new Wa(s,l)}}class Xc{constructor(s,l){this.uniformNames=l.map((p=>`u_${p}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=s.tlbr}setUniform(s,l,p,m){const x=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&s.set(x)}getBinding(s,l,p){return p.substr(0,9)==="u_pattern"?new _r(s,l):new Wa(s,l)}}class Jo{constructor(s,l,p,m){this.expression=s,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map((x=>({name:`a_${x}`,type:"Float32",components:p==="color"?2:1,offset:0}))),this.paintVertexArray=new m}populatePaintArray(s,l,p){const m=this.paintVertexArray.length,x=this.expression.evaluate(new Pi(0,p),l,{},p.canonical,[],p.formattedSection);this.paintVertexArray.resize(s),this._setPaintValue(m,s,x)}updatePaintArray(s,l,p,m,x){const w=this.expression.evaluate(new Pi(0,x),p,m);this._setPaintValue(s,l,w)}_setPaintValue(s,l,p){if(this.type==="color"){const m=vr(p);for(let x=s;x<l;x++)this.paintVertexArray.emplace(x,m[0],m[1])}else{for(let m=s;m<l;m++)this.paintVertexArray.emplace(m,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zs{constructor(s,l,p,m,x,w){this.expression=s,this.uniformNames=l.map((C=>`u_${C}_t`)),this.type=p,this.useIntegerZoom=m,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=l.map((C=>({name:`a_${C}`,type:"Float32",components:p==="color"?4:2,offset:0}))),this.paintVertexArray=new w}populatePaintArray(s,l,p){const m=this.expression.evaluate(new Pi(this.zoom,p),l,{},p.canonical,[],p.formattedSection),x=this.expression.evaluate(new Pi(this.zoom+1,p),l,{},p.canonical,[],p.formattedSection),w=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(w,s,m,x)}updatePaintArray(s,l,p,m,x){const w=this.expression.evaluate(new Pi(this.zoom,x),p,m),C=this.expression.evaluate(new Pi(this.zoom+1,x),p,m);this._setPaintValue(s,l,w,C)}_setPaintValue(s,l,p,m){if(this.type==="color"){const x=vr(p),w=vr(m);for(let C=s;C<l;C++)this.paintVertexArray.emplace(C,x[0],x[1],w[0],w[1])}else{for(let x=s;x<l;x++)this.paintVertexArray.emplace(x,p,m);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(m))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,l){const p=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=rn(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);s.set(m)}getBinding(s,l,p){return new Wa(s,l)}}class Ya{constructor(s,l,p,m,x,w){this.expression=s,this.type=l,this.useIntegerZoom=p,this.zoom=m,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(s,l,p){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(m,s,l.patterns&&l.patterns[this.layerId],p.imagePositions)}updatePaintArray(s,l,p,m,x){this._setPaintValues(s,l,p.patterns&&p.patterns[this.layerId],x.imagePositions)}_setPaintValues(s,l,p,m){if(!m||!p)return;const{min:x,mid:w,max:C}=p,I=m[x],A=m[w],D=m[C];if(I&&A&&D)for(let N=s;N<l;N++)this.zoomInPaintVertexArray.emplace(N,A.tl[0],A.tl[1],A.br[0],A.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],A.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(N,A.tl[0],A.tl[1],A.br[0],A.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],A.pixelRatio,D.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,yr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,yr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class lv{constructor(s,l,p){this.binders={},this._buffers=[];const m=[];for(const x in s.paint._values){if(!p(x))continue;const w=s.paint.get(x);if(!(w instanceof Io&&Va(w.property.specification)))continue;const C=cv(x,s.type),I=w.value,A=w.property.specification.type,D=w.property.useIntegerZoom,N=w.property.specification["property-type"],U=N==="cross-faded"||N==="cross-faded-data-driven";if(I.kind==="constant")this.binders[x]=U?new Xc(I.value,C):new wh(I.value,C,A),m.push(`/u_${x}`);else if(I.kind==="source"||U){const G=$g(x,A,"source");this.binders[x]=U?new Ya(I,A,D,l,G,s.id):new Jo(I,C,A,G),m.push(`/a_${x}`)}else{const G=$g(x,A,"composite");this.binders[x]=new Zs(I,C,A,D,l,G),m.push(`/z_${x}`)}}this.cacheKey=m.sort().join("")}getMaxValue(s){const l=this.binders[s];return l instanceof Jo||l instanceof Zs?l.maxValue:0}populatePaintArrays(s,l,p){for(const m in this.binders){const x=this.binders[m];(x instanceof Jo||x instanceof Zs||x instanceof Ya)&&x.populatePaintArray(s,l,p)}}setConstantPatternPositions(s,l){for(const p in this.binders){const m=this.binders[p];m instanceof Xc&&m.setConstantPatternPositions(s,l)}}updatePaintArrays(s,l,p,m,x){let w=!1;for(const C in s){const I=l.getPositions(C);for(const A of I){const D=p.feature(A.index);for(const N in this.binders){const U=this.binders[N];if((U instanceof Jo||U instanceof Zs||U instanceof Ya)&&U.expression.isStateDependent===!0){const G=m.paint.get(N);U.expression=G.value,U.updatePaintArray(A.start,A.end,D,s[C],x),w=!0}}}}return w}defines(){const s=[];for(const l in this.binders){const p=this.binders[l];(p instanceof wh||p instanceof Xc)&&s.push(...p.uniformNames.map((m=>`#define HAS_UNIFORM_${m}`)))}return s}getBinderAttributes(){const s=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof Jo||p instanceof Zs)for(let m=0;m<p.paintVertexAttributes.length;m++)s.push(p.paintVertexAttributes[m].name);else if(p instanceof Ya)for(let m=0;m<yr.members.length;m++)s.push(yr.members[m].name)}return s}getBinderUniforms(){const s=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof wh||p instanceof Xc||p instanceof Zs)for(const m of p.uniformNames)s.push(m)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,l){const p=[];for(const m in this.binders){const x=this.binders[m];if(x instanceof wh||x instanceof Xc||x instanceof Zs){for(const w of x.uniformNames)if(l[w]){const C=x.getBinding(s,l[w],w);p.push({name:w,property:m,binding:C})}}}return p}setUniforms(s,l,p,m){for(const{name:x,property:w,binding:C}of l)this.binders[w].setUniform(C,m,p.get(w),x)}updatePaintBuffers(s){this._buffers=[];for(const l in this.binders){const p=this.binders[l];if(s&&p instanceof Ya){const m=s.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(p instanceof Jo||p instanceof Zs)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(s){for(const l in this.binders){const p=this.binders[l];(p instanceof Jo||p instanceof Zs||p instanceof Ya)&&p.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const l=this.binders[s];(l instanceof Jo||l instanceof Zs||l instanceof Ya)&&l.destroy()}}}class rs{constructor(s,l,p=()=>!0){this.programConfigurations={};for(const m of s)this.programConfigurations[m.id]=new lv(m,l,p);this.needsUpload=!1,this._featureMap=new Vl,this._bufferOffset=0}populatePaintArrays(s,l,p,m){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(s,l,m);l.id!==void 0&&this._featureMap.add(l.id,p,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,l,p,m){for(const x of p)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,l,x,m)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function cv(c,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}function $g(c,s,l){const p={color:{source:xh,composite:F},number:{source:b,composite:xh}},m=(function(x){return{"line-pattern":{source:Ke,composite:Ke},"fill-pattern":{source:Ke,composite:Ke},"fill-extrusion-pattern":{source:Ke,composite:Ke}}[x]})(c);return m&&m[l]||p[s][l]}ft("ConstantBinder",wh),ft("CrossFadedConstantBinder",Xc),ft("SourceExpressionBinder",Jo),ft("CrossFadedCompositeBinder",Ya),ft("CompositeExpressionBinder",Zs),ft("ProgramConfiguration",lv,{omit:["_buffers"]}),ft("ProgramConfigurationSet",rs);const vp=Math.pow(2,14)-1,bp=-vp-1;function Xa(c){const s=rt/c.extent,l=c.loadGeometry();for(let p=0;p<l.length;p++){const m=l[p];for(let x=0;x<m.length;x++){const w=m[x],C=Math.round(w.x*s),I=Math.round(w.y*s);w.x=rn(C,bp,vp),w.y=rn(I,bp,vp),(C<w.x||C>w.x+1||I<w.y||I>w.y+1)&&lr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function Ko(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?Xa(c):[]}}const aM=-32768;function F8(c,s,l,p,m){c.emplaceBack(aM+8*s+p,aM+8*l+m)}class S2{constructor(s){this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((l=>l.id)),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new xe,this.indexArray=new Ti,this.segments=new Bt,this.programConfigurations=new rs(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id))}populate(s,l,p){const m=this.layers[0],x=[];let w=null,C=!1,I=m.type==="heatmap";if(m.type==="circle"){const D=m;w=D.layout.get("circle-sort-key"),C=!w.isConstant(),I=I||D.paint.get("circle-pitch-alignment")==="map"}const A=I?l.subdivisionGranularity.circle:1;for(const{feature:D,id:N,index:U,sourceLayerIndex:G}of s){const q=this.layers[0]._featureFilter.needGeometry,X=Ko(D,q);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom,{globalState:this.globalState}),X,p))continue;const Q=C?w.evaluate(X,{},p):void 0,ne={id:N,properties:D.properties,type:D.type,sourceLayerIndex:G,index:U,geometry:q?X.geometry:Xa(D),patterns:{},sortKey:Q};x.push(ne)}C&&x.sort(((D,N)=>D.sortKey-N.sortKey));for(const D of x){const{geometry:N,index:U,sourceLayerIndex:G}=D,q=s[U].feature;this.addFeature(D,N,U,p,A),l.featureIndex.insert(q,N,U,G,this.index)}}update(s,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,{imagePositions:p,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Yi),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,l,p,m,x=1){let w;switch(x){case 1:w=[0,7];break;case 3:w=[0,2,5,7];break;case 5:w=[0,1,3,4,6,7];break;case 7:w=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${x}; valid values are 1, 3, 5, 7.`)}const C=w.length;for(const I of l)for(const A of I){const D=A.x,N=A.y;if(D<0||D>=rt||N<0||N>=rt)continue;const U=this.segments.prepareSegment(C*C,this.layoutVertexArray,this.indexArray,s.sortKey),G=U.vertexLength;for(let q=0;q<C;q++)for(let X=0;X<C;X++)F8(this.layoutVertexArray,D,N,w[X],w[q]);for(let q=0;q<C-1;q++)for(let X=0;X<C-1;X++){const Q=G+q*C+X,ne=G+(q+1)*C+X;this.indexArray.emplaceBack(Q,ne+1,Q+1),this.indexArray.emplaceBack(Q,ne,ne+1)}U.vertexLength+=C*C,U.primitiveLength+=(C-1)*(C-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{imagePositions:{},canonical:m,globalState:this.globalState})}}function lM(c,s){for(let l=0;l<c.length;l++)if(xp(s,c[l]))return!0;for(let l=0;l<s.length;l++)if(xp(c,s[l]))return!0;return!!T2(c,s)}function N8(c,s,l){return!!xp(c,s)||!!C2(s,c,l)}function cM(c,s){if(c.length===1)return hM(s,c[0]);for(let l=0;l<s.length;l++){const p=s[l];for(let m=0;m<p.length;m++)if(xp(c,p[m]))return!0}for(let l=0;l<c.length;l++)if(hM(s,c[l]))return!0;for(let l=0;l<s.length;l++)if(T2(c,s[l]))return!0;return!1}function B8(c,s,l){if(c.length>1){if(T2(c,s))return!0;for(let p=0;p<s.length;p++)if(C2(s[p],c,l))return!0}for(let p=0;p<c.length;p++)if(C2(c[p],s,l))return!0;return!1}function T2(c,s){if(c.length===0||s.length===0)return!1;for(let l=0;l<c.length-1;l++){const p=c[l],m=c[l+1];for(let x=0;x<s.length-1;x++)if(j8(p,m,s[x],s[x+1]))return!0}return!1}function j8(c,s,l,p){return Rs(c,l,p)!==Rs(s,l,p)&&Rs(c,s,l)!==Rs(c,s,p)}function C2(c,s,l){const p=l*l;if(s.length===1)return c.distSqr(s[0])<p;for(let m=1;m<s.length;m++)if(uM(c,s[m-1],s[m])<p)return!0;return!1}function uM(c,s,l){const p=s.distSqr(l);if(p===0)return c.distSqr(s);const m=((c.x-s.x)*(l.x-s.x)+(c.y-s.y)*(l.y-s.y))/p;return c.distSqr(m<0?s:m>1?l:l.sub(s)._mult(m)._add(s))}function hM(c,s){let l,p,m,x=!1;for(let w=0;w<c.length;w++){l=c[w];for(let C=0,I=l.length-1;C<l.length;I=C++)p=l[C],m=l[I],p.y>s.y!=m.y>s.y&&s.x<(m.x-p.x)*(s.y-p.y)/(m.y-p.y)+p.x&&(x=!x)}return x}function xp(c,s){let l=!1;for(let p=0,m=c.length-1;p<c.length;m=p++){const x=c[p],w=c[m];x.y>s.y!=w.y>s.y&&s.x<(w.x-x.x)*(s.y-x.y)/(w.y-x.y)+x.x&&(l=!l)}return l}function U8(c,s,l){const p=l[0],m=l[2];if(c.x<p.x&&s.x<p.x||c.x>m.x&&s.x>m.x||c.y<p.y&&s.y<p.y||c.y>m.y&&s.y>m.y)return!1;const x=Rs(c,s,l[0]);return x!==Rs(c,s,l[1])||x!==Rs(c,s,l[2])||x!==Rs(c,s,l[3])}function Pg(c,s,l){const p=s.paint.get(c).value;return p.kind==="constant"?p.value:l.programConfigurations.get(s.id).getMaxValue(c)}function uv(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function hv(c,s,l,p,m){if(!s[0]&&!s[1])return c;const x=_.convert(s)._mult(m);l==="viewport"&&x._rotate(-p);const w=[];for(let C=0;C<c.length;C++)w.push(c[C].sub(x));return w}let dM,pM;ft("CircleBucket",S2,{omit:["layers"]});var V8={get paint(){return pM=pM||new En({"circle-radius":new Pt(Te.paint_circle["circle-radius"]),"circle-color":new Pt(Te.paint_circle["circle-color"]),"circle-blur":new Pt(Te.paint_circle["circle-blur"]),"circle-opacity":new Pt(Te.paint_circle["circle-opacity"]),"circle-translate":new Tt(Te.paint_circle["circle-translate"]),"circle-translate-anchor":new Tt(Te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tt(Te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tt(Te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Pt(Te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Pt(Te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Pt(Te.paint_circle["circle-stroke-opacity"])})},get layout(){return dM=dM||new En({"circle-sort-key":new Pt(Te.layout_circle["circle-sort-key"])})}};class G8 extends _s{constructor(s){super(s,V8)}createBucket(s){return new S2(s)}queryRadius(s){const l=s;return Pg("circle-radius",this,l)+Pg("circle-stroke-width",this,l)+uv(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:s,feature:l,featureState:p,geometry:m,transform:x,pixelsToTileUnits:w,unwrappedTileID:C,getElevation:I}){const A=hv(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-x.bearingInRadians,w),D=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),N=this.paint.get("circle-pitch-alignment")==="map",U=N?A:(function(q,X,Q,ne){return q.map((ye=>fM(ye,X,Q,ne)))})(A,x,C,I),G=N?D*w:D;for(const q of m)for(const X of q){const Q=N?X:fM(X,x,C,I);let ne=G;const ye=x.projectTileCoordinates(X.x,X.y,C,I).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ne*=ye/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ne*=x.cameraToCenterDistance/ye),N8(U,Q,ne))return!0}return!1}}function fM(c,s,l,p){const m=s.projectTileCoordinates(c.x,c.y,l,p).point;return new _((.5*m.x+.5)*s.width,(.5*-m.y+.5)*s.height)}class mM extends S2{}let gM;ft("HeatmapBucket",mM,{omit:["layers"]});var q8={get paint(){return gM=gM||new En({"heatmap-radius":new Pt(Te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Pt(Te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tt(Te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new mp(Te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tt(Te.paint_heatmap["heatmap-opacity"])})}};function E2(c,{width:s,height:l},p,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==s*l*p)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${s*l*p}`)}else m=new Uint8Array(s*l*p);return c.width=s,c.height=l,c.data=m,c}function yM(c,{width:s,height:l},p){if(s===c.width&&l===c.height)return;const m=E2({},{width:s,height:l},p);I2(c,m,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,s),height:Math.min(c.height,l)},p),c.width=s,c.height=l,c.data=m.data}function I2(c,s,l,p,m,x){if(m.width===0||m.height===0)return s;if(m.width>c.width||m.height>c.height||l.x>c.width-m.width||l.y>c.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||p.x>s.width-m.width||p.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const w=c.data,C=s.data;if(w===C)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<m.height;I++){const A=((l.y+I)*c.width+l.x)*x,D=((p.y+I)*s.width+p.x)*x;for(let N=0;N<m.width*x;N++)C[D+N]=w[A+N]}return s}class Mg{constructor(s,l){E2(this,s,1,l)}resize(s){yM(this,s,1)}clone(){return new Mg({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,p,m,x){I2(s,l,p,m,x,1)}}class ns{constructor(s,l){E2(this,s,4,l)}resize(s){yM(this,s,4)}replace(s,l){l?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new ns({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,p,m,x){I2(s,l,p,m,x,4)}setPixel(s,l,p){const m=4*(s*this.width+l);this.data[m+0]=Math.round(255*p.r/p.a),this.data[m+1]=Math.round(255*p.g/p.a),this.data[m+2]=Math.round(255*p.b/p.a),this.data[m+3]=Math.round(255*p.a)}}function _M(c){const s={},l=c.resolution||256,p=c.clips?c.clips.length:1,m=c.image||new ns({width:l,height:p});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const x=(w,C,I)=>{s[c.evaluationKey]=I;const A=c.expression.evaluate(s);m.setPixel(w/4/l,C/4,A)};if(c.clips)for(let w=0,C=0;w<p;++w,C+=4*l)for(let I=0,A=0;I<l;I++,A+=4){const D=I/(l-1),{start:N,end:U}=c.clips[w];x(C,A,N*(1-D)+U*D)}else for(let w=0,C=0;w<l;w++,C+=4)x(0,C,w/(l-1));return m}ft("AlphaImage",Mg),ft("RGBAImage",ns);const $2="big-fb";class H8 extends _s{createBucket(s){return new mM(s)}constructor(s){super(s,q8),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_M({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has($2)&&this.heatmapFbos.delete($2)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let vM;var Z8={get paint(){return vM=vM||new En({"hillshade-illumination-direction":new Tt(Te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Tt(Te.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Tt(Te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tt(Te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tt(Te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tt(Te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tt(Te.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Tt(Te.paint_hillshade["hillshade-method"])})}};class W8 extends _s{constructor(s){super(s,Z8),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let s=this.paint.get("hillshade-illumination-direction").values,l=this.paint.get("hillshade-illumination-altitude").values,p=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values;const x=Math.max(s.length,l.length,p.length,m.length);s=s.concat(Array(x-s.length).fill(s.at(-1))),l=l.concat(Array(x-l.length).fill(l.at(-1))),p=p.concat(Array(x-p.length).fill(p.at(-1))),m=m.concat(Array(x-m.length).fill(m.at(-1)));const w=l.map(Tl);return{directionRadians:s.map(Tl),altitudeRadians:w,shadowColor:m,highlightColor:p}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let bM;var Y8={get paint(){return bM=bM||new En({"color-relief-opacity":new Tt(Te["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new mp(Te["paint_color-relief"]["color-relief-color"])})}};class P2{constructor(s,l,p,m){this.context=s,this.format=p,this.texture=s.gl.createTexture(),this.update(l,m)}update(s,l,p){const{width:m,height:x}=s,w=!(this.size&&this.size[0]===m&&this.size[1]===x||p),{context:C}=this,{gl:I}=C;if(this.useMipmap=!!(l&&l.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!l||l.premultiply!==!1)),w)this.size=[m,x],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||bo(s)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,s):I.texImage2D(I.TEXTURE_2D,0,this.format,m,x,0,this.format,I.UNSIGNED_BYTE,s.data);else{const{x:A,y:D}=p||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||bo(s)?I.texSubImage2D(I.TEXTURE_2D,0,A,D,I.RGBA,I.UNSIGNED_BYTE,s):I.texSubImage2D(I.TEXTURE_2D,0,A,D,m,x,I.RGBA,I.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D),C.pixelStoreUnpackFlipY.setDefault(),C.pixelStoreUnpack.setDefault(),C.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(s,l,p){const{context:m}=this,{gl:x}=m;x.bindTexture(x.TEXTURE_2D,this.texture),p!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=x.LINEAR),s!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,s),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,p||s),this.filter=s),l!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,l),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class xM{constructor(s,l,p,m=1,x=1,w=1,C=0){if(this.uid=s,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void lr(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;const I=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=x,this.blueFactor=w,this.baseShift=C;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let A=0;A<I;A++)this.data[this._idx(-1,A)]=this.data[this._idx(0,A)],this.data[this._idx(I,A)]=this.data[this._idx(I-1,A)],this.data[this._idx(A,-1)]=this.data[this._idx(A,0)],this.data[this._idx(A,I)]=this.data[this._idx(A,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let A=0;A<I;A++)for(let D=0;D<I;D++){const N=this.get(A,D);N>this.max&&(this.max=N),N<this.min&&(this.min=N)}}get(s,l){const p=new Uint8Array(this.data.buffer),m=4*this._idx(s,l);return this.unpack(p[m],p[m+1],p[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,l){if(s<-1||s>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(s+1)}unpack(s,l,p){return s*this.redFactor+l*this.greenFactor+p*this.blueFactor-this.baseShift}pack(s){return wM(s,this.getUnpackVector())}getPixels(){return new ns({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,l,p){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let m=l*this.dim,x=l*this.dim+this.dim,w=p*this.dim,C=p*this.dim+this.dim;switch(l){case-1:m=x-1;break;case 1:x=m+1}switch(p){case-1:w=C-1;break;case 1:C=w+1}const I=-l*this.dim,A=-p*this.dim;for(let D=w;D<C;D++)for(let N=m;N<x;N++)this.data[this._idx(N,D)]=s.data[this._idx(N+I,D+A)]}}function wM(c,s){const l=s[0],p=s[1],m=s[2],x=s[3],w=Math.min(l,p,m),C=Math.round((c+x)/w);return{r:Math.floor(C*w/l)%256,g:Math.floor(C*w/p)%256,b:Math.floor(C*w/m)%256}}ft("DEMData",xM);class X8 extends _s{constructor(s){super(s,Y8)}_createColorRamp(s){const l={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values["color-relief-color"].value.expression;if(p instanceof dh&&p._styleExpression.expression instanceof sn){this.colorRampExpression=p;const w=p._styleExpression.expression;l.elevationStops=w.labels,l.colorStops=[];for(const C of l.elevationStops)l.colorStops.push(w.evaluate({globals:{elevation:C}}))}if(l.elevationStops.length<1&&(l.elevationStops=[0],l.colorStops=[Qt.transparent]),l.elevationStops.length<2&&(l.elevationStops.push(l.elevationStops[0]+1),l.colorStops.push(l.colorStops[0])),l.elevationStops.length<=s)return l;const m={elevationStops:[],colorStops:[]},x=(l.elevationStops.length-1)/(s-1);for(let w=0;w<l.elevationStops.length-.5;w+=x)m.elevationStops.push(l.elevationStops[Math.round(w)]),m.colorStops.push(l.colorStops[Math.round(w)]);return lr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(s,l,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const m=this._createColorRamp(l),x=new ns({width:m.colorStops.length,height:1}),w=new ns({width:m.colorStops.length,height:1});for(let C=0;C<m.elevationStops.length;C++){const I=wM(m.elevationStops[C],p);w.setPixel(0,C,new Qt(I.r/255,I.g/255,I.b/255,1)),x.setPixel(0,C,m.colorStops[C])}return this.colorRampTextures={elevationTexture:new P2(s,w,s.gl.RGBA),colorTexture:new P2(s,x,s.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const J8=ir([{name:"a_pos",components:2,type:"Int16"}],4),{members:K8}=J8;function M2(c,s,l){const p=l.patternDependencies;let m=!1;for(const x of s){const w=x.paint.get(`${c}-pattern`);w.isConstant()||(m=!0);const C=w.constantOr(null);C&&(m=!0,p[C.to]=!0,p[C.from]=!0)}return m}function k2(c,s,l,p,m){const{zoom:x,globalState:w}=p,C=m.patternDependencies;for(const I of s){const A=I.paint.get(`${c}-pattern`).value;if(A.kind!=="constant"){let D=A.evaluate({zoom:x-1,globalState:w},l,{},m.availableImages),N=A.evaluate({zoom:x,globalState:w},l,{},m.availableImages),U=A.evaluate({zoom:x+1,globalState:w},l,{},m.availableImages);D=D&&D.name?D.name:D,N=N&&N.name?N.name:N,U=U&&U.name?U.name:U,C[D]=!0,C[N]=!0,C[U]=!0,l.patterns[I.id]={min:D,mid:N,max:U}}}return l}function SM(c,s,l,p,m){let x;if(m===(function(w,C,I,A){let D=0;for(let N=C,U=I-A;N<I;N+=A)D+=(w[U]-w[N])*(w[N+1]+w[U+1]),U=N;return D})(c,s,l,p)>0)for(let w=s;w<l;w+=p)x=IM(w/p|0,c[w],c[w+1],x);else for(let w=l-p;w>=s;w-=p)x=IM(w/p|0,c[w],c[w+1],x);return x&&wp(x,x.next)&&(zg(x),x=x.next),x}function Sh(c,s){if(!c)return c;s||(s=c);let l,p=c;do if(l=!1,p.steiner||!wp(p,p.next)&&ur(p.prev,p,p.next)!==0)p=p.next;else{if(zg(p),p=s=p.prev,p===p.next)break;l=!0}while(l||p!==s);return s}function kg(c,s,l,p,m,x,w){if(!c)return;!w&&x&&(function(I,A,D,N){let U=I;do U.z===0&&(U.z=A2(U.x,U.y,A,D,N)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==I);U.prevZ.nextZ=null,U.prevZ=null,(function(G){let q,X=1;do{let Q,ne=G;G=null;let ye=null;for(q=0;ne;){q++;let ue=ne,de=0;for(let Le=0;Le<X&&(de++,ue=ue.nextZ,ue);Le++);let Me=X;for(;de>0||Me>0&&ue;)de!==0&&(Me===0||!ue||ne.z<=ue.z)?(Q=ne,ne=ne.nextZ,de--):(Q=ue,ue=ue.nextZ,Me--),ye?ye.nextZ=Q:G=Q,Q.prevZ=ye,ye=Q;ne=ue}ye.nextZ=null,X*=2}while(q>1)})(U)})(c,p,m,x);let C=c;for(;c.prev!==c.next;){const I=c.prev,A=c.next;if(x?ej(c,p,m,x):Q8(c))s.push(I.i,c.i,A.i),zg(c),c=A.next,C=A.next;else if((c=A)===C){w?w===1?kg(c=tj(Sh(c),s),s,l,p,m,x,2):w===2&&ij(c,s,l,p,m,x):kg(Sh(c),s,l,p,m,x,1);break}}}function Q8(c){const s=c.prev,l=c,p=c.next;if(ur(s,l,p)>=0)return!1;const m=s.x,x=l.x,w=p.x,C=s.y,I=l.y,A=p.y,D=Math.min(m,x,w),N=Math.min(C,I,A),U=Math.max(m,x,w),G=Math.max(C,I,A);let q=p.next;for(;q!==s;){if(q.x>=D&&q.x<=U&&q.y>=N&&q.y<=G&&Ag(m,C,x,I,w,A,q.x,q.y)&&ur(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function ej(c,s,l,p){const m=c.prev,x=c,w=c.next;if(ur(m,x,w)>=0)return!1;const C=m.x,I=x.x,A=w.x,D=m.y,N=x.y,U=w.y,G=Math.min(C,I,A),q=Math.min(D,N,U),X=Math.max(C,I,A),Q=Math.max(D,N,U),ne=A2(G,q,s,l,p),ye=A2(X,Q,s,l,p);let ue=c.prevZ,de=c.nextZ;for(;ue&&ue.z>=ne&&de&&de.z<=ye;){if(ue.x>=G&&ue.x<=X&&ue.y>=q&&ue.y<=Q&&ue!==m&&ue!==w&&Ag(C,D,I,N,A,U,ue.x,ue.y)&&ur(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,de.x>=G&&de.x<=X&&de.y>=q&&de.y<=Q&&de!==m&&de!==w&&Ag(C,D,I,N,A,U,de.x,de.y)&&ur(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;ue&&ue.z>=ne;){if(ue.x>=G&&ue.x<=X&&ue.y>=q&&ue.y<=Q&&ue!==m&&ue!==w&&Ag(C,D,I,N,A,U,ue.x,ue.y)&&ur(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;de&&de.z<=ye;){if(de.x>=G&&de.x<=X&&de.y>=q&&de.y<=Q&&de!==m&&de!==w&&Ag(C,D,I,N,A,U,de.x,de.y)&&ur(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function tj(c,s){let l=c;do{const p=l.prev,m=l.next.next;!wp(p,m)&&CM(p,l,l.next,m)&&Dg(p,m)&&Dg(m,p)&&(s.push(p.i,l.i,m.i),zg(l),zg(l.next),l=c=m),l=l.next}while(l!==c);return Sh(l)}function ij(c,s,l,p,m,x){let w=c;do{let C=w.next.next;for(;C!==w.prev;){if(w.i!==C.i&&aj(w,C)){let I=EM(w,C);return w=Sh(w,w.next),I=Sh(I,I.next),kg(w,s,l,p,m,x,0),void kg(I,s,l,p,m,x,0)}C=C.next}w=w.next}while(w!==c)}function rj(c,s){let l=c.x-s.x;return l===0&&(l=c.y-s.y,l===0)&&(l=(c.next.y-c.y)/(c.next.x-c.x)-(s.next.y-s.y)/(s.next.x-s.x)),l}function nj(c,s){const l=(function(m,x){let w=x;const C=m.x,I=m.y;let A,D=-1/0;if(wp(m,w))return w;do{if(wp(m,w.next))return w.next;if(I<=w.y&&I>=w.next.y&&w.next.y!==w.y){const X=w.x+(I-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(X<=C&&X>D&&(D=X,A=w.x<w.next.x?w:w.next,X===C))return A}w=w.next}while(w!==x);if(!A)return null;const N=A,U=A.x,G=A.y;let q=1/0;w=A;do{if(C>=w.x&&w.x>=U&&C!==w.x&&TM(I<G?C:D,I,U,G,I<G?D:C,I,w.x,w.y)){const X=Math.abs(I-w.y)/(C-w.x);Dg(w,m)&&(X<q||X===q&&(w.x>A.x||w.x===A.x&&sj(A,w)))&&(A=w,q=X)}w=w.next}while(w!==N);return A})(c,s);if(!l)return s;const p=EM(l,c);return Sh(p,p.next),Sh(l,l.next)}function sj(c,s){return ur(c.prev,c,s.prev)<0&&ur(s.next,c,c.next)<0}function A2(c,s,l,p,m){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-l)*m|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-p)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function oj(c){let s=c,l=c;do(s.x<l.x||s.x===l.x&&s.y<l.y)&&(l=s),s=s.next;while(s!==c);return l}function TM(c,s,l,p,m,x,w,C){return(m-w)*(s-C)>=(c-w)*(x-C)&&(c-w)*(p-C)>=(l-w)*(s-C)&&(l-w)*(x-C)>=(m-w)*(p-C)}function Ag(c,s,l,p,m,x,w,C){return!(c===w&&s===C)&&TM(c,s,l,p,m,x,w,C)}function aj(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!(function(l,p){let m=l;do{if(m.i!==l.i&&m.next.i!==l.i&&m.i!==p.i&&m.next.i!==p.i&&CM(m,m.next,l,p))return!0;m=m.next}while(m!==l);return!1})(c,s)&&(Dg(c,s)&&Dg(s,c)&&(function(l,p){let m=l,x=!1;const w=(l.x+p.x)/2,C=(l.y+p.y)/2;do m.y>C!=m.next.y>C&&m.next.y!==m.y&&w<(m.next.x-m.x)*(C-m.y)/(m.next.y-m.y)+m.x&&(x=!x),m=m.next;while(m!==l);return x})(c,s)&&(ur(c.prev,c,s.prev)||ur(c,s.prev,s))||wp(c,s)&&ur(c.prev,c,c.next)>0&&ur(s.prev,s,s.next)>0)}function ur(c,s,l){return(s.y-c.y)*(l.x-s.x)-(s.x-c.x)*(l.y-s.y)}function wp(c,s){return c.x===s.x&&c.y===s.y}function CM(c,s,l,p){const m=pv(ur(c,s,l)),x=pv(ur(c,s,p)),w=pv(ur(l,p,c)),C=pv(ur(l,p,s));return m!==x&&w!==C||!(m!==0||!dv(c,l,s))||!(x!==0||!dv(c,p,s))||!(w!==0||!dv(l,c,p))||!(C!==0||!dv(l,s,p))}function dv(c,s,l){return s.x<=Math.max(c.x,l.x)&&s.x>=Math.min(c.x,l.x)&&s.y<=Math.max(c.y,l.y)&&s.y>=Math.min(c.y,l.y)}function pv(c){return c>0?1:c<0?-1:0}function Dg(c,s){return ur(c.prev,c,c.next)<0?ur(c,s,c.next)>=0&&ur(c,c.prev,s)>=0:ur(c,s,c.prev)<0||ur(c,c.next,s)<0}function EM(c,s){const l=D2(c.i,c.x,c.y),p=D2(s.i,s.x,s.y),m=c.next,x=s.prev;return c.next=s,s.prev=c,l.next=m,m.prev=l,p.next=l,l.prev=p,x.next=p,p.prev=x,p}function IM(c,s,l,p){const m=D2(c,s,l);return p?(m.next=p.next,m.prev=p,p.next.prev=m,p.next=m):(m.prev=m,m.next=m),m}function zg(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function D2(c,s,l){return{i:c,x:s,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Sp{constructor(s,l){if(l>s)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=s,this._minGranularity=l}getGranularityForZoomLevel(s){return Math.max(Math.floor(this._baseZoomGranularity/(1<<s)),this._minGranularity,1)}}class fv{constructor(s){this.fill=s.fill,this.line=s.line,this.tile=s.tile,this.stencil=s.stencil,this.circle=s.circle}}fv.noSubdivision=new fv({fill:new Sp(0,0),line:new Sp(0,0),tile:new Sp(0,0),stencil:new Sp(0,0),circle:1}),ft("SubdivisionGranularityExpression",Sp),ft("SubdivisionGranularitySetting",fv);const Tp=-32768,Og=32767;class lj{constructor(s,l){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=s,this._granularityCellSize=rt/s,this._canonical=l}_getKey(s,l){return(s+=32768)<<16|l+32768}_vertexToIndex(s,l){if(s<-32768||l<-32768||s>32767||l>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const p=0|Math.round(s),m=0|Math.round(l),x=this._getKey(p,m);if(this._vertexDictionary.has(x))return this._vertexDictionary.get(x);const w=this._vertexBuffer.length/2;return this._vertexDictionary.set(x,w),this._vertexBuffer.push(p,m),w}_subdivideTrianglesScanline(s){if(this._granularity<2)return(function(m,x){const w=[];for(let C=0;C<x.length;C+=3){const I=x[C],A=x[C+1],D=x[C+2],N=m[2*I],U=m[2*I+1];(m[2*A]-N)*(m[2*D+1]-U)-(m[2*A+1]-U)*(m[2*D]-N)>0?(w.push(I),w.push(D),w.push(A)):(w.push(I),w.push(A),w.push(D))}return w})(this._vertexBuffer,s);const l=[],p=s.length;for(let m=0;m<p;m+=3){const x=[s[m+0],s[m+1],s[m+2]],w=[this._vertexBuffer[2*s[m+0]+0],this._vertexBuffer[2*s[m+0]+1],this._vertexBuffer[2*s[m+1]+0],this._vertexBuffer[2*s[m+1]+1],this._vertexBuffer[2*s[m+2]+0],this._vertexBuffer[2*s[m+2]+1]];let C=1/0,I=1/0,A=-1/0,D=-1/0;for(let X=0;X<3;X++){const Q=w[2*X],ne=w[2*X+1];C=Math.min(C,Q),A=Math.max(A,Q),I=Math.min(I,ne),D=Math.max(D,ne)}if(C===A||I===D)continue;const N=Math.floor(C/this._granularityCellSize),U=Math.ceil(A/this._granularityCellSize),G=Math.floor(I/this._granularityCellSize),q=Math.ceil(D/this._granularityCellSize);if(N!==U||G!==q)for(let X=G;X<q;X++){const Q=this._scanlineGenerateVertexRingForCellRow(X,w,x);cj(this._vertexBuffer,Q,l)}else l.push(...x)}return l}_scanlineGenerateVertexRingForCellRow(s,l,p){const m=s*this._granularityCellSize,x=m+this._granularityCellSize,w=[];for(let C=0;C<3;C++){const I=l[2*C],A=l[2*C+1],D=l[2*(C+1)%6],N=l[(2*(C+1)+1)%6],U=l[2*(C+2)%6],G=l[(2*(C+2)+1)%6],q=D-I,X=N-A,Q=q===0,ne=X===0,ye=(m-A)/X,ue=(x-A)/X,de=Math.min(ye,ue),Me=Math.max(ye,ue);if(!ne&&(de>=1||Me<=0)||ne&&(A<m||A>x)){N>=m&&N<=x&&w.push(p[(C+1)%3]);continue}!ne&&de>0&&w.push(this._vertexToIndex(I+q*de,A+X*de));const Le=I+q*Math.max(de,0),Ze=I+q*Math.min(Me,1);Q||this._generateIntraEdgeVertices(w,I,A,D,N,Le,Ze),!ne&&Me<1&&w.push(this._vertexToIndex(I+q*Me,A+X*Me)),(ne||N>=m&&N<=x)&&w.push(p[(C+1)%3]),!ne&&(N<=m||N>=x)&&this._generateInterEdgeVertices(w,I,A,D,N,U,G,Ze,m,x)}return w}_generateIntraEdgeVertices(s,l,p,m,x,w,C){const I=m-l,A=x-p,D=A===0,N=D?Math.min(l,m):Math.min(w,C),U=D?Math.max(l,m):Math.max(w,C),G=Math.floor(N/this._granularityCellSize)+1,q=Math.ceil(U/this._granularityCellSize)-1;if(D?l<m:w<C)for(let X=G;X<=q;X++){const Q=X*this._granularityCellSize;s.push(this._vertexToIndex(Q,p+A*(Q-l)/I))}else for(let X=q;X>=G;X--){const Q=X*this._granularityCellSize;s.push(this._vertexToIndex(Q,p+A*(Q-l)/I))}}_generateInterEdgeVertices(s,l,p,m,x,w,C,I,A,D){const N=x-p,U=w-m,G=C-x,q=(A-x)/G,X=(D-x)/G,Q=Math.min(q,X),ne=Math.max(q,X),ye=m+U*Q;let ue=Math.floor(Math.min(ye,I)/this._granularityCellSize)+1,de=Math.ceil(Math.max(ye,I)/this._granularityCellSize)-1,Me=I<ye;const Le=G===0;if(Le&&(C===A||C===D))return;if(Le||Q>=1||ne<=0){const ct=p-C,et=w+(l-w)*Math.min((A-C)/ct,(D-C)/ct);ue=Math.floor(Math.min(et,I)/this._granularityCellSize)+1,de=Math.ceil(Math.max(et,I)/this._granularityCellSize)-1,Me=I<et}const Ze=N>0?D:A;if(Me)for(let ct=ue;ct<=de;ct++)s.push(this._vertexToIndex(ct*this._granularityCellSize,Ze));else for(let ct=de;ct>=ue;ct--)s.push(this._vertexToIndex(ct*this._granularityCellSize,Ze))}_generateOutline(s){const l=[];for(const p of s){const m=Th(p,this._granularity,!0),x=this._pointArrayToIndices(m),w=[];for(let C=1;C<x.length;C++)w.push(x[C-1]),w.push(x[C]);l.push(w)}return l}_handlePoles(s){let l=!1,p=!1;this._canonical&&(this._canonical.y===0&&(l=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(l||p)&&this._fillPoles(s,l,p)}_ensureNoPoleVertices(){const s=this._vertexBuffer;for(let l=0;l<s.length;l+=2){const p=s[l+1];p===Tp&&(s[l+1]=-32767),p===Og&&(s[l+1]=32766)}}_generatePoleQuad(s,l,p,m,x,w){m>x!=(w===Tp)?(s.push(l),s.push(p),s.push(this._vertexToIndex(m,w)),s.push(p),s.push(this._vertexToIndex(x,w)),s.push(this._vertexToIndex(m,w))):(s.push(p),s.push(l),s.push(this._vertexToIndex(m,w)),s.push(this._vertexToIndex(x,w)),s.push(p),s.push(this._vertexToIndex(m,w)))}_fillPoles(s,l,p){const m=this._vertexBuffer,x=rt,w=s.length;for(let C=2;C<w;C+=3){const I=s[C-2],A=s[C-1],D=s[C],N=m[2*I],U=m[2*I+1],G=m[2*A],q=m[2*A+1],X=m[2*D],Q=m[2*D+1];l&&(U===0&&q===0&&this._generatePoleQuad(s,I,A,N,G,Tp),q===0&&Q===0&&this._generatePoleQuad(s,A,D,G,X,Tp),Q===0&&U===0&&this._generatePoleQuad(s,D,I,X,N,Tp)),p&&(U===x&&q===x&&this._generatePoleQuad(s,I,A,N,G,Og),q===x&&Q===x&&this._generatePoleQuad(s,A,D,G,X,Og),Q===x&&U===x&&this._generatePoleQuad(s,D,I,X,N,Og))}}_initializeVertices(s){for(let l=0;l<s.length;l+=2)this._vertexToIndex(s[l],s[l+1])}subdividePolygonInternal(s,l){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:p,holeIndices:m}=(function(C){const I=[],A=[];for(const D of C)if(D.length!==0){D!==C[0]&&I.push(A.length/2);for(let N=0;N<D.length;N++)A.push(D[N].x),A.push(D[N].y)}return{flattened:A,holeIndices:I}})(s);let x;this._initializeVertices(p);try{const C=(function(A,D,N=2){const U=D&&D.length,G=U?D[0]*N:A.length;let q=SM(A,0,G,N,!0);const X=[];if(!q||q.next===q.prev)return X;let Q,ne,ye;if(U&&(q=(function(ue,de,Me,Le){const Ze=[];for(let ct=0,et=de.length;ct<et;ct++){const at=SM(ue,de[ct]*Le,ct<et-1?de[ct+1]*Le:ue.length,Le,!1);at===at.next&&(at.steiner=!0),Ze.push(oj(at))}Ze.sort(rj);for(let ct=0;ct<Ze.length;ct++)Me=nj(Ze[ct],Me);return Me})(A,D,q,N)),A.length>80*N){Q=A[0],ne=A[1];let ue=Q,de=ne;for(let Me=N;Me<G;Me+=N){const Le=A[Me],Ze=A[Me+1];Le<Q&&(Q=Le),Ze<ne&&(ne=Ze),Le>ue&&(ue=Le),Ze>de&&(de=Ze)}ye=Math.max(ue-Q,de-ne),ye=ye!==0?32767/ye:0}return kg(q,X,N,Q,ne,ye,0),X})(p,m),I=this._convertIndices(p,C);x=this._subdivideTrianglesScanline(I)}catch(C){console.error(C)}let w=[];return l&&(w=this._generateOutline(s)),this._ensureNoPoleVertices(),this._handlePoles(x),{verticesFlattened:this._vertexBuffer,indicesTriangles:x,indicesLineList:w}}_convertIndices(s,l){const p=[];for(let m=0;m<l.length;m++)p.push(this._vertexToIndex(s[2*l[m]],s[2*l[m]+1]));return p}_pointArrayToIndices(s){const l=[];for(let p=0;p<s.length;p++){const m=s[p];l.push(this._vertexToIndex(m.x,m.y))}return l}}function $M(c,s,l,p=!0){return new lj(l,s).subdividePolygonInternal(c,p)}function Th(c,s,l=!1){if(!c||c.length<1)return[];if(c.length<2)return[];const p=c[0],m=c[c.length-1],x=l&&(p.x!==m.x||p.y!==m.y);if(s<2)return x?[...c,c[0]]:[...c];const w=Math.floor(rt/s),C=[];C.push(new _(c[0].x,c[0].y));const I=c.length,A=x?I:I-1;for(let D=0;D<A;D++){const N=c[D],U=D<I-1?c[D+1]:c[0],G=N.x,q=N.y,X=U.x,Q=U.y,ne=G!==X,ye=q!==Q;if(!ne&&!ye)continue;const ue=X-G,de=Q-q,Me=Math.abs(ue),Le=Math.abs(de);let Ze=G,ct=q;for(;;){const at=ue>0?(Math.floor(Ze/w)+1)*w:(Math.ceil(Ze/w)-1)*w,Et=de>0?(Math.floor(ct/w)+1)*w:(Math.ceil(ct/w)-1)*w,ot=Math.abs(Ze-at),lt=Math.abs(ct-Et),Ue=Math.abs(Ze-X),kt=Math.abs(ct-Q),At=ne?ot/Me:Number.POSITIVE_INFINITY,$t=ye?lt/Le:Number.POSITIVE_INFINITY;if((Ue<=ot||!ne)&&(kt<=lt||!ye))break;if(At<$t&&ne||!ye){Ze=at,ct+=de*At;const wt=new _(Ze,Math.round(ct));C[C.length-1].x===wt.x&&C[C.length-1].y===wt.y||C.push(wt)}else{Ze+=ue*$t,ct=Et;const wt=new _(Math.round(Ze),ct);C[C.length-1].x===wt.x&&C[C.length-1].y===wt.y||C.push(wt)}}const et=new _(X,Q);C[C.length-1].x===et.x&&C[C.length-1].y===et.y||C.push(et)}return C}function cj(c,s,l){if(s.length===0)throw new Error("Subdivision vertex ring is empty.");let p=0,m=c[2*s[0]];for(let I=1;I<s.length;I++){const A=c[2*s[I]];A<m&&(m=A,p=I)}const x=s.length;let w=p,C=(w+1)%x;for(;;){const I=w-1>=0?w-1:x-1,A=(C+1)%x,D=c[2*s[I]],N=c[2*s[A]],U=c[2*s[w]],G=c[2*s[w]+1],q=c[2*s[C]+1];let X=!1;if(D<N)X=!0;else if(D>N)X=!1;else{const Q=q-G,ne=-(c[2*s[C]]-U),ye=G<q?1:-1;((D-U)*Q+(c[2*s[I]+1]-G)*ne)*ye>((N-U)*Q+(c[2*s[A]+1]-G)*ne)*ye&&(X=!0)}if(X){const Q=s[I],ne=s[w],ye=s[C];Q!==ne&&Q!==ye&&ne!==ye&&l.push(ye,ne,Q),w--,w<0&&(w=x-1)}else{const Q=s[A],ne=s[w],ye=s[C];Q!==ne&&Q!==ye&&ne!==ye&&l.push(ye,ne,Q),C++,C>=x&&(C=0)}if(I===A)break}}function PM(c,s,l,p,m,x,w,C,I){const A=m.length/2,D=w&&C&&I;if(A<Bt.MAX_VERTEX_ARRAY_LENGTH){const N=s.prepareSegment(A,l,p),U=N.vertexLength;for(let X=0;X<x.length;X+=3)p.emplaceBack(U+x[X],U+x[X+1],U+x[X+2]);let G,q;N.vertexLength+=A,N.primitiveLength+=x.length/3,D&&(q=w.prepareSegment(A,l,C),G=q.vertexLength,q.vertexLength+=A);for(let X=0;X<m.length;X+=2)c(m[X],m[X+1]);if(D)for(let X=0;X<I.length;X++){const Q=I[X];for(let ne=1;ne<Q.length;ne+=2)C.emplaceBack(G+Q[ne-1],G+Q[ne]);q.primitiveLength+=Q.length/2}}else(function(N,U,G,q,X,Q){const ne=[];for(let Le=0;Le<q.length/2;Le++)ne.push(-1);const ye={count:0};let ue=0,de=N.getOrCreateLatestSegment(U,G),Me=de.vertexLength;for(let Le=2;Le<X.length;Le+=3){const Ze=X[Le-2],ct=X[Le-1],et=X[Le];let at=ne[Ze]<ue,Et=ne[ct]<ue,ot=ne[et]<ue;de.vertexLength+((at?1:0)+(Et?1:0)+(ot?1:0))>Bt.MAX_VERTEX_ARRAY_LENGTH&&(de=N.createNewSegment(U,G),ue=ye.count,at=!0,Et=!0,ot=!0,Me=0);const lt=Rg(ne,q,Q,ye,Ze,at,de),Ue=Rg(ne,q,Q,ye,ct,Et,de),kt=Rg(ne,q,Q,ye,et,ot,de);G.emplaceBack(Me+lt-ue,Me+Ue-ue,Me+kt-ue),de.primitiveLength++}})(s,l,p,m,x,c),D&&(function(N,U,G,q,X,Q){const ne=[];for(let Le=0;Le<q.length/2;Le++)ne.push(-1);const ye={count:0};let ue=0,de=N.getOrCreateLatestSegment(U,G),Me=de.vertexLength;for(let Le=0;Le<X.length;Le++){const Ze=X[Le];for(let ct=1;ct<X[Le].length;ct+=2){const et=Ze[ct-1],at=Ze[ct];let Et=ne[et]<ue,ot=ne[at]<ue;de.vertexLength+((Et?1:0)+(ot?1:0))>Bt.MAX_VERTEX_ARRAY_LENGTH&&(de=N.createNewSegment(U,G),ue=ye.count,Et=!0,ot=!0,Me=0);const lt=Rg(ne,q,Q,ye,et,Et,de),Ue=Rg(ne,q,Q,ye,at,ot,de);G.emplaceBack(Me+lt-ue,Me+Ue-ue),de.primitiveLength++}}})(w,l,C,m,I,c),s.forceNewSegmentOnNextPrepare(),w?.forceNewSegmentOnNextPrepare()}function Rg(c,s,l,p,m,x,w){if(x){const C=p.count;return l(s[2*m],s[2*m+1]),c[m]=p.count,p.count++,w.vertexLength++,C}return c[m]}class z2{constructor(s){this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((l=>l.id)),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Oe,this.indexArray=new Ti,this.indexArray2=new wi,this.programConfigurations=new rs(s.layers,s.zoom),this.segments=new Bt,this.segments2=new Bt,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id))}populate(s,l,p){this.hasPattern=M2("fill",this.layers,l);const m=this.layers[0].layout.get("fill-sort-key"),x=!m.isConstant(),w=[];for(const{feature:C,id:I,index:A,sourceLayerIndex:D}of s){const N=this.layers[0]._featureFilter.needGeometry,U=Ko(C,N);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom,{globalState:this.globalState}),U,p))continue;const G=x?m.evaluate(U,{},p,l.availableImages):void 0,q={id:I,properties:C.properties,type:C.type,sourceLayerIndex:D,index:A,geometry:N?U.geometry:Xa(C),patterns:{},sortKey:G};w.push(q)}x&&w.sort(((C,I)=>C.sortKey-I.sortKey));for(const C of w){const{geometry:I,index:A,sourceLayerIndex:D}=C;if(this.hasPattern){const N=k2("fill",this.layers,C,{zoom:this.zoom,globalState:this.globalState},l);this.patternFeatures.push(N)}else this.addFeature(C,I,A,p,{},l.subdivisionGranularity);l.featureIndex.insert(s[A].feature,I,A,D,this.index)}}update(s,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,{imagePositions:p,globalState:this.globalState})}addFeatures(s,l,p){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,p,s.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,K8),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,l,p,m,x,w){for(const C of ah(l,500)){const I=$M(C,m,w.fill.getGranularityForZoomLevel(m.z)),A=this.layoutVertexArray;PM(((D,N)=>{A.emplaceBack(D,N)}),this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles,this.segments2,this.indexArray2,I.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{imagePositions:x,canonical:m,globalState:this.globalState})}}let MM,kM;ft("FillBucket",z2,{omit:["layers","patternFeatures"]});var uj={get paint(){return kM=kM||new En({"fill-antialias":new Tt(Te.paint_fill["fill-antialias"]),"fill-opacity":new Pt(Te.paint_fill["fill-opacity"]),"fill-color":new Pt(Te.paint_fill["fill-color"]),"fill-outline-color":new Pt(Te.paint_fill["fill-outline-color"]),"fill-translate":new Tt(Te.paint_fill["fill-translate"]),"fill-translate-anchor":new Tt(Te.paint_fill["fill-translate-anchor"]),"fill-pattern":new fp(Te.paint_fill["fill-pattern"])})},get layout(){return MM=MM||new En({"fill-sort-key":new Pt(Te.layout_fill["fill-sort-key"])})}};class hj extends _s{constructor(s){super(s,uj)}recalculate(s,l){super.recalculate(s,l);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new z2(s)}queryRadius(){return uv(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:s,geometry:l,transform:p,pixelsToTileUnits:m}){return cM(hv(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-p.bearingInRadians,m),l)}isTileClipped(){return!0}}const dj=ir([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),pj=ir([{name:"a_centroid",components:2,type:"Int16"}],4),{members:fj}=dj;class Cp{constructor(s,l,p,m,x){this.properties={},this.extent=p,this.type=0,this.id=void 0,this._pbf=s,this._geometry=-1,this._keys=m,this._values=x,s.readFields(mj,this,l)}loadGeometry(){const s=this._pbf;s.pos=this._geometry;const l=s.readVarint()+s.pos,p=[];let m,x=1,w=0,C=0,I=0;for(;s.pos<l;){if(w<=0){const A=s.readVarint();x=7&A,w=A>>3}if(w--,x===1||x===2)C+=s.readSVarint(),I+=s.readSVarint(),x===1&&(m&&p.push(m),m=[]),m&&m.push(new _(C,I));else{if(x!==7)throw new Error(`unknown command ${x}`);m&&m.push(m[0].clone())}}return m&&p.push(m),p}bbox(){const s=this._pbf;s.pos=this._geometry;const l=s.readVarint()+s.pos;let p=1,m=0,x=0,w=0,C=1/0,I=-1/0,A=1/0,D=-1/0;for(;s.pos<l;){if(m<=0){const N=s.readVarint();p=7&N,m=N>>3}if(m--,p===1||p===2)x+=s.readSVarint(),w+=s.readSVarint(),x<C&&(C=x),x>I&&(I=x),w<A&&(A=w),w>D&&(D=w);else if(p!==7)throw new Error(`unknown command ${p}`)}return[C,A,I,D]}toGeoJSON(s,l,p){const m=this.extent*Math.pow(2,p),x=this.extent*s,w=this.extent*l,C=this.loadGeometry();function I(U){return[360*(U.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(U.y+w)/m)*Math.PI))-90]}function A(U){return U.map(I)}let D;if(this.type===1){const U=[];for(const q of C)U.push(q[0]);const G=A(U);D=U.length===1?{type:"Point",coordinates:G[0]}:{type:"MultiPoint",coordinates:G}}else if(this.type===2){const U=C.map(A);D=U.length===1?{type:"LineString",coordinates:U[0]}:{type:"MultiLineString",coordinates:U}}else{if(this.type!==3)throw new Error("unknown feature type");{const U=(function(q){const X=q.length;if(X<=1)return[q];const Q=[];let ne,ye;for(let ue=0;ue<X;ue++){const de=gj(q[ue]);de!==0&&(ye===void 0&&(ye=de<0),ye===de<0?(ne&&Q.push(ne),ne=[q[ue]]):ne&&ne.push(q[ue]))}return ne&&Q.push(ne),Q})(C),G=[];for(const q of U)G.push(q.map(A));D=G.length===1?{type:"Polygon",coordinates:G[0]}:{type:"MultiPolygon",coordinates:G}}}const N={type:"Feature",geometry:D,properties:this.properties};return this.id!=null&&(N.id=this.id),N}}function mj(c,s,l){c===1?s.id=l.readVarint():c===2?(function(p,m){const x=p.readVarint()+p.pos;for(;p.pos<x;){const w=m._keys[p.readVarint()],C=m._values[p.readVarint()];m.properties[w]=C}})(l,s):c===3?s.type=l.readVarint():c===4&&(s._geometry=l.pos)}function gj(c){let s=0;for(let l,p,m=0,x=c.length,w=x-1;m<x;w=m++)l=c[m],p=c[w],s+=(p.x-l.x)*(l.y+p.y);return s}Cp.types=["Unknown","Point","LineString","Polygon"];class AM{constructor(s,l){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(yj,this,l),this.length=this._features.length}feature(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];const l=this._pbf.readVarint()+this._pbf.pos;return new Cp(this._pbf,l,this.extent,this._keys,this._values)}}function yj(c,s,l){c===15?s.version=l.readVarint():c===1?s.name=l.readString():c===5?s.extent=l.readVarint():c===2?s._features.push(l.pos):c===3?s._keys.push(l.readString()):c===4&&s._values.push((function(p){let m=null;const x=p.readVarint()+p.pos;for(;p.pos<x;){const w=p.readVarint()>>3;m=w===1?p.readString():w===2?p.readFloat():w===3?p.readDouble():w===4?p.readVarint64():w===5?p.readVarint():w===6?p.readSVarint():w===7?p.readBoolean():null}if(m==null)throw new Error("unknown feature value");return m})(l))}class DM{constructor(s,l){this.layers=s.readFields(_j,{},l)}}function _j(c,s,l){if(c===3){const p=new AM(l,l.readVarint()+l.pos);p.length&&(s[p.name]=p)}}const O2=Math.pow(2,13);function Lg(c,s,l,p,m,x,w,C){c.emplaceBack(s,l,2*Math.floor(p*O2)+w,m*O2*2,x*O2*2,Math.round(C))}class R2{constructor(s){this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((l=>l.id)),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Ie,this.centroidVertexArray=new ae,this.indexArray=new Ti,this.programConfigurations=new rs(s.layers,s.zoom),this.segments=new Bt,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id))}populate(s,l,p){this.features=[],this.hasPattern=M2("fill-extrusion",this.layers,l);for(const{feature:m,id:x,index:w,sourceLayerIndex:C}of s){const I=this.layers[0]._featureFilter.needGeometry,A=Ko(m,I);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom,{globalState:this.globalState}),A,p))continue;const D={id:x,sourceLayerIndex:C,index:w,geometry:I?A.geometry:Xa(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(k2("fill-extrusion",this.layers,D,{zoom:this.zoom,globalState:this.globalState},l)):this.addFeature(D,D.geometry,w,p,{},l.subdivisionGranularity),l.featureIndex.insert(m,D.geometry,w,C,this.index,!0)}}addFeatures(s,l,p){for(const m of this.features){const{geometry:x}=m;this.addFeature(m,x,m.index,l,p,s.subdivisionGranularity)}}update(s,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,{imagePositions:p,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,fj),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,pj.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,l,p,m,x,w){for(const C of ah(l,500)){const I={x:0,y:0,sampleCount:0},A=this.layoutVertexArray.length;this.processPolygon(I,m,s,C,w);const D=this.layoutVertexArray.length-A,N=Math.floor(I.x/I.sampleCount),U=Math.floor(I.y/I.sampleCount);for(let G=0;G<D;G++)this.centroidVertexArray.emplaceBack(N,U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{imagePositions:x,canonical:m,globalState:this.globalState})}processPolygon(s,l,p,m,x){if(m.length<1||zM(m[0]))return;for(const N of m)N.length!==0&&vj(s,N);const w={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},C=x.fill.getGranularityForZoomLevel(l.z),I=Cp.types[p.type]==="Polygon";for(const N of m){if(N.length===0||zM(N))continue;const U=Th(N,C,I);this._generateSideFaces(U,w)}if(!I)return;const A=$M(m,l,C,!1),D=this.layoutVertexArray;PM(((N,U)=>{Lg(D,N,U,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,A.verticesFlattened,A.indicesTriangles)}_generateSideFaces(s,l){let p=0;for(let m=1;m<s.length;m++){const x=s[m],w=s[m-1];if(bj(x,w))continue;l.segment.vertexLength+4>Bt.MAX_VERTEX_ARRAY_LENGTH&&(l.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const C=x.sub(w)._perp()._unit(),I=w.dist(x);p+I>32768&&(p=0),Lg(this.layoutVertexArray,x.x,x.y,C.x,C.y,0,0,p),Lg(this.layoutVertexArray,x.x,x.y,C.x,C.y,0,1,p),p+=I,Lg(this.layoutVertexArray,w.x,w.y,C.x,C.y,0,0,p),Lg(this.layoutVertexArray,w.x,w.y,C.x,C.y,0,1,p);const A=l.segment.vertexLength;this.indexArray.emplaceBack(A,A+2,A+1),this.indexArray.emplaceBack(A+1,A+2,A+3),l.segment.vertexLength+=4,l.segment.primitiveLength+=2}}}function vj(c,s){for(let l=0;l<s.length;l++){const p=s[l];l===s.length-1&&s[0].x===p.x&&s[0].y===p.y||(c.x+=p.x,c.y+=p.y,c.sampleCount++)}}function bj(c,s){return c.x===s.x&&(c.x<0||c.x>rt)||c.y===s.y&&(c.y<0||c.y>rt)}function zM(c){return c.every((s=>s.x<0))||c.every((s=>s.x>rt))||c.every((s=>s.y<0))||c.every((s=>s.y>rt))}let OM;ft("FillExtrusionBucket",R2,{omit:["layers","features"]});var xj={get paint(){return OM=OM||new En({"fill-extrusion-opacity":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Pt(Te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fp(Te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Pt(Te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Pt(Te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class wj extends _s{constructor(s){super(s,xj)}createBucket(s){return new R2(s)}queryRadius(){return uv(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:s,feature:l,featureState:p,geometry:m,transform:x,pixelsToTileUnits:w,pixelPosMatrix:C}){const I=hv(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-x.bearingInRadians,w),A=this.paint.get("fill-extrusion-height").evaluate(l,p),D=this.paint.get("fill-extrusion-base").evaluate(l,p),N=(function(G,q){const X=[];for(const Q of G){const ne=[Q.x,Q.y,0,1];Ee(ne,ne,q),X.push(new _(ne[0]/ne[3],ne[1]/ne[3]))}return X})(I,C),U=(function(G,q,X,Q){const ne=[],ye=[],ue=Q[8]*q,de=Q[9]*q,Me=Q[10]*q,Le=Q[11]*q,Ze=Q[8]*X,ct=Q[9]*X,et=Q[10]*X,at=Q[11]*X;for(const Et of G){const ot=[],lt=[];for(const Ue of Et){const kt=Ue.x,At=Ue.y,$t=Q[0]*kt+Q[4]*At+Q[12],wt=Q[1]*kt+Q[5]*At+Q[13],si=Q[2]*kt+Q[6]*At+Q[14],Xi=Q[3]*kt+Q[7]*At+Q[15],kr=si+Me,yn=Xi+Le,Ys=$t+Ze,ss=wt+ct,on=si+et,qi=Xi+at,qr=new _(($t+ue)/yn,(wt+de)/yn);qr.z=kr/yn,ot.push(qr);const an=new _(Ys/qi,ss/qi);an.z=on/qi,lt.push(an)}ne.push(ot),ye.push(lt)}return[ne,ye]})(m,D,A,C);return(function(G,q,X){let Q=1/0;cM(X,q)&&(Q=RM(X,q[0]));for(let ne=0;ne<q.length;ne++){const ye=q[ne],ue=G[ne];for(let de=0;de<ye.length-1;de++){const Me=ye[de],Le=[Me,ye[de+1],ue[de+1],ue[de],Me];lM(X,Le)&&(Q=Math.min(Q,RM(X,Le)))}}return Q!==1/0&&Q})(U[0],U[1],N)}}function Fg(c,s){return c.x*s.x+c.y*s.y}function RM(c,s){if(c.length===1){let l=0;const p=s[l++];let m;for(;!m||p.equals(m);)if(m=s[l++],!m)return 1/0;for(;l<s.length;l++){const x=s[l],w=c[0],C=m.sub(p),I=x.sub(p),A=w.sub(p),D=Fg(C,C),N=Fg(C,I),U=Fg(I,I),G=Fg(A,C),q=Fg(A,I),X=D*U-N*N,Q=(U*G-N*q)/X,ne=(D*q-N*G)/X,ye=p.z*(1-Q-ne)+m.z*Q+x.z*ne;if(isFinite(ye))return ye}return 1/0}{let l=1/0;for(const p of s)l=Math.min(l,p.z);return l}}const Sj=ir([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Tj}=Sj,Cj=ir([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ej}=Cj,Ij=Math.cos(Math.PI/180*37.5),LM=Math.pow(2,14)/.5;class L2{constructor(s){this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((l=>l.id)),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((l=>{this.gradients[l.id]={}})),this.layoutVertexArray=new $e,this.layoutVertexArray2=new De,this.indexArray=new Ti,this.programConfigurations=new rs(s.layers,s.zoom),this.segments=new Bt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id))}populate(s,l,p){this.hasPattern=M2("line",this.layers,l);const m=this.layers[0].layout.get("line-sort-key"),x=!m.isConstant(),w=[];for(const{feature:C,id:I,index:A,sourceLayerIndex:D}of s){const N=this.layers[0]._featureFilter.needGeometry,U=Ko(C,N);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom,{globalState:this.globalState}),U,p))continue;const G=x?m.evaluate(U,{},p):void 0,q={id:I,properties:C.properties,type:C.type,sourceLayerIndex:D,index:A,geometry:N?U.geometry:Xa(C),patterns:{},sortKey:G};w.push(q)}x&&w.sort(((C,I)=>C.sortKey-I.sortKey));for(const C of w){const{geometry:I,index:A,sourceLayerIndex:D}=C;if(this.hasPattern){const N=k2("line",this.layers,C,{zoom:this.zoom,globalState:this.globalState},l);this.patternFeatures.push(N)}else this.addFeature(C,I,A,p,{},l.subdivisionGranularity);l.featureIndex.insert(s[A].feature,I,A,D,this.index)}}update(s,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,{imagePositions:p,globalState:this.globalState})}addFeatures(s,l,p){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,p,s.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Ej)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Tj),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,l,p,m,x,w){const C=this.layers[0].layout,I=C.get("line-join").evaluate(s,{}),A=C.get("line-cap"),D=C.get("line-miter-limit"),N=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const U of l)this.addLine(U,s,I,A,D,N,m,w);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{imagePositions:x,canonical:m,globalState:this.globalState})}addLine(s,l,p,m,x,w,C,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,s=Th(s,C?I.line.getGranularityForZoomLevel(C.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<s.length-1;ue++)this.totalDistance+=s[ue].dist(s[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const A=Cp.types[l.type]==="Polygon";let D=s.length;for(;D>=2&&s[D-1].equals(s[D-2]);)D--;let N=0;for(;N<D-1&&s[N].equals(s[N+1]);)N++;if(D<(A?3:2))return;p==="bevel"&&(x=1.05);const U=this.overscaling<=16?122880/(512*this.overscaling):0,G=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let q,X,Q,ne,ye;this.e1=this.e2=-1,A&&(q=s[D-2],ye=s[N].sub(q)._unit()._perp());for(let ue=N;ue<D;ue++){if(Q=ue===D-1?A?s[N+1]:void 0:s[ue+1],Q&&s[ue].equals(Q))continue;ye&&(ne=ye),q&&(X=q),q=s[ue],ye=Q?Q.sub(q)._unit()._perp():ne,ne=ne||ye;let de=ne.add(ye);de.x===0&&de.y===0||de._unit();const Me=ne.x*ye.x+ne.y*ye.y,Le=de.x*ye.x+de.y*ye.y,Ze=Le!==0?1/Le:1/0,ct=2*Math.sqrt(2-2*Le),et=Le<Ij&&X&&Q,at=ne.x*ye.y-ne.y*ye.x>0;if(et&&ue>N){const lt=q.dist(X);if(lt>2*U){const Ue=q.sub(q.sub(X)._mult(U/lt)._round());this.updateDistance(X,Ue),this.addCurrentVertex(Ue,ne,0,0,G),X=Ue}}const Et=X&&Q;let ot=Et?p:A?"butt":m;if(Et&&ot==="round"&&(Ze<w?ot="miter":Ze<=2&&(ot="fakeround")),ot==="miter"&&Ze>x&&(ot="bevel"),ot==="bevel"&&(Ze>2&&(ot="flipbevel"),Ze<x&&(ot="miter")),X&&this.updateDistance(X,q),ot==="miter")de._mult(Ze),this.addCurrentVertex(q,de,0,0,G);else if(ot==="flipbevel"){if(Ze>100)de=ye.mult(-1);else{const lt=Ze*ne.add(ye).mag()/ne.sub(ye).mag();de._perp()._mult(lt*(at?-1:1))}this.addCurrentVertex(q,de,0,0,G),this.addCurrentVertex(q,de.mult(-1),0,0,G)}else if(ot==="bevel"||ot==="fakeround"){const lt=-Math.sqrt(Ze*Ze-1),Ue=at?lt:0,kt=at?0:lt;if(X&&this.addCurrentVertex(q,ne,Ue,kt,G),ot==="fakeround"){const At=Math.round(180*ct/Math.PI/20);for(let $t=1;$t<At;$t++){let wt=$t/At;if(wt!==.5){const Xi=wt-.5;wt+=wt*Xi*(wt-1)*((1.0904+Me*(Me*(3.55645-1.43519*Me)-3.2452))*Xi*Xi+(.848013+Me*(.215638*Me-1.06021)))}const si=ye.sub(ne)._mult(wt)._add(ne)._unit()._mult(at?-1:1);this.addHalfVertex(q,si.x,si.y,!1,at,0,G)}}Q&&this.addCurrentVertex(q,ye,-Ue,-kt,G)}else if(ot==="butt")this.addCurrentVertex(q,de,0,0,G);else if(ot==="square"){const lt=X?1:-1;this.addCurrentVertex(q,de,lt,lt,G)}else ot==="round"&&(X&&(this.addCurrentVertex(q,ne,0,0,G),this.addCurrentVertex(q,ne,1,1,G,!0)),Q&&(this.addCurrentVertex(q,ye,-1,-1,G,!0),this.addCurrentVertex(q,ye,0,0,G)));if(et&&ue<D-1){const lt=q.dist(Q);if(lt>2*U){const Ue=q.add(Q.sub(q)._mult(U/lt)._round());this.updateDistance(q,Ue),this.addCurrentVertex(Ue,ye,0,0,G),q=Ue}}}}addCurrentVertex(s,l,p,m,x,w=!1){const C=l.y*m-l.x,I=-l.y-l.x*m;this.addHalfVertex(s,l.x+l.y*p,l.y-l.x*p,w,!1,p,x),this.addHalfVertex(s,C,I,w,!0,-m,x),this.distance>LM/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,l,p,m,x,w))}addHalfVertex({x:s,y:l},p,m,x,w,C,I){const A=.5*(this.lineClips?this.scaledDistance*(LM-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(x?1:0),(l<<1)+(w?1:0),Math.round(63*p)+128,Math.round(63*m)+128,1+(C===0?0:C<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),I.primitiveLength++),w?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,l){this.distance+=s.dist(l),this.updateScaledDistance()}}let FM,NM;ft("LineBucket",L2,{omit:["layers","patternFeatures"]});var BM={get paint(){return NM=NM||new En({"line-opacity":new Pt(Te.paint_line["line-opacity"]),"line-color":new Pt(Te.paint_line["line-color"]),"line-translate":new Tt(Te.paint_line["line-translate"]),"line-translate-anchor":new Tt(Te.paint_line["line-translate-anchor"]),"line-width":new Pt(Te.paint_line["line-width"]),"line-gap-width":new Pt(Te.paint_line["line-gap-width"]),"line-offset":new Pt(Te.paint_line["line-offset"]),"line-blur":new Pt(Te.paint_line["line-blur"]),"line-dasharray":new qa(Te.paint_line["line-dasharray"]),"line-pattern":new fp(Te.paint_line["line-pattern"]),"line-gradient":new mp(Te.paint_line["line-gradient"])})},get layout(){return FM=FM||new En({"line-cap":new Tt(Te.layout_line["line-cap"]),"line-join":new Pt(Te.layout_line["line-join"]),"line-miter-limit":new Tt(Te.layout_line["line-miter-limit"]),"line-round-limit":new Tt(Te.layout_line["line-round-limit"]),"line-sort-key":new Pt(Te.layout_line["line-sort-key"])})}};class $j extends Pt{possiblyEvaluate(s,l){return l=new Pi(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(s,l)}evaluate(s,l,p,m){return l=dn({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(s,l,p,m)}}let mv;class Pj extends _s{constructor(s){super(s,BM),this.gradientVersion=0,mv||(mv=new $j(BM.paint.properties["line-width"].specification),mv.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const l=this.gradientExpression();this.stepInterpolant=!!(function(p){return p._styleExpression!==void 0})(l)&&l._styleExpression.expression instanceof tr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,l){super.recalculate(s,l),this.paint._values["line-floorwidth"]=mv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new L2(s)}queryRadius(s){const l=s,p=jM(Pg("line-width",this,l),Pg("line-gap-width",this,l)),m=Pg("line-offset",this,l);return p/2+Math.abs(m)+uv(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:s,feature:l,featureState:p,geometry:m,transform:x,pixelsToTileUnits:w}){const C=hv(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-x.bearingInRadians,w),I=w/2*jM(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),A=this.paint.get("line-offset").evaluate(l,p);return A&&(m=(function(D,N){const U=[];for(let G=0;G<D.length;G++){const q=D[G],X=[];for(let Q=0;Q<q.length;Q++){const ne=q[Q-1],ye=q[Q],ue=q[Q+1],de=Q===0?new _(0,0):ye.sub(ne)._unit()._perp(),Me=Q===q.length-1?new _(0,0):ue.sub(ye)._unit()._perp(),Le=de._add(Me)._unit(),Ze=Le.x*Me.x+Le.y*Me.y;Ze!==0&&Le._mult(1/Ze),X.push(Le._mult(N)._add(ye))}U.push(X)}return U})(m,A*w)),(function(D,N,U){for(let G=0;G<N.length;G++){const q=N[G];if(D.length>=3){for(let X=0;X<q.length;X++)if(xp(D,q[X]))return!0}if(B8(D,q,U))return!0}return!1})(C,m,I)}isTileClipped(){return!0}}function jM(c,s){return s>0?s+2*c:c}const Mj=ir([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),kj=ir([{name:"a_projected_pos",components:3,type:"Float32"}],4);ir([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Aj=ir([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ir([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const UM=ir([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Dj=ir([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zj(c,s,l){return c.sections.forEach((p=>{p.text=(function(m,x,w){const C=x.layout.get("text-transform").evaluate(w,{});return C==="uppercase"?m=m.toLocaleUpperCase():C==="lowercase"&&(m=m.toLocaleLowerCase()),Gs.applyArabicShaping&&(m=Gs.applyArabicShaping(m)),m})(p.text,s,l)})),c}ir([{name:"triangle",components:3,type:"Uint16"}]),ir([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ir([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ir([{type:"Float32",name:"offsetX"}]),ir([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ir([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ng={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Gr=24;const F2=4294967296,VM=1/F2,GM=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class N2{constructor(s=new Uint8Array(16)){this.buf=ArrayBuffer.isView(s)?s:new Uint8Array(s),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(s,l,p=this.length){for(;this.pos<p;){const m=this.readVarint(),x=m>>3,w=this.pos;this.type=7&m,s(x,l,this),this.pos===w&&this.skip(m)}return l}readMessage(s,l){return this.readFields(s,l,this.readVarint()+this.pos)}readFixed32(){const s=this.dataView.getUint32(this.pos,!0);return this.pos+=4,s}readSFixed32(){const s=this.dataView.getInt32(this.pos,!0);return this.pos+=4,s}readFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*F2;return this.pos+=8,s}readSFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*F2;return this.pos+=8,s}readFloat(){const s=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,s}readDouble(){const s=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,s}readVarint(s){const l=this.buf;let p,m;return m=l[this.pos++],p=127&m,m<128?p:(m=l[this.pos++],p|=(127&m)<<7,m<128?p:(m=l[this.pos++],p|=(127&m)<<14,m<128?p:(m=l[this.pos++],p|=(127&m)<<21,m<128?p:(m=l[this.pos],p|=(15&m)<<28,(function(x,w,C){const I=C.buf;let A,D;if(D=I[C.pos++],A=(112&D)>>4,D<128||(D=I[C.pos++],A|=(127&D)<<3,D<128)||(D=I[C.pos++],A|=(127&D)<<10,D<128)||(D=I[C.pos++],A|=(127&D)<<17,D<128)||(D=I[C.pos++],A|=(127&D)<<24,D<128)||(D=I[C.pos++],A|=(1&D)<<31,D<128))return Ep(x,A,w);throw new Error("Expected varint not more than 10 bytes")})(p,s,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const s=this.readVarint();return s%2==1?(s+1)/-2:s/2}readBoolean(){return!!this.readVarint()}readString(){const s=this.readVarint()+this.pos,l=this.pos;return this.pos=s,s-l>=12&&GM?GM.decode(this.buf.subarray(l,s)):(function(p,m,x){let w="",C=m;for(;C<x;){const I=p[C];let A,D,N,U=null,G=I>239?4:I>223?3:I>191?2:1;if(C+G>x)break;G===1?I<128&&(U=I):G===2?(A=p[C+1],(192&A)==128&&(U=(31&I)<<6|63&A,U<=127&&(U=null))):G===3?(A=p[C+1],D=p[C+2],(192&A)==128&&(192&D)==128&&(U=(15&I)<<12|(63&A)<<6|63&D,(U<=2047||U>=55296&&U<=57343)&&(U=null))):G===4&&(A=p[C+1],D=p[C+2],N=p[C+3],(192&A)==128&&(192&D)==128&&(192&N)==128&&(U=(15&I)<<18|(63&A)<<12|(63&D)<<6|63&N,(U<=65535||U>=1114112)&&(U=null))),U===null?(U=65533,G=1):U>65535&&(U-=65536,w+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),w+=String.fromCharCode(U),C+=G}return w})(this.buf,l,s)}readBytes(){const s=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,s);return this.pos=s,l}readPackedVarint(s=[],l){const p=this.readPackedEnd();for(;this.pos<p;)s.push(this.readVarint(l));return s}readPackedSVarint(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readSVarint());return s}readPackedBoolean(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readBoolean());return s}readPackedFloat(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readFloat());return s}readPackedDouble(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readDouble());return s}readPackedFixed32(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readFixed32());return s}readPackedSFixed32(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readSFixed32());return s}readPackedFixed64(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readFixed64());return s}readPackedSFixed64(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readSFixed64());return s}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(s){const l=7&s;if(l===0)for(;this.buf[this.pos++]>127;);else if(l===2)this.pos=this.readVarint()+this.pos;else if(l===5)this.pos+=4;else{if(l!==1)throw new Error(`Unimplemented type: ${l}`);this.pos+=8}}writeTag(s,l){this.writeVarint(s<<3|l)}realloc(s){let l=this.length||16;for(;l<this.pos+s;)l*=2;if(l!==this.length){const p=new Uint8Array(l);p.set(this.buf),this.buf=p,this.dataView=new DataView(p.buffer),this.length=l}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeSFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*VM),!0),this.pos+=8}writeSFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*VM),!0),this.pos+=8}writeVarint(s){(s=+s||0)>268435455||s<0?(function(l,p){let m,x;if(l>=0?(m=l%4294967296|0,x=l/4294967296|0):(m=~(-l%4294967296),x=~(-l/4294967296),4294967295^m?m=m+1|0:(m=0,x=x+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),(function(w,C,I){I.buf[I.pos++]=127&w|128,w>>>=7,I.buf[I.pos++]=127&w|128,w>>>=7,I.buf[I.pos++]=127&w|128,w>>>=7,I.buf[I.pos++]=127&w|128,I.buf[I.pos]=127&(w>>>=7)})(m,0,p),(function(w,C){const I=(7&w)<<4;C.buf[C.pos++]|=I|((w>>>=3)?128:0),w&&(C.buf[C.pos++]=127&w|((w>>>=7)?128:0),w&&(C.buf[C.pos++]=127&w|((w>>>=7)?128:0),w&&(C.buf[C.pos++]=127&w|((w>>>=7)?128:0),w&&(C.buf[C.pos++]=127&w|((w>>>=7)?128:0),w&&(C.buf[C.pos++]=127&w)))))})(x,p)})(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))}writeSVarint(s){this.writeVarint(s<0?2*-s-1:2*s)}writeBoolean(s){this.writeVarint(+s)}writeString(s){s=String(s),this.realloc(4*s.length),this.pos++;const l=this.pos;this.pos=(function(m,x,w){for(let C,I,A=0;A<x.length;A++){if(C=x.charCodeAt(A),C>55295&&C<57344){if(!I){C>56319||A+1===x.length?(m[w++]=239,m[w++]=191,m[w++]=189):I=C;continue}if(C<56320){m[w++]=239,m[w++]=191,m[w++]=189,I=C;continue}C=I-55296<<10|C-56320|65536,I=null}else I&&(m[w++]=239,m[w++]=191,m[w++]=189,I=null);C<128?m[w++]=C:(C<2048?m[w++]=C>>6|192:(C<65536?m[w++]=C>>12|224:(m[w++]=C>>18|240,m[w++]=C>>12&63|128),m[w++]=C>>6&63|128),m[w++]=63&C|128)}return w})(this.buf,s,this.pos);const p=this.pos-l;p>=128&&qM(l,p,this),this.pos=l-1,this.writeVarint(p),this.pos+=p}writeFloat(s){this.realloc(4),this.dataView.setFloat32(this.pos,s,!0),this.pos+=4}writeDouble(s){this.realloc(8),this.dataView.setFloat64(this.pos,s,!0),this.pos+=8}writeBytes(s){const l=s.length;this.writeVarint(l),this.realloc(l);for(let p=0;p<l;p++)this.buf[this.pos++]=s[p]}writeRawMessage(s,l){this.pos++;const p=this.pos;s(l,this);const m=this.pos-p;m>=128&&qM(p,m,this),this.pos=p-1,this.writeVarint(m),this.pos+=m}writeMessage(s,l,p){this.writeTag(s,2),this.writeRawMessage(l,p)}writePackedVarint(s,l){l.length&&this.writeMessage(s,Oj,l)}writePackedSVarint(s,l){l.length&&this.writeMessage(s,Rj,l)}writePackedBoolean(s,l){l.length&&this.writeMessage(s,Nj,l)}writePackedFloat(s,l){l.length&&this.writeMessage(s,Lj,l)}writePackedDouble(s,l){l.length&&this.writeMessage(s,Fj,l)}writePackedFixed32(s,l){l.length&&this.writeMessage(s,Bj,l)}writePackedSFixed32(s,l){l.length&&this.writeMessage(s,jj,l)}writePackedFixed64(s,l){l.length&&this.writeMessage(s,Uj,l)}writePackedSFixed64(s,l){l.length&&this.writeMessage(s,Vj,l)}writeBytesField(s,l){this.writeTag(s,2),this.writeBytes(l)}writeFixed32Field(s,l){this.writeTag(s,5),this.writeFixed32(l)}writeSFixed32Field(s,l){this.writeTag(s,5),this.writeSFixed32(l)}writeFixed64Field(s,l){this.writeTag(s,1),this.writeFixed64(l)}writeSFixed64Field(s,l){this.writeTag(s,1),this.writeSFixed64(l)}writeVarintField(s,l){this.writeTag(s,0),this.writeVarint(l)}writeSVarintField(s,l){this.writeTag(s,0),this.writeSVarint(l)}writeStringField(s,l){this.writeTag(s,2),this.writeString(l)}writeFloatField(s,l){this.writeTag(s,5),this.writeFloat(l)}writeDoubleField(s,l){this.writeTag(s,1),this.writeDouble(l)}writeBooleanField(s,l){this.writeVarintField(s,+l)}}function Ep(c,s,l){return l?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function qM(c,s,l){const p=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));l.realloc(p);for(let m=l.pos-1;m>=c;m--)l.buf[m+p]=l.buf[m]}function Oj(c,s){for(let l=0;l<c.length;l++)s.writeVarint(c[l])}function Rj(c,s){for(let l=0;l<c.length;l++)s.writeSVarint(c[l])}function Lj(c,s){for(let l=0;l<c.length;l++)s.writeFloat(c[l])}function Fj(c,s){for(let l=0;l<c.length;l++)s.writeDouble(c[l])}function Nj(c,s){for(let l=0;l<c.length;l++)s.writeBoolean(c[l])}function Bj(c,s){for(let l=0;l<c.length;l++)s.writeFixed32(c[l])}function jj(c,s){for(let l=0;l<c.length;l++)s.writeSFixed32(c[l])}function Uj(c,s){for(let l=0;l<c.length;l++)s.writeFixed64(c[l])}function Vj(c,s){for(let l=0;l<c.length;l++)s.writeSFixed64(c[l])}function Gj(c,s,l){c===1&&l.readMessage(qj,s)}function qj(c,s,l){if(c===3){const{id:p,bitmap:m,width:x,height:w,left:C,top:I,advance:A}=l.readMessage(Hj,{});s.push({id:p,bitmap:new Mg({width:x+6,height:w+6},m),metrics:{width:x,height:w,left:C,top:I,advance:A}})}}function Hj(c,s,l){c===1?s.id=l.readVarint():c===2?s.bitmap=l.readBytes():c===3?s.width=l.readVarint():c===4?s.height=l.readVarint():c===5?s.left=l.readSVarint():c===6?s.top=l.readSVarint():c===7&&(s.advance=l.readVarint())}function HM(c){let s=0,l=0;for(const w of c)s+=w.w*w.h,l=Math.max(l,w.w);c.sort(((w,C)=>C.h-w.h));const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),l),h:1/0}];let m=0,x=0;for(const w of c)for(let C=p.length-1;C>=0;C--){const I=p[C];if(!(w.w>I.w||w.h>I.h)){if(w.x=I.x,w.y=I.y,x=Math.max(x,w.y+w.h),m=Math.max(m,w.x+w.w),w.w===I.w&&w.h===I.h){const A=p.pop();A&&C<p.length&&(p[C]=A)}else w.h===I.h?(I.x+=w.w,I.w-=w.w):w.w===I.w?(I.y+=w.h,I.h-=w.h):(p.push({x:I.x+w.w,y:I.y,w:I.w-w.w,h:w.h}),I.y+=w.h,I.h-=w.h);break}}return{w:m,h:x,fill:s/(m*x)||0}}class B2{constructor(s,{pixelRatio:l,version:p,stretchX:m,stretchY:x,content:w,textFitWidth:C,textFitHeight:I}){this.paddedRect=s,this.pixelRatio=l,this.stretchX=m,this.stretchY=x,this.content=w,this.version=p,this.textFitWidth=C,this.textFitHeight=I}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ZM{constructor(s,l){const p={},m={};this.haveRenderCallbacks=[];const x=[];this.addImages(s,p,x),this.addImages(l,m,x);const{w,h:C}=HM(x),I=new ns({width:w||1,height:C||1});for(const A in s){const D=s[A],N=p[A].paddedRect;ns.copy(D.data,I,{x:0,y:0},{x:N.x+1,y:N.y+1},D.data)}for(const A in l){const D=l[A],N=m[A].paddedRect,U=N.x+1,G=N.y+1,q=D.data.width,X=D.data.height;ns.copy(D.data,I,{x:0,y:0},{x:U,y:G},D.data),ns.copy(D.data,I,{x:0,y:X-1},{x:U,y:G-1},{width:q,height:1}),ns.copy(D.data,I,{x:0,y:0},{x:U,y:G+X},{width:q,height:1}),ns.copy(D.data,I,{x:q-1,y:0},{x:U-1,y:G},{width:1,height:X}),ns.copy(D.data,I,{x:0,y:0},{x:U+q,y:G},{width:1,height:X})}this.image=I,this.iconPositions=p,this.patternPositions=m}addImages(s,l,p){for(const m in s){const x=s[m],w={x:0,y:0,w:x.data.width+2,h:x.data.height+2};p.push(w),l[m]=new B2(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(s,l){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in s.updatedImages)this.patchUpdatedImage(this.iconPositions[p],s.getImage(p),l),this.patchUpdatedImage(this.patternPositions[p],s.getImage(p),l)}patchUpdatedImage(s,l,p){if(!s||!l||s.version===l.version)return;s.version=l.version;const[m,x]=s.tl;p.update(l.data,void 0,{x:m,y:x})}}var Jc;ft("ImagePosition",B2),ft("ImageAtlas",ZM),d.ao=void 0,(Jc=d.ao||(d.ao={}))[Jc.none=0]="none",Jc[Jc.horizontal=1]="horizontal",Jc[Jc.vertical=2]="vertical",Jc[Jc.horizontalOnly=3]="horizontalOnly";class Bg{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(s,l,p){const m=new Bg;return m.scale=s||1,m.fontStack=l,m.verticalAlign=p||"bottom",m}static forImage(s,l){const p=new Bg;return p.imageName=s,p.verticalAlign=l||"bottom",p}}class Ip{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,l){const p=new Ip;for(let m=0;m<s.sections.length;m++){const x=s.sections[m];x.image?p.addImageSection(x):p.addTextSection(x,l)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=(function(s){let l="";for(let p=0;p<s.length;p++){const m=s.charCodeAt(p+1)||null,x=s.charCodeAt(p-1)||null;l+=m&&tv(m)&&!Ng[s[p+1]]||x&&tv(x)&&!Ng[s[p-1]]||!Ng[s[p]]?s[p]:Ng[s[p]]}return l})(this.text)}trim(){let s=0;for(let p=0;p<this.text.length&&yv[this.text.charCodeAt(p)];p++)s++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=s&&yv[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(s,l),this.sectionIndex=this.sectionIndex.slice(s,l)}substring(s,l){const p=new Ip;return p.text=this.text.substring(s,l),p.sectionIndex=this.sectionIndex.slice(s,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((s,l)=>Math.max(s,this.sections[l].scale)),0)}getMaxImageSize(s){let l=0,p=0;for(let m=0;m<this.length();m++){const x=this.getSection(m);if(x.imageName){const w=s[x.imageName];if(!w)continue;const C=w.displaySize;l=Math.max(l,C[0]),p=Math.max(p,C[1])}}return{maxImageWidth:l,maxImageHeight:p}}addTextSection(s,l){this.text+=s.text,this.sections.push(Bg.forText(s.scale,s.fontStack||l,s.verticalAlign));const p=this.sections.length-1;for(let m=0;m<s.text.length;++m)this.sectionIndex.push(p)}addImageSection(s){const l=s.image?s.image.name:"";if(l.length===0)return void lr("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Bg.forImage(l,s.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):lr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function gv(c,s,l,p,m,x,w,C,I,A,D,N,U,G,q){const X=Ip.fromFeature(c,m);let Q;N===d.ao.vertical&&X.verticalizePunctuation();const{processBidirectionalText:ne,processStyledBidirectionalText:ye}=Gs;if(ne&&X.sections.length===1){Q=[];const Me=ne(X.toString(),j2(X,A,x,s,p,G));for(const Le of Me){const Ze=new Ip;Ze.text=Le,Ze.sections=X.sections;for(let ct=0;ct<Le.length;ct++)Ze.sectionIndex.push(0);Q.push(Ze)}}else if(ye){Q=[];const Me=ye(X.text,X.sectionIndex,j2(X,A,x,s,p,G));for(const Le of Me){const Ze=new Ip;Ze.text=Le[0],Ze.sectionIndex=Le[1],Ze.sections=X.sections,Q.push(Ze)}}else Q=(function(Me,Le){const Ze=[],ct=Me.text;let et=0;for(const at of Le)Ze.push(Me.substring(et,at)),et=at;return et<ct.length&&Ze.push(Me.substring(et,ct.length)),Ze})(X,j2(X,A,x,s,p,G));const ue=[],de={positionedLines:ue,text:X.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:N,iconsInText:!1,verticalizable:!1};return(function(Me,Le,Ze,ct,et,at,Et,ot,lt,Ue,kt,At){let $t=0,wt=0,si=0,Xi=0;const kr=ot==="right"?1:ot==="left"?0:.5,yn=Gr/At;let Ys=0;for(const qi of et){qi.trim();const qr=qi.getMaxScale(),an={positionedGlyphs:[],lineOffset:0};Me.positionedLines[Ys]=an;const ln=an.positionedGlyphs;let Un=0;if(!qi.length()){wt+=at,++Ys;continue}const Xs=Xj(ct,qi,yn);for(let os=0;os<qi.length();os++){const Ar=qi.getSection(os),Zr=qi.getSectionIndex(os),Wr=qi.getCharCode(os),br=Jj(lt,kt,Wr);let Fi;if(Ar.imageName){if(Me.iconsInText=!0,Ar.scale=Ar.scale*yn,Fi=Qj(Ar,br,qr,Xs,ct),!Fi)continue;Un=Math.max(Un,Fi.imageOffset)}else if(Fi=Kj(Ar,Wr,br,Xs,Le,Ze),!Fi)continue;const{rect:Qo,metrics:kp,baselineOffset:ea}=Fi;ln.push({glyph:Wr,imageName:Ar.imageName,x:$t,y:wt+ea+-17,vertical:br,scale:Ar.scale,fontStack:Ar.fontStack,sectionIndex:Zr,metrics:kp,rect:Qo}),br?(Me.verticalizable=!0,$t+=(Ar.imageName?kp.advance:Gr)*Ar.scale+Ue):$t+=kp.advance*Ar.scale+Ue}ln.length!==0&&(si=Math.max($t-Ue,si),e9(ln,0,ln.length-1,kr)),$t=0,an.lineOffset=Math.max(Un,(qr-1)*Gr);const Hr=at*qr+Un;wt+=Hr,Xi=Math.max(Hr,Xi),++Ys}const{horizontalAlign:ss,verticalAlign:on}=U2(Et);(function(qi,qr,an,ln,Un,Xs,Hr,os,Ar){const Zr=(qr-an)*Un;let Wr=0;Wr=Xs!==Hr?-os*ln- -17:-ln*Ar*Hr+.5*Hr;for(const br of qi)for(const Fi of br.positionedGlyphs)Fi.x+=Zr,Fi.y+=Wr})(Me.positionedLines,kr,ss,on,si,Xi,at,wt,et.length),Me.top+=-on*wt,Me.bottom=Me.top+wt,Me.left+=-ss*si,Me.right=Me.left+si})(de,s,l,p,Q,w,C,I,N,A,U,q),!(function(Me){for(const Le of Me)if(Le.positionedGlyphs.length!==0)return!1;return!0})(ue)&&de}const yv={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Zj={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Wj={40:!0};function WM(c,s,l,p,m,x){if(s.imageName){const w=p[s.imageName];return w?w.displaySize[0]*s.scale*Gr/x+m:0}{const w=l[s.fontStack],C=w&&w[c];return C?C.metrics.advance*s.scale+m:0}}function YM(c,s,l,p){const m=Math.pow(c-s,2);return p?c<s?m/2:2*m:m+Math.abs(l)*l}function Yj(c,s,l){let p=0;return c===10&&(p-=1e4),l&&(p+=150),c!==40&&c!==65288||(p+=50),s!==41&&s!==65289||(p+=50),p}function XM(c,s,l,p,m,x){let w=null,C=YM(s,l,m,x);for(const I of p){const A=YM(s-I.x,l,m,x)+I.badness;A<=C&&(w=I,C=A)}return{index:c,x:s,priorBreak:w,badness:C}}function JM(c){return c?JM(c.priorBreak).concat(c.index):[]}function j2(c,s,l,p,m,x){if(!c)return[];const w=[],C=(function(N,U,G,q,X,Q){let ne=0;for(let ye=0;ye<N.length();ye++){const ue=N.getSection(ye);ne+=WM(N.getCharCode(ye),ue,q,X,U,Q)}return ne/Math.max(1,Math.ceil(ne/G))})(c,s,l,p,m,x),I=c.text.indexOf("")>=0;let A=0;for(let N=0;N<c.length();N++){const U=c.getSection(N),G=c.getCharCode(N);if(yv[G]||(A+=WM(G,U,p,m,s,x)),N<c.length()-1){const q=!((D=G)<11904)&&(!!ni["CJK Compatibility Forms"](D)||!!ni["CJK Compatibility"](D)||!!ni["CJK Strokes"](D)||!!ni["CJK Symbols and Punctuation"](D)||!!ni["Enclosed CJK Letters and Months"](D)||!!ni["Halfwidth and Fullwidth Forms"](D)||!!ni["Ideographic Description Characters"](D)||!!ni["Vertical Forms"](D)||_g.test(String.fromCodePoint(D)));(Zj[G]||q||U.imageName||N!==c.length()-2&&Wj[c.getCharCode(N+1)])&&w.push(XM(N+1,A,C,w,Yj(G,c.getCharCode(N+1),q&&I),!1))}}var D;return JM(XM(c.length(),A,C,w,0,!0))}function U2(c){let s=.5,l=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:s,verticalAlign:l}}function Xj(c,s,l){const p=s.getMaxScale()*Gr,{maxImageWidth:m,maxImageHeight:x}=s.getMaxImageSize(c),w=Math.max(p,x*l);return{verticalLineContentWidth:Math.max(p,m*l),horizontalLineContentHeight:w}}function KM(c){switch(c){case"top":return 0;case"center":return .5;default:return 1}}function Jj(c,s,l){return!(c===d.ao.horizontal||!s&&!vg(l)||s&&(yv[l]||(p=l,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(p)))));var p}function Kj(c,s,l,p,m,x){const w=x[c.fontStack],C=(function(A,D,N,U){if(A&&A.rect)return A;const G=D[N.fontStack],q=G&&G[U];return q?{rect:null,metrics:q.metrics}:null})(w&&w[s],m,c,s);if(C===null)return null;let I;if(l)I=p.verticalLineContentWidth-c.scale*Gr;else{const A=KM(c.verticalAlign);I=(p.horizontalLineContentHeight-c.scale*Gr)*A}return{rect:C.rect,metrics:C.metrics,baselineOffset:I}}function Qj(c,s,l,p,m){const x=m[c.imageName];if(!x)return null;const w=x.paddedRect,C=x.displaySize,I={width:C[0],height:C[1],left:1,top:-3,advance:s?C[1]:C[0]};let A;if(s)A=p.verticalLineContentWidth-C[1]*c.scale;else{const D=KM(c.verticalAlign);A=(p.horizontalLineContentHeight-C[1]*c.scale)*D}return{rect:w,metrics:I,baselineOffset:A,imageOffset:(s?C[0]:C[1])*c.scale-Gr*l}}function e9(c,s,l,p){if(p===0)return;const m=c[l],x=(c[l].x+m.metrics.advance*m.scale)*p;for(let w=s;w<=l;w++)c[w].x-=x}function t9(c,s,l){const{horizontalAlign:p,verticalAlign:m}=U2(l),x=s[0]-c.displaySize[0]*p,w=s[1]-c.displaySize[1]*m;return{image:c,top:w,bottom:w+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function QM(c){var s,l;let p=c.left,m=c.top,x=c.right-p,w=c.bottom-m;const C=(s=c.image.textFitWidth)!==null&&s!==void 0?s:"stretchOrShrink",I=(l=c.image.textFitHeight)!==null&&l!==void 0?l:"stretchOrShrink",A=(c.image.content[2]-c.image.content[0])/(c.image.content[3]-c.image.content[1]);if(I==="proportional"){if(C==="stretchOnly"&&x/w<A||C==="proportional"){const D=Math.ceil(w*A);p*=D/x,x=D}}else if(C==="proportional"&&I==="stretchOnly"&&A!==0&&x/w>A){const D=Math.ceil(x/A);m*=D/w,w=D}return{x1:p,y1:m,x2:p+x,y2:m+w}}function ek(c,s,l,p,m,x){const w=c.image;let C;if(w.content){const Q=w.content,ne=w.pixelRatio||1;C=[Q[0]/ne,Q[1]/ne,w.displaySize[0]-Q[2]/ne,w.displaySize[1]-Q[3]/ne]}const I=s.left*x,A=s.right*x;let D,N,U,G;l==="width"||l==="both"?(G=m[0]+I-p[3],N=m[0]+A+p[1]):(G=m[0]+(I+A-w.displaySize[0])/2,N=G+w.displaySize[0]);const q=s.top*x,X=s.bottom*x;return l==="height"||l==="both"?(D=m[1]+q-p[0],U=m[1]+X+p[2]):(D=m[1]+(q+X-w.displaySize[1])/2,U=D+w.displaySize[1]),{image:w,top:D,right:N,bottom:U,left:G,collisionPadding:C}}const ql=128,Kc=32640;function tk(c,s){const{expression:l}=s;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Pi(c+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:m}=l;let x=0;for(;x<p.length&&p[x]<=c;)x++;x=Math.max(0,x-1);let w=x;for(;w<p.length&&p[w]<c+1;)w++;w=Math.min(p.length-1,w);const C=p[x],I=p[w];return l.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:I,interpolationType:m}:{kind:"camera",minZoom:C,maxZoom:I,minSize:l.evaluate(new Pi(C)),maxSize:l.evaluate(new Pi(I)),interpolationType:m}}}function V2(c,s,l){let p="never";const m=c.get(s);return m?p=m:c.get(l)&&(p="always"),p}const i9=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function _v(c,s,l,p,m,x,w,C,I,A,D,N,U){const G=C?Math.min(Kc,Math.round(C[0])):0,q=C?Math.min(Kc,Math.round(C[1])):0;c.emplaceBack(s,l,Math.round(32*p),Math.round(32*m),x,w,(G<<1)+(I?1:0),q,16*A,16*D,256*N,256*U)}function G2(c,s,l){c.emplaceBack(s.x,s.y,l),c.emplaceBack(s.x,s.y,l),c.emplaceBack(s.x,s.y,l),c.emplaceBack(s.x,s.y,l)}function r9(c){for(const s of c.sections)if(nv(s.text))return!0;return!1}class q2{constructor(s){this.layoutVertexArray=new it,this.indexArray=new Ti,this.programConfigurations=s,this.segments=new Bt,this.dynamicLayoutVertexArray=new He,this.opacityVertexArray=new xt,this.hasVisibleVertices=!1,this.placedSymbolArray=new W}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,l,p,m){this.isEmpty()||(p&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Mj.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,kj.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,i9,!0),this.opacityVertexBuffer.itemSize=1),(p||m)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ft("SymbolBuffers",q2);class H2{constructor(s,l,p){this.layoutVertexArray=new s,this.layoutAttributes=l,this.indexArray=new p,this.segments=new Bt,this.collisionVertexArray=new gi}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,Aj.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ft("CollisionBuffers",H2);class $p{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((w=>w.id)),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tk(this.zoom,l["text-size"]),this.iconSizeData=tk(this.zoom,l["icon-size"]);const p=this.layers[0].layout,m=p.get("symbol-sort-key"),x=p.get("symbol-z-order");this.canOverlap=V2(p,"text-overlap","text-allow-overlap")!=="never"||V2(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map((w=>d.ao[w]))),this.stateDependentLayerIds=this.layers.filter((w=>w.isStateDependent())).map((w=>w.id)),this.sourceID=s.sourceID}createArrays(){this.text=new q2(new rs(this.layers,this.zoom,(s=>/^text/.test(s)))),this.icon=new q2(new rs(this.layers,this.zoom,(s=>/^icon/.test(s)))),this.glyphOffsetArray=new ie,this.lineVertexArray=new se,this.symbolInstances=new ee,this.textAnchorOffsets=new oe}calculateGlyphDependencies(s,l,p,m,x){for(let w=0;w<s.length;w++)if(l[s.charCodeAt(w)]=!0,(p||m)&&x){const C=Ng[s.charAt(w)];C&&(l[C.charCodeAt(0)]=!0)}}populate(s,l,p){const m=this.layers[0],x=m.layout,w=x.get("text-font"),C=x.get("text-field"),I=x.get("icon-image"),A=(C.value.kind!=="constant"||C.value.value instanceof Sn&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),D=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,N=x.get("symbol-sort-key");if(this.features=[],!A&&!D)return;const U=l.iconDependencies,G=l.glyphDependencies,q=l.availableImages,X=new Pi(this.zoom,{globalState:this.globalState});for(const{feature:Q,id:ne,index:ye,sourceLayerIndex:ue}of s){const de=m._featureFilter.needGeometry,Me=Ko(Q,de);if(!m._featureFilter.filter(X,Me,p))continue;let Le,Ze;if(de||(Me.geometry=Xa(Q)),A){const et=m.getValueAndResolveTokens("text-field",Me,p,q),at=Sn.factory(et),Et=this.hasRTLText=this.hasRTLText||r9(at);(!Et||Gs.getRTLTextPluginStatus()==="unavailable"||Et&&Gs.isParsed())&&(Le=zj(at,m,Me))}if(D){const et=m.getValueAndResolveTokens("icon-image",Me,p,q);Ze=et instanceof ts?et:ts.fromString(et)}if(!Le&&!Ze)continue;const ct=this.sortFeaturesByKey?N.evaluate(Me,{},p):void 0;if(this.features.push({id:ne,text:Le,icon:Ze,index:ye,sourceLayerIndex:ue,geometry:Me.geometry,properties:Q.properties,type:Cp.types[Q.type],sortKey:ct}),Ze&&(U[Ze.name]=!0),Le){const et=w.evaluate(Me,{},p).join(","),at=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(d.ao.vertical)>=0;for(const Et of Le.sections)if(Et.image)U[Et.image.name]=!0;else{const ot=hp(Le.toString()),lt=Et.fontStack||et,Ue=G[lt]=G[lt]||{};this.calculateGlyphDependencies(Et.text,Ue,at,this.allowVerticalPlacement,ot)}}}x.get("symbol-placement")==="line"&&(this.features=(function(Q){const ne={},ye={},ue=[];let de=0;function Me(et){ue.push(Q[et]),de++}function Le(et,at,Et){const ot=ye[et];return delete ye[et],ye[at]=ot,ue[ot].geometry[0].pop(),ue[ot].geometry[0]=ue[ot].geometry[0].concat(Et[0]),ot}function Ze(et,at,Et){const ot=ne[at];return delete ne[at],ne[et]=ot,ue[ot].geometry[0].shift(),ue[ot].geometry[0]=Et[0].concat(ue[ot].geometry[0]),ot}function ct(et,at,Et){const ot=Et?at[0][at[0].length-1]:at[0][0];return`${et}:${ot.x}:${ot.y}`}for(let et=0;et<Q.length;et++){const at=Q[et],Et=at.geometry,ot=at.text?at.text.toString():null;if(!ot){Me(et);continue}const lt=ct(ot,Et),Ue=ct(ot,Et,!0);if(lt in ye&&Ue in ne&&ye[lt]!==ne[Ue]){const kt=Ze(lt,Ue,Et),At=Le(lt,Ue,ue[kt].geometry);delete ne[lt],delete ye[Ue],ye[ct(ot,ue[At].geometry,!0)]=At,ue[kt].geometry=null}else lt in ye?Le(lt,Ue,Et):Ue in ne?Ze(lt,Ue,Et):(Me(et),ne[lt]=de-1,ye[Ue]=de-1)}return ue.filter((et=>et.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Q,ne)=>Q.sortKey-ne.sortKey))}update(s,l,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,l,this.layers,{imagePositions:p,globalState:this.globalState}),this.icon.programConfigurations.updatePaintArrays(s,l,this.layers,{imagePositions:p,globalState:this.globalState}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,l){const p=this.lineVertexArray.length;if(s.segment!==void 0){let m=s.dist(l[s.segment+1]),x=s.dist(l[s.segment]);const w={};for(let C=s.segment+1;C<l.length;C++)w[C]={x:l[C].x,y:l[C].y,tileUnitDistanceFromAnchor:m},C<l.length-1&&(m+=l[C+1].dist(l[C]));for(let C=s.segment||0;C>=0;C--)w[C]={x:l[C].x,y:l[C].y,tileUnitDistanceFromAnchor:x},C>0&&(x+=l[C-1].dist(l[C]));for(let C=0;C<l.length;C++){const I=w[C];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(s,l,p,m,x,w,C,I,A,D,N,U){const G=s.indexArray,q=s.layoutVertexArray,X=s.segments.prepareSegment(4*l.length,q,G,this.canOverlap?w.sortKey:void 0),Q=this.glyphOffsetArray.length,ne=X.vertexLength,ye=this.allowVerticalPlacement&&C===d.ao.vertical?Math.PI/2:0,ue=w.text&&w.text.sections;for(let de=0;de<l.length;de++){const{tl:Me,tr:Le,bl:Ze,br:ct,tex:et,pixelOffsetTL:at,pixelOffsetBR:Et,minFontScaleX:ot,minFontScaleY:lt,glyphOffset:Ue,isSDF:kt,sectionIndex:At}=l[de],$t=X.vertexLength,wt=Ue[1];_v(q,I.x,I.y,Me.x,wt+Me.y,et.x,et.y,p,kt,at.x,at.y,ot,lt),_v(q,I.x,I.y,Le.x,wt+Le.y,et.x+et.w,et.y,p,kt,Et.x,at.y,ot,lt),_v(q,I.x,I.y,Ze.x,wt+Ze.y,et.x,et.y+et.h,p,kt,at.x,Et.y,ot,lt),_v(q,I.x,I.y,ct.x,wt+ct.y,et.x+et.w,et.y+et.h,p,kt,Et.x,Et.y,ot,lt),G2(s.dynamicLayoutVertexArray,I,ye),G.emplaceBack($t,$t+2,$t+1),G.emplaceBack($t+1,$t+2,$t+3),X.vertexLength+=4,X.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ue[0]),de!==l.length-1&&At===l[de+1].sectionIndex||s.programConfigurations.populatePaintArrays(q.length,w,w.index,{imagePositions:{},canonical:U,formattedSection:ue&&ue[At],globalState:this.globalState})}s.placedSymbolArray.emplaceBack(I.x,I.y,Q,this.glyphOffsetArray.length-Q,ne,A,D,I.segment,p?p[0]:0,p?p[1]:0,m[0],m[1],C,0,!1,0,N)}_addCollisionDebugVertex(s,l,p,m,x,w){return l.emplaceBack(0,0),s.emplaceBack(p.x,p.y,m,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(s,l,p,m,x,w,C){const I=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),A=I.vertexLength,D=x.layoutVertexArray,N=x.collisionVertexArray,U=C.anchorX,G=C.anchorY;this._addCollisionDebugVertex(D,N,w,U,G,new _(s,l)),this._addCollisionDebugVertex(D,N,w,U,G,new _(p,l)),this._addCollisionDebugVertex(D,N,w,U,G,new _(p,m)),this._addCollisionDebugVertex(D,N,w,U,G,new _(s,m)),I.vertexLength+=4;const q=x.indexArray;q.emplaceBack(A,A+1),q.emplaceBack(A+1,A+2),q.emplaceBack(A+2,A+3),q.emplaceBack(A+3,A),I.primitiveLength+=4}addDebugCollisionBoxes(s,l,p,m){for(let x=s;x<l;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,m?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new H2(Gt,UM.members,wi),this.iconCollisionBox=new H2(Gt,UM.members,wi);for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(s,l,p,m,x,w,C,I,A){const D={};for(let N=l;N<p;N++){const U=s.get(N);D.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.textFeatureIndex=U.featureIndex;break}for(let N=m;N<x;N++){const U=s.get(N);D.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalTextFeatureIndex=U.featureIndex;break}for(let N=w;N<C;N++){const U=s.get(N);D.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.iconFeatureIndex=U.featureIndex;break}for(let N=I;N<A;N++){const U=s.get(N);D.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalIconFeatureIndex=U.featureIndex;break}return D}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,l){const p=s.placedSymbolArray.get(l),m=p.vertexStartIndex+4*p.numGlyphs;for(let x=p.vertexStartIndex;x<m;x+=4)s.indexArray.emplaceBack(x,x+2,x+1),s.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(s),p=Math.cos(s),m=[],x=[],w=[];for(let C=0;C<this.symbolInstances.length;++C){w.push(C);const I=this.symbolInstances.get(C);m.push(0|Math.round(l*I.anchorX+p*I.anchorY)),x.push(I.featureIndex)}return w.sort(((C,I)=>m[C]-m[I]||x[I]-x[C])),w}addToSortKeyRanges(s,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(((m,x,w)=>{m>=0&&w.indexOf(m)===x&&this.addIndicesForPlacedSymbol(this.text,m)})),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ik,rk;ft("SymbolBucket",$p,{omit:["layers","collisionBoxArray","features","compareText"]}),$p.MAX_GLYPHS=65535,$p.addDynamicAttributes=G2;var Z2={get paint(){return rk=rk||new En({"icon-opacity":new Pt(Te.paint_symbol["icon-opacity"]),"icon-color":new Pt(Te.paint_symbol["icon-color"]),"icon-halo-color":new Pt(Te.paint_symbol["icon-halo-color"]),"icon-halo-width":new Pt(Te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Pt(Te.paint_symbol["icon-halo-blur"]),"icon-translate":new Tt(Te.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tt(Te.paint_symbol["icon-translate-anchor"]),"text-opacity":new Pt(Te.paint_symbol["text-opacity"]),"text-color":new Pt(Te.paint_symbol["text-color"],{runtimeType:nn,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Pt(Te.paint_symbol["text-halo-color"]),"text-halo-width":new Pt(Te.paint_symbol["text-halo-width"]),"text-halo-blur":new Pt(Te.paint_symbol["text-halo-blur"]),"text-translate":new Tt(Te.paint_symbol["text-translate"]),"text-translate-anchor":new Tt(Te.paint_symbol["text-translate-anchor"])})},get layout(){return ik=ik||new En({"symbol-placement":new Tt(Te.layout_symbol["symbol-placement"]),"symbol-spacing":new Tt(Te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tt(Te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Pt(Te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tt(Te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tt(Te.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tt(Te.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tt(Te.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tt(Te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tt(Te.layout_symbol["icon-rotation-alignment"]),"icon-size":new Pt(Te.layout_symbol["icon-size"]),"icon-text-fit":new Tt(Te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tt(Te.layout_symbol["icon-text-fit-padding"]),"icon-image":new Pt(Te.layout_symbol["icon-image"]),"icon-rotate":new Pt(Te.layout_symbol["icon-rotate"]),"icon-padding":new Pt(Te.layout_symbol["icon-padding"]),"icon-keep-upright":new Tt(Te.layout_symbol["icon-keep-upright"]),"icon-offset":new Pt(Te.layout_symbol["icon-offset"]),"icon-anchor":new Pt(Te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tt(Te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tt(Te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tt(Te.layout_symbol["text-rotation-alignment"]),"text-field":new Pt(Te.layout_symbol["text-field"]),"text-font":new Pt(Te.layout_symbol["text-font"]),"text-size":new Pt(Te.layout_symbol["text-size"]),"text-max-width":new Pt(Te.layout_symbol["text-max-width"]),"text-line-height":new Tt(Te.layout_symbol["text-line-height"]),"text-letter-spacing":new Pt(Te.layout_symbol["text-letter-spacing"]),"text-justify":new Pt(Te.layout_symbol["text-justify"]),"text-radial-offset":new Pt(Te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tt(Te.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Pt(Te.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Pt(Te.layout_symbol["text-anchor"]),"text-max-angle":new Tt(Te.layout_symbol["text-max-angle"]),"text-writing-mode":new Tt(Te.layout_symbol["text-writing-mode"]),"text-rotate":new Pt(Te.layout_symbol["text-rotate"]),"text-padding":new Tt(Te.layout_symbol["text-padding"]),"text-keep-upright":new Tt(Te.layout_symbol["text-keep-upright"]),"text-transform":new Pt(Te.layout_symbol["text-transform"]),"text-offset":new Pt(Te.layout_symbol["text-offset"]),"text-allow-overlap":new Tt(Te.layout_symbol["text-allow-overlap"]),"text-overlap":new Tt(Te.layout_symbol["text-overlap"]),"text-ignore-placement":new Tt(Te.layout_symbol["text-ignore-placement"]),"text-optional":new Tt(Te.layout_symbol["text-optional"])})}};class nk{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:Ec,this.defaultValue=s}evaluate(s){if(s.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(s.formattedSection))return l.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ft("FormatSectionOverride",nk,{omit:["defaultValue"]});class vv extends _s{constructor(s){super(s,Z2)}recalculate(s,l){if(super.recalculate(s,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const m=[];for(const x of p)m.indexOf(x)<0&&m.push(x);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,l,p,m){const x=this.layout.get(s).evaluate(l,{},p,m),w=this._unevaluatedLayout._values[s];return w.isDataDriven()||rp(w.value)||!x?x:(function(C,I){return I.replace(/{([^{}]+)}/g,((A,D)=>C&&D in C?String(C[D]):""))})(l.properties,x)}createBucket(s){return new $p(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of Z2.paint.overridableProperties){if(!vv.hasPaintOverride(this.layout,s))continue;const l=this.paint.get(s),p=new nk(l),m=new og(p,l.property.specification);let x=null;x=l.value.kind==="constant"||l.value.kind==="source"?new dh("source",m):new ag("composite",m,l.value.zoomStops),this.paint._values[s]=new Io(l.property,x,l.parameters)}}_handleOverridablePaintPropertyUpdate(s,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&vv.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,l){const p=s.get("text-field"),m=Z2.paint.properties[l];let x=!1;const w=C=>{for(const I of C)if(m.overrides&&m.overrides.hasOverride(I))return void(x=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Sn)w(p.value.value.sections);else if(p.value.kind==="source"||p.value.kind==="composite"){const C=A=>{x||(A instanceof Wo&&Mt(A.value)===Na?w(A.value.sections):A instanceof kl?w(A.sections):A.eachChild(C))},I=p.value;I._styleExpression&&C(I._styleExpression.expression)}return x}}let sk;var n9={get paint(){return sk=sk||new En({"background-color":new Tt(Te.paint_background["background-color"]),"background-pattern":new qa(Te.paint_background["background-pattern"]),"background-opacity":new Tt(Te.paint_background["background-opacity"])})}};class s9 extends _s{constructor(s){super(s,n9)}}let ok;var o9={get paint(){return ok=ok||new En({"raster-opacity":new Tt(Te.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tt(Te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tt(Te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tt(Te.paint_raster["raster-brightness-max"]),"raster-saturation":new Tt(Te.paint_raster["raster-saturation"]),"raster-contrast":new Tt(Te.paint_raster["raster-contrast"]),"raster-resampling":new Tt(Te.paint_raster["raster-resampling"]),"raster-fade-duration":new Tt(Te.paint_raster["raster-fade-duration"])})}};class a9 extends _s{constructor(s){super(s,o9)}}class l9 extends _s{constructor(s){super(s,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class c9{constructor(s){this._methodToThrottle=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const u9={once:!0},W2=63710088e-1;class Qc{constructor(s,l){if(isNaN(s)||isNaN(l))throw new Error(`Invalid LngLat object: (${s}, ${l})`);if(this.lng=+s,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Qc(_o(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const l=Math.PI/180,p=this.lat*l,m=s.lat*l,x=Math.sin(p)*Math.sin(m)+Math.cos(p)*Math.cos(m)*Math.cos((s.lng-this.lng)*l);return W2*Math.acos(Math.min(x,1))}static convert(s){if(s instanceof Qc)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Qc(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Qc(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const ak=2*Math.PI*W2;function lk(c){return ak*Math.cos(c*Math.PI/180)}function ck(c){return(180+c)/360}function uk(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function hk(c,s){return c/lk(s)}function Y2(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function dk(c,s){return c*lk(Y2(s))}class jg{constructor(s,l,p=0){this.x=+s,this.y=+l,this.z=+p}static fromLngLat(s,l=0){const p=Qc.convert(s);return new jg(ck(p.lng),uk(p.lat),hk(l,p.lat))}toLngLat(){return new Qc(360*this.x-180,Y2(this.y))}toAltitude(){return dk(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ak*(s=Y2(this.y),1/Math.cos(s*Math.PI/180));var s}}function pk(c,s,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[c*p-2*Math.PI*6378137/2,s*p-2*Math.PI*6378137/2]}class X2{constructor(s,l,p){if(!(function(m,x,w){return!(m<0||m>25||w<0||w>=Math.pow(2,m)||x<0||x>=Math.pow(2,m))})(s,l,p))throw new Error(`x=${l}, y=${p}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=l,this.y=p,this.key=Pp(0,s,s,l,p)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,l,p){const m=(w=this.y,C=this.z,I=pk(256*(x=this.x),256*(w=Math.pow(2,C)-w-1),C),A=pk(256*(x+1),256*(w+1),C),I[0]+","+I[1]+","+A[0]+","+A[1]);var x,w,C,I,A;const D=(function(N,U,G){let q,X="";for(let Q=N;Q>0;Q--)q=1<<Q-1,X+=(U&q?1:0)+(G&q?2:0);return X})(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,m)}isChildOf(s){const l=this.z-s.z;return l>0&&s.x===this.x>>l&&s.y===this.y>>l}getTilePoint(s){const l=Math.pow(2,this.z);return new _((s.x*l-this.x)*rt,(s.y*l-this.y)*rt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class fk{constructor(s,l){this.wrap=s,this.canonical=l,this.key=Pp(s,l.z,l.z,l.x,l.y)}}class Ws{constructor(s,l,p,m,x){if(this.terrainRttPosMatrix32f=null,s<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${p}`);this.overscaledZ=s,this.wrap=l,this.canonical=new X2(p,+m,+x),this.key=Pp(l,s,p,m,x)}clone(){return new Ws(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-s;return s>this.canonical.z?new Ws(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ws(s,this.wrap,s,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(s,l){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-s;return s>this.canonical.z?Pp(this.wrap*+l,s,this.canonical.z,this.canonical.x,this.canonical.y):Pp(this.wrap*+l,s,s,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const l=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>l&&s.canonical.y===this.canonical.y>>l}children(s){if(this.overscaledZ>=s)return[new Ws(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,m=2*this.canonical.y;return[new Ws(l,this.wrap,l,p,m),new Ws(l,this.wrap,l,p+1,m),new Ws(l,this.wrap,l,p,m+1),new Ws(l,this.wrap,l,p+1,m+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Ws(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Ws(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new fk(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new jg(s.x-this.wrap,s.y))}}function Pp(c,s,l,p,m){(c*=2)<0&&(c=-1*c-1);const x=1<<l;return(x*x*c+x*m+p).toString(36)+l.toString(36)+s.toString(36)}function Ug(c,s){return s?c.properties[s]:c.id}ft("CanonicalTileID",X2),ft("OverscaledTileID",Ws,{omit:["terrainRttPosMatrix32f"]});class Ch{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(s){return this.minX=Math.min(this.minX,s.x),this.minY=Math.min(this.minY,s.y),this.maxX=Math.max(this.maxX,s.x),this.maxY=Math.max(this.maxY,s.y),this}expandBy(s){return this.minX-=s,this.minY-=s,this.maxX+=s,this.maxY+=s,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(s){return this.expandBy(-s)}map(s){const l=new Ch;return l.extend(s(new _(this.minX,this.minY))),l.extend(s(new _(this.maxX,this.minY))),l.extend(s(new _(this.minX,this.maxY))),l.extend(s(new _(this.maxX,this.maxY))),l}static fromPoints(s){const l=new Ch;for(const p of s)l.extend(p);return l}contains(s){return s.x>=this.minX&&s.x<=this.maxX&&s.y>=this.minY&&s.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(s){return!this.empty()&&!s.empty()&&s.minX>=this.minX&&s.maxX<=this.maxX&&s.minY>=this.minY&&s.maxY<=this.maxY}intersects(s){return!this.empty()&&!s.empty()&&s.minX<=this.maxX&&s.maxX>=this.minX&&s.minY<=this.maxY&&s.maxY>=this.minY}}class mk{constructor(s){this._stringToNumber={},this._numberToString=[];for(let l=0;l<s.length;l++){const p=s[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class gk{constructor(s,l,p,m,x){this.type="Feature",this._vectorTileFeature=s,s._z=l,s._x=p,s._y=m,this.properties=s.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(s[l]=this[l]);return s}}class yk{constructor(s,l){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new vh(rt,16,0),this.grid3D=new vh(rt,16,0),this.featureIndexArray=new me,this.promoteId=l}insert(s,l,p,m,x,w){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,m,x);const I=w?this.grid3D:this.grid;for(let A=0;A<l.length;A++){const D=l[A],N=[1/0,1/0,-1/0,-1/0];for(let U=0;U<D.length;U++){const G=D[U];N[0]=Math.min(N[0],G.x),N[1]=Math.min(N[1],G.y),N[2]=Math.max(N[2],G.x),N[3]=Math.max(N[3],G.y)}N[0]<rt&&N[1]<rt&&N[2]>=0&&N[3]>=0&&I.insert(C,N[0],N[1],N[2],N[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new DM(new N2(this.rawTileData)).layers,this.sourceLayerCoder=new mk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,l,p,m){this.loadVTLayers();const x=s.params,w=rt/s.tileSize/s.scale,C=Ll(x.filter),I=s.queryGeometry,A=s.queryPadding*w,D=Ch.fromPoints(I),N=this.grid.query(D.minX-A,D.minY-A,D.maxX+A,D.maxY+A),U=Ch.fromPoints(s.cameraQueryGeometry).expandBy(A),G=this.grid3D.query(U.minX,U.minY,U.maxX,U.maxY,((Q,ne,ye,ue)=>(function(de,Me,Le,Ze,ct){for(const at of de)if(Me<=at.x&&Le<=at.y&&Ze>=at.x&&ct>=at.y)return!0;const et=[new _(Me,Le),new _(Me,ct),new _(Ze,ct),new _(Ze,Le)];if(de.length>2){for(const at of et)if(xp(de,at))return!0}for(let at=0;at<de.length-1;at++)if(U8(de[at],de[at+1],et))return!0;return!1})(s.cameraQueryGeometry,Q-A,ne-A,ye+A,ue+A)));for(const Q of G)N.push(Q);N.sort(h9);const q={};let X;for(let Q=0;Q<N.length;Q++){const ne=N[Q];if(ne===X)continue;X=ne;const ye=this.featureIndexArray.get(ne);let ue=null;this.loadMatchingFeature(q,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,C,x.layers,x.availableImages,l,p,m,((de,Me,Le)=>(ue||(ue=Xa(de)),Me.queryIntersectsFeature({queryGeometry:I,feature:de,featureState:Le,geometry:ue,zoom:this.z,transform:s.transform,pixelsToTileUnits:w,pixelPosMatrix:s.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:s.getElevation}))))}return q}loadMatchingFeature(s,l,p,m,x,w,C,I,A,D,N){const U=this.bucketLayerIDs[l];if(w&&!U.some((Q=>w.has(Q))))return;const G=this.sourceLayerCoder.decode(p),q=this.vtLayers[G].feature(m);if(x.needGeometry){const Q=Ko(q,!0);if(!x.filter(new Pi(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!x.filter(new Pi(this.tileID.overscaledZ),q))return;const X=this.getId(q,G);for(let Q=0;Q<U.length;Q++){const ne=U[Q];if(w&&!w.has(ne))continue;const ye=I[ne];if(!ye)continue;let ue={};X&&D&&(ue=D.getState(ye.sourceLayer||"_geojsonTileLayer",X));const de=dn({},A[ne]);de.paint=_k(de.paint,ye.paint,q,ue,C),de.layout=_k(de.layout,ye.layout,q,ue,C);const Me=!N||N(q,ye,ue);if(!Me)continue;const Le=new gk(q,this.z,this.x,this.y,X);Le.layer=de;let Ze=s[ne];Ze===void 0&&(Ze=s[ne]=[]),Ze.push({featureIndex:m,feature:Le,intersectionZ:Me})}}lookupSymbolFeatures(s,l,p,m,x,w,C,I){const A={};this.loadVTLayers();const D=Ll(x);for(const N of s)this.loadMatchingFeature(A,p,m,N,D,w,C,I,l);return A}hasLayer(s){for(const l of this.bucketLayerIDs)for(const p of l)if(s===p)return!0;return!1}getId(s,l){var p;let m=s.id;return this.promoteId&&(m=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((p=s.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(m=Number(s.properties.cluster_id))),m}}function _k(c,s,l,p,m){return wc(c,((x,w)=>{const C=s instanceof pp?s.get(w):null;return C&&C.evaluate?C.evaluate(l,p,m):C}))}function h9(c,s){return s-c}function vk(c,s,l,p,m){const x=[];for(let w=0;w<c.length;w++){const C=c[w];let I;for(let A=0;A<C.length-1;A++){let D=C[A],N=C[A+1];D.x<s&&N.x<s||(D.x<s?D=new _(s,D.y+(s-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x<s&&(N=new _(s,D.y+(s-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y<l&&N.y<l||(D.y<l?D=new _(D.x+(l-D.y)/(N.y-D.y)*(N.x-D.x),l)._round():N.y<l&&(N=new _(D.x+(l-D.y)/(N.y-D.y)*(N.x-D.x),l)._round()),D.x>=p&&N.x>=p||(D.x>=p?D=new _(p,D.y+(p-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x>=p&&(N=new _(p,D.y+(p-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y>=m&&N.y>=m||(D.y>=m?D=new _(D.x+(m-D.y)/(N.y-D.y)*(N.x-D.x),m)._round():N.y>=m&&(N=new _(D.x+(m-D.y)/(N.y-D.y)*(N.x-D.x),m)._round()),I&&D.equals(I[I.length-1])||(I=[D],x.push(I)),I.push(N)))))}}return x}ft("FeatureIndex",yk,{omit:["rawTileData","sourceLayerCoder"]});class eu extends _{constructor(s,l,p,m){super(s,l),this.angle=p,m!==void 0&&(this.segment=m)}clone(){return new eu(this.x,this.y,this.angle,this.segment)}}function bk(c,s,l,p,m){if(s.segment===void 0||l===0)return!0;let x=s,w=s.segment+1,C=0;for(;C>-l/2;){if(w--,w<0)return!1;C-=c[w].dist(x),x=c[w]}C+=c[w].dist(c[w+1]),w++;const I=[];let A=0;for(;C<l/2;){const D=c[w],N=c[w+1];if(!N)return!1;let U=c[w-1].angleTo(D)-D.angleTo(N);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:C,angleDelta:U}),A+=U;C-I[0].distance>p;)A-=I.shift().angleDelta;if(A>m)return!1;w++,C+=D.dist(N)}return!0}function xk(c){let s=0;for(let l=0;l<c.length-1;l++)s+=c[l].dist(c[l+1]);return s}function wk(c,s,l){return c?.6*s*l:0}function Sk(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function d9(c,s,l,p,m,x){const w=wk(l,m,x),C=Sk(l,p)*x;let I=0;const A=xk(c)/2;for(let D=0;D<c.length-1;D++){const N=c[D],U=c[D+1],G=N.dist(U);if(I+G>A){const q=(A-I)/G,X=Co.number(N.x,U.x,q),Q=Co.number(N.y,U.y,q),ne=new eu(X,Q,U.angleTo(N),D);return ne._round(),!w||bk(c,ne,C,w,s)?ne:void 0}I+=G}}function p9(c,s,l,p,m,x,w,C,I){const A=wk(p,x,w),D=Sk(p,m),N=D*w,U=c[0].x===0||c[0].x===I||c[0].y===0||c[0].y===I;return s-N<s/4&&(s=N+s/4),Tk(c,U?s/2*C%s:(D/2+2*x)*w*C%s,s,A,l,N,U,!1,I)}function Tk(c,s,l,p,m,x,w,C,I){const A=x/2,D=xk(c);let N=0,U=s-l,G=[];for(let q=0;q<c.length-1;q++){const X=c[q],Q=c[q+1],ne=X.dist(Q),ye=Q.angleTo(X);for(;U+l<N+ne;){U+=l;const ue=(U-N)/ne,de=Co.number(X.x,Q.x,ue),Me=Co.number(X.y,Q.y,ue);if(de>=0&&de<I&&Me>=0&&Me<I&&U-A>=0&&U+A<=D){const Le=new eu(de,Me,ye,q);Le._round(),p&&!bk(c,Le,x,p,m)||G.push(Le)}}N+=ne}return C||G.length||w||(G=Tk(c,N/2,l,p,m,x,w,!0,I)),G}function Ck(c,s,l,p){const m=[],x=c.image,w=x.pixelRatio,C=x.paddedRect.w-2,I=x.paddedRect.h-2;let A={x1:c.left,y1:c.top,x2:c.right,y2:c.bottom};const D=x.stretchX||[[0,C]],N=x.stretchY||[[0,I]],U=(Ue,kt)=>Ue+kt[1]-kt[0],G=D.reduce(U,0),q=N.reduce(U,0),X=C-G,Q=I-q;let ne=0,ye=G,ue=0,de=q,Me=0,Le=X,Ze=0,ct=Q;if(x.content&&p){const Ue=x.content,kt=Ue[2]-Ue[0],At=Ue[3]-Ue[1];(x.textFitWidth||x.textFitHeight)&&(A=QM(c)),ne=bv(D,0,Ue[0]),ue=bv(N,0,Ue[1]),ye=bv(D,Ue[0],Ue[2]),de=bv(N,Ue[1],Ue[3]),Me=Ue[0]-ne,Ze=Ue[1]-ue,Le=kt-ye,ct=At-de}const et=A.x1,at=A.y1,Et=A.x2-et,ot=A.y2-at,lt=(Ue,kt,At,$t)=>{const wt=xv(Ue.stretch-ne,ye,Et,et),si=wv(Ue.fixed-Me,Le,Ue.stretch,G),Xi=xv(kt.stretch-ue,de,ot,at),kr=wv(kt.fixed-Ze,ct,kt.stretch,q),yn=xv(At.stretch-ne,ye,Et,et),Ys=wv(At.fixed-Me,Le,At.stretch,G),ss=xv($t.stretch-ue,de,ot,at),on=wv($t.fixed-Ze,ct,$t.stretch,q),qi=new _(wt,Xi),qr=new _(yn,Xi),an=new _(yn,ss),ln=new _(wt,ss),Un=new _(si/w,kr/w),Xs=new _(Ys/w,on/w),Hr=s*Math.PI/180;if(Hr){const Zr=Math.sin(Hr),Wr=Math.cos(Hr),br=[Wr,-Zr,Zr,Wr];qi._matMult(br),qr._matMult(br),ln._matMult(br),an._matMult(br)}const os=Ue.stretch+Ue.fixed,Ar=kt.stretch+kt.fixed;return{tl:qi,tr:qr,bl:ln,br:an,tex:{x:x.paddedRect.x+1+os,y:x.paddedRect.y+1+Ar,w:At.stretch+At.fixed-os,h:$t.stretch+$t.fixed-Ar},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Un,pixelOffsetBR:Xs,minFontScaleX:Le/w/Et,minFontScaleY:ct/w/ot,isSDF:l}};if(p&&(x.stretchX||x.stretchY)){const Ue=Ek(D,X,G),kt=Ek(N,Q,q);for(let At=0;At<Ue.length-1;At++){const $t=Ue[At],wt=Ue[At+1];for(let si=0;si<kt.length-1;si++)m.push(lt($t,kt[si],wt,kt[si+1]))}}else m.push(lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:I+1}));return m}function bv(c,s,l){let p=0;for(const m of c)p+=Math.max(s,Math.min(l,m[1]))-Math.max(s,Math.min(l,m[0]));return p}function Ek(c,s,l){const p=[{fixed:-1,stretch:0}];for(const[m,x]of c){const w=p[p.length-1];p.push({fixed:m-w.stretch,stretch:w.stretch}),p.push({fixed:m-w.stretch,stretch:w.stretch+(x-m)})}return p.push({fixed:s+1,stretch:l}),p}function xv(c,s,l,p){return c/s*l+p}function wv(c,s,l,p){return c-s*l/p}ft("Anchor",eu);class Sv{constructor(s,l,p,m,x,w,C,I,A,D){var N;if(this.boxStartIndex=s.length,A){let U=w.top,G=w.bottom;const q=w.collisionPadding;q&&(U-=q[1],G+=q[3]);let X=G-U;X>0&&(X=Math.max(10,X),this.circleDiameter=X)}else{const U=!((N=w.image)===null||N===void 0)&&N.content&&(w.image.textFitWidth||w.image.textFitHeight)?QM(w):{x1:w.left,y1:w.top,x2:w.right,y2:w.bottom};U.y1=U.y1*C-I[0],U.y2=U.y2*C+I[2],U.x1=U.x1*C-I[3],U.x2=U.x2*C+I[1];const G=w.collisionPadding;if(G&&(U.x1-=G[0]*C,U.y1-=G[1]*C,U.x2+=G[2]*C,U.y2+=G[3]*C),D){const q=new _(U.x1,U.y1),X=new _(U.x2,U.y1),Q=new _(U.x1,U.y2),ne=new _(U.x2,U.y2),ye=D*Math.PI/180;q._rotate(ye),X._rotate(ye),Q._rotate(ye),ne._rotate(ye),U.x1=Math.min(q.x,X.x,Q.x,ne.x),U.x2=Math.max(q.x,X.x,Q.x,ne.x),U.y1=Math.min(q.y,X.y,Q.y,ne.y),U.y2=Math.max(q.y,X.y,Q.y,ne.y)}s.emplaceBack(l.x,l.y,U.x1,U.y1,U.x2,U.y2,p,m,x)}this.boxEndIndex=s.length}}class f9{constructor(s=[],l=(p,m)=>p<m?-1:p>m?1:0){if(this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:l,compare:p}=this,m=l[s];for(;s>0;){const x=s-1>>1,w=l[x];if(p(m,w)>=0)break;l[s]=w,s=x}l[s]=m}_down(s){const{data:l,compare:p}=this,m=this.length>>1,x=l[s];for(;s<m;){let w=1+(s<<1);const C=w+1;if(C<this.length&&p(l[C],l[w])<0&&(w=C),p(l[w],x)>=0)break;l[s]=l[w],s=w}l[s]=x}}function m9(c,s=1,l=!1){const p=Ch.fromPoints(c[0]),m=Math.min(p.width(),p.height());let x=m/2;const w=new f9([],g9),{minX:C,minY:I,maxX:A,maxY:D}=p;if(m===0)return new _(C,I);for(let G=C;G<A;G+=m)for(let q=I;q<D;q+=m)w.push(new Mp(G+x,q+x,x,c));let N=(function(G){let q=0,X=0,Q=0;const ne=G[0];for(let ye=0,ue=ne.length,de=ue-1;ye<ue;de=ye++){const Me=ne[ye],Le=ne[de],Ze=Me.x*Le.y-Le.x*Me.y;X+=(Me.x+Le.x)*Ze,Q+=(Me.y+Le.y)*Ze,q+=3*Ze}return new Mp(X/q,Q/q,0,G)})(c),U=w.length;for(;w.length;){const G=w.pop();(G.d>N.d||!N.d)&&(N=G,l&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,U)),G.max-N.d<=s||(x=G.h/2,w.push(new Mp(G.p.x-x,G.p.y-x,x,c)),w.push(new Mp(G.p.x+x,G.p.y-x,x,c)),w.push(new Mp(G.p.x-x,G.p.y+x,x,c)),w.push(new Mp(G.p.x+x,G.p.y+x,x,c)),U+=4)}return l&&(console.log(`num probes: ${U}`),console.log(`best distance: ${N.d}`)),N.p}function g9(c,s){return s.max-c.max}function Mp(c,s,l,p){this.p=new _(c,s),this.h=l,this.d=(function(m,x){let w=!1,C=1/0;for(let I=0;I<x.length;I++){const A=x[I];for(let D=0,N=A.length,U=N-1;D<N;U=D++){const G=A[D],q=A[U];G.y>m.y!=q.y>m.y&&m.x<(q.x-G.x)*(m.y-G.y)/(q.y-G.y)+G.x&&(w=!w),C=Math.min(C,uM(m,G,q))}}return(w?1:-1)*Math.sqrt(C)})(this.p,p),this.max=this.d+this.h*Math.SQRT2}var gn;d.aE=void 0,(gn=d.aE||(d.aE={}))[gn.center=1]="center",gn[gn.left=2]="left",gn[gn.right=3]="right",gn[gn.top=4]="top",gn[gn.bottom=5]="bottom",gn[gn["top-left"]=6]="top-left",gn[gn["top-right"]=7]="top-right",gn[gn["bottom-left"]=8]="bottom-left",gn[gn["bottom-right"]=9]="bottom-right";const J2=Number.POSITIVE_INFINITY;function Ik(c,s){return s[1]!==J2?(function(l,p,m){let x=0,w=0;switch(p=Math.abs(p),m=Math.abs(m),l){case"top-right":case"top-left":case"top":w=m-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-m}switch(l){case"top-right":case"bottom-right":case"right":x=-p;break;case"top-left":case"bottom-left":case"left":x=p}return[x,w]})(c,s[0],s[1]):(function(l,p){let m=0,x=0;p<0&&(p=0);const w=p/Math.SQRT2;switch(l){case"top-right":case"top-left":x=w-7;break;case"bottom-right":case"bottom-left":x=7-w;break;case"bottom":x=7-p;break;case"top":x=p-7}switch(l){case"top-right":case"bottom-right":m=-w;break;case"top-left":case"bottom-left":m=w;break;case"left":m=p;break;case"right":m=-p}return[m,x]})(c,s[0])}function $k(c,s,l){var p;const m=c.layout,x=(p=m.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(s,{},l);if(x){const C=x.values,I=[];for(let A=0;A<C.length;A+=2){const D=I[A]=C[A],N=C[A+1].map((U=>U*Gr));D.startsWith("top")?N[1]-=7:D.startsWith("bottom")&&(N[1]+=7),I[A+1]=N}return new Cn(I)}const w=m.get("text-variable-anchor");if(w){let C;C=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(s,{},l)*Gr,J2]:m.get("text-offset").evaluate(s,{},l).map((A=>A*Gr));const I=[];for(const A of w)I.push(A,Ik(A,C));return new Cn(I)}return null}function K2(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function y9(c,s,l,p,m,x,w,C,I,A,D,N){let U=x.textMaxSize.evaluate(s,{});U===void 0&&(U=w);const G=c.layers[0].layout,q=G.get("icon-offset").evaluate(s,{},D),X=Mk(l.horizontal),Q=w/24,ne=c.tilePixelRatio*Q,ye=c.tilePixelRatio*U/24,ue=c.tilePixelRatio*C,de=c.tilePixelRatio*G.get("symbol-spacing"),Me=G.get("text-padding")*c.tilePixelRatio,Le=(function(At,$t,wt,si=1){const Xi=At.get("icon-padding").evaluate($t,{},wt),kr=Xi&&Xi.values;return[kr[0]*si,kr[1]*si,kr[2]*si,kr[3]*si]})(G,s,D,c.tilePixelRatio),Ze=G.get("text-max-angle")/180*Math.PI,ct=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point",et=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",at=G.get("symbol-placement"),Et=de/2,ot=G.get("icon-text-fit");let lt;p&&ot!=="none"&&(c.allowVerticalPlacement&&l.vertical&&(lt=ek(p,l.vertical,ot,G.get("icon-text-fit-padding"),q,Q)),X&&(p=ek(p,X,ot,G.get("icon-text-fit-padding"),q,Q)));const Ue=D?N.line.getGranularityForZoomLevel(D.z):1,kt=(At,$t)=>{$t.x<0||$t.x>=rt||$t.y<0||$t.y>=rt||(function(wt,si,Xi,kr,yn,Ys,ss,on,qi,qr,an,ln,Un,Xs,Hr,os,Ar,Zr,Wr,br,Fi,Qo,kp,ea,b9){const Ap=wt.addToLineVertexArray(si,Xi);let Eh,Dp,zp,Op,zk=0,Ok=0,Rk=0,Lk=0,oS=-1,aS=-1;const Hl={};let Fk=Yc("");if(wt.allowVerticalPlacement&&kr.vertical){const Pn=on.layout.get("text-rotate").evaluate(Fi,{},ea)+90;zp=new Sv(qi,si,qr,an,ln,kr.vertical,Un,Xs,Hr,Pn),ss&&(Op=new Sv(qi,si,qr,an,ln,ss,Ar,Zr,Hr,Pn))}if(yn){const Pn=on.layout.get("icon-rotate").evaluate(Fi,{}),Js=on.layout.get("icon-text-fit")!=="none",Ih=Ck(yn,Pn,kp,Js),ia=ss?Ck(ss,Pn,kp,Js):void 0;Dp=new Sv(qi,si,qr,an,ln,yn,Ar,Zr,!1,Pn),zk=4*Ih.length;const $h=wt.iconSizeData;let Ja=null;$h.kind==="source"?(Ja=[ql*on.layout.get("icon-size").evaluate(Fi,{})],Ja[0]>Kc&&lr(`${wt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):$h.kind==="composite"&&(Ja=[ql*Qo.compositeIconSizes[0].evaluate(Fi,{},ea),ql*Qo.compositeIconSizes[1].evaluate(Fi,{},ea)],(Ja[0]>Kc||Ja[1]>Kc)&&lr(`${wt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),wt.addSymbols(wt.icon,Ih,Ja,br,Wr,Fi,d.ao.none,si,Ap.lineStartIndex,Ap.lineLength,-1,ea),oS=wt.icon.placedSymbolArray.length-1,ia&&(Ok=4*ia.length,wt.addSymbols(wt.icon,ia,Ja,br,Wr,Fi,d.ao.vertical,si,Ap.lineStartIndex,Ap.lineLength,-1,ea),aS=wt.icon.placedSymbolArray.length-1)}const Nk=Object.keys(kr.horizontal);for(const Pn of Nk){const Js=kr.horizontal[Pn];if(!Eh){Fk=Yc(Js.text);const ia=on.layout.get("text-rotate").evaluate(Fi,{},ea);Eh=new Sv(qi,si,qr,an,ln,Js,Un,Xs,Hr,ia)}const Ih=Js.positionedLines.length===1;if(Rk+=Pk(wt,si,Js,Ys,on,Hr,Fi,os,Ap,kr.vertical?d.ao.horizontal:d.ao.horizontalOnly,Ih?Nk:[Pn],Hl,oS,Qo,ea),Ih)break}kr.vertical&&(Lk+=Pk(wt,si,kr.vertical,Ys,on,Hr,Fi,os,Ap,d.ao.vertical,["vertical"],Hl,aS,Qo,ea));const x9=Eh?Eh.boxStartIndex:wt.collisionBoxArray.length,w9=Eh?Eh.boxEndIndex:wt.collisionBoxArray.length,S9=zp?zp.boxStartIndex:wt.collisionBoxArray.length,T9=zp?zp.boxEndIndex:wt.collisionBoxArray.length,C9=Dp?Dp.boxStartIndex:wt.collisionBoxArray.length,E9=Dp?Dp.boxEndIndex:wt.collisionBoxArray.length,I9=Op?Op.boxStartIndex:wt.collisionBoxArray.length,$9=Op?Op.boxEndIndex:wt.collisionBoxArray.length;let ta=-1;const Cv=(Pn,Js)=>Pn&&Pn.circleDiameter?Math.max(Pn.circleDiameter,Js):Js;ta=Cv(Eh,ta),ta=Cv(zp,ta),ta=Cv(Dp,ta),ta=Cv(Op,ta);const Bk=ta>-1?1:0;Bk&&(ta*=b9/Gr),wt.glyphOffsetArray.length>=$p.MAX_GLYPHS&&lr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fi.sortKey!==void 0&&wt.addToSortKeyRanges(wt.symbolInstances.length,Fi.sortKey);const P9=$k(on,Fi,ea),[M9,k9]=(function(Pn,Js){const Ih=Pn.length,ia=Js?.values;if(ia?.length>0)for(let $h=0;$h<ia.length;$h+=2){const Ja=ia[$h+1];Pn.emplaceBack(d.aE[ia[$h]],Ja[0],Ja[1])}return[Ih,Pn.length]})(wt.textAnchorOffsets,P9);wt.symbolInstances.emplaceBack(si.x,si.y,Hl.right>=0?Hl.right:-1,Hl.center>=0?Hl.center:-1,Hl.left>=0?Hl.left:-1,Hl.vertical||-1,oS,aS,Fk,x9,w9,S9,T9,C9,E9,I9,$9,qr,Rk,Lk,zk,Ok,Bk,0,Un,ta,M9,k9)})(c,$t,At,l,p,m,lt,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,ne,[Me,Me,Me,Me],ct,I,ue,Le,et,q,s,x,A,D,w)};if(at==="line")for(const At of vk(s.geometry,0,0,rt,rt)){const $t=Th(At,Ue),wt=p9($t,de,Ze,l.vertical||X,p,24,ye,c.overscaling,rt);for(const si of wt)X&&_9(c,X.text,Et,si)||kt($t,si)}else if(at==="line-center"){for(const At of s.geometry)if(At.length>1){const $t=Th(At,Ue),wt=d9($t,Ze,l.vertical||X,p,24,ye);wt&&kt($t,wt)}}else if(s.type==="Polygon")for(const At of ah(s.geometry,0)){const $t=m9(At,16);kt(Th(At[0],Ue,!0),new eu($t.x,$t.y,0))}else if(s.type==="LineString")for(const At of s.geometry){const $t=Th(At,Ue);kt($t,new eu($t[0].x,$t[0].y,0))}else if(s.type==="Point")for(const At of s.geometry)for(const $t of At)kt([$t],new eu($t.x,$t.y,0))}function Pk(c,s,l,p,m,x,w,C,I,A,D,N,U,G,q){const X=(function(ye,ue,de,Me,Le,Ze,ct,et){const at=Me.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Et=[];for(const ot of ue.positionedLines)for(const lt of ot.positionedGlyphs){if(!lt.rect)continue;const Ue=lt.rect||{};let kt=4,At=!0,$t=1,wt=0;const si=(Le||et)&&lt.vertical,Xi=lt.metrics.advance*lt.scale/2;if(et&&ue.verticalizable&&(wt=ot.lineOffset/2-(lt.imageName?-(Gr-lt.metrics.width*lt.scale)/2:(lt.scale-1)*Gr)),lt.imageName){const Zr=ct[lt.imageName];At=Zr.sdf,$t=Zr.pixelRatio,kt=1/$t}const kr=Le?[lt.x+Xi,lt.y]:[0,0];let yn=Le?[0,0]:[lt.x+Xi+de[0],lt.y+de[1]-wt],Ys=[0,0];si&&(Ys=yn,yn=[0,0]);const ss=lt.metrics.isDoubleResolution?2:1,on=(lt.metrics.left-kt)*lt.scale-Xi+yn[0],qi=(-lt.metrics.top-kt)*lt.scale+yn[1],qr=on+Ue.w/ss*lt.scale/$t,an=qi+Ue.h/ss*lt.scale/$t,ln=new _(on,qi),Un=new _(qr,qi),Xs=new _(on,an),Hr=new _(qr,an);if(si){const Zr=new _(-Xi,Xi- -17),Wr=-Math.PI/2,br=12-Xi,Fi=new _(22-br,-(lt.imageName?br:0)),Qo=new _(...Ys);ln._rotateAround(Wr,Zr)._add(Fi)._add(Qo),Un._rotateAround(Wr,Zr)._add(Fi)._add(Qo),Xs._rotateAround(Wr,Zr)._add(Fi)._add(Qo),Hr._rotateAround(Wr,Zr)._add(Fi)._add(Qo)}if(at){const Zr=Math.sin(at),Wr=Math.cos(at),br=[Wr,-Zr,Zr,Wr];ln._matMult(br),Un._matMult(br),Xs._matMult(br),Hr._matMult(br)}const os=new _(0,0),Ar=new _(0,0);Et.push({tl:ln,tr:Un,bl:Xs,br:Hr,tex:Ue,writingMode:ue.writingMode,glyphOffset:kr,sectionIndex:lt.sectionIndex,isSDF:At,pixelOffsetTL:os,pixelOffsetBR:Ar,minFontScaleX:0,minFontScaleY:0})}return Et})(0,l,C,m,x,w,p,c.allowVerticalPlacement),Q=c.textSizeData;let ne=null;Q.kind==="source"?(ne=[ql*m.layout.get("text-size").evaluate(w,{})],ne[0]>Kc&&lr(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Q.kind==="composite"&&(ne=[ql*G.compositeTextSizes[0].evaluate(w,{},q),ql*G.compositeTextSizes[1].evaluate(w,{},q)],(ne[0]>Kc||ne[1]>Kc)&&lr(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,X,ne,C,x,w,A,s,I.lineStartIndex,I.lineLength,U,q);for(const ye of D)N[ye]=c.text.placedSymbolArray.length-1;return 4*X.length}function Mk(c){for(const s in c)return c[s];return null}function _9(c,s,l,p){const m=c.compareText;if(s in m){const x=m[s];for(let w=x.length-1;w>=0;w--)if(p.dist(x[w])<l)return!0}else m[s]=[];return m[s].push(p),!1}const kk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Q2{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,p]=new Uint8Array(s,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=p>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const x=kk[15&p];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(s,2,1),[C]=new Uint32Array(s,4,1);return new Q2(C,w,x,s)}constructor(s,l=64,p=Float64Array,m){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=p,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const x=kk.indexOf(this.ArrayType),w=2*s*this.ArrayType.BYTES_PER_ELEMENT,C=s*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-C%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${p}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+I,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+w+C+I),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+I,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=s)}add(s,l){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=s,this.coords[this._pos++]=l,p}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return eS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,l,p,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:C}=this,I=[0,x.length-1,0],A=[];for(;I.length;){const D=I.pop()||0,N=I.pop()||0,U=I.pop()||0;if(N-U<=C){for(let Q=U;Q<=N;Q++){const ne=w[2*Q],ye=w[2*Q+1];ne>=s&&ne<=p&&ye>=l&&ye<=m&&A.push(x[Q])}continue}const G=U+N>>1,q=w[2*G],X=w[2*G+1];q>=s&&q<=p&&X>=l&&X<=m&&A.push(x[G]),(D===0?s<=q:l<=X)&&(I.push(U),I.push(G-1),I.push(1-D)),(D===0?p>=q:m>=X)&&(I.push(G+1),I.push(N),I.push(1-D))}return A}within(s,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:x,nodeSize:w}=this,C=[0,m.length-1,0],I=[],A=p*p;for(;C.length;){const D=C.pop()||0,N=C.pop()||0,U=C.pop()||0;if(N-U<=w){for(let Q=U;Q<=N;Q++)Dk(x[2*Q],x[2*Q+1],s,l)<=A&&I.push(m[Q]);continue}const G=U+N>>1,q=x[2*G],X=x[2*G+1];Dk(q,X,s,l)<=A&&I.push(m[G]),(D===0?s-p<=q:l-p<=X)&&(C.push(U),C.push(G-1),C.push(1-D)),(D===0?s+p>=q:l+p>=X)&&(C.push(G+1),C.push(N),C.push(1-D))}return I}}function eS(c,s,l,p,m,x){if(m-p<=l)return;const w=p+m>>1;Ak(c,s,w,p,m,x),eS(c,s,l,p,w-1,1-x),eS(c,s,l,w+1,m,1-x)}function Ak(c,s,l,p,m,x){for(;m>p;){if(m-p>600){const A=m-p+1,D=l-p+1,N=Math.log(A),U=.5*Math.exp(2*N/3),G=.5*Math.sqrt(N*U*(A-U)/A)*(D-A/2<0?-1:1);Ak(c,s,l,Math.max(p,Math.floor(l-D*U/A+G)),Math.min(m,Math.floor(l+(A-D)*U/A+G)),x)}const w=s[2*l+x];let C=p,I=m;for(Vg(c,s,p,l),s[2*m+x]>w&&Vg(c,s,p,m);C<I;){for(Vg(c,s,C,I),C++,I--;s[2*C+x]<w;)C++;for(;s[2*I+x]>w;)I--}s[2*p+x]===w?Vg(c,s,p,I):(I++,Vg(c,s,I,m)),I<=l&&(p=I+1),l<=I&&(m=I-1)}}function Vg(c,s,l,p){tS(c,l,p),tS(s,2*l,2*p),tS(s,2*l+1,2*p+1)}function tS(c,s,l){const p=c[s];c[s]=c[l],c[l]=p}function Dk(c,s,l,p){const m=c-l,x=s-p;return m*m+x*x}var iS;d.cx=void 0,(iS=d.cx||(d.cx={})).create="create",iS.load="load",iS.fullLoad="fullLoad";let Tv=null,Gg=[];const rS=1e3/60,nS="loadTime",sS="fullLoadTime",v9={mark(c){performance.mark(c)},frame(c){const s=c;Tv!=null&&Gg.push(s-Tv),Tv=s},clearMetrics(){Tv=null,Gg=[],performance.clearMeasures(nS),performance.clearMeasures(sS);for(const c in d.cx)performance.clearMarks(d.cx[c])},getPerformanceMetrics(){performance.measure(nS,d.cx.create,d.cx.load),performance.measure(sS,d.cx.create,d.cx.fullLoad);const c=performance.getEntriesByName(nS)[0].duration,s=performance.getEntriesByName(sS)[0].duration,l=Gg.length,p=1/(Gg.reduce(((x,w)=>x+w),0)/l/1e3),m=Gg.filter((x=>x>rS)).reduce(((x,w)=>x+(w-rS)/rS),0);return{loadTime:c,fullLoadTime:s,fps:p,percentDroppedFrames:m/(l+m)*100,totalFrames:l}}};d.$=rt,d.A=Pe,d.B=function([c,s,l]){return s+=90,s*=Math.PI/180,l*=Math.PI/180,{x:c*Math.cos(s)*Math.sin(l),y:c*Math.sin(s)*Math.sin(l),z:c*Math.cos(l)}},d.C=Co,d.D=Tt,d.E=St,d.F=Pi,d.G=yh,d.H=function(c){if(Sl==null){const s=c.navigator?c.navigator.userAgent:null;Sl=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Sl},d.I=B2,d.J=class{constructor(c,s){this.target=c,this.mapId=s,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new c9((()=>this.process())),this.subscription=Da(this.target,"message",(l=>this.receive(l)),!1),this.globalScope=vo(self)?c:window}registerMessageHandler(c,s){this.messageHandlers[c]=s}sendAsync(c,s){return new Promise(((l,p)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10),x=s?Da(s.signal,"abort",(()=>{x?.unsubscribe(),delete this.resolveRejects[m];const I={id:m,type:"<cancel>",origin:location.origin,targetMapId:c.targetMapId,sourceMapId:this.mapId};this.target.postMessage(I)}),u9):null;this.resolveRejects[m]={resolve:I=>{x?.unsubscribe(),l(I)},reject:I=>{x?.unsubscribe(),p(I)}};const w=[],C=Object.assign(Object.assign({},c),{id:m,sourceMapId:this.mapId,origin:location.origin,data:Vc(c.data,w)});this.target.postMessage(C,{transfer:w})}))}receive(c){const s=c.data,l=s.id;if(!(s.origin!=="file://"&&location.origin!=="file://"&&s.origin!=="resource://android"&&location.origin!=="resource://android"&&s.origin!==location.origin||s.targetMapId&&this.mapId!==s.targetMapId)){if(s.type==="<cancel>"){delete this.tasks[l];const p=this.abortControllers[l];return delete this.abortControllers[l],void(p&&p.abort())}if(vo(self)||s.mustQueue)return this.tasks[l]=s,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,s)}}process(){if(this.taskQueue.length===0)return;const c=this.taskQueue.shift(),s=this.tasks[c];delete this.tasks[c],this.taskQueue.length>0&&this.invoker.trigger(),s&&this.processTask(c,s)}processTask(c,s){return a(this,void 0,void 0,(function*(){if(s.type==="<response>"){const m=this.resolveRejects[c];return delete this.resolveRejects[c],m?void(s.error?m.reject(Bl(s.error)):m.resolve(Bl(s.data))):void 0}if(!this.messageHandlers[s.type])return void this.completeTask(c,new Error(`Could not find a registered handler for ${s.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const l=Bl(s.data),p=new AbortController;this.abortControllers[c]=p;try{const m=yield this.messageHandlers[s.type](s.sourceMapId,l,p);this.completeTask(c,null,m)}catch(m){this.completeTask(c,m)}}))}completeTask(c,s,l){const p=[];delete this.abortControllers[c];const m={id:c,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:s?Vc(s):null,data:Vc(l,p)};this.target.postMessage(m,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},d.K=K,d.L=function(){var c=new Pe(16);return Pe!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},d.M=function(c,s,l){var p,m,x,w,C,I,A,D,N,U,G,q,X=l[0],Q=l[1],ne=l[2];return s===c?(c[12]=s[0]*X+s[4]*Q+s[8]*ne+s[12],c[13]=s[1]*X+s[5]*Q+s[9]*ne+s[13],c[14]=s[2]*X+s[6]*Q+s[10]*ne+s[14],c[15]=s[3]*X+s[7]*Q+s[11]*ne+s[15]):(m=s[1],x=s[2],w=s[3],C=s[4],I=s[5],A=s[6],D=s[7],N=s[8],U=s[9],G=s[10],q=s[11],c[0]=p=s[0],c[1]=m,c[2]=x,c[3]=w,c[4]=C,c[5]=I,c[6]=A,c[7]=D,c[8]=N,c[9]=U,c[10]=G,c[11]=q,c[12]=p*X+C*Q+N*ne+s[12],c[13]=m*X+I*Q+U*ne+s[13],c[14]=x*X+A*Q+G*ne+s[14],c[15]=w*X+D*Q+q*ne+s[15]),c},d.N=function(c,s,l){var p=l[0],m=l[1],x=l[2];return c[0]=s[0]*p,c[1]=s[1]*p,c[2]=s[2]*p,c[3]=s[3]*p,c[4]=s[4]*m,c[5]=s[5]*m,c[6]=s[6]*m,c[7]=s[7]*m,c[8]=s[8]*x,c[9]=s[9]*x,c[10]=s[10]*x,c[11]=s[11]*x,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},d.O=function(c,s,l){var p=s[0],m=s[1],x=s[2],w=s[3],C=s[4],I=s[5],A=s[6],D=s[7],N=s[8],U=s[9],G=s[10],q=s[11],X=s[12],Q=s[13],ne=s[14],ye=s[15],ue=l[0],de=l[1],Me=l[2],Le=l[3];return c[0]=ue*p+de*C+Me*N+Le*X,c[1]=ue*m+de*I+Me*U+Le*Q,c[2]=ue*x+de*A+Me*G+Le*ne,c[3]=ue*w+de*D+Me*q+Le*ye,c[4]=(ue=l[4])*p+(de=l[5])*C+(Me=l[6])*N+(Le=l[7])*X,c[5]=ue*m+de*I+Me*U+Le*Q,c[6]=ue*x+de*A+Me*G+Le*ne,c[7]=ue*w+de*D+Me*q+Le*ye,c[8]=(ue=l[8])*p+(de=l[9])*C+(Me=l[10])*N+(Le=l[11])*X,c[9]=ue*m+de*I+Me*U+Le*Q,c[10]=ue*x+de*A+Me*G+Le*ne,c[11]=ue*w+de*D+Me*q+Le*ye,c[12]=(ue=l[12])*p+(de=l[13])*C+(Me=l[14])*N+(Le=l[15])*X,c[13]=ue*m+de*I+Me*U+Le*Q,c[14]=ue*x+de*A+Me*G+Le*ne,c[15]=ue*w+de*D+Me*q+Le*ye,c},d.P=_,d.Q=function(c,s){const l={};for(let p=0;p<s.length;p++){const m=s[p];m in c&&(l[m]=c[m])}return l},d.R=ns,d.S=Qc,d.T=P2,d.U=uk,d.V=ck,d.W=pe,d.X=ge,d.Y=Tc,d.Z=Ws,d._=a,d.a=Y,d.a$=Ce,d.a0=function(c,s){var l,p,m,x,w;if(!c)return s??{};if(!s)return c;let C=Object.assign({},c);if(s.removeAll&&(C={removeAll:!0}),s.remove){const I=new Set(s.remove);C.add&&(C.add=C.add.filter((D=>!I.has(D.id)))),C.update&&(C.update=C.update.filter((D=>!I.has(D.id))));const A=new Set(((l=c.add)!==null&&l!==void 0?l:[]).map((D=>D.id)));s.remove=s.remove.filter((D=>!A.has(D)))}if(s.remove){const I=new Set(C.remove?C.remove.concat(s.remove):s.remove);C.remove=Array.from(I.values())}if(s.add){const I=C.add?C.add.concat(s.add):s.add,A=new Map(I.map((D=>[D.id,D])));C.add=Array.from(A.values())}if(s.update){const I=new Map((p=C.update)===null||p===void 0?void 0:p.map((A=>[A.id,A])));for(const A of s.update){const D=(m=I.get(A.id))!==null&&m!==void 0?m:{id:A.id};A.newGeometry&&(D.newGeometry=A.newGeometry),A.addOrUpdateProperties&&(D.addOrUpdateProperties=((x=D.addOrUpdateProperties)!==null&&x!==void 0?x:[]).concat(A.addOrUpdateProperties)),A.removeProperties&&(D.removeProperties=((w=D.removeProperties)!==null&&w!==void 0?w:[]).concat(A.removeProperties)),A.removeAllProperties&&(D.removeAllProperties=!0),I.set(A.id,D)}C.update=Array.from(I.values())}return C.remove&&C.add&&(C.remove=C.remove.filter((I=>C.add.findIndex((A=>A.id===I))===-1))),C},d.a1=jg,d.a2=Ch,d.a3=25,d.a4=X2,d.a5=c=>{const s=window.document.createElement("video");return s.muted=!0,new Promise((l=>{s.onloadstart=()=>{l(s)};for(const p of c){const m=window.document.createElement("source");Ae(p)||(s.crossOrigin="Anonymous"),m.src=p,s.appendChild(m)}}))},d.a6=Qe,d.a7=function(){return Os++},d.a8=B,d.a9=$p,d.aA=function(c){let s=1/0,l=1/0,p=-1/0,m=-1/0;for(const x of c)s=Math.min(s,x.x),l=Math.min(l,x.y),p=Math.max(p,x.x),m=Math.max(m,x.y);return[s,l,p,m]},d.aB=Gr,d.aC=Wt,d.aD=function(c,s,l,p,m=!1){if(!l[0]&&!l[1])return[0,0];const x=m?p==="map"?-c.bearingInRadians:0:p==="viewport"?c.bearingInRadians:0;if(x){const w=Math.sin(x),C=Math.cos(x);l=[l[0]*C-l[1]*w,l[0]*w+l[1]*C]}return[m?l[0]:Wt(s,l[0],c.zoom),m?l[1]:Wt(s,l[1],c.zoom)]},d.aF=V2,d.aG=K2,d.aH=U2,d.aI=Q2,d.aJ=ir,d.aK=fv,d.aL=ae,d.aM=Bt,d.aN=Ti,d.aO=_o,d.aP=za,d.aQ=dk,d.aR=je,d.aS=mt,d.aT=function(c){var s=new Pe(3);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s},d.aU=function(c,s,l){return c[0]=s[0]-l[0],c[1]=s[1]-l[1],c[2]=s[2]-l[2],c},d.aV=function(c,s){var l=s[0],p=s[1],m=s[2],x=l*l+p*p+m*m;return x>0&&(x=1/Math.sqrt(x)),c[0]=s[0]*x,c[1]=s[1]*x,c[2]=s[2]*x,c},d.aW=ke,d.aX=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]},d.aY=function(c,s,l){return c[0]=s[0]*l[0],c[1]=s[1]*l[1],c[2]=s[2]*l[2],c[3]=s[3]*l[3],c},d.aZ=Xe,d.a_=function(c,s,l){const p=s[0]*l[0]+s[1]*l[1]+s[2]*l[2];return p===0?null:(-(c[0]*l[0]+c[1]*l[1]+c[2]*l[2])-l[3])/p},d.aa=Ll,d.ab=Ko,d.ac=gk,d.ad=function(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((l,p,m,x)=>{const w=m||x;return s[p]=!w||w.toLowerCase(),""})),s["max-age"]){const l=parseInt(s["max-age"],10);isNaN(l)?delete s["max-age"]:s["max-age"]=l}return s},d.ae=Tl,d.af=function(c){return Math.pow(2,c)},d.ag=ze,d.ah=rn,d.ai=85.051129,d.aj=hk,d.ak=function(c){return Math.log(c)/Math.LN2},d.al=function(c){var s=c[0],l=c[1];return s*s+l*l},d.am=function(c,s){const l=[];for(const p in c)p in s||l.push(p);return l},d.an=function(c,s){let l=0,p=0;if(c.kind==="constant")p=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:m,minZoom:x,maxZoom:w}=c,C=m?rn(sn.interpolationFactor(m,s,x,w),0,1):0;c.kind==="camera"?p=Co.number(c.minSize,c.maxSize,C):l=C}return{uSizeT:l,uSize:p}},d.ap=function(c,{uSize:s,uSizeT:l},{lowerSize:p,upperSize:m}){return c.kind==="source"?p/ql:c.kind==="composite"?Co.number(p/ql,m/ql,l):s},d.aq=function(c,s){var l=s[0],p=s[1],m=s[2],x=s[3],w=s[4],C=s[5],I=s[6],A=s[7],D=s[8],N=s[9],U=s[10],G=s[11],q=s[12],X=s[13],Q=s[14],ne=s[15],ye=l*C-p*w,ue=l*I-m*w,de=l*A-x*w,Me=p*I-m*C,Le=p*A-x*C,Ze=m*A-x*I,ct=D*X-N*q,et=D*Q-U*q,at=D*ne-G*q,Et=N*Q-U*X,ot=N*ne-G*X,lt=U*ne-G*Q,Ue=ye*lt-ue*ot+de*Et+Me*at-Le*et+Ze*ct;return Ue?(c[0]=(C*lt-I*ot+A*Et)*(Ue=1/Ue),c[1]=(m*ot-p*lt-x*Et)*Ue,c[2]=(X*Ze-Q*Le+ne*Me)*Ue,c[3]=(U*Le-N*Ze-G*Me)*Ue,c[4]=(I*at-w*lt-A*et)*Ue,c[5]=(l*lt-m*at+x*et)*Ue,c[6]=(Q*de-q*Ze-ne*ue)*Ue,c[7]=(D*Ze-U*de+G*ue)*Ue,c[8]=(w*ot-C*at+A*ct)*Ue,c[9]=(p*at-l*ot-x*ct)*Ue,c[10]=(q*Le-X*de+ne*ye)*Ue,c[11]=(N*de-D*Le-G*ye)*Ue,c[12]=(C*et-w*Et-I*ct)*Ue,c[13]=(l*Et-p*et+m*ct)*Ue,c[14]=(X*ue-q*Me-Q*ye)*Ue,c[15]=(D*Me-N*ue+U*ye)*Ue,c):null},d.ar=ht,d.as=function(c){var s=c[0],l=c[1];return Math.sqrt(s*s+l*l)},d.at=function(c){return c[0]=0,c[1]=0,c},d.au=function(c,s,l){return c[0]=s[0]*l,c[1]=s[1]*l,c},d.av=G2,d.aw=Ee,d.ax=function(c,s,l,p){const m=s.y-c.y,x=s.x-c.x,w=p.y-l.y,C=p.x-l.x,I=w*x-C*m;if(I===0)return null;const A=(C*(c.y-l.y)-w*(c.x-l.x))/I;return new _(c.x+A*x,c.y+A*m)},d.ay=vk,d.az=lM,d.b=bo,d.b$=class extends v{},d.b0=function(c,s,l){return c[0]=s[0]*l,c[1]=s[1]*l,c[2]=s[2]*l,c[3]=s[3]*l,c},d.b1=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]},d.b2=fk,d.b3=Pp,d.b4=function(c,s,l,p,m){var x=1/Math.tan(s/2);if(c[0]=x/l,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=x,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,m!=null&&m!==1/0){var w=1/(p-m);c[10]=(m+p)*w,c[14]=2*m*p*w}else c[10]=-1,c[14]=-2*p;return c},d.b5=function(c){var s=new Pe(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},d.b6=function(c,s,l){var p=Math.sin(l),m=Math.cos(l),x=s[0],w=s[1],C=s[2],I=s[3],A=s[4],D=s[5],N=s[6],U=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=x*m+A*p,c[1]=w*m+D*p,c[2]=C*m+N*p,c[3]=I*m+U*p,c[4]=A*m-x*p,c[5]=D*m-w*p,c[6]=N*m-C*p,c[7]=U*m-I*p,c},d.b7=function(c,s,l){var p=Math.sin(l),m=Math.cos(l),x=s[4],w=s[5],C=s[6],I=s[7],A=s[8],D=s[9],N=s[10],U=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=x*m+A*p,c[5]=w*m+D*p,c[6]=C*m+N*p,c[7]=I*m+U*p,c[8]=A*m-x*p,c[9]=D*m-w*p,c[10]=N*m-C*p,c[11]=U*m-I*p,c},d.b8=function(){const c=new Float32Array(16);return ze(c),c},d.b9=function(){const c=new Float64Array(16);return ze(c),c},d.bA=function(c,s){const l=ei(c,360),p=ei(s,360),m=p-l,x=p>l?m-360:m+360;return Math.abs(m)<Math.abs(x)?m:x},d.bB=function(c){return c[0]=0,c[1]=0,c[2]=0,c},d.bC=function(c,s,l,p){const m=Math.sqrt(c*c+s*s),x=Math.sqrt(l*l+p*p);c/=m,s/=m,l/=x,p/=x;const w=Math.acos(c*l+s*p);return-s*l+c*p>0?w:-w},d.bD=function(c,s){const l=ei(c,2*Math.PI),p=ei(s,2*Math.PI);return Math.min(Math.abs(l-p),Math.abs(l-p+2*Math.PI),Math.abs(l-p-2*Math.PI))},d.bE=function(){const c={},s=Te.$version;for(const l in Te.$root){const p=Te.$root[l];if(p.required){let m=null;m=l==="version"?s:p.type==="array"?[]:{},m!=null&&(c[l]=m)}}return c},d.bF=up,d.bG=fe,d.bH=function c(s,l){if(Array.isArray(s)){if(!Array.isArray(l)||s.length!==l.length)return!1;for(let p=0;p<s.length;p++)if(!c(s[p],l[p]))return!1;return!0}if(typeof s=="object"&&s!==null&&l!==null){if(typeof l!="object"||Object.keys(s).length!==Object.keys(l).length)return!1;for(const p in s)if(!c(s[p],l[p]))return!1;return!0}return s===l},d.bI=function(c){c=c.slice();const s=Object.create(null);for(let l=0;l<c.length;l++)s[c[l].id]=c[l];for(let l=0;l<c.length;l++)"ref"in c[l]&&(c[l]=Xt(c[l],s[c[l].ref]));return c},d.bJ=function(c){if(c.type==="custom")return new l9(c);switch(c.type){case"background":return new s9(c);case"circle":return new G8(c);case"color-relief":return new X8(c);case"fill":return new hj(c);case"fill-extrusion":return new wj(c);case"heatmap":return new H8(c);case"hillshade":return new W8(c);case"line":return new Pj(c);case"raster":return new a9(c);case"symbol":return new vv(c)}},d.bK=es,d.bL=function(c,s){if(!c)return[{command:"setStyle",args:[s]}];let l=[];try{if(!It(c.version,s.version))return[{command:"setStyle",args:[s]}];It(c.center,s.center)||l.push({command:"setCenter",args:[s.center]}),It(c.state,s.state)||l.push({command:"setGlobalState",args:[s.state]}),It(c.centerAltitude,s.centerAltitude)||l.push({command:"setCenterAltitude",args:[s.centerAltitude]}),It(c.zoom,s.zoom)||l.push({command:"setZoom",args:[s.zoom]}),It(c.bearing,s.bearing)||l.push({command:"setBearing",args:[s.bearing]}),It(c.pitch,s.pitch)||l.push({command:"setPitch",args:[s.pitch]}),It(c.roll,s.roll)||l.push({command:"setRoll",args:[s.roll]}),It(c.sprite,s.sprite)||l.push({command:"setSprite",args:[s.sprite]}),It(c.glyphs,s.glyphs)||l.push({command:"setGlyphs",args:[s.glyphs]}),It(c.transition,s.transition)||l.push({command:"setTransition",args:[s.transition]}),It(c.light,s.light)||l.push({command:"setLight",args:[s.light]}),It(c.terrain,s.terrain)||l.push({command:"setTerrain",args:[s.terrain]}),It(c.sky,s.sky)||l.push({command:"setSky",args:[s.sky]}),It(c.projection,s.projection)||l.push({command:"setProjection",args:[s.projection]});const p={},m=[];(function(w,C,I,A){let D;for(D in C=C||{},w=w||{})Object.prototype.hasOwnProperty.call(w,D)&&(Object.prototype.hasOwnProperty.call(C,D)||Ir(D,I,A));for(D in C)Object.prototype.hasOwnProperty.call(C,D)&&(Object.prototype.hasOwnProperty.call(w,D)?It(w[D],C[D])||(w[D].type==="geojson"&&C[D].type==="geojson"&&cr(w,C,D)?Nt(I,{command:"setGeoJSONSourceData",args:[D,C[D].data]}):$r(D,C,I,A)):Di(D,C,I))})(c.sources,s.sources,m,p);const x=[];c.layers&&c.layers.forEach((w=>{"source"in w&&p[w.source]?l.push({command:"removeLayer",args:[w.id]}):x.push(w)})),l=l.concat(m),(function(w,C,I){C=C||[];const A=(w=w||[]).map(li),D=C.map(li),N=w.reduce(mr,{}),U=C.reduce(mr,{}),G=A.slice(),q=Object.create(null);let X,Q,ne,ye,ue;for(let de=0,Me=0;de<A.length;de++)X=A[de],Object.prototype.hasOwnProperty.call(U,X)?Me++:(Nt(I,{command:"removeLayer",args:[X]}),G.splice(G.indexOf(X,Me),1));for(let de=0,Me=0;de<D.length;de++)X=D[D.length-1-de],G[G.length-1-de]!==X&&(Object.prototype.hasOwnProperty.call(N,X)?(Nt(I,{command:"removeLayer",args:[X]}),G.splice(G.lastIndexOf(X,G.length-Me),1)):Me++,ye=G[G.length-de],Nt(I,{command:"addLayer",args:[U[X],ye]}),G.splice(G.length-de,0,X),q[X]=!0);for(let de=0;de<D.length;de++)if(X=D[de],Q=N[X],ne=U[X],!q[X]&&!It(Q,ne))if(It(Q.source,ne.source)&&It(Q["source-layer"],ne["source-layer"])&&It(Q.type,ne.type)){for(ue in ti(Q.layout,ne.layout,I,X,null,"setLayoutProperty"),ti(Q.paint,ne.paint,I,X,null,"setPaintProperty"),It(Q.filter,ne.filter)||Nt(I,{command:"setFilter",args:[X,ne.filter]}),It(Q.minzoom,ne.minzoom)&&It(Q.maxzoom,ne.maxzoom)||Nt(I,{command:"setLayerZoomRange",args:[X,ne.minzoom,ne.maxzoom]}),Q)Object.prototype.hasOwnProperty.call(Q,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?ti(Q[ue],ne[ue],I,X,ue.slice(6),"setPaintProperty"):It(Q[ue],ne[ue])||Nt(I,{command:"setLayerProperty",args:[X,ue,ne[ue]]}));for(ue in ne)Object.prototype.hasOwnProperty.call(ne,ue)&&!Object.prototype.hasOwnProperty.call(Q,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?ti(Q[ue],ne[ue],I,X,ue.slice(6),"setPaintProperty"):It(Q[ue],ne[ue])||Nt(I,{command:"setLayerProperty",args:[X,ue,ne[ue]]}))}else Nt(I,{command:"removeLayer",args:[X]}),ye=G[G.lastIndexOf(X)+1],Nt(I,{command:"addLayer",args:[ne,ye]})})(x,s.layers,l)}catch(p){console.warn("Unable to compute style diff:",p),l=[{command:"setStyle",args:[s]}]}return l},d.bM=function(c){const s=[],l=c.id;return l===void 0&&s.push({message:`layers.${l}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${l}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),s},d.bN=wc,d.bO=Sc,d.bP=class extends $n{constructor(c,s){super(c,s),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},d.bQ=Mr,d.bR=class extends $n{constructor(c,s){super(c,s),this.current=vs}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let s=1;s<16;s++)if(c[s]!==this.current[s]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},d.bS=_r,d.bT=class extends $n{constructor(c,s){super(c,s),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},d.bU=class extends $n{constructor(c,s){super(c,s),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},d.bV=Re,d.bW=function(c,s){var l=Math.sin(s),p=Math.cos(s);return c[0]=p,c[1]=l,c[2]=0,c[3]=-l,c[4]=p,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},d.bX=function(c,s,l){var p=s[0],m=s[1],x=s[2];return c[0]=p*l[0]+m*l[3]+x*l[6],c[1]=p*l[1]+m*l[4]+x*l[7],c[2]=p*l[2]+m*l[5]+x*l[8],c},d.bY=function(c,s,l,p,m,x,w){var C=1/(s-l),I=1/(p-m),A=1/(x-w);return c[0]=-2*C,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*I,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*A,c[11]=0,c[12]=(s+l)*C,c[13]=(m+p)*I,c[14]=(w+x)*A,c[15]=1,c},d.bZ=class extends $n{constructor(c,s){super(c,s),this.current=new Array}set(c){if(c!=this.current){this.current=c;const s=new Float32Array(4*c.length);for(let l=0;l<c.length;l++)s[4*l]=c[l].r,s[4*l+1]=c[l].g,s[4*l+2]=c[l].b,s[4*l+3]=c[l].a;this.gl.uniform4fv(this.location,s)}}},d.b_=class extends $n{constructor(c,s){super(c,s),this.current=new Array}set(c){if(c!=this.current){this.current=c;const s=new Float32Array(c);this.gl.uniform1fv(this.location,s)}}},d.ba=function(){return new Float64Array(16)},d.bb=function(c,s,l){const p=new Float64Array(4);return _t(p,c,s-90,l),p},d.bc=function(c,s,l,p){var m,x,w,C,I,A=s[0],D=s[1],N=s[2],U=s[3],G=l[0],q=l[1],X=l[2],Q=l[3];return(x=A*G+D*q+N*X+U*Q)<0&&(x=-x,G=-G,q=-q,X=-X,Q=-Q),1-x>Se?(m=Math.acos(x),w=Math.sin(m),C=Math.sin((1-p)*m)/w,I=Math.sin(p*m)/w):(C=1-p,I=p),c[0]=C*A+I*G,c[1]=C*D+I*q,c[2]=C*N+I*X,c[3]=C*U+I*Q,c},d.bd=function(c){const s=new Float64Array(9);var l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye,ue;N=(m=(p=c)[0])*(I=m+m),U=(x=p[1])*I,q=(w=p[2])*I,X=w*(A=x+x),ne=(C=p[3])*I,ye=C*A,ue=C*(D=w+w),(l=s)[0]=1-(G=x*A)-(Q=w*D),l[3]=U-ue,l[6]=q+ye,l[1]=U+ue,l[4]=1-N-Q,l[7]=X-ne,l[2]=q-ye,l[5]=X+ne,l[8]=1-N-G;const de=za(-Math.asin(rn(s[2],-1,1)));let Me,Le;return Math.hypot(s[5],s[8])<.001?(Me=0,Le=-za(Math.atan2(s[3],s[4]))):(Me=za(s[5]===0&&s[8]===0?0:Math.atan2(s[5],s[8])),Le=za(s[1]===0&&s[0]===0?0:Math.atan2(s[1],s[0]))),{roll:Me,pitch:de+90,bearing:Le}},d.be=function(c,s){return c.roll==s.roll&&c.pitch==s.pitch&&c.bearing==s.bearing},d.bf=Qt,d.bg=Wa,d.bh=Tp,d.bi=Og,d.bj=Sp,d.bk=en,d.bl=hn,d.bm=fn,d.bn=function(c,s,l,p,m){return en(p,m,rn((c-s)/(l-s),0,1))},d.bo=ei,d.bp=function(){return new Float64Array(3)},d.bq=function(c,s,l,p){return c[0]=s[0]+l[0]*p,c[1]=s[1]+l[1]*p,c[2]=s[2]+l[2]*p,c},d.br=_t,d.bs=function(c,s,l){var p=l[0],m=l[1],x=l[2],w=l[3],C=s[0],I=s[1],A=s[2],D=m*A-x*I,N=x*C-p*A,U=p*I-m*C;return c[0]=C+w*(D+=D)+m*(U+=U)-x*(N+=N),c[1]=I+w*N+x*D-p*U,c[2]=A+w*U+p*N-m*D,c},d.bt=function(c,s,l){const p=(m=[c[0],c[1],c[2],s[0],s[1],s[2],l[0],l[1],l[2]])[0]*((D=m[8])*(w=m[4])-(C=m[5])*(A=m[7]))+m[1]*(-D*(x=m[3])+C*(I=m[6]))+m[2]*(A*x-w*I);var m,x,w,C,I,A,D;if(p===0)return null;const N=ke([],[s[0],s[1],s[2]],[l[0],l[1],l[2]]),U=ke([],[l[0],l[1],l[2]],[c[0],c[1],c[2]]),G=ke([],[c[0],c[1],c[2]],[s[0],s[1],s[2]]),q=je([],N,-c[3]);return mt(q,q,je([],U,-s[3])),mt(q,q,je([],G,-l[3])),je(q,q,1/p),q},d.bu=W2,d.bv=function(){return new Float64Array(4)},d.bw=function(c,s,l,p){var m=[],x=[];return m[0]=s[0]-l[0],m[1]=s[1]-l[1],m[2]=s[2]-l[2],x[0]=m[0]*Math.cos(p)-m[1]*Math.sin(p),x[1]=m[0]*Math.sin(p)+m[1]*Math.cos(p),x[2]=m[2],c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.bx=function(c,s,l,p){var m=[],x=[];return m[0]=s[0]-l[0],m[1]=s[1]-l[1],m[2]=s[2]-l[2],x[0]=m[0],x[1]=m[1]*Math.cos(p)-m[2]*Math.sin(p),x[2]=m[1]*Math.sin(p)+m[2]*Math.cos(p),c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.by=function(c,s,l,p){var m=[],x=[];return m[0]=s[0]-l[0],m[1]=s[1]-l[1],m[2]=s[2]-l[2],x[0]=m[2]*Math.sin(p)+m[0]*Math.cos(p),x[1]=m[1],x[2]=m[2]*Math.cos(p)-m[0]*Math.sin(p),c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.bz=function(c,s,l){var p=Math.sin(l),m=Math.cos(l),x=s[0],w=s[1],C=s[2],I=s[3],A=s[8],D=s[9],N=s[10],U=s[11];return s!==c&&(c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=x*m-A*p,c[1]=w*m-D*p,c[2]=C*m-N*p,c[3]=I*m-U*p,c[8]=x*p+A*m,c[9]=w*p+D*m,c[10]=C*p+N*m,c[11]=I*p+U*m,c},d.c=ve,d.c0=Dj,d.c1=class extends u{},d.c2=$2,d.c3=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},d.c4=_M,d.c5=function(c,s,l){var p=s[0],m=s[1],x=s[2],w=l[3]*p+l[7]*m+l[11]*x+l[15];return c[0]=(l[0]*p+l[4]*m+l[8]*x+l[12])/(w=w||1),c[1]=(l[1]*p+l[5]*m+l[9]*x+l[13])/w,c[2]=(l[2]*p+l[6]*m+l[10]*x+l[14])/w,c},d.c6=class extends Tg{},d.c7=class extends z{},d.c8=function(c,s){return c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]&&c[3]===s[3]&&c[4]===s[4]&&c[5]===s[5]&&c[6]===s[6]&&c[7]===s[7]&&c[8]===s[8]&&c[9]===s[9]&&c[10]===s[10]&&c[11]===s[11]&&c[12]===s[12]&&c[13]===s[13]&&c[14]===s[14]&&c[15]===s[15]},d.c9=function(c,s){var l=c[0],p=c[1],m=c[2],x=c[3],w=c[4],C=c[5],I=c[6],A=c[7],D=c[8],N=c[9],U=c[10],G=c[11],q=c[12],X=c[13],Q=c[14],ne=c[15],ye=s[0],ue=s[1],de=s[2],Me=s[3],Le=s[4],Ze=s[5],ct=s[6],et=s[7],at=s[8],Et=s[9],ot=s[10],lt=s[11],Ue=s[12],kt=s[13],At=s[14],$t=s[15];return Math.abs(l-ye)<=Se*Math.max(1,Math.abs(l),Math.abs(ye))&&Math.abs(p-ue)<=Se*Math.max(1,Math.abs(p),Math.abs(ue))&&Math.abs(m-de)<=Se*Math.max(1,Math.abs(m),Math.abs(de))&&Math.abs(x-Me)<=Se*Math.max(1,Math.abs(x),Math.abs(Me))&&Math.abs(w-Le)<=Se*Math.max(1,Math.abs(w),Math.abs(Le))&&Math.abs(C-Ze)<=Se*Math.max(1,Math.abs(C),Math.abs(Ze))&&Math.abs(I-ct)<=Se*Math.max(1,Math.abs(I),Math.abs(ct))&&Math.abs(A-et)<=Se*Math.max(1,Math.abs(A),Math.abs(et))&&Math.abs(D-at)<=Se*Math.max(1,Math.abs(D),Math.abs(at))&&Math.abs(N-Et)<=Se*Math.max(1,Math.abs(N),Math.abs(Et))&&Math.abs(U-ot)<=Se*Math.max(1,Math.abs(U),Math.abs(ot))&&Math.abs(G-lt)<=Se*Math.max(1,Math.abs(G),Math.abs(lt))&&Math.abs(q-Ue)<=Se*Math.max(1,Math.abs(q),Math.abs(Ue))&&Math.abs(X-kt)<=Se*Math.max(1,Math.abs(X),Math.abs(kt))&&Math.abs(Q-At)<=Se*Math.max(1,Math.abs(Q),Math.abs(At))&&Math.abs(ne-$t)<=Se*Math.max(1,Math.abs(ne),Math.abs($t))},d.cA=function(c,s){Y.REGISTERED_PROTOCOLS[c]=s},d.cB=function(c){delete Y.REGISTERED_PROTOCOLS[c]},d.cC=function(c,s){const l={};for(let m=0;m<c.length;m++){const x=s&&s[c[m].id]||g2(c[m]);s&&(s[c[m].id]=x);let w=l[x];w||(w=l[x]=[]),w.push(c[m])}const p=[];for(const m in l)p.push(l[m]);return p},d.cD=ft,d.cE=mk,d.cF=yk,d.cG=ZM,d.cH=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=rt/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const s=c.bucket.layers[0],l=s.layout,p=s._unevaluatedLayout._values,m={layoutIconSize:p["icon-size"].possiblyEvaluate(new Pi(c.bucket.zoom+1),c.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new Pi(c.bucket.zoom+1),c.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new Pi(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:A,maxZoom:D}=c.bucket.textSizeData;m.compositeTextSizes=[p["text-size"].possiblyEvaluate(new Pi(A),c.canonical),p["text-size"].possiblyEvaluate(new Pi(D),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:A,maxZoom:D}=c.bucket.iconSizeData;m.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new Pi(A),c.canonical),p["icon-size"].possiblyEvaluate(new Pi(D),c.canonical)]}const x=l.get("text-line-height")*Gr,w=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",C=l.get("text-keep-upright"),I=l.get("text-size");for(const A of c.bucket.features){const D=l.get("text-font").evaluate(A,{},c.canonical).join(","),N=I.evaluate(A,{},c.canonical),U=m.layoutTextSize.evaluate(A,{},c.canonical),G=m.layoutIconSize.evaluate(A,{},c.canonical),q={horizontal:{},vertical:void 0},X=A.text;let Q,ne=[0,0];if(X){const de=X.toString(),Me=l.get("text-letter-spacing").evaluate(A,{},c.canonical)*Gr,Le=b2(de)?Me:0,Ze=l.get("text-anchor").evaluate(A,{},c.canonical),ct=$k(s,A,c.canonical);if(!ct){const ot=l.get("text-radial-offset").evaluate(A,{},c.canonical);ne=ot?Ik(Ze,[ot*Gr,J2]):l.get("text-offset").evaluate(A,{},c.canonical).map((lt=>lt*Gr))}let et=w?"center":l.get("text-justify").evaluate(A,{},c.canonical);const at=l.get("symbol-placement")==="point"?l.get("text-max-width").evaluate(A,{},c.canonical)*Gr:1/0,Et=()=>{c.bucket.allowVerticalPlacement&&hp(de)&&(q.vertical=gv(X,c.glyphMap,c.glyphPositions,c.imagePositions,D,at,x,Ze,"left",Le,ne,d.ao.vertical,!0,U,N))};if(!w&&ct){const ot=new Set;if(et==="auto")for(let Ue=0;Ue<ct.values.length;Ue+=2)ot.add(K2(ct.values[Ue]));else ot.add(et);let lt=!1;for(const Ue of ot)if(!q.horizontal[Ue])if(lt)q.horizontal[Ue]=q.horizontal[0];else{const kt=gv(X,c.glyphMap,c.glyphPositions,c.imagePositions,D,at,x,"center",Ue,Le,ne,d.ao.horizontal,!1,U,N);kt&&(q.horizontal[Ue]=kt,lt=kt.positionedLines.length===1)}Et()}else{et==="auto"&&(et=K2(Ze));const ot=gv(X,c.glyphMap,c.glyphPositions,c.imagePositions,D,at,x,Ze,et,Le,ne,d.ao.horizontal,!1,U,N);ot&&(q.horizontal[et]=ot),Et(),hp(de)&&w&&C&&(q.vertical=gv(X,c.glyphMap,c.glyphPositions,c.imagePositions,D,at,x,Ze,et,Le,ne,d.ao.vertical,!1,U,N))}}let ye=!1;if(A.icon&&A.icon.name){const de=c.imageMap[A.icon.name];de&&(Q=t9(c.imagePositions[A.icon.name],l.get("icon-offset").evaluate(A,{},c.canonical),l.get("icon-anchor").evaluate(A,{},c.canonical)),ye=!!de.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=ye:c.bucket.sdfIcons!==ye&&lr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(de.pixelRatio!==c.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const ue=Mk(q.horizontal)||q.vertical;c.bucket.iconsInText=!!ue&&ue.iconsInText,(ue||Q)&&y9(c.bucket,A,q,Q,c.imageMap,m,U,G,ne,ye,c.canonical,c.subdivisionGranularity)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},d.cI=L2,d.cJ=z2,d.cK=R2,d.cL=DM,d.cM=N2,d.cN=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},d.cO=function(c,s,l,p,m){return a(this,void 0,void 0,(function*(){if(ge())try{return yield Tc(c,s,l,p,m)}catch{}return(function(x,w,C,I,A){const D=x.width,N=x.height;ka&&Aa||(ka=new OffscreenCanvas(D,N),Aa=ka.getContext("2d",{willReadFrequently:!0})),ka.width=D,ka.height=N,Aa.drawImage(x,0,0,D,N);const U=Aa.getImageData(w,C,I,A);return Aa.clearRect(0,0,D,N),U.data})(c,s,l,p,m)}))},d.cP=xM,d.cQ=T,d.cR=AM,d.cS=Cp,d.cT=hh,d.cU=function(c,s){const l=new Map;if(c!=null)if(c.type==="Feature")l.set(Ug(c,s),c);else for(const p of c.features)l.set(Ug(p,s),p);return l},d.cV=function(c,s){if(c==null)return!0;if(c.type==="Feature")return Ug(c,s)!=null;if(c.type==="FeatureCollection"){const l=new Set;for(const p of c.features){const m=Ug(p,s);if(m==null||l.has(m))return!1;l.add(m)}return!0}return!1},d.cW=function(c,s,l){var p,m,x,w;if(s.removeAll&&c.clear(),s.remove)for(const C of s.remove)c.delete(C);if(s.add)for(const C of s.add){const I=Ug(C,l);I!=null&&c.set(I,C)}if(s.update)for(const C of s.update){let I=c.get(C.id);if(I==null)continue;const A=!C.removeAllProperties&&(((p=C.removeProperties)===null||p===void 0?void 0:p.length)>0||((m=C.addOrUpdateProperties)===null||m===void 0?void 0:m.length)>0);if((C.newGeometry||C.removeAllProperties||A)&&(I=Object.assign({},I),c.set(C.id,I),A&&(I.properties=Object.assign({},I.properties))),C.newGeometry&&(I.geometry=C.newGeometry),C.removeAllProperties)I.properties={};else if(((x=C.removeProperties)===null||x===void 0?void 0:x.length)>0)for(const D of C.removeProperties)Object.prototype.hasOwnProperty.call(I.properties,D)&&delete I.properties[D];if(((w=C.addOrUpdateProperties)===null||w===void 0?void 0:w.length)>0)for(const{key:D,value:N}of C.addOrUpdateProperties)I.properties[D]=N}},d.cX=Gs,d.ca=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},d.cb=c=>c.type==="symbol",d.cc=c=>c.type==="circle",d.cd=c=>c.type==="heatmap",d.ce=c=>c.type==="line",d.cf=c=>c.type==="fill",d.cg=c=>c.type==="fill-extrusion",d.ch=c=>c.type==="hillshade",d.ci=c=>c.type==="color-relief",d.cj=c=>c.type==="raster",d.ck=c=>c.type==="background",d.cl=c=>c.type==="custom",d.cm=tn,d.cn=function(c,s,l){const p=nt(s.x-l.x,s.y-l.y),m=nt(c.x-l.x,c.y-l.y);var x,w;return za(Math.atan2(p[0]*m[1]-p[1]*m[0],(x=p)[0]*(w=m)[0]+x[1]*w[1]))},d.co=Qn,d.cp=function(c,s){return Ra[s]&&(c instanceof MouseEvent||c instanceof WheelEvent)},d.cq=function(c,s){return Oa[s]&&"touches"in c},d.cr=function(c){return Oa[c]||Ra[c]},d.cs=function(c,s,l){var p=s[0],m=s[1];return c[0]=l[0]*p+l[4]*m+l[12],c[1]=l[1]*p+l[5]*m+l[13],c},d.ct=function(c,s){const{x:l,y:p}=jg.fromLngLat(s);return!(c<0||c>25||p<0||p>=1||l<0||l>=1)},d.cu=function(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},d.cv=class extends Hc{},d.cw=v9,d.cy=function(c){return c.message===Cc},d.cz=le,d.d=Ae,d.e=dn,d.f=c=>a(void 0,void 0,void 0,(function*(){if(c.byteLength===0)return createImageBitmap(new ImageData(1,1));const s=new Blob([new Uint8Array(c)],{type:"image/png"});try{return createImageBitmap(s)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),d.g=J,d.h=c=>new Promise(((s,l)=>{const p=new Image;p.onload=()=>{s(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame((()=>{p.src=xo}))},p.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(c)],{type:"image/png"});p.src=c.byteLength?URL.createObjectURL(m):xo})),d.i=vo,d.j=(c,s)=>be(dn(c,{type:"json"}),s),d.k=qe,d.l=Ye,d.m=be,d.n=(c,s)=>be(dn(c,{type:"arrayBuffer"}),s),d.o=function(c){return new N2(c).readFields(Gj,[])},d.p=HM,d.q=Mg,d.r=En,d.s=Da,d.t=sv,d.u=ni,d.v=Te,d.w=lr,d.x=y2,d.y=_h,d.z=Uc})),o("worker",["./shared"],(function(d){class a{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,J){for(const le of Y){this._layerConfigs[le.id]=le;const fe=this._layers[le.id]=d.bJ(le);fe._featureFilter=d.aa(fe.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of J)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const K=d.cC(Object.values(this._layerConfigs),this.keyCache);for(const le of K){const fe=le.map((qe=>this._layers[qe.id])),be=fe[0];if(be.visibility==="none")continue;const Ae=be.source||"";let we=this.familiesBySource[Ae];we||(we=this.familiesBySource[Ae]={});const Be=be.sourceLayer||"_geojsonTileLayer";let Ye=we[Be];Ye||(Ye=we[Be]=[]),Ye.push(fe)}}}class _{constructor(Y){const J={},K=[];for(const Ae in Y){const we=Y[Ae],Be=J[Ae]={};for(const Ye in we){const qe=we[+Ye];if(!qe||qe.bitmap.width===0||qe.bitmap.height===0)continue;const St={x:0,y:0,w:qe.bitmap.width+2,h:qe.bitmap.height+2};K.push(St),Be[Ye]={rect:St,metrics:qe.metrics}}}const{w:le,h:fe}=d.p(K),be=new d.q({width:le||1,height:fe||1});for(const Ae in Y){const we=Y[Ae];for(const Be in we){const Ye=we[+Be];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const qe=J[Ae][Be].rect;d.q.copy(Ye.bitmap,be,{x:0,y:0},{x:qe.x+1,y:qe.y+1},Ye.bitmap)}}this.image=be,this.positions=J}}d.cD("GlyphAtlas",_);class T{constructor(Y){this.tileID=new d.Z(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.uid=Y.uid,this.zoom=Y.zoom,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.collectResourceTiming,this.returnDependencies=!!Y.returnDependencies,this.promoteId=Y.promoteId,this.inFlightDependencies=[],this.globalState=Y.globalState}parse(Y,J,K,le,fe){return d._(this,void 0,void 0,(function*(){this.status="parsing",this.data=Y,this.collisionBoxArray=new d.a8;const be=new d.cE(Object.keys(Y.layers).sort()),Ae=new d.cF(this.tileID,this.promoteId);Ae.bucketLayerIDs=[];const we={},Be={featureIndex:Ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K,subdivisionGranularity:fe},Ye=J.familiesBySource[this.source];for(const ti in Ye){const li=Y.layers[ti];if(!li)continue;li.version===1&&d.w(`Vector tile source "${this.source}" layer "${ti}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const mr=be.encode(ti),Qe=[];for(let pn=0;pn<li.length;pn++){const Zi=li.feature(pn),La=Ae.getId(Zi,ti);Qe.push({feature:Zi,id:La,index:pn,sourceLayerIndex:mr})}for(const pn of Ye[ti]){const Zi=pn[0];Zi.source!==this.source&&d.w(`layer.source = ${Zi.source} does not equal this.source = ${this.source}`),Zi.minzoom&&this.zoom<Math.floor(Zi.minzoom)||Zi.maxzoom&&this.zoom>=Zi.maxzoom||Zi.visibility!=="none"&&(E(pn,this.zoom,K,this.globalState),(we[Zi.id]=Zi.createBucket({index:Ae.bucketLayerIDs.length,layers:pn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mr,sourceID:this.source,globalState:this.globalState})).populate(Qe,Be,this.tileID.canonical),Ae.bucketLayerIDs.push(pn.map((La=>La.id))))}}const qe=d.bN(Be.glyphDependencies,(ti=>Object.keys(ti).map(Number)));this.inFlightDependencies.forEach((ti=>ti?.abort())),this.inFlightDependencies=[];let St=Promise.resolve({});if(Object.keys(qe).length){const ti=new AbortController;this.inFlightDependencies.push(ti),St=le.sendAsync({type:"GG",data:{stacks:qe,source:this.source,tileID:this.tileID,type:"glyphs"}},ti)}const Te=Object.keys(Be.iconDependencies);let Dt=Promise.resolve({});if(Te.length){const ti=new AbortController;this.inFlightDependencies.push(ti),Dt=le.sendAsync({type:"GI",data:{icons:Te,source:this.source,tileID:this.tileID,type:"icons"}},ti)}const Xt=Object.keys(Be.patternDependencies);let It=Promise.resolve({});if(Xt.length){const ti=new AbortController;this.inFlightDependencies.push(ti),It=le.sendAsync({type:"GI",data:{icons:Xt,source:this.source,tileID:this.tileID,type:"patterns"}},ti)}const[Nt,Di,Ir]=yield Promise.all([St,Dt,It]),$r=new _(Nt),cr=new d.cG(Di,Ir);for(const ti in we){const li=we[ti];li instanceof d.a9?(E(li.layers,this.zoom,K,this.globalState),d.cH({bucket:li,glyphMap:Nt,glyphPositions:$r.positions,imageMap:Di,imagePositions:cr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Be.subdivisionGranularity})):li.hasPattern&&(li instanceof d.cI||li instanceof d.cJ||li instanceof d.cK)&&(E(li.layers,this.zoom,K,this.globalState),li.addFeatures(Be,this.tileID.canonical,cr.patternPositions))}return this.status="done",{buckets:Object.values(we).filter((ti=>!ti.isEmpty())),featureIndex:Ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:$r.image,imageAtlas:cr,glyphMap:this.returnDependencies?Nt:null,iconMap:this.returnDependencies?Di:null,glyphPositions:this.returnDependencies?$r.positions:null}}))}}function E(ve,Y,J,K){const le=new d.F(Y);for(const fe of ve)fe.setGlobalState(K),fe.recalculate(le,J)}class k{constructor(Y,J,K){this.actor=Y,this.layerIndex=J,this.availableImages=K,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Y,J){return d._(this,void 0,void 0,(function*(){const K=yield d.n(Y.request,J);try{return{vectorTile:new d.cL(new d.cM(K.data)),rawData:K.data,cacheControl:K.cacheControl,expires:K.expires}}catch(le){const fe=new Uint8Array(K.data);let be=`Unable to parse the tile at ${Y.request.url}, `;throw be+=fe[0]===31&&fe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${le.message}`,new Error(be)}}))}loadTile(Y){return d._(this,void 0,void 0,(function*(){const J=Y.uid,K=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new d.cN(Y.request),le=new T(Y);this.loading[J]=le;const fe=new AbortController;le.abort=fe;try{const be=yield this.loadVectorTile(Y,fe);if(delete this.loading[J],!be)return null;const Ae=be.rawData,we={};be.expires&&(we.expires=be.expires),be.cacheControl&&(we.cacheControl=be.cacheControl);const Be={};if(K){const qe=K.finish();qe&&(Be.resourceTiming=JSON.parse(JSON.stringify(qe)))}le.vectorTile=be.vectorTile;const Ye=le.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity);this.loaded[J]=le,this.fetching[J]={rawTileData:Ae,cacheControl:we,resourceTiming:Be};try{const qe=yield Ye;return d.e({rawTileData:Ae.slice(0)},qe,we,Be)}finally{delete this.fetching[J]}}catch(be){throw delete this.loading[J],le.status="done",this.loaded[J]=le,be}}))}reloadTile(Y){return d._(this,void 0,void 0,(function*(){const J=Y.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const K=this.loaded[J];if(K.showCollisionBoxes=Y.showCollisionBoxes,K.globalState=Y.globalState,K.status==="parsing"){const le=yield K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity);let fe;if(this.fetching[J]){const{rawTileData:be,cacheControl:Ae,resourceTiming:we}=this.fetching[J];delete this.fetching[J],fe=d.e({rawTileData:be.slice(0)},le,Ae,we)}else fe=le;return fe}if(K.status==="done"&&K.vectorTile)return K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity)}))}abortTile(Y){return d._(this,void 0,void 0,(function*(){const J=this.loading,K=Y.uid;J&&J[K]&&J[K].abort&&(J[K].abort.abort(),delete J[K])}))}removeTile(Y){return d._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[Y.uid]&&delete this.loaded[Y.uid]}))}}class L{constructor(){this.loaded={}}loadTile(Y){return d._(this,void 0,void 0,(function*(){const{uid:J,encoding:K,rawImageData:le,redFactor:fe,greenFactor:be,blueFactor:Ae,baseShift:we}=Y,Be=le.width+2,Ye=le.height+2,qe=d.b(le)?new d.R({width:Be,height:Ye},yield d.cO(le,-1,-1,Be,Ye)):le,St=new d.cP(J,qe,K,fe,be,Ae,we);return this.loaded=this.loaded||{},this.loaded[J]=St,St}))}removeTile(Y){const J=this.loaded,K=Y.uid;J&&J[K]&&delete J[K]}}var O,H,re=(function(){if(H)return O;function ve(J,K){if(J.length!==0){Y(J[0],K);for(var le=1;le<J.length;le++)Y(J[le],!K)}}function Y(J,K){for(var le=0,fe=0,be=0,Ae=J.length,we=Ae-1;be<Ae;we=be++){var Be=(J[be][0]-J[we][0])*(J[we][1]+J[be][1]),Ye=le+Be;fe+=Math.abs(le)>=Math.abs(Be)?le-Ye+Be:Be-Ye+le,le=Ye}le+fe>=0!=!!K&&J.reverse()}return H=1,O=function J(K,le){var fe,be=K&&K.type;if(be==="FeatureCollection")for(fe=0;fe<K.features.length;fe++)J(K.features[fe],le);else if(be==="GeometryCollection")for(fe=0;fe<K.geometries.length;fe++)J(K.geometries[fe],le);else if(be==="Feature")J(K.geometry,le);else if(be==="Polygon")ve(K.coordinates,le);else if(be==="MultiPolygon")for(fe=0;fe<K.coordinates.length;fe++)ve(K.coordinates[fe],le);return K}})(),pe=d.cQ(re);class ge extends d.cS{constructor(Y,J){super(new d.cM,0,J,[],[]),this.feature=Y,this.type=Y.type,this.properties=Y.tags?Y.tags:{},"id"in Y&&(typeof Y.id=="string"?this.id=parseInt(Y.id,10):typeof Y.id!="number"||isNaN(Y.id)||(this.id=Y.id))}loadGeometry(){const Y=[],J=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const K of J){const le=[];for(const fe of K)le.push(new d.P(fe[0],fe[1]));Y.push(le)}return Y}}class Se extends d.cR{constructor(Y,J){super(new d.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=J?J.version:1,this.extent=J?J.extent:4096,this.length=Y.length,this.features=Y}feature(Y){return new ge(this.features[Y],this.extent)}}function Pe(ve,Y){Y.writeVarintField(15,ve.version||1),Y.writeStringField(1,ve.name||""),Y.writeVarintField(5,ve.extent||4096);const J={keys:[],values:[],keycache:{},valuecache:{}};for(let fe=0;fe<ve.length;fe++)J.feature=ve.feature(fe),Y.writeMessage(2,Re,J);const K=J.keys;for(const fe of K)Y.writeStringField(3,fe);const le=J.values;for(const fe of le)Y.writeMessage(4,mt,fe)}function Re(ve,Y){if(!ve.feature)return;const J=ve.feature;J.id!==void 0&&Y.writeVarintField(1,J.id),Y.writeMessage(2,ze,ve),Y.writeVarintField(3,J.type),Y.writeMessage(4,yt,J)}function ze(ve,Y){for(const J in ve.feature?.properties){let K=ve.feature.properties[J],le=ve.keycache[J];if(K===null)continue;le===void 0&&(ve.keys.push(J),le=ve.keys.length-1,ve.keycache[J]=le),Y.writeVarint(le),typeof K!="string"&&typeof K!="boolean"&&typeof K!="number"&&(K=JSON.stringify(K));const fe=typeof K+":"+K;let be=ve.valuecache[fe];be===void 0&&(ve.values.push(K),be=ve.values.length-1,ve.valuecache[fe]=be),Y.writeVarint(be)}}function Je(ve,Y){return(Y<<3)+(7&ve)}function Xe(ve){return ve<<1^ve>>31}function yt(ve,Y){const J=ve.loadGeometry(),K=ve.type;let le=0,fe=0;for(const be of J){let Ae=1;K===1&&(Ae=be.length),Y.writeVarint(Je(1,Ae));const we=K===3?be.length-1:be.length;for(let Be=0;Be<we;Be++){Be===1&&K!==1&&Y.writeVarint(Je(2,we-1));const Ye=be[Be].x-le,qe=be[Be].y-fe;Y.writeVarint(Xe(Ye)),Y.writeVarint(Xe(qe)),le+=Ye,fe+=qe}ve.type===3&&Y.writeVarint(Je(7,1))}}function mt(ve,Y){const J=typeof ve;J==="string"?Y.writeStringField(1,ve):J==="boolean"?Y.writeBooleanField(7,ve):J==="number"&&(ve%1!=0?Y.writeDoubleField(3,ve):ve<0?Y.writeSVarintField(6,ve):Y.writeVarintField(5,ve))}const je={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ve=>ve},ke=Math.fround||(We=new Float32Array(1),ve=>(We[0]=+ve,We[0]));var We;class Ce{constructor(Y){this.options=Object.assign(Object.create(je),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:J,minZoom:K,maxZoom:le}=this.options;J&&console.time("total time");const fe=`prepare ${Y.length} points`;J&&console.time(fe),this.points=Y;const be=[];for(let we=0;we<Y.length;we++){const Be=Y[we];if(!Be.geometry)continue;const[Ye,qe]=Be.geometry.coordinates,St=ke(_t(Ye)),Te=ke(ht(qe));be.push(St,Te,1/0,we,-1,1),this.options.reduce&&be.push(0)}let Ae=this.trees[le+1]=this._createTree(be);J&&console.timeEnd(fe);for(let we=le;we>=K;we--){const Be=+Date.now();Ae=this.trees[we]=this._createTree(this._cluster(Ae,we)),J&&console.log("z%d: %d clusters in %dms",we,Ae.numItems,+Date.now()-Be)}return J&&console.timeEnd("total time"),this}getClusters(Y,J){let K=((Y[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,Y[1]));let fe=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const be=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)K=-180,fe=180;else if(K>fe){const qe=this.getClusters([K,le,180,be],J),St=this.getClusters([-180,le,fe,be],J);return qe.concat(St)}const Ae=this.trees[this._limitZoom(J)],we=Ae.range(_t(K),ht(be),_t(fe),ht(le)),Be=Ae.data,Ye=[];for(const qe of we){const St=this.stride*qe;Ye.push(Be[St+5]>1?Ee(Be,St,this.clusterProps):this.points[Be[St+3]])}return Ye}getChildren(Y){const J=this._getOriginId(Y),K=this._getOriginZoom(Y),le="No cluster with the specified id.",fe=this.trees[K];if(!fe)throw new Error(le);const be=fe.data;if(J*this.stride>=be.length)throw new Error(le);const Ae=this.options.radius/(this.options.extent*Math.pow(2,K-1)),we=fe.within(be[J*this.stride],be[J*this.stride+1],Ae),Be=[];for(const Ye of we){const qe=Ye*this.stride;be[qe+4]===Y&&Be.push(be[qe+5]>1?Ee(be,qe,this.clusterProps):this.points[be[qe+3]])}if(Be.length===0)throw new Error(le);return Be}getLeaves(Y,J,K){const le=[];return this._appendLeaves(le,Y,J=J||10,K=K||0,0),le}getTile(Y,J,K){const le=this.trees[this._limitZoom(Y)],fe=Math.pow(2,Y),{extent:be,radius:Ae}=this.options,we=Ae/be,Be=(K-we)/fe,Ye=(K+1+we)/fe,qe={features:[]};return this._addTileFeatures(le.range((J-we)/fe,Be,(J+1+we)/fe,Ye),le.data,J,K,fe,qe),J===0&&this._addTileFeatures(le.range(1-we/fe,Be,1,Ye),le.data,fe,K,fe,qe),J===fe-1&&this._addTileFeatures(le.range(0,Be,we/fe,Ye),le.data,-1,K,fe,qe),qe.features.length?qe:null}getClusterExpansionZoom(Y){let J=this._getOriginZoom(Y)-1;for(;J<=this.options.maxZoom;){const K=this.getChildren(Y);if(J++,K.length!==1)break;Y=K[0].properties.cluster_id}return J}_appendLeaves(Y,J,K,le,fe){const be=this.getChildren(J);for(const Ae of be){const we=Ae.properties;if(we&&we.cluster?fe+we.point_count<=le?fe+=we.point_count:fe=this._appendLeaves(Y,we.cluster_id,K,le,fe):fe<le?fe++:Y.push(Ae),Y.length===K)break}return fe}_createTree(Y){const J=new d.aI(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<Y.length;K+=this.stride)J.add(Y[K],Y[K+1]);return J.finish(),J.data=Y,J}_addTileFeatures(Y,J,K,le,fe,be){for(const Ae of Y){const we=Ae*this.stride,Be=J[we+5]>1;let Ye,qe,St;if(Be)Ye=st(J,we,this.clusterProps),qe=J[we],St=J[we+1];else{const Xt=this.points[J[we+3]];Ye=Xt.properties;const[It,Nt]=Xt.geometry.coordinates;qe=_t(It),St=ht(Nt)}const Te={type:1,geometry:[[Math.round(this.options.extent*(qe*fe-K)),Math.round(this.options.extent*(St*fe-le))]],tags:Ye};let Dt;Dt=Be||this.options.generateId?J[we+3]:this.points[J[we+3]].id,Dt!==void 0&&(Te.id=Dt),be.features.push(Te)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,J){const{radius:K,extent:le,reduce:fe,minPoints:be}=this.options,Ae=K/(le*Math.pow(2,J)),we=Y.data,Be=[],Ye=this.stride;for(let qe=0;qe<we.length;qe+=Ye){if(we[qe+2]<=J)continue;we[qe+2]=J;const St=we[qe],Te=we[qe+1],Dt=Y.within(we[qe],we[qe+1],Ae),Xt=we[qe+5];let It=Xt;for(const Nt of Dt){const Di=Nt*Ye;we[Di+2]>J&&(It+=we[Di+5])}if(It>Xt&&It>=be){let Nt,Di=St*Xt,Ir=Te*Xt,$r=-1;const cr=(qe/Ye<<5)+(J+1)+this.points.length;for(const ti of Dt){const li=ti*Ye;if(we[li+2]<=J)continue;we[li+2]=J;const mr=we[li+5];Di+=we[li]*mr,Ir+=we[li+1]*mr,we[li+4]=cr,fe&&(Nt||(Nt=this._map(we,qe,!0),$r=this.clusterProps.length,this.clusterProps.push(Nt)),fe(Nt,this._map(we,li)))}we[qe+4]=cr,Be.push(Di/It,Ir/It,1/0,cr,-1,It),fe&&Be.push($r)}else{for(let Nt=0;Nt<Ye;Nt++)Be.push(we[qe+Nt]);if(It>1)for(const Nt of Dt){const Di=Nt*Ye;if(!(we[Di+2]<=J)){we[Di+2]=J;for(let Ir=0;Ir<Ye;Ir++)Be.push(we[Di+Ir])}}}}return Be}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,J,K){if(Y[J+5]>1){const be=this.clusterProps[Y[J+6]];return K?Object.assign({},be):be}const le=this.points[Y[J+3]].properties,fe=this.options.map(le);return K&&fe===le?Object.assign({},fe):fe}}function Ee(ve,Y,J){return{type:"Feature",id:ve[Y+3],properties:st(ve,Y,J),geometry:{type:"Point",coordinates:[(K=ve[Y],360*(K-.5)),nt(ve[Y+1])]}};var K}function st(ve,Y,J){const K=ve[Y+5],le=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,fe=ve[Y+6],be=fe===-1?{}:Object.assign({},J[fe]);return Object.assign(be,{cluster:!0,cluster_id:ve[Y+3],point_count:K,point_count_abbreviated:le})}function _t(ve){return ve/360+.5}function ht(ve){const Y=Math.sin(ve*Math.PI/180),J=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return J<0?0:J>1?1:J}function nt(ve){const Y=(180-360*ve)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function rt(ve,Y,J,K){let le=K;const fe=Y+(J-Y>>1);let be,Ae=J-Y;const we=ve[Y],Be=ve[Y+1],Ye=ve[J],qe=ve[J+1];for(let St=Y+3;St<J;St+=3){const Te=Wt(ve[St],ve[St+1],we,Be,Ye,qe);if(Te>le)be=St,le=Te;else if(Te===le){const Dt=Math.abs(St-fe);Dt<Ae&&(be=St,Ae=Dt)}}le>K&&(be-Y>3&&rt(ve,Y,be,K),ve[be+2]=le,J-be>3&&rt(ve,be,J,K))}function Wt(ve,Y,J,K,le,fe){let be=le-J,Ae=fe-K;if(be!==0||Ae!==0){const we=((ve-J)*be+(Y-K)*Ae)/(be*be+Ae*Ae);we>1?(J=le,K=fe):we>0&&(J+=be*we,K+=Ae*we)}return be=ve-J,Ae=Y-K,be*be+Ae*Ae}function ei(ve,Y,J,K){const le={id:ve??null,type:Y,geometry:J,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Y==="Point"||Y==="MultiPoint"||Y==="LineString")en(le,J);else if(Y==="Polygon")en(le,J[0]);else if(Y==="MultiLineString")for(const fe of J)en(le,fe);else if(Y==="MultiPolygon")for(const fe of J)en(le,fe[0]);return le}function en(ve,Y){for(let J=0;J<Y.length;J+=3)ve.minX=Math.min(ve.minX,Y[J]),ve.minY=Math.min(ve.minY,Y[J+1]),ve.maxX=Math.max(ve.maxX,Y[J]),ve.maxY=Math.max(ve.maxY,Y[J+1])}function hn(ve,Y,J,K){if(!Y.geometry)return;const le=Y.geometry.coordinates;if(le&&le.length===0)return;const fe=Y.geometry.type,be=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2);let Ae=[],we=Y.id;if(J.promoteId?we=Y.properties[J.promoteId]:J.generateId&&(we=K||0),fe==="Point")tn(le,Ae);else if(fe==="MultiPoint")for(const Be of le)tn(Be,Ae);else if(fe==="LineString")Qn(le,Ae,be,!1);else if(fe==="MultiLineString"){if(J.lineMetrics){for(const Be of le)Ae=[],Qn(Be,Ae,be,!1),ve.push(ei(we,"LineString",Ae,Y.properties));return}rn(le,Ae,be,!1)}else if(fe==="Polygon")rn(le,Ae,be,!0);else{if(fe!=="MultiPolygon"){if(fe==="GeometryCollection"){for(const Be of Y.geometry.geometries)hn(ve,{id:we,geometry:Be,properties:Y.properties},J,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Be of le){const Ye=[];rn(Be,Ye,be,!0),Ae.push(Ye)}}ve.push(ei(we,fe,Ae,Y.properties))}function tn(ve,Y){Y.push(_o(ve[0]),dn(ve[1]),0)}function Qn(ve,Y,J,K){let le,fe,be=0;for(let we=0;we<ve.length;we++){const Be=_o(ve[we][0]),Ye=dn(ve[we][1]);Y.push(Be,Ye,0),we>0&&(be+=K?(le*Ye-Be*fe)/2:Math.sqrt(Math.pow(Be-le,2)+Math.pow(Ye-fe,2))),le=Be,fe=Ye}const Ae=Y.length-3;Y[2]=1,rt(Y,0,Ae,J),Y[Ae+2]=1,Y.size=Math.abs(be),Y.start=0,Y.end=Y.size}function rn(ve,Y,J,K){for(let le=0;le<ve.length;le++){const fe=[];Qn(ve[le],fe,J,K),Y.push(fe)}}function _o(ve){return ve/360+.5}function dn(ve){const Y=Math.sin(ve*Math.PI/180),J=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return J<0?0:J>1?1:J}function Os(ve,Y,J,K,le,fe,be,Ae){if(K/=Y,fe>=(J/=Y)&&be<K)return ve;if(be<J||fe>=K)return null;const we=[];for(const Be of ve){const Ye=Be.geometry;let qe=Be.type;const St=le===0?Be.minX:Be.minY,Te=le===0?Be.maxX:Be.maxY;if(St>=J&&Te<K){we.push(Be);continue}if(Te<J||St>=K)continue;let Dt=[];if(qe==="Point"||qe==="MultiPoint")wc(Ye,Dt,J,K,le);else if(qe==="LineString")Sc(Ye,Dt,J,K,le,!1,Ae.lineMetrics);else if(qe==="MultiLineString")Qi(Ye,Dt,J,K,le,!1);else if(qe==="Polygon")Qi(Ye,Dt,J,K,le,!0);else if(qe==="MultiPolygon")for(const Xt of Ye){const It=[];Qi(Xt,It,J,K,le,!0),It.length&&Dt.push(It)}if(Dt.length){if(Ae.lineMetrics&&qe==="LineString"){for(const Xt of Dt)we.push(ei(Be.id,qe,Xt,Be.tags));continue}qe!=="LineString"&&qe!=="MultiLineString"||(Dt.length===1?(qe="LineString",Dt=Dt[0]):qe="MultiLineString"),qe!=="Point"&&qe!=="MultiPoint"||(qe=Dt.length===3?"Point":"MultiPoint"),we.push(ei(Be.id,qe,Dt,Be.tags))}}return we.length?we:null}function wc(ve,Y,J,K,le){for(let fe=0;fe<ve.length;fe+=3){const be=ve[fe+le];be>=J&&be<=K&&lr(Y,ve[fe],ve[fe+1],ve[fe+2])}}function Sc(ve,Y,J,K,le,fe,be){let Ae=es(ve);const we=le===0?Rs:vo;let Be,Ye,qe=ve.start;for(let It=0;It<ve.length-3;It+=3){const Nt=ve[It],Di=ve[It+1],Ir=ve[It+2],$r=ve[It+3],cr=ve[It+4],ti=le===0?Nt:Di,li=le===0?$r:cr;let mr=!1;be&&(Be=Math.sqrt(Math.pow(Nt-$r,2)+Math.pow(Di-cr,2))),ti<J?li>J&&(Ye=we(Ae,Nt,Di,$r,cr,J),be&&(Ae.start=qe+Be*Ye)):ti>K?li<K&&(Ye=we(Ae,Nt,Di,$r,cr,K),be&&(Ae.start=qe+Be*Ye)):lr(Ae,Nt,Di,Ir),li<J&&ti>=J&&(Ye=we(Ae,Nt,Di,$r,cr,J),mr=!0),li>K&&ti<=K&&(Ye=we(Ae,Nt,Di,$r,cr,K),mr=!0),!fe&&mr&&(be&&(Ae.end=qe+Be*Ye),Y.push(Ae),Ae=es(ve)),be&&(qe+=Be)}let St=ve.length-3;const Te=ve[St],Dt=ve[St+1],Xt=le===0?Te:Dt;Xt>=J&&Xt<=K&&lr(Ae,Te,Dt,ve[St+2]),St=Ae.length-3,fe&&St>=3&&(Ae[St]!==Ae[0]||Ae[St+1]!==Ae[1])&&lr(Ae,Ae[0],Ae[1],Ae[2]),Ae.length&&Y.push(Ae)}function es(ve){const Y=[];return Y.size=ve.size,Y.start=ve.start,Y.end=ve.end,Y}function Qi(ve,Y,J,K,le,fe){for(const be of ve)Sc(be,Y,J,K,le,fe,!1)}function lr(ve,Y,J,K){ve.push(Y,J,K)}function Rs(ve,Y,J,K,le,fe){const be=(fe-Y)/(K-Y);return lr(ve,fe,J+(le-J)*be,1),be}function vo(ve,Y,J,K,le,fe){const be=(fe-J)/(le-J);return lr(ve,Y+(K-Y)*be,fe,1),be}function Sl(ve,Y){const J=[];for(let K=0;K<ve.length;K++){const le=ve[K],fe=le.type;let be;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")be=bo(le.geometry,Y);else if(fe==="MultiLineString"||fe==="Polygon"){be=[];for(const Ae of le.geometry)be.push(bo(Ae,Y))}else if(fe==="MultiPolygon"){be=[];for(const Ae of le.geometry){const we=[];for(const Be of Ae)we.push(bo(Be,Y));be.push(we)}}J.push(ei(le.id,fe,be,le.tags))}return J}function bo(ve,Y){const J=[];J.size=ve.size,ve.start!==void 0&&(J.start=ve.start,J.end=ve.end);for(let K=0;K<ve.length;K+=3)J.push(ve[K]+Y,ve[K+1],ve[K+2]);return J}function xo(ve,Y){if(ve.transformed)return ve;const J=1<<ve.z,K=ve.x,le=ve.y;for(const fe of ve.features){const be=fe.geometry,Ae=fe.type;if(fe.geometry=[],Ae===1)for(let we=0;we<be.length;we+=2)fe.geometry.push(Tc(be[we],be[we+1],Y,J,K,le));else for(let we=0;we<be.length;we++){const Be=[];for(let Ye=0;Ye<be[we].length;Ye+=2)Be.push(Tc(be[we][Ye],be[we][Ye+1],Y,J,K,le));fe.geometry.push(Be)}}return ve.transformed=!0,ve}function Tc(ve,Y,J,K,le,fe){return[Math.round(J*(ve*K-le)),Math.round(J*(Y*K-fe))]}function ka(ve,Y,J,K,le){const fe=Y===le.maxZoom?0:le.tolerance/((1<<Y)*le.extent),be={features:[],numPoints:0,numSimplified:0,numFeatures:ve.length,source:null,x:J,y:K,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ae of ve)Aa(be,Ae,fe,le);return be}function Aa(ve,Y,J,K){const le=Y.geometry,fe=Y.type,be=[];if(ve.minX=Math.min(ve.minX,Y.minX),ve.minY=Math.min(ve.minY,Y.minY),ve.maxX=Math.max(ve.maxX,Y.maxX),ve.maxY=Math.max(ve.maxY,Y.maxY),fe==="Point"||fe==="MultiPoint")for(let Ae=0;Ae<le.length;Ae+=3)be.push(le[Ae],le[Ae+1]),ve.numPoints++,ve.numSimplified++;else if(fe==="LineString")Da(be,le,ve,J,!1,!1);else if(fe==="MultiLineString"||fe==="Polygon")for(let Ae=0;Ae<le.length;Ae++)Da(be,le[Ae],ve,J,fe==="Polygon",Ae===0);else if(fe==="MultiPolygon")for(let Ae=0;Ae<le.length;Ae++){const we=le[Ae];for(let Be=0;Be<we.length;Be++)Da(be,we[Be],ve,J,!0,Be===0)}if(be.length){let Ae=Y.tags||null;if(fe==="LineString"&&K.lineMetrics){Ae={};for(const Be in Y.tags)Ae[Be]=Y.tags[Be];Ae.mapbox_clip_start=le.start/le.size,Ae.mapbox_clip_end=le.end/le.size}const we={geometry:be,type:fe==="Polygon"||fe==="MultiPolygon"?3:fe==="LineString"||fe==="MultiLineString"?2:1,tags:Ae};Y.id!==null&&(we.id=Y.id),ve.features.push(we)}}function Da(ve,Y,J,K,le,fe){const be=K*K;if(K>0&&Y.size<(le?be:K))return void(J.numPoints+=Y.length/3);const Ae=[];for(let we=0;we<Y.length;we+=3)(K===0||Y[we+2]>be)&&(J.numSimplified++,Ae.push(Y[we],Y[we+1])),J.numPoints++;le&&(function(we,Be){let Ye=0;for(let qe=0,St=we.length,Te=St-2;qe<St;Te=qe,qe+=2)Ye+=(we[qe]-we[Te])*(we[qe+1]+we[Te+1]);if(Ye>0===Be)for(let qe=0,St=we.length;qe<St/2;qe+=2){const Te=we[qe],Dt=we[qe+1];we[qe]=we[St-2-qe],we[qe+1]=we[St-1-qe],we[St-2-qe]=Te,we[St-1-qe]=Dt}})(Ae,fe),ve.push(Ae)}const Tl={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class za{constructor(Y,J){const K=(J=this.options=(function(fe,be){for(const Ae in be)fe[Ae]=be[Ae];return fe})(Object.create(Tl),J)).debug;if(K&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");let le=(function(fe,be){const Ae=[];if(fe.type==="FeatureCollection")for(let we=0;we<fe.features.length;we++)hn(Ae,fe.features[we],be,we);else hn(Ae,fe.type==="Feature"?fe:{geometry:fe},be);return Ae})(Y,J);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),le=(function(fe,be){const Ae=be.buffer/be.extent;let we=fe;const Be=Os(fe,1,-1-Ae,Ae,0,-1,2,be),Ye=Os(fe,1,1-Ae,2+Ae,0,-1,2,be);return(Be||Ye)&&(we=Os(fe,1,-Ae,1+Ae,0,-1,2,be)||[],Be&&(we=Sl(Be,1).concat(we)),Ye&&(we=we.concat(Sl(Ye,-1)))),we})(le,J),le.length&&this.splitTile(le,0,0,0),K&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Y,J,K,le,fe,be,Ae){const we=[Y,J,K,le],Be=this.options,Ye=Be.debug;for(;we.length;){le=we.pop(),K=we.pop(),J=we.pop(),Y=we.pop();const qe=1<<J,St=Oa(J,K,le);let Te=this.tiles[St];if(!Te&&(Ye>1&&console.time("creation"),Te=this.tiles[St]=ka(Y,J,K,le,Be),this.tileCoords.push({z:J,x:K,y:le}),Ye)){Ye>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,K,le,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));const mr=`z${J}`;this.stats[mr]=(this.stats[mr]||0)+1,this.total++}if(Te.source=Y,fe==null){if(J===Be.indexMaxZoom||Te.numPoints<=Be.indexMaxPoints)continue}else{if(J===Be.maxZoom||J===fe)continue;if(fe!=null){const mr=fe-J;if(K!==be>>mr||le!==Ae>>mr)continue}}if(Te.source=null,Y.length===0)continue;Ye>1&&console.time("clipping");const Dt=.5*Be.buffer/Be.extent,Xt=.5-Dt,It=.5+Dt,Nt=1+Dt;let Di=null,Ir=null,$r=null,cr=null,ti=Os(Y,qe,K-Dt,K+It,0,Te.minX,Te.maxX,Be),li=Os(Y,qe,K+Xt,K+Nt,0,Te.minX,Te.maxX,Be);Y=null,ti&&(Di=Os(ti,qe,le-Dt,le+It,1,Te.minY,Te.maxY,Be),Ir=Os(ti,qe,le+Xt,le+Nt,1,Te.minY,Te.maxY,Be),ti=null),li&&($r=Os(li,qe,le-Dt,le+It,1,Te.minY,Te.maxY,Be),cr=Os(li,qe,le+Xt,le+Nt,1,Te.minY,Te.maxY,Be),li=null),Ye>1&&console.timeEnd("clipping"),we.push(Di||[],J+1,2*K,2*le),we.push(Ir||[],J+1,2*K,2*le+1),we.push($r||[],J+1,2*K+1,2*le),we.push(cr||[],J+1,2*K+1,2*le+1)}}getTile(Y,J,K){Y=+Y,J=+J,K=+K;const le=this.options,{extent:fe,debug:be}=le;if(Y<0||Y>24)return null;const Ae=1<<Y,we=Oa(Y,J=J+Ae&Ae-1,K);if(this.tiles[we])return xo(this.tiles[we],fe);be>1&&console.log("drilling down to z%d-%d-%d",Y,J,K);let Be,Ye=Y,qe=J,St=K;for(;!Be&&Ye>0;)Ye--,qe>>=1,St>>=1,Be=this.tiles[Oa(Ye,qe,St)];return Be&&Be.source?(be>1&&(console.log("found parent tile z%d-%d-%d",Ye,qe,St),console.time("drilling down")),this.splitTile(Be.source,Ye,qe,St,Y,J,K),be>1&&console.timeEnd("drilling down"),this.tiles[we]?xo(this.tiles[we],fe):null):null}}function Oa(ve,Y,J){return 32*((1<<ve)*J+Y)+ve}class Ra extends k{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Y,J){return d._(this,void 0,void 0,(function*(){const K=Y.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const le=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!le)return null;const fe=new Se(le.features,{version:2,extent:d.$});let be=(function(Ae){const we=new d.cM;return(function(Be,Ye){for(const qe in Be.layers)Ye.writeMessage(3,Pe,Be.layers[qe])})(Ae,we),we.finish()})(fe);return be.byteOffset===0&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),{vectorTile:fe,rawData:be.buffer}}))}loadData(Y){return d._(this,void 0,void 0,(function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const K=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new d.cN(Y.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(Y,this._pendingRequest);const le=yield this._pendingData;this._geoJSONIndex=Y.cluster?new Ce((function({superclusterOptions:be,clusterProperties:Ae}){if(!Ae||!be)return be;const we={},Be={},Ye={accumulated:null,zoom:0},qe={properties:null},St=Object.keys(Ae);for(const Te of St){const[Dt,Xt]=Ae[Te],It=d.cT(Xt),Nt=d.cT(typeof Dt=="string"?[Dt,["accumulated"],["get",Te]]:Dt);we[Te]=It.value,Be[Te]=Nt.value}return be.map=Te=>{qe.properties=Te;const Dt={};for(const Xt of St)Dt[Xt]=we[Xt].evaluate(Ye,qe);return Dt},be.reduce=(Te,Dt)=>{qe.properties=Dt;for(const Xt of St)Ye.accumulated=Te[Xt],Te[Xt]=Be[Xt].evaluate(Ye,qe)},be})(Y)).load(le.features):(function(be,Ae){return new za(be,Ae)})(le,Y.geojsonVtOptions),this.loaded={};const fe={data:le};if(K){const be=K.finish();be&&(fe.resourceTiming={},fe.resourceTiming[Y.source]=JSON.parse(JSON.stringify(be)))}return fe}catch(le){if(delete this._pendingRequest,d.cy(le))return{abandoned:!0};throw le}}))}getData(){return d._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(Y){const J=this.loaded;return J&&J[Y.uid]?super.reloadTile(Y):this.loadTile(Y)}loadAndProcessGeoJSON(Y,J){return d._(this,void 0,void 0,(function*(){let K=yield this.loadGeoJSON(Y,J);if(delete this._pendingRequest,typeof K!="object")throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`);if(pe(K,!0),Y.filter){const le=d.cT(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map((be=>`${be.key}: ${be.message}`)).join(", "));K={type:"FeatureCollection",features:K.features.filter((be=>le.value.evaluate({zoom:0},be)))}}return K}))}loadGeoJSON(Y,J){return d._(this,void 0,void 0,(function*(){const{promoteId:K}=Y;if(Y.request){const le=yield d.j(Y.request,J);return this._dataUpdateable=d.cV(le.data,K)?d.cU(le.data,K):void 0,le.data}if(typeof Y.data=="string")try{const le=JSON.parse(Y.data);return this._dataUpdateable=d.cV(le,K)?d.cU(le,K):void 0,le}catch{throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`)}if(!Y.dataDiff)throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Y.source}`);return d.cW(this._dataUpdateable,Y.dataDiff,K),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(Y){return d._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(Y){return this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId)}getClusterChildren(Y){return this._geoJSONIndex.getChildren(Y.clusterId)}getClusterLeaves(Y){return this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset)}}class Cc{constructor(Y){this.self=Y,this.actor=new d.J(Y),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(J,K)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=K},this.self.addProtocol=d.cA,this.self.removeProtocol=d.cB,this.self.registerRTLTextPlugin=J=>{d.cX.setMethods(J)},this.actor.registerMessageHandler("LDT",((J,K)=>this._getDEMWorkerSource(J,K.source).loadTile(K))),this.actor.registerMessageHandler("RDT",((J,K)=>d._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(J,K.source).removeTile(K)})))),this.actor.registerMessageHandler("GCEZ",((J,K)=>d._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,K.type,K.source).getClusterExpansionZoom(K)})))),this.actor.registerMessageHandler("GCC",((J,K)=>d._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,K.type,K.source).getClusterChildren(K)})))),this.actor.registerMessageHandler("GCL",((J,K)=>d._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,K.type,K.source).getClusterLeaves(K)})))),this.actor.registerMessageHandler("LD",((J,K)=>this._getWorkerSource(J,K.type,K.source).loadData(K))),this.actor.registerMessageHandler("GD",((J,K)=>this._getWorkerSource(J,K.type,K.source).getData())),this.actor.registerMessageHandler("LT",((J,K)=>this._getWorkerSource(J,K.type,K.source).loadTile(K))),this.actor.registerMessageHandler("RT",((J,K)=>this._getWorkerSource(J,K.type,K.source).reloadTile(K))),this.actor.registerMessageHandler("AT",((J,K)=>this._getWorkerSource(J,K.type,K.source).abortTile(K))),this.actor.registerMessageHandler("RMT",((J,K)=>this._getWorkerSource(J,K.type,K.source).removeTile(K))),this.actor.registerMessageHandler("RS",((J,K)=>d._(this,void 0,void 0,(function*(){if(!this.workerSources[J]||!this.workerSources[J][K.type]||!this.workerSources[J][K.type][K.source])return;const le=this.workerSources[J][K.type][K.source];delete this.workerSources[J][K.type][K.source],le.removeSource!==void 0&&le.removeSource(K)})))),this.actor.registerMessageHandler("RM",(J=>d._(this,void 0,void 0,(function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J]})))),this.actor.registerMessageHandler("SR",((J,K)=>d._(this,void 0,void 0,(function*(){this.referrer=K})))),this.actor.registerMessageHandler("SRPS",((J,K)=>this._syncRTLPluginState(J,K))),this.actor.registerMessageHandler("IS",((J,K)=>d._(this,void 0,void 0,(function*(){this.self.importScripts(K)})))),this.actor.registerMessageHandler("SI",((J,K)=>this._setImages(J,K))),this.actor.registerMessageHandler("UL",((J,K)=>d._(this,void 0,void 0,(function*(){this._getLayerIndex(J).update(K.layers,K.removedIds)})))),this.actor.registerMessageHandler("SL",((J,K)=>d._(this,void 0,void 0,(function*(){this._getLayerIndex(J).replace(K)}))))}_setImages(Y,J){return d._(this,void 0,void 0,(function*(){this.availableImages[Y]=J;for(const K in this.workerSources[Y]){const le=this.workerSources[Y][K];for(const fe in le)le[fe].availableImages=J}}))}_syncRTLPluginState(Y,J){return d._(this,void 0,void 0,(function*(){return yield d.cX.syncState(J,this.self.importScripts)}))}_getAvailableImages(Y){let J=this.availableImages[Y];return J||(J=[]),J}_getLayerIndex(Y){let J=this.layerIndexes[Y];return J||(J=this.layerIndexes[Y]=new a),J}_getWorkerSource(Y,J,K){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][J]||(this.workerSources[Y][J]={}),!this.workerSources[Y][J][K]){const le={sendAsync:(fe,be)=>(fe.targetMapId=Y,this.actor.sendAsync(fe,be))};switch(J){case"vector":this.workerSources[Y][J][K]=new k(le,this._getLayerIndex(Y),this._getAvailableImages(Y));break;case"geojson":this.workerSources[Y][J][K]=new Ra(le,this._getLayerIndex(Y),this._getAvailableImages(Y));break;default:this.workerSources[Y][J][K]=new this.externalWorkerSourceTypes[J](le,this._getLayerIndex(Y),this._getAvailableImages(Y))}}return this.workerSources[Y][J][K]}_getDEMWorkerSource(Y,J){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][J]||(this.demWorkerSources[Y][J]=new L),this.demWorkerSources[Y][J]}}return d.i(self)&&(self.worker=new Cc(self)),Cc})),o("index",["exports","./shared"],(function(d,a){var _="5.7.1";function T(){var v=new a.A(4);return a.A!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v}let E,k;const L={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(v,n,u){const f=requestAnimationFrame((b=>{g(),n(b)})),{unsubscribe:g}=a.s(v.signal,"abort",(()=>{g(),cancelAnimationFrame(f),u(a.c())}),!1)},frameAsync(v){return new Promise(((n,u)=>{this.frame(v,n,u)}))},getImageData(v,n=0){return this.getImageCanvasContext(v).getImageData(-n,-n,v.width+2*n,v.height+2*n)},getImageCanvasContext(v){const n=window.document.createElement("canvas"),u=n.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return n.width=v.width,n.height=v.height,u.drawImage(v,0,0,v.width,v.height),u},resolveURL:v=>(E||(E=document.createElement("a")),E.href=v,E.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(k==null&&(k=matchMedia("(prefers-reduced-motion: reduce)")),k.matches)}};class O{static testProp(n){if(!O.docStyle)return n[0];for(let u=0;u<n.length;u++)if(n[u]in O.docStyle)return n[u];return n[0]}static create(n,u,f){const g=window.document.createElement(n);return u!==void 0&&(g.className=u),f&&f.appendChild(g),g}static createNS(n,u){return window.document.createElementNS(n,u)}static disableDrag(){O.docStyle&&O.selectProp&&(O.userSelect=O.docStyle[O.selectProp],O.docStyle[O.selectProp]="none")}static enableDrag(){O.docStyle&&O.selectProp&&(O.docStyle[O.selectProp]=O.userSelect)}static setTransform(n,u){n.style[O.transformProp]=u}static addEventListener(n,u,f,g={}){n.addEventListener(u,f,"passive"in g?g:g.capture)}static removeEventListener(n,u,f,g={}){n.removeEventListener(u,f,"passive"in g?g:g.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",O.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",O.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",O.suppressClickInternal,!0)}),0)}static getScale(n){const u=n.getBoundingClientRect();return{x:u.width/n.offsetWidth||1,y:u.height/n.offsetHeight||1,boundingClientRect:u}}static getPoint(n,u,f){const g=u.boundingClientRect;return new a.P((f.clientX-g.left)/u.x-n.clientLeft,(f.clientY-g.top)/u.y-n.clientTop)}static mousePos(n,u){const f=O.getScale(n);return O.getPoint(n,f,u)}static touchPos(n,u){const f=[],g=O.getScale(n);for(let b=0;b<u.length;b++)f.push(O.getPoint(n,g,u[b]));return f}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}static sanitize(n){const u=new DOMParser().parseFromString(n,"text/html").body||document.createElement("body"),f=u.querySelectorAll("script");for(const g of f)g.remove();return O.clean(u),u.innerHTML}static isPossiblyDangerous(n,u){const f=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(n)||!f.includes("javascript:")&&!f.includes("data:"))||!!n.startsWith("on")||void 0}static clean(n){const u=n.children;for(const f of u)O.removeAttributes(f),O.clean(f)}static removeAttributes(n){for(const{name:u,value:f}of n.attributes)O.isPossiblyDangerous(u,f)&&n.removeAttribute(u)}}O.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,O.selectProp=O.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),O.transformProp=O.testProp(["transform","WebkitTransform"]);const H={supported:!1,testSupport:function(v){!ge&&pe&&(Se?Pe(v):re=v)}};let re,pe,ge=!1,Se=!1;function Pe(v){const n=v.createTexture();v.bindTexture(v.TEXTURE_2D,n);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,pe),v.isContextLost())return;H.supported=!0}catch{}v.deleteTexture(n),ge=!0}var Re;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=()=>{re&&Pe(re),re=null,Se=!0},pe.onerror=()=>{ge=!0,re=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(v){let n,u,f,g;v.resetRequestQueue=()=>{n=[],u=0,f=0,g={}},v.addThrottleControl=M=>{const z=f++;return g[z]=M,z},v.removeThrottleControl=M=>{delete g[M],S()},v.getImage=(M,z,F=!0)=>new Promise(((j,B)=>{H.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),a.e(M,{type:"image"}),n.push({abortController:z,requestParameters:M,supportImageRefresh:F,state:"queued",onError:V=>{B(V)},onSuccess:V=>{j(V)}}),S()}));const b=M=>a._(this,void 0,void 0,(function*(){M.state="running";const{requestParameters:z,supportImageRefresh:F,onError:j,onSuccess:B,abortController:V}=M,W=F===!1&&!a.i(self)&&!a.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce(((ie,se)=>ie&&se==="accept"),!0));u++;const te=W?$(z,V):a.m(z,V);try{const ie=yield te;delete M.abortController,M.state="completed",ie.data instanceof HTMLImageElement||a.b(ie.data)?B(ie):ie.data&&B({data:yield(ee=ie.data,typeof createImageBitmap=="function"?a.f(ee):a.h(ee)),cacheControl:ie.cacheControl,expires:ie.expires})}catch(ie){delete M.abortController,j(ie)}finally{u--,S()}var ee})),S=()=>{const M=(()=>{for(const z of Object.keys(g))if(g[z]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=u;z<M&&n.length>0;z++){const F=n.shift();F.abortController.signal.aborted?z--:b(F)}},$=(M,z)=>new Promise(((F,j)=>{const B=new Image,V=M.url,W=M.credentials;W&&W==="include"?B.crossOrigin="use-credentials":(W&&W==="same-origin"||!a.d(V))&&(B.crossOrigin="anonymous"),z.signal.addEventListener("abort",(()=>{B.src="",j(a.c())})),B.fetchPriority="high",B.onload=()=>{B.onerror=B.onload=null,F({data:B})},B.onerror=()=>{B.onerror=B.onload=null,z.signal.aborted||j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},B.src=V}))})(Re||(Re={})),Re.resetRequestQueue();class ze{constructor(n){this._transformRequestFn=n??null}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function Je(v){const n=[];if(typeof v=="string")n.push({id:"default",url:v});else if(v&&v.length>0){const u=[];for(const{id:f,url:g}of v){const b=`${f}${g}`;u.indexOf(b)===-1&&(u.push(b),n.push({id:f,url:g}))}}return n}function Xe(v,n,u){try{const f=new URL(v);return f.pathname+=`${n}${u}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${v}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function yt(v){const{userImage:n}=v;return!!(n&&n.render&&n.render())&&(v.data.replace(new Uint8Array(n.data.buffer)),!0)}class mt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:u,promiseResolve:f}of this.requestors)f(this._getImagesForIds(u));this.requestors=[]}}getImage(n){const u=this.images[n];if(u&&!u.data&&u.spriteData){const f=u.spriteData;u.data=new a.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(n,u){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,u)&&(this.images[n]=u)}_validate(n,u){let f=!0;const g=u.data||u.spriteData;return this._validateStretch(u.stretchX,g&&g.width)||(this.fire(new a.k(new Error(`Image "${n}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,g&&g.height)||(this.fire(new a.k(new Error(`Image "${n}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new a.k(new Error(`Image "${n}" has invalid "content" value`))),f=!1),f}_validateStretch(n,u){if(!n)return!0;let f=0;for(const g of n){if(g[0]<f||g[1]<g[0]||u<g[1])return!1;f=g[1]}return!0}_validateContent(n,u){if(!n)return!0;if(n.length!==4)return!1;const f=u.spriteData,g=f&&f.width||u.data.width,b=f&&f.height||u.data.height;return!(n[0]<0||g<n[0]||n[1]<0||b<n[1]||n[2]<0||g<n[2]||n[3]<0||b<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,u,f=!0){const g=this.getImage(n);if(f&&(g.data.width!==u.data.width||g.data.height!==u.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=g.version+1,this.images[n]=u,this.updatedImages[n]=!0}removeImage(n){const u=this.images[n];delete this.images[n],delete this.patterns[n],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise(((u,f)=>{let g=!0;if(!this.isLoaded())for(const b of n)this.images[b]||(g=!1);this.isLoaded()||g?u(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:u})}))}_getImagesForIds(n){const u={};for(const f of n){let g=this.getImage(f);g||(this.fire(new a.l("styleimagemissing",{id:f})),g=this.getImage(f)),g?u[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:a.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:n,height:u}=this.atlasImage;return{width:n,height:u}}getPattern(n){const u=this.patterns[n],f=this.getImage(n);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},b=new a.I(g,f);this.patterns[n]={bin:g,position:b}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const u=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.T(n,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const b in this.patterns)n.push(this.patterns[b].bin);const{w:u,h:f}=a.p(n),g=this.atlasImage;g.resize({width:u||1,height:f||1});for(const b in this.patterns){const{bin:S}=this.patterns[b],$=S.x+1,M=S.y+1,z=this.getImage(b).data,F=z.width,j=z.height;a.R.copy(z,g,{x:0,y:0},{x:$,y:M},{width:F,height:j}),a.R.copy(z,g,{x:0,y:j-1},{x:$,y:M-1},{width:F,height:1}),a.R.copy(z,g,{x:0,y:0},{x:$,y:M+j},{width:F,height:1}),a.R.copy(z,g,{x:F-1,y:0},{x:$-1,y:M},{width:1,height:j}),a.R.copy(z,g,{x:0,y:0},{x:$+F,y:M},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const u of n){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.getImage(u);f||a.w(`Image with ID: "${u}" was not found`),yt(f)&&this.updateImage(u,f)}}}const je=1e20;function ke(v,n,u,f,g,b,S,$,M){for(let z=n;z<n+f;z++)We(v,u*b+z,b,g,S,$,M);for(let z=u;z<u+g;z++)We(v,z*b+n,1,f,S,$,M)}function We(v,n,u,f,g,b,S){b[0]=0,S[0]=-je,S[1]=je,g[0]=v[n];for(let $=1,M=0,z=0;$<f;$++){g[$]=v[n+$*u];const F=$*$;do{const j=b[M];z=(g[$]-g[j]+F-j*j)/($-j)/2}while(z<=S[M]&&--M>-1);M++,b[M]=$,S[M]=z,S[M+1]=je}for(let $=0,M=0;$<f;$++){for(;S[M+1]<$;)M++;const z=b[M],F=$-z;v[n+$*u]=g[z]+F*F}}class Ce{constructor(n,u,f){this.requestManager=n,this.localIdeographFontFamily=u,this.entries={},this.lang=f}setURL(n){this.url=n}getGlyphs(n){return a._(this,void 0,void 0,(function*(){const u=[];for(const b in n)for(const S of n[b])u.push(this._getAndCacheGlyphsPromise(b,S));const f=yield Promise.all(u),g={};for(const{stack:b,id:S,glyph:$}of f)g[b]||(g[b]={}),g[b][S]=$&&{id:$.id,bitmap:$.bitmap.clone(),metrics:$.metrics};return g}))}_getAndCacheGlyphsPromise(n,u){return a._(this,void 0,void 0,(function*(){let f=this.entries[n];f||(f=this.entries[n]={glyphs:{},requests:{},ranges:{}});let g=f.glyphs[u];if(g!==void 0)return{stack:n,id:u,glyph:g};if(g=this._tinySDF(f,n,u),g)return f.glyphs[u]=g,{stack:n,id:u,glyph:g};const b=Math.floor(u/256);if(256*b>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[b])return{stack:n,id:u,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[b]){const $=Ce.loadGlyphRange(n,b,this.url,this.requestManager);f.requests[b]=$}const S=yield f.requests[b];for(const $ in S)this._doesCharSupportLocalGlyph(+$)||(f.glyphs[+$]=S[+$]);return f.ranges[b]=!0,{stack:n,id:u,glyph:S[u]||null}}))}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))||a.u["CJK Unified Ideographs"](n)||a.u["Hangul Syllables"](n)||a.u.Hiragana(n)||a.u.Katakana(n)||a.u["CJK Symbols and Punctuation"](n)||a.u["Halfwidth and Fullwidth Forms"](n))}_tinySDF(n,u,f){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let b=n.tinySDF;if(!b){let $="400";/bold/i.test(u)?$="900":/medium/i.test(u)?$="500":/light/i.test(u)&&($="200"),b=n.tinySDF=new Ce.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:g,fontWeight:$})}const S=b.draw(String.fromCharCode(f));return{id:f,bitmap:new a.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ce.loadGlyphRange=function(v,n,u,f){return a._(this,void 0,void 0,(function*(){const g=256*n,b=g+255,S=f.transformRequest(u.replace("{fontstack}",v).replace("{range}",`${g}-${b}`),"Glyphs"),$=yield a.n(S,new AbortController);if(!$||!$.data)throw new Error(`Could not load glyph range. range: ${n}, ${g}-${b}`);const M={};for(const z of a.o($.data))M[z.id]=z;return M}))},Ce.TinySDF=class{constructor({fontSize:v=24,buffer:n=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:b="normal",fontStyle:S="normal",lang:$=null}={}){this.buffer=n,this.cutoff=f,this.radius=u,this.lang=$;const M=this.size=v+4*n,z=this._createCanvas(M),F=this.ctx=z.getContext("2d",{willReadFrequently:!0});F.font=`${S} ${b} ${v}px ${g}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(v){const n=document.createElement("canvas");return n.width=n.height=v,n}draw(v){const{width:n,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:b}=this.ctx.measureText(v),S=Math.ceil(u),$=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-g))),M=Math.min(this.size-this.buffer,S+Math.ceil(f)),z=$+2*this.buffer,F=M+2*this.buffer,j=Math.max(z*F,0),B=new Uint8ClampedArray(j),V={data:B,width:z,height:F,glyphWidth:$,glyphHeight:M,glyphTop:S,glyphLeft:0,glyphAdvance:n};if($===0||M===0)return V;const{ctx:W,buffer:te,gridInner:ee,gridOuter:ie}=this;this.lang&&(W.lang=this.lang),W.clearRect(te,te,$,M),W.fillText(v,te,te+S);const se=W.getImageData(te,te,$,M);ie.fill(je,0,j),ee.fill(0,0,j);for(let ce=0;ce<M;ce++)for(let oe=0;oe<$;oe++){const he=se.data[4*(ce*$+oe)+3]/255;if(he===0)continue;const me=(ce+te)*z+oe+te;if(he===1)ie[me]=0,ee[me]=je;else{const ae=.5-he;ie[me]=ae>0?ae*ae:0,ee[me]=ae<0?ae*ae:0}}ke(ie,0,0,z,F,z,this.f,this.v,this.z),ke(ee,te,te,$,M,z,this.f,this.v,this.z);for(let ce=0;ce<j;ce++){const oe=Math.sqrt(ie[ce])-Math.sqrt(ee[ce]);B[ce]=Math.round(255-255*(oe/this.radius+this.cutoff))}return V}};class Ee{constructor(){this.specification=a.v.light.position}possiblyEvaluate(n,u){return a.B(n.expression.evaluate(u))}interpolate(n,u,f){return{x:a.C.number(n.x,u.x,f),y:a.C.number(n.y,u.y,f),z:a.C.number(n.z,u.z,f)}}}let st;class _t extends a.E{constructor(n){super(),st=st||new a.r({anchor:new a.D(a.v.light.anchor),position:new Ee,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.t(st),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u={}){if(!this._validate(a.x,n,u))for(const f in n){const g=n[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,f){return(!f||f.validate!==!1)&&a.y(this,n.call(a.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}const ht=new a.r({"sky-color":new a.D(a.v.sky["sky-color"]),"horizon-color":new a.D(a.v.sky["horizon-color"]),"fog-color":new a.D(a.v.sky["fog-color"]),"fog-ground-blend":new a.D(a.v.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.v.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.v.sky["atmosphere-blend"])});class nt extends a.E{constructor(n){super(),this._transitionable=new a.t(ht),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0))}setSky(n,u={}){if(!this._validate(a.G,n,u)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in n){const g=n[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,f={}){return f?.validate!==!1&&a.y(this,n.call(a.z,a.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class rt{constructor(n,u){this.width=n,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,u){const f=n.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(n,u)),this.dashEntry[f]}getDashRanges(n,u,f){const g=[];let b=n.length%2==1?-n[n.length-1]*f:0,S=n[0]*f,$=!0;g.push({left:b,right:S,isDash:$,zeroLength:n[0]===0});let M=n[0];for(let z=1;z<n.length;z++){$=!$;const F=n[z];b=M*f,M+=F,S=M*f,g.push({left:b,right:S,isDash:$,zeroLength:F===0})}return g}addRoundDash(n,u,f){const g=u/2;for(let b=-f;b<=f;b++){const S=this.width*(this.nextRow+f+b);let $=0,M=n[$];for(let z=0;z<this.width;z++){z/M.right>1&&(M=n[++$]);const F=Math.abs(z-M.left),j=Math.abs(z-M.right),B=Math.min(F,j);let V;const W=b/f*(g+1);if(M.isDash){const te=g-Math.abs(W);V=Math.sqrt(B*B+te*te)}else V=g-Math.sqrt(B*B+W*W);this.data[S+z]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(n){for(let $=n.length-1;$>=0;--$){const M=n[$],z=n[$+1];M.zeroLength?n.splice($,1):z&&z.isDash===M.isDash&&(z.left=M.left,n.splice($,1))}const u=n[0],f=n[n.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const g=this.width*this.nextRow;let b=0,S=n[b];for(let $=0;$<this.width;$++){$/S.right>1&&(S=n[++b]);const M=Math.abs($-S.left),z=Math.abs($-S.right),F=Math.min(M,z);this.data[g+$]=Math.max(0,Math.min(255,(S.isDash?F:-F)+128))}}addDash(n,u){const f=u?7:0,g=2*f+1;if(this.nextRow+g>this.height)return a.w("LineAtlas out of space"),null;let b=0;for(let $=0;$<n.length;$++)b+=n[$];if(b!==0){const $=this.width/b,M=this.getDashRanges(n,this.width,$);u?this.addRoundDash(M,$,f):this.addRegularDash(M)}const S={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:b};return this.nextRow+=g,this.dirty=!0,S}bind(n){const u=n.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const Wt="maplibre_preloaded_worker_pool";class ei{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<ei.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach((u=>{u.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Wt]}numActive(){return Object.keys(this.active).length}}const en=Math.floor(L.hardwareConcurrency/2);let hn,tn;function Qn(){return hn||(hn=new ei),hn}ei.workerCount=a.H(globalThis)?Math.max(Math.min(en,3),1):1;class rn{constructor(n,u){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u;const f=this.workerPool.acquire(u);for(let g=0;g<f.length;g++){const b=new a.J(f[g],u);b.name=`Worker ${g}`,this.actors.push(b)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,u){const f=[];for(const g of this.actors)f.push(g.sendAsync({type:n,data:u}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach((u=>{u.remove()})),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,u){for(const f of this.actors)f.registerMessageHandler(n,u)}}function _o(){return tn||(tn=new rn(Qn(),a.K),tn.registerMessageHandler("GR",((v,n,u)=>a.m(n,u)))),tn}function dn(v,n){const u=a.L();return a.M(u,u,[1,1,0]),a.N(u,u,[.5*v.width,.5*v.height,1]),v.calculatePosMatrix?a.O(u,u,v.calculatePosMatrix(n.toUnwrapped())):u}function Os(v,n,u,f,g,b,S){var $;const M=(function(B,V,W){if(B)for(const te of B){const ee=V[te];if(ee&&ee.source===W&&ee.type==="fill-extrusion")return!0}else for(const te in V){const ee=V[te];if(ee.source===W&&ee.type==="fill-extrusion")return!0}return!1})(($=g?.layers)!==null&&$!==void 0?$:null,n,v.id),z=b.maxPitchScaleFactor(),F=v.tilesIn(f,z,M);F.sort(wc);const j=[];for(const B of F)j.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(n,u,v._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,g,b,z,dn(v.transform,B.tileID),S?(V,W)=>S(B.tileID,V,W):void 0)});return(function(B,V){for(const W in B)for(const te of B[W])Sc(te,V);return B})((function(B){const V={},W={};for(const te of B){const ee=te.queryResults,ie=te.wrappedTileID,se=W[ie]=W[ie]||{};for(const ce in ee){const oe=ee[ce],he=se[ce]=se[ce]||{},me=V[ce]=V[ce]||[];for(const ae of oe)he[ae.featureIndex]||(he[ae.featureIndex]=!0,me.push(ae))}}return V})(j),v)}function wc(v,n){const u=v.tileID,f=n.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}function Sc(v,n){const u=v.feature,f=n.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=f}function es(v,n,u){return a._(this,void 0,void 0,(function*(){let f=v;if(v.url?f=(yield a.j(n.transformRequest(v.url,"Source"),u)).data:yield L.frameAsync(u),!f)return null;const g=a.Q(a.e(f,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(g.vectorLayerIds=f.vector_layers.map((b=>b.id))),g}))}class Qi{constructor(n,u){n&&(u?this.setSouthWest(n).setNorthEast(u):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof a.S?new a.S(n.lng,n.lat):a.S.convert(n),this}setSouthWest(n){return this._sw=n instanceof a.S?new a.S(n.lng,n.lat):a.S.convert(n),this}extend(n){const u=this._sw,f=this._ne;let g,b;if(n instanceof a.S)g=n,b=n;else{if(!(n instanceof Qi))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Qi.convert(n)):this.extend(a.S.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(a.S.convert(n)):this;if(g=n._sw,b=n._ne,!g||!b)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(b.lng,f.lng),f.lat=Math.max(b.lat,f.lat)):(this._sw=new a.S(g.lng,g.lat),this._ne=new a.S(b.lng,b.lat)),this}getCenter(){return new a.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.S(this.getWest(),this.getNorth())}getSouthEast(){return new a.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:u,lat:f}=a.S.convert(n);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(n){return n instanceof Qi?n:n&&new Qi(n)}static fromLngLat(n,u=0){const f=360*u/40075017,g=f/Math.cos(Math.PI/180*n.lat);return new Qi(new a.S(n.lng-g,n.lat-f),new a.S(n.lng+g,n.lat+f))}adjustAntiMeridian(){const n=new a.S(this._sw.lng,this._sw.lat),u=new a.S(this._ne.lng,this._ne.lat);return new Qi(n,n.lng>u.lng?new a.S(u.lng+360,u.lat):u)}}class lr{constructor(n,u,f){this.bounds=Qi.convert(this.validateBounds(n)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const u=Math.pow(2,n.z),f=Math.floor(a.V(this.bounds.getWest())*u),g=Math.floor(a.U(this.bounds.getNorth())*u),b=Math.ceil(a.V(this.bounds.getEast())*u),S=Math.ceil(a.U(this.bounds.getSouth())*u);return n.x>=f&&n.x<b&&n.y>=g&&n.y<S}}class Rs extends a.E{constructor(n,u,f,g){if(super(),this.id=n,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.Q(u,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield es(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(a.e(this,n),n.bounds&&(this.tileBounds=new lr(n.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new a.k(n))}}))}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty((()=>{this._options.tiles=n})),this}setUrl(n){return this.setSourceProperty((()=>{this.url=n,this._options.url=n})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(n){return a._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(u,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};f.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise(((b,S)=>{n.reloadPromise={resolve:b,reject:S}}))}else n.actor=this.dispatcher.getActor(),g="LT";n.abortController=new AbortController;try{const b=yield n.actor.sendAsync({type:g,data:f},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,b)}catch(b){if(delete n.abortController,n.aborted)return;if(b&&b.status!==404)throw b;this._afterTileLoadWorkerResponse(n,null)}}))}_afterTileLoadWorkerResponse(n,u){if(u&&u.resourceTiming&&(n.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&n.setExpiryData(u),n.loadVectorData(u,this.map.painter),n.reloadPromise){const f=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(f.resolve).catch(f.reject)}}abortTile(n){return a._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))}))}unloadTile(n){return a._(this,void 0,void 0,(function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class vo extends a.E{constructor(n,u,f,g){super(),this.id=n,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},u),a.e(this,a.Q(u,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,(function*(n=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield es(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(a.e(this,u),u.bounds&&(this.tileBounds=new lr(u.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(u){this._tileJSONRequest=null,this.fire(new a.k(u))}}))}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load(!0)}setTiles(n){return this.setSourceProperty((()=>{this._options.tiles=n})),this}setUrl(n){return this.setSourceProperty((()=>{this.url=n,this._options.url=n})),this}serialize(){return a.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return a._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const f=yield Re.getImage(this.map._requestManager.transformRequest(u,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&n.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const g=this.map.painter.context,b=g.gl,S=f.data;n.texture=this.map.painter.getTileTexture(S.width),n.texture?n.texture.update(S,{useMipmap:!0}):(n.texture=new a.T(g,S,b.RGBA,{useMipmap:!0}),n.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(f){if(delete n.abortController,n.aborted)n.state="unloaded";else if(f)throw n.state="errored",f}}))}abortTile(n){return a._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)}))}unloadTile(n){return a._(this,void 0,void 0,(function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)}))}hasTransition(){return!1}}class Sl extends vo{constructor(n,u,f,g){super(n,u,f,g),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(n){return a._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(u,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const g=yield Re.getImage(f,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(g&&g.data){const b=g.data;this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&n.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const S=a.b(b)&&a.W()?b:yield this.readImageNow(b),$={type:this.type,uid:n.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const M=yield n.actor.sendAsync({type:"LDT",data:$});n.dem=M,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(g){if(delete n.abortController,n.aborted)n.state="unloaded";else if(g)throw n.state="errored",g}}))}readImageNow(n){return a._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&a.X()){const u=n.width+2,f=n.height+2;try{return new a.R({width:u,height:f},yield a.Y(n,-1,-1,u,f))}catch{}}return L.getImageData(n,1)}))}_getNeighboringTiles(n){const u=n.canonical,f=Math.pow(2,u.z),g=(u.x-1+f)%f,b=u.x===0?n.wrap-1:n.wrap,S=(u.x+1+f)%f,$=u.x+1===f?n.wrap+1:n.wrap,M={};return M[new a.Z(n.overscaledZ,b,u.z,g,u.y).key]={backfilled:!1},M[new a.Z(n.overscaledZ,$,u.z,S,u.y).key]={backfilled:!1},u.y>0&&(M[new a.Z(n.overscaledZ,b,u.z,g,u.y-1).key]={backfilled:!1},M[new a.Z(n.overscaledZ,n.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},M[new a.Z(n.overscaledZ,$,u.z,S,u.y-1).key]={backfilled:!1}),u.y+1<f&&(M[new a.Z(n.overscaledZ,b,u.z,g,u.y+1).key]={backfilled:!1},M[new a.Z(n.overscaledZ,n.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},M[new a.Z(n.overscaledZ,$,u.z,S,u.y+1).key]={backfilled:!1}),M}unloadTile(n){return a._(this,void 0,void 0,(function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))}))}}class bo extends a.E{constructor(n,u,f,g){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=f.getActor(),this.setEventedParent(g),this._data=u.data,this._options=a.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:a.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(n){return n*(a.$/this.tileSize)}_getClusterMaxZoom(n){const u=n?Math.round(n):this.maxzoom-1;return Number.isInteger(n)||n===void 0||a.w(`Integer expected for option 'clusterMaxZoom': provided value "${n}" rounded to "${u}"`),u}load(){return a._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._pendingWorkerUpdate={data:n},this._updateWorkerData(),this}updateData(n){return this._pendingWorkerUpdate.diff=a.a0(this._pendingWorkerUpdate.diff,n),this._updateWorkerData(),this}getData(){return a._(this,void 0,void 0,(function*(){const n=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})}))}getCoordinatesFromGeometry(n){return n.type==="GeometryCollection"?n.geometries.map((u=>u.coordinates)).flat(1/0):n.coordinates.flat(1/0)}getBounds(){return a._(this,void 0,void 0,(function*(){const n=new Qi,u=yield this.getData();let f;switch(u.type){case"FeatureCollection":f=u.features.map((g=>this.getCoordinatesFromGeometry(g.geometry))).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(u.geometry);break;default:f=this.getCoordinatesFromGeometry(u)}if(f.length==0)return n;for(let g=0;g<f.length-1;g+=2)n.extend([f[g],f[g+1]]);return n}))}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(n.clusterRadius)),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(n.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,u,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:u,offset:f}})}_updateWorkerData(){return a._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:n,diff:u}=this._pendingWorkerUpdate;if(!n&&!u)return void a.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const f=a.e({type:this.type},this.workerOptions);n?(typeof n=="string"?(f.request=this.map._requestManager.transformRequest(L.resolveURL(n),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(n),this._pendingWorkerUpdate.data=void 0):u&&(f.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new a.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||g.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));this._data=g.data;let b=null;g.resourceTiming&&g.resourceTiming[this.id]&&(b=g.resourceTiming[this.id].slice(0));const S={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&a.e(S,{resourceTiming:b}),this.fire(new a.l("data",Object.assign(Object.assign({},S),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},S),{sourceDataType:"content"})))}catch(g){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(g))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(n){return a._(this,void 0,void 0,(function*(){const u=n.actor?"RT":"LT";n.actor=this.actor;const f={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};n.abortController=new AbortController;const g=yield this.actor.sendAsync({type:u,data:f},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(g,this.map.painter,u==="RT")}))}abortTile(n){return a._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0}))}unloadTile(n){return a._(this,void 0,void 0,(function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class xo extends a.E{constructor(n,u,f,g){super(),this.flippedWindingOrder=!1,this.id=n,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=u}load(n){return a._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield Re.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,n&&(this.coordinates=n),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new a.k(u))}}))}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const u=n.map(a.a1.fromLngLat);var f;return this.tileID=(function(g){const b=a.a2.fromPoints(g),S=b.width(),$=b.height(),M=Math.max(S,$),z=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),F=Math.pow(2,z);return new a.a4(z,Math.floor((b.minX+b.maxX)/2*F),Math.floor((b.minY+b.maxY)/2*F))})(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map((g=>this.tileID.getTilePoint(g)._round())),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,u=n.gl;this.texture||(this.texture=new a.T(n,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const b=this.tiles[g];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,f=!0)}f&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return a._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(n){const{minX:u,minY:f,maxX:g,maxY:b}=a.a2.fromPoints(n),S={};for(let $=0;$<=a.a3;$++){const M=Math.pow(2,$),z=Math.floor(u*M),F=Math.floor(f*M),j=Math.floor(g*M),B=Math.floor(b*M);S[$]={minTileX:z,minTileY:F,maxTileX:j,maxTileY:B}}return S}}class Tc extends xo{constructor(n,u,f,g){super(n,u,f,g),this.roundZoom=!0,this.type="video",this.options=u}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const u of n.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield a.a5(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new a.k(u))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const u=this.video.seekable;n<u.start(0)||n>u.end(0)?this.fire(new a.k(new a.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,u=n.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(n,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const b=this.tiles[g];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,f=!0)}f&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ka extends xo{constructor(n,u,f,g){super(n,u,f,g),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some((b=>!Array.isArray(b)||b.length!==2||b.some((S=>typeof S!="number"))))||this.fire(new a.k(new a.a6(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.a6(`sources.${n}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.k(new a.a6(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.a6(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.a6(`sources.${n}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,f=u.gl;this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(u,this.canvas,f.RGBA,{premultiply:!0});let g=!1;for(const b in this.tiles){const S=this.tiles[b];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,g=!0)}g&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Aa={},Da=v=>{switch(v){case"geojson":return bo;case"image":return xo;case"raster":return vo;case"raster-dem":return Sl;case"vector":return Rs;case"video":return Tc;case"canvas":return ka}return Aa[v]},Tl="RTLPluginLoaded";class za extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=_o()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch((u=>{throw this.status="error",u}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return a._(this,arguments,void 0,(function*(u,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=L.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return a._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(Tl))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Oa=null;function Ra(){return Oa||(Oa=new za),Oa}class Cc{constructor(n,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=a.a7(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const u=n+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=(function(g,b){const S={};if(!b)return S;for(const $ of g){const M=$.layerIds.map((z=>b.getLayer(z))).filter(Boolean);if(M.length!==0){$.layers=M,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map((z=>M.filter((F=>F.id===z))[0])));for(const z of M)S[z.id]=$}}return S})(n.buckets,u?.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const b=this.buckets[g];if(b instanceof a.a9){if(this.hasSymbolBuckets=!0,!f)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const b=this.buckets[g];if(b instanceof a.a9&&b.hasRTLText){this.hasRTLText=!0,Ra().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const b=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(b))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new a.a8}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(n)}const u=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new a.T(n,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(n,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,u,f,g,b,S,$,M,z,F,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:b,scale:S,tileSize:this.tileSize,pixelPosMatrix:F,transform:M,params:$,queryPadding:this.queryPadding*z,getElevation:j},n,u,f):{}}querySourceFeatures(n,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),b=u&&u.sourceLayer?u.sourceLayer:"",S=g._geojsonTileLayer||g[b];if(!S)return;const $=a.aa(u&&u.filter),{z:M,x:z,y:F}=this.tileID.canonical,j={z:M,x:z,y:F};for(let B=0;B<S.length;B++){const V=S.feature(B);if($.needGeometry){const ee=a.ab(V,!0);if(!$.filter(new a.F(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!$.filter(new a.F(this.tileID.overscaledZ),V))continue;const W=f.getId(V,b),te=new a.ac(V,M,z,F,W);te.tile=j,n.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const f=a.ad(n.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const b=this.expirationTime-u;b?this.expirationTime=f+Math.max(b,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!u.style.hasLayer(g))continue;const b=this.buckets[g],S=b.layers[0].sourceLayer||"_geojsonTileLayer",$=f[S],M=n[S];if(!$||!M||Object.keys(M).length===0)continue;b.update(M,$,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=u&&u.style&&u.style.getLayer(g);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<L.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=L.now()+n}setDependencies(n,u){const f={};for(const g of u)f[g]=!0;this.dependencies[n]=f}hasDependency(n,u){for(const f of n){const g=this.dependencies[f];if(g){for(const b of u)if(g[b])return!0}}return!1}}class ve{constructor(n,u){this.max=n,this.onRemove=u,this.reset()}reset(){for(const n in this.data)for(const u of this.data[n])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(n,u,f){const g=n.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const b={value:u,timeout:void 0};if(f!==void 0&&(b.timeout=setTimeout((()=>{this.remove(n,b)}),f)),this.data[g].push(b),this.order.push(g),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const u=this.data[n].shift();return u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),u.value}getByKey(n){const u=this.data[n];return u?u[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,u){if(!this.has(n))return this;const f=n.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),b=this.data[f][g];return this.data[f].splice(g,1),b.timeout&&clearTimeout(b.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(b.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(n){const u=[];for(const f in this.data)for(const g of this.data[f])n(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class Y{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,u,f){const g=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][g]=this.stateChanges[n][g]||{},a.e(this.stateChanges[n][g],f),this.deletedStates[n]===null){this.deletedStates[n]={};for(const b in this.state[n])b!==g&&(this.deletedStates[n][b]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][g]===null){this.deletedStates[n][g]={};for(const b in this.state[n][g])f[b]||(this.deletedStates[n][g][b]=null)}else for(const b in f)this.deletedStates[n]&&this.deletedStates[n][g]&&this.deletedStates[n][g][b]===null&&delete this.deletedStates[n][g][b]}removeFeatureState(n,u,f){if(this.deletedStates[n]===null)return;const g=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},f&&u!==void 0)this.deletedStates[n][g]!==null&&(this.deletedStates[n][g]=this.deletedStates[n][g]||{},this.deletedStates[n][g][f]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][g])for(f in this.deletedStates[n][g]={},this.stateChanges[n][g])this.deletedStates[n][g][f]=null;else this.deletedStates[n][g]=null;else this.deletedStates[n]=null}getState(n,u){const f=String(u),g=a.e({},(this.state[n]||{})[f],(this.stateChanges[n]||{})[f]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const b=this.deletedStates[n][u];if(b===null)return{};for(const S in b)delete g[S]}return g}initializeTileState(n,u){n.setFeatureState(this.state,u)}coalesceChanges(n,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const b={};for(const S in this.stateChanges[g])this.state[g][S]||(this.state[g][S]={}),a.e(this.state[g][S],this.stateChanges[g][S]),b[S]=this.state[g][S];f[g]=b}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const b={};if(this.deletedStates[g]===null)for(const S in this.state[g])b[S]={},this.state[g][S]={};else for(const S in this.deletedStates[g]){if(this.deletedStates[g][S]===null)this.state[g][S]={};else for(const $ of Object.keys(this.deletedStates[g][S]))delete this.state[g][S][$];b[S]=this.state[g][S]}f[g]=f[g]||{},a.e(f[g],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in n)n[g].setFeatureState(f,u)}}const J=89.25;function K(v,n){const u=a.ah(n.lat,-a.ai,a.ai);return new a.P(a.V(n.lng)*v,a.U(u)*v)}function le(v,n){return new a.a1(n.x/v,n.y/v).toLngLat()}function fe(v){return v.cameraToCenterDistance*Math.min(.85*Math.tan(a.ae(90-v.pitch)),Math.tan(a.ae(J-v.pitch)))}function be(v,n){const u=v.canonical,f=n/a.af(u.z),g=u.x+Math.pow(2,u.z)*v.wrap,b=a.ag(new Float64Array(16));return a.M(b,b,[g*f,u.y*f,0]),a.N(b,b,[f/a.$,f/a.$,1]),b}function Ae(v,n,u,f,g){const b=a.a1.fromLngLat(v,n),S=g*a.aj(1,v.lat),$=S*Math.cos(a.ae(u)),M=Math.sqrt(S*S-$*$),z=M*Math.sin(a.ae(-f)),F=M*Math.cos(a.ae(-f));return new a.a1(b.x+z,b.y+F,b.z+$)}function we(v,n,u){const f=n.intersectsFrustum(v);if(!u||f===0)return f;const g=n.intersectsPlane(u);return g===0?0:f===2&&g===2?2:1}function Be(v,n,u){let f=0;const g=(u-n)/10;for(let b=0;b<10;b++)f+=g*Math.pow(Math.cos(n+(b+.5)/10*(u-n)),v);return f}function Ye(v,n){return function(u,f,g,b,S){const $=2*((v-1)/a.ak(Math.cos(a.ae(J-S))/Math.cos(a.ae(J)))-1),M=Math.acos(g/b),z=2*Be($-1,0,a.ae(S/2)),F=Math.min(a.ae(J),M+a.ae(S/2)),j=Be($-1,Math.min(F,M-a.ae(S/2)),F),B=Math.atan(f/g),V=Math.hypot(f,g);let W=u;return W+=a.ak(b/V/Math.max(.5,Math.cos(a.ae(S/2)))),W+=$*a.ak(Math.cos(B))/2,W-=a.ak(Math.max(1,j/z/n))/2,W}}const qe=Ye(9.314,3);function St(v,n){const u=(n.roundZoom?Math.round:Math.floor)(v.zoom+a.ak(v.tileSize/n.tileSize));return Math.max(0,u)}function Te(v,n){const u=v.getCameraFrustum(),f=v.getClippingPlane(),g=v.screenPointToMercatorCoordinate(v.getCameraPoint()),b=a.a1.fromLngLat(v.center,v.elevation);g.z=b.z+Math.cos(v.pitchInRadians)*v.cameraToCenterDistance/v.worldSize;const S=v.getCoveringTilesDetailsProvider(),$=S.allowVariableZoom(v,n),M=St(v,n),z=n.minzoom||0,F=n.maxzoom!==void 0?n.maxzoom:v.maxZoom,j=Math.min(Math.max(0,M),F),B=Math.pow(2,j),V=[B*g.x,B*g.y,0],W=[B*b.x,B*b.y,0],te=Math.hypot(b.x-g.x,b.y-g.y),ee=Math.abs(b.z-g.z),ie=Math.hypot(te,ee),se=he=>({zoom:0,x:0,y:0,wrap:he,fullyVisible:!1}),ce=[],oe=[];if(v.renderWorldCopies&&S.allowWorldCopies())for(let he=1;he<=3;he++)ce.push(se(-he)),ce.push(se(he));for(ce.push(se(0));ce.length>0;){const he=ce.pop(),me=he.x,ae=he.y;let xe=he.fullyVisible;const Oe={x:me,y:ae,z:he.zoom},Ie=S.getTileBoundingVolume(Oe,he.wrap,v.elevation,n);if(!xe){const it=we(u,Ie,f);if(it===0)continue;xe=it===2}const $e=S.distanceToTile2d(g.x,g.y,Oe,Ie);let De=M;$&&(De=(n.calculateTileZoom||qe)(v.zoom+a.ak(v.tileSize/n.tileSize),$e,ee,ie,v.fov)),De=(n.roundZoom?Math.round:Math.floor)(De),De=Math.max(0,De);const Ke=Math.min(De,F);if(he.wrap=S.getWrap(b,Oe,he.wrap),he.zoom>=Ke){if(he.zoom<z)continue;const it=j-he.zoom,He=V[0]-.5-(me<<it),xt=V[1]-.5-(ae<<it),Gt=n.reparseOverscaled?Math.max(he.zoom,De):he.zoom;oe.push({tileID:new a.Z(he.zoom===F?Gt:he.zoom,he.wrap,he.zoom,me,ae),distanceSq:a.al([W[0]-.5-me,W[1]-.5-ae]),tileDistanceToCamera:Math.sqrt(He*He+xt*xt)})}else for(let it=0;it<4;it++)ce.push({zoom:he.zoom+1,x:(me<<1)+it%2,y:(ae<<1)+(it>>1),wrap:he.wrap,fullyVisible:xe})}return oe.sort(((he,me)=>he.distanceSq-me.distanceSq)).map((he=>he.tileID))}const Dt=a.a2.fromPoints([new a.P(0,0),new a.P(a.$,a.$)]);class Xt extends a.E{constructor(n,u,f){super(),this.id=n,this.dispatcher=f,this.on("data",(g=>this._dataHandler(g))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((g,b,S,$)=>{const M=new(Da(b.type))(g,b,S,$);if(M.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${M.id}`);return M})(n,u,f,this),this._tiles={},this._cache=new ve(0,(g=>this._unloadTile(g))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Y,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const u=this._tiles[n];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,u,f){return a._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,u,f)}catch(g){n.state="errored",g.status!==404?this._source.fire(new a.k(g,{tile:n})):this.update(this.transform,this.terrain)}}))}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new a.l("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(n),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((n=>n.tileID)).sort(It).map((n=>n.key))}getRenderableIds(n){const u=[];for(const f in this._tiles)this._isIdRenderable(f,n)&&u.push(this._tiles[f]);return n?u.sort(((f,g)=>{const b=f.tileID,S=g.tileID,$=new a.P(b.canonical.x,b.canonical.y)._rotate(-this.transform.bearingInRadians),M=new a.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return b.overscaledZ-S.overscaledZ||M.y-$.y||M.x-$.x})).map((f=>f.tileID.key)):u.map((f=>f.tileID)).sort(It).map((f=>f.key))}hasRenderableParent(n){const u=this.findLoadedParent(n,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(n,u){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(u||!this._tiles[n].holdingForFade())}reload(n){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)n?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(n,u){return a._(this,void 0,void 0,(function*(){const f=this._tiles[n];f&&(f.state!=="loading"&&(f.state=u),yield this._loadTile(f,n,u))}))}_tileLoaded(n,u,f){n.timeAdded=L.now(),f==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const b=u[g];if(n.neighboringTiles&&n.neighboringTiles[b]){const S=this.getTileByID(b);f(n,S),f(S,n)}}function f(g,b){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let S=b.tileID.canonical.x-g.tileID.canonical.x;const $=b.tileID.canonical.y-g.tileID.canonical.y,M=Math.pow(2,g.tileID.canonical.z),z=b.tileID.key;S===0&&$===0||Math.abs($)>1||(Math.abs(S)>1&&(Math.abs(S+M)===1?S+=M:Math.abs(S-M)===1&&(S-=M)),b.dem&&g.dem&&(g.dem.backfillBorder(b.dem,S,$),g.neighboringTiles&&g.neighboringTiles[z]&&(g.neighboringTiles[z].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,u,f,g){for(const b in this._tiles){let S=this._tiles[b];if(g[b]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>f)continue;let $=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const z=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[z.key],S&&S.hasData()&&($=z)}let M=$;for(;M.overscaledZ>u;)if(M=M.scaledTo(M.overscaledZ-1),n[M.key]||n[M.canonical.key]){g[$.key]=$;break}}}findLoadedParent(n,u){if(n.key in this._loadedParentTiles){const f=this._loadedParentTiles[n.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=n.overscaledZ-1;f>=u;f--){const g=n.scaledTo(f),b=this._getLoadedTile(g);if(b)return b}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const u=this._tiles[n.key];return u&&u.hasData()?u:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const u=Math.ceil(n.width/this._source.tileSize)+1,f=Math.ceil(n.height/this._source.tileSize)+1,g=Math.floor(u*f*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(b)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,u){const f={};for(const g in this._tiles){const b=this._tiles[g];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+u),f[b.tileID.key]=b}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}_updateCoveredAndRetainedTiles(n,u,f,g,b,S){const $={},M={},z=Object.keys(n),F=L.now();for(const j of z){const B=n[j],V=this._tiles[j];if(!V||V.fadeEndTime!==0&&V.fadeEndTime<=F)continue;const W=this.findLoadedParent(B,u),te=this.findLoadedSibling(B),ee=W||te||null;ee&&(this._addTile(ee.tileID),$[ee.tileID.key]=ee.tileID),M[j]=B}this._retainLoadedChildren(M,g,f,n);for(const j in $)n[j]||(this._coveredTiles[j]=!0,n[j]=$[j]);if(S){const j={},B={};for(const V of b)this._tiles[V.key].hasData()?j[V.key]=V:B[V.key]=V;for(const V in B){const W=B[V].children(this._source.maxzoom);this._tiles[W[0].key]&&this._tiles[W[1].key]&&this._tiles[W[2].key]&&this._tiles[W[3].key]&&(j[W[0].key]=n[W[0].key]=W[0],j[W[1].key]=n[W[1].key]=W[1],j[W[2].key]=n[W[2].key]=W[2],j[W[3].key]=n[W[3].key]=W[3],delete B[V])}for(const V in B){const W=B[V],te=this.findLoadedParent(W,this._source.minzoom),ee=this.findLoadedSibling(W),ie=te||ee||null;if(ie){j[ie.tileID.key]=n[ie.tileID.key]=ie.tileID;for(const se in j)j[se].isChildOf(ie.tileID)&&delete j[se]}}for(const V in this._tiles)j[V]||(this._coveredTiles[V]=!0)}}update(n,u){if(!this._sourceLoaded||this._paused)return;let f;this.transform=n,this.terrain=u,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=n.getVisibleUnwrappedCoordinates(this._source.tileID).map((F=>new a.Z(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y))):(f=Te(n,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter((F=>this._source.hasTile(F))))):f=[];const g=St(n,this._source),b=Math.max(g-Xt.maxOverzooming,this._source.minzoom),S=Math.max(g+Xt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const j of f)if(j.canonical.z>this._source.minzoom){const B=j.scaledTo(j.canonical.z-1);F[B.key]=B;const V=j.scaledTo(Math.max(this._source.minzoom,Math.min(j.canonical.z,5)));F[V.key]=V}f=f.concat(Object.values(F))}const $=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,$&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(f,g);Nt(this._source.type)&&this._updateCoveredAndRetainedTiles(M,b,S,g,f,u);for(const F in M)this._tiles[F].clearFadeHold();const z=a.am(this._tiles,M);for(const F of z){const j=this._tiles[F];j.hasSymbolBuckets&&!j.holdingForFade()?j.setHoldDuration(this.map._fadeDuration):j.hasSymbolBuckets&&!j.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,u){var f;const g={},b={},S=Math.max(u-Xt.maxOverzooming,this._source.minzoom),$=Math.max(u+Xt.maxUnderzooming,this._source.minzoom),M={};for(const z of n){const F=this._addTile(z);g[z.key]=z,F.hasData()||u<this._source.maxzoom&&(M[z.key]=z)}this._retainLoadedChildren(M,u,$,g);for(const z of n){let F=this._tiles[z.key];if(F.hasData())continue;if(u+1>this._source.maxzoom){const B=z.children(this._source.maxzoom)[0],V=this.getTile(B);if(V&&V.hasData()){g[B.key]=B;continue}}else{const B=z.children(this._source.maxzoom);if(g[B[0].key]&&g[B[1].key]&&g[B[2].key]&&g[B[3].key])continue}let j=F.wasRequested();for(let B=z.overscaledZ-1;B>=S;--B){const V=z.scaledTo(B);if(b[V.key])break;if(b[V.key]=!0,F=this.getTile(V),!F&&j&&(F=this._addTile(V)),F){const W=F.hasData();if((W||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||j)&&(g[V.key]=V),j=F.wasRequested(),W)break}}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const u=[];let f,g=this._tiles[n].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const b=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(b),f)break;g=b}for(const b of u)this._loadedParentTiles[b]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const u=this._tiles[n].tileID,f=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=f}}_addTile(n){let u=this._tiles[n.key];if(u)return u;u=this._cache.getAndRemove(n),u&&(this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,u)));const f=u;return u||(u=new Cc(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(u,n.key,u.state)),u.uses++,this._tiles[n.key]=u,f||this._source.fire(new a.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const f=u.getExpiryTimeout();f&&(this._timers[n]=setTimeout((()=>{this._reloadTile(n,"expired"),delete this._timers[n]}),f))}refreshTiles(n){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&n.some((f=>f.equals(this._tiles[u].tileID.canonical)))&&this._reloadTile(u,"expired")}_removeTile(n){const u=this._tiles[n];u&&(u.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(n){const u=n.sourceDataType;n.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&u==="content"&&(this.reload(n.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,u,f){const g=[],b=this.transform;if(!b)return g;const S=b.getCoveringTilesDetailsProvider().allowWorldCopies(),$=f?b.getCameraQueryGeometry(n):n,M=V=>b.screenPointToMercatorCoordinate(V,this.terrain),z=this.transformBbox(n,M,!S),F=this.transformBbox($,M,!S),j=this.getIds(),B=a.a2.fromPoints(F);for(let V=0;V<j.length;V++){const W=this._tiles[j[V]];if(W.holdingForFade())continue;const te=S?[W.tileID]:[W.tileID.unwrapTo(-1),W.tileID.unwrapTo(0)],ee=Math.pow(2,b.zoom-W.tileID.overscaledZ),ie=u*W.queryPadding*a.$/W.tileSize/ee;for(const se of te){const ce=B.map((oe=>se.getTilePoint(new a.a1(oe.x,oe.y))));if(ce.expandBy(ie),ce.intersects(Dt)){const oe=z.map((me=>se.getTilePoint(me))),he=F.map((me=>se.getTilePoint(me)));g.push({tile:W,tileID:S?se:se.unwrapTo(0),queryGeometry:oe,cameraQueryGeometry:he,scale:ee})}}}return g}transformBbox(n,u,f){let g=n.map(u);if(f){const b=a.a2.fromPoints(n);b.shrinkBy(.001*Math.min(b.width(),b.height()));const S=b.map(u);a.a2.fromPoints(g).covers(S)||(g=g.map(($=>$.x>.5?new a.a1($.x-1,$.y,$.z):$)))}return g}getVisibleCoordinates(n){const u=this.getRenderableIds(n).map((f=>this._tiles[f].tileID));return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(Nt(this._source.type)){const n=L.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=n)return!0}return!1}setFeatureState(n,u,f){this._state.updateState(n=n||"_geojsonTileLayer",u,f)}removeFeatureState(n,u,f){this._state.removeFeatureState(n=n||"_geojsonTileLayer",u,f)}getFeatureState(n,u){return this._state.getState(n=n||"_geojsonTileLayer",u)}setDependencies(n,u,f){const g=this._tiles[n];g&&g.setDependencies(u,f)}reloadTilesForDependencies(n,u){for(const f in this._tiles)this._tiles[f].hasDependency(n,u)&&this._reloadTile(f,"reloading");this._cache.filter((f=>!f.hasDependency(n,u)))}}function It(v,n){const u=Math.abs(2*v.wrap)-+(v.wrap<0),f=Math.abs(2*n.wrap)-+(n.wrap<0);return v.overscaledZ-n.overscaledZ||f-u||n.canonical.y-v.canonical.y||n.canonical.x-v.canonical.x}function Nt(v){return v==="raster"||v==="image"||v==="video"}Xt.maxOverzooming=10,Xt.maxUnderzooming=3;class Di{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=a.ah(n,0,1);let u=1,f=this._distances[u];const g=n*this.paddedLength+this.padding;for(;f<g&&u<this._distances.length;)f=this._distances[++u];const b=u-1,S=this._distances[b],$=f-S,M=$>0?(g-S)/$:0;return this.points[b].mult(1-M).add(this.points[u].mult(M))}}function Ir(v,n){let u=!0;return v==="always"||v!=="never"&&n!=="never"||(u=!1),u}class $r{constructor(n,u,f){const g=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(n/f),this.yCellCount=Math.ceil(u/f);for(let S=0;S<this.xCellCount*this.yCellCount;S++)g.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,f,g,b){this._forEachCell(u,f,g,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(b)}insertCircle(n,u,f,g){this._forEachCell(u-g,f-g,u+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(f),this.circles.push(g)}_insertBoxCell(n,u,f,g,b,S){this.boxCells[b].push(S)}_insertCircleCell(n,u,f,g,b,S){this.circleCells[b].push(S)}_query(n,u,f,g,b,S,$){if(f<0||n>this.width||g<0||u>this.height)return[];const M=[];if(n<=0&&u<=0&&this.width<=f&&this.height<=g){if(b)return[{key:null,x1:n,y1:u,x2:f,y2:g}];for(let z=0;z<this.boxKeys.length;z++)M.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const F=this.circles[3*z],j=this.circles[3*z+1],B=this.circles[3*z+2];M.push({key:this.circleKeys[z],x1:F-B,y1:j-B,x2:F+B,y2:j+B})}}else this._forEachCell(n,u,f,g,this._queryCell,M,{hitTest:b,overlapMode:S,seenUids:{box:{},circle:{}}},$);return M}query(n,u,f,g){return this._query(n,u,f,g,!1,null)}hitTest(n,u,f,g,b,S){return this._query(n,u,f,g,!0,b,S).length>0}hitTestCircle(n,u,f,g,b){const S=n-f,$=n+f,M=u-f,z=u+f;if($<0||S>this.width||z<0||M>this.height)return!1;const F=[];return this._forEachCell(S,M,$,z,this._queryCellCircle,F,{hitTest:!0,overlapMode:g,circle:{x:n,y:u,radius:f},seenUids:{box:{},circle:{}}},b),F.length>0}_queryCell(n,u,f,g,b,S,$,M){const{seenUids:z,hitTest:F,overlapMode:j}=$,B=this.boxCells[b];if(B!==null){const W=this.bboxes;for(const te of B)if(!z.box[te]){z.box[te]=!0;const ee=4*te,ie=this.boxKeys[te];if(n<=W[ee+2]&&u<=W[ee+3]&&f>=W[ee+0]&&g>=W[ee+1]&&(!M||M(ie))&&(!F||!Ir(j,ie.overlapMode))&&(S.push({key:ie,x1:W[ee],y1:W[ee+1],x2:W[ee+2],y2:W[ee+3]}),F))return!0}}const V=this.circleCells[b];if(V!==null){const W=this.circles;for(const te of V)if(!z.circle[te]){z.circle[te]=!0;const ee=3*te,ie=this.circleKeys[te];if(this._circleAndRectCollide(W[ee],W[ee+1],W[ee+2],n,u,f,g)&&(!M||M(ie))&&(!F||!Ir(j,ie.overlapMode))){const se=W[ee],ce=W[ee+1],oe=W[ee+2];if(S.push({key:ie,x1:se-oe,y1:ce-oe,x2:se+oe,y2:ce+oe}),F)return!0}}}return!1}_queryCellCircle(n,u,f,g,b,S,$,M){const{circle:z,seenUids:F,overlapMode:j}=$,B=this.boxCells[b];if(B!==null){const W=this.bboxes;for(const te of B)if(!F.box[te]){F.box[te]=!0;const ee=4*te,ie=this.boxKeys[te];if(this._circleAndRectCollide(z.x,z.y,z.radius,W[ee+0],W[ee+1],W[ee+2],W[ee+3])&&(!M||M(ie))&&!Ir(j,ie.overlapMode))return S.push(!0),!0}}const V=this.circleCells[b];if(V!==null){const W=this.circles;for(const te of V)if(!F.circle[te]){F.circle[te]=!0;const ee=3*te,ie=this.circleKeys[te];if(this._circlesCollide(W[ee],W[ee+1],W[ee+2],z.x,z.y,z.radius)&&(!M||M(ie))&&!Ir(j,ie.overlapMode))return S.push(!0),!0}}}_forEachCell(n,u,f,g,b,S,$,M){const z=this._convertToXCellCoord(n),F=this._convertToYCellCoord(u),j=this._convertToXCellCoord(f),B=this._convertToYCellCoord(g);for(let V=z;V<=j;V++)for(let W=F;W<=B;W++)if(b.call(this,n,u,f,g,this.xCellCount*W+V,S,$,M))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,f,g,b,S){const $=g-n,M=b-u,z=f+S;return z*z>$*$+M*M}_circleAndRectCollide(n,u,f,g,b,S,$){const M=(S-g)/2,z=Math.abs(n-(g+M));if(z>M+f)return!1;const F=($-b)/2,j=Math.abs(u-(b+F));if(j>F+f)return!1;if(z<=M||j<=F)return!0;const B=z-M,V=j-F;return B*B+V*V<=f*f}}function cr(v,n,u){const f=a.L();if(!v){const{vecSouth:j,vecEast:B}=li(n),V=T();V[0]=B[0],V[1]=B[1],V[2]=j[0],V[3]=j[1],g=V,(F=(S=(b=V)[0])*(z=b[3])-(M=b[2])*($=b[1]))&&(g[0]=z*(F=1/F),g[1]=-$*F,g[2]=-M*F,g[3]=S*F),f[0]=V[0],f[1]=V[1],f[4]=V[2],f[5]=V[3]}var g,b,S,$,M,z,F;return a.N(f,f,[1/u,1/u,1]),f}function ti(v,n,u,f){if(v){const g=a.L();if(!n){const{vecSouth:b,vecEast:S}=li(u);g[0]=S[0],g[1]=S[1],g[4]=b[0],g[5]=b[1]}return a.N(g,g,[f,f,1]),g}return u.pixelsToClipSpaceMatrix}function li(v){const n=Math.cos(v.rollInRadians),u=Math.sin(v.rollInRadians),f=Math.cos(v.pitchInRadians),g=Math.cos(v.bearingInRadians),b=Math.sin(v.bearingInRadians),S=a.ar();S[0]=-g*f*u-b*n,S[1]=-b*f*u+g*n;const $=a.as(S);$<1e-9?a.at(S):a.au(S,S,1/$);const M=a.ar();M[0]=g*f*n-b*u,M[1]=b*f*n+g*u;const z=a.as(M);return z<1e-9?a.at(M):a.au(M,M,1/z),{vecEast:M,vecSouth:S}}function mr(v,n,u,f){let g;f?(g=[v,n,f(v,n),1],a.aw(g,g,u)):(g=[v,n,0,1],Ic(g,g,u));const b=g[3];return{point:new a.P(g[0]/b,g[1]/b),signedDistanceFromCamera:b,isOccluded:!1}}function Qe(v,n){return .5+v/n*.5}function pn(v,n){return v.x>=-n[0]&&v.x<=n[0]&&v.y>=-n[1]&&v.y<=n[1]}function Zi(v,n,u,f,g,b,S,$,M,z,F,j,B){const V=u?v.textSizeData:v.iconSizeData,W=a.an(V,n.transform.zoom),te=[256/n.width*2+1,256/n.height*2+1],ee=u?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;ee.clear();const ie=v.lineVertexArray,se=u?v.text.placedSymbolArray:v.icon.placedSymbolArray,ce=n.transform.width/n.transform.height;let oe=!1;for(let he=0;he<se.length;he++){const me=se.get(he);if(me.hidden||me.writingMode===a.ao.vertical&&!oe){wo(me.numGlyphs,ee);continue}oe=!1;const ae=new a.P(me.anchorX,me.anchorY),xe={getElevation:B,pitchedLabelPlaneMatrix:f,lineVertexArray:ie,pitchWithMap:b,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:ae,unwrappedTileID:M,width:z,height:F,translation:j},Oe=Fa(me.anchorX,me.anchorY,xe);if(!pn(Oe.point,te)){wo(me.numGlyphs,ee);continue}const Ie=Qe(n.transform.cameraToCenterDistance,Oe.signedDistanceFromCamera),$e=a.ap(V,W,me),De=b?$e*n.transform.getPitchedTextCorrection(me.anchorX,me.anchorY,M)/Ie:$e*Ie,Ke=pt({projectionContext:xe,pitchedLabelPlaneMatrixInverse:g,symbol:me,fontSize:De,flip:!1,keepUpright:S,glyphOffsetArray:v.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:ce,rotateToLine:$});oe=Ke.useVertical,(Ke.notEnoughRoom||oe||Ke.needsFlipping&&pt({projectionContext:xe,pitchedLabelPlaneMatrixInverse:g,symbol:me,fontSize:De,flip:!0,keepUpright:S,glyphOffsetArray:v.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:ce,rotateToLine:$}).notEnoughRoom)&&wo(me.numGlyphs,ee)}u?v.text.dynamicLayoutVertexBuffer.updateData(ee):v.icon.dynamicLayoutVertexBuffer.updateData(ee)}function La(v,n,u,f,g,b,S,$){const M=b.glyphStartIndex+b.numGlyphs,z=b.lineStartIndex,F=b.lineStartIndex+b.lineLength,j=n.getoffsetX(b.glyphStartIndex),B=n.getoffsetX(M-1),V=Na(v*j,u,f,g,b.segment,z,F,$,S);if(!V)return null;const W=Na(v*B,u,f,g,b.segment,z,F,$,S);return W?$.projectionCache.anyProjectionOccluded?null:{first:V,last:W}:null}function Ec(v,n,u,f){return v===a.ao.horizontal&&Math.abs(u.y-n.y)>Math.abs(u.x-n.x)*f?{useVertical:!0}:(v===a.ao.vertical?n.y<u.y:n.x>u.x)?{needsFlipping:!0}:null}function pt(v){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:u,symbol:f,fontSize:g,flip:b,keepUpright:S,glyphOffsetArray:$,dynamicLayoutVertexArray:M,aspectRatio:z,rotateToLine:F}=v,j=g/24,B=f.lineOffsetX*j,V=f.lineOffsetY*j;let W;if(f.numGlyphs>1){const te=f.glyphStartIndex+f.numGlyphs,ee=f.lineStartIndex,ie=f.lineStartIndex+f.lineLength,se=La(j,$,B,V,b,f,F,n);if(!se)return{notEnoughRoom:!0};const ce=Cl(se.first.point.x,se.first.point.y,n,u),oe=Cl(se.last.point.x,se.last.point.y,n,u);if(S&&!b){const he=Ec(f.writingMode,ce,oe,z);if(he)return he}W=[se.first];for(let he=f.glyphStartIndex+1;he<te-1;he++){const me=Na(j*$.getoffsetX(he),B,V,b,f.segment,ee,ie,n,F);if(!me)return{notEnoughRoom:!0};W.push(me)}W.push(se.last)}else{if(S&&!b){const ee=nn(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,ie=f.lineStartIndex+f.segment+1,se=new a.P(n.lineVertexArray.getx(ie),n.lineVertexArray.gety(ie)),ce=nn(se.x,se.y,n),oe=ce.signedDistanceFromCamera>0?ce.point:Jt(n.tileAnchorPoint,se,ee,1,n),he=Cl(ee.x,ee.y,n,u),me=Cl(oe.x,oe.y,n,u),ae=Ec(f.writingMode,he,me,z);if(ae)return ae}const te=Na(j*$.getoffsetX(f.glyphStartIndex),B,V,b,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,n,F);if(!te||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};W=[te]}for(const te of W)a.av(M,te.point,te.angle);return{}}function Jt(v,n,u,f,g){const b=v.add(v.sub(n)._unit()),S=nn(b.x,b.y,g).point,$=u.sub(S);return u.add($._mult(f/$.mag()))}function Ht(v,n,u){const f=n.projectionCache;if(f.projections[v])return f.projections[v];const g=new a.P(n.lineVertexArray.getx(v),n.lineVertexArray.gety(v)),b=nn(g.x,g.y,n);if(b.signedDistanceFromCamera>0)return f.projections[v]=b.point,f.anyProjectionOccluded=f.anyProjectionOccluded||b.isOccluded,b.point;const S=v-u.direction;return Jt(u.distanceFromAnchor===0?n.tileAnchorPoint:new a.P(n.lineVertexArray.getx(S),n.lineVertexArray.gety(S)),g,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,n)}function nn(v,n,u){const f=v+u.translation[0],g=n+u.translation[1];let b;return u.pitchWithMap?(b=mr(f,g,u.pitchedLabelPlaneMatrix,u.getElevation),b.isOccluded=!1):(b=u.transform.projectTileCoordinates(f,g,u.unwrappedTileID,u.getElevation),b.point.x=(.5*b.point.x+.5)*u.width,b.point.y=(.5*-b.point.y+.5)*u.height),b}function Cl(v,n,u,f){if(u.pitchWithMap){const g=[v,n,0,1];return a.aw(g,g,f),u.transform.projectTileCoordinates(g[0]/g[3],g[1]/g[3],u.unwrappedTileID,u.getElevation).point}return{x:v/u.width*2-1,y:1-n/u.height*2}}function Fa(v,n,u){return u.transform.projectTileCoordinates(v,n,u.unwrappedTileID,u.getElevation)}function Vt(v,n,u){return v._unit()._perp()._mult(n*u)}function Od(v,n,u,f,g,b,S,$,M){if($.projectionCache.offsets[v])return $.projectionCache.offsets[v];const z=u.add(n);if(v+M.direction<f||v+M.direction>=g)return $.projectionCache.offsets[v]=z,z;const F=Ht(v+M.direction,$,M),j=Vt(F.sub(u),S,M.direction),B=u.add(j),V=F.add(j);return $.projectionCache.offsets[v]=a.ax(b,z,B,V)||z,$.projectionCache.offsets[v]}function Na(v,n,u,f,g,b,S,$,M){const z=f?v-n:v+n;let F=z>0?1:-1,j=0;f&&(F*=-1,j=Math.PI),F<0&&(j+=Math.PI);let B,V=F>0?b+g:b+g+1;$.projectionCache.cachedAnchorPoint?B=$.projectionCache.cachedAnchorPoint:(B=nn($.tileAnchorPoint.x,$.tileAnchorPoint.y,$).point,$.projectionCache.cachedAnchorPoint=B);let W,te,ee=B,ie=B,se=0,ce=0;const oe=Math.abs(z),he=[];let me;for(;se+ce<=oe;){if(V+=F,V<b||V>=S)return null;se+=ce,ie=ee,te=W;const Oe={absOffsetX:oe,direction:F,distanceFromAnchor:se,previousVertex:ie};if(ee=Ht(V,$,Oe),u===0)he.push(ie),me=ee.sub(ie);else{let Ie;const $e=ee.sub(ie);Ie=$e.mag()===0?Vt(Ht(V+F,$,Oe).sub(ee),u,F):Vt($e,u,F),te||(te=ie.add(Ie)),W=Od(V,Ie,ee,b,S,te,u,$,Oe),he.push(te),me=W.sub(te)}ce=me.mag()}const ae=me._mult((oe-se)/ce)._add(te||ie),xe=j+Math.atan2(ee.y-ie.y,ee.x-ie.x);return he.push(ae),{point:ae,angle:M?xe:0,path:he}}const Rd=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function wo(v,n){for(let u=0;u<v;u++){const f=n.length;n.resize(f+4),n.float32.set(Rd,3*f)}}function Ic(v,n,u){const f=n[0],g=n[1];return v[0]=u[0]*f+u[4]*g+u[12],v[1]=u[1]*f+u[5]*g+u[13],v[3]=u[3]*f+u[7]*g+u[15],v}const er=100;class Ld{constructor(n,u=new $r(n.width+200,n.height+200,25),f=new $r(n.width+200,n.height+200,25)){this.transform=n,this.grid=u,this.ignoredGrid=f,this.pitchFactor=Math.cos(n.pitch*Math.PI/180)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+er,this.screenBottomBoundary=n.height+er,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,u,f,g,b,S,$,M,z,F,j,B){const V=this.projectAndGetPerspectiveRatio(n.anchorPointX+M[0],n.anchorPointY+M[1],b,F,B),W=f*V.perspectiveRatio;let te;if(S||$)te=this._projectCollisionBox(n,W,g,b,S,$,M,V,F,j,B);else{const me=V.x+(j?j.x*W:0),ae=V.y+(j?j.y*W:0);te={allPointsOccluded:!1,box:[me+n.x1*W,ae+n.y1*W,me+n.x2*W,ae+n.y2*W]}}const[ee,ie,se,ce]=te.box,oe=S?te.allPointsOccluded:V.isOccluded;let he=oe;return he||(he=V.perspectiveRatio<this.perspectiveRatioCutoff),he||(he=!this.isInsideGrid(ee,ie,se,ce)),he||u!=="always"&&this.grid.hitTest(ee,ie,se,ce,u,z)?{box:[ee,ie,se,ce],placeable:!1,offscreen:!1,occluded:oe}:{box:[ee,ie,se,ce],placeable:!0,offscreen:this.isOffscreen(ee,ie,se,ce),occluded:oe}}placeCollisionCircles(n,u,f,g,b,S,$,M,z,F,j,B,V,W){const te=[],ee=new a.P(u.anchorX,u.anchorY),ie=this.getPerspectiveRatio(ee.x,ee.y,S,W),se=(z?b*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,S)/ie:b*ie)/a.aB,ce={getElevation:W,pitchedLabelPlaneMatrix:$,lineVertexArray:f,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ee,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:V},oe=La(se,g,u.lineOffsetX*se,u.lineOffsetY*se,!1,u,!1,ce);let he=!1,me=!1,ae=!0;if(oe){const xe=.5*j*ie+B,Oe=new a.P(-100,-100),Ie=new a.P(this.screenRightBoundary,this.screenBottomBoundary),$e=new Di,De=oe.first,Ke=oe.last;let it=[];for(let Gt=De.path.length-1;Gt>=1;Gt--)it.push(De.path[Gt]);for(let Gt=1;Gt<Ke.path.length;Gt++)it.push(Ke.path[Gt]);const He=2.5*xe;if(z){const Gt=this.projectPathToScreenSpace(it,ce);it=Gt.some((gi=>gi.signedDistanceFromCamera<=0))?[]:Gt.map((gi=>gi.point))}let xt=[];if(it.length>0){const Gt=it[0].clone(),gi=it[0].clone();for(let Ti=1;Ti<it.length;Ti++)Gt.x=Math.min(Gt.x,it[Ti].x),Gt.y=Math.min(Gt.y,it[Ti].y),gi.x=Math.max(gi.x,it[Ti].x),gi.y=Math.max(gi.y,it[Ti].y);xt=Gt.x>=Oe.x&&gi.x<=Ie.x&&Gt.y>=Oe.y&&gi.y<=Ie.y?[it]:gi.x<Oe.x||Gt.x>Ie.x||gi.y<Oe.y||Gt.y>Ie.y?[]:a.ay([it],Oe.x,Oe.y,Ie.x,Ie.y)}for(const Gt of xt){$e.reset(Gt,.25*xe);let gi=0;gi=$e.length<=.5*xe?1:Math.ceil($e.paddedLength/He)+1;for(let Ti=0;Ti<gi;Ti++){const wi=Ti/Math.max(gi-1,1),Gi=$e.lerp(wi),Yi=Gi.x+er,Bt=Gi.y+er;te.push(Yi,Bt,xe,0);const Ci=Yi-xe,yr=Bt-xe,Pr=Yi+xe,Vr=Bt+xe;if(ae=ae&&this.isOffscreen(Ci,yr,Pr,Vr),me=me||this.isInsideGrid(Ci,yr,Pr,Vr),n!=="always"&&this.grid.hitTestCircle(Yi,Bt,xe,n,F)&&(he=!0,!M))return{circles:[],offscreen:!1,collisionDetected:he}}}}return{circles:!M&&he||!me||ie<this.perspectiveRatioCutoff?[]:te,offscreen:ae,collisionDetected:he}}projectPathToScreenSpace(n,u){const f=(function(g,b){const S=a.L();return a.aq(S,b.pitchedLabelPlaneMatrix),g.map(($=>{const M=mr($.x,$.y,S,b.getElevation),z=b.transform.projectTileCoordinates(M.point.x,M.point.y,b.unwrappedTileID,b.getElevation);return z.point.x=(.5*z.point.x+.5)*b.width,z.point.y=(.5*-z.point.y+.5)*b.height,z}))})(n,u);return(function(g){let b=0,S=0,$=0,M=0;for(let z=0;z<g.length;z++)g[z].isOccluded?($=z+1,M=0):(M++,M>S&&(S=M,b=$));return g.slice(b,b+S)})(f)}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],f=new a.a2;for(const j of n){const B=new a.P(j.x+er,j.y+er);f.extend(B),u.push(B)}const{minX:g,minY:b,maxX:S,maxY:$}=f,M=this.grid.query(g,b,S,$).concat(this.ignoredGrid.query(g,b,S,$)),z={},F={};for(const j of M){const B=j.key;if(z[B.bucketInstanceId]===void 0&&(z[B.bucketInstanceId]={}),z[B.bucketInstanceId][B.featureIndex])continue;const V=[new a.P(j.x1,j.y1),new a.P(j.x2,j.y1),new a.P(j.x2,j.y2),new a.P(j.x1,j.y2)];a.az(u,V)&&(z[B.bucketInstanceId][B.featureIndex]=!0,F[B.bucketInstanceId]===void 0&&(F[B.bucketInstanceId]=[]),F[B.bucketInstanceId].push(B.featureIndex))}return F}insertCollisionBox(n,u,f,g,b,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:b,collisionGroupID:S,overlapMode:u},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,f,g,b,S){const $=f?this.ignoredGrid:this.grid,M={bucketInstanceId:g,featureIndex:b,collisionGroupID:S,overlapMode:u};for(let z=0;z<n.length;z+=4)$.insertCircle(M,n[z],n[z+1],n[z+2])}projectAndGetPerspectiveRatio(n,u,f,g,b){if(b){let S;g?(S=[n,u,g(n,u),1],a.aw(S,S,b)):(S=[n,u,0,1],Ic(S,S,b));const $=S[3];return{x:(S[0]/$+1)/2*this.transform.width+er,y:(-S[1]/$+1)/2*this.transform.height+er,perspectiveRatio:.5+this.transform.cameraToCenterDistance/$*.5,isOccluded:!1,signedDistanceFromCamera:$}}{const S=this.transform.projectTileCoordinates(n,u,f,g);return{x:(S.point.x+1)/2*this.transform.width+er,y:(1-S.point.y)/2*this.transform.height+er,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(n,u,f,g){const b=this.transform.projectTileCoordinates(n,u,f,g);return .5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5}isOffscreen(n,u,f,g){return f<er||n>=this.screenRightBoundary||g<er||u>this.screenBottomBoundary}isInsideGrid(n,u,f,g){return f>=0&&n<this.gridRightBoundary&&g>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=a.ag([]);return a.M(n,n,[-100,-100,0]),n}_projectCollisionBox(n,u,f,g,b,S,$,M,z,F,j){let B=1,V=0,W=0,te=1;const ee=n.anchorPointX+$[0],ie=n.anchorPointY+$[1];if(S&&!b){const it=this.projectAndGetPerspectiveRatio(ee+1,ie,g,z,j),He=it.x-M.x,xt=Math.atan((it.y-M.y)/He)+(He<0?Math.PI:0),Gt=Math.sin(xt),gi=Math.cos(xt);B=gi,V=Gt,W=-Gt,te=gi}else if(!S&&b){const it=li(this.transform);B=it.vecEast[0],V=it.vecEast[1],W=it.vecSouth[0],te=it.vecSouth[1]}let se=M.x,ce=M.y,oe=u;b&&(se=ee,ce=ie,oe=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),oe*=this.transform.getPitchedTextCorrection(ee,ie,g),F||(oe*=a.ah(.5+M.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),F&&(se+=B*F.x*oe+W*F.y*oe,ce+=V*F.x*oe+te*F.y*oe);const he=n.x1*oe,me=n.x2*oe,ae=(he+me)/2,xe=n.y1*oe,Oe=n.y2*oe,Ie=(xe+Oe)/2,$e=[{offsetX:he,offsetY:xe},{offsetX:ae,offsetY:xe},{offsetX:me,offsetY:xe},{offsetX:me,offsetY:Ie},{offsetX:me,offsetY:Oe},{offsetX:ae,offsetY:Oe},{offsetX:he,offsetY:Oe},{offsetX:he,offsetY:Ie}];let De=[];for(const{offsetX:it,offsetY:He}of $e)De.push(new a.P(se+B*it+W*He,ce+V*it+te*He));let Ke=!1;if(b){const it=De.map((He=>this.projectAndGetPerspectiveRatio(He.x,He.y,g,z,j)));Ke=it.some((He=>!He.isOccluded)),De=it.map((He=>new a.P(He.x,He.y)))}else Ke=!0;return{box:a.aA(De),allPointsOccluded:!Ke}}}class Fn{constructor(n,u,f,g){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Ii{constructor(n,u,f,g,b){this.text=new Fn(n?n.text:null,u,f,b),this.icon=new Fn(n?n.icon:null,u,g,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class g_{constructor(n,u,f){this.text=n,this.icon=u,this.skipFade=f}}class Yu{constructor(n,u,f,g,b){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=b}}class Om{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[n]}}function Ba(v,n,u,f,g){const{horizontalAlign:b,verticalAlign:S}=a.aH(v);return new a.P(-(b-.5)*n+f[0]*g,-(S-.5)*u+f[1]*g)}class ja{constructor(n,u,f,g,b){this.transform=n.clone(),this.terrain=u,this.collisionIndex=new Ld(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Om(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const u=this.terrain;return u?(f,g)=>u.getElevation(n,f,g):null}getBucketParts(n,u,f,g){const b=f.getBucket(u),S=f.latestFeatureIndex;if(!b||!S||u.id!==b.layerIds[0])return;const $=f.collisionBoxArray,M=b.layers[0].layout,z=b.layers[0].paint,F=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),j=f.tileSize/a.$,B=f.tileID.toUnwrapped(),V=M.get("text-rotation-alignment")==="map",W=a.aC(f,1,this.transform.zoom),te=a.aD(this.collisionIndex.transform,f,z.get("text-translate"),z.get("text-translate-anchor")),ee=a.aD(this.collisionIndex.transform,f,z.get("icon-translate"),z.get("icon-translate-anchor")),ie=cr(V,this.transform,W);this.retainedQueryData[b.bucketInstanceId]=new Yu(b.bucketInstanceId,S,b.sourceLayerIndex,b.index,f.tileID);const se={bucket:b,layout:M,translationText:te,translationIcon:ee,unwrappedTileID:B,pitchedLabelPlaneMatrix:ie,scale:F,textPixelRatio:j,holdingForFade:f.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:a.an(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(g)for(const ce of b.sortKeyRanges){const{sortKey:oe,symbolInstanceStart:he,symbolInstanceEnd:me}=ce;n.push({sortKey:oe,symbolInstanceStart:he,symbolInstanceEnd:me,parameters:se})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:se})}attemptAnchorPlacement(n,u,f,g,b,S,$,M,z,F,j,B,V,W,te,ee,ie,se,ce,oe){const he=a.aE[n.textAnchor],me=[n.textOffset0,n.textOffset1],ae=Ba(he,f,g,me,b),xe=this.collisionIndex.placeCollisionBox(u,B,M,z,F,$,S,ee,j.predicate,ce,ae,oe);if((!se||this.collisionIndex.placeCollisionBox(se,B,M,z,F,$,S,ie,j.predicate,ce,ae,oe).placeable)&&xe.placeable){let Oe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(Oe=this.prevPlacement.variableOffsets[V.crossTileID].anchor),V.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[V.crossTileID]={textOffset:me,width:f,height:g,anchor:he,textBoxScale:b,prevAnchor:Oe},this.markUsedJustification(W,he,V,te),W.allowVerticalPlacement&&(this.markUsedOrientation(W,te,V),this.placedOrientations[V.crossTileID]=te),{shift:ae,placedGlyphBoxes:xe}}}placeLayerBucketPart(n,u,f){const{bucket:g,layout:b,translationText:S,translationIcon:$,unwrappedTileID:M,pitchedLabelPlaneMatrix:z,textPixelRatio:F,holdingForFade:j,collisionBoxArray:B,partiallyEvaluatedTextSize:V,collisionGroup:W}=n.parameters,te=b.get("text-optional"),ee=b.get("icon-optional"),ie=a.aF(b,"text-overlap","text-allow-overlap"),se=ie==="always",ce=a.aF(b,"icon-overlap","icon-allow-overlap"),oe=ce==="always",he=b.get("text-rotation-alignment")==="map",me=b.get("text-pitch-alignment")==="map",ae=b.get("icon-text-fit")!=="none",xe=b.get("symbol-z-order")==="viewport-y",Oe=se&&(oe||!g.hasIconData()||ee),Ie=oe&&(se||!g.hasTextData()||te);!g.collisionArrays&&B&&g.deserializeCollisionBoxes(B);const $e=this.retainedQueryData[g.bucketInstanceId].tileID,De=this._getTerrainElevationFunc($e),Ke=this.transform.getFastPathSimpleProjectionMatrix($e),it=(He,xt,Gt)=>{var gi,Ti;if(u[He.crossTileID])return;if(j)return void(this.placements[He.crossTileID]=new g_(!1,!1,!1));let wi=!1,Gi=!1,Yi=!0,Bt=null,Ci={box:null,placeable:!1,offscreen:null,occluded:!1},yr={placeable:!1},Pr=null,Vr=null,In=null,qs=0,Ha=0,Za=0;xt.textFeatureIndex?qs=xt.textFeatureIndex:He.useRuntimeCollisionCircles&&(qs=He.featureIndex),xt.verticalTextFeatureIndex&&(Ha=xt.verticalTextFeatureIndex);const Wc=xt.textBox;if(Wc){const jn=_r=>{let Mr=a.ao.horizontal;if(g.allowVerticalPlacement&&!_r&&this.prevPlacement){const vs=this.prevPlacement.placedOrientations[He.crossTileID];vs&&(this.placedOrientations[He.crossTileID]=vs,Mr=vs,this.markUsedOrientation(g,Mr,He))}return Mr},Hs=(_r,Mr)=>{if(g.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&xt.verticalTextBox){for(const vs of g.writingModes)if(vs===a.ao.vertical?(Ci=Mr(),yr=Ci):Ci=_r(),Ci&&Ci.placeable)break}else Ci=_r()},$n=He.textAnchorOffsetStartIndex,Wa=He.textAnchorOffsetEndIndex;if(Wa===$n){const _r=(Mr,vs)=>{const vr=this.collisionIndex.placeCollisionBox(Mr,ie,F,$e,M,me,he,S,W.predicate,De,void 0,Ke);return vr&&vr.placeable&&(this.markUsedOrientation(g,vs,He),this.placedOrientations[He.crossTileID]=vs),vr};Hs((()=>_r(Wc,a.ao.horizontal)),(()=>{const Mr=xt.verticalTextBox;return g.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Mr?_r(Mr,a.ao.vertical):{box:null,offscreen:null}})),jn(Ci&&Ci.placeable)}else{let _r=a.aE[(Ti=(gi=this.prevPlacement)===null||gi===void 0?void 0:gi.variableOffsets[He.crossTileID])===null||Ti===void 0?void 0:Ti.anchor];const Mr=(vr,wh,Xc)=>{const Jo=vr.x2-vr.x1,Zs=vr.y2-vr.y1,Ya=He.textBoxScale,lv=ae&&ce==="never"?wh:null;let rs=null,cv=ie==="never"?1:2,$g="never";_r&&cv++;for(let vp=0;vp<cv;vp++){for(let bp=$n;bp<Wa;bp++){const Xa=g.textAnchorOffsets.get(bp);if(_r&&Xa.textAnchor!==_r)continue;const Ko=this.attemptAnchorPlacement(Xa,vr,Jo,Zs,Ya,he,me,F,$e,M,W,$g,He,g,Xc,S,$,lv,De);if(Ko&&(rs=Ko.placedGlyphBoxes,rs&&rs.placeable))return wi=!0,Bt=Ko.shift,rs}_r?_r=null:$g=ie}return f&&!rs&&(rs={box:this.collisionIndex.placeCollisionBox(Wc,"always",F,$e,M,me,he,S,W.predicate,De,void 0,Ke).box,offscreen:!1,placeable:!1,occluded:!1}),rs};Hs((()=>Mr(Wc,xt.iconBox,a.ao.horizontal)),(()=>{const vr=xt.verticalTextBox;return g.allowVerticalPlacement&&(!Ci||!Ci.placeable)&&He.numVerticalGlyphVertices>0&&vr?Mr(vr,xt.verticalIconBox,a.ao.vertical):{box:null,occluded:!0,offscreen:null}})),Ci&&(wi=Ci.placeable,Yi=Ci.offscreen);const vs=jn(Ci&&Ci.placeable);if(!wi&&this.prevPlacement){const vr=this.prevPlacement.variableOffsets[He.crossTileID];vr&&(this.variableOffsets[He.crossTileID]=vr,this.markUsedJustification(g,vr.anchor,He,vs))}}}if(Pr=Ci,wi=Pr&&Pr.placeable,Yi=Pr&&Pr.offscreen,He.useRuntimeCollisionCircles){const jn=g.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex),Hs=a.ap(g.textSizeData,V,jn),$n=b.get("text-padding");Vr=this.collisionIndex.placeCollisionCircles(ie,jn,g.lineVertexArray,g.glyphOffsetArray,Hs,M,z,f,me,W.predicate,He.collisionCircleDiameter,$n,S,De),Vr.circles.length&&Vr.collisionDetected&&!f&&a.w("Collisions detected, but collision boxes are not shown"),wi=se||Vr.circles.length>0&&!Vr.collisionDetected,Yi=Yi&&Vr.offscreen}if(xt.iconFeatureIndex&&(Za=xt.iconFeatureIndex),xt.iconBox){const jn=Hs=>this.collisionIndex.placeCollisionBox(Hs,ce,F,$e,M,me,he,$,W.predicate,De,ae&&Bt?Bt:void 0,Ke);yr&&yr.placeable&&xt.verticalIconBox?(In=jn(xt.verticalIconBox),Gi=In.placeable):(In=jn(xt.iconBox),Gi=In.placeable),Yi=Yi&&In.offscreen}const Yc=te||He.numHorizontalGlyphVertices===0&&He.numVerticalGlyphVertices===0,Vl=ee||He.numIconVertices===0;Yc||Vl?Vl?Yc||(Gi=Gi&&wi):wi=Gi&&wi:Gi=wi=Gi&&wi;const Gl=Gi&&In.placeable;if(wi&&Pr.placeable&&this.collisionIndex.insertCollisionBox(Pr.box,ie,b.get("text-ignore-placement"),g.bucketInstanceId,yr&&yr.placeable&&Ha?Ha:qs,W.ID),Gl&&this.collisionIndex.insertCollisionBox(In.box,ce,b.get("icon-ignore-placement"),g.bucketInstanceId,Za,W.ID),Vr&&wi&&this.collisionIndex.insertCollisionCircles(Vr.circles,ie,b.get("text-ignore-placement"),g.bucketInstanceId,qs,W.ID),f&&this.storeCollisionData(g.bucketInstanceId,Gt,xt,Pr,In,Vr),He.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[He.crossTileID]=new g_((wi||Oe)&&!Pr?.occluded,(Gi||Ie)&&!In?.occluded,Yi||g.justReloaded),u[He.crossTileID]=!0};if(xe){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const He=g.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let xt=He.length-1;xt>=0;--xt){const Gt=He[xt];it(g.symbolInstances.get(Gt),g.collisionArrays[Gt],Gt)}}else for(let He=n.symbolInstanceStart;He<n.symbolInstanceEnd;He++)it(g.symbolInstances.get(He),g.collisionArrays[He],He);g.justReloaded=!1}storeCollisionData(n,u,f,g,b,S){if(f.textBox||f.iconBox){let $,M;this.collisionBoxArrays.has(n)?$=this.collisionBoxArrays.get(n):($=new Map,this.collisionBoxArrays.set(n,$)),$.has(u)?M=$.get(u):(M={text:null,icon:null},$.set(u,M)),f.textBox&&(M.text=g.box),f.iconBox&&(M.icon=b.box)}if(S){let $=this.collisionCircleArrays[n];$===void 0&&($=this.collisionCircleArrays[n]=[]);for(let M=0;M<S.circles.length;M+=4)$.push(S.circles[M+0]-er),$.push(S.circles[M+1]-er),$.push(S.circles[M+2]),$.push(S.collisionDetected?1:0)}}markUsedJustification(n,u,f,g){let b;b=g===a.ao.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[a.aG(u)];const S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const $ of S)$>=0&&(n.text.placedSymbolArray.get($).crossTileID=b>=0&&$!==b?0:f.crossTileID)}markUsedOrientation(n,u,f){const g=u===a.ao.horizontal||u===a.ao.horizontalOnly?u:0,b=u===a.ao.vertical?u:0,S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const $ of S)n.text.placedSymbolArray.get($).placedOrientation=g;f.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const g=u?u.symbolFadeChange(n):1,b=u?u.opacities:{},S=u?u.variableOffsets:{},$=u?u.placedOrientations:{};for(const M in this.placements){const z=this.placements[M],F=b[M];F?(this.opacities[M]=new Ii(F,g,z.text,z.icon),f=f||z.text!==F.text.placed||z.icon!==F.icon.placed):(this.opacities[M]=new Ii(null,g,z.text,z.icon,z.skipFade),f=f||z.text||z.icon)}for(const M in b){const z=b[M];if(!this.opacities[M]){const F=new Ii(z,g,!1,!1);F.isHidden()||(this.opacities[M]=F,f=f||z.text.placed||z.icon.placed)}}for(const M in S)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=S[M]);for(const M in $)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=$[M]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u){const f={};for(const g of u){const b=g.getBucket(n);b&&g.latestFeatureIndex&&n.id===b.layerIds[0]&&this.updateBucketOpacities(b,g.tileID,f,g.collisionBoxArray)}}updateBucketOpacities(n,u,f,g){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const b=n.layers[0],S=b.layout,$=new Ii(null,0,!1,!1,!0),M=S.get("text-allow-overlap"),z=S.get("icon-allow-overlap"),F=b._unevaluatedLayout.hasValue("text-variable-anchor")||b._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=S.get("text-rotation-alignment")==="map",B=S.get("text-pitch-alignment")==="map",V=S.get("icon-text-fit")!=="none",W=new Ii(null,0,M&&(z||!n.hasIconData()||S.get("icon-optional")),z&&(M||!n.hasTextData()||S.get("text-optional")),!0);!n.collisionArrays&&g&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(g);const te=(ie,se,ce)=>{for(let oe=0;oe<se/4;oe++)ie.opacityVertexArray.emplaceBack(ce);ie.hasVisibleVertices=ie.hasVisibleVertices||ce!==Pc},ee=this.collisionBoxArrays.get(n.bucketInstanceId);for(let ie=0;ie<n.symbolInstances.length;ie++){const se=n.symbolInstances.get(ie),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:oe,crossTileID:he}=se;let me=this.opacities[he];f[he]?me=$:me||(me=W,this.opacities[he]=me),f[he]=!0;const ae=se.numIconVertices>0,xe=this.placedOrientations[se.crossTileID],Oe=xe===a.ao.vertical,Ie=xe===a.ao.horizontal||xe===a.ao.horizontalOnly;if(ce>0||oe>0){const De=Lm(me.text);te(n.text,ce,Oe?Pc:De),te(n.text,oe,Ie?Pc:De);const Ke=me.text.isHidden();[se.rightJustifiedTextSymbolIndex,se.centerJustifiedTextSymbolIndex,se.leftJustifiedTextSymbolIndex].forEach((xt=>{xt>=0&&(n.text.placedSymbolArray.get(xt).hidden=Ke||Oe?1:0)})),se.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(se.verticalPlacedTextSymbolIndex).hidden=Ke||Ie?1:0);const it=this.variableOffsets[se.crossTileID];it&&this.markUsedJustification(n,it.anchor,se,xe);const He=this.placedOrientations[se.crossTileID];He&&(this.markUsedJustification(n,"left",se,He),this.markUsedOrientation(n,He,se))}if(ae){const De=Lm(me.icon),Ke=!(V&&se.verticalPlacedIconSymbolIndex&&Oe);se.placedIconSymbolIndex>=0&&(te(n.icon,se.numIconVertices,Ke?De:Pc),n.icon.placedSymbolArray.get(se.placedIconSymbolIndex).hidden=me.icon.isHidden()),se.verticalPlacedIconSymbolIndex>=0&&(te(n.icon,se.numVerticalIconVertices,Ke?Pc:De),n.icon.placedSymbolArray.get(se.verticalPlacedIconSymbolIndex).hidden=me.icon.isHidden())}const $e=ee&&ee.has(ie)?ee.get(ie):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const De=n.collisionArrays[ie];if(De){let Ke=new a.P(0,0);if(De.textBox||De.verticalTextBox){let it=!0;if(F){const He=this.variableOffsets[he];He?(Ke=Ba(He.anchor,He.width,He.height,He.textOffset,He.textBoxScale),j&&Ke._rotate(B?-this.transform.bearingInRadians:this.transform.bearingInRadians)):it=!1}if(De.textBox||De.verticalTextBox){let He;De.textBox&&(He=Oe),De.verticalTextBox&&(He=Ie),Rm(n.textCollisionBox.collisionVertexArray,me.text.placed,!it||He,$e.text,Ke.x,Ke.y)}}if(De.iconBox||De.verticalIconBox){const it=!!(!Ie&&De.verticalIconBox);let He;De.iconBox&&(He=it),De.verticalIconBox&&(He=!it),Rm(n.iconCollisionBox.collisionVertexArray,me.icon.placed,He,$e.icon,V?Ke.x:0,V?Ke.y:0)}}}}if(n.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);n.bucketInstanceId in this.collisionCircleArrays&&(n.collisionCircleArray=this.collisionCircleArrays[n.bucketInstanceId],delete this.collisionCircleArrays[n.bucketInstanceId])}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>n}setStale(){this.stale=!0}}function Rm(v,n,u,f,g,b){f&&f.length!==0||(f=[0,0,0,0]);const S=f[0]-er,$=f[1]-er,M=f[2]-er,z=f[3]-er;v.emplaceBack(n?1:0,u?1:0,g||0,b||0,S,$),v.emplaceBack(n?1:0,u?1:0,g||0,b||0,M,$),v.emplaceBack(n?1:0,u?1:0,g||0,b||0,M,z),v.emplaceBack(n?1:0,u?1:0,g||0,b||0,S,z)}const y_=Math.pow(2,25),__=Math.pow(2,24),$c=Math.pow(2,17),v_=Math.pow(2,16),Ww=Math.pow(2,9),Yw=Math.pow(2,8),Xw=Math.pow(2,1);function Lm(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const n=v.placed?1:0,u=Math.floor(127*v.opacity);return u*y_+n*__+u*$c+n*v_+u*Ww+n*Yw+u*Xw+n}const Pc=0;class Fm{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,u,f,g,b){const S=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(S,g,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((($,M)=>$.sortKey-M.sortKey)));this._currentPartIndex<S.length;)if(u.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,b())return!0;return!1}}class Nm{constructor(n,u,f,g,b,S,$,M){this.placement=new ja(n,u,S,$,M),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(n,u,f){const g=L.now(),b=()=>!this._forceFullPlacement&&L.now()-g>2;for(;this._currentPlacementIndex>=0;){const S=u[n[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=$)&&(!S.maxzoom||S.maxzoom>$)){if(this._inProgressLayer||(this._inProgressLayer=new Fm(S)),this._inProgressLayer.continuePlacement(f[S.source],this.placement,this._showCollisionBoxes,S,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Mc=512/a.$/2;class Bm{constructor(n,u,f){this.tileID=n,this.bucketInstanceId=f,this._symbolsByKey={};const g=new Map;for(let b=0;b<u.length;b++){const S=u.get(b),$=S.key,M=g.get($);M?M.push(S):g.set($,[S])}for(const[b,S]of g){const $={positions:S.map((M=>({x:Math.floor(M.anchorX*Mc),y:Math.floor(M.anchorY*Mc)}))),crossTileIDs:S.map((M=>M.crossTileID))};if($.positions.length>128){const M=new a.aI($.positions.length,16,Uint16Array);for(const{x:z,y:F}of $.positions)M.add(z,F);M.finish(),delete $.positions,$.index=M}this._symbolsByKey[b]=$}}getScaledCoordinates(n,u){const{x:f,y:g,z:b}=this.tileID.canonical,{x:S,y:$,z:M}=u.canonical,z=Mc/Math.pow(2,M-b),F=($*a.$+n.anchorY)*z,j=g*a.$*Mc;return{x:Math.floor((S*a.$+n.anchorX)*z-f*a.$*Mc),y:Math.floor(F-j)}}findMatches(n,u,f){const g=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let b=0;b<n.length;b++){const S=n.get(b);if(S.crossTileID)continue;const $=this._symbolsByKey[S.key];if(!$)continue;const M=this.getScaledCoordinates(S,u);if($.index){const z=$.index.range(M.x-g,M.y-g,M.x+g,M.y+g).sort();for(const F of z){const j=$.crossTileIDs[F];if(!f[j]){f[j]=!0,S.crossTileID=j;break}}}else if($.positions)for(let z=0;z<$.positions.length;z++){const F=$.positions[z],j=$.crossTileIDs[z];if(Math.abs(F.x-M.x)<=g&&Math.abs(F.y-M.y)<=g&&!f[j]){f[j]=!0,S.crossTileID=j;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:n})=>n))}}class jm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Jw{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const f in this.indexes){const g=this.indexes[f],b={};for(const S in g){const $=g[S];$.tileID=$.tileID.unwrapTo($.tileID.wrap+u),b[$.tileID.key]=$}this.indexes[f]=b}this.lng=n}addBucket(n,u,f){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const g=this.usedCrossTileIDs[n.overscaledZ];for(const b in this.indexes){const S=this.indexes[b];if(Number(b)>n.overscaledZ)for(const $ in S){const M=S[$];M.tileID.isChildOf(n)&&M.findMatches(u.symbolInstances,n,g)}else{const $=S[n.scaledTo(Number(b)).key];$&&$.findMatches(u.symbolInstances,n,g)}}for(let b=0;b<u.symbolInstances.length;b++){const S=u.symbolInstances.get(b);S.crossTileID||(S.crossTileID=f.generate(),g[S.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Bm(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const f of u.getCrossTileIDsLists())for(const g of f)delete this.usedCrossTileIDs[n][g]}removeStaleBuckets(n){let u=!1;for(const f in this.indexes){const g=this.indexes[f];for(const b in g)n[g[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[b]),delete g[b],u=!0)}return u}}class kc{constructor(){this.layerIndexes={},this.crossTileIDs=new jm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,f){let g=this.layerIndexes[n.id];g===void 0&&(g=this.layerIndexes[n.id]=new Jw);let b=!1;const S={};g.handleWrapJump(f);for(const $ of u){const M=$.getBucket(n);M&&n.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket($.tileID,M,this.crossTileIDs)&&(b=!0),S[M.bucketInstanceId]=!0)}return g.removeStaleBuckets(S)&&(b=!0),b}pruneUnusedLayers(n){const u={};n.forEach((f=>{u[f]=!0}));for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}var Xu="void main() {fragColor=vec4(1.0);}";const Ls={prelude:Kt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Kt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Kt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Kt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Kt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Kt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Kt(Xu,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Kt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Kt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Kt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Kt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Kt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Kt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Kt(Xu,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Kt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Kt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Kt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Kt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Kt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Kt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Kt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Kt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Kt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Kt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Kt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Kt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Kt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Kt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Kt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Kt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Kt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Kt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Kt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Kt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Kt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Kt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Kt(v,n){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=n.match(/in ([\w]+) ([\w]+)/g),g=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=b?b.concat(g):g,$={};return{fragmentSource:v=v.replace(u,((M,z,F,j,B)=>($[B]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
in ${F} ${j} ${B};
#else
uniform ${F} ${j} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${F} ${j} ${B} = u_${B};
#endif
`))),vertexSource:n=n.replace(u,((M,z,F,j,B)=>{const V=j==="float"?"vec2":"vec4",W=B.match(/color/)?"color":V;return $[B]?z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${F} ${V} a_${B};
out ${F} ${j} ${B};
#else
uniform ${F} ${j} u_${B};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${F} ${j} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${W}(a_${B}, u_${B}_t);
#else
    ${F} ${j} ${B} = u_${B};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${F} ${V} a_${B};
#else
uniform ${F} ${j} u_${B};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${F} ${j} ${B} = a_${B};
#else
    ${F} ${j} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${F} ${j} ${B} = unpack_mix_${W}(a_${B}, u_${B}_t);
#else
    ${F} ${j} ${B} = u_${B};
#endif
`})),staticAttributes:f,staticUniforms:S}}class El{constructor(n,u,f){this.vertexBuffer=n,this.indexBuffer=u,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ua=a.aJ([{name:"a_pos",type:"Int16",components:2}]);const Zo="#define PROJECTION_MERCATOR",Il="mercator";class Qt{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Il}get shaderDefine(){return Zo}get shaderPreludeCode(){return Ls.projectionMercator}get vertexShaderPreludeCode(){return Ls.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(n){}getMeshFromTileID(n,u,f,g,b){if(this._cachedMesh)return this._cachedMesh;const S=new a.aL;S.emplaceBack(0,0),S.emplaceBack(a.$,0),S.emplaceBack(0,a.$),S.emplaceBack(a.$,a.$);const $=n.createVertexBuffer(S,Ua.members),M=a.aM.simpleSegment(0,0,4,2),z=new a.aN;z.emplaceBack(1,0,2),z.emplaceBack(1,2,3);const F=n.createIndexBuffer(z);return this._cachedMesh=new El($,F,M),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(n){}}class $l{constructor(n=0,u=0,f=0,g=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=f,this.right=g}interpolate(n,u,f){return u.top!=null&&n.top!=null&&(this.top=a.C.number(n.top,u.top,f)),u.bottom!=null&&n.bottom!=null&&(this.bottom=a.C.number(n.bottom,u.bottom,f)),u.left!=null&&n.left!=null&&(this.left=a.C.number(n.left,u.left,f)),u.right!=null&&n.right!=null&&(this.right=a.C.number(n.right,u.right,f)),this}getCenter(n,u){const f=a.ah((this.left+n-this.right)/2,0,n),g=a.ah((this.top+u-this.bottom)/2,0,u);return new a.P(f,g)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new $l(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Fd(v,n){if(!v.renderWorldCopies||v.lngRange)return;const u=n.lng-v.center.lng;n.lng+=u>180?-360:u<-180?360:0}function Nd(v){return Math.max(0,Math.floor(v))}class Sn{constructor(n,u,f,g,b,S){this._callbacks=n,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=u||0,this._maxZoom=f||22,this._minPitch=g??0,this._maxPitch=b??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Nd(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new $l,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(n,u,f){this._latRange=n.latRange,this._lngRange=n.lngRange,this._width=n.width,this._height=n.height,this._center=n.center,this._elevation=n.elevation,this._minElevationForCurrentTile=n.minElevationForCurrentTile,this._zoom=n.zoom,this._tileZoom=Nd(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=n.bearingInRadians,this._fovInRadians=n.fovInRadians,this._pitchInRadians=n.pitchInRadians,this._rollInRadians=n.rollInRadians,this._unmodified=n.unmodified,this._edgeInsets=new $l(n.padding.top,n.padding.bottom,n.padding.left,n.padding.right),this._minZoom=n.minZoom,this._maxZoom=n.maxZoom,this._minPitch=n.minPitch,this._maxPitch=n.maxPitch,this._renderWorldCopies=n.renderWorldCopies,this._cameraToCenterDistance=n.cameraToCenterDistance,this._nearZ=n.nearZ,this._farZ=n.farZ,this._autoCalculateNearFarZ=!f&&n.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(n){this._minElevationForCurrentTile=n}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(n){this._minZoom!==n&&(this._minZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(n){this._minPitch!==n&&(this._minPitch=n,this.setPitch(Math.max(this.pitch,n)))}get maxPitch(){return this._maxPitch}setMaxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.setPitch(Math.min(this.pitch,n)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(n){const u=a.aO(n,-180,180)*Math.PI/180;var f,g,b,S,$,M,z,F,j;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=T(),f=this._rotationMatrix,b=-this._bearingInRadians,S=(g=this._rotationMatrix)[0],$=g[1],M=g[2],z=g[3],F=Math.sin(b),j=Math.cos(b),f[0]=S*j+M*F,f[1]=$*j+z*F,f[2]=S*-F+M*j,f[3]=$*-F+z*j)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(n){const u=a.ah(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(n){const u=n/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aP(this._fovInRadians)}setFov(n){n=a.ah(n,.1,150),this.fov!==n&&(this._unmodified=!1,this._fovInRadians=a.ae(n),this._calcMatrices())}get zoom(){return this._zoom}setZoom(n){const u=this.getConstrained(this._center,n).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=a.af(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(n,u){this._autoCalculateNearFarZ=!1,this._nearZ=n,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,f){this._unmodified=!1,this._edgeInsets.interpolate(n,u,f),this._constrain(),this._calcMatrices()}resize(n,u,f=!0){this._width=n,this._height=u,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Qi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(n){n?(this._lngRange=[n.getWest(),n.getEast()],this._latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-a.ai,a.ai])}getConstrained(n,u){return this._callbacks.getConstrained(n,u)}getCameraQueryGeometry(n,u){if(u.length===1)return[u[0],n];{const{minX:f,minY:g,maxX:b,maxY:S}=a.a2.fromPoints(u).extend(n);return[new a.P(f,g),new a.P(b,g),new a.P(b,S),new a.P(f,S),new a.P(f,g)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:u,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(f),this._unmodified=n,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let n=a.ag(new Float64Array(16));a.N(n,n,[this._width/2,-this._height/2,1]),a.M(n,n,[1,-1,0]),this._clipSpaceToPixelsMatrix=n,n=a.ag(new Float64Array(16)),a.N(n,n,[1,-1,1]),a.M(n,n,[-1,-1,0]),a.N(n,n,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=n,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(n,u,f,g){const b=f!==void 0?f:this.bearing,S=g=g!==void 0?g:this.pitch,$=a.a1.fromLngLat(n,u),M=-Math.cos(a.ae(S)),z=Math.sin(a.ae(S)),F=z*Math.sin(a.ae(b)),j=-z*Math.cos(a.ae(b));let B=this.elevation;const V=u-B;let W;M*V>=0||Math.abs(M)<.1?(W=1e4,B=u+W*M):W=-V/M;let te,ee,ie=a.aQ(1,$.y),se=0;do{if(se+=1,se>10)break;ee=W/ie,te=new a.a1($.x+F*ee,$.y+j*ee),ie=1/te.meterInMercatorCoordinateUnits()}while(Math.abs(W-ee*ie)>1e-12);return{center:te.toLngLat(),elevation:B,zoom:a.ak(this.height/2/Math.tan(this.fovInRadians/2)/ee/this.tileSize)}}recalculateZoomAndCenter(n){if(this.elevation-n==0)return;const u=a.aj(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/u,g=a.a1.fromLngLat(this.center,this.elevation),b=Ae(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=n;const S=this.calculateCenterFromCameraLngLatAlt(b.toLngLat(),a.aQ(b.z,g.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const n=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(n*Math.sin(this.rollInRadians),n*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const n=a.aj(1,this.center.lat)*this.worldSize;return Ae(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/n).toLngLat()}getMercatorTileCoordinates(n){if(!n)return[0,0,1,1];const u=n.canonical.z>=0?1<<n.canonical.z:Math.pow(2,n.canonical.z);return[n.canonical.x/u,n.canonical.y/u,1/u/a.$,1/u/a.$]}}class jr{constructor(n,u){this.min=n,this.max=u,this.center=a.aR([],a.aS([],this.min,this.max),.5)}quadrant(n){const u=[n%2==0,n<2],f=a.aT(this.min),g=a.aT(this.max);for(let b=0;b<u.length;b++)f[b]=u[b]?this.min[b]:this.center[b],g[b]=u[b]?this.center[b]:this.max[b];return g[2]=this.max[2],new jr(f,g)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersectsFrustum(n){let u=!0;for(let f=0;f<n.planes.length;f++){const g=this.intersectsPlane(n.planes[f]);if(g===0)return 0;g===1&&(u=!1)}return u?2:n.aabb.min[0]>this.max[0]||n.aabb.min[1]>this.max[1]||n.aabb.min[2]>this.max[2]||n.aabb.max[0]<this.min[0]||n.aabb.max[1]<this.min[1]||n.aabb.max[2]<this.min[2]?0:1}intersectsPlane(n){let u=n[3],f=n[3];for(let g=0;g<3;g++)n[g]>0?(u+=n[g]*this.min[g],f+=n[g]*this.max[g]):(f+=n[g]*this.min[g],u+=n[g]*this.max[g]);return u>=0?2:f<0?0:1}}class Tn{distanceToTile2d(n,u,f,g){const b=g.distanceX([n,u]),S=g.distanceY([n,u]);return Math.hypot(b,S)}getWrap(n,u,f){return f}getTileBoundingVolume(n,u,f,g){var b,S;let $=0,M=0;if(g?.terrain){const F=new a.Z(n.z,u,n.z,n.x,n.y),j=g.terrain.getMinMaxElevation(F);$=(b=j.minElevation)!==null&&b!==void 0?b:Math.min(0,f),M=(S=j.maxElevation)!==null&&S!==void 0?S:Math.max(0,f)}const z=1<<n.z;return new jr([u+n.x/z,n.y/z,$],[u+(n.x+1)/z,(n.y+1)/z,M])}allowVariableZoom(n,u){const f=n.fov*(Math.abs(Math.cos(n.rollInRadians))*n.height+Math.abs(Math.sin(n.rollInRadians))*n.width)/n.height,g=a.ah(78.5-f/2,0,60);return!!u.terrain||n.pitch>g}allowWorldCopies(){return!0}prepareNextFrame(){}}class gr{constructor(n,u,f){this.points=n,this.planes=u,this.aabb=f}static fromInvProjectionMatrix(n,u=1,f=0,g,b){const S=b?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],$=Math.pow(2,f),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((B=>(function(V,W,te,ee){const ie=a.aw([],V,W),se=1/ie[3]/te*ee;return a.aY(ie,ie,[se,se,1/ie[3],se])})(B,n,u,$)));g&&(function(B,V,W,te){const ee=te?4:0,ie=te?0:4;let se=0;const ce=[],oe=[];for(let ae=0;ae<4;ae++){const xe=a.aU([],B[ae+ie],B[ae+ee]),Oe=a.aZ(xe);a.aR(xe,xe,1/Oe),ce.push(Oe),oe.push(xe)}for(let ae=0;ae<4;ae++){const xe=a.a_(B[ae+ee],oe[ae],W);se=xe!==null&&xe>=0?Math.max(se,xe):Math.max(se,ce[ae])}const he=(function(ae,xe){const Oe=a.aU([],ae[xe[0]],ae[xe[1]]),Ie=a.aU([],ae[xe[2]],ae[xe[1]]),$e=[0,0,0,0];return a.aV($e,a.aW([],Oe,Ie)),$e[3]=-a.aX($e,ae[xe[0]]),$e})(B,V),me=(function(ae,xe){const Oe=a.a$(ae),Ie=a.b0([],ae,1/Oe),$e=a.aU([],xe,a.aR([],Ie,a.aX(xe,Ie))),De=a.a$($e);if(De>0){const Ke=Math.sqrt(1-Ie[3]*Ie[3]),it=a.aR([],Ie,-Ie[3]),He=a.aS([],it,a.aR([],$e,Ke/De));return a.b1(xe,He)}return null})(W,he);if(me!==null){const ae=me/a.aX(oe[0],he);se=Math.min(se,ae)}for(let ae=0;ae<4;ae++){const xe=Math.min(se,ce[ae]);B[ae+ie]=[B[ae+ee][0]+oe[ae][0]*xe,B[ae+ee][1]+oe[ae][1]*xe,B[ae+ee][2]+oe[ae][2]*xe,1]}})(M,S[0],g,b);const z=S.map((B=>{const V=a.aU([],M[B[0]],M[B[1]]),W=a.aU([],M[B[2]],M[B[1]]),te=a.aV([],a.aW([],V,W)),ee=-a.aX(te,M[B[1]]);return te.concat(ee)})),F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],j=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const B of M)for(let V=0;V<3;V++)F[V]=Math.min(F[V],B[V]),j[V]=Math.max(j[V],B[V]);return new gr(M,z,new jr(F,j))}}class $i{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,f){return this._helper.interpolatePadding(n,u,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,f=!0){this._helper.resize(n,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n,u){}constructor(n,u,f,g,b){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,$)=>this.getConstrained(S,$)},n,u,f,g,b),this._coveringTilesDetailsProvider=new Tn}clone(){const n=new $i;return n.apply(this),n}apply(n,u,f){this._helper.apply(n,u,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(n){const u=[new a.b2(0,n)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new a.P(0,0)),g=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),b=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),$=Math.floor(Math.min(f.x,g.x,b.x,S.x)),M=Math.floor(Math.max(f.x,g.x,b.x,S.x)),z=1;for(let F=$-z;F<=M+z;F++)F!==0&&u.push(new a.b2(F,n))}return u}getCameraFrustum(){return gr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){const u=this.screenPointToLocation(this.centerPoint,n),f=n?n.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(n,u){const f=a.aj(this.elevation,this.center.lat),g=this.screenPointToMercatorCoordinateAtZ(u,f),b=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),S=a.a1.fromLngLat(n),$=new a.a1(S.x-(g.x-b.x),S.y-(g.y-b.y));this.setCenter($?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(n,u){return u?this.coordinatePoint(a.a1.fromLngLat(n),u.getElevationForLngLatZoom(n,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.a1.fromLngLat(n))}screenPointToLocation(n,u){var f;return(f=this.screenPointToMercatorCoordinate(n,u))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(n,u){if(u){const f=u.pointCoordinate(n);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(n)}screenPointToMercatorCoordinateAtZ(n,u){const f=u||0,g=[n.x,n.y,0,1],b=[n.x,n.y,1,1];a.aw(g,g,this._pixelMatrixInverse),a.aw(b,b,this._pixelMatrixInverse);const S=g[3],$=b[3],M=g[1]/S,z=b[1]/$,F=g[2]/S,j=b[2]/$,B=F===j?0:(f-F)/(j-F);return new a.a1(a.C.number(g[0]/S,b[0]/$,B)/this.worldSize,a.C.number(M,z,B)/this.worldSize,f)}coordinatePoint(n,u=0,f=this._pixelMatrix){const g=[n.x*this.worldSize,n.y*this.worldSize,u,1];return a.aw(g,g,f),new a.P(g[0]/g[3],g[1]/g[3])}getBounds(){const n=Math.max(0,this._helper._height/2-fe(this));return new Qi().extend(this.screenPointToLocation(new a.P(0,n))).extend(this.screenPointToLocation(new a.P(this._helper._width,n))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(n,u){return u?u.pointCoordinate(n)!=null:n.y>this.height/2-fe(this)}calculatePosMatrix(n,u=!1,f){var g;const b=(g=n.key)!==null&&g!==void 0?g:a.b3(n.wrap,n.canonical.z,n.canonical.z,n.canonical.x,n.canonical.y),S=u?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(b)){const z=S.get(b);return f?z.f32:z.f64}const $=be(n,this.worldSize);a.O($,u?this._alignedProjMatrix:this._viewProjMatrix,$);const M={f64:$,f32:new Float32Array($)};return S.set(b,M),f?M.f32:M.f64}calculateFogMatrix(n){const u=n.key,f=this._fogMatrixCacheF32;if(f.has(u))return f.get(u);const g=be(n,this.worldSize);return a.O(g,this._fogMatrix,g),f.set(u,new Float32Array(g)),f.get(u)}getConstrained(n,u){u=a.ah(+u,this.minZoom,this.maxZoom);const f={center:new a.S(n.lng,n.lat),zoom:u};let g=this._helper._lngRange;if(!this._helper._renderWorldCopies&&g===null){const ce=179.9999999999;g=[-ce,ce]}const b=this.tileSize*a.af(f.zoom);let S=0,$=b,M=0,z=b,F=0,j=0;const{x:B,y:V}=this.size;if(this._helper._latRange){const ce=this._helper._latRange;S=a.U(ce[1])*b,$=a.U(ce[0])*b,$-S<V&&(F=V/($-S))}g&&(M=a.aO(a.V(g[0])*b,0,b),z=a.aO(a.V(g[1])*b,0,b),z<M&&(z+=b),z-M<B&&(j=B/(z-M)));const{x:W,y:te}=K(b,n);let ee,ie;const se=Math.max(j||0,F||0);if(se){const ce=new a.P(j?(z+M)/2:W,F?($+S)/2:te);return f.center=le(b,ce).wrap(),f.zoom+=a.ak(se),f}if(this._helper._latRange){const ce=V/2;te-ce<S&&(ie=S+ce),te+ce>$&&(ie=$-ce)}if(g){const ce=(M+z)/2;let oe=W;this._helper._renderWorldCopies&&(oe=a.aO(W,ce-b/2,ce+b/2));const he=B/2;oe-he<M&&(ee=M+he),oe+he>z&&(ee=z-he)}if(ee!==void 0||ie!==void 0){const ce=new a.P(ee??W,ie??te);f.center=le(b,ce).wrap()}return f}calculateCenterFromCameraLngLatAlt(n,u,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,f,g)}_calculateNearFarZIfNeeded(n,u,f){if(!this._helper.autoCalculateNearFarZ)return;const g=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),b=n-g*this._helper._pixelPerMeter/Math.cos(u),S=g<0?b:n,$=Math.PI/2+this.pitchInRadians,M=a.ae(this.fov)*(Math.abs(Math.cos(a.ae(this.roll)))*this.height+Math.abs(Math.sin(a.ae(this.roll)))*this.width)/this.height*(.5+f.y/this.height),z=Math.sin(M)*S/Math.sin(a.ah(Math.PI-$-M,.01,Math.PI-.01)),F=fe(this),j=Math.atan(F/this._helper.cameraToCenterDistance),B=a.ae(.75),V=j>B?2*j*(.5+f.y/(2*F)):B,W=Math.sin(V)*S/Math.sin(a.ah(Math.PI-$-V,.01,Math.PI-.01)),te=Math.min(z,W);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*te+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const n=this.centerOffset,u=K(this.worldSize,this.center),f=u.x,g=u.y;this._helper._pixelPerMeter=a.aj(1,this.center.lat)*this.worldSize;const b=a.ae(Math.min(this.pitch,J)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(b));let $;this._calculateNearFarZIfNeeded(S,b,n),$=new Float64Array(16),a.b4($,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.aq(this._invProjMatrix,$),$[8]=2*-n.x/this._helper._width,$[9]=2*n.y/this._helper._height,this._projectionMatrix=a.b5($),a.N($,$,[1,-1,1]),a.M($,$,[0,0,-this._helper.cameraToCenterDistance]),a.b6($,$,-this.rollInRadians),a.b7($,$,this.pitchInRadians),a.b6($,$,-this.bearingInRadians),a.M($,$,[-f,-g,0]),this._mercatorMatrix=a.N([],$,[this.worldSize,this.worldSize,this.worldSize]),a.N($,$,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,$),a.M($,$,[0,0,-this.elevation]),this._viewProjMatrix=$,this._invViewProjMatrix=a.aq([],$);const M=[0,0,-1,1];a.aw(M,M,this._invViewProjMatrix),this._cameraPosition=[M[0]/M[3],M[1]/M[3],M[2]/M[3]],this._fogMatrix=new Float64Array(16),a.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-n.x/this.width,this._fogMatrix[9]=2*n.y/this.height,a.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.M(this._fogMatrix,this._fogMatrix,[-f,-g,0]),a.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,$);const z=this._helper._width%2/2,F=this._helper._height%2/2,j=Math.cos(this.bearingInRadians),B=Math.sin(-this.bearingInRadians),V=f-Math.round(f)+j*z+B*F,W=g-Math.round(g)+j*F+B*z,te=new Float64Array($);if(a.M(te,te,[V>.5?V-1:V,W>.5?W-1:W,0]),this._alignedProjMatrix=te,$=a.aq(new Float64Array(16),this._pixelMatrix),!$)throw new Error("failed to invert matrix");this._pixelMatrixInverse=$,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const n=this.screenPointToMercatorCoordinate(new a.P(0,0)),u=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.aw(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const n=a.aj(1,this.center.lat)*this.worldSize;return Ae(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/n).toLngLat()}lngLatToCameraDepth(n,u){const f=a.a1.fromLngLat(n),g=[f.x*this.worldSize,f.y*this.worldSize,u,1];return a.aw(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(n){const{overscaledTileID:u,aligned:f,applyTerrainMatrix:g}=n,b=this._helper.getMercatorTileCoordinates(u),S=u?this.calculatePosMatrix(u,f,!0):null;let $;return $=u&&u.terrainRttPosMatrix32f&&g?u.terrainRttPosMatrix32f:S||a.b8(),{mainMatrix:$,tileMercatorCoords:b,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:$}}isLocationOccluded(n){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(n,u,f){return 1}transformLightDirection(n){return a.aT(n)}getRayDirectionFromPixel(n){throw new Error("Not implemented.")}projectTileCoordinates(n,u,f,g){const b=this.calculatePosMatrix(f);let S;g?(S=[n,u,g(n,u),1],a.aw(S,S,b)):(S=[n,u,0,1],Ic(S,S,b));const $=S[3];return{point:new a.P(S[0]/$,S[1]/$),signedDistanceFromCamera:$,isOccluded:!1}}populateCache(n){for(const u of n)this.calculatePosMatrix(u)}getMatrixForModel(n,u){const f=a.a1.fromLngLat(n,u),g=f.meterInMercatorCoordinateUnits(),b=a.b9();return a.M(b,b,[f.x,f.y,f.z]),a.b6(b,b,Math.PI),a.b7(b,b,Math.PI/2),a.N(b,b,[-g,g,g]),b}getProjectionDataForCustomLayer(n=!0){const u=new a.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:n}),g=be(u,this.worldSize);a.O(g,this._viewProjMatrix,g),f.tileMercatorCoords=[0,0,1,1];const b=[a.$,a.$,this.worldSize/this._helper.pixelsPerMeter],S=a.ba();return a.N(S,g,b),f.fallbackMatrix=S,f.mainMatrix=S,f}getFastPathSimpleProjectionMatrix(n){return this.calculatePosMatrix(n)}}function b_(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Cn(v){if(v.useSlerp)if(v.k<1){const n=a.bb(v.startEulerAngles.roll,v.startEulerAngles.pitch,v.startEulerAngles.bearing),u=a.bb(v.endEulerAngles.roll,v.endEulerAngles.pitch,v.endEulerAngles.bearing),f=new Float64Array(4);a.bc(f,n,u,v.k);const g=a.bd(f);v.tr.setRoll(g.roll),v.tr.setPitch(g.pitch),v.tr.setBearing(g.bearing)}else v.tr.setRoll(v.endEulerAngles.roll),v.tr.setPitch(v.endEulerAngles.pitch),v.tr.setBearing(v.endEulerAngles.bearing);else v.tr.setRoll(a.C.number(v.startEulerAngles.roll,v.endEulerAngles.roll,v.k)),v.tr.setPitch(a.C.number(v.startEulerAngles.pitch,v.endEulerAngles.pitch,v.k)),v.tr.setBearing(a.C.number(v.startEulerAngles.bearing,v.endEulerAngles.bearing,v.k))}function ts(v,n,u,f,g){const b=g.padding,S=K(g.worldSize,u.getNorthWest()),$=K(g.worldSize,u.getNorthEast()),M=K(g.worldSize,u.getSouthEast()),z=K(g.worldSize,u.getSouthWest()),F=a.ae(-f),j=S.rotate(F),B=$.rotate(F),V=M.rotate(F),W=z.rotate(F),te=new a.P(Math.max(j.x,B.x,W.x,V.x),Math.max(j.y,B.y,W.y,V.y)),ee=new a.P(Math.min(j.x,B.x,W.x,V.x),Math.min(j.y,B.y,W.y,V.y)),ie=te.sub(ee),se=(g.width-(b.left+b.right+n.left+n.right))/ie.x,ce=(g.height-(b.top+b.bottom+n.top+n.bottom))/ie.y;if(ce<0||se<0)return void b_();const oe=Math.min(a.ak(g.scale*Math.min(se,ce)),v.maxZoom),he=a.P.convert(v.offset),me=new a.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(a.ae(f)),ae=he.add(me).mult(g.scale/a.af(oe));return{center:le(g.worldSize,S.add(M).div(2).sub(ae)),zoom:oe,bearing:f}}class fn{get useGlobeControls(){return!1}handlePanInertia(n,u){const f=n.mag(),g=Math.abs(fe(u));return{easingOffset:n.mult(Math.min(.75*g/f,1)),easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(n,u){n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta),n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta)}handleMapControlsPan(n,u,f){n.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(f,n.around)}cameraForBoxAndBearing(n,u,f,g,b){return ts(n,u,f,g,b)}handleJumpToCenterZoom(n,u){n.zoom!==(u.zoom!==void 0?+u.zoom:n.zoom)&&n.setZoom(+u.zoom),u.center!==void 0&&n.setCenter(a.S.convert(u.center))}handleEaseTo(n,u){const f=n.zoom,g=n.padding,b={roll:n.roll,pitch:n.pitch,bearing:n.bearing},S={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},$=u.zoom!==void 0,M=!n.isPaddingEqual(u.padding);let z=!1;const F=$?+u.zoom:n.zoom;let j=n.centerPoint.add(u.offsetAsPoint);const B=n.screenPointToLocation(j),{center:V,zoom:W}=n.getConstrained(a.S.convert(u.center||B),F??f);Fd(n,V);const te=K(n.worldSize,B),ee=K(n.worldSize,V).sub(te),ie=a.af(W-f);return z=W!==f,{easeFunc:se=>{if(z&&n.setZoom(a.C.number(f,W,se)),a.be(b,S)||Cn({startEulerAngles:b,endEulerAngles:S,tr:n,k:se,useSlerp:b.roll!=S.roll}),M&&(n.interpolatePadding(g,u.padding,se),j=n.centerPoint.add(u.offsetAsPoint)),u.around)n.setLocationAtPoint(u.around,u.aroundPoint);else{const ce=a.af(n.zoom-f),oe=W>f?Math.min(2,ie):Math.max(.5,ie),he=Math.pow(oe,1-se),me=le(n.worldSize,te.add(ee.mult(se*he)).mult(ce));n.setLocationAtPoint(n.renderWorldCopies?me.wrap():me,j)}},isZooming:z,elevationCenter:V}}handleFlyTo(n,u){const f=u.zoom!==void 0,g=n.zoom,b=n.getConstrained(a.S.convert(u.center||u.locationAtOffset),f?+u.zoom:g),S=b.center,$=b.zoom;Fd(n,S);const M=K(n.worldSize,u.locationAtOffset),z=K(n.worldSize,S).sub(M),F=z.mag(),j=a.af($-g);let B;if(u.minZoom!==void 0){const V=Math.min(+u.minZoom,g,$),W=n.getConstrained(S,V).zoom;B=a.af(W-g)}return{easeFunc:(V,W,te,ee)=>{n.setZoom(V===1?$:g+a.ak(W));const ie=V===1?S:le(n.worldSize,M.add(z.mult(te)).mult(W));n.setLocationAtPoint(n.renderWorldCopies?ie.wrap():ie,ee)},scaleOfZoom:j,targetCenter:S,scaleOfMinZoom:B,pixelPathLength:F}}}class Li{constructor(n,u,f){this.blendFunction=n,this.blendColor=u,this.mask=f}}Li.Replace=[1,0],Li.disabled=new Li(Li.Replace,a.bf.transparent,[!1,!1,!1,!1]),Li.unblended=new Li(Li.Replace,a.bf.transparent,[!0,!0,!0,!0]),Li.alphaBlended=new Li([1,771],a.bf.transparent,[!0,!0,!0,!0]);const Pl=2305;class Mt{constructor(n,u,f){this.enable=n,this.mode=u,this.frontFace=f}}Mt.disabled=new Mt(!1,1029,Pl),Mt.backCCW=new Mt(!0,1029,Pl),Mt.frontCCW=new Mt(!0,1028,Pl);class Ft{constructor(n,u,f){this.func=n,this.mask=u,this.range=f}}Ft.ReadOnly=!1,Ft.ReadWrite=!0,Ft.disabled=new Ft(519,Ft.ReadOnly,[0,1]);const Wo=7680;class ci{constructor(n,u,f,g,b,S){this.test=n,this.ref=u,this.mask=f,this.fail=g,this.depthFail=b,this.pass=S}}ci.disabled=new ci({func:519,mask:0},0,0,Wo,Wo,Wo);const is=new WeakMap;function So(v){var n;if(is.has(v))return is.get(v);{const u=(n=v.getParameter(v.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return is.set(v,u),u}}class To{get awaitingQuery(){return!!this._readbackQueue}constructor(n){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=n;const u=n.context,f=u.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const g=new a.aL;g.emplaceBack(-1,-1),g.emplaceBack(2,-1),g.emplaceBack(-1,2);const b=new a.aN;b.emplaceBack(0,1,2),this._fullscreenTriangle=new El(u.createVertexBuffer(g,Ua.members),u.createIndexBuffer(b),a.aM.simpleSegment(0,0,g.length,b.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(f.TEXTURE1);const S=f.createTexture();f.bindTexture(f.TEXTURE_2D,S),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),So(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const n=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),n.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(n,u){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(n,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const n=this._cachedRenderContext.context,u=n.gl;n.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),n.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(n,u){const f=this._cachedRenderContext.context,g=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:a.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,g.TRIANGLES,Ft.disabled,ci.disabled,Li.unblended,Mt.disabled,((b,S)=>({u_input:b,u_output_expected:S}))(n,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&So(g)){g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.readBuffer(g.COLOR_ATTACHMENT0),g.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),g.bindBuffer(g.PIXEL_PACK_BUFFER,null);const b=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0);g.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:b}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const n=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&So(n)){const u=n.clientWaitSync(this._readbackQueue.sync,0,0);if(u===n.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===n.TIMEOUT_EXPIRED)return;n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),n.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=To._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(n){let u=0;return u+=n[0]/256,u+=n[1]/65536,u+=n[2]/16777216,n[3]<127&&(u=-u),u/128}}const Bd=a.$/128;function Um(v,n){const u=v.granularity!==void 0?Math.max(v.granularity,1):1,f=u+(v.generateBorders?2:0),g=u+(v.extendToNorthPole||v.generateBorders?1:0)+(v.extendToSouthPole||v.generateBorders?1:0),b=f+1,S=g+1,$=v.generateBorders?-1:0,M=v.generateBorders||v.extendToNorthPole?-1:0,z=u+(v.generateBorders?1:0),F=u+(v.generateBorders||v.extendToSouthPole?1:0),j=b*S,B=f*g*6,V=b*S>65536;if(V&&n==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const W=V||n==="32bit",te=new Int16Array(2*j);let ee=0;for(let ce=M;ce<=F;ce++)for(let oe=$;oe<=z;oe++){let he=oe/u*a.$;oe===-1&&(he=-Bd),oe===u+1&&(he=a.$+Bd);let me=ce/u*a.$;ce===-1&&(me=v.extendToNorthPole?a.bh:-Bd),ce===u+1&&(me=v.extendToSouthPole?a.bi:a.$+Bd),te[ee++]=he,te[ee++]=me}const ie=W?new Uint32Array(B):new Uint16Array(B);let se=0;for(let ce=0;ce<g;ce++)for(let oe=0;oe<f;oe++){const he=oe+1+ce*b,me=oe+(ce+1)*b,ae=oe+1+(ce+1)*b;ie[se++]=oe+ce*b,ie[se++]=me,ie[se++]=he,ie[se++]=he,ie[se++]=me,ie[se++]=ae}return{vertices:te.buffer.slice(0),indices:ie.buffer.slice(0),uses32bitIndices:W}}const Ac=new a.aK({fill:new a.bj(128,2),line:new a.bj(512,0),tile:new a.bj(128,32),stencil:new a.bj(128,1),circle:3});class Ju{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ls.projectionGlobe}get vertexShaderPreludeCode(){return Ls.projectionMercator.vertexSource}get subdivisionGranularity(){return Ac}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(n){this._errorMeasurement||(this._errorMeasurement=new To(n));const u=a.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,g=this._errorMeasurement.updateErrorLoop(u,f),b=L.now();g!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=g,this._errorMeasurementLastChangeTime=b);const S=Math.min(Math.max((b-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bl(S))}_getMeshKey(n){return`${n.granularity.toString(36)}_${n.generateBorders?"b":""}${n.extendToNorthPole?"n":""}${n.extendToSouthPole?"s":""}`}getMeshFromTileID(n,u,f,g,b){const S=(b==="stencil"?Ac.stencil:Ac.tile).getGranularityForZoomLevel(u.z);return this._getMesh(n,{granularity:S,generateBorders:f,extendToNorthPole:u.y===0&&g,extendToSouthPole:u.y===(1<<u.z)-1&&g})}_getMesh(n,u){const f=this._getMeshKey(u);if(f in this._tileMeshCache)return this._tileMeshCache[f];const g=(function(b,S){const $=Um(S,"16bit"),M=a.aL.deserialize({arrayBuffer:$.vertices,length:$.vertices.byteLength/2/2}),z=a.aN.deserialize({arrayBuffer:$.indices,length:$.indices.byteLength/2/3});return new El(b.createVertexBuffer(M,Ua.members),b.createIndexBuffer(z),a.aM.simpleSegment(0,0,M.length,z.length))})(n,u);return this._tileMeshCache[f]=g,g}recalculate(n){}hasTransition(){const n=L.now();let u=!1;return u=u||(n-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(n){this._errorQueryLatitudeDegrees=n}}const jd=new a.r({type:new a.D(a.v.projection.type)});class Ud extends a.E{constructor(n){super(),this._transitionable=new a.t(jd),this.setProjection(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0)),this._mercatorProjection=new Qt,this._verticalPerspectiveProjection=new Ju}get transitionState(){const n=this.properties.get("type");if(typeof n=="string"&&n==="mercator")return 0;if(typeof n=="string"&&n==="vertical-perspective")return 1;if(n instanceof a.bm){if(n.from==="vertical-perspective"&&n.to==="mercator")return 1-n.transition;if(n.from==="mercator"&&n.to==="vertical-perspective")return n.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(n){this._mercatorProjection.updateGPUdependent(n),this._verticalPerspectiveProjection.updateGPUdependent(n)}getMeshFromTileID(n,u,f,g,b){return this.currentProjection.getMeshFromTileID(n,u,f,g,b)}setProjection(n){this._transitionable.setValue("type",n?.type||"mercator")}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}setErrorQueryLatitudeDegrees(n){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(n),this._mercatorProjection.setErrorQueryLatitudeDegrees(n)}}function Vd(v){const n=Dc(v.worldSize,v.center.lat);return 2*Math.PI*n}function Fs(v,n,u,f,g){const b=1/(1<<g),S=n/a.$*b+f*b,$=a.bo((v/a.$*b+u*b)*Math.PI*2+Math.PI,2*Math.PI),M=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,z=Math.cos(M),F=new Float64Array(3);return F[0]=Math.sin($)*z,F[1]=Math.sin(M),F[2]=Math.cos($)*z,F}function Ur(v){return(function(n,u){const f=Math.cos(u),g=new Float64Array(3);return g[0]=Math.sin(n)*f,g[1]=Math.sin(u),g[2]=Math.cos(n)*f,g})(v.lng*Math.PI/180,v.lat*Math.PI/180)}function Dc(v,n){return v/(2*Math.PI)/Math.cos(n*Math.PI/180)}function Ku(v){const n=Math.asin(v[1])/Math.PI*180,u=Math.sqrt(v[0]*v[0]+v[2]*v[2]);if(u>1e-6){const f=v[0]/u,g=Math.acos(v[2]/u),b=(f>0?g:-g)/Math.PI*180;return new a.S(a.aO(b,-180,180),n)}return new a.S(0,n)}function Ml(v){return Math.cos(v*Math.PI/180)}function tr(v,n){const u=Ml(v),f=Ml(n);return a.ak(f/u)}function x_(v,n){const u=v.rotate(n.bearingInRadians),f=n.zoom+tr(n.center.lat,0),g=a.bk(1/Ml(n.center.lat),1/Ml(Math.min(Math.abs(n.center.lat),60)),a.bn(f,7,3,0,1)),b=360/Vd({worldSize:n.worldSize,center:{lat:n.center.lat}});return new a.S(n.center.lng-u.x*b*g,a.ah(n.center.lat+u.y*b,-a.ai,a.ai))}function Qu(v){const n=.5*v,u=Math.sin(n),f=Math.cos(n);return Math.log(u+f)-Math.log(f-u)}function Vm(v,n,u,f){const g=v.lat+u*f;if(Math.abs(u)>1){const b=(Math.sign(v.lat+u)!==Math.sign(v.lat)?-Math.abs(v.lat):Math.abs(v.lat))*Math.PI/180,S=Math.abs(v.lat+u)*Math.PI/180,$=Qu(b+f*(S-b)),M=Qu(b),z=Qu(S);return new a.S(v.lng+n*(($-M)/(z-M)),g)}return new a.S(v.lng+n*f,g)}class Kw{constructor(n){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=n}swapBuffers(){if(!this._hadAnyChanges)return;const n=this._cachePrevious;this._cachePrevious=this._cache,this._cache=n,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(n,u,f,g){const b=`${n.z}_${n.x}_${n.y}_${g?.terrain?"t":""}`,S=this._cache.get(b);if(S)return S;const $=this._cachePrevious.get(b);if($)return this._cache.set(b,$),$;const M=this._boundingVolumeFactory(n,u,f,g);return this._cache.set(b,M),this._hadAnyChanges=!0,M}}class zc{constructor(n,u,f,g){this.min=f,this.max=g,this.points=n,this.planes=u}static fromAabb(n,u){const f=[];for(let g=0;g<8;g++)f.push([1&~g?n[0]:u[0],(g>>1&1)==1?u[1]:n[1],(g>>2&1)==1?u[2]:n[2]]);return new zc(f,[[-1,0,0,u[0]],[1,0,0,-n[0]],[0,-1,0,u[1]],[0,1,0,-n[1]],[0,0,-1,u[2]],[0,0,1,-n[2]]],n,u)}static fromCenterSizeAngles(n,u,f){const g=a.br([],f[0],f[1],f[2]),b=a.bs([],[u[0],0,0],g),S=a.bs([],[0,u[1],0],g),$=a.bs([],[0,0,u[2]],g),M=[...n],z=[...n];for(let j=0;j<8;j++)for(let B=0;B<3;B++){const V=n[B]+b[B]*(1&~j?-1:1)+S[B]*((j>>1&1)==1?1:-1)+$[B]*((j>>2&1)==1?1:-1);M[B]=Math.min(M[B],V),z[B]=Math.max(z[B],V)}const F=[];for(let j=0;j<8;j++){const B=[...n];a.aS(B,B,a.aR([],b,1&~j?-1:1)),a.aS(B,B,a.aR([],S,(j>>1&1)==1?1:-1)),a.aS(B,B,a.aR([],$,(j>>2&1)==1?1:-1)),F.push(B)}return new zc(F,[[...b,-a.aX(b,F[0])],[...S,-a.aX(S,F[0])],[...$,-a.aX($,F[0])],[-b[0],-b[1],-b[2],-a.aX(b,F[7])],[-S[0],-S[1],-S[2],-a.aX(S,F[7])],[-$[0],-$[1],-$[2],-a.aX($,F[7])]],M,z)}intersectsFrustum(n){let u=!0;const f=this.points.length,g=this.planes.length,b=n.planes.length,S=n.points.length;for(let $=0;$<b;$++){const M=n.planes[$];let z=0;for(let F=0;F<f;F++){const j=this.points[F];M[0]*j[0]+M[1]*j[1]+M[2]*j[2]+M[3]>=0&&z++}if(z===0)return 0;z<f&&(u=!1)}if(u)return 2;for(let $=0;$<g;$++){const M=this.planes[$];let z=0;for(let F=0;F<S;F++){const j=n.points[F];M[0]*j[0]+M[1]*j[1]+M[2]*j[2]+M[3]>=0&&z++}if(z===0)return 0}return 1}intersectsPlane(n){const u=this.points.length;let f=0;for(let g=0;g<u;g++){const b=this.points[g];n[0]*b[0]+n[1]*b[1]+n[2]*b[2]+n[3]>=0&&f++}return f===u?2:f===0?0:1}}function sn(v,n,u){const f=v-n;return f<0?-f:Math.max(0,f-u)}function eh(v,n,u,f,g){const b=v-u;let S;return S=b<0?Math.min(-b,1+b-g):b>1?Math.min(Math.max(b-g,0),1-b):0,Math.max(S,sn(n,f,g))}class Co{constructor(){this._boundingVolumeCache=new Kw(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(n,u,f,g){const b=1<<f.z,S=1/b,$=f.x/b,M=f.y/b;let z=2;return z=Math.min(z,eh(n,u,$,M,S)),z=Math.min(z,eh(n,u,$+.5,-M-S,S)),z=Math.min(z,eh(n,u,$+.5,2-M-S,S)),z}getWrap(n,u,f){const g=1<<u.z,b=1/g,S=u.x/g,$=sn(n.x,S,b),M=sn(n.x,S-1,b),z=sn(n.x,S+1,b),F=Math.min($,M,z);return F===z?1:F===M?-1:0}allowVariableZoom(n,u){return St(n,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(n,u,f,g){return this._boundingVolumeCache.getTileBoundingVolume(n,u,f,g)}_computeTileBoundingVolume(n,u,f,g){var b,S;let $=0,M=0;if(g?.terrain){const z=new a.Z(n.z,u,n.z,n.x,n.y),F=g.terrain.getMinMaxElevation(z);$=(b=F.minElevation)!==null&&b!==void 0?b:Math.min(0,f),M=(S=F.maxElevation)!==null&&S!==void 0?S:Math.max(0,f)}if($/=a.bu,M/=a.bu,$+=1,M+=1,n.z<=0)return zc.fromAabb([-M,-M,-M],[M,M,M]);if(n.z===1)return zc.fromAabb([n.x===0?-M:0,n.y===0?0:-M,-M],[n.x===0?0:M,n.y===0?M:0,M]);{const z=[Fs(0,0,n.x,n.y,n.z),Fs(a.$,0,n.x,n.y,n.z),Fs(a.$,a.$,n.x,n.y,n.z),Fs(0,a.$,n.x,n.y,n.z)],F=[];for(const $e of z)F.push(a.aR([],$e,M));if(M!==$)for(const $e of z)F.push(a.aR([],$e,$));n.y===0&&F.push([0,1,0]),n.y===(1<<n.z)-1&&F.push([0,-1,0]);const j=[1,1,1],B=[-1,-1,-1];for(const $e of F)for(let De=0;De<3;De++)j[De]=Math.min(j[De],$e[De]),B[De]=Math.max(B[De],$e[De]);const V=Fs(a.$/2,a.$/2,n.x,n.y,n.z),W=a.aW([],[0,1,0],V);a.aV(W,W);const te=a.aW([],V,W);a.aV(te,te);const ee=a.aW([],z[2],z[1]);a.aV(ee,ee);const ie=a.aW([],z[0],z[3]);a.aV(ie,ie),F.push(a.aR([],V,M)),n.y>=(1<<n.z)/2&&F.push(a.aR([],Fs(a.$/2,0,n.x,n.y,n.z),M)),n.y<(1<<n.z)/2&&F.push(a.aR([],Fs(a.$/2,a.$,n.x,n.y,n.z),M));const se=th(V,F),ce=th(te,F),oe=[-V[0],-V[1],-V[2],se.max],he=[V[0],V[1],V[2],-se.min],me=[-te[0],-te[1],-te[2],ce.max],ae=[te[0],te[1],te[2],-ce.min],xe=[...ee,0],Oe=[...ie,0],Ie=[];return n.y===0?Ie.push(a.bt(Oe,xe,oe),a.bt(Oe,xe,he)):Ie.push(a.bt(me,xe,oe),a.bt(me,xe,he),a.bt(me,Oe,oe),a.bt(me,Oe,he)),n.y===(1<<n.z)-1?Ie.push(a.bt(Oe,xe,oe),a.bt(Oe,xe,he)):Ie.push(a.bt(ae,xe,oe),a.bt(ae,xe,he),a.bt(ae,Oe,oe),a.bt(ae,Oe,he)),new zc(Ie,[oe,he,me,ae,xe,Oe],j,B)}}}function th(v,n){let u=1/0,f=-1/0;for(const g of n){const b=a.aX(v,g);u=Math.min(u,b),f=Math.max(f,b)}return{min:u,max:f}}class ih{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,f){return this._helper.interpolatePadding(n,u,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u){this._helper.resize(n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n){}constructor(){this._cachedClippingPlane=a.bv(),this._projectionMatrix=a.b9(),this._globeViewProjMatrix32f=a.b8(),this._globeViewProjMatrixNoCorrection=a.b9(),this._globeViewProjMatrixNoCorrectionInverted=a.b9(),this._globeProjMatrixInverted=a.b9(),this._cameraPosition=a.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,u)=>this.getConstrained(n,u)}),this._coveringTilesDetailsProvider=new Co}clone(){const n=new ih;return n.apply(this),n}apply(n,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(n)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const n=a.bp();return n[0]=this._cameraPosition[0],n[1]=this._cameraPosition[1],n[2]=this._cameraPosition[2],n}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(n){const{overscaledTileID:u,applyGlobeMatrix:f}=n,g=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:g,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(n){const u=this.pitchInRadians,f=this.cameraToCenterDistance/n,g=Math.sin(u)*f,b=Math.cos(u)*f+1,S=1/Math.sqrt(g*g+b*b)*1;let $=-g,M=b;const z=Math.sqrt($*$+M*M);$/=z,M/=z;const F=[0,$,M];a.bw(F,F,[0,0,0],-this.bearingInRadians),a.bx(F,F,[0,0,0],-1*this.center.lat*Math.PI/180),a.by(F,F,[0,0,0],this.center.lng*Math.PI/180);const j=1/a.aZ(F);return a.aR(F,F,j),[...F,-S*j]}isLocationOccluded(n){return!this.isSurfacePointVisible(Ur(n))}transformLightDirection(n){const u=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,g=Math.cos(f),b=[Math.sin(u)*g,Math.sin(f),Math.cos(u)*g],S=[b[2],0,-b[0]],$=[0,0,0];a.aW($,S,b),a.aV(S,S),a.aV($,$);const M=[0,0,0];return a.aV(M,[S[0]*n[0]+$[0]*n[1]+b[0]*n[2],S[1]*n[0]+$[1]*n[1]+b[1]*n[2],S[2]*n[0]+$[2]*n[1]+b[2]*n[2]]),M}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(n,u,f){const g=(function($,M,z){const F=1/(1<<z.z);return new a.a1($/a.$*F+z.x*F,M/a.$*F+z.y*F)})(n,u,f.canonical),b=(S=g.y,[a.bo(g.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(b[1])}projectTileCoordinates(n,u,f,g){const b=f.canonical,S=Fs(n,u,b.x,b.y,b.z),$=1+(g?g(n,u):0)/a.bu,M=[S[0]*$,S[1]*$,S[2]*$,1];a.aw(M,M,this._globeViewProjMatrixNoCorrection);const z=this._cachedClippingPlane,F=z[0]*S[0]+z[1]*S[1]+z[2]*S[2]+z[3]<0;return{point:new a.P(M[0]/M[3],M[1]/M[3]),signedDistanceFromCamera:M[3],isOccluded:F}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const n=Dc(this.worldSize,this.center.lat),u=a.ba(),f=a.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*n),a.b4(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const g=this.centerOffset;u[8]=2*-g.x/this._helper._width,u[9]=2*g.y/this._helper._height,this._projectionMatrix=a.b5(u),this._globeProjMatrixInverted=a.ba(),a.aq(this._globeProjMatrixInverted,u),a.M(u,u,[0,0,-this.cameraToCenterDistance]),a.b6(u,u,this.rollInRadians),a.b7(u,u,-this.pitchInRadians),a.b6(u,u,this.bearingInRadians),a.M(u,u,[0,0,-n]);const b=a.bp();b[0]=n,b[1]=n,b[2]=n,a.b7(f,u,this.center.lat*Math.PI/180),a.bz(f,f,-this.center.lng*Math.PI/180),a.N(f,f,b),this._globeViewProjMatrixNoCorrection=f,a.b7(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bz(u,u,-this.center.lng*Math.PI/180),a.N(u,u,b),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=a.ba(),a.aq(this._globeViewProjMatrixNoCorrectionInverted,f);const S=a.bp();this._cameraPosition=a.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/n,a.bw(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),a.bx(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),a.bw(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),a.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bx(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),a.by(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(n);const $=a.b5(this._globeViewProjMatrixNoCorrectionInverted);a.N($,$,[1,1,-1]),this._cachedFrustum=gr.fromInvProjectionMatrix($,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(n){a.w("calculateFogMatrix is not supported on globe projection.");const u=a.ba();return a.ag(u),u}getVisibleUnwrappedCoordinates(n){return[new a.b2(0,n)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){n&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=Ur(n);a.aR(f,f,1+u/a.bu);const g=a.bv();return a.aw(g,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(n){}getBounds(){const n=.5*this.width,u=.5*this.height,f=[new a.P(0,0),new a.P(n,0),new a.P(this.width,0),new a.P(this.width,u),new a.P(this.width,this.height),new a.P(n,this.height),new a.P(0,this.height),new a.P(0,u)],g=[];for(const j of f)g.push(this.unprojectScreenPoint(j));let b=0,S=0,$=0,M=0;const z=this.center;for(const j of g){const B=a.bA(z.lng,j.lng),V=a.bA(z.lat,j.lat);B<S&&(S=B),B>b&&(b=B),V<M&&(M=V),V>$&&($=V)}const F=[z.lng+S,z.lat+M,z.lng+b,z.lat+$];return this.isSurfacePointOnScreen([0,1,0])&&(F[3]=90,F[0]=-180,F[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(F[1]=-90,F[0]=-180,F[2]=180),new Qi(F)}getConstrained(n,u){const f=a.ah(n.lat,-a.ai,a.ai),g=a.ah(+u,this.minZoom+tr(0,f),this.maxZoom);return{center:new a.S(n.lng,f),zoom:g}}calculateCenterFromCameraLngLatAlt(n,u,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,f,g)}setLocationAtPoint(n,u){const f=Ur(this.unprojectScreenPoint(u)),g=Ur(n),b=a.bp();a.bB(b);const S=a.bp();a.by(S,f,b,-this.center.lng*Math.PI/180),a.bx(S,S,b,this.center.lat*Math.PI/180);const $=g[0]*g[0]+g[2]*g[2],M=S[0]*S[0];if($<M)return;const z=Math.sqrt($-M),F=-z,j=a.bC(g[0],g[2],S[0],z),B=a.bC(g[0],g[2],S[0],F),V=a.bp();a.by(V,g,b,-j);const W=a.bC(V[1],V[2],S[1],S[2]),te=a.bp();a.by(te,g,b,-B);const ee=a.bC(te[1],te[2],S[1],S[2]),ie=.5*Math.PI,se=W>=-ie&&W<=ie,ce=ee>=-ie&&ee<=ie;let oe,he;if(se&&ce){const Oe=this.center.lng*Math.PI/180,Ie=this.center.lat*Math.PI/180;a.bD(j,Oe)+a.bD(W,Ie)<a.bD(B,Oe)+a.bD(ee,Ie)?(oe=j,he=W):(oe=B,he=ee)}else if(se)oe=j,he=W;else{if(!ce)return;oe=B,he=ee}const me=oe/Math.PI*180,ae=he/Math.PI*180,xe=this.center.lat;this.setCenter(new a.S(me,a.ah(ae,-90,90))),this.setZoom(this.zoom+tr(xe,this.center.lat))}locationToScreenPoint(n,u){const f=Ur(n);if(u){const g=u.getElevationForLngLatZoom(n,this._helper._tileZoom);a.aR(f,f,1+g/a.bu)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(n){const u=a.bv();return a.aw(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new a.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(n,u){if(u){const f=u.pointCoordinate(n);if(f)return f}return a.a1.fromLngLat(this.unprojectScreenPoint(n))}screenPointToLocation(n,u){var f;return(f=this.screenPointToMercatorCoordinate(n,u))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(n,u){const f=this._cameraPosition,g=this.getRayDirectionFromPixel(n);return!!this.rayPlanetIntersection(f,g)}getRayDirectionFromPixel(n){const u=a.bv();u[0]=n.x/this.width*2-1,u[1]=-1*(n.y/this.height*2-1),u[2]=1,u[3]=1,a.aw(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const f=a.bp();f[0]=u[0]-this._cameraPosition[0],f[1]=u[1]-this._cameraPosition[1],f[2]=u[2]-this._cameraPosition[2];const g=a.bp();return a.aV(g,f),g}isSurfacePointVisible(n){const u=this._cachedClippingPlane;return u[0]*n[0]+u[1]*n[1]+u[2]*n[2]+u[3]>=0}isSurfacePointOnScreen(n){if(!this.isSurfacePointVisible(n))return!1;const u=a.bv();return a.aw(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(n,u){const f=a.aX(n,u),g=a.bp(),b=a.bp();a.aR(b,u,f),a.aU(g,n,b);const S=1-a.aX(g,g);if(S<0)return null;const $=a.aX(n,n)-1,M=-f+(f<0?1:-1)*Math.sqrt(S),z=$/M,F=M;return{tMin:Math.min(z,F),tMax:Math.max(z,F)}}unprojectScreenPoint(n){const u=this._cameraPosition,f=this.getRayDirectionFromPixel(n),g=this.rayPlanetIntersection(u,f);if(g){const F=a.bp();a.aS(F,u,[f[0]*g.tMin,f[1]*g.tMin,f[2]*g.tMin]);const j=a.bp();return a.aV(j,F),Ku(j)}const b=this._cachedClippingPlane,S=b[0]*f[0]+b[1]*f[1]+b[2]*f[2],$=-a.b1(b,u)/S,M=a.bp();if($>0)a.aS(M,u,[f[0]*$,f[1]*$,f[2]*$]);else{const F=a.bp();a.aS(F,u,[2*f[0],2*f[1],2*f[2]]);const j=a.b1(this._cachedClippingPlane,F);a.aU(M,F,[this._cachedClippingPlane[0]*j,this._cachedClippingPlane[1]*j,this._cachedClippingPlane[2]*j])}const z=(function(F){const j=a.bp();return j[0]=F[0]*-F[3],j[1]=F[1]*-F[3],j[2]=F[2]*-F[3],{center:j,radius:Math.sqrt(1-F[3]*F[3])}})(b);return Ku((function(F,j,B){const V=a.bp();a.aU(V,B,F);const W=a.bp();return a.bq(W,F,V,j/a.a$(V)),W})(z.center,z.radius,M))}getMatrixForModel(n,u){const f=a.S.convert(n),g=1/a.bu,b=a.b9();return a.bz(b,b,f.lng/180*Math.PI),a.b7(b,b,-f.lat/180*Math.PI),a.M(b,b,[0,0,1+u/a.bu]),a.b7(b,b,.5*Math.PI),a.N(b,b,[g,g,g]),b}getProjectionDataForCustomLayer(n=!0){const u=this.getProjectionData({overscaledTileID:new a.Z(0,0,0,0,0),applyGlobeMatrix:n});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(n){}}class rh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,f){return this._helper.interpolatePadding(n,u,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,f=!0){this._helper.resize(n,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(n,u){this._globeness=n,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,u)=>this.getConstrained(n,u)}),this._globeness=1,this._mercatorTransform=new $i,this._verticalPerspectiveTransform=new ih}clone(){const n=new rh;return n._globeness=this._globeness,n._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,n.apply(this),n}apply(n){this._helper.apply(n),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(n){const u=this._mercatorTransform.getProjectionData(n),f=this._verticalPerspectiveTransform.getProjectionData(n);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:u.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:n.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(n){return this.currentTransform.isLocationOccluded(n)}transformLightDirection(n){return this.currentTransform.transformLightDirection(n)}getPixelScale(){return a.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(n,u,f){const g=this._mercatorTransform.getPitchedTextCorrection(n,u,f),b=this._verticalPerspectiveTransform.getPitchedTextCorrection(n,u,f);return a.bk(g,b,this._globeness)}projectTileCoordinates(n,u,f,g){return this.currentTransform.projectTileCoordinates(n,u,f,g)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(n){return this.currentTransform.calculateFogMatrix(n)}getVisibleUnwrappedCoordinates(n){return this.currentTransform.getVisibleUnwrappedCoordinates(n)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(n){this._mercatorTransform.recalculateZoomAndCenter(n),this._verticalPerspectiveTransform.recalculateZoomAndCenter(n)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){return this.currentTransform.lngLatToCameraDepth(n,u)}populateCache(n){this._mercatorTransform.populateCache(n),this._verticalPerspectiveTransform.populateCache(n)}getBounds(){return this.currentTransform.getBounds()}getConstrained(n,u){return this.currentTransform.getConstrained(n,u)}calculateCenterFromCameraLngLatAlt(n,u,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,f,g)}setLocationAtPoint(n,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(n,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(n,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(n,u){return this.currentTransform.locationToScreenPoint(n,u)}screenPointToMercatorCoordinate(n,u){return this.currentTransform.screenPointToMercatorCoordinate(n,u)}screenPointToLocation(n,u){return this.currentTransform.screenPointToLocation(n,u)}isPointOnMapSurface(n,u){return this.currentTransform.isPointOnMapSurface(n,u)}getRayDirectionFromPixel(n){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(n)}getMatrixForModel(n,u){return this.currentTransform.getMatrixForModel(n,u)}getProjectionDataForCustomLayer(n=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(n);if(!this.isGlobeRendering)return u;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(n);return f.fallbackMatrix=u.mainMatrix,f}getFastPathSimpleProjectionMatrix(n){return this.currentTransform.getFastPathSimpleProjectionMatrix(n)}}class mn{get useGlobeControls(){return!0}handlePanInertia(n,u){const f=x_(n,u);return Math.abs(f.lng-u.center.lng)>180&&(f.lng=u.center.lng+179.5*Math.sign(f.lng-u.center.lng)),{easingCenter:f,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(n,u){const f=n.around,g=u.screenPointToLocation(f);n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta);const b=u.zoom;n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta);const S=u.zoom-b;if(S===0)return;const $=a.bA(u.center.lng,g.lng),M=$/(Math.abs($/180)+1),z=a.bA(u.center.lat,g.lat),F=u.getRayDirectionFromPixel(f),j=u.cameraPosition,B=-1*a.aX(j,F),V=a.bp();a.aS(V,j,[F[0]*B,F[1]*B,F[2]*B]);const W=a.aZ(V)-1,te=Math.exp(.5*-Math.max(W-.3,0)),ee=Dc(u.worldSize,u.center.lat)/Math.min(u.width,u.height),ie=a.bn(ee,.9,.5,1,.25),se=(1-a.af(-S))*Math.min(te,ie),ce=u.center.lat,oe=u.zoom,he=new a.S(u.center.lng+M*se,a.ah(u.center.lat+z*se,-a.ai,a.ai));u.setLocationAtPoint(g,f);const me=u.center,ae=a.bn(Math.abs($),45,85,0,1),xe=a.bn(ee,.75,.35,0,1),Oe=Math.pow(Math.max(ae,xe),.25),Ie=a.bA(me.lng,he.lng),$e=a.bA(me.lat,he.lat);u.setCenter(new a.S(me.lng+Ie*Oe,me.lat+$e*Oe).wrap()),u.setZoom(oe+tr(ce,u.center.lat))}handleMapControlsPan(n,u,f){if(!n.panDelta)return;const g=u.center.lat,b=u.zoom;u.setCenter(x_(n.panDelta,u).wrap()),u.setZoom(b+tr(g,u.center.lat))}cameraForBoxAndBearing(n,u,f,g,b){const S=ts(n,u,f,g,b),$=u.left/b.width*2-1,M=(b.width-u.right)/b.width*2-1,z=u.top/b.height*-2+1,F=(b.height-u.bottom)/b.height*-2+1,j=a.bA(f.getWest(),f.getEast())<0,B=j?f.getEast():f.getWest(),V=j?f.getWest():f.getEast(),W=Math.max(f.getNorth(),f.getSouth()),te=Math.min(f.getNorth(),f.getSouth()),ee=B+.5*a.bA(B,V),ie=W+.5*a.bA(W,te),se=b.clone();se.setCenter(S.center),se.setBearing(S.bearing),se.setPitch(0),se.setRoll(0),se.setZoom(S.zoom);const ce=se.modelViewProjectionMatrix,oe=[Ur(f.getNorthWest()),Ur(f.getNorthEast()),Ur(f.getSouthWest()),Ur(f.getSouthEast()),Ur(new a.S(V,ie)),Ur(new a.S(B,ie)),Ur(new a.S(ee,W)),Ur(new a.S(ee,te))],he=Ur(S.center);let me=Number.POSITIVE_INFINITY;for(const ae of oe)$<0&&(me=mn.getLesserNonNegativeNonNull(me,mn.solveVectorScale(ae,he,ce,"x",$))),M>0&&(me=mn.getLesserNonNegativeNonNull(me,mn.solveVectorScale(ae,he,ce,"x",M))),z>0&&(me=mn.getLesserNonNegativeNonNull(me,mn.solveVectorScale(ae,he,ce,"y",z))),F<0&&(me=mn.getLesserNonNegativeNonNull(me,mn.solveVectorScale(ae,he,ce,"y",F)));if(Number.isFinite(me)&&me!==0)return S.zoom=se.zoom+a.ak(me),S;b_()}handleJumpToCenterZoom(n,u){const f=n.center.lat,g=n.getConstrained(u.center?a.S.convert(u.center):n.center,n.zoom).center;n.setCenter(g.wrap());const b=u.zoom!==void 0?+u.zoom:n.zoom+tr(f,g.lat);n.zoom!==b&&n.setZoom(b)}handleEaseTo(n,u){const f=n.zoom,g=n.center,b=n.padding,S={roll:n.roll,pitch:n.pitch,bearing:n.bearing},$={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},M=u.zoom!==void 0,z=!n.isPaddingEqual(u.padding);let F=!1;const j=u.center?a.S.convert(u.center):g,B=n.getConstrained(j,f).center;Fd(n,B);const V=n.clone();V.setCenter(B),V.setZoom(M?+u.zoom:f+tr(g.lat,j.lat)),V.setBearing(u.bearing);const W=new a.P(a.ah(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),a.ah(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));V.setLocationAtPoint(B,W);const te=(u.offset&&u.offsetAsPoint.mag())>0?V.center:B,ee=M?+u.zoom:f+tr(g.lat,te.lat),ie=f+tr(g.lat,0),se=ee+tr(te.lat,0),ce=a.bA(g.lng,te.lng),oe=a.bA(g.lat,te.lat),he=a.af(se-ie);return F=ee!==f,{easeFunc:me=>{if(a.be(S,$)||Cn({startEulerAngles:S,endEulerAngles:$,tr:n,k:me,useSlerp:S.roll!=$.roll}),z&&n.interpolatePadding(b,u.padding,me),u.around)a.w("Easing around a point is not supported under globe projection."),n.setLocationAtPoint(u.around,u.aroundPoint);else{const ae=se>ie?Math.min(2,he):Math.max(.5,he),xe=Math.pow(ae,1-me),Oe=Vm(g,ce,oe,me*xe);n.setCenter(Oe.wrap())}if(F){const ae=a.C.number(ie,se,me)+tr(0,n.center.lat);n.setZoom(ae)}},isZooming:F,elevationCenter:te}}handleFlyTo(n,u){const f=u.zoom!==void 0,g=n.center,b=n.zoom,S=n.padding,$=!n.isPaddingEqual(u.padding),M=n.getConstrained(a.S.convert(u.center||u.locationAtOffset),b).center,z=f?+u.zoom:n.zoom+tr(n.center.lat,M.lat),F=n.clone();F.setCenter(M),F.setZoom(z),F.setBearing(u.bearing);const j=new a.P(a.ah(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),a.ah(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));F.setLocationAtPoint(M,j);const B=F.center;Fd(n,B);const V=(function(oe,he,me){const ae=Ur(he),xe=Ur(me),Oe=a.aX(ae,xe),Ie=Math.acos(Oe),$e=Vd(oe);return Ie/(2*Math.PI)*$e})(n,g,B),W=b+tr(g.lat,0),te=z+tr(B.lat,0),ee=a.af(te-W);let ie;if(typeof u.minZoom=="number"){const oe=+u.minZoom+tr(B.lat,0),he=Math.min(oe,W,te)+tr(0,B.lat),me=n.getConstrained(B,he).zoom+tr(B.lat,0);ie=a.af(me-W)}const se=a.bA(g.lng,B.lng),ce=a.bA(g.lat,B.lat);return{easeFunc:(oe,he,me,ae)=>{const xe=Vm(g,se,ce,me);$&&n.interpolatePadding(S,u.padding,oe);const Oe=oe===1?B:xe;n.setCenter(Oe.wrap());const Ie=W+a.ak(he);n.setZoom(oe===1?z:Ie+tr(0,Oe.lat))},scaleOfZoom:ee,targetCenter:B,scaleOfMinZoom:ie,pixelPathLength:V}}static solveVectorScale(n,u,f,g,b){const S=g==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],$=[f[3],f[7],f[11],f[15]],M=n[0]*S[0]+n[1]*S[1]+n[2]*S[2],z=n[0]*$[0]+n[1]*$[1]+n[2]*$[2],F=u[0]*S[0]+u[1]*S[1]+u[2]*S[2],j=u[0]*$[0]+u[1]*$[1]+u[2]*$[2];return F+b*z===M+b*j||$[3]*(M-F)+S[3]*(j-z)+M*j==F*z?null:(F+S[3]-b*j-b*$[3])/(F-M-b*j+b*z)}static getLesserNonNegativeNonNull(n,u){return u!==null&&u>=0&&u<n?u:n}}class w_{constructor(n){this._globe=n,this._mercatorCameraHelper=new fn,this._verticalPerspectiveCameraHelper=new mn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(n,u){return this.currentHelper.handlePanInertia(n,u)}handleMapControlsRollPitchBearingZoom(n,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(n,u)}handleMapControlsPan(n,u,f){this.currentHelper.handleMapControlsPan(n,u,f)}cameraForBoxAndBearing(n,u,f,g,b){return this.currentHelper.cameraForBoxAndBearing(n,u,f,g,b)}handleJumpToCenterZoom(n,u){this.currentHelper.handleJumpToCenterZoom(n,u)}handleEaseTo(n,u){return this.currentHelper.handleEaseTo(n,u)}handleFlyTo(n,u){return this.currentHelper.handleFlyTo(n,u)}}const Gd=(v,n)=>a.y(v,n&&n.filter((u=>u.identifier!=="source.canvas"))),Qw=a.bE();class Gm extends a.E{constructor(n,u={}){var f,g;super(),this._rtlPluginLoaded=()=>{for(const S in this.sourceCaches){const $=this.sourceCaches[S].getSource().type;$!=="vector"&&$!=="geojson"||this.sourceCaches[S].reload()}},this.map=n,this.dispatcher=new rn(Qn(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",((S,$)=>this.getGlyphs(S,$))),this.dispatcher.registerMessageHandler("GI",((S,$)=>this.getImages(S,$))),this.imageManager=new mt,this.imageManager.setEventedParent(this);const b=((f=n._container)===null||f===void 0?void 0:f.lang)||typeof document<"u"&&((g=document.documentElement)===null||g===void 0?void 0:g.lang)||void 0;this.glyphManager=new Ce(n._requestManager,u.localIdeographFontFamily,b),this.lineAtlas=new rt(256,512),this.crossTileSymbolIndex=new kc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",a.bG()),Ra().on(Tl,this._rtlPluginLoaded),this.on("data",(S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const $=this.sourceCaches[S.sourceId];if(!$)return;const M=$.getSource();if(M&&M.vectorLayerIds)for(const z in this._layers){const F=this._layers[z];F.source===M.id&&this._validateLayer(F)}}))}setGlobalStateProperty(n,u){var f,g,b;this._checkLoaded();const S=u===null?(b=(g=(f=this.stylesheet.state)===null||f===void 0?void 0:f[n])===null||g===void 0?void 0:g.default)!==null&&b!==void 0?b:null:u;if(a.bH(S,this._globalState[n]))return this;this._globalState[n]=S,this._applyGlobalStateChanges([n])}getGlobalState(){return this._globalState}setGlobalState(n){this._checkLoaded();const u=[];for(const f in n)!a.bH(this._globalState[f],n[f].default)&&(u.push(f),this._globalState[f]=n[f].default);this._applyGlobalStateChanges(u)}_applyGlobalStateChanges(n){if(n.length===0)return;const u=new Set;for(const f in this._layers){const g=this._layers[f],b=g.getLayoutAffectingGlobalStateRefs(),S=g.getPaintAffectingGlobalStateRefs();for(const $ of n)if(b.has($)&&u.add(g.source),S.has($))for(const{name:M,value:z}of S.get($))this._updatePaintProperty(g,M,z)}for(const f in this.sourceCaches)u.has(f)&&(this._reloadSource(f),this._changed=!0)}loadURL(n,u={},f){this.fire(new a.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const g=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const b=this._loadStyleRequest;a.j(g,this._loadStyleRequest).then((S=>{this._loadStyleRequest=null,this._load(S.data,u,f)})).catch((S=>{this._loadStyleRequest=null,S&&!b.signal.aborted&&this.fire(new a.k(S))}))}loadJSON(n,u={},f){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,L.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(n,u,f)})).catch((()=>{}))}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(Qw,{validate:!1})}_load(n,u,f){var g,b;let S=u.transformStyle?u.transformStyle(f,n):n;if(!u.validate||!Gd(this,a.z(S))){S=Object.assign({},S),this._loaded=!0,this.stylesheet=S;for(const $ in S.sources)this.addSource($,S.sources[$],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new _t(this.stylesheet.light),this._setProjectionInternal(((g=this.stylesheet.projection)===null||g===void 0?void 0:g.type)||"mercator"),this.sky=new nt(this.stylesheet.sky),this.map.setTerrain((b=this.stylesheet.terrain)!==null&&b!==void 0?b:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){var n;const u=a.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",u),this._order=u.map((f=>f.id)),this._layers={},this.setGlobalState((n=this.stylesheet.state)!==null&&n!==void 0?n:null),this._serializedLayers=null;for(const f of u){const g=a.bJ(f);g.setEventedParent(this,{layer:{id:f.id}}),g.setGlobalState(this._globalState),this._layers[f.id]=g}}_loadSprite(n,u=!1,f=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(b,S,$,M){return a._(this,void 0,void 0,(function*(){const z=Je(b),F=$>1?"@2x":"",j={},B={};for(const{id:V,url:W}of z){const te=S.transformRequest(Xe(W,F,".json"),"SpriteJSON");j[V]=a.j(te,M);const ee=S.transformRequest(Xe(W,F,".png"),"SpriteImage");B[V]=Re.getImage(ee,M)}return yield Promise.all([...Object.values(j),...Object.values(B)]),(function(V,W){return a._(this,void 0,void 0,(function*(){const te={};for(const ee in V){te[ee]={};const ie=L.getImageCanvasContext((yield W[ee]).data),se=(yield V[ee]).data;for(const ce in se){const{width:oe,height:he,x:me,y:ae,sdf:xe,pixelRatio:Oe,stretchX:Ie,stretchY:$e,content:De,textFitWidth:Ke,textFitHeight:it}=se[ce];te[ee][ce]={data:null,pixelRatio:Oe,sdf:xe,stretchX:Ie,stretchY:$e,content:De,textFitWidth:Ke,textFitHeight:it,spriteData:{width:oe,height:he,x:me,y:ae,context:ie}}}}return te}))})(j,B)}))})(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((b=>{if(this._spriteRequest=null,b)for(const S in b){this._spritesImagesIds[S]=[];const $=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter((M=>!(M in b))):[];for(const M of $)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in b[S]){const z=S==="default"?M:`${S}:${M}`;this._spritesImagesIds[S].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,b[S][M],!1):this.imageManager.addImage(z,b[S][M]),u&&(this._changedImages[z]=!0)}}})).catch((b=>{this._spriteRequest=null,g=b,this.fire(new a.k(g))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),f&&f(g)}))}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(n){const u=this.sourceCaches[n.source];if(!u)return;const f=n.sourceLayer;if(!f)return;const g=u.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(f)===-1)&&this.fire(new a.k(new Error(`Source layer "${f}" does not exist on source "${g.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,u=!1){const f=this._serializedAllLayers();if(!n||n.length===0)return Object.values(u?a.bK(f):f);const g=[];for(const b of n)if(f[b]){const S=u?a.bK(f[b]):f[b];g.push(S)}return g}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const u=Object.keys(this._layers);for(const f of u){const g=this._layers[f];g.type!=="custom"&&(n[f]=g.serialize())}return n}hasTransitions(){var n,u,f;if(!((n=this.light)===null||n===void 0)&&n.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const g in this.sourceCaches)if(this.sourceCaches[g].hasTransition())return!0;for(const g in this._layers)if(this._layers[g].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const u=this._changed;if(u){const g=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(g.length||b.length)&&this._updateWorkerLayers(g,b);for(const S in this._updatedSources){const $=this._updatedSources[S];if($==="reload")this._reloadSource(S);else{if($!=="clear")throw new Error(`Invalid action ${$}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const f={};for(const g in this.sourceCaches){const b=this.sourceCaches[g];f[g]=b.used,b.used=!1}for(const g of this._order){const b=this._layers[g];b.recalculate(n,this._availableImages),!b.isHidden(n.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(const g in f){const b=this.sourceCaches[g];!!f[g]!=!!b.used&&b.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(n),this.sky.recalculate(n),this.projection.recalculate(n),this.z=n.zoom,u&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,u={}){var f;this._checkLoaded();const g=this.serialize();if(n=u.transformStyle?u.transformStyle(g,n):n,((f=u.validate)===null||f===void 0||f)&&Gd(this,a.z(n)))return!1;(n=a.bK(n)).layers=a.bI(n.layers);const b=a.bL(g,n),S=this._getOperationsToPerform(b);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const $ of S.operations)$();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const u=[],f=[];for(const g of n)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push((()=>this.addLayer.apply(this,g.args)));break;case"removeLayer":u.push((()=>this.removeLayer.apply(this,g.args)));break;case"setPaintProperty":u.push((()=>this.setPaintProperty.apply(this,g.args)));break;case"setLayoutProperty":u.push((()=>this.setLayoutProperty.apply(this,g.args)));break;case"setFilter":u.push((()=>this.setFilter.apply(this,g.args)));break;case"addSource":u.push((()=>this.addSource.apply(this,g.args)));break;case"removeSource":u.push((()=>this.removeSource.apply(this,g.args)));break;case"setLayerZoomRange":u.push((()=>this.setLayerZoomRange.apply(this,g.args)));break;case"setLight":u.push((()=>this.setLight.apply(this,g.args)));break;case"setGeoJSONSourceData":u.push((()=>this.setGeoJSONSourceData.apply(this,g.args)));break;case"setGlyphs":u.push((()=>this.setGlyphs.apply(this,g.args)));break;case"setSprite":u.push((()=>this.setSprite.apply(this,g.args)));break;case"setTerrain":u.push((()=>this.map.setTerrain.apply(this,g.args)));break;case"setSky":u.push((()=>this.setSky.apply(this,g.args)));break;case"setProjection":this.setProjection.apply(this,g.args);break;case"setGlobalState":u.push((()=>this.setGlobalState.apply(this,g.args)));break;case"setTransition":u.push((()=>{}));break;default:f.push(g.command)}return{operations:u,unimplemented:f}}addImage(n,u){if(this.getImage(n))return this.fire(new a.k(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,u),this._afterImageUpdated(n)}updateImage(n,u){this.imageManager.updateImage(n,u)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new a.k(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,u,f={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.z.source,`sources.${n}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const g=this.sourceCaches[n]=new Xt(n,u,this.dispatcher);g.style=this,g.setEventedParent(this,(()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:n}))),g.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===n)return this.fire(new a.k(new Error(`Source "${n}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],u.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,u){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const f=this.sourceCaches[n].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,u,f={}){this._checkLoaded();const g=n.id;if(this.getLayer(g))return void this.fire(new a.k(new Error(`Layer "${g}" already exists on this map.`)));let b;if(n.type==="custom"){if(Gd(this,a.bM(n)))return;b=a.bJ(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(g,n.source),n=a.bK(n),n=a.e(n,{source:g})),this._validate(a.z.layer,`layers.${g}`,n,{arrayIndex:-1},f))return;b=a.bJ(n),this._validateLayer(b),b.setEventedParent(this,{layer:{id:g}})}const S=u?this._order.indexOf(u):this._order.length;if(u&&S===-1)this.fire(new a.k(new Error(`Cannot add layer "${g}" before non-existing layer "${u}".`)));else{if(this._order.splice(S,0,g),this._layerOrderChanged=!0,this._layers[g]=b,this._removedLayers[g]&&b.source&&b.type!=="custom"){const $=this._removedLayers[g];delete this._removedLayers[g],$.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(n,u){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new a.k(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===u)return;const f=this._order.indexOf(n);this._order.splice(f,1);const g=u?this._order.indexOf(u):this._order.length;u&&g===-1?this.fire(new a.k(new Error(`Cannot move layer "${n}" before non-existing layer "${u}".`))):(this._order.splice(g,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const u=this._layers[n];if(!u)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${n}".`)));u.setEventedParent(null);const f=this._order.indexOf(n);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=u,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],u.onRemove&&u.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,u,f){this._checkLoaded();const g=this.getLayer(n);g?g.minzoom===u&&g.maxzoom===f||(u!=null&&(g.minzoom=u),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,u,f={}){this._checkLoaded();const g=this.getLayer(n);if(g){if(!a.bH(g.filter,u))return u==null?(g.setFilter(void 0),void this._updateLayer(g)):void(this._validate(a.z.filter,`layers.${g.id}.filter`,u,null,f)||(g.setFilter(a.bK(u)),this._updateLayer(g)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return a.bK(this.getLayer(n).filter)}setLayoutProperty(n,u,f,g={}){this._checkLoaded();const b=this.getLayer(n);b?a.bH(b.getLayoutProperty(u),f)||(b.setLayoutProperty(u,f,g),this._updateLayer(b)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,u){const f=this.getLayer(n);if(f)return f.getLayoutProperty(u);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,u,f,g={}){this._checkLoaded();const b=this.getLayer(n);b?a.bH(b.getPaintProperty(u),f)||this._updatePaintProperty(b,u,f,g):this.fire(new a.k(new Error(`Cannot style non-existing layer "${n}".`)))}_updatePaintProperty(n,u,f,g={}){n.setPaintProperty(u,f,g)&&this._updateLayer(n),this._changed=!0,this._updatedPaintProps[n.id]=!0,this._serializedLayers=null}getPaintProperty(n,u){return this.getLayer(n).getPaintProperty(u)}setFeatureState(n,u){this._checkLoaded();const f=n.source,g=n.sourceLayer,b=this.sourceCaches[f];if(b===void 0)return void this.fire(new a.k(new Error(`The source '${f}' does not exist in the map's style.`)));const S=b.getSource().type;S==="geojson"&&g?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||g?(n.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),b.setFeatureState(g,n.id,u)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,u){this._checkLoaded();const f=n.source,g=this.sourceCaches[f];if(g===void 0)return void this.fire(new a.k(new Error(`The source '${f}' does not exist in the map's style.`)));const b=g.getSource().type,S=b==="vector"?n.sourceLayer:void 0;b!=="vector"||S?u&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(S,n.id,u):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const u=n.source,f=n.sourceLayer,g=this.sourceCaches[u];if(g!==void 0)return g.getSource().type!=="vector"||f?(n.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),g.getFeatureState(f,n.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=a.bN(this.sourceCaches,(b=>b.serialize())),u=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,g=this.stylesheet;return a.bO({version:g.version,name:g.name,metadata:g.metadata,light:g.light,sky:g.sky,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,projection:g.projection,sources:n,layers:u,terrain:f},(b=>b!==void 0))}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const u=S=>this._layers[S].type==="fill-extrusion",f={},g=[];for(let S=this._order.length-1;S>=0;S--){const $=this._order[S];if(u($)){f[$]=S;for(const M of n){const z=M[$];if(z)for(const F of z)g.push(F)}}}g.sort(((S,$)=>$.intersectionZ-S.intersectionZ));const b=[];for(let S=this._order.length-1;S>=0;S--){const $=this._order[S];if(u($))for(let M=g.length-1;M>=0;M--){const z=g[M].feature;if(f[z.layer.id]<S)break;b.push(z),g.pop()}else for(const M of n){const z=M[$];if(z)for(const F of z)b.push(F.feature)}}return b}queryRenderedFeatures(n,u,f){u&&u.filter&&this._validate(a.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const g={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const z of u.layers){const F=this._layers[z];if(!F)return this.fire(new a.k(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];g[F.source]=!0}}const b=[];u.availableImages=this._availableImages;const S=this._serializedAllLayers(),$=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,M=Object.assign(Object.assign({},u),{layers:$});for(const z in this.sourceCaches)u.layers&&!g[z]||b.push(Os(this.sourceCaches[z],this._layers,S,n,M,f,this.map.terrain?(F,j,B)=>this.map.terrain.getElevation(F,j,B):void 0));return this.placement&&b.push((function(z,F,j,B,V,W,te){const ee={},ie=W.queryRenderedSymbols(B),se=[];for(const ce of Object.keys(ie).map(Number))se.push(te[ce]);se.sort(wc);for(const ce of se){const oe=ce.featureIndex.lookupSymbolFeatures(ie[ce.bucketInstanceId],F,ce.bucketIndex,ce.sourceLayerIndex,V.filter,V.layers,V.availableImages,z);for(const he in oe){const me=ee[he]=ee[he]||[],ae=oe[he];ae.sort(((xe,Oe)=>{const Ie=ce.featureSortOrder;if(Ie){const $e=Ie.indexOf(xe.featureIndex);return Ie.indexOf(Oe.featureIndex)-$e}return Oe.featureIndex-xe.featureIndex}));for(const xe of ae)me.push(xe)}}return(function(ce,oe,he){for(const me in ce)for(const ae of ce[me])Sc(ae,he[oe[me].source]);return ce})(ee,z,j)})(this._layers,S,this.sourceCaches,n,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(n,u){u&&u.filter&&this._validate(a.z.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[n];return f?(function(g,b){const S=g.getRenderableIds().map((z=>g.getTileByID(z))),$=[],M={};for(let z=0;z<S.length;z++){const F=S[z],j=F.tileID.canonical.key;M[j]||(M[j]=!0,F.querySourceFeatures($,b))}return $})(f,u):[]}getLight(){return this.light.getLight()}setLight(n,u={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const S in n)if(!a.bH(n[S],f[S])){g=!0;break}if(!g)return;const b={now:L.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,u),this.light.updateTransitions(b)}getProjection(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.projection}setProjection(n){if(this._checkLoaded(),this.projection){if(this.projection.name===n.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=n,this._setProjectionInternal(n.type)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,u={}){this._checkLoaded();const f=this.getSky();let g=!1;if(!n&&!f)return;if(n&&!f)g=!0;else if(!n&&f)g=!0;else for(const S in n)if(!a.bH(n[S],f[S])){g=!0;break}if(!g)return;const b={now:L.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,u),this.sky.updateTransitions(b)}_setProjectionInternal(n){const u=(function(f){if(Array.isArray(f)){const g=new Ud({type:f});return{projection:g,transform:new rh,cameraHelper:new w_(g)}}switch(f){case"mercator":return{projection:new Qt,transform:new $i,cameraHelper:new fn};case"globe":{const g=new Ud({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:g,transform:new rh,cameraHelper:new w_(g)}}case"vertical-perspective":return{projection:new Ju,transform:new ih,cameraHelper:new mn};default:return a.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new Qt,transform:new $i,cameraHelper:new fn}}})(n);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(n,u,f,g,b={}){return(!b||b.validate!==!1)&&Gd(this,n.call(a.z,a.e({key:u,style:this.serialize(),value:f,styleSpec:a.v},g)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ra().off(Tl,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const u in this.sourceCaches)this.sourceCaches[u].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,u,f,g,b=!1){let S=!1,$=!1;const M={};for(const z of this._order){const F=this._layers[z];if(F.type!=="symbol")continue;if(!M[F.source]){const B=this.sourceCaches[F.source];M[F.source]=B.getRenderableIds(!0).map((V=>B.getTileByID(V))).sort(((V,W)=>W.tileID.overscaledZ-V.tileID.overscaledZ||(V.tileID.isLessThan(W.tileID)?-1:1)))}const j=this.crossTileSymbolIndex.addLayer(F,M[F.source],n.center.lng);S=S||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(L.now(),n.zoom))&&(this.pauseablePlacement=new Nm(n,this.map.terrain,this._order,b,u,f,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(L.now()),$=!0),S&&this.pauseablePlacement.placement.setStale()),$||S)for(const z of this._order){const F=this._layers[z];F.type==="symbol"&&this.placement.updateLayerOpacities(F,M[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(L.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,u){return a._(this,void 0,void 0,(function*(){const f=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,u.icons),f}))}getGlyphs(n,u){return a._(this,void 0,void 0,(function*(){const f=yield this.glyphManager.getGlyphs(u.stacks),g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,[""]),f}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,u={}){this._checkLoaded(),n&&this._validate(a.z.glyphs,"glyphs",n,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,u,f={},g){this._checkLoaded();const b=[{id:n,url:u}],S=[...Je(this.stylesheet.sprite),...b];this._validate(a.z.sprite,"sprite",S,null,f)||(this.stylesheet.sprite=S,this._loadSprite(b,!0,g))}removeSprite(n){this._checkLoaded();const u=Je(this.stylesheet.sprite);if(u.find((f=>f.id===n))){if(this._spritesImagesIds[n])for(const f of this._spritesImagesIds[n])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex((f=>f.id===n)),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return Je(this.stylesheet.sprite)}setSprite(n,u={},f){this._checkLoaded(),n&&this._validate(a.z.sprite,"sprite",n,null,u)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,f):(this._unloadSprite(),f&&f(null)))}}var e2=a.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class t2{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,u,f,g,b,S,$,M,z){this.context=n;let F=this.boundPaintVertexBuffers.length!==g.length;for(let j=0;!F&&j<g.length;j++)this.boundPaintVertexBuffers[j]!==g[j]&&(F=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||F||this.boundIndexBuffer!==b||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==$||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==z?this.freshBind(u,f,g,b,S,$,M,z):(n.bindVertexArray.set(this.vao),$&&$.bind(),b&&b.dynamicDraw&&b.bind(),M&&M.bind(),z&&z.bind())}freshBind(n,u,f,g,b,S,$,M){const z=n.numAttributes,F=this.context,j=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=$,this.boundDynamicVertexBuffer3=M,u.enableAttributes(j,n);for(const B of f)B.enableAttributes(j,n);S&&S.enableAttributes(j,n),$&&$.enableAttributes(j,n),M&&M.enableAttributes(j,n),u.bind(),u.setVertexAttribPointers(j,n,b);for(const B of f)B.bind(),B.setVertexAttribPointers(j,n,b);S&&(S.bind(),S.setVertexAttribPointers(j,n,b)),g&&g.bind(),$&&($.bind(),$.setVertexAttribPointers(j,n,b)),M&&(M.bind(),M.setVertexAttribPointers(j,n,b)),F.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const qd=(v,n,u,f,g)=>({u_texture:0,u_ele_delta:v,u_fog_matrix:n,u_fog_color:u?u.properties.get("fog-color"):a.bf.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?0:u?u.calculateFogBlendOpacity(f):0,u_horizon_color:u?u.properties.get("horizon-color"):a.bf.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:g?1:0}),qm={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function kl(v){const n=[];for(let u=0;u<v.length;u++){if(v[u]===null)continue;const f=v[u].split(" ");n.push(f.pop())}return n}class Hm{constructor(n,u,f,g,b,S,$,M,z=[]){const F=n.gl;this.program=F.createProgram();const j=kl(u.staticAttributes),B=f?f.getBinderAttributes():[],V=j.concat(B),W=Ls.prelude.staticUniforms?kl(Ls.prelude.staticUniforms):[],te=$.staticUniforms?kl($.staticUniforms):[],ee=u.staticUniforms?kl(u.staticUniforms):[],ie=f?f.getBinderUniforms():[],se=W.concat(te).concat(ee).concat(ie),ce=[];for(const Ie of se)ce.indexOf(Ie)<0&&ce.push(Ie);const oe=f?f.defines():[];So(F)&&oe.unshift("#version 300 es"),b&&oe.push("#define OVERDRAW_INSPECTOR;"),S&&oe.push("#define TERRAIN3D;"),M&&oe.push(M),z&&oe.push(...z);let he=oe.concat(Ls.prelude.fragmentSource,$.fragmentSource,u.fragmentSource).join(`
`),me=oe.concat(Ls.prelude.vertexSource,$.vertexSource,u.vertexSource).join(`
`);So(F)||(he=(function(Ie){return Ie.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(he),me=(function(Ie){return Ie.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(me));const ae=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(ae,he),F.compileShader(ae),!F.getShaderParameter(ae,F.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${F.getShaderInfoLog(ae)}`);F.attachShader(this.program,ae);const xe=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(xe,me),F.compileShader(xe),!F.getShaderParameter(xe,F.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${F.getShaderInfoLog(xe)}`);F.attachShader(this.program,xe),this.attributes={};const Oe={};this.numAttributes=V.length;for(let Ie=0;Ie<this.numAttributes;Ie++)V[Ie]&&(F.bindAttribLocation(this.program,Ie,V[Ie]),this.attributes[V[Ie]]=Ie);if(F.linkProgram(this.program),!F.getProgramParameter(this.program,F.LINK_STATUS))throw new Error(`Program failed to link: ${F.getProgramInfoLog(this.program)}`);F.deleteShader(xe),F.deleteShader(ae);for(let Ie=0;Ie<ce.length;Ie++){const $e=ce[Ie];if($e&&!Oe[$e]){const De=F.getUniformLocation(this.program,$e);De&&(Oe[$e]=De)}}this.fixedUniforms=g(n,Oe),this.terrainUniforms=((Ie,$e)=>({u_depth:new a.bP(Ie,$e.u_depth),u_terrain:new a.bP(Ie,$e.u_terrain),u_terrain_dim:new a.bg(Ie,$e.u_terrain_dim),u_terrain_matrix:new a.bR(Ie,$e.u_terrain_matrix),u_terrain_unpack:new a.bS(Ie,$e.u_terrain_unpack),u_terrain_exaggeration:new a.bg(Ie,$e.u_terrain_exaggeration)}))(n,Oe),this.projectionUniforms=((Ie,$e)=>({u_projection_matrix:new a.bR(Ie,$e.u_projection_matrix),u_projection_tile_mercator_coords:new a.bS(Ie,$e.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bS(Ie,$e.u_projection_clipping_plane),u_projection_transition:new a.bg(Ie,$e.u_projection_transition),u_projection_fallback_matrix:new a.bR(Ie,$e.u_projection_fallback_matrix)}))(n,Oe),this.binderUniforms=f?f.getUniforms(n,Oe):[]}draw(n,u,f,g,b,S,$,M,z,F,j,B,V,W,te,ee,ie,se,ce){const oe=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(f),n.setStencilMode(g),n.setColorMode(b),n.setCullFace(S),M){n.activeTexture.set(oe.TEXTURE2),oe.bindTexture(oe.TEXTURE_2D,M.depthTexture),n.activeTexture.set(oe.TEXTURE3),oe.bindTexture(oe.TEXTURE_2D,M.texture);for(const me in this.terrainUniforms)this.terrainUniforms[me].set(M[me])}if(z)for(const me in z)this.projectionUniforms[qm[me]].set(z[me]);if($)for(const me in this.fixedUniforms)this.fixedUniforms[me].set($[me]);ee&&ee.setUniforms(n,this.binderUniforms,W,{zoom:te});let he=0;switch(u){case oe.LINES:he=2;break;case oe.TRIANGLES:he=3;break;case oe.LINE_STRIP:he=1}for(const me of V.get()){const ae=me.vaos||(me.vaos={});(ae[F]||(ae[F]=new t2)).bind(n,this,j,ee?ee.getPaintVertexBuffers():[],B,me.vertexOffset,ie,se,ce),oe.drawElements(u,me.primitiveLength*he,oe.UNSIGNED_SHORT,me.primitiveOffset*he*2)}}}function Hd(v,n,u){const f=1/a.aC(u,1,n.transform.tileZoom),g=Math.pow(2,u.tileID.overscaledZ),b=u.tileSize*Math.pow(2,n.transform.tileZoom)/g,S=b*(u.tileID.canonical.x+u.tileID.wrap*g),$=b*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[S>>16,$>>16],u_pixel_coord_lower:[65535&S,65535&$]}}const Ns=(v,n,u,f)=>{const g=v.style.light,b=g.properties.get("position"),S=[b.x,b.y,b.z],$=a.bV();g.properties.get("anchor")==="viewport"&&a.bW($,v.transform.bearingInRadians),a.bX(S,S,$);const M=v.transform.transformLightDirection(S),z=g.properties.get("color");return{u_lightpos:S,u_lightpos_globe:M,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[z.r,z.g,z.b],u_vertical_gradient:+n,u_opacity:u,u_fill_translate:f}},i2=(v,n,u,f,g,b,S)=>a.e(Ns(v,n,u,f),Hd(b,v,S),{u_height_factor:-Math.pow(2,g.overscaledZ)/S.tileSize/8}),Zd=(v,n,u,f)=>a.e(Hd(n,v,u),{u_fill_translate:f}),nh=(v,n)=>({u_world:v,u_fill_translate:n}),sh=(v,n,u,f,g)=>a.e(Zd(v,n,u,g),{u_world:f}),r2=(v,n,u,f,g)=>{const b=v.transform;let S,$,M=0;if(u.paint.get("circle-pitch-alignment")==="map"){const z=a.aC(n,1,b.zoom);S=!0,$=[z,z],M=z/(a.$*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*g}else S=!1,$=b.pixelsToGLUnits;return{u_camera_to_center_distance:b.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:$,u_globe_extrude_scale:M,u_translate:f}},Wd=v=>({u_pixel_extrude_scale:[1/v.width,1/v.height]}),n2=v=>({u_viewport_size:[v.width,v.height]}),Al=(v,n=1)=>({u_color:v,u_overlay:0,u_overlay_scale:n}),S_=(v,n,u,f)=>{const g=a.aC(v,1,n)/(a.$*Math.pow(2,v.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:a.aC(v,1,n),u_intensity:u,u_globe_extrude_scale:g}},Zm=(v,n,u,f)=>{const g=a.L();a.bY(g,0,v.width,v.height,0,0,1);const b=v.context.gl;return{u_matrix:g,u_world:[b.drawingBufferWidth,b.drawingBufferHeight],u_image:u,u_color_ramp:f,u_opacity:n.paint.get("heatmap-opacity")}},s2=(v,n,u)=>{const f=u.paint.get("hillshade-accent-color");let g;switch(u.paint.get("hillshade-method")){case"basic":g=4;break;case"combined":g=1;break;case"igor":g=2;break;case"multidirectional":g=3;break;default:g=0}const b=u.getIlluminationProperties();for(let S=0;S<b.directionRadians.length;S++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(b.directionRadians[S]+=v.transform.bearingInRadians);return{u_image:0,u_latrange:Wm(0,n.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:b.altitudeRadians,u_azimuths:b.directionRadians,u_accent:f,u_method:g,u_highlights:b.highlightColor,u_shadows:b.shadowColor}},T_=(v,n)=>{const u=n.stride,f=a.L();return a.bY(f,0,a.$,-a.$,0,0,1),a.M(f,f,[0,-a.$,0]),{u_matrix:f,u_image:1,u_dimension:[u,u],u_zoom:v.overscaledZ,u_unpack:n.getUnpackVector()}};function Wm(v,n){const u=Math.pow(2,n.canonical.z),f=n.canonical.y;return[new a.a1(0,f/u).toLngLat().lat,new a.a1(0,(f+1)/u).toLngLat().lat]}const C_=(v,n,u=0)=>({u_image:0,u_unpack:n.getUnpackVector(),u_dimension:[n.stride,n.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:v.paint.get("color-relief-opacity")}),Yd=(v,n,u,f)=>{const g=v.transform;return{u_translation:Xm(v,n,u),u_ratio:f/a.aC(n,1,g.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},E_=(v,n,u,f,g)=>a.e(Yd(v,n,u,f),{u_image:0,u_image_height:g}),I_=(v,n,u,f,g)=>{const b=v.transform,S=Ym(n,b);return{u_translation:Xm(v,n,u),u_texsize:n.imageAtlasTexture.size,u_ratio:f/a.aC(n,1,b.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[S,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},Dl=(v,n,u,f,g,b)=>{const S=v.lineAtlas,$=Ym(n,v.transform),M=u.layout.get("line-cap")==="round",z=S.getDash(g.from,M),F=S.getDash(g.to,M),j=z.width*b.fromScale,B=F.width*b.toScale;return a.e(Yd(v,n,u,f),{u_patternscale_a:[$/j,-z.height/2],u_patternscale_b:[$/B,-F.height/2],u_sdfgamma:S.width/(256*Math.min(j,B)*v.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:F.y,u_mix:b.t})};function Ym(v,n){return 1/a.aC(v,1,n.tileZoom)}function Xm(v,n,u){return a.aD(v.transform,n,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const oh=(v,n,u,f,g)=>{return{u_tl_parent:v,u_scale_parent:n,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(S=f.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(b=f.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:o2(f.paint.get("raster-hue-rotate")),u_coords_top:[g[0].x,g[0].y,g[1].x,g[1].y],u_coords_bottom:[g[3].x,g[3].y,g[2].x,g[2].y]};var b,S};function o2(v){v*=Math.PI/180;const n=Math.sin(v),u=Math.cos(v);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const ah=(v,n,u,f,g,b,S,$,M,z,F,j,B)=>{const V=S.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:V.cameraToCenterDistance,u_pitch:V.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:V.width/V.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:$,u_coord_matrix:M,u_is_text:+F,u_pitch_with_map:+f,u_is_along_line:g,u_is_variable_anchor:b,u_texsize:j,u_texture:0,u_translation:z,u_pitched_scale:B}},$_=(v,n,u,f,g,b,S,$,M,z,F,j,B,V)=>{const W=S.transform;return a.e(ah(v,n,u,f,g,b,S,$,M,z,F,j,V),{u_gamma_scale:f?Math.cos(W.pitch*Math.PI/180)*W.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},a2=(v,n,u,f,g,b,S,$,M,z,F,j,B)=>a.e($_(v,n,u,f,g,b,S,$,M,z,!0,F,0,B),{u_texsize_icon:j,u_texture_icon:1}),P_=(v,n)=>({u_opacity:v,u_color:n}),M_=(v,n,u,f,g)=>a.e((function(b,S,$,M){const z=$.imageManager.getPattern(b.from.toString()),F=$.imageManager.getPattern(b.to.toString()),{width:j,height:B}=$.imageManager.getPixelSize(),V=Math.pow(2,M.tileID.overscaledZ),W=M.tileSize*Math.pow(2,$.transform.tileZoom)/V,te=W*(M.tileID.canonical.x+M.tileID.wrap*V),ee=W*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[j,B],u_mix:S.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/a.aC(M,1,$.transform.tileZoom),u_pixel_coord_upper:[te>>16,ee>>16],u_pixel_coord_lower:[65535&te,65535&ee]}})(u,g,n,f),{u_opacity:v}),Jm=(v,n)=>{},Km={fillExtrusion:(v,n)=>({u_lightpos:new a.bT(v,n.u_lightpos),u_lightpos_globe:new a.bT(v,n.u_lightpos_globe),u_lightintensity:new a.bg(v,n.u_lightintensity),u_lightcolor:new a.bT(v,n.u_lightcolor),u_vertical_gradient:new a.bg(v,n.u_vertical_gradient),u_opacity:new a.bg(v,n.u_opacity),u_fill_translate:new a.bU(v,n.u_fill_translate)}),fillExtrusionPattern:(v,n)=>({u_lightpos:new a.bT(v,n.u_lightpos),u_lightpos_globe:new a.bT(v,n.u_lightpos_globe),u_lightintensity:new a.bg(v,n.u_lightintensity),u_lightcolor:new a.bT(v,n.u_lightcolor),u_vertical_gradient:new a.bg(v,n.u_vertical_gradient),u_height_factor:new a.bg(v,n.u_height_factor),u_opacity:new a.bg(v,n.u_opacity),u_fill_translate:new a.bU(v,n.u_fill_translate),u_image:new a.bP(v,n.u_image),u_texsize:new a.bU(v,n.u_texsize),u_pixel_coord_upper:new a.bU(v,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(v,n.u_pixel_coord_lower),u_scale:new a.bT(v,n.u_scale),u_fade:new a.bg(v,n.u_fade)}),fill:(v,n)=>({u_fill_translate:new a.bU(v,n.u_fill_translate)}),fillPattern:(v,n)=>({u_image:new a.bP(v,n.u_image),u_texsize:new a.bU(v,n.u_texsize),u_pixel_coord_upper:new a.bU(v,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(v,n.u_pixel_coord_lower),u_scale:new a.bT(v,n.u_scale),u_fade:new a.bg(v,n.u_fade),u_fill_translate:new a.bU(v,n.u_fill_translate)}),fillOutline:(v,n)=>({u_world:new a.bU(v,n.u_world),u_fill_translate:new a.bU(v,n.u_fill_translate)}),fillOutlinePattern:(v,n)=>({u_world:new a.bU(v,n.u_world),u_image:new a.bP(v,n.u_image),u_texsize:new a.bU(v,n.u_texsize),u_pixel_coord_upper:new a.bU(v,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(v,n.u_pixel_coord_lower),u_scale:new a.bT(v,n.u_scale),u_fade:new a.bg(v,n.u_fade),u_fill_translate:new a.bU(v,n.u_fill_translate)}),circle:(v,n)=>({u_camera_to_center_distance:new a.bg(v,n.u_camera_to_center_distance),u_scale_with_map:new a.bP(v,n.u_scale_with_map),u_pitch_with_map:new a.bP(v,n.u_pitch_with_map),u_extrude_scale:new a.bU(v,n.u_extrude_scale),u_device_pixel_ratio:new a.bg(v,n.u_device_pixel_ratio),u_globe_extrude_scale:new a.bg(v,n.u_globe_extrude_scale),u_translate:new a.bU(v,n.u_translate)}),collisionBox:(v,n)=>({u_pixel_extrude_scale:new a.bU(v,n.u_pixel_extrude_scale)}),collisionCircle:(v,n)=>({u_viewport_size:new a.bU(v,n.u_viewport_size)}),debug:(v,n)=>({u_color:new a.bQ(v,n.u_color),u_overlay:new a.bP(v,n.u_overlay),u_overlay_scale:new a.bg(v,n.u_overlay_scale)}),depth:Jm,clippingMask:Jm,heatmap:(v,n)=>({u_extrude_scale:new a.bg(v,n.u_extrude_scale),u_intensity:new a.bg(v,n.u_intensity),u_globe_extrude_scale:new a.bg(v,n.u_globe_extrude_scale)}),heatmapTexture:(v,n)=>({u_matrix:new a.bR(v,n.u_matrix),u_world:new a.bU(v,n.u_world),u_image:new a.bP(v,n.u_image),u_color_ramp:new a.bP(v,n.u_color_ramp),u_opacity:new a.bg(v,n.u_opacity)}),hillshade:(v,n)=>({u_image:new a.bP(v,n.u_image),u_latrange:new a.bU(v,n.u_latrange),u_exaggeration:new a.bg(v,n.u_exaggeration),u_altitudes:new a.b_(v,n.u_altitudes),u_azimuths:new a.b_(v,n.u_azimuths),u_accent:new a.bQ(v,n.u_accent),u_method:new a.bP(v,n.u_method),u_shadows:new a.bZ(v,n.u_shadows),u_highlights:new a.bZ(v,n.u_highlights)}),hillshadePrepare:(v,n)=>({u_matrix:new a.bR(v,n.u_matrix),u_image:new a.bP(v,n.u_image),u_dimension:new a.bU(v,n.u_dimension),u_zoom:new a.bg(v,n.u_zoom),u_unpack:new a.bS(v,n.u_unpack)}),colorRelief:(v,n)=>({u_image:new a.bP(v,n.u_image),u_unpack:new a.bS(v,n.u_unpack),u_dimension:new a.bU(v,n.u_dimension),u_elevation_stops:new a.bP(v,n.u_elevation_stops),u_color_stops:new a.bP(v,n.u_color_stops),u_color_ramp_size:new a.bP(v,n.u_color_ramp_size),u_opacity:new a.bg(v,n.u_opacity)}),line:(v,n)=>({u_translation:new a.bU(v,n.u_translation),u_ratio:new a.bg(v,n.u_ratio),u_device_pixel_ratio:new a.bg(v,n.u_device_pixel_ratio),u_units_to_pixels:new a.bU(v,n.u_units_to_pixels)}),lineGradient:(v,n)=>({u_translation:new a.bU(v,n.u_translation),u_ratio:new a.bg(v,n.u_ratio),u_device_pixel_ratio:new a.bg(v,n.u_device_pixel_ratio),u_units_to_pixels:new a.bU(v,n.u_units_to_pixels),u_image:new a.bP(v,n.u_image),u_image_height:new a.bg(v,n.u_image_height)}),linePattern:(v,n)=>({u_translation:new a.bU(v,n.u_translation),u_texsize:new a.bU(v,n.u_texsize),u_ratio:new a.bg(v,n.u_ratio),u_device_pixel_ratio:new a.bg(v,n.u_device_pixel_ratio),u_image:new a.bP(v,n.u_image),u_units_to_pixels:new a.bU(v,n.u_units_to_pixels),u_scale:new a.bT(v,n.u_scale),u_fade:new a.bg(v,n.u_fade)}),lineSDF:(v,n)=>({u_translation:new a.bU(v,n.u_translation),u_ratio:new a.bg(v,n.u_ratio),u_device_pixel_ratio:new a.bg(v,n.u_device_pixel_ratio),u_units_to_pixels:new a.bU(v,n.u_units_to_pixels),u_patternscale_a:new a.bU(v,n.u_patternscale_a),u_patternscale_b:new a.bU(v,n.u_patternscale_b),u_sdfgamma:new a.bg(v,n.u_sdfgamma),u_image:new a.bP(v,n.u_image),u_tex_y_a:new a.bg(v,n.u_tex_y_a),u_tex_y_b:new a.bg(v,n.u_tex_y_b),u_mix:new a.bg(v,n.u_mix)}),raster:(v,n)=>({u_tl_parent:new a.bU(v,n.u_tl_parent),u_scale_parent:new a.bg(v,n.u_scale_parent),u_buffer_scale:new a.bg(v,n.u_buffer_scale),u_fade_t:new a.bg(v,n.u_fade_t),u_opacity:new a.bg(v,n.u_opacity),u_image0:new a.bP(v,n.u_image0),u_image1:new a.bP(v,n.u_image1),u_brightness_low:new a.bg(v,n.u_brightness_low),u_brightness_high:new a.bg(v,n.u_brightness_high),u_saturation_factor:new a.bg(v,n.u_saturation_factor),u_contrast_factor:new a.bg(v,n.u_contrast_factor),u_spin_weights:new a.bT(v,n.u_spin_weights),u_coords_top:new a.bS(v,n.u_coords_top),u_coords_bottom:new a.bS(v,n.u_coords_bottom)}),symbolIcon:(v,n)=>({u_is_size_zoom_constant:new a.bP(v,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(v,n.u_is_size_feature_constant),u_size_t:new a.bg(v,n.u_size_t),u_size:new a.bg(v,n.u_size),u_camera_to_center_distance:new a.bg(v,n.u_camera_to_center_distance),u_pitch:new a.bg(v,n.u_pitch),u_rotate_symbol:new a.bP(v,n.u_rotate_symbol),u_aspect_ratio:new a.bg(v,n.u_aspect_ratio),u_fade_change:new a.bg(v,n.u_fade_change),u_label_plane_matrix:new a.bR(v,n.u_label_plane_matrix),u_coord_matrix:new a.bR(v,n.u_coord_matrix),u_is_text:new a.bP(v,n.u_is_text),u_pitch_with_map:new a.bP(v,n.u_pitch_with_map),u_is_along_line:new a.bP(v,n.u_is_along_line),u_is_variable_anchor:new a.bP(v,n.u_is_variable_anchor),u_texsize:new a.bU(v,n.u_texsize),u_texture:new a.bP(v,n.u_texture),u_translation:new a.bU(v,n.u_translation),u_pitched_scale:new a.bg(v,n.u_pitched_scale)}),symbolSDF:(v,n)=>({u_is_size_zoom_constant:new a.bP(v,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(v,n.u_is_size_feature_constant),u_size_t:new a.bg(v,n.u_size_t),u_size:new a.bg(v,n.u_size),u_camera_to_center_distance:new a.bg(v,n.u_camera_to_center_distance),u_pitch:new a.bg(v,n.u_pitch),u_rotate_symbol:new a.bP(v,n.u_rotate_symbol),u_aspect_ratio:new a.bg(v,n.u_aspect_ratio),u_fade_change:new a.bg(v,n.u_fade_change),u_label_plane_matrix:new a.bR(v,n.u_label_plane_matrix),u_coord_matrix:new a.bR(v,n.u_coord_matrix),u_is_text:new a.bP(v,n.u_is_text),u_pitch_with_map:new a.bP(v,n.u_pitch_with_map),u_is_along_line:new a.bP(v,n.u_is_along_line),u_is_variable_anchor:new a.bP(v,n.u_is_variable_anchor),u_texsize:new a.bU(v,n.u_texsize),u_texture:new a.bP(v,n.u_texture),u_gamma_scale:new a.bg(v,n.u_gamma_scale),u_device_pixel_ratio:new a.bg(v,n.u_device_pixel_ratio),u_is_halo:new a.bP(v,n.u_is_halo),u_translation:new a.bU(v,n.u_translation),u_pitched_scale:new a.bg(v,n.u_pitched_scale)}),symbolTextAndIcon:(v,n)=>({u_is_size_zoom_constant:new a.bP(v,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(v,n.u_is_size_feature_constant),u_size_t:new a.bg(v,n.u_size_t),u_size:new a.bg(v,n.u_size),u_camera_to_center_distance:new a.bg(v,n.u_camera_to_center_distance),u_pitch:new a.bg(v,n.u_pitch),u_rotate_symbol:new a.bP(v,n.u_rotate_symbol),u_aspect_ratio:new a.bg(v,n.u_aspect_ratio),u_fade_change:new a.bg(v,n.u_fade_change),u_label_plane_matrix:new a.bR(v,n.u_label_plane_matrix),u_coord_matrix:new a.bR(v,n.u_coord_matrix),u_is_text:new a.bP(v,n.u_is_text),u_pitch_with_map:new a.bP(v,n.u_pitch_with_map),u_is_along_line:new a.bP(v,n.u_is_along_line),u_is_variable_anchor:new a.bP(v,n.u_is_variable_anchor),u_texsize:new a.bU(v,n.u_texsize),u_texsize_icon:new a.bU(v,n.u_texsize_icon),u_texture:new a.bP(v,n.u_texture),u_texture_icon:new a.bP(v,n.u_texture_icon),u_gamma_scale:new a.bg(v,n.u_gamma_scale),u_device_pixel_ratio:new a.bg(v,n.u_device_pixel_ratio),u_is_halo:new a.bP(v,n.u_is_halo),u_translation:new a.bU(v,n.u_translation),u_pitched_scale:new a.bg(v,n.u_pitched_scale)}),background:(v,n)=>({u_opacity:new a.bg(v,n.u_opacity),u_color:new a.bQ(v,n.u_color)}),backgroundPattern:(v,n)=>({u_opacity:new a.bg(v,n.u_opacity),u_image:new a.bP(v,n.u_image),u_pattern_tl_a:new a.bU(v,n.u_pattern_tl_a),u_pattern_br_a:new a.bU(v,n.u_pattern_br_a),u_pattern_tl_b:new a.bU(v,n.u_pattern_tl_b),u_pattern_br_b:new a.bU(v,n.u_pattern_br_b),u_texsize:new a.bU(v,n.u_texsize),u_mix:new a.bg(v,n.u_mix),u_pattern_size_a:new a.bU(v,n.u_pattern_size_a),u_pattern_size_b:new a.bU(v,n.u_pattern_size_b),u_scale_a:new a.bg(v,n.u_scale_a),u_scale_b:new a.bg(v,n.u_scale_b),u_pixel_coord_upper:new a.bU(v,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(v,n.u_pixel_coord_lower),u_tile_units_to_pixels:new a.bg(v,n.u_tile_units_to_pixels)}),terrain:(v,n)=>({u_texture:new a.bP(v,n.u_texture),u_ele_delta:new a.bg(v,n.u_ele_delta),u_fog_matrix:new a.bR(v,n.u_fog_matrix),u_fog_color:new a.bQ(v,n.u_fog_color),u_fog_ground_blend:new a.bg(v,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.bg(v,n.u_fog_ground_blend_opacity),u_horizon_color:new a.bQ(v,n.u_horizon_color),u_horizon_fog_blend:new a.bg(v,n.u_horizon_fog_blend),u_is_globe_mode:new a.bg(v,n.u_is_globe_mode)}),terrainDepth:(v,n)=>({u_ele_delta:new a.bg(v,n.u_ele_delta)}),terrainCoords:(v,n)=>({u_texture:new a.bP(v,n.u_texture),u_terrain_coords_id:new a.bg(v,n.u_terrain_coords_id),u_ele_delta:new a.bg(v,n.u_ele_delta)}),projectionErrorMeasurement:(v,n)=>({u_input:new a.bg(v,n.u_input),u_output_expected:new a.bg(v,n.u_output_expected)}),atmosphere:(v,n)=>({u_sun_pos:new a.bT(v,n.u_sun_pos),u_atmosphere_blend:new a.bg(v,n.u_atmosphere_blend),u_globe_position:new a.bT(v,n.u_globe_position),u_globe_radius:new a.bg(v,n.u_globe_radius),u_inv_proj_matrix:new a.bR(v,n.u_inv_proj_matrix)}),sky:(v,n)=>({u_sky_color:new a.bQ(v,n.u_sky_color),u_horizon_color:new a.bQ(v,n.u_horizon_color),u_horizon:new a.bU(v,n.u_horizon),u_horizon_normal:new a.bU(v,n.u_horizon_normal),u_sky_horizon_blend:new a.bg(v,n.u_sky_horizon_blend),u_sky_blend:new a.bg(v,n.u_sky_blend)})};class k_{constructor(n,u,f){this.context=n;const g=n.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xd={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yo{constructor(n,u,f,g){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=g,this.context=n;const b=n.gl;this.buffer=b.createBuffer(),n.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let f=0;f<this.attributes.length;f++){const g=u.attributes[this.attributes[f].name];g!==void 0&&n.enableVertexAttribArray(g)}}setVertexAttribPointers(n,u,f){for(let g=0;g<this.attributes.length;g++){const b=this.attributes[g],S=u.attributes[b.name];S!==void 0&&n.vertexAttribPointer(S,b.components,n[Xd[b.type]],!1,this.itemSize,b.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class di{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Qm extends di{getDefault(){return a.bf.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class eg extends di{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class A_ extends di{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class tg extends di{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class zl extends di{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class ig extends di{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class l2 extends di{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class c2 extends di{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class u2 extends di{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class h2 extends di{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class D_ extends di{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class d2 extends di{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class z_ extends di{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class Jd extends di{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Kd extends di{getDefault(){return a.bf.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Qd extends di{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class rg extends di{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class Ol extends di{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class lh extends di{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Oc extends di{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class gs extends di{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class O_ extends di{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class R_ extends di{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class ng extends di{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Rl extends di{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class ep extends di{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class tp extends di{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ch extends di{getDefault(){return null}set(n){var u;if(n===this.current&&!this.dirty)return;const f=this.gl;So(f)?f.bindVertexArray(n):(u=f.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class ip extends di{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class L_ extends di{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Rc extends di{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Va extends di{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class F_ extends Va{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class sg extends Va{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class ii extends Va{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}const uh="Framebuffer is not complete";class p2{constructor(n,u,f,g,b){this.context=n,this.width=u,this.height=f;const S=n.gl,$=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new F_(n,$),g)this.depthAttachment=b?new ii(n,$):new sg(n,$);else if(b)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(uh)}destroy(){const n=this.context.gl,u=this.colorAttachment.get();if(u&&n.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&n.deleteRenderbuffer(f)}n.deleteFramebuffer(this.framebuffer)}}class N_{constructor(n){var u,f;if(this.gl=n,this.clearColor=new Qm(this),this.clearDepth=new eg(this),this.clearStencil=new A_(this),this.colorMask=new tg(this),this.depthMask=new zl(this),this.stencilMask=new ig(this),this.stencilFunc=new l2(this),this.stencilOp=new c2(this),this.stencilTest=new u2(this),this.depthRange=new h2(this),this.depthTest=new D_(this),this.depthFunc=new d2(this),this.blend=new z_(this),this.blendFunc=new Jd(this),this.blendColor=new Kd(this),this.blendEquation=new Qd(this),this.cullFace=new rg(this),this.cullFaceSide=new Ol(this),this.frontFace=new lh(this),this.program=new Oc(this),this.activeTexture=new gs(this),this.viewport=new O_(this),this.bindFramebuffer=new R_(this),this.bindRenderbuffer=new ng(this),this.bindTexture=new Rl(this),this.bindVertexBuffer=new ep(this),this.bindElementBuffer=new tp(this),this.bindVertexArray=new ch(this),this.pixelStoreUnpack=new ip(this),this.pixelStoreUnpackPremultiplyAlpha=new L_(this),this.pixelStoreUnpackFlipY=new Rc(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),So(n)){this.HALF_FLOAT=n.HALF_FLOAT;const g=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=n.RGBA16F)!==null&&u!==void 0?u:g?.RGBA16F_EXT,this.RGB16F=(f=n.RGB16F)!==null&&f!==void 0?f:g?.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const g=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=g?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u){return new k_(this,n,u)}createVertexBuffer(n,u,f){return new Yo(this,n,u,f)}createRenderbuffer(n,u,f){const g=this.gl,b=g.createRenderbuffer();return this.bindRenderbuffer.set(b),g.renderbufferStorage(g.RENDERBUFFER,n,u,f),this.bindRenderbuffer.set(null),b}createFramebuffer(n,u,f,g){return new p2(this,n,u,f,g)}clear({color:n,depth:u,stencil:f}){const g=this.gl;let b=0;n&&(b|=g.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(b|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),f!==void 0&&(b|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(b)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){a.bH(n.blendFunction,Li.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return So(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var u;return So(this.gl)?this.gl.deleteVertexArray(n):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}let Ga;function B_(v,n,u,f,g){const b=v.context,S=v.transform,$=b.gl,M=v.useProgram("collisionBox"),z=[];let F=0,j=0;for(let ie=0;ie<f.length;ie++){const se=f[ie],ce=n.getTile(se).getBucket(u);if(!ce)continue;const oe=g?ce.textCollisionBox:ce.iconCollisionBox,he=ce.collisionCircleArray;he.length>0&&(z.push({circleArray:he,circleOffset:j,coord:se}),F+=he.length/4,j=F),oe&&M.draw(b,$.LINES,Ft.disabled,ci.disabled,v.colorModeForRenderPass(),Mt.disabled,Wd(v.transform),v.style.map.terrain&&v.style.map.terrain.getTerrainData(se),S.getProjectionData({overscaledTileID:se,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,null,v.transform.zoom,null,null,oe.collisionVertexBuffer)}if(!g||!z.length)return;const B=v.useProgram("collisionCircle"),V=new a.b$;V.resize(4*F),V._trim();let W=0;for(const ie of z)for(let se=0;se<ie.circleArray.length/4;se++){const ce=4*se,oe=ie.circleArray[ce+0],he=ie.circleArray[ce+1],me=ie.circleArray[ce+2],ae=ie.circleArray[ce+3];V.emplace(W++,oe,he,me,ae,0),V.emplace(W++,oe,he,me,ae,1),V.emplace(W++,oe,he,me,ae,2),V.emplace(W++,oe,he,me,ae,3)}(!Ga||Ga.length<2*F)&&(Ga=(function(ie){const se=2*ie,ce=new a.c1;ce.resize(se),ce._trim();for(let oe=0;oe<se;oe++){const he=6*oe;ce.uint16[he+0]=4*oe+0,ce.uint16[he+1]=4*oe+1,ce.uint16[he+2]=4*oe+2,ce.uint16[he+3]=4*oe+2,ce.uint16[he+4]=4*oe+3,ce.uint16[he+5]=4*oe+0}return ce})(F));const te=b.createIndexBuffer(Ga,!0),ee=b.createVertexBuffer(V,a.c0.members,!0);for(const ie of z){const se=n2(v.transform);B.draw(b,$.TRIANGLES,Ft.disabled,ci.disabled,v.colorModeForRenderPass(),Mt.disabled,se,v.style.map.terrain&&v.style.map.terrain.getTerrainData(ie.coord),null,u.id,ee,te,a.aM.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,v.transform.zoom,null,null,null)}ee.destroy(),te.destroy()}const f2=a.ag(new Float32Array(16));function j_(v,n,u,f,g,b){const{horizontalAlign:S,verticalAlign:$}=a.aH(v);return new a.P((-(S-.5)*n/g+f[0])*b,(-($-.5)*u/g+f[1])*b)}function m2(v,n,u,f,g,b){const S=n.tileAnchorPoint.add(new a.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let $=f.mult(b);u||($=$.rotate(-g));const M=S.add($);return mr(M.x,M.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(u){const $=nn(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(v),M=Math.atan($.y/$.x)+($.x<0?Math.PI:0);return v.add(f.rotate(M))}return v.add(f)}function og(v,n,u,f,g,b,S,$,M,z,F,j){const B=v.text.placedSymbolArray,V=v.text.dynamicLayoutVertexArray,W=v.icon.dynamicLayoutVertexArray,te={};V.clear();for(let ee=0;ee<B.length;ee++){const ie=B.get(ee),se=ie.hidden||!ie.crossTileID||v.allowVerticalPlacement&&!ie.placedOrientation?null:f[ie.crossTileID];if(se){const ce=new a.P(ie.anchorX,ie.anchorY),oe={getElevation:j,width:g.width,height:g.height,pitchedLabelPlaneMatrix:b,pitchWithMap:u,transform:g,tileAnchorPoint:ce,translation:z,unwrappedTileID:F},he=u?Fa(ce.x,ce.y,oe):nn(ce.x,ce.y,oe),me=Qe(g.cameraToCenterDistance,he.signedDistanceFromCamera);let ae=a.ap(v.textSizeData,$,ie)*me/a.aB;u&&(ae*=v.tilePixelRatio/S);const{width:xe,height:Oe,anchor:Ie,textOffset:$e,textBoxScale:De}=se,Ke=j_(Ie,xe,Oe,$e,De,ae),it=g.getPitchedTextCorrection(ce.x+z[0],ce.y+z[1],F),He=m2(he.point,oe,n,Ke,-g.bearingInRadians,it),xt=v.allowVerticalPlacement&&ie.placedOrientation===a.ao.vertical?Math.PI/2:0;for(let Gt=0;Gt<ie.numGlyphs;Gt++)a.av(V,He,xt);M&&ie.associatedIconIndex>=0&&(te[ie.associatedIconIndex]={shiftedAnchor:He,angle:xt})}else wo(ie.numGlyphs,V)}if(M){W.clear();const ee=v.icon.placedSymbolArray;for(let ie=0;ie<ee.length;ie++){const se=ee.get(ie);if(se.hidden)wo(se.numGlyphs,W);else{const ce=te[ie];if(ce)for(let oe=0;oe<se.numGlyphs;oe++)a.av(W,ce.shiftedAnchor,ce.angle);else wo(se.numGlyphs,W)}}v.icon.dynamicLayoutVertexBuffer.updateData(W)}v.text.dynamicLayoutVertexBuffer.updateData(V)}function rp(v,n,u){return u.iconsInText&&n?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function hh(v,n,u,f,g,b,S,$,M,z,F,j,B){const V=v.context,W=V.gl,te=v.transform,ee=$==="map",ie=M==="map",se=$!=="viewport"&&u.layout.get("symbol-placement")!=="point",ce=ee&&!ie&&!se,oe=!u.layout.get("symbol-sort-key").isConstant();let he=!1;const me=v.getDepthModeForSublayer(0,Ft.ReadOnly),ae=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),xe=[],Oe=te.getCircleRadiusCorrection();for(const Ie of f){const $e=n.getTile(Ie),De=$e.getBucket(u);if(!De)continue;const Ke=g?De.text:De.icon;if(!Ke||!Ke.segments.get().length||!Ke.hasVisibleVertices)continue;const it=Ke.programConfigurations.get(u.id),He=g||De.sdfIcons,xt=g?De.textSizeData:De.iconSizeData,Gt=ie||te.pitch!==0,gi=v.useProgram(rp(He,g,De),it),Ti=a.an(xt,te.zoom),wi=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ie);let Gi,Yi,Bt,Ci,yr=[0,0],Pr=null;if(g)Yi=$e.glyphAtlasTexture,Bt=W.LINEAR,Gi=$e.glyphAtlasTexture.size,De.iconsInText&&(yr=$e.imageAtlasTexture.size,Pr=$e.imageAtlasTexture,Ci=Gt||v.options.rotating||v.options.zooming||xt.kind==="composite"||xt.kind==="camera"?W.LINEAR:W.NEAREST);else{const _r=u.layout.get("icon-size").constantOr(0)!==1||De.iconsNeedLinear;Yi=$e.imageAtlasTexture,Bt=He||v.options.rotating||v.options.zooming||_r||Gt?W.LINEAR:W.NEAREST,Gi=$e.imageAtlasTexture.size}const Vr=a.aC($e,1,v.transform.zoom),In=cr(ee,v.transform,Vr),qs=a.L();a.aq(qs,In);const Ha=ti(ie,ee,v.transform,Vr),Za=a.aD(te,$e,b,S),Wc=te.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),Yc=ae&&De.hasTextData(),Vl=u.layout.get("icon-text-fit")!=="none"&&Yc&&De.hasIconData();if(se){const _r=v.style.map.terrain?(vs,vr)=>v.style.map.terrain.getElevation(Ie,vs,vr):null,Mr=u.layout.get("text-rotation-alignment")==="map";Zi(De,v,g,In,qs,ie,z,Mr,Ie.toUnwrapped(),te.width,te.height,Za,_r)}const Gl=g&&ae||Vl,jn=se||Gl?f2:ie?In:v.transform.clipSpaceToPixelsMatrix,Hs=He&&u.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let $n;$n=He?De.iconsInText?a2(xt.kind,Ti,ce,ie,se,Gl,v,jn,Ha,Za,Gi,yr,Oe):$_(xt.kind,Ti,ce,ie,se,Gl,v,jn,Ha,Za,g,Gi,0,Oe):ah(xt.kind,Ti,ce,ie,se,Gl,v,jn,Ha,Za,g,Gi,Oe);const Wa={program:gi,buffers:Ke,uniformValues:$n,projectionData:Wc,atlasTexture:Yi,atlasTextureIcon:Pr,atlasInterpolation:Bt,atlasInterpolationIcon:Ci,isSDF:He,hasHalo:Hs};if(oe&&De.canOverlap){he=!0;const _r=Ke.segments.get();for(const Mr of _r)xe.push({segments:new a.aM([Mr]),sortKey:Mr.sortKey,state:Wa,terrainData:wi})}else xe.push({segments:Ke.segments,sortKey:0,state:Wa,terrainData:wi})}he&&xe.sort(((Ie,$e)=>Ie.sortKey-$e.sortKey));for(const Ie of xe){const $e=Ie.state;if(V.activeTexture.set(W.TEXTURE0),$e.atlasTexture.bind($e.atlasInterpolation,W.CLAMP_TO_EDGE),$e.atlasTextureIcon&&(V.activeTexture.set(W.TEXTURE1),$e.atlasTextureIcon&&$e.atlasTextureIcon.bind($e.atlasInterpolationIcon,W.CLAMP_TO_EDGE)),$e.isSDF){const De=$e.uniformValues;$e.hasHalo&&(De.u_is_halo=1,dh($e.buffers,Ie.segments,u,v,$e.program,me,F,j,De,$e.projectionData,Ie.terrainData)),De.u_is_halo=0}dh($e.buffers,Ie.segments,u,v,$e.program,me,F,j,$e.uniformValues,$e.projectionData,Ie.terrainData)}}function dh(v,n,u,f,g,b,S,$,M,z,F){const j=f.context;g.draw(j,j.gl.TRIANGLES,b,S,$,Mt.backCCW,M,F,z,u.id,v.layoutVertexBuffer,v.indexBuffer,n,u.paint,f.transform.zoom,v.programConfigurations.get(u.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function ag(v,n,u,f,g){const b=v.context,S=b.gl,$=ci.disabled,M=new Li([S.ONE,S.ONE],a.bf.transparent,[!0,!0,!0,!0]),z=n.getBucket(u);if(!z)return;const F=f.key;let j=u.heatmapFbos.get(F);j||(j=ph(b,n.tileSize,n.tileSize),u.heatmapFbos.set(F,j)),b.bindFramebuffer.set(j.framebuffer),b.viewport.set([0,0,n.tileSize,n.tileSize]),b.clear({color:a.bf.transparent});const B=z.programConfigurations.get(u.id),V=v.useProgram("heatmap",B,!g),W=v.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),te=v.style.map.terrain.getTerrainData(f);V.draw(b,S.TRIANGLES,Ft.disabled,$,M,Mt.disabled,S_(n,v.transform.zoom,u.paint.get("heatmap-intensity"),1),te,W,u.id,z.layoutVertexBuffer,z.indexBuffer,z.segments,u.paint,v.transform.zoom,B)}function U_(v,n,u,f,g){const b=v.context,S=b.gl,$=v.transform;b.setColorMode(v.colorModeForRenderPass());const M=fh(b,n),z=u.key,F=n.heatmapFbos.get(z);if(!F)return;b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,F.colorAttachment.get()),b.activeTexture.set(S.TEXTURE1),M.bind(S.LINEAR,S.CLAMP_TO_EDGE);const j=$.getProjectionData({overscaledTileID:u,applyTerrainMatrix:g,applyGlobeMatrix:!f});v.useProgram("heatmapTexture").draw(b,S.TRIANGLES,Ft.disabled,ci.disabled,v.colorModeForRenderPass(),Mt.disabled,Zm(v,n,0,1),null,j,n.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments,n.paint,$.zoom),F.destroy(),n.heatmapFbos.delete(z)}function ph(v,n,u){var f,g;const b=v.gl,S=b.createTexture();b.bindTexture(b.TEXTURE_2D,S),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);const $=(f=v.HALF_FLOAT)!==null&&f!==void 0?f:b.UNSIGNED_BYTE,M=(g=v.RGBA16F)!==null&&g!==void 0?g:b.RGBA;b.texImage2D(b.TEXTURE_2D,0,M,n,u,0,b.RGBA,$,null);const z=v.createFramebuffer(n,u,!1,!1);return z.colorAttachment.set(S),z}function fh(v,n){return n.colorRampTexture||(n.colorRampTexture=new a.T(v,n.colorRamp,v.gl.RGBA)),n.colorRampTexture}function mh(v,n,u,f,g){if(!u||!f||!f.imageAtlas)return;const b=f.imageAtlas.patternPositions;let S=b[u.to.toString()],$=b[u.from.toString()];if(!S&&$&&(S=$),!$&&S&&($=S),!S||!$){const M=g.getPaintProperty(n);S=b[M],$=b[M]}S&&$&&v.setConstantPatternPositions(S,$)}function np(v,n,u,f,g,b,S,$){const M=v.context.gl,z="fill-pattern",F=u.paint.get(z),j=F&&F.constantOr(1),B=u.getCrossfadeParameters();let V,W,te,ee,ie;const se=v.transform,ce=u.paint.get("fill-translate"),oe=u.paint.get("fill-translate-anchor");S?(W=j&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=M.LINES):(W=j?"fillPattern":"fill",V=M.TRIANGLES);const he=F.constantOr(null);for(const me of f){const ae=n.getTile(me);if(j&&!ae.patternsLoaded())continue;const xe=ae.getBucket(u);if(!xe)continue;const Oe=xe.programConfigurations.get(u.id),Ie=v.useProgram(W,Oe),$e=v.style.map.terrain&&v.style.map.terrain.getTerrainData(me);j&&(v.context.activeTexture.set(M.TEXTURE0),ae.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Oe.updatePaintBuffers(B)),mh(Oe,z,he,ae,u);const De=se.getProjectionData({overscaledTileID:me,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),Ke=a.aD(se,ae,ce,oe);if(S){ee=xe.indexBuffer2,ie=xe.segments2;const He=[M.drawingBufferWidth,M.drawingBufferHeight];te=W==="fillOutlinePattern"&&j?sh(v,B,ae,He,Ke):nh(He,Ke)}else ee=xe.indexBuffer,ie=xe.segments,te=j?Zd(v,B,ae,Ke):{u_fill_translate:Ke};const it=v.stencilModeForClipping(me);Ie.draw(v.context,V,g,it,b,Mt.backCCW,te,$e,De,u.id,xe.layoutVertexBuffer,ee,ie,u.paint,v.transform.zoom,Oe)}}function lg(v,n,u,f,g,b,S,$){const M=v.context,z=M.gl,F="fill-extrusion-pattern",j=u.paint.get(F),B=j.constantOr(1),V=u.getCrossfadeParameters(),W=u.paint.get("fill-extrusion-opacity"),te=j.constantOr(null),ee=v.transform;for(const ie of f){const se=n.getTile(ie),ce=se.getBucket(u);if(!ce)continue;const oe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ie),he=ce.programConfigurations.get(u.id),me=v.useProgram(B?"fillExtrusionPattern":"fillExtrusion",he);B&&(v.context.activeTexture.set(z.TEXTURE0),se.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),he.updatePaintBuffers(V));const ae=ee.getProjectionData({overscaledTileID:ie,applyGlobeMatrix:!$,applyTerrainMatrix:!0});mh(he,F,te,se,u);const xe=a.aD(ee,se,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Oe=u.paint.get("fill-extrusion-vertical-gradient"),Ie=B?i2(v,Oe,W,xe,ie,V,se):Ns(v,Oe,W,xe);me.draw(M,M.gl.TRIANGLES,g,b,S,Mt.backCCW,Ie,oe,ae,u.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,u.paint,v.transform.zoom,he,v.style.map.terrain&&ce.centroidVertexBuffer)}}function Ll(v,n,u,f,g,b,S,$,M){var z;const F=v.style.projection,j=v.context,B=v.transform,V=j.gl,W=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],te=v.useProgram("hillshade",null,!1,W),ee=!v.options.moving;for(const ie of f){const se=n.getTile(ie),ce=se.fbo;if(!ce)continue;const oe=F.getMeshFromTileID(j,ie.canonical,$,!0,"raster"),he=(z=v.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(ie);j.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,ce.colorAttachment.get());const me=B.getProjectionData({overscaledTileID:ie,aligned:ee,applyGlobeMatrix:!M,applyTerrainMatrix:!0});te.draw(j,V.TRIANGLES,b,g[ie.overscaledZ],S,Mt.backCCW,s2(v,se,u),he,me,u.id,oe.vertexBuffer,oe.indexBuffer,oe.segments)}}function cg(v,n,u,f,g,b,S,$,M){var z;const F=v.style.projection,j=v.context,B=v.transform,V=j.gl,W=v.useProgram("colorRelief"),te=!v.options.moving;let ee=!0,ie=0;for(const se of f){const ce=n.getTile(se),oe=ce.dem;if(ee){const Ie=V.getParameter(V.MAX_TEXTURE_SIZE),{elevationTexture:$e,colorTexture:De}=u.getColorRampTextures(j,Ie,oe.getUnpackVector());j.activeTexture.set(V.TEXTURE1),$e.bind(V.NEAREST,V.CLAMP_TO_EDGE),j.activeTexture.set(V.TEXTURE4),De.bind(V.LINEAR,V.CLAMP_TO_EDGE),ee=!1,ie=$e.size[0]}if(!oe||!oe.data)continue;const he=oe.stride,me=oe.getPixels();if(j.activeTexture.set(V.TEXTURE0),j.pixelStoreUnpackPremultiplyAlpha.set(!1),ce.demTexture=ce.demTexture||v.getTileTexture(he),ce.demTexture){const Ie=ce.demTexture;Ie.update(me,{premultiply:!1}),Ie.bind(V.LINEAR,V.CLAMP_TO_EDGE)}else ce.demTexture=new a.T(j,me,V.RGBA,{premultiply:!1}),ce.demTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const ae=F.getMeshFromTileID(j,se.canonical,$,!0,"raster"),xe=(z=v.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(se),Oe=B.getProjectionData({overscaledTileID:se,aligned:te,applyGlobeMatrix:!M,applyTerrainMatrix:!0});W.draw(j,V.TRIANGLES,b,g[se.overscaledZ],S,Mt.backCCW,C_(u,ce.dem,ie),xe,Oe,u.id,ae.vertexBuffer,ae.indexBuffer,ae.segments)}}const sp=[new a.P(0,0),new a.P(a.$,0),new a.P(a.$,a.$),new a.P(0,a.$)];function Fl(v,n,u,f,g,b,S,$,M=!1,z=!1){const F=f[f.length-1].overscaledZ,j=v.context,B=j.gl,V=v.useProgram("raster"),W=v.transform,te=v.style.projection,ee=v.colorModeForRenderPass(),ie=!v.options.moving;for(const se of f){const ce=v.getDepthModeForSublayer(se.overscaledZ-F,u.paint.get("raster-opacity")===1?Ft.ReadWrite:Ft.ReadOnly,B.LESS),oe=n.getTile(se);oe.registerFadeDuration(u.paint.get("raster-fade-duration"));const he=n.findLoadedParent(se,0),me=n.findLoadedSibling(se),ae=ug(oe,he||me||null,n,u,v.transform,v.style.map.terrain);let xe,Oe;const Ie=u.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;j.activeTexture.set(B.TEXTURE0),oe.texture.bind(Ie,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),j.activeTexture.set(B.TEXTURE1),he?(he.texture.bind(Ie,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),xe=Math.pow(2,he.tileID.overscaledZ-oe.tileID.overscaledZ),Oe=[oe.tileID.canonical.x*xe%1,oe.tileID.canonical.y*xe%1]):oe.texture.bind(Ie,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),oe.texture.useMipmap&&j.extTextureFilterAnisotropic&&v.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const $e=v.style.map.terrain&&v.style.map.terrain.getTerrainData(se),De=W.getProjectionData({overscaledTileID:se,aligned:ie,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),Ke=oh(Oe||[0,0],xe||1,ae,u,$),it=te.getMeshFromTileID(j,se.canonical,b,S,"raster");V.draw(j,B.TRIANGLES,ce,g?g[se.overscaledZ]:ci.disabled,ee,M?Mt.frontCCW:Mt.backCCW,Ke,$e,De,u.id,it.vertexBuffer,it.indexBuffer,it.segments)}}function ug(v,n,u,f,g,b){const S=f.paint.get("raster-fade-duration");if(!b&&S>0){const $=L.now(),M=($-v.timeAdded)/S,z=n?($-n.timeAdded)/S:-1,F=u.getSource(),j=St(g,{tileSize:F.tileSize,roundZoom:F.roundZoom}),B=!n||Math.abs(n.tileID.overscaledZ-j)>Math.abs(v.tileID.overscaledZ-j),V=B&&v.refreshedUponExpiration?1:a.ah(B?M:1-z,0,1);return v.refreshedUponExpiration&&M>=1&&(v.refreshedUponExpiration=!1),n?{opacity:1,mix:1-V}:{opacity:V,mix:0}}return{opacity:1,mix:0}}const V_=new a.bf(1,0,0,1),G_=new a.bf(0,1,0,1),op=new a.bf(0,0,1,1),hg=new a.bf(1,0,1,1),g2=new a.bf(0,1,1,1);function dg(v,n,u,f){Eo(v,0,n+u/2,v.transform.width,u,f)}function Wi(v,n,u,f){Eo(v,n-u/2,0,u,v.transform.height,f)}function Eo(v,n,u,f,g,b){const S=v.context,$=S.gl;$.enable($.SCISSOR_TEST),$.scissor(n*v.pixelRatio,u*v.pixelRatio,f*v.pixelRatio,g*v.pixelRatio),S.clear({color:b}),$.disable($.SCISSOR_TEST)}function ys(v,n,u){const f=v.context,g=f.gl,b=v.useProgram("debug"),S=Ft.disabled,$=ci.disabled,M=v.colorModeForRenderPass(),z="$debug",F=v.style.map.terrain&&v.style.map.terrain.getTerrainData(u);f.activeTexture.set(g.TEXTURE0);const j=n.getTileByID(u.key).latestRawTileData,B=Math.floor((j&&j.byteLength||0)/1024),V=n.getTile(u).tileSize,W=512/Math.min(V,512)*(u.overscaledZ/v.transform.zoom)*.5;let te=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(te+=` => ${u.overscaledZ}`),(function(ie,se){ie.initDebugOverlayCanvas();const ce=ie.debugOverlayCanvas,oe=ie.context.gl,he=ie.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,ce.width,ce.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(se,5,5),he.strokeText(se,5,5),ie.debugOverlayTexture.update(ce),ie.debugOverlayTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE)})(v,`${te} ${B}kB`);const ee=v.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});b.draw(f,g.TRIANGLES,S,$,Li.alphaBlended,Mt.disabled,Al(a.bf.transparent,W),null,ee,z,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),b.draw(f,g.LINE_STRIP,S,$,M,Mt.disabled,Al(a.bf.red),F,ee,z,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function ap(v,n,u,f){const{isRenderingGlobe:g}=f,b=v.context,S=b.gl,$=v.transform,M=v.colorModeForRenderPass(),z=v.getDepthModeFor3D(),F=v.useProgram("terrain");b.bindFramebuffer.set(null),b.viewport.set([0,0,v.width,v.height]);for(const j of u){const B=n.getTerrainMesh(j.tileID),V=v.renderToTexture.getTexture(j),W=n.getTerrainData(j.tileID);b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,V.texture);const te=n.getMeshFrameDelta($.zoom),ee=$.calculateFogMatrix(j.tileID.toUnwrapped()),ie=qd(te,ee,v.style.sky,$.pitch,g),se=$.getProjectionData({overscaledTileID:j.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});F.draw(b,S.TRIANGLES,z,ci.disabled,M,Mt.backCCW,ie,W,se,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}}function gh(v,n){if(!n.mesh){const u=new a.aL;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const f=new a.aN;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),n.mesh=new El(v.createVertexBuffer(u,Ua.members),v.createIndexBuffer(f),a.aM.simpleSegment(0,0,u.length,f.length))}return n.mesh}class q_{constructor(n,u){this.context=new N_(n),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Xt.maxUnderzooming+Xt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new kc}resize(n,u,f){if(this.width=Math.floor(n*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const n=this.context,u=new a.aL;u.emplaceBack(0,0),u.emplaceBack(a.$,0),u.emplaceBack(0,a.$),u.emplaceBack(a.$,a.$),this.tileExtentBuffer=n.createVertexBuffer(u,Ua.members),this.tileExtentSegments=a.aM.simpleSegment(0,0,4,2);const f=new a.aL;f.emplaceBack(0,0),f.emplaceBack(a.$,0),f.emplaceBack(0,a.$),f.emplaceBack(a.$,a.$),this.debugBuffer=n.createVertexBuffer(f,Ua.members),this.debugSegments=a.aM.simpleSegment(0,0,4,5);const g=new a.c6;g.emplaceBack(0,0,0,0),g.emplaceBack(a.$,0,a.$,0),g.emplaceBack(0,a.$,0,a.$),g.emplaceBack(a.$,a.$,a.$,a.$),this.rasterBoundsBuffer=n.createVertexBuffer(g,e2.members),this.rasterBoundsSegments=a.aM.simpleSegment(0,0,4,2);const b=new a.aL;b.emplaceBack(0,0),b.emplaceBack(a.$,0),b.emplaceBack(0,a.$),b.emplaceBack(a.$,a.$),this.rasterBoundsBufferPosOnly=n.createVertexBuffer(b,Ua.members),this.rasterBoundsSegmentsPosOnly=a.aM.simpleSegment(0,0,4,5);const S=new a.aL;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(S,Ua.members),this.viewportSegments=a.aM.simpleSegment(0,0,4,2);const $=new a.c7;$.emplaceBack(0),$.emplaceBack(1),$.emplaceBack(3),$.emplaceBack(2),$.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer($);const M=new a.aN;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(M);const z=this.context.gl;this.stencilClearMode=new ci({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.tileExtentMesh=new El(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const n=this.context,u=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=a.L();a.bY(f,0,this.width,this.height,0,0,1),a.N(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const g={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(n,u.TRIANGLES,Ft.disabled,this.stencilClearMode,Li.disabled,Mt.disabled,null,null,g,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,u,f){if(this.currentStencilSource===n.source||!n.isTileClipped()||!u||!u.length)return;this.currentStencilSource=n.source,this.nextStencilID+u.length>256&&this.clearStencil();const g=this.context;g.setColorMode(Li.disabled),g.setDepthMode(Ft.disabled);const b={};for(const S of u)b[S.key]=this.nextStencilID++;this._renderTileMasks(b,u,f,!0),this._renderTileMasks(b,u,f,!1),this._tileClippingMaskIDs=b}_renderTileMasks(n,u,f,g){const b=this.context,S=b.gl,$=this.style.projection,M=this.transform,z=this.useProgram("clippingMask");for(const F of u){const j=n[F.key],B=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),V=$.getMeshFromTileID(this.context,F.canonical,g,!0,"stencil"),W=M.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!f,applyTerrainMatrix:!0});z.draw(b,S.TRIANGLES,Ft.disabled,new ci({func:S.ALWAYS,mask:0},j,255,S.KEEP,S.KEEP,S.REPLACE),Li.disabled,f?Mt.disabled:Mt.backCCW,null,B,W,"$clipping",V.vertexBuffer,V.indexBuffer,V.segments)}}_renderTilesDepthBuffer(){const n=this.context,u=n.gl,f=this.style.projection,g=this.transform,b=this.useProgram("depth"),S=this.getDepthModeFor3D(),$=Te(g,{tileSize:g.tileSize});for(const M of $){const z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(M),F=f.getMeshFromTileID(this.context,M.canonical,!0,!0,"raster"),j=g.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!0,applyTerrainMatrix:!0});b.draw(n,u.TRIANGLES,S,ci.disabled,Li.disabled,Mt.backCCW,null,z,j,"$clipping",F.vertexBuffer,F.indexBuffer,F.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new ci({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){const u=this.context.gl;return new ci({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(n){const u=this.context.gl,f=n.sort(((S,$)=>$.overscaledZ-S.overscaledZ)),g=f[f.length-1].overscaledZ,b=f[0].overscaledZ-g+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const S={};for(let $=0;$<b;$++)S[$+g]=new ci({func:u.GEQUAL,mask:255},$+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[S,f]}return[{[g]:ci.disabled},f]}stencilConfigForOverlapTwoPass(n){const u=this.context.gl,f=n.sort(((S,$)=>$.overscaledZ-S.overscaledZ)),g=f[f.length-1].overscaledZ,b=f[0].overscaledZ-g+1;if(this.clearStencil(),b>1){const S={},$={};for(let M=0;M<b;M++)S[M+g]=new ci({func:u.GREATER,mask:255},b+1+M,255,u.KEEP,u.KEEP,u.REPLACE),$[M+g]=new ci({func:u.GREATER,mask:255},1+M,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*b+1,[S,$,f]}return this.nextStencilID=3,[{[g]:new ci({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[g]:new ci({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},f]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Li([n.CONSTANT_COLOR,n.ONE],new a.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Li.unblended:Li.alphaBlended}getDepthModeForSublayer(n,u,f){if(!this.opaquePassEnabledForLayer())return Ft.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Ft(f||this.context.gl.LEQUAL,u,[g,g])}getDepthModeFor3D(){return new Ft(this.context.gl.LEQUAL,Ft.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,u){var f,g;this.style=n,this.options=u,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(L.now()),this.imageManager.beginFrame();const b=this.style._order,S=this.style.sourceCaches,$={},M={},z={},F={isRenderingToTexture:!1,isRenderingGlobe:((f=n.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const B in S){const V=S[B];V.used&&V.prepare(this.context),$[B]=V.getVisibleCoordinates(!1),M[B]=$[B].slice().reverse(),z[B]=V.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<b.length;B++)if(this.style._layers[b[B]].is3D()){this.opaquePassCutoff=B;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const B of b){const V=this.style._layers[B];if(!V.hasOffscreenPass()||V.isHidden(this.transform.zoom))continue;const W=M[V.source];(V.type==="custom"||W.length)&&this.renderLayer(this,S[V.source],V,W,F)}if((g=this.style.projection)===null||g===void 0||g.updateGPUdependent({context:this.context,useProgram:B=>this.useProgram(B)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?a.bf.black:a.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(B,V){const W=B.context,te=W.gl,ee=((me,ae,xe)=>{const Oe=Math.cos(ae.rollInRadians),Ie=Math.sin(ae.rollInRadians),$e=fe(ae),De=ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:me.properties.get("sky-color"),u_horizon_color:me.properties.get("horizon-color"),u_horizon:[(ae.width/2-$e*Ie)*xe,(ae.height/2+$e*Oe)*xe],u_horizon_normal:[-Ie,Oe],u_sky_horizon_blend:me.properties.get("sky-horizon-blend")*ae.height/2*xe,u_sky_blend:De}})(V,B.style.map.transform,B.pixelRatio),ie=new Ft(te.LEQUAL,Ft.ReadWrite,[0,1]),se=ci.disabled,ce=B.colorModeForRenderPass(),oe=B.useProgram("sky"),he=gh(W,V);oe.draw(W,te.TRIANGLES,ie,se,ce,Mt.disabled,ee,null,void 0,"sky",he.vertexBuffer,he.indexBuffer,he.segments)})(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[b[this.currentLayer]],V=S[B.source],W=$[B.source];this._renderTileClippingMasks(B,W,!1),this.renderLayer(this,V,B,W,F)}this.renderPass="translucent";let j=!1;for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const B=this.style._layers[b[this.currentLayer]],V=S[B.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(B,F))continue;this.opaquePassEnabledForLayer()||j||(j=!0,F.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const W=(B.type==="symbol"?z:M)[B.source];this._renderTileClippingMasks(B,$[B.source],!!this.renderToTexture),this.renderLayer(this,V,B,W,F)}if(F.isRenderingGlobe&&(function(B,V,W){const te=B.context,ee=te.gl,ie=B.useProgram("atmosphere"),se=new Ft(ee.LEQUAL,Ft.ReadOnly,[0,1]),ce=B.transform,oe=(function(De,Ke){const it=De.properties.get("position"),He=[-it.x,-it.y,-it.z],xt=a.ag(new Float64Array(16));return De.properties.get("anchor")==="map"&&(a.b6(xt,xt,Ke.rollInRadians),a.b7(xt,xt,-Ke.pitchInRadians),a.b6(xt,xt,Ke.bearingInRadians),a.b7(xt,xt,Ke.center.lat*Math.PI/180),a.bz(xt,xt,-Ke.center.lng*Math.PI/180)),a.c5(He,He,xt),He})(W,B.transform),he=ce.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),me=V.properties.get("atmosphere-blend")*he.projectionTransition;if(me===0)return;const ae=Dc(ce.worldSize,ce.center.lat),xe=ce.inverseProjectionMatrix,Oe=new Float64Array(4);Oe[3]=1,a.aw(Oe,Oe,ce.modelViewProjectionMatrix),Oe[0]/=Oe[3],Oe[1]/=Oe[3],Oe[2]/=Oe[3],Oe[3]=1,a.aw(Oe,Oe,xe),Oe[0]/=Oe[3],Oe[1]/=Oe[3],Oe[2]/=Oe[3],Oe[3]=1;const Ie=((De,Ke,it,He,xt)=>({u_sun_pos:De,u_atmosphere_blend:Ke,u_globe_position:it,u_globe_radius:He,u_inv_proj_matrix:xt}))(oe,me,[Oe[0],Oe[1],Oe[2]],ae,xe),$e=gh(te,V);ie.draw(te,ee.TRIANGLES,se,ci.disabled,Li.alphaBlended,Mt.disabled,Ie,null,null,"atmosphere",$e.vertexBuffer,$e.indexBuffer,$e.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const B=(function(V,W){let te=null;const ee=Object.values(V._layers).flatMap((oe=>oe.source&&!oe.isHidden(W)?[V.sourceCaches[oe.source]]:[])),ie=ee.filter((oe=>oe.getSource().type==="vector")),se=ee.filter((oe=>oe.getSource().type!=="vector")),ce=oe=>{(!te||te.getSource().maxzoom<oe.getSource().maxzoom)&&(te=oe)};return ie.forEach((oe=>ce(oe))),te||se.forEach((oe=>ce(oe))),te})(this.style,this.transform.zoom);B&&(function(V,W,te){for(let ee=0;ee<te.length;ee++)ys(V,W,te[ee])})(this,B,B.getVisibleCoordinates())}this.options.showPadding&&(function(B){const V=B.transform.padding;dg(B,B.transform.height-(V.top||0),3,V_),dg(B,V.bottom||0,3,G_),Wi(B,V.left||0,3,op),Wi(B,B.transform.width-(V.right||0),3,hg);const W=B.transform.centerPoint;(function(te,ee,ie,se){Eo(te,ee-1,ie-10,2,20,se),Eo(te,ee-10,ie-1,20,2,se)})(B,W.x,B.transform.height-W.y,g2)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=n?!a.c8(u,f):!a.c9(u,f)),g||(g=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),g&&(a.ca(u,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(b,S){const $=b.context,M=$.gl,z=b.transform,F=Li.unblended,j=new Ft(M.LEQUAL,Ft.ReadWrite,[0,1]),B=S.sourceCache.getRenderableTiles(),V=b.useProgram("terrainDepth");$.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),$.viewport.set([0,0,b.width/devicePixelRatio,b.height/devicePixelRatio]),$.clear({color:a.bf.transparent,depth:1});for(const W of B){const te=S.getTerrainMesh(W.tileID),ee=S.getTerrainData(W.tileID),ie=z.getProjectionData({overscaledTileID:W.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),se={u_ele_delta:S.getMeshFrameDelta(z.zoom)};V.draw($,M.TRIANGLES,j,ci.disabled,F,Mt.backCCW,se,ee,ie,"terrain",te.vertexBuffer,te.indexBuffer,te.segments)}$.bindFramebuffer.set(null),$.viewport.set([0,0,b.width,b.height])})(this,this.style.map.terrain),(function(b,S){const $=b.context,M=$.gl,z=b.transform,F=Li.unblended,j=new Ft(M.LEQUAL,Ft.ReadWrite,[0,1]),B=S.getCoordsTexture(),V=S.sourceCache.getRenderableTiles(),W=b.useProgram("terrainCoords");$.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),$.viewport.set([0,0,b.width/devicePixelRatio,b.height/devicePixelRatio]),$.clear({color:a.bf.transparent,depth:1}),S.coordsIndex=[];for(const te of V){const ee=S.getTerrainMesh(te.tileID),ie=S.getTerrainData(te.tileID);$.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,B.texture);const se={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(z.zoom)},ce=z.getProjectionData({overscaledTileID:te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});W.draw($,M.TRIANGLES,j,ci.disabled,F,Mt.backCCW,se,ie,ce,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments),S.coordsIndex.push(te.tileID.key)}$.bindFramebuffer.set(null),$.viewport.set([0,0,b.width,b.height])})(this,this.style.map.terrain))}renderLayer(n,u,f,g,b){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(g||[]).length)&&(this.id=f.id,a.cb(f)?(function(S,$,M,z,F,j){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:B}=j,V=ci.disabled,W=S.colorModeForRenderPass();(M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(te,ee,ie,se,ce,oe,he,me,ae){const xe=ee.transform,Oe=ee.style.map.terrain,Ie=ce==="map",$e=oe==="map";for(const De of te){const Ke=se.getTile(De),it=Ke.getBucket(ie);if(!it||!it.text||!it.text.segments.get().length)continue;const He=a.an(it.textSizeData,xe.zoom),xt=a.aC(Ke,1,ee.transform.zoom),Gt=cr(Ie,ee.transform,xt),gi=ie.layout.get("icon-text-fit")!=="none"&&it.hasIconData();if(He){const Ti=Math.pow(2,xe.zoom-Ke.tileID.overscaledZ),wi=Oe?(Gi,Yi)=>Oe.getElevation(De,Gi,Yi):null;og(it,Ie,$e,ae,xe,Gt,Ti,He,gi,a.aD(xe,Ke,he,me),De.toUnwrapped(),wi)}}})(z,S,M,$,M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),F),M.paint.get("icon-opacity").constantOr(1)!==0&&hh(S,$,M,z,!1,M.paint.get("icon-translate"),M.paint.get("icon-translate-anchor"),M.layout.get("icon-rotation-alignment"),M.layout.get("icon-pitch-alignment"),M.layout.get("icon-keep-upright"),V,W,B),M.paint.get("text-opacity").constantOr(1)!==0&&hh(S,$,M,z,!0,M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.layout.get("text-keep-upright"),V,W,B),$.map.showCollisionBoxes&&(B_(S,$,M,z,!0),B_(S,$,M,z,!1))})(n,u,f,g,this.style.placement.variableOffsets,b):a.cc(f)?(function(S,$,M,z,F){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:j}=F,B=M.paint.get("circle-opacity"),V=M.paint.get("circle-stroke-width"),W=M.paint.get("circle-stroke-opacity"),te=!M.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(V.constantOr(1)===0||W.constantOr(1)===0))return;const ee=S.context,ie=ee.gl,se=S.transform,ce=S.getDepthModeForSublayer(0,Ft.ReadOnly),oe=ci.disabled,he=S.colorModeForRenderPass(),me=[],ae=se.getCircleRadiusCorrection();for(let xe=0;xe<z.length;xe++){const Oe=z[xe],Ie=$.getTile(Oe),$e=Ie.getBucket(M);if(!$e)continue;const De=M.paint.get("circle-translate"),Ke=M.paint.get("circle-translate-anchor"),it=a.aD(se,Ie,De,Ke),He=$e.programConfigurations.get(M.id),xt=S.useProgram("circle",He),Gt=$e.layoutVertexBuffer,gi=$e.indexBuffer,Ti=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Oe),wi={programConfiguration:He,program:xt,layoutVertexBuffer:Gt,indexBuffer:gi,uniformValues:r2(S,Ie,M,it,ae),terrainData:Ti,projectionData:se.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!j,applyTerrainMatrix:!0})};if(te){const Gi=$e.segments.get();for(const Yi of Gi)me.push({segments:new a.aM([Yi]),sortKey:Yi.sortKey,state:wi})}else me.push({segments:$e.segments,sortKey:0,state:wi})}te&&me.sort(((xe,Oe)=>xe.sortKey-Oe.sortKey));for(const xe of me){const{programConfiguration:Oe,program:Ie,layoutVertexBuffer:$e,indexBuffer:De,uniformValues:Ke,terrainData:it,projectionData:He}=xe.state;Ie.draw(ee,ie.TRIANGLES,ce,oe,he,Mt.backCCW,Ke,it,He,M.id,$e,De,xe.segments,M.paint,S.transform.zoom,Oe)}})(n,u,f,g,b):a.cd(f)?(function(S,$,M,z,F){if(M.paint.get("heatmap-opacity")===0)return;const j=S.context,{isRenderingToTexture:B,isRenderingGlobe:V}=F;if(S.style.map.terrain){for(const W of z){const te=$.getTile(W);$.hasRenderableParent(W)||(S.renderPass==="offscreen"?ag(S,te,M,W,V):S.renderPass==="translucent"&&U_(S,M,W,B,V))}j.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?(function(W,te,ee,ie){const se=W.context,ce=se.gl,oe=W.transform,he=ci.disabled,me=new Li([ce.ONE,ce.ONE],a.bf.transparent,[!0,!0,!0,!0]);(function(ae,xe,Oe){const Ie=ae.gl;ae.activeTexture.set(Ie.TEXTURE1),ae.viewport.set([0,0,xe.width/4,xe.height/4]);let $e=Oe.heatmapFbos.get(a.c2);$e?(Ie.bindTexture(Ie.TEXTURE_2D,$e.colorAttachment.get()),ae.bindFramebuffer.set($e.framebuffer)):($e=ph(ae,xe.width/4,xe.height/4),Oe.heatmapFbos.set(a.c2,$e))})(se,W,ee),se.clear({color:a.bf.transparent});for(let ae=0;ae<ie.length;ae++){const xe=ie[ae];if(te.hasRenderableParent(xe))continue;const Oe=te.getTile(xe),Ie=Oe.getBucket(ee);if(!Ie)continue;const $e=Ie.programConfigurations.get(ee.id),De=W.useProgram("heatmap",$e),Ke=oe.getProjectionData({overscaledTileID:xe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),it=oe.getCircleRadiusCorrection();De.draw(se,ce.TRIANGLES,Ft.disabled,he,me,Mt.backCCW,S_(Oe,oe.zoom,ee.paint.get("heatmap-intensity"),it),null,Ke,ee.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,ee.paint,oe.zoom,$e)}se.viewport.set([0,0,W.width,W.height])})(S,$,M,z):S.renderPass==="translucent"&&(function(W,te){const ee=W.context,ie=ee.gl;ee.setColorMode(W.colorModeForRenderPass());const se=te.heatmapFbos.get(a.c2);se&&(ee.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,se.colorAttachment.get()),ee.activeTexture.set(ie.TEXTURE1),fh(ee,te).bind(ie.LINEAR,ie.CLAMP_TO_EDGE),W.useProgram("heatmapTexture").draw(ee,ie.TRIANGLES,Ft.disabled,ci.disabled,W.colorModeForRenderPass(),Mt.disabled,Zm(W,te,0,1),null,null,te.id,W.viewportBuffer,W.quadTriangleIndexBuffer,W.viewportSegments,te.paint,W.transform.zoom))})(S,M)})(n,u,f,g,b):a.ce(f)?(function(S,$,M,z,F){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:j}=F,B=M.paint.get("line-opacity"),V=M.paint.get("line-width");if(B.constantOr(1)===0||V.constantOr(1)===0)return;const W=S.getDepthModeForSublayer(0,Ft.ReadOnly),te=S.colorModeForRenderPass(),ee=M.paint.get("line-dasharray"),ie=M.paint.get("line-pattern"),se=ie.constantOr(1),ce=M.paint.get("line-gradient"),oe=M.getCrossfadeParameters(),he=se?"linePattern":ee?"lineSDF":ce?"lineGradient":"line",me=S.context,ae=me.gl,xe=S.transform;let Oe=!0;for(const Ie of z){const $e=$.getTile(Ie);if(se&&!$e.patternsLoaded())continue;const De=$e.getBucket(M);if(!De)continue;const Ke=De.programConfigurations.get(M.id),it=S.context.program.get(),He=S.useProgram(he,Ke),xt=Oe||He.program!==it,Gt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ie),gi=ie.constantOr(null);if(gi&&$e.imageAtlas){const Bt=$e.imageAtlas,Ci=Bt.patternPositions[gi.to.toString()],yr=Bt.patternPositions[gi.from.toString()];Ci&&yr&&Ke.setConstantPatternPositions(Ci,yr)}const Ti=xe.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),wi=xe.getPixelScale(),Gi=se?I_(S,$e,M,wi,oe):ee?Dl(S,$e,M,wi,ee,oe):ce?E_(S,$e,M,wi,De.lineClipsArray.length):Yd(S,$e,M,wi);if(se)me.activeTexture.set(ae.TEXTURE0),$e.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),Ke.updatePaintBuffers(oe);else if(ee&&(xt||S.lineAtlas.dirty))me.activeTexture.set(ae.TEXTURE0),S.lineAtlas.bind(me);else if(ce){const Bt=De.gradients[M.id];let Ci=Bt.texture;if(M.gradientVersion!==Bt.version){let yr=256;if(M.stepInterpolant){const Pr=$.getSource().maxzoom,Vr=Ie.canonical.z===Pr?Math.ceil(1<<S.transform.maxZoom-Ie.canonical.z):1;yr=a.ah(a.c3(De.maxLineLength/a.$*1024*Vr),256,me.maxTextureSize)}Bt.gradient=a.c4({expression:M.gradientExpression(),evaluationKey:"lineProgress",resolution:yr,image:Bt.gradient||void 0,clips:De.lineClipsArray}),Bt.texture?Bt.texture.update(Bt.gradient):Bt.texture=new a.T(me,Bt.gradient,ae.RGBA),Bt.version=M.gradientVersion,Ci=Bt.texture}me.activeTexture.set(ae.TEXTURE0),Ci.bind(M.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}const Yi=S.stencilModeForClipping(Ie);He.draw(me,ae.TRIANGLES,W,Yi,te,Mt.disabled,Gi,Gt,Ti,M.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,M.paint,S.transform.zoom,Ke,De.layoutVertexBuffer2),Oe=!1}})(n,u,f,g,b):a.cf(f)?(function(S,$,M,z,F){const j=M.paint.get("fill-color"),B=M.paint.get("fill-opacity");if(B.constantOr(1)===0)return;const{isRenderingToTexture:V}=F,W=S.colorModeForRenderPass(),te=M.paint.get("fill-pattern"),ee=S.opaquePassEnabledForLayer()&&!te.constantOr(1)&&j.constantOr(a.bf.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===ee){const ie=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?Ft.ReadWrite:Ft.ReadOnly);np(S,$,M,z,ie,W,!1,V)}if(S.renderPass==="translucent"&&M.paint.get("fill-antialias")){const ie=S.getDepthModeForSublayer(M.getPaintProperty("fill-outline-color")?2:0,Ft.ReadOnly);np(S,$,M,z,ie,W,!0,V)}})(n,u,f,g,b):a.cg(f)?(function(S,$,M,z,F){const j=M.paint.get("fill-extrusion-opacity");if(j===0)return;const{isRenderingToTexture:B}=F;if(S.renderPass==="translucent"){const V=new Ft(S.context.gl.LEQUAL,Ft.ReadWrite,S.depthRangeFor3D);if(j!==1||M.paint.get("fill-extrusion-pattern").constantOr(1))lg(S,$,M,z,V,ci.disabled,Li.disabled,B),lg(S,$,M,z,V,S.stencilModeFor3D(),S.colorModeForRenderPass(),B);else{const W=S.colorModeForRenderPass();lg(S,$,M,z,V,ci.disabled,W,B)}}})(n,u,f,g,b):a.ch(f)?(function(S,$,M,z,F){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:j}=F,B=S.context,V=S.style.projection.useSubdivision,W=S.getDepthModeForSublayer(0,Ft.ReadOnly),te=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(ee,ie,se,ce,oe,he,me){const ae=ee.context,xe=ae.gl;for(const Oe of se){const Ie=ie.getTile(Oe),$e=Ie.dem;if(!$e||!$e.data||!Ie.needsHillshadePrepare)continue;const De=$e.dim,Ke=$e.stride,it=$e.getPixels();if(ae.activeTexture.set(xe.TEXTURE1),ae.pixelStoreUnpackPremultiplyAlpha.set(!1),Ie.demTexture=Ie.demTexture||ee.getTileTexture(Ke),Ie.demTexture){const xt=Ie.demTexture;xt.update(it,{premultiply:!1}),xt.bind(xe.NEAREST,xe.CLAMP_TO_EDGE)}else Ie.demTexture=new a.T(ae,it,xe.RGBA,{premultiply:!1}),Ie.demTexture.bind(xe.NEAREST,xe.CLAMP_TO_EDGE);ae.activeTexture.set(xe.TEXTURE0);let He=Ie.fbo;if(!He){const xt=new a.T(ae,{width:De,height:De,data:null},xe.RGBA);xt.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),He=Ie.fbo=ae.createFramebuffer(De,De,!0,!1),He.colorAttachment.set(xt.texture)}ae.bindFramebuffer.set(He.framebuffer),ae.viewport.set([0,0,De,De]),ee.useProgram("hillshadePrepare").draw(ae,xe.TRIANGLES,oe,he,me,Mt.disabled,T_(Ie.tileID,$e),null,null,ce.id,ee.rasterBoundsBuffer,ee.quadTriangleIndexBuffer,ee.rasterBoundsSegments),Ie.needsHillshadePrepare=!1}})(S,$,z,M,W,ci.disabled,te),B.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(V){const[ee,ie,se]=S.stencilConfigForOverlapTwoPass(z);Ll(S,$,M,se,ee,W,te,!1,j),Ll(S,$,M,se,ie,W,te,!0,j)}else{const[ee,ie]=S.getStencilConfigForOverlapAndUpdateStencilID(z);Ll(S,$,M,ie,ee,W,te,!1,j)}})(n,u,f,g,b):a.ci(f)?(function(S,$,M,z,F){if(S.renderPass!=="translucent"||!z.length)return;const{isRenderingToTexture:j}=F,B=S.style.projection.useSubdivision,V=S.getDepthModeForSublayer(0,Ft.ReadOnly),W=S.colorModeForRenderPass();if(B){const[te,ee,ie]=S.stencilConfigForOverlapTwoPass(z);cg(S,$,M,ie,te,V,W,!1,j),cg(S,$,M,ie,ee,V,W,!0,j)}else{const[te,ee]=S.getStencilConfigForOverlapAndUpdateStencilID(z);cg(S,$,M,ee,te,V,W,!1,j)}})(n,u,f,g,b):a.cj(f)?(function(S,$,M,z,F){if(S.renderPass!=="translucent"||M.paint.get("raster-opacity")===0||!z.length)return;const{isRenderingToTexture:j}=F,B=$.getSource(),V=S.style.projection.useSubdivision;if(B instanceof xo)Fl(S,$,M,z,null,!1,!1,B.tileCoords,B.flippedWindingOrder,j);else if(V){const[W,te,ee]=S.stencilConfigForOverlapTwoPass(z);Fl(S,$,M,ee,W,!1,!0,sp,!1,j),Fl(S,$,M,ee,te,!0,!0,sp,!1,j)}else{const[W,te]=S.getStencilConfigForOverlapAndUpdateStencilID(z);Fl(S,$,M,te,W,!1,!0,sp,!1,j)}})(n,u,f,g,b):a.ck(f)?(function(S,$,M,z,F){const j=M.paint.get("background-color"),B=M.paint.get("background-opacity");if(B===0)return;const{isRenderingToTexture:V}=F,W=S.context,te=W.gl,ee=S.style.projection,ie=S.transform,se=ie.tileSize,ce=M.paint.get("background-pattern");if(S.isPatternMissing(ce))return;const oe=!ce&&j.a===1&&B===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==oe)return;const he=ci.disabled,me=S.getDepthModeForSublayer(0,oe==="opaque"?Ft.ReadWrite:Ft.ReadOnly),ae=S.colorModeForRenderPass(),xe=S.useProgram(ce?"backgroundPattern":"background"),Oe=z||Te(ie,{tileSize:se,terrain:S.style.map.terrain});ce&&(W.activeTexture.set(te.TEXTURE0),S.imageManager.bind(S.context));const Ie=M.getCrossfadeParameters();for(const $e of Oe){const De=ie.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),Ke=ce?M_(B,S,ce,{tileID:$e,tileSize:se},Ie):P_(B,j),it=S.style.map.terrain&&S.style.map.terrain.getTerrainData($e),He=ee.getMeshFromTileID(W,$e.canonical,!1,!0,"raster");xe.draw(W,te.TRIANGLES,me,he,ae,Mt.backCCW,Ke,it,De,M.id,He.vertexBuffer,He.indexBuffer,He.segments)}})(n,0,f,g,b):a.cl(f)&&(function(S,$,M,z){const{isRenderingGlobe:F}=z,j=S.context,B=M.implementation,V=S.style.projection,W=S.transform,te=W.getProjectionDataForCustomLayer(F),ee={farZ:W.farZ,nearZ:W.nearZ,fov:W.fov*Math.PI/180,modelViewProjectionMatrix:W.modelViewProjectionMatrix,projectionMatrix:W.projectionMatrix,shaderData:{variantName:V.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${V.shaderPreludeCode.vertexSource}`,define:V.shaderDefine},defaultProjectionData:te},ie=B.renderingMode?B.renderingMode:"2d";if(S.renderPass==="offscreen"){const se=B.prerender;se&&(S.setCustomLayerDefaults(),j.setColorMode(S.colorModeForRenderPass()),se.call(B,j.gl,ee),j.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),j.setColorMode(S.colorModeForRenderPass()),j.setStencilMode(ci.disabled);const se=ie==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,Ft.ReadOnly);j.setDepthMode(se),B.render(j.gl,ee),j.setDirty(),S.setBaseState(),j.bindFramebuffer.set(null)}})(n,0,f,b))}saveTileTexture(n){const u=this._tileTextures[n.size[0]];u?u.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const u=this.imageManager.getPattern(n.from.toString()),f=this.imageManager.getPattern(n.to.toString());return!u||!f}useProgram(n,u,f=!1,g=[]){this.cache=this.cache||{};const b=!!this.style.map.terrain,S=this.style.projection,$=f?Ls.projectionMercator:S.shaderPreludeCode,M=f?Zo:S.shaderDefine,z=n+(u?u.cacheKey:"")+`/${f?Il:S.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(b?"/terrain":"")+(g?`/${g.join("/")}`:"");return this.cache[z]||(this.cache[z]=new Hm(this.context,Ls[n],u,Km[n],this._showOverdrawInspector,b,$,M,g)),this.cache[z]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:u}=this.context.gl;return this.width!==n||this.height!==u}}function Nl(v,n){let u,f=!1,g=null,b=null;const S=()=>{g=null,f&&(v.apply(b,u),g=setTimeout(S,n),f=!1)};return(...$)=>(f=!0,b=this,u=$,g||S(),g)}class lp{constructor(n){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map((g=>g.split("="))).forEach((g=>{g[0]===this._hashName&&(f=g)})),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const f=u.join("/");let g=f;g.split("&").length>0&&(g=g.split("&")[0]),this._hashName&&(g=`${this._hashName}=${f}`);let b=window.location.hash.replace(g,"");b.startsWith("#&")?b=b.slice(0,1)+b.slice(2):b==="#"&&(b="");let S=window.location.href.replace(/(#.+)?$/,b);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=Nl(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,g),S=Math.round(u.lng*b)/b,$=Math.round(u.lat*b)/b,M=this._map.getBearing(),z=this._map.getPitch();let F="";if(F+=n?`/${S}/${$}/${f}`:`${f}/${$}/${S}`,(M||z)&&(F+="/"+Math.round(10*M)/10),z&&(F+=`/${Math.round(z)}`),this._hashName){const j=this._hashName;let B=!1;const V=window.location.hash.slice(1).split("&").map((W=>{const te=W.split("=")[0];return te===j?(B=!0,`${te}=${F}`):W})).filter((W=>W));return B||V.push(`${j}=${F}`),`#${V.join("&")}`}return`#${F}`}_isValidHash(n){if(n.length<3||n.some(isNaN))return!1;try{new a.S(+n[2],+n[1])}catch{return!1}const u=+n[0],f=+(n[3]||0),g=+(n[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&f>=-180&&f<=180&&g>=this._map.getMinPitch()&&g<=this._map.getMaxPitch()}}const Xo={linearity:.3,easing:a.cm(0,0,.3,1)},pg=a.e({deceleration:2500,maxSpeed:1400},Xo),H_=a.e({deceleration:20,maxSpeed:1400},Xo),Z_=a.e({deceleration:1e3,maxSpeed:360},Xo),W_=a.e({deceleration:1e3,maxSpeed:90},Xo),Y_=a.e({deceleration:1e3,maxSpeed:360},Xo);class X_{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:L.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=L.now();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,u.roll+=b.rollDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(u.pan.mag()){const b=Lc(u.pan.mag(),f,a.e({},pg,n||{})),S=u.pan.mult(b.amount/u.pan.mag()),$=this._map.cameraHelper.handlePanInertia(S,this._map.transform);g.center=$.easingCenter,g.offset=$.easingOffset,Bs(g,b)}if(u.zoom){const b=Lc(u.zoom,f,H_);g.zoom=this._map.transform.zoom+b.amount,Bs(g,b)}if(u.bearing){const b=Lc(u.bearing,f,Z_);g.bearing=this._map.transform.bearing+a.ah(b.amount,-179,179),Bs(g,b)}if(u.pitch){const b=Lc(u.pitch,f,W_);g.pitch=this._map.transform.pitch+b.amount,Bs(g,b)}if(u.roll){const b=Lc(u.roll,f,Y_);g.roll=this._map.transform.roll+a.ah(b.amount,-179,179),Bs(g,b)}if(g.zoom||g.bearing){const b=u.pinchAround===void 0?u.around:u.pinchAround;g.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),a.e(g,{noMoveStart:!0})}}function Bs(v,n){(!v.duration||v.duration<n.duration)&&(v.duration=n.duration,v.easing=n.easing)}function Lc(v,n,u){const{maxSpeed:f,linearity:g,deceleration:b}=u,S=a.ah(v*g/(n/1e3),-f,f),$=Math.abs(S)/(b*g);return{easing:u.easing,duration:1e3*$,amount:S*($/2)}}class Nn extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f,g={}){f=f instanceof MouseEvent?f:new MouseEvent(n,f);const b=O.mousePos(u.getCanvas(),f),S=u.unproject(b);super(n,a.e({point:b,lngLat:S,originalEvent:f},g)),this._defaultPrevented=!1,this.target=u}}class Fc extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f){const g=n==="touchend"?f.changedTouches:f.touches,b=O.touchPos(u.getCanvasContainer(),g),S=b.map((M=>u.unproject(M))),$=b.reduce(((M,z,F,j)=>M.add(z.div(j.length))),new a.P(0,0));super(n,{points:b,point:$,lngLats:S,lngLat:u.unproject($),originalEvent:f}),this._defaultPrevented=!1}}class fg extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f){super(n,{originalEvent:f}),this._defaultPrevented=!1}}class J_{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new fg(n.type,this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new Nn(n.type,this._map,n))}mouseup(n){this._map.fire(new Nn(n.type,this._map,n))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Nn(n.type,this._map,n))}dblclick(n){return this._firePreventable(new Nn(n.type,this._map,n))}mouseover(n){this._map.fire(new Nn(n.type,this._map,n))}mouseout(n){this._map.fire(new Nn(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Fc(n.type,this._map,n))}touchmove(n){this._map.fire(new Fc(n.type,this._map,n))}touchend(n){this._map.fire(new Fc(n.type,this._map,n))}touchcancel(n){this._map.fire(new Fc(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class K_{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Nn(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Nn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new Nn(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nc{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.screenPointToLocation(a.P.convert(n),this._map.terrain)}}class mg{constructor(n,u){this._map=n,this._tr=new Nc(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(O.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=f,this._box||(this._box=O.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const b=Math.min(g.x,f.x),S=Math.max(g.x,f.x),$=Math.min(g.y,f.y),M=Math.max(g.y,f.y);O.setTransform(this._box,`translate(${b}px,${$}px)`),this._box.style.width=S-b+"px",this._box.style.height=M-$+"px"}mouseupWindow(n,u){if(!this._active||n.button!==0)return;const f=this._startPos,g=u;if(this.reset(),O.suppressClick(),f.x!==g.x||f.y!==g.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:n})),{cameraAnimation:b=>b.fitScreenCoordinates(f,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(O.remove(this._box),this._box=null),O.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new a.l(n,{originalEvent:u}))}}function Bc(v,n){if(v.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${n.length}`);const u={};for(let f=0;f<v.length;f++)u[v[f].identifier]=n[f];return u}class Q_{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),f.length===this.numTouches&&(this.centroid=(function(g){const b=new a.P(0,0);for(const S of g)b._add(S);return b.div(g.length)})(u),this.touches=Bc(f,u)))}touchmove(n,u,f){if(this.aborted||!this.centroid)return;const g=Bc(f,u);for(const b in this.touches){const S=g[b];(!S||S.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(n,u,f){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Bn{constructor(n){this.singleTap=new Q_(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,u,f){this.singleTap.touchstart(n,u,f)}touchmove(n,u,f){this.singleTap.touchmove(n,u,f)}touchend(n,u,f){const g=this.singleTap.touchend(n,u,f);if(g){const b=n.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(g)<30;if(b&&S||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class js{constructor(n){this._tr=new Nc(n),this._zoomIn=new Bn({numTouches:1,numTaps:2}),this._zoomOut=new Bn({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,f){this._zoomIn.touchstart(n,u,f),this._zoomOut.touchstart(n,u,f)}touchmove(n,u,f){this._zoomIn.touchmove(n,u,f),this._zoomOut.touchmove(n,u,f)}touchend(n,u,f){const g=this._zoomIn.touchend(n,u,f),b=this._zoomOut.touchend(n,u,f),S=this._tr;return g?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(g)},{originalEvent:n})}):b?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(b)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jc{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const u=this._moveFunction(...n);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(n,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,u){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const g=Array.isArray(u)?u[0]:u;return!this._moved&&g.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(f,g))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&O.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Us=0,Uc=2,y2={[Us]:1,[Uc]:2};class yh{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const u=O.mouseButton(n);this._eventButton=u}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!(function(u,f){const g=y2[f];return u.buttons===void 0||(u.buttons&g)!==g})(n,this._eventButton)}isValidEndEvent(n){return O.mouseButton(n)===this._eventButton}}class _2{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}class v2{constructor(n=new yh({checkCorrectEvent:()=>!0}),u=new _2){this.mouseMoveStateManager=n,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(n,u,f){return n instanceof MouseEvent?u(n):typeof TouchEvent<"u"&&n instanceof TouchEvent?f(n):void 0}startMove(n){this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.startMove(u)),(u=>this.oneFingerTouchMoveStateManager.startMove(u)))}endMove(n){this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.endMove(u)),(u=>this.oneFingerTouchMoveStateManager.endMove(u)))}isValidStartEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidStartEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u)))}isValidMoveEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidMoveEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u)))}isValidEndEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidEndEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u)))}}const _h=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=n=>{n.preventDefault()}};class vh{constructor(n,u){this._clickTolerance=n.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,u,f){return this._calculateTransform(n,u,f)}touchmove(n,u,f){if(this._active){if(!this._shouldBePrevented(f.length))return n.preventDefault(),this._calculateTransform(n,u,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,u,f){this._calculateTransform(n,u,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,f){f.length>0&&(this._active=!0);const g=Bc(f,u),b=new a.P(0,0),S=new a.P(0,0);let $=0;for(const z in g){const F=g[z],j=this._touches[z];j&&(b._add(F),S._add(F.sub(j)),$++,g[z]=F)}if(this._touches=g,this._shouldBePrevented($)||!S.mag())return;const M=S.div($);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div($),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vs{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,f){if(!this._firstTwoTouches)return;n.preventDefault();const[g,b]=this._firstTwoTouches,S=ft(f,u,g),$=ft(f,u,b);if(!S||!$)return;const M=this._aroundCenter?null:S.add($).div(2);return this._move([S,$],M,n)}touchend(n,u,f){if(!this._firstTwoTouches)return;const[g,b]=this._firstTwoTouches,S=ft(f,u,g),$=ft(f,u,b);S&&$||(this._active&&O.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ft(v,n,u){for(let f=0;f<v.length;f++)if(v[f].identifier===u)return n[f]}function gg(v,n){return Math.log(v/n)/Math.LN2}class cp extends Vs{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const f=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(gg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:gg(this._distance,f),pinchAround:u}}}function yg(v,n){return 180*v.angleWith(n)/Math.PI}class Vc extends Vs{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u,f){const g=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:yg(this._vector,g),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,f=yg(n,this._startVector);return Math.abs(f)<u}}function Bl(v){return Math.abs(v.y)>Math.abs(v.x)}class up extends Vs{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,u,f){super.touchstart(n,u,f),this._currentTouchCount=f.length}_start(n){this._lastPoints=n,Bl(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=n[0].sub(this._lastPoints[0]),b=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,b,f.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(g.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(n,u,f){if(this._valid!==void 0)return this._valid;const g=n.mag()>=2,b=u.mag()>=2;if(!g&&!b)return;if(!g||!b)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const S=n.y>0==u.y>0;return Bl(n)&&Bl(u)&&S}}const ni={panStep:100,bearingStep:15,pitchStep:10};class hp{constructor(n){this._tr=new Nc(n);const u=ni;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,f=0,g=0,b=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?f=-1:(n.preventDefault(),b=-1);break;case 39:n.shiftKey?f=1:(n.preventDefault(),b=1);break;case 38:n.shiftKey?g=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?g=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:$=>{const M=this._tr;$.easeTo({duration:300,easeId:"keyboardHandler",easing:b2,zoom:u?Math.round(M.zoom)+u*(n.shiftKey?2:1):M.zoom,bearing:M.bearing+f*this._bearingStep,pitch:M.pitch+g*this._pitchStep,offset:[-b*this._panStep,-S*this._panStep],center:M.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function b2(v){return v*(2-v)}const dp=4.000244140625,x2=1/450;class ev{constructor(n,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=n,this._tr=new Nc(n),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=x2}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const f=L.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,u!==0&&u%dp==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(g*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=O.mousePos(this._map.getCanvas(),n),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(a.S.convert(f.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const $=n.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=$),typeof this._targetZoom=="number"&&(this._targetZoom+=$)}if(this._delta!==0){const $=this._type==="wheel"&&Math.abs(this._delta)>dp?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*$)));this._delta<0&&M!==0&&(M=1/M);const z=typeof this._targetZoom!="number"?n.scale:a.af(this._targetZoom);this._targetZoom=n.getConstrained(n.getCameraLngLat(),a.ak(z*M)).zoom,this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?n.zoom:this._targetZoom,f=this._startZoom,g=this._easing;let b,S=!1;if(this._type==="wheel"&&f&&g){const $=L.now()-this._lastWheelEventTime,M=Math.min(($+5)/200,1),z=g(M);b=a.C.number(f,u,z),M<1?this._frameId||(this._frameId=!0):S=!0}else b=u,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=b,{noInertia:!0,needsRenderFrame:!S,zoomDelta:b-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=a.co;if(this._prevEase){const f=this._prevEase,g=(L.now()-f.start)/f.duration,b=f.easing(g+.01)-f.easing(g),S=.27/Math.sqrt(b*b+1e-4)*.01,$=Math.sqrt(.0729-S*S);u=a.cm(S,$,.25,1)}return this._prevEase={start:L.now(),duration:n,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class _g{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class vg{constructor(n){this._tr=new Nc(n),this.reset()}reset(){this._active=!1}dblclick(n,u){return n.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tv{constructor(){this._tap=new Bn({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,u,f){if(!this._swipePoint)if(this._tapTime){const g=u[0],b=n.timeStamp-this._tapTime<500,S=this._tapPoint.dist(g)<30;b&&S?f.length>0&&(this._swipePoint=g,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(n,u,f)}touchmove(n,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=u[0],b=g.y-this._swipePoint.y;return this._swipePoint=g,n.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(n,u,f)}touchend(n,u,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const g=this._tap.touchend(n,u,f);g&&(this._tapTime=n.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class iv{constructor(n,u,f){this._el=n,this._mousePan=u,this._touchPan=f}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class bg{constructor(n,u,f,g){this._pitchWithRotate=n.pitchWithRotate,this._rollEnabled=n.rollEnabled,this._mouseRotate=u,this._mousePitch=f,this._mouseRoll=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class rv{constructor(n,u,f,g){this._el=n,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class nv{constructor(n,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=O.create("div","maplibregl-cooperative-gesture-screen",n);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=u,this._container.appendChild(g);const b=document.createElement("div");b.className="maplibregl-mobile-message",b.textContent=f,this._container.appendChild(b),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(O.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,u){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:n,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Gs=v=>v.zoom||v.drag||v.roll||v.pitch||v.rotate;class Pi extends a.l{}function Gc(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta||v.rollDelta}class xg{constructor(n,u){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,b)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=g.type==="renderFrame"?void 0:g,$={needsRenderFrame:!1},M={},z={};for(const{handlerName:B,handler:V,allowed:W}of this._handlers){if(!V.isEnabled())continue;let te;if(this._blockedByActive(z,W,B))V.reset();else if(V[b||g.type]){if(a.cp(g,b||g.type)){const ee=O.mousePos(this._map.getCanvas(),g);te=V[b||g.type](g,ee)}else if(a.cq(g,b||g.type)){const ee=this._getMapTouches(g.touches),ie=O.touchPos(this._map.getCanvas(),ee);te=V[b||g.type](g,ie,ee)}else a.cr(b||g.type)||(te=V[b||g.type](g));this.mergeHandlerResult($,M,te,B,S),te&&te.needsRenderFrame&&this._triggerRenderFrame()}(te||V.isActive())&&(z[B]=V)}const F={};for(const B in this._previousActiveHandlers)z[B]||(F[B]=S);this._previousActiveHandlers=z,(Object.keys(F).length||Gc($))&&(this._changes.push([$,M,F]),this._triggerRenderFrame()),(Object.keys(z).length||Gc($))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=$;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new X_(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,b,S]of this._listeners)O.addEventListener(g,b,g===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[n,u,f]of this._listeners)O.removeEventListener(n,u,n===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(n){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new J_(u,n));const g=u.boxZoom=new mg(u,n);this._add("boxZoom",g),n.interactive&&n.boxZoom&&g.enable();const b=u.cooperativeGestures=new nv(u,n.cooperativeGestures);this._add("cooperativeGestures",b),n.cooperativeGestures&&b.enable();const S=new js(u),$=new vg(u);u.doubleClickZoom=new _g($,S),this._add("tapZoom",S),this._add("clickZoom",$),n.interactive&&n.doubleClickZoom&&u.doubleClickZoom.enable();const M=new tv;this._add("tapDragZoom",M);const z=u.touchPitch=new up(u);this._add("touchPitch",z),n.interactive&&n.touchPitch&&u.touchPitch.enable(n.touchPitch);const F=()=>u.project(u.getCenter()),j=(function({enable:oe,clickTolerance:he,aroundCenter:me=!0,minPixelCenterThreshold:ae=100,rotateDegreesPerPixelMoved:xe=.8},Oe){const Ie=new yh({checkCorrectEvent:$e=>O.mouseButton($e)===0&&$e.ctrlKey||O.mouseButton($e)===2&&!$e.ctrlKey});return new jc({clickTolerance:he,move:($e,De)=>{const Ke=Oe();if(me&&Math.abs(Ke.y-$e.y)>ae)return{bearingDelta:a.cn(new a.P($e.x,De.y),De,Ke)};let it=(De.x-$e.x)*xe;return me&&De.y<Ke.y&&(it=-it),{bearingDelta:it}},moveStateManager:Ie,enable:oe,assignEvents:_h})})(n,F),B=(function({enable:oe,clickTolerance:he,pitchDegreesPerPixelMoved:me=-.5}){const ae=new yh({checkCorrectEvent:xe=>O.mouseButton(xe)===0&&xe.ctrlKey||O.mouseButton(xe)===2});return new jc({clickTolerance:he,move:(xe,Oe)=>({pitchDelta:(Oe.y-xe.y)*me}),moveStateManager:ae,enable:oe,assignEvents:_h})})(n),V=(function({enable:oe,clickTolerance:he,rollDegreesPerPixelMoved:me=.3},ae){const xe=new yh({checkCorrectEvent:Oe=>O.mouseButton(Oe)===2&&Oe.ctrlKey});return new jc({clickTolerance:he,move:(Oe,Ie)=>{const $e=ae();let De=(Ie.x-Oe.x)*me;return Ie.y<$e.y&&(De=-De),{rollDelta:De}},moveStateManager:xe,enable:oe,assignEvents:_h})})(n,F);u.dragRotate=new bg(n,j,B,V),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",B,["mouseRotate","mouseRoll"]),this._add("mouseRoll",V,["mousePitch"]),n.interactive&&n.dragRotate&&u.dragRotate.enable();const W=(function({enable:oe,clickTolerance:he}){const me=new yh({checkCorrectEvent:ae=>O.mouseButton(ae)===0&&!ae.ctrlKey});return new jc({clickTolerance:he,move:(ae,xe)=>({around:xe,panDelta:xe.sub(ae)}),activateOnStart:!0,moveStateManager:me,enable:oe,assignEvents:_h})})(n),te=new vh(n,u);u.dragPan=new iv(f,W,te),this._add("mousePan",W),this._add("touchPan",te,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&u.dragPan.enable(n.dragPan);const ee=new Vc,ie=new cp;u.touchZoomRotate=new rv(f,ie,ee,M),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&u.touchZoomRotate.enable(n.touchZoomRotate);const se=u.scrollZoom=new ev(u,(()=>this._triggerRenderFrame()));this._add("scrollZoom",se,["mousePan"]),n.interactive&&n.scrollZoom&&u.scrollZoom.enable(n.scrollZoom);const ce=u.keyboard=new hp(u);this._add("keyboard",ce),n.interactive&&n.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new K_(u))}_add(n,u,f){this._handlers.push({handlerName:n,handler:u,allowed:f}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Gs(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,u,f){for(const g in n)if(g!==f&&(!u||u.indexOf(g)<0))return!0;return!1}_getMapTouches(n){const u=[];for(const f of n)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(n,u,f,g,b){if(!f)return;a.e(n,f);const S={handlerName:g,originalEvent:f.originalEvent||b};f.zoomDelta!==void 0&&(u.zoom=S),f.panDelta!==void 0&&(u.drag=S),f.rollDelta!==void 0&&(u.roll=S),f.pitchDelta!==void 0&&(u.pitch=S),f.bearingDelta!==void 0&&(u.rotate=S)}_applyChanges(){const n={},u={},f={};for(const[g,b,S]of this._changes)g.panDelta&&(n.panDelta=(n.panDelta||new a.P(0,0))._add(g.panDelta)),g.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+g.pitchDelta),g.rollDelta&&(n.rollDelta=(n.rollDelta||0)+g.rollDelta),g.around!==void 0&&(n.around=g.around),g.pinchAround!==void 0&&(n.pinchAround=g.pinchAround),g.noInertia&&(n.noInertia=g.noInertia),a.e(u,b),a.e(f,S);this._updateMapTransform(n,u,f),this._changes=[]}_updateMapTransform(n,u,f){const g=this._map,b=g._getTransformForUpdate(),S=g.terrain;if(!(Gc(n)||S&&this._terrainMovement))return this._fireEvents(u,f,!0);g._stop(!0);let{panDelta:$,zoomDelta:M,bearingDelta:z,pitchDelta:F,rollDelta:j,around:B,pinchAround:V}=n;V!==void 0&&(B=V),B=B||g.transform.centerPoint,S&&!b.isPointOnMapSurface(B)&&(B=b.centerPoint);const W={panDelta:$,zoomDelta:M,rollDelta:j,pitchDelta:F,bearingDelta:z,around:B};this._map.cameraHelper.useGlobeControls&&!b.isPointOnMapSurface(B)&&(B=b.centerPoint);const te=B.distSqr(b.centerPoint)<.01?b.center:b.screenPointToLocation($?B.sub($):B);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,b),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?b.setCenter(b.screenPointToLocation(b.centerPoint.sub($))):this._map.cameraHelper.handleMapControlsPan(W,b,te):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(W,b,te))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,b),this._map.cameraHelper.handleMapControlsPan(W,b,te)),g._applyUpdatedTransform(b),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,f,!0)}_fireEvents(n,u,f){const g=Gs(this._eventsInProgress),b=Gs(n),S={};for(const j in n){const{originalEvent:B}=n[j];this._eventsInProgress[j]||(S[`${j}start`]=B),this._eventsInProgress[j]=n[j]}!g&&b&&this._fireEvent("movestart",b.originalEvent);for(const j in S)this._fireEvent(j,S[j]);b&&this._fireEvent("move",b.originalEvent);for(const j in n){const{originalEvent:B}=n[j];this._fireEvent(j,B)}const $={};let M;for(const j in this._eventsInProgress){const{handlerName:B,originalEvent:V}=this._eventsInProgress[j];this._handlersById[B].isActive()||(delete this._eventsInProgress[j],M=u[B]||V,$[`${j}end`]=M)}for(const j in $)this._fireEvent(j,$[j]);const z=Gs(this._eventsInProgress),F=(g||b)&&!z;if(F&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const j=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&j.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(j)}if(f&&F){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=V=>V!==0&&-this._bearingSnap<V&&V<this._bearingSnap;!j||!j.essential&&L.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:M})),B(this._map.getBearing())&&this._map.resetNorth()):(B(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new a.l(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((n=>{delete this._frameId,this.handleEvent(new Pi("renderFrame",{timeStamp:n})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class sv extends a.E{constructor(n,u,f){super(),this._renderFrameCallback=()=>{const g=Math.min((L.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=f.bearingSnap,this.cameraHelper=u,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(n,u){n.apply(this.transform),this.transform=n,this.cameraHelper=u}getCenter(){return new a.S(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(n,u){return this.jumpTo({elevation:n},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(n){this._centerClampedToGround=n}panBy(n,u,f){return n=a.P.convert(n).mult(-1),this.panTo(this.transform.center,a.e({offset:n},u),f)}panTo(n,u,f){return this.easeTo(a.e({center:n},u),f)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,f){return this.easeTo(a.e({zoom:n},u),f)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(n,u){return n!=this.transform.fov&&(this.transform.setFov(n),this.fire(new a.l("movestart",u)).fire(new a.l("move",u)).fire(new a.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,f){return this.easeTo(a.e({bearing:n},u),f)}resetNorth(n,u){return this.rotateTo(0,a.e({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}getRoll(){return this.transform.roll}setRoll(n,u){return this.jumpTo({roll:n},u),this}cameraForBounds(n,u){n=Qi.convert(n).adjustAntiMeridian();const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),f,u)}_cameraForBoxAndBearing(n,u,f,g){const b={top:0,bottom:0,right:0,left:0};if(typeof(g=a.e({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const z=g.padding;g.padding={top:z,bottom:z,right:z,left:z}}const S=a.e(b,g.padding);g.padding=S;const $=this.transform,M=new Qi(n,u);return this.cameraHelper.cameraForBoxAndBearing(g,S,M,f,$)}fitBounds(n,u,f){return this._fitInternal(this.cameraForBounds(n,u),u,f)}fitScreenCoordinates(n,u,f,g,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(n)),this.transform.screenPointToLocation(a.P.convert(u)),f,g),g,b)}_fitInternal(n,u,f){return n?(delete(u=a.e(n,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(n,u){this.stop();const f=this._getTransformForUpdate();let g=!1,b=!1,S=!1;const $=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,n);const M=f.zoom!==$;return"elevation"in n&&f.elevation!==+n.elevation&&f.setElevation(+n.elevation),"bearing"in n&&f.bearing!==+n.bearing&&(g=!0,f.setBearing(+n.bearing)),"pitch"in n&&f.pitch!==+n.pitch&&(b=!0,f.setPitch(+n.pitch)),"roll"in n&&f.roll!==+n.roll&&(S=!0,f.setRoll(+n.roll)),n.padding==null||f.isPaddingEqual(n.padding)||f.setPadding(n.padding),this._applyUpdatedTransform(f),this.fire(new a.l("movestart",u)).fire(new a.l("move",u)),M&&this.fire(new a.l("zoomstart",u)).fire(new a.l("zoom",u)).fire(new a.l("zoomend",u)),g&&this.fire(new a.l("rotatestart",u)).fire(new a.l("rotate",u)).fire(new a.l("rotateend",u)),b&&this.fire(new a.l("pitchstart",u)).fire(new a.l("pitch",u)).fire(new a.l("pitchend",u)),S&&this.fire(new a.l("rollstart",u)).fire(new a.l("roll",u)).fire(new a.l("rollend",u)),this.fire(new a.l("moveend",u))}calculateCameraOptionsFromTo(n,u,f,g=0){const b=a.a1.fromLngLat(n,u),S=a.a1.fromLngLat(f,g),$=S.x-b.x,M=S.y-b.y,z=S.z-b.z,F=Math.hypot($,M,z);if(F===0)throw new Error("Can't calculate camera options with same From and To");const j=Math.hypot($,M),B=a.ak(this.transform.cameraToCenterDistance/F/this.transform.tileSize),V=180*Math.atan2($,-M)/Math.PI;let W=180*Math.acos(j/F)/Math.PI;return W=z<0?90-W:90+W,{center:S.toLngLat(),elevation:g,zoom:B,pitch:W,bearing:V}}calculateCameraOptionsFromCameraLngLatAltRotation(n,u,f,g,b){const S=this.transform.calculateCenterFromCameraLngLatAlt(n,u,f,g);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:f,pitch:g,roll:b}}easeTo(n,u){this._stop(!1,n.easeId),((n=a.e({offset:[0,0],duration:500,easing:a.co},n)).animate===!1||!n.essential&&L.prefersReducedMotion)&&(n.duration=0);const f=this._getTransformForUpdate(),g=this.getBearing(),b=f.pitch,S=f.roll,$="bearing"in n?this._normalizeBearing(n.bearing,g):g,M="pitch"in n?+n.pitch:b,z="roll"in n?this._normalizeBearing(n.roll,S):S,F="padding"in n?n.padding:f.padding,j=a.P.convert(n.offset);let B,V;n.around&&(B=a.S.convert(n.around),V=f.locationToScreenPoint(B));const W={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},te=this.cameraHelper.handleEaseTo(f,{bearing:$,pitch:M,roll:z,padding:F,around:B,aroundPoint:V,offsetAsPoint:j,offset:n.offset,zoom:n.zoom,center:n.center});return this._rotating=this._rotating||g!==$,this._pitching=this._pitching||M!==b,this._rolling=this._rolling||z!==S,this._padding=!f.isPaddingEqual(F),this._zooming=this._zooming||te.isZooming,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,W),this.terrain&&this._prepareElevation(te.elevationCenter),this._ease((ee=>{te.easeFunc(ee),this.terrain&&!n.freezeElevation&&this._updateElevation(ee),this._applyUpdatedTransform(f),this._fireMoveEvents(u)}),(ee=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u,ee)}),n),this}_prepareEase(n,u,f={}){this._moving=!0,u||f.moving||this.fire(new a.l("movestart",n)),this._zooming&&!f.zooming&&this.fire(new a.l("zoomstart",n)),this._rotating&&!f.rotating&&this.fire(new a.l("rotatestart",n)),this._pitching&&!f.pitching&&this.fire(new a.l("pitchstart",n)),this._rolling&&!f.rolling&&this.fire(new a.l("rollstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&u!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(f-(u-(f*n+this._elevationStart))/(1-n)),this._elevationTarget=u}this.transform.setElevation(a.C.number(this._elevationStart,this._elevationTarget,n))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){if(!this.terrain&&n.elevation>=0&&n.pitch<=90)return{};const u=n.getCameraLngLat(),f=n.getCameraAltitude(),g=this.terrain?this.terrain.getElevationForLngLatZoom(u,n.zoom):0;if(f<g){const b=this.calculateCameraOptionsFromTo(u,g,n.center,n.elevation);return{pitch:b.pitch,zoom:b.zoom}}return{}}_applyUpdatedTransform(n){const u=[];if(u.push((g=>this._elevateCameraIfInsideTerrain(g))),this.transformCameraUpdate&&u.push((g=>this.transformCameraUpdate(g))),!u.length)return;const f=n.clone();for(const g of u){const b=f.clone(),{center:S,zoom:$,roll:M,pitch:z,bearing:F,elevation:j}=g(b);S&&b.setCenter(S),j!==void 0&&b.setElevation(j),$!==void 0&&b.setZoom($),M!==void 0&&b.setRoll(M),z!==void 0&&b.setPitch(z),F!==void 0&&b.setBearing(F),f.apply(b)}this.transform.apply(f)}_fireMoveEvents(n){this.fire(new a.l("move",n)),this._zooming&&this.fire(new a.l("zoom",n)),this._rotating&&this.fire(new a.l("rotate",n)),this._pitching&&this.fire(new a.l("pitch",n)),this._rolling&&this.fire(new a.l("roll",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const f=this._zooming,g=this._rotating,b=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new a.l("zoomend",n)),g&&this.fire(new a.l("rotateend",n)),b&&this.fire(new a.l("pitchend",n)),S&&this.fire(new a.l("rollend",n)),this.fire(new a.l("moveend",n))}flyTo(n,u){if(!n.essential&&L.prefersReducedMotion){const De=a.Q(n,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(De,u)}this.stop(),n=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.co},n);const f=this._getTransformForUpdate(),g=f.bearing,b=f.pitch,S=f.roll,$=f.padding,M="bearing"in n?this._normalizeBearing(n.bearing,g):g,z="pitch"in n?+n.pitch:b,F="roll"in n?this._normalizeBearing(n.roll,S):S,j="padding"in n?n.padding:f.padding,B=a.P.convert(n.offset);let V=f.centerPoint.add(B);const W=f.screenPointToLocation(V),te=this.cameraHelper.handleFlyTo(f,{bearing:M,pitch:z,roll:F,padding:j,locationAtOffset:W,offsetAsPoint:B,center:n.center,minZoom:n.minZoom,zoom:n.zoom});let ee=n.curve;const ie=Math.max(f.width,f.height),se=ie/te.scaleOfZoom,ce=te.pixelPathLength;typeof te.scaleOfMinZoom=="number"&&(ee=Math.sqrt(ie/te.scaleOfMinZoom/ce*2));const oe=ee*ee;function he(De){const Ke=(se*se-ie*ie+(De?-1:1)*oe*oe*ce*ce)/(2*(De?se:ie)*oe*ce);return Math.log(Math.sqrt(Ke*Ke+1)-Ke)}function me(De){return(Math.exp(De)-Math.exp(-De))/2}function ae(De){return(Math.exp(De)+Math.exp(-De))/2}const xe=he(!1);let Oe=function(De){return ae(xe)/ae(xe+ee*De)},Ie=function(De){return ie*((ae(xe)*(me(Ke=xe+ee*De)/ae(Ke))-me(xe))/oe)/ce;var Ke},$e=(he(!0)-xe)/ee;if(Math.abs(ce)<2e-6||!isFinite($e)){if(Math.abs(ie-se)<1e-6)return this.easeTo(n,u);const De=se<ie?-1:1;$e=Math.abs(Math.log(se/ie))/ee,Ie=()=>0,Oe=Ke=>Math.exp(De*ee*Ke)}return n.duration="duration"in n?+n.duration:1e3*$e/("screenSpeed"in n?+n.screenSpeed/ee:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=g!==M,this._pitching=z!==b,this._rolling=F!==S,this._padding=!f.isPaddingEqual(j),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(te.targetCenter),this._ease((De=>{const Ke=De*$e,it=1/Oe(Ke),He=Ie(Ke);this._rotating&&f.setBearing(a.C.number(g,M,De)),this._pitching&&f.setPitch(a.C.number(b,z,De)),this._rolling&&f.setRoll(a.C.number(S,F,De)),this._padding&&(f.interpolatePadding($,j,De),V=f.centerPoint.add(B)),te.easeFunc(De,it,He,V),this.terrain&&!n.freezeElevation&&this._updateElevation(De),this._applyUpdatedTransform(f),this._fireMoveEvents(u)}),(()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u)}),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,u){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,u)}return n||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(n,u,f){f.animate===!1||f.duration===0?(n(1),u()):(this._easeStart=L.now(),this._easeOptions=f,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,u){n=a.aO(n,-180,180);const f=Math.abs(n-u);return Math.abs(n-360-u)<f&&(n-=360),Math.abs(n+360-u)<f&&(n+=360),n}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(a.S.convert(n),this.transform.tileZoom):null}}const wg={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Sg{constructor(n=wg){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=O.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=O.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=O.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){O.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,u){const f=this._map._getUIString(`AttributionControl.${u}`);n.title=f,n.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map((g=>typeof g!="string"?"":g))):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const u=this._map.style.sourceCaches;for(const g in u){const b=u[g];if(b.used||b.usedForTerrain){const S=b.getSource();S.attribution&&n.indexOf(S.attribution)<0&&n.push(S.attribution)}}n=n.filter((g=>String(g).trim())),n.sort(((g,b)=>g.length-b.length)),n=n.filter(((g,b)=>{for(let S=b+1;S<n.length;S++)if(n[S].indexOf(g)>=0)return!1;return!0}));const f=n.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,n.length?(this._innerContainer.innerHTML=O.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ov{constructor(n={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=O.create("div","maplibregl-ctrl");const u=O.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){O.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Io{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const g of f)if(g.id===n)return void(g.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var pp=a.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Tt extends a.E{constructor(n){super(),this._lastTilesetChange=L.now(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=n._source.tileSize*2**this.deltaZoom,n.usedForTerrain=!0,n.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,u){this.sourceCache.update(n,u),this._renderableTilesKeys=[];const f={};for(const g of Te(n,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.terrainRttPosMatrix32f=new Float64Array(16),a.bY(g.terrainRttPosMatrix32f,0,a.$,a.$,0,0,1),this._tiles[g.key]=new Cc(g,this.tileSize),this._lastTilesetChange=L.now());for(const g in this._tiles)f[g]||delete this._tiles[g]}freeRtt(n){for(const u in this._tiles){const f=this._tiles[u];(!n||f.tileID.equals(n)||f.tileID.isChildOf(n)||n.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((n=>this.getTileByID(n)))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n,u){return u?this._getTerrainCoordsForTileRanges(n,u):this._getTerrainCoordsForRegularTile(n)}_getTerrainCoordsForRegularTile(n){const u={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID,b=n.clone(),S=a.ba();if(g.canonical.equals(n.canonical))a.bY(S,0,a.$,a.$,0,0,1);else if(g.canonical.isChildOf(n.canonical)){const $=g.canonical.z-n.canonical.z,M=g.canonical.x-(g.canonical.x>>$<<$),z=g.canonical.y-(g.canonical.y>>$<<$),F=a.$>>$;a.bY(S,0,F,F,0,0,1),a.M(S,S,[-M*F,-z*F,0])}else{if(!n.canonical.isChildOf(g.canonical))continue;{const $=n.canonical.z-g.canonical.z,M=n.canonical.x-(n.canonical.x>>$<<$),z=n.canonical.y-(n.canonical.y>>$<<$),F=a.$>>$;a.bY(S,0,a.$,a.$,0,0,1),a.M(S,S,[M*F,z*F,0]),a.N(S,S,[1/2**$,1/2**$,0])}}b.terrainRttPosMatrix32f=new Float32Array(S),u[f]=b}return u}_getTerrainCoordsForTileRanges(n,u){const f={};for(const g of this._renderableTilesKeys){const b=this._tiles[g].tileID;if(!this._isWithinTileRanges(b,u))continue;const S=n.clone(),$=a.ba();if(b.canonical.z===n.canonical.z){const M=n.canonical.x-b.canonical.x,z=n.canonical.y-b.canonical.y;a.bY($,0,a.$,a.$,0,0,1),a.M($,$,[M*a.$,z*a.$,0])}else if(b.canonical.z>n.canonical.z){const M=b.canonical.z-n.canonical.z,z=b.canonical.x-(b.canonical.x>>M<<M),F=b.canonical.y-(b.canonical.y>>M<<M),j=n.canonical.x-(b.canonical.x>>M),B=n.canonical.y-(b.canonical.y>>M),V=a.$>>M;a.bY($,0,V,V,0,0,1),a.M($,$,[-z*V+j*a.$,-F*V+B*a.$,0])}else{const M=n.canonical.z-b.canonical.z,z=n.canonical.x-(n.canonical.x>>M<<M),F=n.canonical.y-(n.canonical.y>>M<<M),j=(n.canonical.x>>M)-b.canonical.x,B=(n.canonical.y>>M)-b.canonical.y,V=a.$<<M;a.bY($,0,V,V,0,0,1),a.M($,$,[z*a.$+j*V,F*a.$+B*V,0])}S.terrainRttPosMatrix32f=new Float32Array($),f[g]=S}return f}getSourceTile(n,u){const f=this.sourceCache._source;let g=n.overscaledZ-this.deltaZoom;if(g>f.maxzoom&&(g=f.maxzoom),g<f.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(g).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!b||!b.dem)&&u)for(;g>=f.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(n.scaledTo(g--).key);return b}anyTilesAfterTime(n=Date.now()){return this._lastTilesetChange>=n}_isWithinTileRanges(n,u){return u[n.canonical.z]&&n.canonical.x>=u[n.canonical.z].minTileX&&n.canonical.x<=u[n.canonical.z].maxTileX&&n.canonical.y>=u[n.canonical.z].minTileY&&n.canonical.y<=u[n.canonical.z].maxTileY}}class Pt{constructor(n,u,f){this._meshCache={},this.painter=n,this.sourceCache=new Tt(u),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,u,f,g=a.$){var b;if(!(u>=0&&u<g&&f>=0&&f<g))return 0;const S=this.getTerrainData(n),$=(b=S.tile)===null||b===void 0?void 0:b.dem;if(!$)return 0;const M=a.cs([],[u/g*a.$,f/g*a.$],S.u_terrain_matrix),z=[M[0]*$.dim,M[1]*$.dim],F=Math.floor(z[0]),j=Math.floor(z[1]),B=z[0]-F,V=z[1]-j;return $.get(F,j)*(1-B)*(1-V)+$.get(F+1,j)*B*(1-V)+$.get(F,j+1)*(1-B)*V+$.get(F+1,j+1)*B*V}getElevationForLngLatZoom(n,u){if(!a.ct(u,n.wrap()))return 0;const{tileID:f,mercatorX:g,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(n,u);return this.getElevation(f,g%a.$,b%a.$,a.$)}getElevation(n,u,f,g=a.$){return this.getDEMElevation(n,u,f,g)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const g=this.painter.context,b=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new a.T(g,b,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new a.T(g,new a.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ag([])}const u=this.sourceCache.getSourceTile(n,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const g=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new a.T(g,u.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),u.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+n.key;if(f&&!this._demMatrixCache[f]){const g=this.sourceCache.sourceCache._source.maxzoom;let b=n.canonical.z-u.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=g?b=n.canonical.z-g:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=n.canonical.x-(n.canonical.x>>b<<b),$=n.canonical.y-(n.canonical.y>>b<<b),M=a.cu(new Float64Array(16),[1/(a.$<<b),1/(a.$<<b),0]);a.M(M,M,[S*a.$,$*a.$,0]),this._demMatrixCache[n.key]={matrix:M,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(n){const u=this.painter,f=u.width/devicePixelRatio,g=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new a.T(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new a.T(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,g,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,g))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,S=0;b<this._coordsTextureSize;b++)for(let $=0;$<this._coordsTextureSize;$++,S+=4)u[S+0]=255&$,u[S+1]=255&b,u[S+2]=$>>8<<4|b>>8,u[S+3]=0;const f=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),g=new a.T(n,f,n.gl.RGBA,{premultiply:!1});return g.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),f=this.painter.context,g=f.gl,b=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),$=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(b,$-S-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);const M=u[0]+(u[2]>>4<<8),z=u[1]+((15&u[2])<<8),F=this.coordsIndex[255-u[3]],j=F&&this.sourceCache.getTileByID(F);if(!j)return null;const B=this._coordsTextureSize,V=(1<<j.tileID.canonical.z)*B;return new a.a1((j.tileID.canonical.x*B+M)/V+j.tileID.wrap,(j.tileID.canonical.y*B+z)/V,this.getElevation(j.tileID,M,z,B))}depthAtPoint(n){const u=new Uint8Array(4),f=this.painter.context,g=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(n){var u;const f=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,g=f&&n.canonical.y===0,b=f&&n.canonical.y===(1<<n.canonical.z)-1,S=`m_${g?"n":""}_${b?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const $=this.painter.context,M=new a.cv,z=new a.aN,F=this.meshSize,j=a.$/F,B=F*F;for(let ae=0;ae<=F;ae++)for(let xe=0;xe<=F;xe++)M.emplaceBack(xe*j,ae*j,0);for(let ae=0;ae<B;ae+=F+1)for(let xe=0;xe<F;xe++)z.emplaceBack(xe+ae,F+xe+ae+1,F+xe+ae+2),z.emplaceBack(xe+ae,F+xe+ae+2,xe+ae+1);const V=M.length,W=V+(F+1),te=(F+1)*F,ee=g?a.bh:0,ie=g?0:1,se=b?a.bi:a.$,ce=b?0:1;for(let ae=0;ae<=F;ae++)M.emplaceBack(ae*j,ee,ie);for(let ae=0;ae<=F;ae++)M.emplaceBack(ae*j,se,ce);for(let ae=0;ae<F;ae++)z.emplaceBack(te+ae,W+ae,W+ae+1),z.emplaceBack(te+ae,W+ae+1,te+ae+1),z.emplaceBack(0+ae,V+ae+1,V+ae),z.emplaceBack(0+ae,0+ae+1,V+ae+1);const oe=M.length,he=oe+2*(F+1);for(const ae of[0,1])for(let xe=0;xe<=F;xe++)for(const Oe of[0,1])M.emplaceBack(ae*a.$,xe*j,Oe);for(let ae=0;ae<2*F;ae+=2)z.emplaceBack(oe+ae,oe+ae+1,oe+ae+3),z.emplaceBack(oe+ae,oe+ae+3,oe+ae+2),z.emplaceBack(he+ae,he+ae+3,he+ae+1),z.emplaceBack(he+ae,he+ae+2,he+ae+3);const me=new El($.createVertexBuffer(M,pp.members),$.createIndexBuffer(z),a.aM.simpleSegment(0,0,M.length,z.length));return this._meshCache[S]=me,me}getMeshFrameDelta(n){return 2*Math.PI*a.bu/Math.pow(2,Math.max(n,0))/5}getMinTileElevationForLngLatZoom(n,u){var f;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(n,u);return(f=this.getMinMaxElevation(g).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(n){const u=this.getTerrainData(n).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(n,u){const f=a.a1.fromLngLat(n.wrap()),g=(1<<u)*a.$,b=f.x*g,S=f.y*g,$=Math.floor(b/a.$),M=Math.floor(S/a.$);return{tileID:new a.Z(u,0,u,$,M),mercatorX:b,mercatorY:S}}}class fp{constructor(n,u,f){this._context=n,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new a.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:n,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((u=>n.id!==u)),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((n=>!n.inUse))===!1}}const qa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class mp{constructor(n,u){this.painter=n,this.terrain=u,this.pool=new fp(n.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter((f=>!n._layers[f].isHidden(u))),this._coordsAscending={};for(const f in n.sourceCaches){this._coordsAscending[f]={};const g=n.sourceCaches[f].getVisibleCoordinates(),b=n.sourceCaches[f].getSource(),S=b instanceof xo?b.terrainTileRanges:null;for(const $ of g){const M=this.terrain.sourceCache.getTerrainCoords($,S);for(const z in M)this._coordsAscending[f][z]||(this._coordsAscending[f][z]=[]),this._coordsAscending[f][z].push(M[z])}}this._coordsAscendingStr={};for(const f of n._order){const g=n._layers[f],b=g.source;if(qa[g.type]&&!this._coordsAscendingStr[b]){this._coordsAscendingStr[b]={};for(const S in this._coordsAscending[b])this._coordsAscendingStr[b][S]=this._coordsAscending[b][S].map(($=>$.key)).sort().join()}}for(const f of this._renderableTiles)for(const g in this._coordsAscendingStr){const b=this._coordsAscendingStr[g][f.tileID.key];b&&b!==f.rttCoords[g]&&(f.rtt=[])}}renderLayer(n,u){if(n.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),g=n.type,b=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(qa[g]&&(this._prevType&&qa[this._prevType]||this._stacks.push([]),this._prevType=g,this._stacks[this._stacks.length-1].push(n.id),!S))return!0;if(qa[this._prevType]||qa[g]&&S){this._prevType=g;const $=this._stacks.length-1,M=this._stacks[$]||[];for(const z of this._renderableTiles){if(this.pool.isFull()&&(ap(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(z),z.rtt[$]){const j=this.pool.getObjectForId(z.rtt[$].id);if(j.stamp===z.rtt[$].stamp){this.pool.useObject(j);continue}}const F=this.pool.getOrCreateFreeObject();this.pool.useObject(F),this.pool.stampObject(F),z.rtt[$]={id:F.id,stamp:F.stamp},b.context.bindFramebuffer.set(F.fbo.framebuffer),b.context.clear({color:a.bf.transparent,stencil:0}),b.currentStencilSource=void 0;for(let j=0;j<M.length;j++){const B=b.style._layers[M[j]],V=B.source?this._coordsAscending[B.source][z.tileID.key]:[z.tileID];b.context.viewport.set([0,0,F.fbo.width,F.fbo.height]),b._renderTileClippingMasks(B,V,!0),b.renderLayer(b,b.style.sourceCaches[B.source],B,V,f),B.source&&(z.rttCoords[B.source]=this._coordsAscendingStr[B.source][z.tileID.key])}}return ap(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),qa[g]}return!1}}const En={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},av=_,_s={hash:!1,interactive:!0,bearingSnap:7,attributionControl:wg,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},w2={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class bh{constructor(n,u,f=!1){this.mousedown=b=>{this.startMove(b,O.mousePos(this.element,b)),O.addEventListener(window,"mousemove",this.mousemove),O.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.move(b,O.mousePos(this.element,b))},this.mouseup=b=>{this._rotatePitchHandler.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=O.touchPos(this.element,b.targetTouches)[0],this.startMove(b,this._startPos),O.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=O.touchPos(this.element,b.targetTouches)[0],this.move(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const g=new v2;this._rotatePitchHandler=new jc({clickTolerance:3,move:(b,S)=>{const $=u.getBoundingClientRect(),M=new a.P(($.bottom-$.top)/2,($.right-$.left)/2);return{bearingDelta:a.cn(new a.P(b.x,S.y),S,M),pitchDelta:f?-.5*(S.y-b.y):void 0}},moveStateManager:g,enable:!0,assignEvents:()=>{}}),this.map=n,O.addEventListener(u,"mousedown",this.mousedown),O.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),O.addEventListener(u,"touchcancel",this.reset)}startMove(n,u){this._rotatePitchHandler.dragStart(n,u),O.disableDrag()}move(n,u){const f=this.map,{bearingDelta:g,pitchDelta:b}=this._rotatePitchHandler.dragMove(n,u)||{};g&&f.setBearing(f.getBearing()+g),b&&f.setPitch(f.getPitch()+b)}off(){const n=this.element;O.removeEventListener(n,"mousedown",this.mousedown),O.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),O.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.removeEventListener(window,"touchend",this.touchend),O.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){O.enableDrag(),O.removeEventListener(window,"mousemove",this.mousemove),O.removeEventListener(window,"mouseup",this.mouseup),O.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.removeEventListener(window,"touchend",this.touchend)}}let Si;function ir(v,n,u,f=!1){if(f||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return v?.wrap();const g=new a.S(v.lng,v.lat);if(v=new a.S(v.lng,v.lat),n){const b=new a.S(v.lng-360,v.lat),S=new a.S(v.lng+360,v.lat),$=u.locationToScreenPoint(v).distSqr(n);u.locationToScreenPoint(b).distSqr(n)<$?v=b:u.locationToScreenPoint(S).distSqr(n)<$&&(v=S)}for(;Math.abs(v.lng-u.center.lng)>180;){const b=u.locationToScreenPoint(v);if(b.x>=0&&b.y>=0&&b.x<=u.width&&b.y<=u.height)break;v.lng>u.center.lng?v.lng-=360:v.lng+=360}return v.lng!==g.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(v))?v:g}const gp={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qc(v,n,u){const f=v.classList;for(const g in gp)f.remove(`maplibregl-${u}-anchor-${g}`);f.add(`maplibregl-${u}-anchor-${n}`)}class Hc extends a.E{constructor(n){if(super(),this._onKeyPress=u=>{const f=u.code,g=u.charCode||u.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=u=>{const f=u.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=ir(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),O.setTransform(this._element,`${gp[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${g}`),L.frameAsync(new AbortController).then((()=>{this._updateOpacity(u&&u.type==="moveend")})).catch((()=>{}))},this._onMove=u=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(n?.opacity,n?.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=a.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=O.create("div");const u=O.createNS("http://www.w3.org/2000/svg","svg"),f=41,g=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${g}px`),u.setAttributeNS(null,"viewBox",`0 0 ${g} ${f}`);const b=O.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");const S=O.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const $=O.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ie of M){const se=O.createNS("http://www.w3.org/2000/svg","ellipse");se.setAttributeNS(null,"opacity","0.04"),se.setAttributeNS(null,"cx","10.5"),se.setAttributeNS(null,"cy","5.80029008"),se.setAttributeNS(null,"rx",ie.rx),se.setAttributeNS(null,"ry",ie.ry),$.appendChild(se)}const z=O.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const F=O.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(F);const j=O.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const B=O.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(B);const V=O.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(6.0, 7.0)"),V.setAttributeNS(null,"fill","#FFFFFF");const W=O.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=O.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const ee=O.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#FFFFFF"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962"),W.appendChild(te),W.appendChild(ee),S.appendChild($),S.appendChild(z),S.appendChild(j),S.appendChild(V),S.appendChild(W),u.appendChild(S),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(u),this._offset=a.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(u=>{u.preventDefault()})),this._element.addEventListener("mousedown",(u=>{u.preventDefault()})),qc(this._element,this._anchor,"marker"),n&&n.className)for(const u of n.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),n.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),O.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=a.S.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const g=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var u,f;const g=(u=this._map)===null||u===void 0?void 0:u.terrain,b=this._map.transform.isLocationOccluded(this._lngLat);if(!g||b){const V=b?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==V&&(this._element.style.opacity=V))}if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const S=this._map,$=S.terrain.depthAtPoint(this._pos),M=S.terrain.getElevationForLngLatZoom(this._lngLat,S.transform.tileZoom);if(S.transform.lngLatToCameraDepth(this._lngLat,M)-$<.006)return void(this._element.style.opacity=this._opacity);const z=-this._offset.y/S.transform.pixelsPerMeter,F=Math.sin(S.getPitch()*Math.PI/180)*z,j=S.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),B=S.transform.lngLatToCameraDepth(this._lngLat,M+F)-j>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=a.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,u){return(this._opacity===void 0||n===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Tg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Zc=0,jl=!1;const xh={maxWidth:100,unit:"metric"};function yp(v,n,u){const f=u&&u.maxWidth||100,g=v._container.clientHeight/2,b=v._container.clientWidth/2,S=v.unproject([b-f/2,g]),$=v.unproject([b+f/2,g]),M=Math.round(v.project($).x-v.project(S).x),z=Math.min(f,M,v._container.clientWidth),F=S.distanceTo($);if(u&&u.unit==="imperial"){const j=3.2808*F;j>5280?Ul(n,z,j/5280,v._getUIString("ScaleControl.Miles")):Ul(n,z,j,v._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Ul(n,z,F/1852,v._getUIString("ScaleControl.NauticalMiles")):F>=1e3?Ul(n,z,F/1e3,v._getUIString("ScaleControl.Kilometers")):Ul(n,z,F,v._getUIString("ScaleControl.Meters"))}function Ul(v,n,u,f){const g=(function(b){const S=Math.pow(10,`${Math.floor(b)}`.length-1);let $=b/S;return $=$>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:(function(M){const z=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*z)/z})($),S*$})(u);v.style.width=n*(g/u)+"px",v.innerHTML=`${g}&nbsp;${f}`}const Cg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Eg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function _p(v){if(v){if(typeof v=="number"){const n=Math.round(Math.abs(v)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,v),"top-left":new a.P(n,n),"top-right":new a.P(-n,n),bottom:new a.P(0,-v),"bottom-left":new a.P(n,-n),"bottom-right":new a.P(-n,-n),left:new a.P(v,0),right:new a.P(-v,0)}}if(v instanceof a.P||Array.isArray(v)){const n=a.P.convert(v);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:a.P.convert(v.center||[0,0]),top:a.P.convert(v.top||[0,0]),"top-left":a.P.convert(v["top-left"]||[0,0]),"top-right":a.P.convert(v["top-right"]||[0,0]),bottom:a.P.convert(v.bottom||[0,0]),"bottom-left":a.P.convert(v["bottom-left"]||[0,0]),"bottom-right":a.P.convert(v["bottom-right"]||[0,0]),left:a.P.convert(v.left||[0,0]),right:a.P.convert(v.right||[0,0])}}return _p(new a.P(0,0))}const Ig=_;d.AJAXError=a.cz,d.Event=a.l,d.Evented=a.E,d.LngLat=a.S,d.MercatorCoordinate=a.a1,d.Point=a.P,d.addProtocol=a.cA,d.config=a.a,d.removeProtocol=a.cB,d.AttributionControl=Sg,d.BoxZoomHandler=mg,d.CanvasSource=ka,d.CooperativeGesturesHandler=nv,d.DoubleClickZoomHandler=_g,d.DragPanHandler=iv,d.DragRotateHandler=bg,d.EdgeInsets=$l,d.FullscreenControl=class extends a.E{constructor(v={}){super(),this._onFullscreenChange=()=>{var n;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=u?.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){O.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=O.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);O.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},d.GeoJSONSource=bo,d.GeolocateControl=class extends a.E{constructor(v){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",n)),this._finish()}},this._updateCamera=n=>{const u=new a.S(n.coords.longitude,n.coords.latitude),f=n.coords.accuracy,g=this._map.getBearing(),b=a.e({bearing:g},this.options.fitBoundsOptions),S=Qi.fromLngLat(u,f);this._map.fitBounds(S,b,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const u=new a.S(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=n.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=n=>{if(this._map){if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&jl)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this._geolocateButton=O.create("button","maplibregl-ctrl-geolocate",this._container),O.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=O.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Hc({element:this._dotElement}),this._circleElement=O.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Hc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(u=>{const f=u?.[0]instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))}))}},this.options=a.e({},Tg,v)}onAdd(v){return this._map=v,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return a._(this,arguments,void 0,(function*(n=!1){if(Si!==void 0&&!n)return Si;if(window.navigator.permissions===void 0)return Si=!!window.navigator.geolocation,Si;try{Si=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Si=!!window.navigator.geolocation}return Si}))})().then((n=>this._finishSetupUI(n))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),O.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Zc=0,jl=!1}_isOutOfMapMaxBounds(v){const n=this._map.getMaxBounds(),u=v.coords;return n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const v=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&v))return;const n=this._map.project(v),u=this._map.unproject([n.x+100,n.y]),f=v.distanceTo(u)/100,g=2*this._accuracy/f;this._circleElement.style.width=`${g.toFixed(2)}px`,this._circleElement.style.height=`${g.toFixed(2)}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Zc--,jl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Zc++,Zc>1?(v={maximumAge:6e5,timeout:0},jl=!0):(v=this.options.positionOptions,jl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},d.GlobeControl=class{constructor(){this._toggleProjection=()=>{var v;const n=(v=this._map.getProjection())===null||v===void 0?void 0:v.type;this._map.setProjection(n!=="mercator"&&n?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var v;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((v=this._map.getProjection())===null||v===void 0?void 0:v.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(v){return this._map=v,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=O.create("button","maplibregl-ctrl-globe",this._container),O.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){O.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},d.Hash=lp,d.ImageSource=xo,d.KeyboardHandler=hp,d.LngLatBounds=Qi,d.LogoControl=ov,d.Map=class extends sv{constructor(v){var n,u;a.cw.mark(a.cx.create);const f=Object.assign(Object.assign(Object.assign({},_s),v),{canvasContextAttributes:Object.assign(Object.assign({},_s.canvasContextAttributes),v.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const g=new $i,b=new fn;if(f.minZoom!==void 0&&g.setMinZoom(f.minZoom),f.maxZoom!==void 0&&g.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&g.setMinPitch(f.minPitch),f.maxPitch!==void 0&&g.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&g.setRenderWorldCopies(f.renderWorldCopies),super(g,b,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Io,this._controls=[],this._mapId=a.a7(),this._contextLost=$=>{$.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:$}))},this._contextRestored=$=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:$}))},this._onMapScroll=$=>{if($.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},En),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Re.addThrottleControl((()=>this.isMoving())),this._requestManager=new ze(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let $=!1;const M=Nl((z=>{this._trackResize&&!this._removed&&(this.resize(z),this.redraw())}),50);this._resizeObserver=new ResizeObserver((z=>{$?M(z):$=!0})),this._resizeObserver.observe(this._container)}this.handlers=new xg(this,f),this._hash=f.hash&&new lp(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,a.e({},f.fitBoundsOptions,{duration:0}))));const S=typeof f.style=="string"||((u=(n=f.style)===null||n===void 0?void 0:n.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Sg(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new ov,f.logoPosition),this.on("style.load",(()=>{if(S||this._resizeTransform(),this.transform.unmodified){const $=a.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo($)}})),this.on("data",($=>{this._update($.dataType==="style"),this.fire(new a.l(`${$.dataType}data`,$))})),this.on("dataloading",($=>{this.fire(new a.l(`${$.dataType}dataloading`,$))})),this.on("dataabort",($=>{this.fire(new a.l("sourcedataabort",$))}))}_getMapId(){return this._mapId}setGlobalStateProperty(v,n){return this.style.setGlobalStateProperty(v,n),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(v,n){if(n===void 0&&(n=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=v.onAdd(this);this._controls.push(v);const f=this._controlPositions[n];return n.indexOf("bottom")!==-1?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(v);return n>-1&&this._controls.splice(n,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}coveringTiles(v){return Te(this.transform,v)}calculateCameraOptionsFromTo(v,n,u,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,n,u,f)}resize(v,n=!0){const[u,f]=this._containerDimensions(),g=this._getClampedPixelRatio(u,f);if(this._resizeCanvas(u,f,g),this.painter.resize(u,f,g),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const $=this._getClampedPixelRatio(u,f);this._resizeCanvas(u,f,$),this.painter.resize(u,f,$)}this._resizeTransform(n);const b=!this._moving;return b&&(this.stop(),this.fire(new a.l("movestart",v)).fire(new a.l("move",v))),this.fire(new a.l("resize",v)),b&&this.fire(new a.l("moveend",v)),this}_resizeTransform(v=!0){var n;const[u,f]=this._containerDimensions();this.transform.resize(u,f,v),(n=this._requestedCameraState)===null||n===void 0||n.resize(u,f,v)}_getClampedPixelRatio(v,n){const{0:u,1:f}=this._maxCanvasSize,g=this.getPixelRatio(),b=v*g,S=n*g;return Math.min(b>u?u/b:1,S>f?f/S:1)*g}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(Qi.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.setMinZoom(v),this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.setMaxZoom(v),this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.setMinPitch(v),this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(v>=this.transform.minPitch)return this.transform.setMaxPitch(v),this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.setRenderWorldCopies(v),this._update()}project(v){return this.transform.locationToScreenPoint(a.S.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.screenPointToLocation(a.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,n,u){if(v==="mouseenter"||v==="mouseover"){let f=!1;return{layers:n,listener:u,delegates:{mousemove:b=>{const S=n.filter((M=>this.getLayer(M))),$=S.length!==0?this.queryRenderedFeatures(b.point,{layers:S}):[];$.length?f||(f=!0,u.call(this,new Nn(v,this,b.originalEvent,{features:$}))):f=!1},mouseout:()=>{f=!1}}}}if(v==="mouseleave"||v==="mouseout"){let f=!1;return{layers:n,listener:u,delegates:{mousemove:S=>{const $=n.filter((M=>this.getLayer(M)));($.length!==0?this.queryRenderedFeatures(S.point,{layers:$}):[]).length?f=!0:f&&(f=!1,u.call(this,new Nn(v,this,S.originalEvent)))},mouseout:S=>{f&&(f=!1,u.call(this,new Nn(v,this,S.originalEvent)))}}}}{const f=g=>{const b=n.filter(($=>this.getLayer($))),S=b.length!==0?this.queryRenderedFeatures(g.point,{layers:b}):[];S.length&&(g.features=S,u.call(this,g),delete g.features)};return{layers:n,listener:u,delegates:{[v]:f}}}}_saveDelegatedListener(v,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(n)}_removeDelegatedListener(v,n,u){if(!this._delegatedListeners||!this._delegatedListeners[v])return;const f=this._delegatedListeners[v];for(let g=0;g<f.length;g++){const b=f[g];if(b.listener===u&&b.layers.length===n.length&&b.layers.every((S=>n.includes(S)))){for(const S in b.delegates)this.off(S,b.delegates[S]);return void f.splice(g,1)}}}on(v,n,u){if(u===void 0)return super.on(v,n);const f=typeof n=="string"?[n]:n,g=this._createDelegatedListener(v,f,u);this._saveDelegatedListener(v,g);for(const b in g.delegates)this.on(b,g.delegates[b]);return{unsubscribe:()=>{this._removeDelegatedListener(v,f,u)}}}once(v,n,u){if(u===void 0)return super.once(v,n);const f=typeof n=="string"?[n]:n,g=this._createDelegatedListener(v,f,u);for(const b in g.delegates){const S=g.delegates[b];g.delegates[b]=(...$)=>{this._removeDelegatedListener(v,f,u),S(...$)}}this._saveDelegatedListener(v,g);for(const b in g.delegates)this.once(b,g.delegates[b]);return this}off(v,n,u){return u===void 0?super.off(v,n):(this._removeDelegatedListener(v,typeof n=="string"?[n]:n,u),this)}queryRenderedFeatures(v,n){if(!this.style)return[];let u;const f=v instanceof a.P||Array.isArray(v),g=f?v:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(f?{}:v)||{},g instanceof a.P||typeof g[0]=="number")u=[a.P.convert(g)];else{const b=a.P.convert(g[0]),S=a.P.convert(g[1]);u=[b,new a.P(S.x,b.y),S,new a.P(b.x,S.y),b]}return this.style.queryRenderedFeatures(u,n,this.transform)}querySourceFeatures(v,n){return this.style.querySourceFeatures(v,n)}setStyle(v,n){return(n=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(v,n))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const n=this._locale[v];if(n==null)throw new Error(`Missing UI string '${v}'`);return n}_updateStyle(v,n){var u,f;if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(v,n)));const g=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new Gm(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,n,g):this.style.loadJSON(v,n,g),this):((f=(u=this.style)===null||u===void 0?void 0:u.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Gm(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,n){if(typeof v=="string"){const u=this._requestManager.transformRequest(v,"Style");a.j(u,new AbortController).then((f=>{this._updateDiff(f.data,n)})).catch((f=>{f&&this.fire(new a.k(f))}))}else typeof v=="object"&&this._updateDiff(v,n)}_updateDiff(v,n){try{this.style.setState(v,n)&&this._update(!0)}catch(u){a.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(v,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(v,n){return this._lazyInitEmptyStyle(),this.style.addSource(v,n),this._update(!0)}isSourceLoaded(v){const n=this.style&&this.style.sourceCaches[v];if(n!==void 0)return n.loaded();this.fire(new a.k(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const n=this.style.sourceCaches[v.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);this.terrain===null&&n.reload();for(const u in this.style._layers){const f=this.style._layers[u];f.type==="hillshade"&&f.source===v.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===v.source&&a.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Pt(this.painter,n,v),this.painter.renderToTexture=new mp(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var f;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==v.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=u.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:v})),this}getTerrain(){var v,n;return(n=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const n in v){const u=v[n]._tiles;for(const f in u){const g=u[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}setSourceTileLodParams(v,n,u){if(u){const f=this.getSource(u);if(!f)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);f.calculateTileZoom=Ye(Math.max(1,v),Math.max(1,n))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=Ye(Math.max(1,v),Math.max(1,n));return this._update(!0),this}refreshTiles(v,n){const u=this.style.sourceCaches[v];if(!u)throw new Error(`There is no source cache with ID "${v}", cannot refresh tile`);n===void 0?u.reload(!0):u.refreshTiles(n.map((f=>new a.a4(f.z,f.x,f.y))))}addImage(v,n,u={}){const{pixelRatio:f=1,sdf:g=!1,stretchX:b,stretchY:S,content:$,textFitWidth:M,textFitHeight:z}=u;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||a.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:j,data:B}=n,V=n;return this.style.addImage(v,{data:new a.R({width:F,height:j},new Uint8Array(B)),pixelRatio:f,stretchX:b,stretchY:S,content:$,textFitWidth:M,textFitHeight:z,sdf:g,version:0,userImage:V}),V.onAdd&&V.onAdd(this,v),this}}{const{width:F,height:j,data:B}=L.getImageData(n);this.style.addImage(v,{data:new a.R({width:F,height:j},B),pixelRatio:f,stretchX:b,stretchY:S,content:$,textFitWidth:M,textFitHeight:z,sdf:g,version:0})}}updateImage(v,n){const u=this.style.getImage(v);if(!u)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=n instanceof HTMLImageElement||a.b(n)?L.getImageData(n):n,{width:g,height:b,data:S}=f;if(g===void 0||b===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==u.data.width||b!==u.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const $=!(n instanceof HTMLImageElement||a.b(n));return u.data.replace(S,$),this.style.updateImage(v,u),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v){return Re.getImage(this._requestManager.transformRequest(v,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(v,n){return this._lazyInitEmptyStyle(),this.style.addLayer(v,n),this._update(!0)}moveLayer(v,n){return this.style.moveLayer(v,n),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,n,u){return this.style.setLayerZoomRange(v,n,u),this._update(!0)}setFilter(v,n,u={}){return this.style.setFilter(v,n,u),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,n,u,f={}){return this.style.setPaintProperty(v,n,u,f),this._update(!0)}getPaintProperty(v,n){return this.style.getPaintProperty(v,n)}setLayoutProperty(v,n,u,f={}){return this.style.setLayoutProperty(v,n,u,f),this._update(!0)}getLayoutProperty(v,n){return this.style.getLayoutProperty(v,n)}setGlyphs(v,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,n,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,n,u,(f=>{f||this._update(!0)})),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,n,(u=>{u||this._update(!0)})),this}setLight(v,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(v,n={}){return this._lazyInitEmptyStyle(),this.style.setSky(v,n),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(v,n){return this.style.setFeatureState(v,n),this._update()}removeFeatureState(v,n){return this.style.removeFeatureState(v,n),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,n=0;return this._container&&(v=this._container.clientWidth||400,n=this._container.clientHeight||300),[v,n]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const n=this._canvasContainer=O.create("div","maplibregl-canvas-container",v);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=O.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);const g=this._controlContainer=O.create("div","maplibregl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((S=>{b[S]=O.create("div",`maplibregl-ctrl-${S} `,g)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,n,u){this._canvas.width=Math.floor(u*v),this._canvas.height=Math.floor(u*n),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const v=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let n=null;this._canvas.addEventListener("webglcontextcreationerror",(f=>{n={requestedAttributes:v},f&&(n.statusMessage=f.statusMessage,n.type=f.type)}),{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,v):this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v),!u){const f="Failed to initialize WebGL";throw n?(n.message=f,new Error(JSON.stringify(n))):new Error(f)}this.painter=new q_(u,this.transform),H.testSupport(u)}migrateProjection(v,n){super.migrateProjection(v,n),this.painter.transform=v,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){var n,u,f,g,b;const S=this._idleTriggered?this._fadeDuration:0,$=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let M=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const j=this.transform.zoom,B=L.now();this.style.zoomHistory.update(j,B);const V=new a.F(j,{now:B,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),W=V.crossFadingFactor();W===1&&W===this._crossFadingFactor||(M=!0,this._crossFadingFactor=W),this.style.update(V)}const z=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==$;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((g=this.style.projection)===null||g===void 0?void 0:g.transitionState,(b=this.style.projection)===null||b===void 0?void 0:b.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||z)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,z),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cw.mark(a.cx.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,a.cw.mark(a.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Re.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n?.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),O.remove(this._canvasContainer),O.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cw.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,L.frame(this._frameRequest,(v=>{a.cw.frame(v),this._frameRequest=null;try{this._render(v)}catch(n){if(!a.cy(n)&&!(function(u){return u.message===uh})(n))throw n}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return av}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(v){return this._lazyInitEmptyStyle(),this.style.setProjection(v),this._update(!0)}},d.MapMouseEvent=Nn,d.MapTouchEvent=Fc,d.MapWheelEvent=fg,d.Marker=Hc,d.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const n=this._map.getZoom(),u=n===this._map.getMaxZoom(),f=n===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(n,u)=>{const f=this._map._getUIString(`NavigationControl.${u}`);n.title=f,n.setAttribute("aria-label",f)},this.options=a.e({},w2,v),this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(n=>this._map.zoomIn({},{originalEvent:n}))),O.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(n=>this._map.zoomOut({},{originalEvent:n}))),O.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})})),this._compassIcon=O.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new bh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){O.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,n){const u=O.create("button",v,this._container);return u.type="button",u.addEventListener("click",n),u}},d.Popup=class extends a.E{constructor(v){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&O.remove(this._content),this._container&&(O.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=O.create("div","maplibregl-popup",this._map.getContainer()),this._tip=O.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=ir(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!n)return;const u=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const g=_p(this.options.offset);if(!f){const S=this._container.offsetWidth,$=this._container.offsetHeight;let M;M=u.y+g.bottom.y<$?["top"]:u.y>this._map.transform.height-$?["bottom"]:[],u.x<S/2?M.push("left"):u.x>this._map.transform.width-S/2&&M.push("right"),f=M.length===0?"bottom":M.join("-")}let b=u.add(g[f]);this.options.subpixelPositioning||(b=b.round()),O.setTransform(this._container,`${gp[f]} translate(${b.x}px,${b.y}px)`),qc(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(Cg),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=a.S.convert(v),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const n=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=v;f=u.firstChild,f;)n.appendChild(f);return this.setDOMContent(n)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=O.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){return this._container&&this._container.classList.add(v),this}removeClassName(v){return this._container&&this._container.classList.remove(v),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}setSubpixelPositioning(v){this.options.subpixelPositioning=v}_createCloseButton(){this.options.closeButton&&(this._closeButton=O.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(Eg);v&&v.focus()}},d.RasterDEMTileSource=Sl,d.RasterTileSource=vo,d.ScaleControl=class{constructor(v){this._onMove=()=>{yp(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,yp(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},xh),v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){O.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},d.ScrollZoomHandler=ev,d.Style=Gm,d.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=v}onAdd(v){return this._map=v,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=O.create("button","maplibregl-ctrl-terrain",this._container),O.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){O.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},d.TwoFingersTouchPitchHandler=up,d.TwoFingersTouchRotateHandler=Vc,d.TwoFingersTouchZoomHandler=cp,d.TwoFingersTouchZoomRotateHandler=rv,d.VectorTileSource=Rs,d.VideoSource=Tc,d.addSourceType=(v,n)=>a._(void 0,void 0,void 0,(function*(){if(Da(v))throw new Error(`A source type called "${v}" already exists.`);((u,f)=>{Aa[u]=f})(v,n)})),d.clearPrewarmedResources=function(){const v=hn;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(Wt),hn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},d.createTileMesh=Um,d.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},d.getRTLTextPluginStatus=function(){return Ra().getRTLTextPluginStatus()},d.getVersion=function(){return Ig},d.getWorkerCount=function(){return ei.workerCount},d.getWorkerUrl=function(){return a.a.WORKER_URL},d.importScriptInWorkers=function(v){return _o().broadcast("IS",v)},d.prewarm=function(){Qn().acquire(Wt)},d.setMaxParallelImageRequests=function(v){a.a.MAX_PARALLEL_IMAGE_REQUESTS=v},d.setRTLTextPlugin=function(v,n){return Ra().setRTLTextPlugin(v,n)},d.setWorkerCount=function(v){ei.workerCount=v},d.setWorkerUrl=function(v){a.a.WORKER_URL=v}}));var h=i;return h}))})(rb)),rb.exports}var V9=U9();const uu=Vz(V9);var uS,Gk;function G9(){if(Gk)return uS;Gk=1;function t(i,r){var o=i.getCenter(),h=i.getZoom(),d=i.getBearing(),a=i.getPitch();r.forEach(function(_){_.jumpTo({center:o,zoom:h,bearing:d,pitch:a})})}function e(){var i,r=arguments.length;if(r===1)i=arguments[0];else{i=[];for(var o=0;o<r;o++)i.push(arguments[o])}var h=[];i.forEach(function(T,E){h[E]=_.bind(null,T,i.filter(function(k,L){return L!==E}))});function d(){i.forEach(function(T,E){T.on("move",h[E])})}function a(){i.forEach(function(T,E){T.off("move",h[E])})}function _(T,E){a(),t(T,E),d()}return d(),function(){a(),h=[],i=[]}}return uS=e,uS}var q9=G9();const H9=Vz(q9),Lo={LEFT_RIGHT:"left-right",TOP_BOTTOM:"top-bottom"};function qz(t,e,i,r){if(this.options=r||{},this.includeLabel=this.options.includeLabel||!0,this._mapA=t,this._mapB=e,this.orientation=this.options.orientation||Lo.LEFT_RIGHT,this._onDown=this._onDown.bind(this),this._onMove=this._onMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._ev=r.eventEmitter||new EventTarget,this._swiper=document.createElement("div"),this._swiper.className=this.orientation===Lo.LEFT_RIGHT?"compare-swiper-leftRight":"compare-swiper-topBottom",this._appendTarget=typeof i=="string"&&document.body.querySelectorAll?document.body.querySelectorAll(i)[0]:null,this._appendTarget&&(this._appendTarget.classList.remove("orientation-left-right","orientation-top-bottom"),this._appendTarget.classList.add(this.orientation==="top-bottom"?"orientation-top-bottom":"orientation-left-right")),this._controlContainer=document.createElement("div"),this._controlContainer.className=this.orientation===Lo.LEFT_RIGHT?"maplibregl-compare maplibregl-compare-leftRight":"maplibregl-compare maplibregl-compare-topBottom",this._controlContainer.append(this._swiper),this._appendTarget instanceof Element&&document.body.querySelectorAll){if(this._appendTarget.style.textAlign="left",!this._appendTarget)throw new Error("Cannot find element with specified container selector.");this._appendTarget.append(this._controlContainer)}else if(this._appendTarget instanceof Element&&i.appendChild)this._appendTarget.append(this._controlContainer);else throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._bounds=t.getContainer().getBoundingClientRect();const o=this.orientation===Lo.LEFT_RIGHT?this._bounds.width/2:this._bounds.height/2;if(this._setPosition(o),this._clearSync=H9(t,e),this._onResize=(function(){const h=this.orientation===Lo.LEFT_RIGHT?this._bounds.width/2:this._bounds.height/2;this._setPosition(h),this._bounds=t.getContainer().getBoundingClientRect(),t.triggerRepaint(),e.triggerRepaint(),this.switchType(this?.options?.type||"slider")}).bind(this),e.on("resize",this._onResize),t.on("resize",this._onResize),window.addEventListener("resize",this._onResize),this._typeToggle=this._createTypeToggle(),typeof i=="string"&&document.body.querySelectorAll){const h=document.body.querySelectorAll(i)[0];h&&h.append(this._typeToggle)}else i instanceof Element&&i.appendChild&&i.append(this._typeToggle);this.switchType(this?.options?.type||"slider")}qz.prototype={_createTypeToggle(){const t=document.createElement("div");t.className="maplibregl-compare-type-toggle",this.options.position.forEach(H=>{t.classList.add(H)});const e=document.createElement("div");e.className="toggle-prepend";const i=document.createElement("div");i.className="toggle-divide";const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("viewBox","0 0 24 24"),r.setAttribute("width","20"),r.setAttribute("height","20"),r.style.fill="currentColor";const o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),r.append(o),e.append(i),e.append(r);const h=document.createElement("input");h.type="checkbox",h.className="toggle-switch",h.checked=(this?.options?.type||"slider")==="sideBySide",h.addEventListener("change",H=>{const re=H.target.checked?"sideBySide":"slider";this.options.type=re,this.switchType(re)});const d=document.createElement("label");d.className="toggle-label",d.append(h);const a=document.createElement("div");a.className="toggle-append";const _=document.createElementNS("http://www.w3.org/2000/svg","svg");_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("width","20"),_.setAttribute("height","20"),_.style.fill="currentColor";const T=document.createElementNS("http://www.w3.org/2000/svg","path");T.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),_.append(T);const E=document.createElement("span");E.textContent="|",E.className="toggle-icon-divider";const k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.setAttribute("viewBox","0 0 24 24"),k.setAttribute("width","20"),k.setAttribute("height","20"),k.style.fill="currentColor";const L=document.createElementNS("http://www.w3.org/2000/svg","path");L.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),k.append(L),a.append(_),a.append(E),a.append(k);const O=document.createElement("div");if(O.className="toggle-controls-row",O.style.display="flex",O.style.alignItems="center",O.style.gap="8px",O.append(e),O.append(d),O.append(a),t.style.flexDirection="column",t.style.alignItems="center",t.append(O),this.includeLabel){const H=document.createElement("div");H.className="toggle-label",H.textContent="Slider | Side by Side",t.prepend(H)}return t},_setPointerEvents(t){this._controlContainer.style.pointerEvents=t,this._swiper.style.pointerEvents=t},_onDown(t){t.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},_setPosition(t){t=Math.min(t,this.orientation===Lo.LEFT_RIGHT?this._bounds.width:this._bounds.height),t=t/document.body.style.zoom;const e=this.orientation===Lo.TOP_BOTTOM?"translate(0, "+t+"px)":"translate("+t+"px, 0)";this._controlContainer.style.transform=e,this._controlContainer.style.WebkitTransform=e;const i=this._bounds.height/document.body.style.zoom,r=this.orientation===Lo.TOP_BOTTOM?"rect(0, 999em, "+t+"px, 0)":"rect(0, "+t+"px, "+i+"px, 0)",o=this.orientation===Lo.TOP_BOTTOM?"rect("+t+"px, 999em, "+i+"px,0)":"rect(0, 999em, "+i+"px,"+t+"px)";this._mapA.getContainer().style.clip=r,this._mapB.getContainer().style.clip=o,this.currentPosition=t},_onMove(t){this.options&&this.options.mousemove&&this._setPointerEvents(t.touches?"auto":"none"),this.orientation===Lo.TOP_BOTTOM?this._setPosition(this._getY(t)):this._setPosition(this._getX(t))},_onMouseUp(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp),this.fire("slideend",{currentPosition:this.currentPosition})},_onTouchEnd(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd),this.fire("slideend",{currentPosition:this.currentPosition})},_getX(t){t=t.touches?t.touches[0]:t;const e=t.clientX-this._bounds.left;return e<0&&(e=0),e>this._bounds.width&&(e=this._bounds.width),e},_getY(t){t=t.touches?t.touches[0]:t;const e=t.clientY-this._bounds.top;return e<0?0:e>this._bounds.height?this._bounds.height:e},switchType(t="slider"){const e=this._mapA,i=this._mapB;this._appendTarget.classList.remove("slider","sideBySide"),this._appendTarget.classList.add(t);const r=this.orientation===Lo.LEFT_RIGHT?this._bounds.width/2:this._bounds.height/2;if(this._setPosition(r),this._typeToggle){const o=this._typeToggle.querySelector(".toggle-switch");o&&(o.checked=t==="sideBySide")}this.options.type=t,t==="sideBySide"?(e.getContainer().style.clip=null,i.getContainer().style.clip="unset",this.orientation===Lo.TOP_BOTTOM?i.getContainer().style.transform="none":i.getContainer().style.transform="translateX(50%)",this._controlContainer.style.display="none",this.options&&this.options.mousemove&&(e.getContainer().removeEventListener("mousemove",this._onMove),i.getContainer().removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown)):(this._controlContainer.style.display="inline-block",i.getContainer().style.transform="none",this.options&&this.options.mousemove&&(e.getContainer().addEventListener("mousemove",this._onMove),i.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown))},setSlider(t){this._setPosition(t)},onceBoth(t,e){let i=!1,r=!1;return this._mapA.once(t,()=>{i=!0,r&&e()}),this._mapB.once(t,()=>{r=!0,i&&e()}),this},onBoth(t,e){let i=!1,r=!1;return this._mapA.on(t,()=>{i=!0,r&&e()}),this._mapB.on(t,()=>{r=!0,i&&e()}),this},on(t,e){return this._ev.addEventListener(t,e),this},fire(t,e){return this._ev.dispatchEvent(new CustomEvent(t,{detail:e})),this},off(t,e){return this._ev.removeEventListener(t,e),this},remove(){this._clearSync(),this._mapB.off("resize",this._onResize),this._mapA.off("resize",this._onResize);const t=this._mapA.getContainer();t&&(t.style.clip=null,t.removeEventListener("mousemove",this._onMove));const e=this._mapB.getContainer();e&&(e.style.clip=null,e.removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown),this._controlContainer.remove(),this._typeToggle&&this._typeToggle.parentNode&&this._typeToggle.remove()}};function nb(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Z9(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Hz(t){let e,i,r;t.length!==2?(e=nb,i=(a,_)=>nb(t(a),_),r=(a,_)=>t(a)-_):(e=t===nb||t===Z9?t:W9,i=t,r=t);function o(a,_,T=0,E=a.length){if(T<E){if(e(_,_)!==0)return E;do{const k=T+E>>>1;i(a[k],_)<0?T=k+1:E=k}while(T<E)}return T}function h(a,_,T=0,E=a.length){if(T<E){if(e(_,_)!==0)return E;do{const k=T+E>>>1;i(a[k],_)<=0?T=k+1:E=k}while(T<E)}return T}function d(a,_,T=0,E=a.length){const k=o(a,_,T,E-1);return k>T&&r(a[k-1],_)>-r(a[k],_)?k-1:k}return{left:o,center:d,right:h}}function W9(){return 0}function Y9(t){return t===null?NaN:+t}const X9=Hz(nb),J9=X9.right;Hz(Y9).center;class qk extends Map{constructor(e,i=e7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),e!=null)for(const[r,o]of e)this.set(r,o)}get(e){return super.get(Hk(this,e))}has(e){return super.has(Hk(this,e))}set(e,i){return super.set(K9(this,e),i)}delete(e){return super.delete(Q9(this,e))}}function Hk({_intern:t,_key:e},i){const r=e(i);return t.has(r)?t.get(r):i}function K9({_intern:t,_key:e},i){const r=e(i);return t.has(r)?t.get(r):(t.set(r,i),i)}function Q9({_intern:t,_key:e},i){const r=e(i);return t.has(r)&&(i=t.get(r),t.delete(r)),i}function e7(t){return t!==null&&typeof t=="object"?t.valueOf():t}const t7=Math.sqrt(50),i7=Math.sqrt(10),r7=Math.sqrt(2);function ox(t,e,i){const r=(e-t)/Math.max(0,i),o=Math.floor(Math.log10(r)),h=r/Math.pow(10,o),d=h>=t7?10:h>=i7?5:h>=r7?2:1;let a,_,T;return o<0?(T=Math.pow(10,-o)/d,a=Math.round(t*T),_=Math.round(e*T),a/T<t&&++a,_/T>e&&--_,T=-T):(T=Math.pow(10,o)*d,a=Math.round(t/T),_=Math.round(e/T),a*T<t&&++a,_*T>e&&--_),_<a&&.5<=i&&i<2?ox(t,e,i*2):[a,_,T]}function n7(t,e,i){if(e=+e,t=+t,i=+i,!(i>0))return[];if(t===e)return[t];const r=e<t,[o,h,d]=r?ox(e,t,i):ox(t,e,i);if(!(h>=o))return[];const a=h-o+1,_=new Array(a);if(r)if(d<0)for(let T=0;T<a;++T)_[T]=(h-T)/-d;else for(let T=0;T<a;++T)_[T]=(h-T)*d;else if(d<0)for(let T=0;T<a;++T)_[T]=(o+T)/-d;else for(let T=0;T<a;++T)_[T]=(o+T)*d;return _}function NT(t,e,i){return e=+e,t=+t,i=+i,ox(t,e,i)[2]}function s7(t,e,i){e=+e,t=+t,i=+i;const r=e<t,o=r?NT(e,t,i):NT(t,e,i);return(r?-1:1)*(o<0?1/-o:o)}function o7(t){return t}var hS=1,dS=2,BT=3,ly=4,Zk=1e-6;function a7(t){return"translate("+t+",0)"}function l7(t){return"translate(0,"+t+")"}function c7(t){return e=>+t(e)}function u7(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),i=>+t(i)+e}function h7(){return!this.__axis}function Zz(t,e){var i=[],r=null,o=null,h=6,d=6,a=3,_=typeof window<"u"&&window.devicePixelRatio>1?0:.5,T=t===hS||t===ly?-1:1,E=t===ly||t===dS?"x":"y",k=t===hS||t===BT?a7:l7;function L(O){var H=r??(e.ticks?e.ticks.apply(e,i):e.domain()),re=o??(e.tickFormat?e.tickFormat.apply(e,i):o7),pe=Math.max(h,0)+a,ge=e.range(),Se=+ge[0]+_,Pe=+ge[ge.length-1]+_,Re=(e.bandwidth?u7:c7)(e.copy(),_),ze=O.selection?O.selection():O,Je=ze.selectAll(".domain").data([null]),Xe=ze.selectAll(".tick").data(H,e).order(),yt=Xe.exit(),mt=Xe.enter().append("g").attr("class","tick"),je=Xe.select("line"),ke=Xe.select("text");Je=Je.merge(Je.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Xe=Xe.merge(mt),je=je.merge(mt.append("line").attr("stroke","currentColor").attr(E+"2",T*h)),ke=ke.merge(mt.append("text").attr("fill","currentColor").attr(E,T*pe).attr("dy",t===hS?"0em":t===BT?"0.71em":"0.32em")),O!==ze&&(Je=Je.transition(O),Xe=Xe.transition(O),je=je.transition(O),ke=ke.transition(O),yt=yt.transition(O).attr("opacity",Zk).attr("transform",function(We){return isFinite(We=Re(We))?k(We+_):this.getAttribute("transform")}),mt.attr("opacity",Zk).attr("transform",function(We){var Ce=this.parentNode.__axis;return k((Ce&&isFinite(Ce=Ce(We))?Ce:Re(We))+_)})),yt.remove(),Je.attr("d",t===ly||t===dS?d?"M"+T*d+","+Se+"H"+_+"V"+Pe+"H"+T*d:"M"+_+","+Se+"V"+Pe:d?"M"+Se+","+T*d+"V"+_+"H"+Pe+"V"+T*d:"M"+Se+","+_+"H"+Pe),Xe.attr("opacity",1).attr("transform",function(We){return k(Re(We)+_)}),je.attr(E+"2",T*h),ke.attr(E,T*pe).text(re),ze.filter(h7).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===dS?"start":t===ly?"end":"middle"),ze.each(function(){this.__axis=Re})}return L.scale=function(O){return arguments.length?(e=O,L):e},L.ticks=function(){return i=Array.from(arguments),L},L.tickArguments=function(O){return arguments.length?(i=O==null?[]:Array.from(O),L):i.slice()},L.tickValues=function(O){return arguments.length?(r=O==null?null:Array.from(O),L):r&&r.slice()},L.tickFormat=function(O){return arguments.length?(o=O,L):o},L.tickSize=function(O){return arguments.length?(h=d=+O,L):h},L.tickSizeInner=function(O){return arguments.length?(h=+O,L):h},L.tickSizeOuter=function(O){return arguments.length?(d=+O,L):d},L.tickPadding=function(O){return arguments.length?(a=+O,L):a},L.offset=function(O){return arguments.length?(_=+O,L):_},L}function Wk(t){return Zz(BT,t)}function d7(t){return Zz(ly,t)}var p7={value:()=>{}};function Wz(){for(var t=0,e=arguments.length,i={},r;t<e;++t){if(!(r=arguments[t]+"")||r in i||/[\s.]/.test(r))throw new Error("illegal type: "+r);i[r]=[]}return new sb(i)}function sb(t){this._=t}function f7(t,e){return t.trim().split(/^|\s+/).map(function(i){var r="",o=i.indexOf(".");if(o>=0&&(r=i.slice(o+1),i=i.slice(0,o)),i&&!e.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:r}})}sb.prototype=Wz.prototype={constructor:sb,on:function(t,e){var i=this._,r=f7(t+"",i),o,h=-1,d=r.length;if(arguments.length<2){for(;++h<d;)if((o=(t=r[h]).type)&&(o=m7(i[o],t.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++h<d;)if(o=(t=r[h]).type)i[o]=Yk(i[o],t.name,e);else if(e==null)for(o in i)i[o]=Yk(i[o],t.name,null);return this},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new sb(t)},call:function(t,e){if((o=arguments.length-2)>0)for(var i=new Array(o),r=0,o,h;r<o;++r)i[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(h=this._[t],r=0,o=h.length;r<o;++r)h[r].value.apply(e,i)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,h=r.length;o<h;++o)r[o].value.apply(e,i)}};function m7(t,e){for(var i=0,r=t.length,o;i<r;++i)if((o=t[i]).name===e)return o.value}function Yk(t,e,i){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=p7,t=t.slice(0,r).concat(t.slice(r+1));break}return i!=null&&t.push({name:e,value:i}),t}var jT="http://www.w3.org/1999/xhtml";const Xk={svg:"http://www.w3.org/2000/svg",xhtml:jT,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function V1(t){var e=t+="",i=e.indexOf(":");return i>=0&&(e=t.slice(0,i))!=="xmlns"&&(t=t.slice(i+1)),Xk.hasOwnProperty(e)?{space:Xk[e],local:t}:t}function g7(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===jT&&e.documentElement.namespaceURI===jT?e.createElement(t):e.createElementNS(i,t)}}function y7(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Yz(t){var e=V1(t);return(e.local?y7:g7)(e)}function _7(){}function ZI(t){return t==null?_7:function(){return this.querySelector(t)}}function v7(t){typeof t!="function"&&(t=ZI(t));for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o)for(var h=e[o],d=h.length,a=r[o]=new Array(d),_,T,E=0;E<d;++E)(_=h[E])&&(T=t.call(_,_.__data__,E,h))&&("__data__"in _&&(T.__data__=_.__data__),a[E]=T);return new fs(r,this._parents)}function Xz(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function b7(){return[]}function Jz(t){return t==null?b7:function(){return this.querySelectorAll(t)}}function x7(t){return function(){return Xz(t.apply(this,arguments))}}function w7(t){typeof t=="function"?t=x7(t):t=Jz(t);for(var e=this._groups,i=e.length,r=[],o=[],h=0;h<i;++h)for(var d=e[h],a=d.length,_,T=0;T<a;++T)(_=d[T])&&(r.push(t.call(_,_.__data__,T,d)),o.push(_));return new fs(r,o)}function Kz(t){return function(){return this.matches(t)}}function Qz(t){return function(e){return e.matches(t)}}var S7=Array.prototype.find;function T7(t){return function(){return S7.call(this.children,t)}}function C7(){return this.firstElementChild}function E7(t){return this.select(t==null?C7:T7(typeof t=="function"?t:Qz(t)))}var I7=Array.prototype.filter;function $7(){return Array.from(this.children)}function P7(t){return function(){return I7.call(this.children,t)}}function M7(t){return this.selectAll(t==null?$7:P7(typeof t=="function"?t:Qz(t)))}function k7(t){typeof t!="function"&&(t=Kz(t));for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o)for(var h=e[o],d=h.length,a=r[o]=[],_,T=0;T<d;++T)(_=h[T])&&t.call(_,_.__data__,T,h)&&a.push(_);return new fs(r,this._parents)}function eO(t){return new Array(t.length)}function A7(){return new fs(this._enter||this._groups.map(eO),this._parents)}function ax(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ax.prototype={constructor:ax,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function D7(t){return function(){return t}}function z7(t,e,i,r,o,h){for(var d=0,a,_=e.length,T=h.length;d<T;++d)(a=e[d])?(a.__data__=h[d],r[d]=a):i[d]=new ax(t,h[d]);for(;d<_;++d)(a=e[d])&&(o[d]=a)}function O7(t,e,i,r,o,h,d){var a,_,T=new Map,E=e.length,k=h.length,L=new Array(E),O;for(a=0;a<E;++a)(_=e[a])&&(L[a]=O=d.call(_,_.__data__,a,e)+"",T.has(O)?o[a]=_:T.set(O,_));for(a=0;a<k;++a)O=d.call(t,h[a],a,h)+"",(_=T.get(O))?(r[a]=_,_.__data__=h[a],T.delete(O)):i[a]=new ax(t,h[a]);for(a=0;a<E;++a)(_=e[a])&&T.get(L[a])===_&&(o[a]=_)}function R7(t){return t.__data__}function L7(t,e){if(!arguments.length)return Array.from(this,R7);var i=e?O7:z7,r=this._parents,o=this._groups;typeof t!="function"&&(t=D7(t));for(var h=o.length,d=new Array(h),a=new Array(h),_=new Array(h),T=0;T<h;++T){var E=r[T],k=o[T],L=k.length,O=F7(t.call(E,E&&E.__data__,T,r)),H=O.length,re=a[T]=new Array(H),pe=d[T]=new Array(H),ge=_[T]=new Array(L);i(E,k,re,pe,ge,O,e);for(var Se=0,Pe=0,Re,ze;Se<H;++Se)if(Re=re[Se]){for(Se>=Pe&&(Pe=Se+1);!(ze=pe[Pe])&&++Pe<H;);Re._next=ze||null}}return d=new fs(d,r),d._enter=a,d._exit=_,d}function F7(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function N7(){return new fs(this._exit||this._groups.map(eO),this._parents)}function B7(t,e,i){var r=this.enter(),o=this,h=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(o=e(o),o&&(o=o.selection())),i==null?h.remove():i(h),r&&o?r.merge(o).order():o}function j7(t){for(var e=t.selection?t.selection():t,i=this._groups,r=e._groups,o=i.length,h=r.length,d=Math.min(o,h),a=new Array(o),_=0;_<d;++_)for(var T=i[_],E=r[_],k=T.length,L=a[_]=new Array(k),O,H=0;H<k;++H)(O=T[H]||E[H])&&(L[H]=O);for(;_<o;++_)a[_]=i[_];return new fs(a,this._parents)}function U7(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var r=t[e],o=r.length-1,h=r[o],d;--o>=0;)(d=r[o])&&(h&&d.compareDocumentPosition(h)^4&&h.parentNode.insertBefore(d,h),h=d);return this}function V7(t){t||(t=G7);function e(k,L){return k&&L?t(k.__data__,L.__data__):!k-!L}for(var i=this._groups,r=i.length,o=new Array(r),h=0;h<r;++h){for(var d=i[h],a=d.length,_=o[h]=new Array(a),T,E=0;E<a;++E)(T=d[E])&&(_[E]=T);_.sort(e)}return new fs(o,this._parents).order()}function G7(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function q7(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function H7(){return Array.from(this)}function Z7(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r=t[e],o=0,h=r.length;o<h;++o){var d=r[o];if(d)return d}return null}function W7(){let t=0;for(const e of this)++t;return t}function Y7(){return!this.node()}function X7(t){for(var e=this._groups,i=0,r=e.length;i<r;++i)for(var o=e[i],h=0,d=o.length,a;h<d;++h)(a=o[h])&&t.call(a,a.__data__,h,o);return this}function J7(t){return function(){this.removeAttribute(t)}}function K7(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Q7(t,e){return function(){this.setAttribute(t,e)}}function eU(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function tU(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttribute(t):this.setAttribute(t,i)}}function iU(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function rU(t,e){var i=V1(t);if(arguments.length<2){var r=this.node();return i.local?r.getAttributeNS(i.space,i.local):r.getAttribute(i)}return this.each((e==null?i.local?K7:J7:typeof e=="function"?i.local?iU:tU:i.local?eU:Q7)(i,e))}function tO(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function nU(t){return function(){this.style.removeProperty(t)}}function sU(t,e,i){return function(){this.style.setProperty(t,e,i)}}function oU(t,e,i){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,i)}}function aU(t,e,i){return arguments.length>1?this.each((e==null?nU:typeof e=="function"?oU:sU)(t,e,i??"")):Xf(this.node(),t)}function Xf(t,e){return t.style.getPropertyValue(e)||tO(t).getComputedStyle(t,null).getPropertyValue(e)}function lU(t){return function(){delete this[t]}}function cU(t,e){return function(){this[t]=e}}function uU(t,e){return function(){var i=e.apply(this,arguments);i==null?delete this[t]:this[t]=i}}function hU(t,e){return arguments.length>1?this.each((e==null?lU:typeof e=="function"?uU:cU)(t,e)):this.node()[t]}function iO(t){return t.trim().split(/^|\s+/)}function WI(t){return t.classList||new rO(t)}function rO(t){this._node=t,this._names=iO(t.getAttribute("class")||"")}rO.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function nO(t,e){for(var i=WI(t),r=-1,o=e.length;++r<o;)i.add(e[r])}function sO(t,e){for(var i=WI(t),r=-1,o=e.length;++r<o;)i.remove(e[r])}function dU(t){return function(){nO(this,t)}}function pU(t){return function(){sO(this,t)}}function fU(t,e){return function(){(e.apply(this,arguments)?nO:sO)(this,t)}}function mU(t,e){var i=iO(t+"");if(arguments.length<2){for(var r=WI(this.node()),o=-1,h=i.length;++o<h;)if(!r.contains(i[o]))return!1;return!0}return this.each((typeof e=="function"?fU:e?dU:pU)(i,e))}function gU(){this.textContent=""}function yU(t){return function(){this.textContent=t}}function _U(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function vU(t){return arguments.length?this.each(t==null?gU:(typeof t=="function"?_U:yU)(t)):this.node().textContent}function bU(){this.innerHTML=""}function xU(t){return function(){this.innerHTML=t}}function wU(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function SU(t){return arguments.length?this.each(t==null?bU:(typeof t=="function"?wU:xU)(t)):this.node().innerHTML}function TU(){this.nextSibling&&this.parentNode.appendChild(this)}function CU(){return this.each(TU)}function EU(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function IU(){return this.each(EU)}function $U(t){var e=typeof t=="function"?t:Yz(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function PU(){return null}function MU(t,e){var i=typeof t=="function"?t:Yz(t),r=e==null?PU:typeof e=="function"?e:ZI(e);return this.select(function(){return this.insertBefore(i.apply(this,arguments),r.apply(this,arguments)||null)})}function kU(){var t=this.parentNode;t&&t.removeChild(this)}function AU(){return this.each(kU)}function DU(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function zU(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function OU(t){return this.select(t?zU:DU)}function RU(t){return arguments.length?this.property("__data__",t):this.node().__data__}function LU(t){return function(e){t.call(this,e,this.__data__)}}function FU(t){return t.trim().split(/^|\s+/).map(function(e){var i="",r=e.indexOf(".");return r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),{type:e,name:i}})}function NU(t){return function(){var e=this.__on;if(e){for(var i=0,r=-1,o=e.length,h;i<o;++i)h=e[i],(!t.type||h.type===t.type)&&h.name===t.name?this.removeEventListener(h.type,h.listener,h.options):e[++r]=h;++r?e.length=r:delete this.__on}}}function BU(t,e,i){return function(){var r=this.__on,o,h=LU(e);if(r){for(var d=0,a=r.length;d<a;++d)if((o=r[d]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=h,o.options=i),o.value=e;return}}this.addEventListener(t.type,h,i),o={type:t.type,name:t.name,value:e,listener:h,options:i},r?r.push(o):this.__on=[o]}}function jU(t,e,i){var r=FU(t+""),o,h=r.length,d;if(arguments.length<2){var a=this.node().__on;if(a){for(var _=0,T=a.length,E;_<T;++_)for(o=0,E=a[_];o<h;++o)if((d=r[o]).type===E.type&&d.name===E.name)return E.value}return}for(a=e?BU:NU,o=0;o<h;++o)this.each(a(r[o],e,i));return this}function oO(t,e,i){var r=tO(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,i):(o=r.document.createEvent("Event"),i?(o.initEvent(e,i.bubbles,i.cancelable),o.detail=i.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function UU(t,e){return function(){return oO(this,t,e)}}function VU(t,e){return function(){return oO(this,t,e.apply(this,arguments))}}function GU(t,e){return this.each((typeof e=="function"?VU:UU)(t,e))}function*qU(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r=t[e],o=0,h=r.length,d;o<h;++o)(d=r[o])&&(yield d)}var YI=[null];function fs(t,e){this._groups=t,this._parents=e}function q0(){return new fs([[document.documentElement]],YI)}function HU(){return this}fs.prototype=q0.prototype={constructor:fs,select:v7,selectAll:w7,selectChild:E7,selectChildren:M7,filter:k7,data:L7,enter:A7,exit:N7,join:B7,merge:j7,selection:HU,order:U7,sort:V7,call:q7,nodes:H7,node:Z7,size:W7,empty:Y7,each:X7,attr:rU,style:aU,property:hU,classed:mU,text:vU,html:SU,raise:CU,lower:IU,append:$U,insert:MU,remove:AU,clone:OU,datum:RU,on:jU,dispatch:GU,[Symbol.iterator]:qU};function Ph(t){return typeof t=="string"?new fs([[document.querySelector(t)]],[document.documentElement]):new fs([[t]],YI)}function Zl(t){return typeof t=="string"?new fs([document.querySelectorAll(t)],[document.documentElement]):new fs([Xz(t)],YI)}function XI(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function aO(t,e){var i=Object.create(t.prototype);for(var r in e)i[r]=e[r];return i}function H0(){}var o0=.7,lx=1/o0,If="\\s*([+-]?\\d+)\\s*",a0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ZU=/^#([0-9a-f]{3,8})$/,WU=new RegExp(`^rgb\\(${If},${If},${If}\\)$`),YU=new RegExp(`^rgb\\(${dl},${dl},${dl}\\)$`),XU=new RegExp(`^rgba\\(${If},${If},${If},${a0}\\)$`),JU=new RegExp(`^rgba\\(${dl},${dl},${dl},${a0}\\)$`),KU=new RegExp(`^hsl\\(${a0},${dl},${dl}\\)$`),QU=new RegExp(`^hsla\\(${a0},${dl},${dl},${a0}\\)$`),Jk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};XI(H0,fd,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Kk,formatHex:Kk,formatHex8:eV,formatHsl:tV,formatRgb:Qk,toString:Qk});function Kk(){return this.rgb().formatHex()}function eV(){return this.rgb().formatHex8()}function tV(){return lO(this).formatHsl()}function Qk(){return this.rgb().formatRgb()}function fd(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=ZU.exec(t))?(i=e[1].length,e=parseInt(e[1],16),i===6?e3(e):i===3?new ks(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):i===8?Ev(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):i===4?Ev(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=WU.exec(t))?new ks(e[1],e[2],e[3],1):(e=YU.exec(t))?new ks(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=XU.exec(t))?Ev(e[1],e[2],e[3],e[4]):(e=JU.exec(t))?Ev(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=KU.exec(t))?r3(e[1],e[2]/100,e[3]/100,1):(e=QU.exec(t))?r3(e[1],e[2]/100,e[3]/100,e[4]):Jk.hasOwnProperty(t)?e3(Jk[t]):t==="transparent"?new ks(NaN,NaN,NaN,0):null}function e3(t){return new ks(t>>16&255,t>>8&255,t&255,1)}function Ev(t,e,i,r){return r<=0&&(t=e=i=NaN),new ks(t,e,i,r)}function iV(t){return t instanceof H0||(t=fd(t)),t?(t=t.rgb(),new ks(t.r,t.g,t.b,t.opacity)):new ks}function UT(t,e,i,r){return arguments.length===1?iV(t):new ks(t,e,i,r??1)}function ks(t,e,i,r){this.r=+t,this.g=+e,this.b=+i,this.opacity=+r}XI(ks,UT,aO(H0,{brighter(t){return t=t==null?lx:Math.pow(lx,t),new ks(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?o0:Math.pow(o0,t),new ks(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ks(od(this.r),od(this.g),od(this.b),cx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:t3,formatHex:t3,formatHex8:rV,formatRgb:i3,toString:i3}));function t3(){return`#${Qh(this.r)}${Qh(this.g)}${Qh(this.b)}`}function rV(){return`#${Qh(this.r)}${Qh(this.g)}${Qh(this.b)}${Qh((isNaN(this.opacity)?1:this.opacity)*255)}`}function i3(){const t=cx(this.opacity);return`${t===1?"rgb(":"rgba("}${od(this.r)}, ${od(this.g)}, ${od(this.b)}${t===1?")":`, ${t})`}`}function cx(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function od(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Qh(t){return t=od(t),(t<16?"0":"")+t.toString(16)}function r3(t,e,i,r){return r<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new _a(t,e,i,r)}function lO(t){if(t instanceof _a)return new _a(t.h,t.s,t.l,t.opacity);if(t instanceof H0||(t=fd(t)),!t)return new _a;if(t instanceof _a)return t;t=t.rgb();var e=t.r/255,i=t.g/255,r=t.b/255,o=Math.min(e,i,r),h=Math.max(e,i,r),d=NaN,a=h-o,_=(h+o)/2;return a?(e===h?d=(i-r)/a+(i<r)*6:i===h?d=(r-e)/a+2:d=(e-i)/a+4,a/=_<.5?h+o:2-h-o,d*=60):a=_>0&&_<1?0:d,new _a(d,a,_,t.opacity)}function nV(t,e,i,r){return arguments.length===1?lO(t):new _a(t,e,i,r??1)}function _a(t,e,i,r){this.h=+t,this.s=+e,this.l=+i,this.opacity=+r}XI(_a,nV,aO(H0,{brighter(t){return t=t==null?lx:Math.pow(lx,t),new _a(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?o0:Math.pow(o0,t),new _a(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,r=i+(i<.5?i:1-i)*e,o=2*i-r;return new ks(pS(t>=240?t-240:t+120,o,r),pS(t,o,r),pS(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new _a(n3(this.h),Iv(this.s),Iv(this.l),cx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=cx(this.opacity);return`${t===1?"hsl(":"hsla("}${n3(this.h)}, ${Iv(this.s)*100}%, ${Iv(this.l)*100}%${t===1?")":`, ${t})`}`}}));function n3(t){return t=(t||0)%360,t<0?t+360:t}function Iv(t){return Math.max(0,Math.min(1,t||0))}function pS(t,e,i){return(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)*255}const JI=t=>()=>t;function sV(t,e){return function(i){return t+i*e}}function oV(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(r){return Math.pow(t+r*e,i)}}function aV(t){return(t=+t)==1?cO:function(e,i){return i-e?oV(e,i,t):JI(isNaN(e)?i:e)}}function cO(t,e){var i=e-t;return i?sV(t,i):JI(isNaN(t)?e:t)}const ux=(function t(e){var i=aV(e);function r(o,h){var d=i((o=UT(o)).r,(h=UT(h)).r),a=i(o.g,h.g),_=i(o.b,h.b),T=cO(o.opacity,h.opacity);return function(E){return o.r=d(E),o.g=a(E),o.b=_(E),o.opacity=T(E),o+""}}return r.gamma=t,r})(1);function lV(t,e){e||(e=[]);var i=t?Math.min(e.length,t.length):0,r=e.slice(),o;return function(h){for(o=0;o<i;++o)r[o]=t[o]*(1-h)+e[o]*h;return r}}function cV(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function uV(t,e){var i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),h=new Array(i),d;for(d=0;d<r;++d)o[d]=KI(t[d],e[d]);for(;d<i;++d)h[d]=e[d];return function(a){for(d=0;d<r;++d)h[d]=o[d](a);return h}}function hV(t,e){var i=new Date;return t=+t,e=+e,function(r){return i.setTime(t*(1-r)+e*r),i}}function ya(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}function dV(t,e){var i={},r={},o;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(o in e)o in t?i[o]=KI(t[o],e[o]):r[o]=e[o];return function(h){for(o in i)r[o]=i[o](h);return r}}var VT=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fS=new RegExp(VT.source,"g");function pV(t){return function(){return t}}function fV(t){return function(e){return t(e)+""}}function uO(t,e){var i=VT.lastIndex=fS.lastIndex=0,r,o,h,d=-1,a=[],_=[];for(t=t+"",e=e+"";(r=VT.exec(t))&&(o=fS.exec(e));)(h=o.index)>i&&(h=e.slice(i,h),a[d]?a[d]+=h:a[++d]=h),(r=r[0])===(o=o[0])?a[d]?a[d]+=o:a[++d]=o:(a[++d]=null,_.push({i:d,x:ya(r,o)})),i=fS.lastIndex;return i<e.length&&(h=e.slice(i),a[d]?a[d]+=h:a[++d]=h),a.length<2?_[0]?fV(_[0].x):pV(e):(e=_.length,function(T){for(var E=0,k;E<e;++E)a[(k=_[E]).i]=k.x(T);return a.join("")})}function KI(t,e){var i=typeof e,r;return e==null||i==="boolean"?JI(e):(i==="number"?ya:i==="string"?(r=fd(e))?(e=r,ux):uO:e instanceof fd?ux:e instanceof Date?hV:cV(e)?lV:Array.isArray(e)?uV:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?dV:ya)(t,e)}function mV(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}}var s3=180/Math.PI,GT={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hO(t,e,i,r,o,h){var d,a,_;return(d=Math.sqrt(t*t+e*e))&&(t/=d,e/=d),(_=t*i+e*r)&&(i-=t*_,r-=e*_),(a=Math.sqrt(i*i+r*r))&&(i/=a,r/=a,_/=a),t*r<e*i&&(t=-t,e=-e,_=-_,d=-d),{translateX:o,translateY:h,rotate:Math.atan2(e,t)*s3,skewX:Math.atan(_)*s3,scaleX:d,scaleY:a}}var $v;function gV(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?GT:hO(e.a,e.b,e.c,e.d,e.e,e.f)}function yV(t){return t==null||($v||($v=document.createElementNS("http://www.w3.org/2000/svg","g")),$v.setAttribute("transform",t),!(t=$v.transform.baseVal.consolidate()))?GT:(t=t.matrix,hO(t.a,t.b,t.c,t.d,t.e,t.f))}function dO(t,e,i,r){function o(T){return T.length?T.pop()+" ":""}function h(T,E,k,L,O,H){if(T!==k||E!==L){var re=O.push("translate(",null,e,null,i);H.push({i:re-4,x:ya(T,k)},{i:re-2,x:ya(E,L)})}else(k||L)&&O.push("translate("+k+e+L+i)}function d(T,E,k,L){T!==E?(T-E>180?E+=360:E-T>180&&(T+=360),L.push({i:k.push(o(k)+"rotate(",null,r)-2,x:ya(T,E)})):E&&k.push(o(k)+"rotate("+E+r)}function a(T,E,k,L){T!==E?L.push({i:k.push(o(k)+"skewX(",null,r)-2,x:ya(T,E)}):E&&k.push(o(k)+"skewX("+E+r)}function _(T,E,k,L,O,H){if(T!==k||E!==L){var re=O.push(o(O)+"scale(",null,",",null,")");H.push({i:re-4,x:ya(T,k)},{i:re-2,x:ya(E,L)})}else(k!==1||L!==1)&&O.push(o(O)+"scale("+k+","+L+")")}return function(T,E){var k=[],L=[];return T=t(T),E=t(E),h(T.translateX,T.translateY,E.translateX,E.translateY,k,L),d(T.rotate,E.rotate,k,L),a(T.skewX,E.skewX,k,L),_(T.scaleX,T.scaleY,E.scaleX,E.scaleY,k,L),T=E=null,function(O){for(var H=-1,re=L.length,pe;++H<re;)k[(pe=L[H]).i]=pe.x(O);return k.join("")}}}var _V=dO(gV,"px, ","px)","deg)"),vV=dO(yV,", ",")",")"),Jf=0,cy=0,Hg=0,pO=1e3,hx,uy,dx=0,md=0,G1=0,l0=typeof performance=="object"&&performance.now?performance:Date,fO=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function QI(){return md||(fO(bV),md=l0.now()+G1)}function bV(){md=0}function px(){this._call=this._time=this._next=null}px.prototype=mO.prototype={constructor:px,restart:function(t,e,i){if(typeof t!="function")throw new TypeError("callback is not a function");i=(i==null?QI():+i)+(e==null?0:+e),!this._next&&uy!==this&&(uy?uy._next=this:hx=this,uy=this),this._call=t,this._time=i,qT()},stop:function(){this._call&&(this._call=null,this._time=1/0,qT())}};function mO(t,e,i){var r=new px;return r.restart(t,e,i),r}function xV(){QI(),++Jf;for(var t=hx,e;t;)(e=md-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Jf}function o3(){md=(dx=l0.now())+G1,Jf=cy=0;try{xV()}finally{Jf=0,SV(),md=0}}function wV(){var t=l0.now(),e=t-dx;e>pO&&(G1-=e,dx=t)}function SV(){for(var t,e=hx,i,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(i=e._next,e._next=null,e=t?t._next=i:hx=i);uy=t,qT(r)}function qT(t){if(!Jf){cy&&(cy=clearTimeout(cy));var e=t-md;e>24?(t<1/0&&(cy=setTimeout(o3,t-l0.now()-G1)),Hg&&(Hg=clearInterval(Hg))):(Hg||(dx=l0.now(),Hg=setInterval(wV,pO)),Jf=1,fO(o3))}}function a3(t,e,i){var r=new px;return e=e==null?0:+e,r.restart(o=>{r.stop(),t(o+e)},e,i),r}var TV=Wz("start","end","cancel","interrupt"),CV=[],gO=0,l3=1,HT=2,ob=3,c3=4,ZT=5,ab=6;function q1(t,e,i,r,o,h){var d=t.__transition;if(!d)t.__transition={};else if(i in d)return;EV(t,i,{name:e,index:r,group:o,on:TV,tween:CV,time:h.time,delay:h.delay,duration:h.duration,ease:h.ease,timer:null,state:gO})}function e$(t,e){var i=Ma(t,e);if(i.state>gO)throw new Error("too late; already scheduled");return i}function xl(t,e){var i=Ma(t,e);if(i.state>ob)throw new Error("too late; already running");return i}function Ma(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function EV(t,e,i){var r=t.__transition,o;r[e]=i,i.timer=mO(h,0,i.time);function h(T){i.state=l3,i.timer.restart(d,i.delay,i.time),i.delay<=T&&d(T-i.delay)}function d(T){var E,k,L,O;if(i.state!==l3)return _();for(E in r)if(O=r[E],O.name===i.name){if(O.state===ob)return a3(d);O.state===c3?(O.state=ab,O.timer.stop(),O.on.call("interrupt",t,t.__data__,O.index,O.group),delete r[E]):+E<e&&(O.state=ab,O.timer.stop(),O.on.call("cancel",t,t.__data__,O.index,O.group),delete r[E])}if(a3(function(){i.state===ob&&(i.state=c3,i.timer.restart(a,i.delay,i.time),a(T))}),i.state=HT,i.on.call("start",t,t.__data__,i.index,i.group),i.state===HT){for(i.state=ob,o=new Array(L=i.tween.length),E=0,k=-1;E<L;++E)(O=i.tween[E].value.call(t,t.__data__,i.index,i.group))&&(o[++k]=O);o.length=k+1}}function a(T){for(var E=T<i.duration?i.ease.call(null,T/i.duration):(i.timer.restart(_),i.state=ZT,1),k=-1,L=o.length;++k<L;)o[k].call(t,E);i.state===ZT&&(i.on.call("end",t,t.__data__,i.index,i.group),_())}function _(){i.state=ab,i.timer.stop(),delete r[e];for(var T in r)return;delete t.__transition}}function IV(t,e){var i=t.__transition,r,o,h=!0,d;if(i){e=e==null?null:e+"";for(d in i){if((r=i[d]).name!==e){h=!1;continue}o=r.state>HT&&r.state<ZT,r.state=ab,r.timer.stop(),r.on.call(o?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete i[d]}h&&delete t.__transition}}function $V(t){return this.each(function(){IV(this,t)})}function PV(t,e){var i,r;return function(){var o=xl(this,t),h=o.tween;if(h!==i){r=i=h;for(var d=0,a=r.length;d<a;++d)if(r[d].name===e){r=r.slice(),r.splice(d,1);break}}o.tween=r}}function MV(t,e,i){var r,o;if(typeof i!="function")throw new Error;return function(){var h=xl(this,t),d=h.tween;if(d!==r){o=(r=d).slice();for(var a={name:e,value:i},_=0,T=o.length;_<T;++_)if(o[_].name===e){o[_]=a;break}_===T&&o.push(a)}h.tween=o}}function kV(t,e){var i=this._id;if(t+="",arguments.length<2){for(var r=Ma(this.node(),i).tween,o=0,h=r.length,d;o<h;++o)if((d=r[o]).name===t)return d.value;return null}return this.each((e==null?PV:MV)(i,t,e))}function t$(t,e,i){var r=t._id;return t.each(function(){var o=xl(this,r);(o.value||(o.value={}))[e]=i.apply(this,arguments)}),function(o){return Ma(o,r).value[e]}}function yO(t,e){var i;return(typeof e=="number"?ya:e instanceof fd?ux:(i=fd(e))?(e=i,ux):uO)(t,e)}function AV(t){return function(){this.removeAttribute(t)}}function DV(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zV(t,e,i){var r,o=i+"",h;return function(){var d=this.getAttribute(t);return d===o?null:d===r?h:h=e(r=d,i)}}function OV(t,e,i){var r,o=i+"",h;return function(){var d=this.getAttributeNS(t.space,t.local);return d===o?null:d===r?h:h=e(r=d,i)}}function RV(t,e,i){var r,o,h;return function(){var d,a=i(this),_;return a==null?void this.removeAttribute(t):(d=this.getAttribute(t),_=a+"",d===_?null:d===r&&_===o?h:(o=_,h=e(r=d,a)))}}function LV(t,e,i){var r,o,h;return function(){var d,a=i(this),_;return a==null?void this.removeAttributeNS(t.space,t.local):(d=this.getAttributeNS(t.space,t.local),_=a+"",d===_?null:d===r&&_===o?h:(o=_,h=e(r=d,a)))}}function FV(t,e){var i=V1(t),r=i==="transform"?vV:yO;return this.attrTween(t,typeof e=="function"?(i.local?LV:RV)(i,r,t$(this,"attr."+t,e)):e==null?(i.local?DV:AV)(i):(i.local?OV:zV)(i,r,e))}function NV(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function BV(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function jV(t,e){var i,r;function o(){var h=e.apply(this,arguments);return h!==r&&(i=(r=h)&&BV(t,h)),i}return o._value=e,o}function UV(t,e){var i,r;function o(){var h=e.apply(this,arguments);return h!==r&&(i=(r=h)&&NV(t,h)),i}return o._value=e,o}function VV(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;var r=V1(t);return this.tween(i,(r.local?jV:UV)(r,e))}function GV(t,e){return function(){e$(this,t).delay=+e.apply(this,arguments)}}function qV(t,e){return e=+e,function(){e$(this,t).delay=e}}function HV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?GV:qV)(e,t)):Ma(this.node(),e).delay}function ZV(t,e){return function(){xl(this,t).duration=+e.apply(this,arguments)}}function WV(t,e){return e=+e,function(){xl(this,t).duration=e}}function YV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ZV:WV)(e,t)):Ma(this.node(),e).duration}function XV(t,e){if(typeof e!="function")throw new Error;return function(){xl(this,t).ease=e}}function JV(t){var e=this._id;return arguments.length?this.each(XV(e,t)):Ma(this.node(),e).ease}function KV(t,e){return function(){var i=e.apply(this,arguments);if(typeof i!="function")throw new Error;xl(this,t).ease=i}}function QV(t){if(typeof t!="function")throw new Error;return this.each(KV(this._id,t))}function eG(t){typeof t!="function"&&(t=Kz(t));for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o)for(var h=e[o],d=h.length,a=r[o]=[],_,T=0;T<d;++T)(_=h[T])&&t.call(_,_.__data__,T,h)&&a.push(_);return new mc(r,this._parents,this._name,this._id)}function tG(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,r=e.length,o=i.length,h=Math.min(r,o),d=new Array(r),a=0;a<h;++a)for(var _=e[a],T=i[a],E=_.length,k=d[a]=new Array(E),L,O=0;O<E;++O)(L=_[O]||T[O])&&(k[O]=L);for(;a<r;++a)d[a]=e[a];return new mc(d,this._parents,this._name,this._id)}function iG(t){return(t+"").trim().split(/^|\s+/).every(function(e){var i=e.indexOf(".");return i>=0&&(e=e.slice(0,i)),!e||e==="start"})}function rG(t,e,i){var r,o,h=iG(e)?e$:xl;return function(){var d=h(this,t),a=d.on;a!==r&&(o=(r=a).copy()).on(e,i),d.on=o}}function nG(t,e){var i=this._id;return arguments.length<2?Ma(this.node(),i).on.on(t):this.each(rG(i,t,e))}function sG(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}function oG(){return this.on("end.remove",sG(this._id))}function aG(t){var e=this._name,i=this._id;typeof t!="function"&&(t=ZI(t));for(var r=this._groups,o=r.length,h=new Array(o),d=0;d<o;++d)for(var a=r[d],_=a.length,T=h[d]=new Array(_),E,k,L=0;L<_;++L)(E=a[L])&&(k=t.call(E,E.__data__,L,a))&&("__data__"in E&&(k.__data__=E.__data__),T[L]=k,q1(T[L],e,i,L,T,Ma(E,i)));return new mc(h,this._parents,e,i)}function lG(t){var e=this._name,i=this._id;typeof t!="function"&&(t=Jz(t));for(var r=this._groups,o=r.length,h=[],d=[],a=0;a<o;++a)for(var _=r[a],T=_.length,E,k=0;k<T;++k)if(E=_[k]){for(var L=t.call(E,E.__data__,k,_),O,H=Ma(E,i),re=0,pe=L.length;re<pe;++re)(O=L[re])&&q1(O,e,i,re,L,H);h.push(L),d.push(E)}return new mc(h,d,e,i)}var cG=q0.prototype.constructor;function uG(){return new cG(this._groups,this._parents)}function hG(t,e){var i,r,o;return function(){var h=Xf(this,t),d=(this.style.removeProperty(t),Xf(this,t));return h===d?null:h===i&&d===r?o:o=e(i=h,r=d)}}function _O(t){return function(){this.style.removeProperty(t)}}function dG(t,e,i){var r,o=i+"",h;return function(){var d=Xf(this,t);return d===o?null:d===r?h:h=e(r=d,i)}}function pG(t,e,i){var r,o,h;return function(){var d=Xf(this,t),a=i(this),_=a+"";return a==null&&(_=a=(this.style.removeProperty(t),Xf(this,t))),d===_?null:d===r&&_===o?h:(o=_,h=e(r=d,a))}}function fG(t,e){var i,r,o,h="style."+e,d="end."+h,a;return function(){var _=xl(this,t),T=_.on,E=_.value[h]==null?a||(a=_O(e)):void 0;(T!==i||o!==E)&&(r=(i=T).copy()).on(d,o=E),_.on=r}}function mG(t,e,i){var r=(t+="")=="transform"?_V:yO;return e==null?this.styleTween(t,hG(t,r)).on("end.style."+t,_O(t)):typeof e=="function"?this.styleTween(t,pG(t,r,t$(this,"style."+t,e))).each(fG(this._id,t)):this.styleTween(t,dG(t,r,e),i).on("end.style."+t,null)}function gG(t,e,i){return function(r){this.style.setProperty(t,e.call(this,r),i)}}function yG(t,e,i){var r,o;function h(){var d=e.apply(this,arguments);return d!==o&&(r=(o=d)&&gG(t,d,i)),r}return h._value=e,h}function _G(t,e,i){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,yG(t,e,i??""))}function vG(t){return function(){this.textContent=t}}function bG(t){return function(){var e=t(this);this.textContent=e??""}}function xG(t){return this.tween("text",typeof t=="function"?bG(t$(this,"text",t)):vG(t==null?"":t+""))}function wG(t){return function(e){this.textContent=t.call(this,e)}}function SG(t){var e,i;function r(){var o=t.apply(this,arguments);return o!==i&&(e=(i=o)&&wG(o)),e}return r._value=t,r}function TG(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,SG(t))}function CG(){for(var t=this._name,e=this._id,i=vO(),r=this._groups,o=r.length,h=0;h<o;++h)for(var d=r[h],a=d.length,_,T=0;T<a;++T)if(_=d[T]){var E=Ma(_,e);q1(_,t,i,T,d,{time:E.time+E.delay+E.duration,delay:0,duration:E.duration,ease:E.ease})}return new mc(r,this._parents,t,i)}function EG(){var t,e,i=this,r=i._id,o=i.size();return new Promise(function(h,d){var a={value:d},_={value:function(){--o===0&&h()}};i.each(function(){var T=xl(this,r),E=T.on;E!==t&&(e=(t=E).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(_)),T.on=e}),o===0&&h()})}var IG=0;function mc(t,e,i,r){this._groups=t,this._parents=e,this._name=i,this._id=r}function vO(){return++IG}var Wl=q0.prototype;mc.prototype={constructor:mc,select:aG,selectAll:lG,selectChild:Wl.selectChild,selectChildren:Wl.selectChildren,filter:eG,merge:tG,selection:uG,transition:CG,call:Wl.call,nodes:Wl.nodes,node:Wl.node,size:Wl.size,empty:Wl.empty,each:Wl.each,on:nG,attr:FV,attrTween:VV,style:mG,styleTween:_G,text:xG,textTween:TG,remove:oG,tween:kV,delay:HV,duration:YV,ease:JV,easeVarying:QV,end:EG,[Symbol.iterator]:Wl[Symbol.iterator]};function $G(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var PG={time:null,delay:0,duration:250,ease:$G};function MG(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}function kG(t){var e,i;t instanceof mc?(e=t._id,t=t._name):(e=vO(),(i=PG).time=QI(),t=t==null?null:t+"");for(var r=this._groups,o=r.length,h=0;h<o;++h)for(var d=r[h],a=d.length,_,T=0;T<a;++T)(_=d[T])&&q1(_,t,e,T,d,i||MG(_,e));return new mc(r,this._parents,t,e)}q0.prototype.interrupt=$V;q0.prototype.transition=kG;const WT=Math.PI,YT=2*WT,Lh=1e-6,AG=YT-Lh;function bO(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=arguments[e]+t[e]}function DG(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return bO;const i=10**e;return function(r){this._+=r[0];for(let o=1,h=r.length;o<h;++o)this._+=Math.round(arguments[o]*i)/i+r[o]}}class zG{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?bO:DG(e)}moveTo(e,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,i){this._append`L${this._x1=+e},${this._y1=+i}`}quadraticCurveTo(e,i,r,o){this._append`Q${+e},${+i},${this._x1=+r},${this._y1=+o}`}bezierCurveTo(e,i,r,o,h,d){this._append`C${+e},${+i},${+r},${+o},${this._x1=+h},${this._y1=+d}`}arcTo(e,i,r,o,h){if(e=+e,i=+i,r=+r,o=+o,h=+h,h<0)throw new Error(`negative radius: ${h}`);let d=this._x1,a=this._y1,_=r-e,T=o-i,E=d-e,k=a-i,L=E*E+k*k;if(this._x1===null)this._append`M${this._x1=e},${this._y1=i}`;else if(L>Lh)if(!(Math.abs(k*_-T*E)>Lh)||!h)this._append`L${this._x1=e},${this._y1=i}`;else{let O=r-d,H=o-a,re=_*_+T*T,pe=O*O+H*H,ge=Math.sqrt(re),Se=Math.sqrt(L),Pe=h*Math.tan((WT-Math.acos((re+L-pe)/(2*ge*Se)))/2),Re=Pe/Se,ze=Pe/ge;Math.abs(Re-1)>Lh&&this._append`L${e+Re*E},${i+Re*k}`,this._append`A${h},${h},0,0,${+(k*O>E*H)},${this._x1=e+ze*_},${this._y1=i+ze*T}`}}arc(e,i,r,o,h,d){if(e=+e,i=+i,r=+r,d=!!d,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(o),_=r*Math.sin(o),T=e+a,E=i+_,k=1^d,L=d?o-h:h-o;this._x1===null?this._append`M${T},${E}`:(Math.abs(this._x1-T)>Lh||Math.abs(this._y1-E)>Lh)&&this._append`L${T},${E}`,r&&(L<0&&(L=L%YT+YT),L>AG?this._append`A${r},${r},0,1,${k},${e-a},${i-_}A${r},${r},0,1,${k},${this._x1=T},${this._y1=E}`:L>Lh&&this._append`A${r},${r},0,${+(L>=WT)},${k},${this._x1=e+r*Math.cos(h)},${this._y1=i+r*Math.sin(h)}`)}rect(e,i,r,o){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}h${r=+r}v${+o}h${-r}Z`}toString(){return this._}}function OG(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function fx(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,r=t.slice(0,i);return[r.length>1?r[0]+r.slice(2):r,+t.slice(i+1)]}function Kf(t){return t=fx(Math.abs(t)),t?t[1]:NaN}function RG(t,e){return function(i,r){for(var o=i.length,h=[],d=0,a=t[0],_=0;o>0&&a>0&&(_+a+1>r&&(a=Math.max(1,r-_)),h.push(i.substring(o-=a,o+a)),!((_+=a+1)>r));)a=t[d=(d+1)%t.length];return h.reverse().join(e)}}function LG(t){return function(e){return e.replace(/[0-9]/g,function(i){return t[+i]})}}var FG=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function mx(t){if(!(e=FG.exec(t)))throw new Error("invalid format: "+t);var e;return new i$({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}mx.prototype=i$.prototype;function i$(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}i$.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function NG(t){e:for(var e=t.length,i=1,r=-1,o;i<e;++i)switch(t[i]){case".":r=o=i;break;case"0":r===0&&(r=i),o=i;break;default:if(!+t[i])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(o+1):t}var xO;function BG(t,e){var i=fx(t,e);if(!i)return t+"";var r=i[0],o=i[1],h=o-(xO=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,d=r.length;return h===d?r:h>d?r+new Array(h-d+1).join("0"):h>0?r.slice(0,h)+"."+r.slice(h):"0."+new Array(1-h).join("0")+fx(t,Math.max(0,e+h-1))[0]}function u3(t,e){var i=fx(t,e);if(!i)return t+"";var r=i[0],o=i[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}const h3={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:OG,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>u3(t*100,e),r:u3,s:BG,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function d3(t){return t}var p3=Array.prototype.map,f3=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function jG(t){var e=t.grouping===void 0||t.thousands===void 0?d3:RG(p3.call(t.grouping,Number),t.thousands+""),i=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",o=t.decimal===void 0?".":t.decimal+"",h=t.numerals===void 0?d3:LG(p3.call(t.numerals,String)),d=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",_=t.nan===void 0?"NaN":t.nan+"";function T(k){k=mx(k);var L=k.fill,O=k.align,H=k.sign,re=k.symbol,pe=k.zero,ge=k.width,Se=k.comma,Pe=k.precision,Re=k.trim,ze=k.type;ze==="n"?(Se=!0,ze="g"):h3[ze]||(Pe===void 0&&(Pe=12),Re=!0,ze="g"),(pe||L==="0"&&O==="=")&&(pe=!0,L="0",O="=");var Je=re==="$"?i:re==="#"&&/[boxX]/.test(ze)?"0"+ze.toLowerCase():"",Xe=re==="$"?r:/[%p]/.test(ze)?d:"",yt=h3[ze],mt=/[defgprs%]/.test(ze);Pe=Pe===void 0?6:/[gprs]/.test(ze)?Math.max(1,Math.min(21,Pe)):Math.max(0,Math.min(20,Pe));function je(ke){var We=Je,Ce=Xe,Ee,st,_t;if(ze==="c")Ce=yt(ke)+Ce,ke="";else{ke=+ke;var ht=ke<0||1/ke<0;if(ke=isNaN(ke)?_:yt(Math.abs(ke),Pe),Re&&(ke=NG(ke)),ht&&+ke==0&&H!=="+"&&(ht=!1),We=(ht?H==="("?H:a:H==="-"||H==="("?"":H)+We,Ce=(ze==="s"?f3[8+xO/3]:"")+Ce+(ht&&H==="("?")":""),mt){for(Ee=-1,st=ke.length;++Ee<st;)if(_t=ke.charCodeAt(Ee),48>_t||_t>57){Ce=(_t===46?o+ke.slice(Ee+1):ke.slice(Ee))+Ce,ke=ke.slice(0,Ee);break}}}Se&&!pe&&(ke=e(ke,1/0));var nt=We.length+ke.length+Ce.length,rt=nt<ge?new Array(ge-nt+1).join(L):"";switch(Se&&pe&&(ke=e(rt+ke,rt.length?ge-Ce.length:1/0),rt=""),O){case"<":ke=We+ke+Ce+rt;break;case"=":ke=We+rt+ke+Ce;break;case"^":ke=rt.slice(0,nt=rt.length>>1)+We+ke+Ce+rt.slice(nt);break;default:ke=rt+We+ke+Ce;break}return h(ke)}return je.toString=function(){return k+""},je}function E(k,L){var O=T((k=mx(k),k.type="f",k)),H=Math.max(-8,Math.min(8,Math.floor(Kf(L)/3)))*3,re=Math.pow(10,-H),pe=f3[8+H/3];return function(ge){return O(re*ge)+pe}}return{format:T,formatPrefix:E}}var Pv,wO,SO;UG({thousands:",",grouping:[3],currency:["$",""]});function UG(t){return Pv=jG(t),wO=Pv.format,SO=Pv.formatPrefix,Pv}function VG(t){return Math.max(0,-Kf(Math.abs(t)))}function GG(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Kf(e)/3)))*3-Kf(Math.abs(t)))}function qG(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Kf(e)-Kf(t))+1}function TO(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const m3=Symbol("implicit");function CO(){var t=new qk,e=[],i=[],r=m3;function o(h){let d=t.get(h);if(d===void 0){if(r!==m3)return r;t.set(h,d=e.push(h)-1)}return i[d%i.length]}return o.domain=function(h){if(!arguments.length)return e.slice();e=[],t=new qk;for(const d of h)t.has(d)||t.set(d,e.push(d)-1);return o},o.range=function(h){return arguments.length?(i=Array.from(h),o):i.slice()},o.unknown=function(h){return arguments.length?(r=h,o):r},o.copy=function(){return CO(e,i).unknown(r)},TO.apply(o,arguments),o}function HG(t){return function(){return t}}function ZG(t){return+t}var g3=[0,1];function df(t){return t}function XT(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:HG(isNaN(e)?NaN:.5)}function WG(t,e){var i;return t>e&&(i=t,t=e,e=i),function(r){return Math.max(t,Math.min(e,r))}}function YG(t,e,i){var r=t[0],o=t[1],h=e[0],d=e[1];return o<r?(r=XT(o,r),h=i(d,h)):(r=XT(r,o),h=i(h,d)),function(a){return h(r(a))}}function XG(t,e,i){var r=Math.min(t.length,e.length)-1,o=new Array(r),h=new Array(r),d=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++d<r;)o[d]=XT(t[d],t[d+1]),h[d]=i(e[d],e[d+1]);return function(a){var _=J9(t,a,1,r)-1;return h[_](o[_](a))}}function JG(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function KG(){var t=g3,e=g3,i=KI,r,o,h,d=df,a,_,T;function E(){var L=Math.min(t.length,e.length);return d!==df&&(d=WG(t[0],t[L-1])),a=L>2?XG:YG,_=T=null,k}function k(L){return L==null||isNaN(L=+L)?h:(_||(_=a(t.map(r),e,i)))(r(d(L)))}return k.invert=function(L){return d(o((T||(T=a(e,t.map(r),ya)))(L)))},k.domain=function(L){return arguments.length?(t=Array.from(L,ZG),E()):t.slice()},k.range=function(L){return arguments.length?(e=Array.from(L),E()):e.slice()},k.rangeRound=function(L){return e=Array.from(L),i=mV,E()},k.clamp=function(L){return arguments.length?(d=L?!0:df,E()):d!==df},k.interpolate=function(L){return arguments.length?(i=L,E()):i},k.unknown=function(L){return arguments.length?(h=L,k):h},function(L,O){return r=L,o=O,E()}}function QG(){return KG()(df,df)}function eq(t,e,i,r){var o=s7(t,e,i),h;switch(r=mx(r??",f"),r.type){case"s":{var d=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(h=GG(o,d))&&(r.precision=h),SO(r,d)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(h=qG(o,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=h-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(h=VG(o))&&(r.precision=h-(r.type==="%")*2);break}}return wO(r)}function tq(t){var e=t.domain;return t.ticks=function(i){var r=e();return n7(r[0],r[r.length-1],i??10)},t.tickFormat=function(i,r){var o=e();return eq(o[0],o[o.length-1],i??10,r)},t.nice=function(i){i==null&&(i=10);var r=e(),o=0,h=r.length-1,d=r[o],a=r[h],_,T,E=10;for(a<d&&(T=d,d=a,a=T,T=o,o=h,h=T);E-- >0;){if(T=NT(d,a,i),T===_)return r[o]=d,r[h]=a,e(r);if(T>0)d=Math.floor(d/T)*T,a=Math.ceil(a/T)*T;else if(T<0)d=Math.ceil(d*T)/T,a=Math.floor(a*T)/T;else break;_=T}return t},t}function lb(){var t=QG();return t.copy=function(){return JG(t,lb())},TO.apply(t,arguments),tq(t)}function Rp(t){return function(){return t}}function iq(t){let e=3;return t.digits=function(i){if(!arguments.length)return e;if(i==null)e=null;else{const r=Math.floor(i);if(!(r>=0))throw new RangeError(`invalid digits: ${i}`);e=r}return t},()=>new zG(e)}function rq(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function EO(t){this._context=t}EO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function nq(t){return new EO(t)}function sq(t){return t[0]}function oq(t){return t[1]}function y3(t,e){var i=Rp(!0),r=null,o=nq,h=null,d=iq(a);t=typeof t=="function"?t:t===void 0?sq:Rp(t),e=typeof e=="function"?e:e===void 0?oq:Rp(e);function a(_){var T,E=(_=rq(_)).length,k,L=!1,O;for(r==null&&(h=o(O=d())),T=0;T<=E;++T)!(T<E&&i(k=_[T],T,_))===L&&((L=!L)?h.lineStart():h.lineEnd()),L&&h.point(+t(k,T,_),+e(k,T,_));if(O)return h=null,O+""||null}return a.x=function(_){return arguments.length?(t=typeof _=="function"?_:Rp(+_),a):t},a.y=function(_){return arguments.length?(e=typeof _=="function"?_:Rp(+_),a):e},a.defined=function(_){return arguments.length?(i=typeof _=="function"?_:Rp(!!_),a):i},a.curve=function(_){return arguments.length?(o=_,r!=null&&(h=o(r)),a):o},a.context=function(_){return arguments.length?(_==null?r=h=null:h=o(r=_),a):r},a}function _3(t){return t<0?-1:1}function v3(t,e,i){var r=t._x1-t._x0,o=e-t._x1,h=(t._y1-t._y0)/(r||o<0&&-0),d=(i-t._y1)/(o||r<0&&-0),a=(h*o+d*r)/(r+o);return(_3(h)+_3(d))*Math.min(Math.abs(h),Math.abs(d),.5*Math.abs(a))||0}function b3(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function mS(t,e,i){var r=t._x0,o=t._y0,h=t._x1,d=t._y1,a=(h-r)/3;t._context.bezierCurveTo(r+a,o+a*e,h-a,d-a*i,h,d)}function gx(t){this._context=t}gx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:mS(this,this._t0,b3(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var i=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,mS(this,b3(this,i=v3(this,t,e)),i);break;default:mS(this,this._t0,i=v3(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=i}}};Object.create(gx.prototype).point=function(t,e){gx.prototype.point.call(this,e,t)};function x3(t){return new gx(t)}function hy(t,e,i){this.k=t,this.x=e,this.y=i}hy.prototype={constructor:hy,scale:function(t){return t===1?this:new hy(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new hy(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};hy.prototype;const aq={ref:"popupContainer",class:"popup-container"},lq={class:"feature-details"},cq={key:0,class:"popup-header"},uq={class:"header-content"},hq={key:0,class:"feature-name"},dq={key:1,class:"feature-name"},pq={key:2,class:"feature-address"},fq={key:1,class:"stats-section"},mq={class:"indicator-title"},gq={class:"stats-grid"},yq={class:"stat-label"},_q={class:"stat-value percentage"},vq={key:0,class:"stat-value count"},bq={key:2,class:"more-info-section"},xq=["innerHTML"],wq={key:3,class:"popup-header area"},Sq={class:"header-content"},Tq={key:0,class:"feature-name"},Cq={key:1,class:"feature-name"},Eq={key:2,class:"feature-address"},Iq=Md({__name:"Popup",props:{properties:{},side:{}},setup(t){const e=t,i=gd(e.side);j1(()=>{const a=document.getElementsByClassName("maplibregl-popup-content");if(a&&a.length>0)for(const _ of a)_.style.transform=`scale(${Math.min(1,window.innerWidth/1e3)})`,_.style.transformOrigin="bottom"});const r=xn(()=>i.getCurrentIndicator()),o=xn(()=>e.properties.more_info?decodeURIComponent(e.properties.more_info).split(`
`).join("<br/>"):""),h={pct:"pct_",count:"count_",pop:"pop_"},d=xn(()=>{const a=Array.from(new Set(Object.keys(e.properties).map(E=>Number(E.toLowerCase().replace("count_","").replace("pop_","").replace("pct_",""))).filter(E=>!isNaN(+E)))),_=[],T=r?.value?.popup;for(const E of a){const k=e.properties[h.count+E.toString()]||"",L=e.properties[h.pop+E.toString()]||"",O=e.properties[h.pct+E.toString()]||"",H=k===""&&L===""&&O==="",re=O!==""&&k===""&&L==="";_.push({isEmpty:H,pctOnly:re,year:E,title:T?.format?.title?.replace("{{count}}",(+k).toLocaleString()).replace("{{pop}}",(+L).toLocaleString()).replace("{{pct}}",O.toLocaleString()),subtitle:T?.format?.subtitle?.replace("{{count}}",(+k).toLocaleString()).replace("{{pop}}",(+L).toLocaleString()).replace("{{pct}}",O.toLocaleString())})}return _});return(a,_)=>{const T=Lr("v-icon"),E=Lr("v-divider"),k=Lr("v-expansion-panel-title"),L=Lr("v-expansion-panel-text"),O=Lr("v-expansion-panel"),H=Lr("v-expansion-panels");return vi(),Hi("div",aq,[Ct("div",lq,[r.value?.geotype==="protected"||r.value?.geotype==="tract"||r.value?.geotype==="county"?cn("",!0):(vi(),Hi("div",cq,[Vi(T,{icon:"mdi-map-marker",size:"24",color:"primary",class:"header-icon"}),Ct("div",uq,[a.properties.name?(vi(),Hi("h3",hq,Ki(a.properties.name),1)):a.properties.geoid?(vi(),Hi("h3",dq,Ki(r.value?.geotype==="tract"?"Census Tract Number":r.value?.geotype==="county"?"County FIPS code":"ID")+": "+Ki(a.properties.geoid),1)):cn("",!0),a.properties.address?(vi(),Hi("div",pq,[Vi(T,{icon:"mdi-map-marker-outline",size:"14",class:"mr-1"}),Vo(" "+Ki(decodeURIComponent(a.properties.address)),1)])):cn("",!0)])])),r.value?(vi(),Hi("div",fq,[Ct("div",mq,[Vi(T,{icon:"mdi-chart-line",size:"18",class:"mr-2"}),Vo(" "+Ki(r.value.title),1)]),Vi(E,{class:"my-3"}),Ct("div",gq,[(vi(!0),Hi(z9,null,O9(d.value,re=>(vi(),Hi("div",{key:re.year,class:U1({"stat-item":!0,"stat-item-empty":re.isEmpty})},[Ct("div",yq,Ki(re.year),1),Ct("div",_q,Ki(re.title),1),re.pctOnly?cn("",!0):(vi(),Hi("div",vq,Ki(re.subtitle),1))],2))),128))])])):cn("",!0),o.value.length>0?(vi(),Hi("div",bq,[Vi(H,{color:"primary",variant:"accordion",class:"info-panels"},{default:va(()=>[Vi(O,null,{default:va(()=>[Vi(k,{class:"info-panel-title"},{default:va(()=>[Vi(T,{icon:"mdi-information-outline",size:"18",class:"mx-2"}),_[0]||(_[0]=Ct("span",null,"More Information",-1)),_[1]||(_[1]=Ct("span",{class:"info-hint"},"(Click to expand)",-1))]),_:1}),Vi(L,{class:"info-panel-content"},{default:va(()=>[Ct("div",{innerHTML:o.value,class:"info-text"},null,8,xq)]),_:1})]),_:1})]),_:1})])):cn("",!0),r.value?.geotype==="protected"||r.value?.geotype==="tract"||r.value?.geotype==="county"?(vi(),Hi("div",wq,[Vi(T,{icon:"mdi-map-marker",size:"24",color:"primary",class:"header-icon"}),Ct("div",Sq,[a.properties.name?(vi(),Hi("h3",Tq,Ki(a.properties.name),1)):a.properties.geoid?(vi(),Hi("h3",Cq,Ki(r.value?.geotype==="tract"?"Census Tract Number":r.value?.geotype==="county"?"County FIPS code":"ID")+": "+Ki(a.properties.geoid),1)):cn("",!0),a.properties.address?(vi(),Hi("div",Eq,[Vi(T,{icon:"mdi-map-marker-outline",size:"14",class:"mr-1"}),Vo(" "+Ki(decodeURIComponent(a.properties.address)),1)])):cn("",!0)])])):cn("",!0)])],512)}}}),$q=kd(Iq,[["__scopeId","data-v-af6482b4"]]),Pq=2023,gS="overall",IO=/^\d{4}$/,yS=3,Mq=20,kq=10,Aq=400,_S=.75,Dq=1,vS=["overall","statewide","school district"],zq=.95,Oq=1.05,w3=12,S3=500,T3=.5;class $O{data;map;emitter;events;year;side;popup=null;frozenPopup=!1;popupApp=null;highlightedGeoid=null;lastPopupGeoid=null;popupProperties=null;arrasBranding;sitePath;hoveringPlaceId=-1;minValue;maxValue;rangeValues;constructor(e,i,r=null,o,h,d){this.data=e,this.map=i,this.emitter=o,this.events={click:null,mousemove:null,mouseleave:null},this.year=null,this.side=r,this.highlightedGeoid=null,this.arrasBranding=h,this.sitePath=d||"",this.hoveringPlaceId=-1,this.minValue=null,this.maxValue=null,this.rangeValues={count:{min:0,max:100},pop:{min:0,max:100},pct:{min:0,max:100}}}async setupIndicator(e){this.year=e||this.year||null,this.rangeValues.pop.min=this.getMin("pop")??null,this.rangeValues.pop.max=this.getMax("pop")??null,this.rangeValues.pct.min=this.getMin("pct")??null,this.rangeValues.pct.max=this.getMax("pct")??null,this.rangeValues.count.min=this.getMin("count")??null,this.rangeValues.count.max=this.getMax("count")??null;const{minValue:i,maxValue:r}=this.getMinMaxValues();return this.minValue=i,this.maxValue=r,!0}generateGeojson(){}getGradientExpression(){const e=this.data,i=this.minValue||this.getMinMaxValues().minValue,r=this.maxValue||this.getMinMaxValues().maxValue,o=this.arrasBranding.colors[e.style.min.color],h=this.arrasBranding.colors[e.style.max.color];if(!e||!e.layers||!e.layers.main||!e.style||!e.style.min||!e.style.max)return console.error("Missing required data properties:",{data:e,layers:e?.layers,style:e?.style}),!1;const d=this.data.timeline?.yearValuePrefix||"",a=["case",["has",d+String(this.year)],["interpolate",["linear"],["to-number",["get",d+String(this.year)]],i,o,r,h],"#0000"];return e.layers.main?a:(console.error("data.layers.main is undefined"),!1)}hideLayers(){this.map&&(this.data.layers.main&&this.map.setLayoutProperty(this.data.layers.main,"visibility","none"),this.data.layers.outline&&this.map.setLayoutProperty(this.data.layers.outline,"visibility","none"),this.data.legend?.extra_layers?.layer_name&&this.map.setLayoutProperty(this.data.legend?.extra_layers?.layer_name,"visibility","none"),this.data.layers.circle&&this.map.setLayoutProperty(this.data.layers.circle,"visibility","none"))}removeOldEvents(){if(!this.map){this.popupApp&&(this.popupApp.unmount(),this.popupApp=null),this.popup&&(this.popup.remove(),this.popup=null);return}this.events.click&&this.map.off("click",this.events.click),this.events.mousemove&&this.map.off("mousemove",this.events.mousemove),this.events.mouseleave&&this.map.off("mouseleave",this.events.mouseleave),this.popupApp&&(this.popupApp.unmount(),this.popupApp=null),this.popup&&(this.popup.remove(),this.popup=null)}addNewEvents(){this.events.mouseleave=()=>{this.frozenPopup||!this.popup||this.removePopup()};const e=this.data.layers.main;this.map.on("mouseleave",e,this.events.mouseleave),this.events.mousemove=i=>{const r=this.map.queryRenderedFeatures(i.point,{layers:["places-fill"]});r.length>0?(this.hoveringPlaceId=r[0].id,this.map.setFeatureState({source:"places-source",id:this.hoveringPlaceId},{hover:!0})):(this.map.setFeatureState({source:"places-source",id:this.hoveringPlaceId},{hover:!1}),this.hoveringPlaceId=-1)},this.map.on("mousemove",this.events.mousemove),this.events.click=i=>{this.frozenPopup=!this.frozenPopup},this.map.on("click",this.events.click)}createPopupIfNeeded(){this.popup||(this.popup=new uu.Popup({closeButton:!0,closeOnClick:!1,closeOnMove:!1,focusAfterOpen:!1}))}showPopup(e,i,r){if(!this.map)return;const o=i?.geoid||i?.id||null,h=o!==this.lastPopupGeoid,d=`popup-container-${r}`;this.createPopupIfNeeded(),this.popup.setLngLat(e),(h||!this.popupApp)&&this.popup.setHTML(`<div id="${d}"></div>`).addTo(this.map);const a=document.getElementById(d);a&&(h||!this.popupApp?(this.popupApp&&(this.popupApp.unmount(),this.popupApp=null),this.popupProperties=R9({...i}),this.popupApp=L9($q,{properties:this.popupProperties,side:r}).use(F9),this.popupApp.mount(a),this.lastPopupGeoid=o):this.popupProperties&&Object.assign(this.popupProperties,i))}removePopup(){this.popupApp&&(this.popupApp.unmount(),this.popupApp=null),this.popup&&(this.popup.remove(),this.popup=null),this.lastPopupGeoid=null,this.popupProperties=null}async setPaintAndLayoutProperties(e){return this.map?(this.year=e||this.year||null,this.map&&this.data.layers.main&&this.map.setLayoutProperty(this.data.layers.main,"visibility","visible"),this.map&&this.data.layers.outline&&this.map.setLayoutProperty(this.data.layers.outline,"visibility","visible"),this.map&&this.data.legend?.extra_layers?.layer_name&&this.map.setLayoutProperty(this.data.legend?.extra_layers?.layer_name,"visibility","visible"),!0):!1}getAllYears(){const e=this.data.google_sheets_data.headerShortNames;return Array.from(new Set(e.map(i=>Number(i.toLowerCase().replace("count_","").replace("pop_","").replace("pct_",""))).filter(i=>!isNaN(+i))))}getMinForYear(e,i){let o=this.data.google_sheets_data.data.filter(d=>d.geoid!==null&&d.geoid!==void 0&&d[e+"_"+(i||this.year)]!==null&&d[e+"_"+(i||this.year)]!==void 0);if((e==="pop"||e==="count")&&(o=o.filter(d=>!vS.some(a=>d?.geoid?.toLowerCase()?.includes(a)))),o.length===0)return console.warn(i,e,"no data"),null;const h=Math.min(...o.map(d=>+d[e+"_"+(i||this.year)]));return isNaN(+h)?(console.warn(i,e,"isNaN",h),Number.MAX_SAFE_INTEGER):h}getMaxForYear(e,i){let o=this.data.google_sheets_data.data.filter(d=>d.geoid!==null&&d.geoid!==void 0&&d[e+"_"+(i||this.year)]!==null&&d[e+"_"+(i||this.year)]!==void 0);if((e==="pop"||e==="count")&&(o=o.filter(d=>!vS.some(a=>d?.geoid?.toLowerCase()?.includes(a)))),o.length===0)return console.warn(i,e,"no data"),Number.MAX_SAFE_INTEGER;const h=Math.max(...o.map(d=>+d[e+"_"+(i||this.year)]));return isNaN(h)?(console.warn(i,e,"isNaN",h),Number.MAX_SAFE_INTEGER):h}getMin(e){let i=Number.MAX_SAFE_INTEGER;const r=this.getAllYears();for(let o=0;o<r.length;o++){const h=r[o],d=this.getMinForYear(e,+h);d!==null&&d<i&&!isNaN(d)&&(i=d)}return i}getMax(e){let i=0;const r=this.getAllYears();for(let o=0;o<r.length;o++){const h=r[o],d=this.getMaxForYear(e,+h);d!==null&&d>i&&!isNaN(d)&&(i=d)}return i}getMinMaxValues(){const e=this.data,i=e.timeline?.yearValuePrefix||"";let r=e.google_sheets_data.headerShortNames.filter(d=>i.length>0?d.startsWith(i):IO.test(d)&&!isNaN(Number(d))),o=Number.MAX_SAFE_INTEGER,h=0;for(let d=0;d<r.length;d++){const a=r[d],_=e.google_sheets_data.data.filter(k=>{const L=k?.geoid?.toLowerCase()||"",O=k?.name?.toLowerCase()||"";return!vS.some(H=>L.includes(H)||O.includes(H))}).map(k=>k[a]).filter(k=>k!=null&&!isNaN(Number(k)));if(_.length===0)continue;const T=Math.min(..._),E=Math.max(..._);T<o&&(o=T),E>h&&(h=E)}return{minValue:Math.floor(o*zq),maxValue:Math.ceil(h*Oq)}}}class Rq extends $O{selectedGeography=null;constructor(e,i,r=null,o,h,d){super(e,i,r,o,h,d),this.selectedGeography=null}async setupIndicator(e){await super.setupIndicator?.(e),this.removeOldEvents();const i=this.map,r=this.data,o=i.getSource(r.source_name),h=await o.getData();return h.features=h.features.map(d=>{let a=r.google_sheets_data.data.find(_=>+_.geoid==+d.properties.geoid);return Object.keys(a).forEach(_=>{(a[_]===null||a[_]===void 0)&&delete a[_]}),a?{type:"Feature",geometry:d.geometry,properties:a}:!1}),o&&typeof o.setData=="function"?o.setData(h):console.error(`Source ${r.source_name} not found`),await this.setPaintAndLayoutProperties(e),this.addNewEvents(),!0}removeOldEvents(){super.removeOldEvents()}addNewEvents(){super.addNewEvents();const e=this.map,i=this.data.layers.main;if(!e)return;const r=this.data;this.events.mousemove=o=>{if(this.frozenPopup)return;this.createPopupIfNeeded();const h=e.queryRenderedFeatures(o.point,{layers:[i]}),d=r.layers.outline;if(h.length>0){if(this.highlightedGeoid&&this.highlightedGeoid===h[0].properties.geoid)return;this.highlightedGeoid=this.highlightedGeoid||h[0]}else{this.emitter?.emit(`feature-${this.side||"left"}-hovered`,null),d&&e.setPaintProperty(d,"line-color",["case",["==",["get","geoid"],""+this.selectedGeography],["literal","#08ff"],"#0000"]),this.removePopup();return}const a=h[0],_=a.properties;d&&e.setPaintProperty(d,"line-color",["case",["==",["get","geoid"],""+_.geoid],["literal","#000f"],["==",["get","geoid"],""+this.selectedGeography],["literal","#08ff"],"#0000"]),this.showPopup(o.lngLat,a.properties,this.side),this.emitter?.emit(`feature-${this.side||"left"}-hovered`,a.properties.geoid)},e.on("mousemove",this.events.mousemove),this.events.click=o=>{if(!e)return;const h=e.queryRenderedFeatures(o.point,{layers:[i]});if(h.length===0||h[0].properties.geoid===this.selectedGeography){this.emitter?.emit(`feature-${this.side||"left"}-clicked`,null),this.selectedGeography=null,r.layers.outline&&e.setPaintProperty(r.layers.outline,"line-color","#0000");return}e.getLayer(r.layers.outline)&&e.setPaintProperty(r.layers.outline,"line-color",["case",["==",["get","geoid"],h[0].properties.geoid],["literal","#08ff"],"#0000"]),this.emitter?.emit(`feature-${this.side||"left"}-clicked`,h[0].properties.geoid),this.selectedGeography=h[0].properties.geoid},e.on("click",this.events.click)}async setPaintAndLayoutProperties(e){await super.setPaintAndLayoutProperties(e);const i=this.map;if(!i)return!1;const r=this.data,o=this.getGradientExpression();return console.log(o),o?(i.setPaintProperty(r.layers.main,"fill-color",o),i.setLayoutProperty(r.layers.main,"visibility","visible"),r.layers.supplementary&&r.layers.supplementary.forEach(h=>{console.log(h),i.setLayoutProperty(h,"visibility","visible")}),!0):(console.error("Failed to generate gradient expression"),!1)}generateGeojson(){super.generateGeojson()}}class Lq extends $O{constructor(e,i,r=null,o,h,d){super(e,i,r,o,h,d),this.arrasBranding=h}getSizeExpression(){let i=this.data.map?.size+"_"+String(this.year);return i?["case",["has",i],["interpolate",["linear"],["to-number",["get",i]],kq,yS,Aq,Mq],yS+3]:yS+3}async setupIndicator(e){await super.setupIndicator?.(e),this.removeOldEvents();const i=this.generateGeojson(),r=this.map,o=this.data,h=await r.getSource(o.source_name);return h&&typeof h.setData=="function"?h.setData(i):console.error(`Source ${o.source_name} not found`),await this.setPaintAndLayoutProperties(e),this.addNewEvents(),!0}removeOldEvents(){super.removeOldEvents()}addNewEvents(){super.addNewEvents();const e=this.map,i=this.data.layers.main;e&&(this.events.mousemove=r=>{if(this.frozenPopup)return;this.createPopupIfNeeded();const o=e.queryRenderedFeatures(r.point,{layers:[i]});if(o.length===0){e.setPaintProperty(i,"circle-opacity",_S),this.removePopup(),this.emitter?.emit(`feature-${this.side||"left"}-hovered`,null),this.emitter?.emit(`feature-name-${this.side||"left"}-hovered`,null);return}else e.setPaintProperty(i,"circle-opacity",["case",["==",["get","geoid"],o[0].properties.geoid],Dq,_S]),this.showPopup(r.lngLat,o[0].properties,this.side),this.emitter?.emit(`feature-${this.side||"left"}-hovered`,o[0].properties.geoid),this.emitter?.emit(`feature-name-${this.side||"left"}-hovered`,o[0].properties.name)},e.on("mousemove",this.events.mousemove))}async setPaintAndLayoutProperties(e){await super.setPaintAndLayoutProperties(e);const i=this.map;if(!i)return!1;const r=this.data.layers.main;i.setLayoutProperty(r,"visibility","visible"),i.setPaintProperty(r,"circle-radius",this.getSizeExpression()),i.setPaintProperty(r,"circle-opacity",_S),i.setLayoutProperty(r,"circle-sort-key",["case",["has",`cohort_${this.year}`],["/",1,["to-number",["get",`cohort_${this.year}`]]],["has",`count_${this.year}`],["/",1,["to-number",["get",`count_${this.year}`]]],["has",`pct_${this.year}`],["/",1,["to-number",["get",`pct_${this.year}`]]],0]);const o=this.arrasBranding.colors[this.data.style.max.color],h=this.data.map?.color===null?o:this.getGradientExpression();return i.setPaintProperty(r,"circle-color",h),i.setLayoutProperty(r,"visibility","visible"),!0}generateGeojson(){super.generateGeojson();const i={type:"FeatureCollection",features:this.data.google_sheets_data.data.map(r=>({type:"Feature",geometry:{type:"Point",coordinates:[+r.lng,+r.lat]},properties:r}))};return console.log(i),i}}function Fq(t,e,i=null,r,o,h){if(!e)return null;switch(t?.geolevel){case"protected":case"area":return new Rq(t,e,i,r,o,h);case"point":return new Lq(t,e,i,r,o,h);default:return console.warn(`Unknown geolevel: ${t?.geolevel}`),null}}const Nq=Ef(),Bq=t=>{const e=Ps(Go("arrasBranding")),i=Go("sitePath"),r=Ps(null),o=Ps(null);let h=null;const d=Ps(Pq),a=Ps(null),_=Ps(null);function T(){return Nq.getAllCurrentThemeIndicators()}function E(ze,Je){h=ze,ze.on("load",async()=>{const yt=T()?.find(mt=>t.includes(mt.default))||null;await ge(yt?.short_name||"",Je)})}let k=null;function L(){k&&(k.removeOldEvents(),k.hideLayers(),k=null),h=null}async function O(ze){typeof ze=="string"&&(ze=+ze.replace(/[^0-9]/g,"")),d.value=ze,k&&await k.setPaintAndLayoutProperties(ze)}function H(){return d.value}function re(){return o.value?.toLowerCase()||gS}function pe(ze){o.value=ze?.toLowerCase()||null}async function ge(ze,Je){const yt=T()?.find(mt=>mt.short_name===ze)||null;if(yt){if(r.value=yt,!yt.google_sheets_data)return!1;if(k&&(k.removeOldEvents(),k.hideLayers(),k=null),k=Fq(yt,h,t,Je,e.value,i),k){const mt=yt.google_sheets_data.headerShortNames;let je=mt&&mt.length>0?mt.filter(ke=>/^\d{4}$/.test(ke)).sort((ke,We)=>Number(ke)-Number(We)):null;(!je||je.length===0)&&(je=mt.filter(ke=>ke.toLowerCase().startsWith(yt.timeline?.yearValuePrefix||"")).sort((ke,We)=>Number(ke.replace(yt.timeline?.yearValuePrefix||"",""))-Number(We.replace(yt.timeline?.yearValuePrefix||"",""))).map(ke=>Number(ke.replace(yt.timeline?.yearValuePrefix||"","")))),await k.setupIndicator(je[je.length-1]),a.value=k.minValue??null,_.value=k.maxValue??null,await O(je[je.length-1]),pe(gS),Je?.on(`feature-${t}-clicked`,ke=>{pe(ke||gS)})}}else r.value=null}function Se(){return r.value||null}function Pe(ze){return ze==="count"?k?.rangeValues.count.min??null:ze==="pop"?k?.rangeValues.pop.min??null:ze==="pct"?k?.rangeValues.pct.min??null:null}function Re(ze){return ze==="count"?k?.rangeValues.count.max??null:ze==="pop"?k?.rangeValues.pop.max??null:ze==="pct"?k?.rangeValues.pct.max??null:null}return{setIndicatorFromIndicatorShortName:ge,getCurrentIndicator:Se,initializeMap:E,removeMap:L,setCurrentYear:O,getCurrentYear:H,getCurrentGeoSelection:re,setCurrentGeoSelection:pe,getMinValue:Pe,getMaxValue:Re,minValue:a,maxValue:_}},gd=t=>N9(`${t}-indicator`,()=>Bq(t))(),jq=Md({__name:"IndicatorSelector",props:{side:{}},setup(t,{expose:e}){const i=t,r=gd(i.side),o=Ef(),h=Go("mitt"),d=async a=>{await r.setIndicatorFromIndicatorShortName(a.short_name,h),h?.emit(`indicator-changed-${i.side}`,a,i.side)};return e({indicatorStore:r}),(a,_)=>{const T=Lr("v-list-item"),E=Lr("v-select");return vi(),Iu(E,{"model-value":cs(r)?.getCurrentIndicator(),items:cs(o)?.getAllCurrentThemeIndicators()||[],"return-object":"","item-title":"short_title",density:"compact",variant:"outlined",width:"100%","hide-details":"",class:"indicator-select","onUpdate:modelValue":d},{item:va(({props:k})=>[Vi(T,GI({class:"indicator-select-item"},k),null,16)]),_:1},8,["model-value","items"])}}}),Uq=kd(jq,[["__scopeId","data-v-712c6649"]]),Vq={class:"timeline-header"},Gq={ref:"container",class:"timeline-visualization"},qq={class:"chart-label"},Hq={class:"viz-legend"},Zq={key:0},Wq={class:"hovered-geo mx-0"},Yq={key:1},Xq={class:"hovered-geo mx-0"},bS="#2563eb",xS="#f80",wS="#7d7d7d",Jq=Md({__name:"TimelineVisualization",props:{side:{}},emits:["indicatorChanged","close"],setup(t){const e=Go("mitt"),i=t,r=gd(i.side),o=Ps(bS),h=Ps(xS),d=Ps();let a,_=document.body.clientWidth*.33,T=130,E={top:15,right:5,bottom:0,left:20},k=lb().domain([0,100]).range([T-E.bottom,E.top]);const L=xn(()=>{const je=r.getCurrentIndicator(),ke=je?.google_sheets_data;if(!ke)return[];const We=ke.headerShortNames;return Array.from(new Set(We.map(Ce=>Number(Ce.replace(je?.timeline?.yearValuePrefix||"",""))).filter(Ce=>Ce!=null&&!isNaN(Ce)).sort((Ce,Ee)=>Ce-Ee)))});xn(()=>r.getCurrentIndicator()?.timeline?.yearValueShortFormat||null);const O=xn({get:()=>r.getCurrentYear(),set:je=>{je!==null&&r.setCurrentYear(je)}}),H=je=>{r.setCurrentYear(je)},re=je=>{const ke=r.getCurrentIndicator(),We=ke?.google_sheets_data;if(!We)return[];const Ce=We.data,Ee=je||r.getCurrentGeoSelection();let st;const _t=[];return st=Ce.find(ht=>""+ht.geoid==""+Ee),st?(L.value.forEach(ht=>{let nt=ke?.timeline?.yearValuePrefix?`${ke.timeline.yearValuePrefix}${ht}`:ht.toString(),rt=st?.[nt];_t.push({year:ht,value:rt!=null&&rt!==""?Number(rt):null})}),_t):[]},pe=()=>{if(!d.value)return;const je=re(null);if(je.length===0)return;Ph(d.value).selectAll("*").remove(),a=Ph(d.value).attr("width",_).attr("height",T);const ke=je.filter(nt=>nt.value!==null&&!isNaN(+nt.value)).map(nt=>({year:nt.year,value:nt.value?.toFixed(2)?Number(nt.value?.toFixed(2)):null}));if(ke.length===0){Re(je);return}const We=ze(je);k=Xe(ke);const Ce=Wk(We).tickFormat(nt=>nt.toString()).tickSize(0).tickPadding(8),Ee=d7(k).tickFormat(nt=>nt.toLocaleString().replace(",000","K")).tickSize(-_+E.left+E.right).tickPadding(2).ticks(5);a.append("g").attr("class","x-axis").attr("transform",`translate(0, ${T+E.bottom})`).call(Ce).selectAll("text").style("font-size","10px").style("fill","#666"),a.append("g").attr("class","y-axis").attr("transform",`translate(${E.left}, 0)`).call(Ee).selectAll("text").style("font-size","10px").style("fill","#666"),a.selectAll(".y-axis .tick line").style("stroke","#e0e0e0").style("stroke-width",1);const st=r.getCurrentYear();if(st&&je.some(nt=>nt.year===st)){const nt=We(st);a.append("line").attr("class","current-year-line").attr("x1",nt).attr("x2",nt).attr("y1",E.top).attr("y2",T+E.bottom).style("stroke","#dc2626").style("stroke-width",1.5).style("stroke-dasharray","3,3").style("opacity",.7)}const _t=y3().x(nt=>We(nt.year)).y(nt=>k(nt.value)).curve(x3);a.append("path").datum(ke).attr("class","timeline-line").attr("d",_t).style("fill","none").style("stroke",bS).style("stroke-width",2),a.selectAll(".data-point").data(ke).enter().append("circle").attr("class","data-point").attr("cx",nt=>We(nt.year)).attr("cy",nt=>k(nt.value)).attr("r",4).style("fill",bS).style("stroke","#fff").style("stroke-width",2).style("cursor","pointer").on("click",(nt,rt)=>{r.setCurrentYear(rt.year)}).on("mouseover",function(nt,rt){rt.year!==r.getCurrentYear()&&Ph(this).transition().duration(200).attr("r",6).style("fill","#1d4ed8")}).on("mouseout",function(nt,rt){rt.year!==r.getCurrentYear()&&Ph(this).transition().duration(200).attr("r",4).style("fill","#2563eb")}).filter(nt=>nt.year===r.getCurrentYear()).style("fill","#dc2626").attr("r",5)},ge=Ps(""),Se=Ps(""),Pe=je=>{const ke=je.toLowerCase().includes("statewide");if(ge.value=ke?ge.value:je,!d.value)return;const We=re(je);if(We.length===0)return;a=Ph(d.value).attr("width",_).attr("height",T);const Ce=We.filter(ht=>ht.value!==null&&!isNaN(+ht.value)),Ee=ze(We);ke||a.append("rect").attr("class",`${ke?"statewide-":""}data-feature-point-label-background`).attr("x",E.left).attr("y",0).attr("width",_).attr("height",T).style("fill","#fff").style("opacity",.667);const st=y3().x(ht=>Ee(ht.year)).y(ht=>k(ht.value)).curve(x3);Zl(`.${i.side} .data-feature-point`).remove(),Zl(`.${i.side} .data-feature-point-label`).remove(),Zl(`.${i.side} .data-feature-point-label-background`).remove(),Zl(`.${i.side} .timeline-feature-line`).remove(),ke&&Zl(`.${i.side} ${ke?"statewide-":""}timeline-feature-line`).remove(),a.append("path").datum(Ce).attr("class",`${ke?"statewide-":""}timeline-feature-line`).attr("d",st).style("fill","none").style("stroke",ke?wS:xS).style("stroke-width",1),a.selectAll(`.${ke?"statewide-":""}data-feature-point`).data(Ce).enter().append("circle").attr("class",`${ke?"statewide-":""}data-feature-point`).attr("cx",ht=>Ee(ht.year)).attr("cy",ht=>k(ht.value)).attr("r",4).style("fill",ke?wS:xS).style("stroke","#fff").style("stroke-width",1).style("cursor","pointer").on("click",(ht,nt)=>{r.setCurrentYear(nt.year)}).on("mouseover",function(ht,nt){nt.year!==r.getCurrentYear()&&Ph(this).transition().duration(200).attr("r",6)}).on("mouseout",function(ht,nt){nt.year!==r.getCurrentYear()&&Ph(this).transition().duration(200).attr("r",4)}).filter(ht=>ht.year===r.getCurrentYear()).style("fill","#dc2626").attr("r",5)},Re=je=>{const ke=ze(je),We=Wk(ke).tickFormat(Ee=>Ee.toString()).tickSize(0).tickPadding(8);a.append("g").attr("class","x-axis").attr("transform",`translate(0, ${T+E.bottom})`).call(We).selectAll("text").style("font-size","10px").style("fill","#666");const Ce=r.getCurrentYear();if(Ce&&je.some(Ee=>Ee.year===Ce)){const Ee=ke(Ce);a.append("line").attr("class","current-year-line").attr("x1",Ee).attr("x2",Ee).attr("y1",E.top).attr("y2",T+E.bottom).style("stroke","#dc2626").style("stroke-width",1.5).style("stroke-dasharray","3,3").style("opacity",.7)}a.append("text").attr("x",_/2).attr("y",T/2).attr("text-anchor","middle").style("font-size","12px").style("fill","#999").text("No data available")},ze=je=>{const ke=je.map(Ee=>Ee.year).filter(Ee=>Ee!=null&&!isNaN(Number(Ee))).sort((Ee,st)=>Ee-st),We=[];let Ce=E.left+5;for(let Ee=0;Ee<ke.length;Ee++)if(We.push(Ce),Ee<ke.length-1){const st=ke[Ee],ht=ke[Ee+1]-st,nt=_/ke.length*(Math.sqrt(ht)/ke.length)*1.333;Ce+=nt}return CO().domain(ke).range(We)},Je=()=>{const je=r.getCurrentIndicator(),ke=je?.google_sheets_data;if(!ke)return{minValue:0,maxValue:100};const We=je?.timeline?.yearValuePrefix||"";let Ce=ke.headerShortNames.filter(_t=>We.length>0?_t.startsWith(We):IO.test(_t)&&!isNaN(Number(_t))),Ee=Number.MAX_SAFE_INTEGER,st=0;for(let _t=0;_t<Ce.length;_t++){const ht=ke.data.filter(Wt=>!je?.timeline?.filterOut?.some(ei=>Wt?.geoid.toLowerCase().includes(ei))).filter(Wt=>!Wt?.name?.toLowerCase().includes("school district")).map(Wt=>Wt[Ce[_t]]).filter(Wt=>Wt!=null&&!isNaN(Number(Wt))).map(Wt=>Number(Wt)),nt=Math.min(...ht),rt=Math.max(...ht);+nt<Ee&&(Ee=+nt),+rt>st&&(st=+rt)}return{minValue:Math.floor(Ee*.95),maxValue:Math.ceil(st*1.05)}},Xe=je=>{if(je.map(Ee=>Ee.value).filter(Ee=>Ee!=null&&!isNaN(+Ee)).length===0)return lb().domain([0,100]).range([T-E.bottom,E.top]);const{minValue:We,maxValue:Ce}=Je();return lb().domain([We,Ce]).range([T+E.bottom,E.top])},yt=async()=>{cS(()=>{pe(),Pe("statewide")})},mt=xn(()=>r?.getCurrentIndicator()?.google_sheets_data?.data?.find(je=>je?.geoid?.toLowerCase()==="statewide")!==void 0&&!r?.getCurrentIndicator()?.timeline?.filterOut?.some(je=>je.toLowerCase()==="statewide"));return FT([()=>r.getCurrentIndicator(),()=>r.getCurrentYear(),()=>r.getCurrentGeoSelection()],()=>{cS(()=>{pe(),Pe("statewide")})},{deep:!0}),j1(()=>{cS(()=>{pe()}),e.on(`feature-${i.side}-hovered`,je=>{Zl(".timeline-feature-line").remove(),Zl(".data-feature-point").remove(),Zl(".data-feature-point-label").remove(),Zl(".data-feature-point-label-background").remove(),je===null?ge.value="":(ge.value=je,Pe(je))}),e.on(`feature-name-${i.side}-hovered`,je=>{je===null?Se.value="":Se.value=je})}),Uz(()=>{e.off("feature-left-hovered",Pe),e.off("feature-right-hovered",Pe)}),(je,ke)=>{const We=Lr("v-select");return vi(),Hi("div",{class:U1(["timeline-visualization-container",je.side==="left"?"left":"right"])},[Ct("div",Vq,[Vi(Uq,{side:je.side,onIndicatorChanged:yt},null,8,["side"])]),L.value.length>0?(vi(),Iu(We,{key:0,modelValue:O.value,"onUpdate:modelValue":[ke[0]||(ke[0]=Ce=>O.value=Ce),H],items:L.value,label:"Year",density:"compact",variant:"solo",elevation:"0","hide-details":"",class:"year-selector"},null,8,["modelValue","items"])):cn("",!0),Ct("div",Gq,[Ct("div",qq,[Ct("table",Hq,[Ct("tbody",null,[Ct("tr",null,[cs(r)?.getCurrentIndicator()?.timeline?.filterOut?.some(Ce=>Ce.toLowerCase()==="overall")?cn("",!0):(vi(),Hi("td",Zq,[Ct("span",Wq,[ke[1]||(ke[1]=Vo("Chester & Lancaster avg.",-1)),ke[2]||(ke[2]=Ct("br",null,null,-1)),Ct("span",{class:"selected-color",style:hl({border:`2px solid ${o.value}`})},null,4)])])),mt.value?(vi(),Hi("td",Yq,[ke[3]||(ke[3]=Ct("span",{class:"selected-geo"},"Statewide",-1)),ke[4]||(ke[4]=Ct("br",null,null,-1)),Ct("span",{class:"selected-color",style:hl({border:`2px solid ${wS}`})},null,4)])):cn("",!0),Ct("td",null,[qI(Ct("span",Xq,[ke[5]||(ke[5]=Vo("Selected area",-1)),ke[6]||(ke[6]=Ct("br",null,null,-1)),Ct("span",{class:"hovered-color",style:hl({border:`2px solid ${h.value}`})},null,4)],512),[[HI,ge.value]])])])])])]),(vi(),Hi("svg",{ref_key:"svg",ref:d,class:"timeline-chart"},null,512))],512)],2)}}}),C3=kd(Jq,[["__scopeId","data-v-4e573ffc"]]),Kq={class:"legend-container"},Qq={class:"legend-header"},eH={class:"legend-title"},tH={class:"legend-content"},iH={class:"legend-gradient"},rH={class:"legend-labels"},nH={class:"min-label"},sH={class:"max-label"},oH=["innerHTML"],aH={class:"data-source"},lH=["href"],cH=Md({__name:"ColorLegend",props:{selectedIndicator:{},side:{}},setup(t){const e=Go("arrasBranding"),i=t,r=gd(i.side),o=Go("mainConfig"),h=xn(()=>o?.data_sources?.[i.selectedIndicator?.data_source]),d=xn(()=>i.selectedIndicator?.legend?.extra_layers?.html),a=xn(()=>{const E=i.selectedIndicator?.legend?.title,k=i.selectedIndicator?.legend?.["title-column"],L=r.getMinValue(k)??0,O=r.getMaxValue(k)??0;return E?{min:E.replace(`{{${k}}}`,(+L).toLocaleString()),max:E.replace(`{{${k}}}`,(+O).toLocaleString())}:{min:"",mid:"",max:""}}),_=xn(()=>{const E=i.selectedIndicator?.style?.min?.color;return E?e.colors[E]:"#f2f0f7"}),T=xn(()=>{const E=i.selectedIndicator?.style?.max?.color;return E?e.colors[E]:"#000000"});return(E,k)=>{const L=Lr("v-icon"),O=Lr("v-tooltip");return vi(),Hi("div",{class:U1(["color-legend",{left:E.side==="left",right:E.side==="right"}])},[Ct("div",Kq,[Ct("div",Qq,[Ct("span",eH,[Vo(Ki(E.selectedIndicator?.title||"Indicator")+" ",1),Vi(O,{style:{display:"inline-block","max-width":"500px"},location:"bottom",text:E.selectedIndicator["tooltip-info"]},{activator:va(({props:H})=>[Vi(L,GI(H,{icon:"mdi-information-outline",size:"18",class:"mx-2"}),null,16)]),_:1},8,["text"])])]),Ct("div",tH,[Ct("div",iH,[Ct("div",{class:"gradient-bar",style:hl({background:`linear-gradient(to right, ${_.value}, ${T.value})`})},null,4)]),Ct("div",rH,[Ct("span",nH,Ki(a.value.min),1),Ct("span",sH,Ki(a.value.max),1)]),d.value?(vi(),Hi("div",{key:0,class:"extra-layer",innerHTML:d.value},null,8,oH)):cn("",!0),qI(Ct("div",aH,[k[0]||(k[0]=Vo("Data Source: ",-1)),Ct("a",{href:h.value?.url,target:"_blank"},[Vo(Ki(h.value?.text)+" ",1),Vi(L,{icon:"mdi-open-in-new",size:"12"})],8,lH)],512),[[HI,h.value]])])])],2)}}}),E3=kd(cH,[["__scopeId","data-v-191e4f0c"]]),uH={class:"legend-container"},hH={class:"legend-header"},dH={class:"legend-title"},pH={class:"legend-content"},fH={key:0,class:"legend-icon-container"},mH={style:{"text-align":"left"}},gH={style:{"text-align":"center"}},yH={style:{"text-align":"right"}},_H={class:"legend-labels"},vH={style:{"text-align":"left"}},bH={class:"min-label"},xH={style:{"text-align":"center"}},wH={class:"mid-label"},SH={style:{"text-align":"right"}},TH={class:"max-label"},CH={key:2,class:"legend-icon-container"},EH={class:"legend-labels"},IH={style:{"text-align":"left"}},$H={class:"min-label"},PH={style:{"text-align":"center"}},MH={class:"mid-label"},kH={style:{"text-align":"right"}},AH={class:"max-label"},DH={class:"data-source"},zH=["href"],OH=Md({__name:"PointLegend",props:{selectedIndicator:{},side:{}},setup(t){const e=Go("arrasBranding"),i=t,r=gd(i.side),o=Go("mainConfig"),h=xn(()=>o?.data_sources?.[i.selectedIndicator?.data_source]),d=xn(()=>i.selectedIndicator?.legend?.["secondary-title-column"]),a=xn(()=>{const k=i.selectedIndicator?.legend?.["secondary-title"],L=r.getMinValue(d.value)??0,O=r.getMaxValue(d.value)??0,H=((L+O)/2).toFixed(0).toLocaleString();return k?{min:k.replace(`{{${d.value}}}`,L.toLocaleString()??"0"),mid:k.replace(`{{${d.value}}}`,H.toLocaleString()??"0"),max:k.replace(`{{${d.value}}}`,O.toLocaleString()??"0")}:{min:"",mid:"",max:""}}),_=xn(()=>{const k=i.selectedIndicator?.legend?.title,L=i.selectedIndicator?.legend?.["title-column"],O=r.getMinValue(L)??0,H=r.getMaxValue(L)??0,re=+((O+H)/2).toFixed(0).toLocaleString();return k?{min:k.replace(`{{${L}}}`,O.toLocaleString()??"0"),mid:k.replace(`{{${L}}}`,re.toLocaleString()??"0"),max:k.replace(`{{${L}}}`,H.toLocaleString()??"0")}:{min:"",mid:"",max:""}}),T=xn(()=>{const k=i.selectedIndicator?.style?.max?.color;return k?e.colors[k]:"#000000"}),E=xn(()=>{const k=i.selectedIndicator?.style?.min?.color;return k?e.colors[k]:"#000000"});return(k,L)=>{const O=Lr("v-icon"),H=Lr("v-tooltip");return vi(),Hi("div",{class:U1(["color-legend",{left:k.side==="left",right:k.side==="right"}])},[Ct("div",uH,[Ct("div",hH,[Ct("span",dH,[Vo(Ki(k.selectedIndicator?.title||"Indicator")+" ",1),Vi(H,{style:{display:"inline-block","max-width":"500px"},location:"bottom",text:k.selectedIndicator["tooltip-info"]},{activator:va(({props:re})=>[Vi(O,GI(re,{icon:"mdi-information-outline",size:"18",class:"mx-2"}),null,16)]),_:1},8,["text"])])]),Ct("div",pH,[_.value.min!==""&&_.value.max!==""&&_.value.mid!==""?(vi(),Hi("table",fH,[Ct("tbody",null,[Ct("tr",null,[Ct("td",mH,[Ct("span",{style:hl([{display:"inline-block",width:"8px",height:"8px","border-radius":"50%"},{backgroundColor:T.value}])},null,4)]),Ct("td",gH,[Ct("span",{style:hl([{display:"inline-block",width:"16px",height:"16px","border-radius":"50%"},{backgroundColor:T.value}])},null,4)]),Ct("td",yH,[Ct("span",{style:hl([{display:"inline-block",width:"32px",height:"32px","border-radius":"50%"},{backgroundColor:T.value}])},null,4)])]),Ct("tr",_H,[Ct("td",vH,[Ct("span",bH,Ki(_.value.min??""),1)]),Ct("td",xH,[Ct("span",wH,Ki(_.value.mid.toLocaleString()??""),1)]),Ct("td",SH,[Ct("span",TH,Ki(_.value.max??""),1)])])])])):cn("",!0),d.value?(vi(),Hi("div",{key:1,class:"gradient-bar",style:hl({width:"100%",background:`linear-gradient(to right, ${E.value}, ${T.value})`})},null,4)):cn("",!0),d.value?(vi(),Hi("table",CH,[Ct("tbody",null,[Ct("tr",EH,[Ct("td",IH,[Ct("span",$H,Ki(a.value?.min.toLocaleString()),1)]),Ct("td",PH,[Ct("span",MH,Ki(a.value?.mid.toLocaleString()),1)]),Ct("td",kH,[Ct("span",AH,Ki(a.value?.max.toLocaleString()),1)])])])])):cn("",!0),qI(Ct("div",DH,[L[0]||(L[0]=Vo("Data Source: ",-1)),Ct("a",{href:h.value?.url,target:"_blank"},[Vo(Ki(h.value?.text)+" ",1),Vi(O,{icon:"mdi-open-in-new",size:"12"})],8,zH)],512),[[HI,h.value]])])])],2)}}}),I3=kd(OH,[["__scopeId","data-v-50805e19"]]);async function $3(t){return await fetch(t+"assets/localStyle.json").then(e=>e.json())}function RH(t){return e=>{if(e.includes("arcgisonline.com")||e.includes("arcgis.com"))return{url:e};if(e.startsWith("/"))return{url:t+e};if(t&&typeof window<"u"){const i=window.location.origin;if(e.startsWith(i+"/")&&!e.includes(t)){const r=e.substring(i.length),o=t.endsWith("/")?t.slice(0,-1):t,h=r.startsWith("/")?r:"/"+r;return{url:i+o+h}}}return{url:e}}}const LH={id:"comparison-container"},P3="#comparison-container",FH=Md({__name:"ComparisonMap",props:{_center:{},_zoom:{},_type:{},_orientation:{}},setup(t){const e=Ps();let i=null;const r=Ps();let o=null;const h=t,d=Ps();d.value=window.innerWidth>window.innerHeight?"left-right":"top-bottom";const a=gd("left"),_=gd("right"),T=Ef(),E=Go("mitt");let k=null,L=null,O=null;FT(()=>h._type,ge=>{O&&O.switchType(ge)}),FT(()=>T.currentThemeShortName,async(ge,Se)=>{if(ge&&ge!==Se&&i&&o&&i.loaded()&&o.loaded()){const Pe=T.getAllCurrentThemeIndicators();if(Pe){const Re=Pe.find(Je=>"left".includes(Je.default)),ze=Pe.find(Je=>"right".includes(Je.default));Re&&await a.setIndicatorFromIndicatorShortName(Re.short_name,E),ze&&await _.setIndicatorFromIndicatorShortName(ze.short_name,E)}}});let H=!1;B9(()=>{H=!!(window?.location?.hash&&window.location.hash!=="")}),j1(async()=>{const ge=Go("sitePath"),Se=RH(ge),Pe=await $3(ge),Re=await $3(ge);if(e.value&&(i=new uu.Map({container:e.value,style:Pe,center:h._center,zoom:h._zoom,hash:!0,attributionControl:!1,transformRequest:Se}),a.initializeMap(i,E)),r.value&&(o=new uu.Map({container:r.value,style:Re,center:h._center,zoom:h._zoom,attributionControl:!1,hash:!0,canvasContextAttributes:{antialias:!0},transformRequest:Se}).addControl(new uu.NavigationControl({visualizePitch:!0,visualizeRoll:!0,showZoom:!0,showCompass:!0})).addControl(new uu.AttributionControl({compact:!0}),"top-right"),_.initializeMap(o,E)),i&&o){const ze=d.value==="top-bottom"?["bottom","left"]:["top","horiz-center"];O=new qz(i,o,P3,{orientation:d.value,type:h._type,position:ze});let Je=new uu.LngLatBounds([-81.63527368320112,34.24556219498636],[-78.89220264452729,35.22169720245361]);H||(i.fitBounds(Je,{padding:{top:10,bottom:25,left:15,right:5},animate:!1}),o.fitBounds(Je,{padding:{top:10,bottom:25,left:15,right:5},animate:!1})),O.onceBoth("load",()=>{const Xe=document.getElementById("loading");Xe&&Xe.style&&(Xe.style.display="none"),Array.from(document.getElementsByClassName("maplibregl-ctrl-attrib")).forEach(yt=>{yt.classList.remove("maplibregl-compact-show")})})}E.on("location-selected",re),E.on("location-cleared",pe)});const re=ge=>{const[Se,Pe]=ge.coordinates;i&&(i.flyTo({center:[Se,Pe],zoom:Math.max(i.getZoom(),w3),duration:S3,padding:{top:0,bottom:0,left:0,right:window.innerWidth*T3}}),i.once("moveend",()=>{o?.flyTo({center:[Se,Pe],zoom:Math.max(o.getZoom(),w3),duration:S3,padding:{top:0,bottom:0,left:0,right:window.innerWidth*T3}})})),k&&(k.remove(),k=null),L&&(L.remove(),L=null);const Re=()=>{const ze=document.createElement("div");ze.className="location-marker";const Je=document.createElement("div");return Je.className="pin-icon",Je.innerHTML=`
      <svg width="32" height="40" viewBox="0 0 32 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M16 0C7.163 0 0 7.163 0 16C0 24.837 16 40 16 40C16 40 32 24.837 32 16C32 7.163 24.837 0 16 0Z" fill="#dc2626"/>
        <circle cx="16" cy="16" r="8" fill="white"/>
      </svg>
    `,ze.onclick=Xe=>{Xe.stopPropagation(),pe()},ze.appendChild(Je),ze};if(i){const ze=Re();k=new uu.Marker({element:ze,anchor:"bottom"}).setLngLat([Se,Pe]).addTo(i)}if(o){const ze=Re();L=new uu.Marker({element:ze,anchor:"bottom"}).setLngLat([Se,Pe]).addTo(o)}},pe=()=>{k&&(k.remove(),k=null),L&&(L.remove(),L=null)};return Uz(()=>{E.off("location-selected",re),E.off("location-cleared",pe),pe(),a.removeMap(),_.removeMap(),i&&i.remove(),o&&o.remove(),document.querySelector(P3)?.classList.remove("orientation-left-right","orientation-top-bottom")}),(ge,Se)=>(vi(),Hi("div",LH,[Ct("div",{ref_key:"mapContainerLeft",ref:e,class:"map-container left"},null,512),Vi(C3,{side:"left"}),cs(a).getCurrentIndicator()&&cs(a).getCurrentIndicator()?.geolevel==="area"?(vi(),Iu(E3,{key:0,selectedIndicator:cs(a).getCurrentIndicator(),side:"left"},null,8,["selectedIndicator"])):cs(a).getCurrentIndicator()&&cs(a).getCurrentIndicator()?.geolevel==="point"?(vi(),Iu(I3,{key:1,"selected-indicator":cs(a).getCurrentIndicator(),side:"left"},null,8,["selected-indicator"])):cn("",!0),Ct("div",{ref_key:"mapContainerRight",ref:r,class:"map-container right"},null,512),Vi(C3,{side:"right"}),cs(_).getCurrentIndicator()&&cs(_).getCurrentIndicator()?.geolevel==="area"?(vi(),Iu(E3,{key:2,selectedIndicator:cs(_).getCurrentIndicator(),side:"right"},null,8,["selectedIndicator"])):cs(_).getCurrentIndicator()&&cs(_).getCurrentIndicator()?.geolevel==="point"?(vi(),Iu(I3,{key:3,"selected-indicator":cs(_).getCurrentIndicator(),side:"right"},null,8,["selected-indicator"])):cn("",!0)]))}}),pr=(t,e,...i)=>{try{return t?.call(e,...i)}catch(r){console.error(r,t)}},JT=async(t,e,...i)=>{try{return await t?.call(e,...i)}catch(r){console.error(r,t)}},r$=Symbol.for("controller"),NH=t=>typeof t=="object"&&t!==null&&(r$ in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),BH=t=>typeof t?.then=="function";let dy;const pf=t=>{dy!==t&&(dy=t,queueMicrotask(()=>dy===t?dy=void 0:0))},bm=t=>dy;let Fh=[];const PO=t=>{if(t===void 0){Fh=[];return}const e=Fh.indexOf(t);Fh=e===-1?[...Fh,t]:Fh.slice(0,e+1),queueMicrotask(()=>Fh=[])},MO=()=>Fh;let ff;const jH=t=>{ff!==t&&(ff=t,queueMicrotask(()=>ff===t?ff=void 0:0))},UH=()=>{const t=ff;return ff=void 0,t},VH=async(t,e)=>{const i=n$(t);if(i===void 0)return t;if(await i.ready,typeof e=="function"){const r=i.watchExports(o=>e(o,r))}return i.exports},GH=async t=>{const e=n$(t);return await e.ready,e},n$=t=>{const i=bm().manager.X(t);if(i!==void 0)return i;if(NH(t))return t;const r=UH();if(r!==void 0)return r};let KT=!1;const qH=t=>{KT=!0;try{return t()}finally{KT=!1}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const cb=globalThis,s$=cb.ShadowRoot&&(cb.ShadyCSS===void 0||cb.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,o$=Symbol(),M3=new WeakMap;let kO=class{constructor(e,i,r){if(this._$cssResult$=!0,r!==o$)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=i}get styleSheet(){let e=this.o;const i=this.t;if(s$&&e===void 0){const r=i!==void 0&&i.length===1;r&&(e=M3.get(i)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&M3.set(i,e))}return e}toString(){return this.cssText}};const HH=t=>new kO(typeof t=="string"?t:t+"",void 0,o$),Ui=(t,...e)=>{const i=t.length===1?t[0]:e.reduce(((r,o,h)=>r+(d=>{if(d._$cssResult$===!0)return d.cssText;if(typeof d=="number")return d;throw Error("Value passed to 'css' function must be a 'css' function result: "+d+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+t[h+1]),t[0]);return new kO(i,t,o$)},ZH=(t,e)=>{if(s$)t.adoptedStyleSheets=e.map((i=>i instanceof CSSStyleSheet?i:i.styleSheet));else for(const i of e){const r=document.createElement("style"),o=cb.litNonce;o!==void 0&&r.setAttribute("nonce",o),r.textContent=i.cssText,t.appendChild(r)}},k3=s$?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let i="";for(const r of e.cssRules)i+=r.cssText;return HH(i)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:WH,defineProperty:YH,getOwnPropertyDescriptor:XH,getOwnPropertyNames:JH,getOwnPropertySymbols:KH,getPrototypeOf:QH}=Object,H1=globalThis,A3=H1.trustedTypes,eZ=A3?A3.emptyScript:"",tZ=H1.reactiveElementPolyfillSupport,Oy=(t,e)=>t,QT={toAttribute(t,e){switch(e){case Boolean:t=t?eZ:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=t!==null;break;case Number:i=t===null?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch{i=null}}return i}},a$=(t,e)=>!WH(t,e),D3={attribute:!0,type:String,converter:QT,reflect:!1,useDefault:!1,hasChanged:a$};Symbol.metadata??=Symbol("metadata"),H1.litPropertyMetadata??=new WeakMap;let Qp=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,i=D3){if(i.state&&(i.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((i=Object.create(i)).wrapped=!0),this.elementProperties.set(e,i),!i.noAccessor){const r=Symbol(),o=this.getPropertyDescriptor(e,r,i);o!==void 0&&YH(this.prototype,e,o)}}static getPropertyDescriptor(e,i,r){const{get:o,set:h}=XH(this.prototype,e)??{get(){return this[i]},set(d){this[i]=d}};return{get:o,set(d){const a=o?.call(this);h?.call(this,d),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??D3}static _$Ei(){if(this.hasOwnProperty(Oy("elementProperties")))return;const e=QH(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Oy("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Oy("properties"))){const i=this.properties,r=[...JH(i),...KH(i)];for(const o of r)this.createProperty(o,i[o])}const e=this[Symbol.metadata];if(e!==null){const i=litPropertyMetadata.get(e);if(i!==void 0)for(const[r,o]of i)this.elementProperties.set(r,o)}this._$Eh=new Map;for(const[i,r]of this.elementProperties){const o=this._$Eu(i,r);o!==void 0&&this._$Eh.set(o,i)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const i=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const o of r)i.unshift(k3(o))}else e!==void 0&&i.push(k3(e));return i}static _$Eu(e,i){const r=i.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,i=this.constructor.elementProperties;for(const r of i.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return ZH(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,i,r){this._$AK(e,r)}_$ET(e,i){const r=this.constructor.elementProperties.get(e),o=this.constructor._$Eu(e,r);if(o!==void 0&&r.reflect===!0){const h=(r.converter?.toAttribute!==void 0?r.converter:QT).toAttribute(i,r.type);this._$Em=e,h==null?this.removeAttribute(o):this.setAttribute(o,h),this._$Em=null}}_$AK(e,i){const r=this.constructor,o=r._$Eh.get(e);if(o!==void 0&&this._$Em!==o){const h=r.getPropertyOptions(o),d=typeof h.converter=="function"?{fromAttribute:h.converter}:h.converter?.fromAttribute!==void 0?h.converter:QT;this._$Em=o;const a=d.fromAttribute(i,h.type);this[o]=a??this._$Ej?.get(o)??a,this._$Em=null}}requestUpdate(e,i,r){if(e!==void 0){const o=this.constructor,h=this[e];if(r??=o.getPropertyOptions(e),!((r.hasChanged??a$)(h,i)||r.useDefault&&r.reflect&&h===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,r))))return;this.C(e,i,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,i,{useDefault:r,reflect:o,wrapped:h},d){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,d??i??this[e]),h!==!0||d!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(i=void 0),this._$AL.set(e,i)),o===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(i){Promise.reject(i)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[o,h]of this._$Ep)this[o]=h;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[o,h]of r){const{wrapped:d}=h,a=this[o];d!==!0||this._$AL.has(o)||a===void 0||this.C(o,void 0,h,a)}}let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),this._$EO?.forEach((r=>r.hostUpdate?.())),this.update(i)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(i)}willUpdate(e){}_$AE(e){this._$EO?.forEach((i=>i.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((i=>this._$ET(i,this[i]))),this._$EM()}updated(e){}firstUpdated(e){}};Qp.elementStyles=[],Qp.shadowRootOptions={mode:"open"},Qp[Oy("elementProperties")]=new Map,Qp[Oy("finalized")]=new Map,tZ?.({ReactiveElement:Qp}),(H1.reactiveElementVersions??=[]).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const l$=globalThis,yx=l$.trustedTypes,z3=yx?yx.createPolicy("lit-html",{createHTML:t=>t}):void 0,AO="$lit$",Su=`lit$${Math.random().toFixed(9).slice(2)}$`,DO="?"+Su,iZ=`<${DO}>`,yd=document,c0=()=>yd.createComment(""),u0=t=>t===null||typeof t!="object"&&typeof t!="function",c$=Array.isArray,rZ=t=>c$(t)||typeof t?.[Symbol.iterator]=="function",SS=`[ 	
\f\r]`,Zg=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,O3=/-->/g,R3=/>/g,Mh=RegExp(`>|${SS}(?:([^\\s"'>=/]+)(${SS}*=${SS}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),L3=/'/g,F3=/"/g,zO=/^(?:script|style|textarea|title)$/i,OO=t=>(e,...i)=>({_$litType$:t,strings:e,values:i}),Ne=OO(1),h0=OO(2),lo=Symbol.for("lit-noChange"),ut=Symbol.for("lit-nothing"),N3=new WeakMap,ed=yd.createTreeWalker(yd,129);function RO(t,e){if(!c$(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return z3!==void 0?z3.createHTML(e):e}const nZ=(t,e)=>{const i=t.length-1,r=[];let o,h=e===2?"<svg>":e===3?"<math>":"",d=Zg;for(let a=0;a<i;a++){const _=t[a];let T,E,k=-1,L=0;for(;L<_.length&&(d.lastIndex=L,E=d.exec(_),E!==null);)L=d.lastIndex,d===Zg?E[1]==="!--"?d=O3:E[1]!==void 0?d=R3:E[2]!==void 0?(zO.test(E[2])&&(o=RegExp("</"+E[2],"g")),d=Mh):E[3]!==void 0&&(d=Mh):d===Mh?E[0]===">"?(d=o??Zg,k=-1):E[1]===void 0?k=-2:(k=d.lastIndex-E[2].length,T=E[1],d=E[3]===void 0?Mh:E[3]==='"'?F3:L3):d===F3||d===L3?d=Mh:d===O3||d===R3?d=Zg:(d=Mh,o=void 0);const O=d===Mh&&t[a+1].startsWith("/>")?" ":"";h+=d===Zg?_+iZ:k>=0?(r.push(T),_.slice(0,k)+AO+_.slice(k)+Su+O):_+Su+(k===-2?a:O)}return[RO(t,h+(t[i]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};let eC=class LO{constructor({strings:e,_$litType$:i},r){let o;this.parts=[];let h=0,d=0;const a=e.length-1,_=this.parts,[T,E]=nZ(e,i);if(this.el=LO.createElement(T,r),ed.currentNode=this.el.content,i===2||i===3){const k=this.el.content.firstChild;k.replaceWith(...k.childNodes)}for(;(o=ed.nextNode())!==null&&_.length<a;){if(o.nodeType===1){if(o.hasAttributes())for(const k of o.getAttributeNames())if(k.endsWith(AO)){const L=E[d++],O=o.getAttribute(k).split(Su),H=/([.?@])?(.*)/.exec(L);_.push({type:1,index:h,name:H[2],strings:O,ctor:H[1]==="."?oZ:H[1]==="?"?aZ:H[1]==="@"?lZ:W1}),o.removeAttribute(k)}else k.startsWith(Su)&&(_.push({type:6,index:h}),o.removeAttribute(k));if(zO.test(o.tagName)){const k=o.textContent.split(Su),L=k.length-1;if(L>0){o.textContent=yx?yx.emptyScript:"";for(let O=0;O<L;O++)o.append(k[O],c0()),ed.nextNode(),_.push({type:2,index:++h});o.append(k[L],c0())}}}else if(o.nodeType===8)if(o.data===DO)_.push({type:2,index:h});else{let k=-1;for(;(k=o.data.indexOf(Su,k+1))!==-1;)_.push({type:7,index:h}),k+=Su.length-1}h++}}static createElement(e,i){const r=yd.createElement("template");return r.innerHTML=e,r}};function Qf(t,e,i=t,r){if(e===lo)return e;let o=r!==void 0?i._$Co?.[r]:i._$Cl;const h=u0(e)?void 0:e._$litDirective$;return o?.constructor!==h&&(o?._$AO?.(!1),h===void 0?o=void 0:(o=new h(t),o._$AT(t,i,r)),r!==void 0?(i._$Co??=[])[r]=o:i._$Cl=o),o!==void 0&&(e=Qf(t,o._$AS(t,e.values),o,r)),e}let sZ=class{constructor(e,i){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:i},parts:r}=this._$AD,o=(e?.creationScope??yd).importNode(i,!0);ed.currentNode=o;let h=ed.nextNode(),d=0,a=0,_=r[0];for(;_!==void 0;){if(d===_.index){let T;_.type===2?T=new Z1(h,h.nextSibling,this,e):_.type===1?T=new _.ctor(h,_.name,_.strings,this,e):_.type===6&&(T=new cZ(h,this,e)),this._$AV.push(T),_=r[++a]}d!==_?.index&&(h=ed.nextNode(),d++)}return ed.currentNode=yd,o}p(e){let i=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,i),i+=r.strings.length-2):r._$AI(e[i])),i++}},Z1=class FO{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,i,r,o){this.type=2,this._$AH=ut,this._$AN=void 0,this._$AA=e,this._$AB=i,this._$AM=r,this.options=o,this._$Cv=o?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const i=this._$AM;return i!==void 0&&e?.nodeType===11&&(e=i.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,i=this){e=Qf(this,e,i),u0(e)?e===ut||e==null||e===""?(this._$AH!==ut&&this._$AR(),this._$AH=ut):e!==this._$AH&&e!==lo&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):rZ(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==ut&&u0(this._$AH)?this._$AA.nextSibling.data=e:this.T(yd.createTextNode(e)),this._$AH=e}$(e){const{values:i,_$litType$:r}=e,o=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=eC.createElement(RO(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===o)this._$AH.p(i);else{const h=new sZ(o,this),d=h.u(this.options);h.p(i),this.T(d),this._$AH=h}}_$AC(e){let i=N3.get(e.strings);return i===void 0&&N3.set(e.strings,i=new eC(e)),i}k(e){c$(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let r,o=0;for(const h of e)o===i.length?i.push(r=new FO(this.O(c0()),this.O(c0()),this,this.options)):r=i[o],r._$AI(h),o++;o<i.length&&(this._$AR(r&&r._$AB.nextSibling,o),i.length=o)}_$AR(e=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},W1=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,i,r,o,h){this.type=1,this._$AH=ut,this._$AN=void 0,this.element=e,this.name=i,this._$AM=o,this.options=h,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=ut}_$AI(e,i=this,r,o){const h=this.strings;let d=!1;if(h===void 0)e=Qf(this,e,i,0),d=!u0(e)||e!==this._$AH&&e!==lo,d&&(this._$AH=e);else{const a=e;let _,T;for(e=h[0],_=0;_<h.length-1;_++)T=Qf(this,a[r+_],i,_),T===lo&&(T=this._$AH[_]),d||=!u0(T)||T!==this._$AH[_],T===ut?e=ut:e!==ut&&(e+=(T??"")+h[_+1]),this._$AH[_]=T}d&&!o&&this.j(e)}j(e){e===ut?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},oZ=class extends W1{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===ut?void 0:e}},aZ=class extends W1{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==ut)}},lZ=class extends W1{constructor(e,i,r,o,h){super(e,i,r,o,h),this.type=5}_$AI(e,i=this){if((e=Qf(this,e,i,0)??ut)===lo)return;const r=this._$AH,o=e===ut&&r!==ut||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,h=e!==ut&&(r===ut||o);o&&this.element.removeEventListener(this.name,this,r),h&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},cZ=class{constructor(e,i,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=i,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Qf(this,e)}};const uZ={I:Z1},hZ=l$.litHtmlPolyfillSupport;hZ?.(eC,Z1),(l$.litHtmlVersions??=[]).push("3.3.1");const NO=(t,e,i)=>{const r=i?.renderBefore??e;let o=r._$litPart$;if(o===void 0){const h=i?.renderBefore??null;r._$litPart$=o=new Z1(e.insertBefore(c0(),h),h,void 0,i??{})}return o._$AI(t),o};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const u$=globalThis;let $f=class extends Qp{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const i=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=NO(i,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return lo}};$f._$litElement$=!0,$f.finalized=!0,u$.litElementHydrateSupport?.({LitElement:$f});const dZ=u$.litElementPolyfillSupport;dZ?.({LitElement:$f});(u$.litElementVersions??=[]).push("4.2.1");class d0{constructor(){this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}}const pZ=(t,e)=>{const i=e/fZ;let r=0;const o=setInterval(()=>{r+=i,r>=e&&(clearInterval(o),t())},i);return o},fZ=4,mZ=(t,e,i)=>{const r=Object.keys(t),o=r.length;mf===void 0&&queueMicrotask(Y1),mf??=new Map;let h=mf.get(t);return h===void 0&&(h={callbacks:[],keyCount:o},mf.set(t,h)),h.keyCount!==o&&(h.callbacks.forEach(d=>d(r)),h.callbacks=[],h.keyCount=o),h.callbacks.push(d=>{const a=T=>pr(e,null,T),_=d[o];_===void 0?a(void 0):t[_]===i?a(_):a(void 0)}),i};let mf;const Y1=()=>{mf?.forEach(({callbacks:t},e)=>{const i=Object.keys(e);t.forEach(r=>r(i))}),mf=void 0},BO=(t,e,i)=>{const r=t.manager;return r.V!==ut&&r.V!==i&&r.S(void 0,void 0),r.T.length===0&&queueMicrotask(()=>r.S(void 0,void 0)),r.V=i,r.T.push((o,h)=>pr(e,void 0,i===h?o:void 0)),i},h$=(t=[bm(),...MO()],e,i)=>{const r=Array.isArray(t)?t:[t];let o=r.length+1;const h=d=>{o-=1,d!==void 0&&(o=Math.min(o,0)),o===0&&e(d)};r.forEach(d=>mZ(d,a=>h(a===void 0?void 0:{key:a,host:d,isReactive:!1}),i));for(const d of r)if("manager"in d&&d.manager.component===d){BO(d,a=>h(a===void 0?void 0:{key:a,host:d,isReactive:!0}),i);break}return i},d$=(t="",e={},i=bm())=>{const r={emit:o=>{t===""&&Y1();const h=new CustomEvent(t,{detail:o,cancelable:!0,bubbles:!0,composed:!0,...e});return i.el.dispatchEvent(h),h}};return t===""&&h$(void 0,o=>t=o.key,r),r},vt=d$.bind(null,"");var jO;jO=r$;class p${constructor(e){this.#e=[],this.#t=[],this.#i=[],this.#l=[],this.#c=[],this.#u=[],this.#h=[],this.#d=[],this.#o=[],this.#a=!1,this.P=new d0,this.connectedCalled=!1,this.loadedCalled=!1,this[jO]=!0,this.#s=[];const i=this,r=e??bm();i.#r=r,i.ready=i.P.promise,i.#n=j3(i),i.component=r,i.#r.addController(i),i.#r.manager===void 0||(PO(i),queueMicrotask(()=>i.catchUpLifecycle()))}#e;#t;#i;#l;#c;#u;#h;#d;#o;#a;#r;catchUpLifecycle(){const{manager:e}=this.#r;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#n;get exports(){return this.#n}set exports(e){const i=this.#n;i!==e&&(this.#n=e,this.#s.forEach(pr),this.connectedCalled&&this.O!==!1&&this.#r.requestUpdate(this.O,i)),this.P.resolve(e)}setProvisionalExports(e,i=!0){this.#n=i?j3(e):e,this.#s.forEach(pr)}#s;watchExports(e){const i=()=>e(this.#n);return this.#s.push(i),()=>void this.#s.splice(this.#s.indexOf(i),1)}get use(){return pf(this.#r),VH}get useRef(){return pf(this.#r),GH}get useRefSync(){return pf(this.#r),n$}controllerRemoved(){this.#r.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#e.push(e)}onDisconnected(e){this.#t.push(e)}onLoad(e){this.#i.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#c.push(e)}onUpdated(e){this.#u.push(e)}onDestroy(e){this.#h.push(e)}onLifecycle(e){this.#d.push(e),this.connectedCalled&&this.#r.el.isConnected&&this.#p(e)}triggerConnected(){const e=this;e.hostConnected&&pr(e.hostConnected,e),e.#e.forEach(pr),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&pr(e.hostDisconnected,e),e.#t.forEach(pr),e.#o.forEach(pr),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await JT(e.hostLoad,e),this.#i.length>0&&await Promise.allSettled(this.#i.map(JT)),this.P.resolve(this.#n)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&pr(this.hostLoaded,this),this.#l.forEach(pr),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&pr(this.hostUpdate,this,e),this.#c.forEach(B3,e)}triggerUpdated(e){this.hostUpdated&&pr(this.hostUpdated,this,e),this.#u.forEach(B3,e)}triggerDestroy(){this.hostDestroy&&pr(this.hostDestroy,this),this.#h.forEach(pr)}triggerLifecycle(){this.hostLifecycle&&this.#p(()=>this.hostLifecycle()),this.#d.forEach(this.#p,this)}#p(e){pf(this.#r);const i=pr(e);(Array.isArray(i)?i:[i]).forEach(o=>{typeof o=="function"?this.#o.push(o):typeof o=="object"&&typeof o.remove=="function"&&this.#o.push(o.remove)})}}function B3(t){pr(t,void 0,this)}const f$=p$,j3=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(r,o,h){if(!((o==="exports"||o==="_exports")&&o in r&&r[o]===i)&&(o in r||o in Promise.prototype||typeof o=="symbol"))return typeof r=="function"?r[o]:Reflect.get(r,o,h)}},i=new Proxy(t,e);return i},gZ=t=>t.replace(yZ,(e,i)=>`${i===0?"":"-"}${e.toLowerCase()}`),yZ=/[A-Z]+(?![a-z])|[A-Z]/gu,_Z=1,vZ=2,bZ=4,xZ=8,wZ=16,SZ=32,TZ=64,UO=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const i=e;return i.manager?.loadedCalled||(i.J??i._offspring).push(t),(i.I??i._postLoad).promise}return!1},U3={};function VO(){}const ub=Object.defineProperty,CZ=globalThis.HTMLElement??VO;var ws,hc,Ff,U0,tC;const oM=class oM extends CZ{constructor(){var o;super();ra(this,U0);ra(this,ws);ra(this,hc);ra(this,Ff);na(this,hc,{}),na(this,Ff,[]),this.I=new d0,this.H=new d0,this.J=[];const i=this,r=i.constructor;i._offspring=i.J,i._postLoad=i.I,r.C?.forEach(h=>{Object.hasOwn(i,h)&&(Mi(i,hc)[h]=i[h],delete i[h])}),r.A?qg(o=i,U0,tC).call(o,{a:r.A}):r.B.then(async h=>{var d;await r.K.p,qg(d=i,U0,tC).call(d,await(h.default?.then(a=>typeof a=="function"?{a}:a)??h))}).catch(h=>{i.H.reject(h),setTimeout(()=>{throw h})})}static F(){for(const i of this.C??[])ub(this.prototype,i,{configurable:!0,enumerable:!0,get(){return Mi(this,hc)[i]},set(r){Mi(this,hc)[i]=r}});for(const i of this.E??[])ub(this.prototype,i,{async value(...r){return Mi(this,ws)||await this.H.promise,await Mi(this,ws)[i](...r)},configurable:!0});for(const i of this.D??[])ub(this.prototype,i,{value(...r){return Mi(this,ws)[i](...r)},configurable:!0})}get manager(){return Mi(this,ws)?.manager}attributeChangedCallback(i,r,o){Mi(this,ws)?.attributeChangedCallback(i,r,o),Mi(this,ws)||Mi(this,Ff).push(i)}connectedCallback(){Mi(this,ws)?Mi(this,ws).connectedCallback?.():queueMicrotask(()=>this.G=UO(this))}disconnectedCallback(){Mi(this,ws)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){Mi(this,ws)?.requestUpdate()}};ws=new WeakMap,hc=new WeakMap,Ff=new WeakMap,U0=new WeakSet,tC=function(i){const r=this.constructor,o=r.L,h=Mi(this,hc),d=Object.values(i).find(L=>L.L===o),a=`${o}--lazy`;let _=d;for(;_&&!Object.hasOwn(_,"lumina");)_=Object.getPrototypeOf(_);IZ(_),!r.A&&(r.A=d,customElements.define(a,d)),d.N=this;const E=document.createElement(a);d.N=void 0,na(this,ws,E),na(this,hc,E),Mi(this,Ff).forEach(L=>E.attributeChangedCallback(L,null,this.getAttribute(L))),Object.entries(h).forEach(EZ,E);const k=this.isConnected;(k||this.G)&&(E.connectedCallback?.(),k||E.disconnectedCallback())},oM.lumina=!0;let V3=oM;function EZ([t,e]){this[t]=e}const IZ=t=>{const e=t.prototype,i=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(o,h){i.setAttribute.call(this.el,o,h)},e.removeAttribute=function(o){i.removeAttribute.call(this.el,o)},ub(e,"isConnected",{get(){return Reflect.get(i,"isConnected",this.el)}}))};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ol={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},xm=t=>(...e)=>({_$litDirective$:t,values:e});let wm=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,i,r){this._$Ct=e,this._$AM=i,this._$Ci=r}_$AS(e,i){return this.update(e,i)}update(e,i){return this.render(...i)}};/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const $Z=xm(class extends wm{constructor(t){if(super(t),t.type!==ol.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((r=>r!==""))));for(const r in e)e[r]&&!this.nt?.has(r)&&this.st.add(r);return this.render(e)}const i=t.element.classList;for(const r of this.st)r in e||(i.remove(r),this.st.delete(r));for(const r in e){const o=!!e[r];o===this.st.has(r)||this.nt?.has(r)||(o?(i.add(r),this.st.add(r)):(i.remove(r),this.st.delete(r)))}return lo}});/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const GO="important",PZ=" !"+GO,MZ=xm(class extends wm{constructor(t){if(super(t),t.type!==ol.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce(((e,i)=>{const r=t[i];return r==null?e:e+`${i=i.includes("-")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`}),"")}update(t,[e]){const{style:i}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const r of this.ft)e[r]==null&&(this.ft.delete(r),r.includes("-")?i.removeProperty(r):i[r]=null);for(const r in e){const o=e[r];if(o!=null){this.ft.add(r);const h=typeof o=="string"&&o.endsWith(PZ);r.includes("-")||h?i.setProperty(r,h?o.slice(0,-11):o,h?GO:""):i[r]=o}}return lo}});/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{I:kZ}=uZ,qO=t=>t.strings===void 0,G3=()=>document.createComment(""),Wg=(t,e,i)=>{const r=t._$AA.parentNode,o=e===void 0?t._$AB:e._$AA;if(i===void 0){const h=r.insertBefore(G3(),o),d=r.insertBefore(G3(),o);i=new kZ(h,d,t,t.options)}else{const h=i._$AB.nextSibling,d=i._$AM,a=d!==t;if(a){let _;i._$AQ?.(t),i._$AM=t,i._$AP!==void 0&&(_=t._$AU)!==d._$AU&&i._$AP(_)}if(h!==o||a){let _=i._$AA;for(;_!==h;){const T=_.nextSibling;r.insertBefore(_,o),_=T}}}return i},kh=(t,e,i=t)=>(t._$AI(e,i),t),AZ={},m$=(t,e=AZ)=>t._$AH=e,DZ=t=>t._$AH,TS=t=>{t._$AR(),t._$AA.remove()};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const q3=xm(class extends wm{constructor(t){if(super(t),t.type!==ol.PROPERTY&&t.type!==ol.ATTRIBUTE&&t.type!==ol.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!qO(t))throw Error("`live` bindings can only contain a single expression")}render(t){return t}update(t,[e]){if(e===lo||e===ut)return e;const i=t.element,r=t.name;if(t.type===ol.PROPERTY){if(e===i[r])return lo}else if(t.type===ol.BOOLEAN_ATTRIBUTE){if(!!e===i.hasAttribute(r))return lo}else if(t.type===ol.ATTRIBUTE&&i.getAttribute(r)===e+"")return lo;return m$(t),e}});/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ry=(t,e)=>{const i=t._$AN;if(i===void 0)return!1;for(const r of i)r._$AO?.(e,!1),Ry(r,e);return!0},_x=t=>{let e,i;do{if((e=t._$AM)===void 0)break;i=e._$AN,i.delete(t),t=e}while(i?.size===0)},HO=t=>{for(let e;e=t._$AM;t=e){let i=e._$AN;if(i===void 0)e._$AN=i=new Set;else if(i.has(t))break;i.add(t),RZ(e)}};function zZ(t){this._$AN!==void 0?(_x(this),this._$AM=t,HO(this)):this._$AM=t}function OZ(t,e=!1,i=0){const r=this._$AH,o=this._$AN;if(o!==void 0&&o.size!==0)if(e)if(Array.isArray(r))for(let h=i;h<r.length;h++)Ry(r[h],!1),_x(r[h]);else r!=null&&(Ry(r,!1),_x(r));else Ry(this,t)}const RZ=t=>{t.type==ol.CHILD&&(t._$AP??=OZ,t._$AQ??=zZ)};let LZ=class extends wm{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,i,r){super._$AT(e,i,r),HO(this),this.isConnected=e._$AU}_$AO(e,i=!0){e!==this.isConnected&&(this.isConnected=e,e?this.reconnected?.():this.disconnected?.()),i&&(Ry(this,e),_x(this))}setValue(e){if(qO(this._$Ct))this._$Ct._$AI(e,this);else{const i=[...this._$Ct._$AH];i[this._$Ci]=e,this._$Ct._$AI(i,this,0)}}disconnected(){}reconnected(){}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Yn=()=>new FZ;let FZ=class{};const CS=new WeakMap,hi=xm(class extends LZ{render(t){return ut}update(t,[e]){const i=e!==this.G;return i&&this.G!==void 0&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.G=e,this.ht=t.options?.host,this.rt(this.ct=t.element)),ut}rt(t){if(this.isConnected||(t=void 0),typeof this.G=="function"){const e=this.ht??globalThis;let i=CS.get(e);i===void 0&&(i=new WeakMap,CS.set(e,i)),i.get(this.G)!==void 0&&this.G.call(this.ht,void 0),i.set(this.G,t),t!==void 0&&this.G.call(this.ht,t)}else this.G.value=t}get lt(){return typeof this.G=="function"?CS.get(this.ht??globalThis)?.get(this.G):this.G?.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});class NZ extends f${constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=ut,this.T=[],this.#i=new WeakMap,this.#t=e,this.exports=void 0,this.hasDestroy=iC in e&&typeof e.destroy=="function",$f.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const i=e.el.localName;throw e.el.remove(),new Error(`The ${i} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${iC} prop.`)}this.#e!==void 0&&clearTimeout(this.#e),Y1();for(const i of e.M)"triggerConnected"in i?i.triggerConnected():pr(i.hostConnected,i)},hostDisconnected:()=>{for(const i of e.M)"triggerDisconnected"in i?i.triggerDisconnected():pr(i.hostDisconnected,i);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const i of e.M)"triggerUpdate"in i?i.triggerUpdate(this.Q):pr(i.hostUpdate,i,this.Q)},hostUpdated:()=>{for(const i of e.M)"triggerUpdated"in i?i.triggerUpdated(this.Q):pr(i.hostUpdated,i,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),pf(e)}#e;#t;async destroy(){if(!this.destroyed){this.#t.el.isConnected&&(this.hasDestroy=!1,this.#t.el.remove()),this.#e=void 0,this.destroyed=!0;for(const e of this.#t.M)"triggerDestroy"in e?e.triggerDestroy():pr(e.hostDestroy,e);this.#t.M.splice(0)}}U(){if(this.#e!==void 0&&clearTimeout(this.#e),!this.#t.el.isConnected&&!this.#t.autoDestroyDisabled){const e=()=>void this.#t.destroy();this.#e=pZ(e,BZ)}}S(e,i){const r=this.T;this.V=ut,this.T=[],r.forEach(o=>o(e,i))}#i;W(e,i){(typeof i=="object"&&i!==null||typeof i=="function")&&this.#i.set(i,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#i.get(e)}}let BZ=1e3;const iC="autoDestroyDisabled";var nd,V0,G0,sd,sl,vm,ZO,WO;const i0=class i0 extends $f{constructor(){super();ra(this,vm);ra(this,nd);ra(this,V0);ra(this,G0);ra(this,sd);ra(this,sl);this.M=[],this.manager=new NZ(this);const i=this,r=i.constructor,o=r.N,h=r.K.o,d=i0.prototype.shouldUpdate;na(i,sd,o?.H??new d0),i.I=o?.I??new d0,i.J=o?.J??[],i._offspring=i.J,i._postLoad=i.I,i.el=o??i,na(i,G0,i.enableUpdating),i.enableUpdating=VO,i.shouldUpdate!==d&&(na(i,V0,i.shouldUpdate),i.shouldUpdate=d),h&&(na(i,nd,new Map),r.elementProperties.forEach((a,_)=>Mi(i,nd).set(_,h())))}static finalizeStyles(i){const r=super.finalizeStyles(i),o=this.shadowRootOptions===U3;return this.K?.commonStyles===void 0||o?r:[this.K.commonStyles,...r]}static createProperty(i,r){const o=typeof r=="number"?r:Array.isArray(r)?r[0]:0,h=Array.isArray(r)?r[1]:void 0,d=h?.hasChanged??a$,a={attribute:o&_Z&&typeof i=="string"?gZ(i):!1,reflect:!!(o&vZ),type:o&bZ?Boolean:o&xZ?Number:void 0,state:!!(o&wZ),readOnly:!!(o&SZ),noAccessor:!!(o&TZ),c:!1,...h,hasChanged(_,T){const E=d(_,T);return a.c=E,E}};super.createProperty(i,a)}static getPropertyDescriptor(i,r,o){const h=this.K,d=super.getPropertyDescriptor(i,r,o);return o.d=d,{...d,get(){return h.t?.(Mi(this,nd).get(i)),d.get?.call(this)},set(a){const _=this.manager;if(o.readOnly&&!KT&&(_.R||_.connectedCalled))throw Error(`Cannot assign to read-only property "${i}" of ${this.el.localName}. Trying to assign "${a}"`);d.set.call(this,a??void 0),o.c&&Mi(this,nd)?.get(i)?.notify(),_.T.length>0&&(Y1(),_?.S(i,a))}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const i=this.constructor.K.c?.(()=>this.requestUpdate());na(this,sl,i);const r=!this.manager.connectedCalled;super.connectedCallback(),r?queueMicrotask(()=>qg(this,vm,WO).call(this).catch(o=>{Mi(this,sd).reject(o),setTimeout(()=>{throw o})})):i&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),Mi(this,sl)?.destroy(),na(this,sl,void 0)}createRenderRoot(){const i=this.el.shadowRoot,r=this.constructor,o=r.shadowRootOptions,d=i??(o===U3?this.el:this.el.attachShadow(o));if(this.isConnected){const a=d.getRootNode();a.adoptedStyleSheets=[...a.adoptedStyleSheets,...r.elementStyles.map(_=>"styleSheet"in _?_.styleSheet:_)]}return d}shouldUpdate(i){var r;return this.manager.Q=i,((r=Mi(this,V0))==null?void 0:r.call(this,i))??!0}update(i){Mi(this,sl)?qg(this,vm,ZO).call(this,i):super.update(i)}listen(i,r,o){const h=r?.bind(this)??r;this.manager.onLifecycle(()=>(this.el.addEventListener(i,h,o),()=>this.el.removeEventListener(i,h,o)))}listenOn(i,r,o,h){const d=o?.bind(this)??o;this.manager.onLifecycle(()=>(i.addEventListener(r,d,h),()=>i.removeEventListener(r,d,h)))}async componentOnReady(){return await Mi(this,sd).promise,this}addController(i){this.M.push(i),!(r$ in i)&&this.renderRoot&&this.el.isConnected&&i.hostConnected?.()}removeController(i){this.M.splice(this.M.indexOf(i),1),i.controllerRemoved?.()}};nd=new WeakMap,V0=new WeakMap,G0=new WeakMap,sd=new WeakMap,sl=new WeakMap,vm=new WeakSet,ZO=function(i){try{Mi(this,sl).clear(),this.constructor.K.r(Mi(this,sl),()=>Uk(i0.prototype,this,"update").call(this,i))}catch(r){throw Mi(this,sl).clear(),r}},WO=async function(){const i=this.el.G??UO(this.el);i&&await i;const r=[];for(const h of this.M)"triggerLoad"in h?r.push(h.triggerLoad()):r.push(JT(h.hostLoad,h));await Promise.all(r),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(h=>h.has(iC)&&this.manager.U()),Mi(this,G0).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const o=this.J.filter(h=>!h.manager?.loadedCalled);o.length&&await Promise.allSettled(o.map(async h=>await h.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const h of this.M)"triggerLoaded"in h?h.triggerLoaded():pr(h.hostLoaded,h);this.loaded?.(),Mi(this,sd).resolve()},i0.lumina=!0;let ji=i0;const YO=t=>{let e;const i=o=>{e=new URL(o,globalThis.location?.href||void 0).href},r={...t,getAssetPath(o){const h=new URL(o,e);return h.origin!==globalThis.location?.origin?h.href:h.pathname},setAssetPath:i,customElement(o,h){h.K=r,h.L=o,customElements.get(o)||customElements.define(o,h)}};return i(t.defaultAssetPath),r},Fe=t=>typeof t=="object"&&t!=null?$Z(t):t,XO=t=>typeof t=="object"&&t!=null?MZ(t):t,Ou=ut;function X1(t,e,i){i==null?t.removeAttribute(e):t.setAttribute(e,i)}const _d={toAttribute:t=>t===!0?"":t===!1?null:t},jZ=t=>{const e=document.createElement("div");return NO(t,e),e.firstElementChild},UZ="calcite-mode-auto",VZ="calcite-mode-dark",JO={rtl:"calcite--rtl"},g$={filter:250,nextTick:0,reposition:100},_pe=25;function H3(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains(VZ)||t.contains(UZ)&&e?"dark":"light",r=d=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:d}})),o=d=>{h!==d&&r(d),h=d};let h=i();r(h),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",d=>o(d.matches?"dark":"light")),new MutationObserver(()=>o(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const Ly=globalThis.calciteConfig,GZ=Ly?.focusTrapStack||[],qZ=Ly?.logLevel||"info",Z3="3.3.3",HZ="2025-10-08",ZZ="7391af08e";function WZ(){if(Ly&&Ly.version)return;console.info(`Using Calcite Components ${Z3} [Date: ${HZ}, Revision: ${ZZ}]`);const t=Ly||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:Z3,writable:!1}),globalThis.calciteConfig=t}document.readyState==="interactive"?H3():document.addEventListener("DOMContentLoaded",H3,{once:!0});queueMicrotask(WZ);const YZ=YO({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.3.3/",hydratedAttribute:"calcite-hydrated"}),{customElement:ar,getAssetPath:KO,setAssetPath:vpe}=YZ;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function XZ(t){return t.map(e=>{let i="";for(let r=0;r<e;r++)i+=((1+Math.random())*65536|0).toString(16).substring(1);return i}).join("-")}const Hu=()=>XZ([2,1,1,1,3]),QO=t=>(...e)=>{const i=MO(),r=new t(...e),o=r.exports;PO(i.at(-1));const h=r.component.manager;h.W(r,o),r.watchExports(h.W.bind(h,r)),jH(r);const d=[r.component,...i].reverse();return h$(d,a=>a===void 0?void 0:JZ(r,a,o),o)},JZ=(t,{host:e,key:i,isReactive:r},o)=>{const h=e,d=h[i]!==t.exports,a=h[i]!==o,_=o!==t.exports;if(d&&!a&&_&&(h[i]=t.exports),e===t.component){if(r){const k=t.component.manager;a&&k.W(t,h[i]),t.onUpdate(L=>{if(L.has(i)){const O=h[i];O!==t.exports&&k.W(t,O)}})}t.O=r?void 0:i}const E=t.component.constructor.elementProperties.get(i)?.readOnly;t.watchExports(()=>{h[i]!==t.exports&&(E?qH(()=>{h[i]=t.exports}):h[i]=t.exports)})},eR=(...t)=>{const e=[];for(let r=0;r<t.length;r++){const o=t[r];if(typeof o=="string")e.push(o);else if(Array.isArray(o))e.push.apply(e,o);else if(typeof o=="object")for(const h in o)o[h]&&e.push(h)}const i=e.join(" ");return e.length=0,i},KZ=(t,e)=>{let i=t;for(;i;){if(i===e)return!0;if(!i.parentNode)return!1;i.parentNode instanceof ShadowRoot?i=i.parentNode.host:i=i.parentNode}return!1},QZ=(t,e,i)=>{const r=eW(e).subscribe;return r(o=>{o.some(d=>KZ(t,d.target))&&i()})},ES={},eW=t=>{const e=t.join(","),i=ES[e];if(i!==void 0)return i;const r=new Set,o=new MutationObserver(d=>r.forEach(a=>a(d)));globalThis.document&&o.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const h={subscribe:d=>(r.add(d),()=>{r.delete(d),r.size===0&&(o.disconnect(),ES[e]=void 0)})};return ES[e]=h,h},tR=(t,e)=>{let i=t;for(;i;){const r=i.closest?.(e);if(r)return r;const o=i.getRootNode?.();if(o===globalThis.document)return;i=o.host}};function bpe(t){const e=tR(t,".calcite-mode-dark, .calcite-mode-light, .calcite-mode-auto");return e?.classList.contains("calcite-mode-dark")||e?.classList.contains("calcite-mode-auto")&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const tW=(t,e,i)=>tR(t,`[${e}]`)?.getAttribute(e)??i,iW="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),rW=new Set(iW),vx="en",nW={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},sW=async(t,e,i="")=>{const r=`${e}/${i}`,o=`${r}${t}.json`;return IS[o]??(IS[o]=iR(t,r)),await IS[o]},IS={},iR=async(t,e)=>{const i=`${e}${t}.json`;try{const r=await fetch(i);if(r.ok)return await r.json()}catch(r){return console.error(r),{}}return t===vx?{}:await iR(vx,e)},rR=t=>{const e=tW(t,"lang",globalThis.navigator?.language||vx);return{lang:e,t9nLocale:nR(e)}},nR=t=>{const[e,i]=t.split("-"),r=e.toLowerCase();let o=r;return i&&(o=`${r}-${i.toUpperCase()}`),o=nW[o]??o,rW.has(o)?o:i?nR(r):vx},oW=(t,e,i,r)=>{let o;const h=()=>aW(t,e(),r).then(d=>{(o?.lang!==d.lang||o.t9nLocale!==d.t9nLocale||o.t9nStrings!==d.t9nStrings)&&i(d),o=d}).catch(console.error);return queueMicrotask(h),QZ(t,["lang"],h)},aW=async(t,e,i=t.localName.split("-").slice(1).join("-"))=>{const{lang:r,t9nLocale:o}=rR(t),h=`${e}/${i}/t9n`,a=i===null?{}:await sW(o,h,"messages.");return{lang:r,t9nLocale:o,t9nStrings:a}},lW=t=>sR(void 0,t),y$=t=>e=>sR(e,t);class cW extends p${constructor(e,i){super(e);const r=this.exports;try{pf(this.component);const o=i(this.component,this),h=this.exports!==r;if(BH(o)){h||this.setProvisionalExports(o);const d=o.then(a=>{this.exports=a,super.catchUpLifecycle()}).catch(a=>{this.P.reject(a),console.error(a)});this.onLoad(async()=>await d)}else(!h||o!==void 0)&&(this.exports=o),queueMicrotask(()=>super.catchUpLifecycle())}catch(o){this.P.reject(o),console.error(o)}}catchUpLifecycle(){}}const sR=QO(cW),_$=(t,e)=>new uW(t,e);class uW extends p${#e;#t;#i;constructor(e,i){super(),this.#t=e,this.#i=i,this.#e=new MutationObserver(r=>{r.forEach(o=>{e.includes(o.attributeName)&&i.call(this.component,this.component.el.getAttribute(o.attributeName),o.oldValue,o.attributeName)})})}hostConnected(){this.#t.forEach(e=>{this.component.el.hasAttribute(e)&&this.#i.call(this.component,null,this.component.el.getAttribute(e),e)}),this.#e.observe(this.component.el,{attributes:!0,attributeOldValue:!0,attributeFilter:this.#t})}hostDisconnected(){this.#e.disconnect()}}const oR=t=>(e={})=>lW((i,r)=>{const o=rR(i.el),h={_lang:o.lang,_t9nLocale:o.t9nLocale,_loading:!0},d=i;r.onLifecycle(()=>oW(i.el,()=>t("./assets"),({t9nLocale:_,t9nStrings:T,lang:E})=>{const k={...T,_lang:E,_t9nLocale:_,_loading:!1};r.exports=k;const L=T.componentLabel;typeof L=="string"&&"label"in i&&i.label==null&&(i.label??=L),a(d.messageOverrides)},e.name));const a=_=>{const T=r.exports,E=T._original??T,k=aR(E,_);_&&(k._original=E),r.exports=k};return"messageOverrides"in d&&r.onUpdate(_=>{_.has("messageOverrides")&&a(d.messageOverrides)}),e.blocking?(r.setProvisionalExports(h,!1),r.ready):h}),aR=(t,e)=>{if(!e)return t;const i={...t};return Object.entries(e).forEach(([r,o])=>{typeof o=="object"?i[r]=aR(t[r],o):i[r]=o??t[r]}),i},hW=t=>pW,dW="arcgisPropertyChange",pW=(...t)=>{const e=bm(),i=d$(dW,void 0,e);let r=!0;return e.manager.onUpdated(o=>{if(r||!e.el.isConnected){r=!1;return}for(const h of t)o.has(h)&&i.emit({name:h})}),i};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const fo=oR(KO);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Lp={percentage:"percentage",progressRing:"ring--progress",ring:"ring",rings:"rings",text:"text",trackRing:"ring--track"},fW=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{position:relative;margin-inline:auto;display:flex;align-items:center;justify-content:center;opacity:1;flex-direction:column;min-block-size:var(--calcite-loader-size);font-size:var(--calcite-loader-font-size);stroke-width:var(--calcite-internal-stroke-width);fill:none;transform:scale(1);padding-block:var(--calcite-loader-spacing, 4rem)}:host([scale=s]){--calcite-internal-stroke-width: 3;--calcite-internal-text-offset: var(--calcite-spacing-xxs);--calcite-internal-loader-font-size: var(--calcite-font-size--3);--calcite-internal-loader-size: 2rem;--calcite-internal-loader-size-inline: .75rem;--calcite-internal-loader-value-line-height: .625rem}:host([scale=m]){--calcite-internal-stroke-width: 6;--calcite-internal-text-offset: var(--calcite-spacing-sm);--calcite-internal-loader-font-size: var(--calcite-font-size-0);--calcite-internal-loader-size: 4rem;--calcite-internal-loader-size-inline: 1rem;--calcite-internal-loader-value-line-height: 1.375rem}:host([scale=l]){--calcite-internal-stroke-width: 8;--calcite-internal-text-offset: var(--calcite-spacing-md);--calcite-internal-loader-font-size: var(--calcite-font-size-2);--calcite-internal-loader-size: 6rem;--calcite-internal-loader-size-inline: 1.5rem;--calcite-internal-loader-value-line-height: 1.71875rem}.text{display:block;text-align:center;font-size:var(--calcite-font-size--2);line-height:1rem;margin-block-start:var(--calcite-loader-text-spacing, var(--calcite-internal-text-offset));font-weight:var(--calcite-loader-text-weight, var(--calcite-font-weight-normal));color:var(--calcite-loader-text-color, var(--calcite-color-text-1))}.percentage{display:block;text-align:center;font-size:var(--calcite-loader-font-size);inline-size:var(--calcite-loader-size, var(--calcite-internal-loader-size));line-height:var(--calcite-internal-loader-value-line-height);align-self:center;color:var(--calcite-loader-text-color, var(--calcite-color-text-1))}.rings{position:relative;display:flex;overflow:visible;opacity:1;inline-size:var(--calcite-loader-size, var(--calcite-internal-loader-size));block-size:var(--calcite-loader-size, var(--calcite-internal-loader-size))}.ring{position:absolute;inset-block-start:0px;transform-origin:center;overflow:visible;inset-inline-start:0;inline-size:var(--calcite-loader-size, var(--calcite-internal-loader-size));block-size:var(--calcite-loader-size, var(--calcite-internal-loader-size))}.ring--track{stroke:var(--calcite-loader-track-color, var(--calcite-color-transparent-press))}.ring--progress{stroke:var(--calcite-loader-progress-color, var(--calcite-color-brand));transform:rotate(-90deg);transition:all var(--calcite-internal-animation-timing-fast) linear}:host([type=indeterminate]) .ring--progress{animation:loader-clockwise calc(var(--calcite-internal-animation-timing-slow) / var(--calcite-internal-duration-factor) * 2 / var(--calcite-internal-duration-factor)) linear infinite}:host([inline]){--calcite-internal-stroke-width: 2;position:relative;margin:0;stroke:currentColor;stroke-width:2;padding-block:0px;block-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));min-block-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));inline-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));vertical-align:calc(var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline))) * -1 * .2)}:host([inline]) .rings{inset-block-start:0px;margin:0;inset-inline-start:0;inline-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));block-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)))}:host([inline]) .ring{inline-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));block-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)))}:host([inline]) .ring--progress{stroke:var(--calcite-loader-progress-color-inline, currentColor)}:host([complete]){opacity:0;transform:scale(.75);transform-origin:center;transition:opacity var(--calcite-internal-animation-timing-medium) linear 1s,transform var(--calcite-internal-animation-timing-medium) linear 1s}:host([complete]) .rings{opacity:0;transform:scale(.75);transform-origin:center;transition:opacity calc(.18s * var(--calcite-internal-duration-factor)) linear .8s,transform calc(.18s * var(--calcite-internal-duration-factor)) linear .8s}:host([complete]) .percentage{color:var(--calcite-color-brand);transform:scale(1.05);transform-origin:center;transition:color var(--calcite-internal-animation-timing-medium) linear,transform var(--calcite-internal-animation-timing-medium) linear}@keyframes loader-clockwise{0%{transform:rotate(0)}to{transform:rotate(360deg)}}:host([hidden]){display:none}[hidden]{display:none}`,v1=class v1 extends ji{constructor(){super(...arguments),this.messages=fo({name:null}),this.complete=!1,this.inline=!1,this.scale="m",this.text="",this.type="indeterminate",this.value=0}connectedCallback(){super.connectedCallback(),this.updateFormatter()}load(){requestAnimationFrame(()=>this.valueChangeHandler())}willUpdate(e){e.has("value")&&(this.hasUpdated||this.value!==0)&&this.valueChangeHandler(),(e.has("type")&&(this.hasUpdated||this.type!=="indeterminate")||e.has("messages"))&&this.updateFormatter()}valueChangeHandler(){this.complete=this.type.startsWith("determinate")&&this.value===100}formatValue(){return this.type!=="determinate-value"?`${this.value}`:this.formatter.format(this.value/100)}getSize(e){return{s:32,m:64,l:96}[e]}getInlineSize(e){return{s:12,m:16,l:24}[e]}updateFormatter(){this.type!=="determinate-value"||this.formatter?.resolvedOptions().locale===this.messages._lang||(this.formatter=new Intl.NumberFormat(this.messages._lang,{style:"percent"}))}render(){const{el:e,inline:i,label:r,text:o,type:h,value:d}=this,a=e.id||Hu(),_=h!=="indeterminate",T=Math.floor(d);return this.el.ariaLabel=r,this.el.ariaValueMax=_?"100":void 0,this.el.ariaValueMin=_?"0":void 0,this.el.ariaValueNow=_?T.toString():void 0,X1(this.el,"id",a),this.el.role="progressbar",Ne`<div class=${Fe(Lp.rings)}>${this.renderRing("track")}${this.renderRing("progress")}${!i&&_&&Ne`<div class=${Fe(Lp.percentage)}>${this.formatValue()}</div>`||""}</div>${!i&&o&&Ne`<div class=${Fe(Lp.text)}>${o}</div>`||""}`}renderRing(e){const{inline:i,scale:r,value:o}=this,h=i?this.getInlineSize(r):this.getSize(r),a=h*.45;let _;if(e==="progress"){const T=2*a*Math.PI,E=(this.type.startsWith("determinate")?o:24)/100*T,k=T-E;_={"stroke-dasharray":`${E} ${k}`}}return Ne`<svg aria-hidden=true class=${Fe({[Lp.ring]:!0,[Lp.trackRing]:e==="track",[Lp.progressRing]:e==="progress"})} style=${XO(_)} viewBox=${`0 0 ${h} ${h}`}>${h0`<circle cx=${h/2} cy=${h/2} r=${a??ut} />`}</svg>`}};v1.properties={complete:[7,{},{reflect:!0,type:Boolean}],inline:[7,{},{reflect:!0,type:Boolean}],label:1,scale:[3,{},{reflect:!0}],text:1,type:[3,{},{reflect:!0}],value:[9,{},{type:Number}]},v1.styles=fW;let rC=v1;ar("calcite-loader",rC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function qo(t,e,i){const r=mW(t);return new r(e,i)}function mW(t){class e extends window.MutationObserver{constructor(r){super(r),this.observedEntry=[],this.callback=r}observe(r,o){return this.observedEntry.push({target:r,options:o}),super.observe(r,o)}unobserve(r){const o=this.observedEntry.filter(h=>h.target!==r);this.observedEntry=[],this.callback(super.takeRecords(),this),this.disconnect(),o.forEach(h=>this.observe(h.target,h.options))}}return(function(){return t==="intersection"?window.IntersectionObserver:t==="mutation"?e:window.ResizeObserver})()}function bx(t,e,i,r){if(t&&(e&&t.unobserve(e),!!i)){if(t instanceof MutationObserver){t.observe(i,r);return}t.observe(i)}}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 *//*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var gW=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],nC=gW.join(","),lR=typeof Element>"u",p0=lR?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,xx=!lR&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t?.ownerDocument},wx=function t(e,i){var r;i===void 0&&(i=!0);var o=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"inert"),h=o===""||o==="true",d=h||i&&e&&t(e.parentNode);return d},yW=function(e){var i,r=e==null||(i=e.getAttribute)===null||i===void 0?void 0:i.call(e,"contenteditable");return r===""||r==="true"},cR=function(e,i,r){if(wx(e))return[];var o=Array.prototype.slice.apply(e.querySelectorAll(nC));return i&&p0.call(e,nC)&&o.unshift(e),o=o.filter(r),o},uR=function t(e,i,r){for(var o=[],h=Array.from(e);h.length;){var d=h.shift();if(!wx(d,!1))if(d.tagName==="SLOT"){var a=d.assignedElements(),_=a.length?a:d.children,T=t(_,!0,r);r.flatten?o.push.apply(o,T):o.push({scopeParent:d,candidates:T})}else{var E=p0.call(d,nC);E&&r.filter(d)&&(i||!e.includes(d))&&o.push(d);var k=d.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(d),L=!wx(k,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(d));if(k&&L){var O=t(k===!0?d.children:k.children,!0,r);r.flatten?o.push.apply(o,O):o.push({scopeParent:d,candidates:O})}else h.unshift.apply(h,d.children)}}return o},hR=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},dR=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||yW(e))&&!hR(e)?0:e.tabIndex},_W=function(e,i){var r=dR(e);return r<0&&i&&!hR(e)?0:r},vW=function(e,i){return e.tabIndex===i.tabIndex?e.documentOrder-i.documentOrder:e.tabIndex-i.tabIndex},pR=function(e){return e.tagName==="INPUT"},bW=function(e){return pR(e)&&e.type==="hidden"},xW=function(e){var i=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(r){return r.tagName==="SUMMARY"});return i},wW=function(e,i){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===i)return e[r]},SW=function(e){if(!e.name)return!0;var i=e.form||xx(e),r=function(a){return i.querySelectorAll('input[type="radio"][name="'+a+'"]')},o;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")o=r(window.CSS.escape(e.name));else try{o=r(e.name)}catch(d){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",d.message),!1}var h=wW(o,e.form);return!h||h===e},TW=function(e){return pR(e)&&e.type==="radio"},CW=function(e){return TW(e)&&!SW(e)},EW=function(e){var i,r=e&&xx(e),o=(i=r)===null||i===void 0?void 0:i.host,h=!1;if(r&&r!==e){var d,a,_;for(h=!!((d=o)!==null&&d!==void 0&&(a=d.ownerDocument)!==null&&a!==void 0&&a.contains(o)||e!=null&&(_=e.ownerDocument)!==null&&_!==void 0&&_.contains(e));!h&&o;){var T,E,k;r=xx(o),o=(T=r)===null||T===void 0?void 0:T.host,h=!!((E=o)!==null&&E!==void 0&&(k=E.ownerDocument)!==null&&k!==void 0&&k.contains(o))}}return h},W3=function(e){var i=e.getBoundingClientRect(),r=i.width,o=i.height;return r===0&&o===0},IW=function(e,i){var r=i.displayCheck,o=i.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var h=p0.call(e,"details>summary:first-of-type"),d=h?e.parentElement:e;if(p0.call(d,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="legacy-full"){if(typeof o=="function"){for(var a=e;e;){var _=e.parentElement,T=xx(e);if(_&&!_.shadowRoot&&o(_)===!0)return W3(e);e.assignedSlot?e=e.assignedSlot:!_&&T!==e.ownerDocument?e=T.host:e=_}e=a}if(EW(e))return!e.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return W3(e);return!1},$W=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var i=e.parentElement;i;){if(i.tagName==="FIELDSET"&&i.disabled){for(var r=0;r<i.children.length;r++){var o=i.children.item(r);if(o.tagName==="LEGEND")return p0.call(i,"fieldset[disabled] *")?!0:!o.contains(e)}return!0}i=i.parentElement}return!1},sC=function(e,i){return!(i.disabled||wx(i)||bW(i)||IW(i,e)||xW(i)||$W(i))},Y3=function(e,i){return!(CW(i)||dR(i)<0||!sC(e,i))},PW=function(e){var i=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(i)||i>=0)},MW=function t(e){var i=[],r=[];return e.forEach(function(o,h){var d=!!o.scopeParent,a=d?o.scopeParent:o,_=_W(a,d),T=d?t(o.candidates):a;_===0?d?i.push.apply(i,T):i.push(a):r.push({documentOrder:h,tabIndex:_,item:o,isScope:d,content:T})}),r.sort(vW).reduce(function(o,h){return h.isScope?o.push.apply(o,h.content):o.push(h.content),o},[]).concat(i)},kW=function(e,i){i=i||{};var r;return i.getShadowRoot?r=uR([e],i.includeContainer,{filter:Y3.bind(null,i),flatten:!1,getShadowRoot:i.getShadowRoot,shadowRootFilter:PW}):r=cR(e,i.includeContainer,Y3.bind(null,i)),MW(r)},AW=function(e,i){i=i||{};var r;return i.getShadowRoot?r=uR([e],i.includeContainer,{filter:sC.bind(null,i),flatten:!0,getShadowRoot:i.getShadowRoot}):r=cR(e,i.includeContainer,sC.bind(null,i)),r};const v$={getShadowRoot:!0};function Z0(t){const r=Sm(t,"[dir]");return r?r.getAttribute("dir"):"ltr"}function J1(t){return t.getRootNode()}function fR(t){return t.host||null}function K1(t,{selector:e,id:i}){if(!t)return null;t.assignedSlot&&(t=t.assignedSlot);const r=J1(t);return(i?"getElementById"in r?r.getElementById(i):null:e?r.querySelector(e):null)||K1(fR(r),{selector:e,id:i})}function Sm(t,e){return t?t.closest(e)||Sm(fR(J1(t)),e):null}function DW(t){return typeof t?.setFocus=="function"}async function f0(t,e=!1,i="tabbable",r,o){return t?DW(t)&&r!==t?t.setFocus(o):(i==="tabbable"?zW:RW)(t,e,o):void 0}function mR(t,e){if(t)return kW(t,{...v$,includeContainer:e})[0]??t}function zW(t,e,i){mR(t,e)?.focus(i)}function OW(t,e){if(t)return AW(t,{...v$,includeContainer:e})[0]??t}function RW(t,e,i){OW(t,e)?.focus(i)}function LW(t,e){return t.filter(i=>i.matches(e))}function em(t,e,i){if(typeof e=="string"&&e!=="")return e;if(e===""||e===!0)return t[i]}function Q1(t){return(!!t).toString()}function FW(t){return Cr(t)||jW(t)}function NW(t){return UW(t).filter(e=>e.nodeType===Node.TEXT_NODE).map(e=>e.textContent).join("").trim()}function BW(t){for(const e of t.childNodes)if(e.nodeType===Node.TEXT_NODE&&e.textContent?.trim()!==""||e.nodeType===Node.ELEMENT_NODE)return!0;return!1}function jW(t){return!!NW(t)}function UW(t){return t.currentTarget.assignedNodes({flatten:!0})}function Cr(t){return!!gR(t).length}function gR(t,e){return VW(t.currentTarget,e)}function VW(t,e){const i=t.assignedElements({flatten:!0});return e?LW(i,e):i}function yR(t){return!!(t.isPrimary&&t.button===0)}function GW(t){return t.detail===0}const Mv=(t,e,i,r=!0,o=!0,h=!1)=>{const d=t.indexOf(e),a=d===0,_=d===t.length-1;r&&(i=i==="previous"&&a?"last":i==="next"&&_?"first":i);let T;return i==="previous"?T=t[d-1]||t[r?t.length-1:d]:i==="next"?T=t[d+1]||t[r?0:d]:i==="last"?T=t[t.length-1]:T=t[0],f0(T,o,"tabbable",h?T:void 0),T};function qW(t,e){if(t.parentNode!==e.parentNode)return!1;const i=Array.from(t.parentNode.children);return i.indexOf(t)<i.indexOf(e)}async function HW(t,e){return ZW(t,e,"transition")}function X3(t,e,i){const r="transitionProperty";return t.getAnimations().find(o=>o[r]===i)}async function ZW(t,e,i){let r=X3(t,i,e);if(r||(await oC(),r=X3(t,i,e)),!!r)try{await r.finished}catch{}}async function oC(){await new Promise(t=>requestAnimationFrame(()=>t()))}function xpe(t){return t.endsWith("px")?parseFloat(t):t.endsWith("vw")?J3(parseFloat(t),window.innerWidth):t.endsWith("vh")?J3(parseFloat(t),window.innerHeight):0}function J3(t,e){return t*e/100}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const K3={scrim:"scrim",content:"content"},Q3={s:72,l:480},WW=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{position:absolute;inset:0;z-index:var(--calcite-z-index-overlay);display:flex;block-size:100%;inline-size:100%;flex-direction:column;align-items:stretch}@keyframes calcite-scrim-fade-in{0%{--tw-bg-opacity: 0}to{--tw-text-opacity: 1}}.scrim{position:absolute;inset:0;display:flex;flex-direction:column;align-content:center;align-items:center;justify-content:center;overflow:hidden;animation:calcite-scrim-fade-in var(--calcite-internal-animation-timing-medium) ease-in-out;background-color:var(--calcite-scrim-background, var(--calcite-color-transparent-scrim))}.content{padding:1rem}:host([hidden]){display:none}[hidden]{display:none}`,b1=class b1 extends ji{constructor(){super(...arguments),this.loaderRef=Yn(),this.resizeObserver=qo("resize",()=>this.handleResize()),this.messages=fo(),this.hasContent=!1,this.loading=!1}connectedCallback(){super.connectedCallback(),this.resizeObserver?.observe(this.el)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver?.disconnect()}handleDefaultSlotChange(e){this.hasContent=FW(e)}getScale(e){return e<Q3.s?"s":e>=Q3.l?"l":"m"}handleResize(){const{el:e}=this;this.loaderScale=this.getScale(Math.min(e.clientHeight,e.clientWidth)??0)}render(){const{hasContent:e,loading:i,loaderScale:r,messages:o}=this;return Ne`<div class=${Fe(K3.scrim)}>${i&&r?Ne`<calcite-loader .label=${o.loading} .scale=${r} ${hi(this.loaderRef)}></calcite-loader>`:null}<div class=${Fe(K3.content)} .hidden=${!e}><slot @slotchange=${this.handleDefaultSlotChange}></slot></div></div>`}};b1.properties={hasContent:[16,{},{state:!0}],loaderScale:[16,{},{state:!0}],loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}]},b1.styles=WW;let aC=b1;ar("calcite-scrim",aC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const eA=new Set,tA={trace:0,debug:1,info:2,warn:4,error:8,off:10};function YW(t){return tA[t]>=tA[qZ]}function ef(t,...e){if(!YW(t))return;console[t].call(this,"%ccalcite","background: #007AC2; color: #fff; border-radius: 4px; padding: 2px 4px;",...e)}let $S;const Sx={debug:t=>ef("debug",t),info:t=>ef("info",t),warn:t=>ef("warn",t),error:t=>ef("error",t),trace:t=>ef("trace",t),deprecated:XW};function XW(t,{component:e,name:i,suggested:r,removalVersion:o}){const h=`${t}:${t==="component"?"":e}${i}`;if(eA.has(h))return;eA.add(h);const d=Array.isArray(r);d&&!$S&&($S=new Intl.ListFormat("en",{style:"long",type:"disjunction"}));const a=`[${i}] ${t} is deprecated and will be removed in ${o==="future"?"a future version":`v${o}`}.${r?` Use ${d?$S.format(r.map(_=>`"${_}"`)):`"${r}"`} instead.`:""}`;ef("warn",a)}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const iA={flipRtl:"flip-rtl",svg:"svg"},_R={},PS={},vR={s:16,m:24,l:32};function bR({icon:t,scale:e}){const i=vR[e],r=QW(t),o=r.charAt(r.length-1)==="F";return`${o?r.substring(0,r.length-1):r}${i}${o?"F":""}`}async function JW(t){const e=bR(t),i=xR(e);if(i)return i;PS[e]||(PS[e]=fetch(KO(`./assets/icon/${e}.json`)).then(o=>o.json()).catch(()=>(Sx.error(`${t.icon} (${t.scale}) icon failed to load`),"")));const r=await PS[e];return _R[e]=r,r}function KW(t){return xR(bR(t))}function xR(t){return _R[t]}function QW(t){const e=!isNaN(Number(t.charAt(0))),i=t.split("-");if(i.length>0){const o=/[a-z]/i;t=i.map((h,d)=>h.replace(o,function(_,T){return d===0&&T===0?_:_.toUpperCase()})).join("")}return e?`i${t}`:t}const eY=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{display:inline-flex;color:var(--calcite-icon-color, var(--calcite-ui-icon-color, currentColor))}:host([scale=s]){inline-size:16px;block-size:16px;min-inline-size:16px;min-block-size:16px}:host([scale=m]){inline-size:24px;block-size:24px;min-inline-size:24px;min-block-size:24px}:host([scale=l]){inline-size:32px;block-size:32px;min-inline-size:32px;min-block-size:32px}.flip-rtl{transform:scaleX(-1)}.svg{display:block}:host([hidden]){display:none}[hidden]{display:none}`,x1=class x1 extends ji{constructor(){super(...arguments),this.visible=!1,this.flipRtl=!1,this.icon=null,this.preload=!1,this.scale="m"}connectedCallback(){if(super.connectedCallback(),this.preload){this.visible=!0,this.loadIconPathData();return}this.visible||this.waitUntilVisible(()=>{this.visible=!0,this.loadIconPathData()})}willUpdate(e){(e.has("icon")&&(this.hasUpdated||this.icon!==null)||e.has("scale")&&(this.hasUpdated||this.scale!=="m"))&&this.loadIconPathData()}disconnectedCallback(){super.disconnectedCallback(),this.intersectionObserver?.disconnect(),this.intersectionObserver=null}async loadIconPathData(){const{icon:e,scale:i,visible:r}=this;if(!e||!r)return;const o={icon:e,scale:i},h=KW(o)||await JW(o);e===this.icon&&(this.pathData=h)}waitUntilVisible(e){if(this.intersectionObserver=qo("intersection",i=>{i.forEach(r=>{r.isIntersecting&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,e())})},{rootMargin:"50px"}),!this.intersectionObserver){e();return}this.intersectionObserver.observe(this.el)}render(){const{el:e,flipRtl:i,pathData:r,scale:o,textLabel:h}=this,d=Z0(e),a=vR[o],_=!!h,T=[].concat(r||"");return this.el.ariaHidden=Q1(!_),this.el.ariaLabel=_?h:null,this.el.role=_?"img":null,Ne`<svg aria-hidden=true class=${Fe({[iA.flipRtl]:d==="rtl"&&i,[iA.svg]:!0})} fill=currentColor height=100% viewBox=${`0 0 ${a} ${a}`} width=100% xmlns=http://www.w3.org/2000/svg>${T.map(E=>typeof E=="string"?h0`<path d=${E??ut} />`:h0`<path d=${E.d??ut} opacity=${("opacity"in E?E.opacity:1)??ut} />`)}</svg>`}};x1.properties={pathData:[16,{},{state:!0}],visible:[16,{},{state:!0}],flipRtl:[7,{},{reflect:!0,type:Boolean}],icon:[3,{},{reflect:!0}],preload:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],textLabel:1},x1.styles=eY;let lC=x1;ar("calcite-icon",lC);const wR=["top","right","bottom","left"],rA=["start","end"],nA=wR.reduce((t,e)=>t.concat(e,e+"-"+rA[0],e+"-"+rA[1]),[]),tm=Math.min,ad=Math.max,Tx=Math.round,kv=Math.floor,pl=t=>({x:t,y:t}),tY={left:"right",right:"left",bottom:"top",top:"bottom"},iY={start:"end",end:"start"};function cC(t,e,i){return ad(t,tm(e,i))}function Ad(t,e){return typeof t=="function"?t(e):t}function gc(t){return t.split("-")[0]}function fl(t){return t.split("-")[1]}function SR(t){return t==="x"?"y":"x"}function b$(t){return t==="y"?"height":"width"}const rY=new Set(["top","bottom"]);function $u(t){return rY.has(gc(t))?"y":"x"}function x$(t){return SR($u(t))}function TR(t,e,i){i===void 0&&(i=!1);const r=fl(t),o=x$(t),h=b$(o);let d=o==="x"?r===(i?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[h]>e.floating[h]&&(d=Ex(d)),[d,Ex(d)]}function nY(t){const e=Ex(t);return[Cx(t),e,Cx(e)]}function Cx(t){return t.replace(/start|end/g,e=>iY[e])}const sA=["left","right"],oA=["right","left"],sY=["top","bottom"],oY=["bottom","top"];function aY(t,e,i){switch(t){case"top":case"bottom":return i?e?oA:sA:e?sA:oA;case"left":case"right":return e?sY:oY;default:return[]}}function lY(t,e,i,r){const o=fl(t);let h=aY(gc(t),i==="start",r);return o&&(h=h.map(d=>d+"-"+o),e&&(h=h.concat(h.map(Cx)))),h}function Ex(t){return t.replace(/left|right|bottom|top/g,e=>tY[e])}function cY(t){return{top:0,right:0,bottom:0,left:0,...t}}function CR(t){return typeof t!="number"?cY(t):{top:t,right:t,bottom:t,left:t}}function Ix(t){const{x:e,y:i,width:r,height:o}=t;return{width:r,height:o,top:i,left:e,right:e+r,bottom:i+o,x:e,y:i}}function aA(t,e,i){let{reference:r,floating:o}=t;const h=$u(e),d=x$(e),a=b$(d),_=gc(e),T=h==="y",E=r.x+r.width/2-o.width/2,k=r.y+r.height/2-o.height/2,L=r[a]/2-o[a]/2;let O;switch(_){case"top":O={x:E,y:r.y-o.height};break;case"bottom":O={x:E,y:r.y+r.height};break;case"right":O={x:r.x+r.width,y:k};break;case"left":O={x:r.x-o.width,y:k};break;default:O={x:r.x,y:r.y}}switch(fl(e)){case"start":O[d]-=L*(i&&T?-1:1);break;case"end":O[d]+=L*(i&&T?-1:1);break}return O}const uY=async(t,e,i)=>{const{placement:r="bottom",strategy:o="absolute",middleware:h=[],platform:d}=i,a=h.filter(Boolean),_=await(d.isRTL==null?void 0:d.isRTL(e));let T=await d.getElementRects({reference:t,floating:e,strategy:o}),{x:E,y:k}=aA(T,r,_),L=r,O={},H=0;for(let re=0;re<a.length;re++){const{name:pe,fn:ge}=a[re],{x:Se,y:Pe,data:Re,reset:ze}=await ge({x:E,y:k,initialPlacement:r,placement:L,strategy:o,middlewareData:O,rects:T,platform:d,elements:{reference:t,floating:e}});E=Se??E,k=Pe??k,O={...O,[pe]:{...O[pe],...Re}},ze&&H<=50&&(H++,typeof ze=="object"&&(ze.placement&&(L=ze.placement),ze.rects&&(T=ze.rects===!0?await d.getElementRects({reference:t,floating:e,strategy:o}):ze.rects),{x:E,y:k}=aA(T,L,_)),re=-1)}return{x:E,y:k,placement:L,strategy:o,middlewareData:O}};async function m0(t,e){var i;e===void 0&&(e={});const{x:r,y:o,platform:h,rects:d,elements:a,strategy:_}=t,{boundary:T="clippingAncestors",rootBoundary:E="viewport",elementContext:k="floating",altBoundary:L=!1,padding:O=0}=Ad(e,t),H=CR(O),pe=a[L?k==="floating"?"reference":"floating":k],ge=Ix(await h.getClippingRect({element:(i=await(h.isElement==null?void 0:h.isElement(pe)))==null||i?pe:pe.contextElement||await(h.getDocumentElement==null?void 0:h.getDocumentElement(a.floating)),boundary:T,rootBoundary:E,strategy:_})),Se=k==="floating"?{x:r,y:o,width:d.floating.width,height:d.floating.height}:d.reference,Pe=await(h.getOffsetParent==null?void 0:h.getOffsetParent(a.floating)),Re=await(h.isElement==null?void 0:h.isElement(Pe))?await(h.getScale==null?void 0:h.getScale(Pe))||{x:1,y:1}:{x:1,y:1},ze=Ix(h.convertOffsetParentRelativeRectToViewportRelativeRect?await h.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:Se,offsetParent:Pe,strategy:_}):Se);return{top:(ge.top-ze.top+H.top)/Re.y,bottom:(ze.bottom-ge.bottom+H.bottom)/Re.y,left:(ge.left-ze.left+H.left)/Re.x,right:(ze.right-ge.right+H.right)/Re.x}}const hY=t=>({name:"arrow",options:t,async fn(e){const{x:i,y:r,placement:o,rects:h,platform:d,elements:a,middlewareData:_}=e,{element:T,padding:E=0}=Ad(t,e)||{};if(T==null)return{};const k=CR(E),L={x:i,y:r},O=x$(o),H=b$(O),re=await d.getDimensions(T),pe=O==="y",ge=pe?"top":"left",Se=pe?"bottom":"right",Pe=pe?"clientHeight":"clientWidth",Re=h.reference[H]+h.reference[O]-L[O]-h.floating[H],ze=L[O]-h.reference[O],Je=await(d.getOffsetParent==null?void 0:d.getOffsetParent(T));let Xe=Je?Je[Pe]:0;(!Xe||!await(d.isElement==null?void 0:d.isElement(Je)))&&(Xe=a.floating[Pe]||h.floating[H]);const yt=Re/2-ze/2,mt=Xe/2-re[H]/2-1,je=tm(k[ge],mt),ke=tm(k[Se],mt),We=je,Ce=Xe-re[H]-ke,Ee=Xe/2-re[H]/2+yt,st=cC(We,Ee,Ce),_t=!_.arrow&&fl(o)!=null&&Ee!==st&&h.reference[H]/2-(Ee<We?je:ke)-re[H]/2<0,ht=_t?Ee<We?Ee-We:Ee-Ce:0;return{[O]:L[O]+ht,data:{[O]:st,centerOffset:Ee-st-ht,..._t&&{alignmentOffset:ht}},reset:_t}}});function dY(t,e,i){return(t?[...i.filter(o=>fl(o)===t),...i.filter(o=>fl(o)!==t)]:i.filter(o=>gc(o)===o)).filter(o=>t?fl(o)===t||(e?Cx(o)!==o:!1):!0)}const pY=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var i,r,o;const{rects:h,middlewareData:d,placement:a,platform:_,elements:T}=e,{crossAxis:E=!1,alignment:k,allowedPlacements:L=nA,autoAlignment:O=!0,...H}=Ad(t,e),re=k!==void 0||L===nA?dY(k||null,O,L):L,pe=await m0(e,H),ge=((i=d.autoPlacement)==null?void 0:i.index)||0,Se=re[ge];if(Se==null)return{};const Pe=TR(Se,h,await(_.isRTL==null?void 0:_.isRTL(T.floating)));if(a!==Se)return{reset:{placement:re[0]}};const Re=[pe[gc(Se)],pe[Pe[0]],pe[Pe[1]]],ze=[...((r=d.autoPlacement)==null?void 0:r.overflows)||[],{placement:Se,overflows:Re}],Je=re[ge+1];if(Je)return{data:{index:ge+1,overflows:ze},reset:{placement:Je}};const Xe=ze.map(je=>{const ke=fl(je.placement);return[je.placement,ke&&E?je.overflows.slice(0,2).reduce((We,Ce)=>We+Ce,0):je.overflows[0],je.overflows]}).sort((je,ke)=>je[1]-ke[1]),mt=((o=Xe.filter(je=>je[2].slice(0,fl(je[0])?2:3).every(ke=>ke<=0))[0])==null?void 0:o[0])||Xe[0][0];return mt!==a?{data:{index:ge+1,overflows:ze},reset:{placement:mt}}:{}}}},fY=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var i,r;const{placement:o,middlewareData:h,rects:d,initialPlacement:a,platform:_,elements:T}=e,{mainAxis:E=!0,crossAxis:k=!0,fallbackPlacements:L,fallbackStrategy:O="bestFit",fallbackAxisSideDirection:H="none",flipAlignment:re=!0,...pe}=Ad(t,e);if((i=h.arrow)!=null&&i.alignmentOffset)return{};const ge=gc(o),Se=$u(a),Pe=gc(a)===a,Re=await(_.isRTL==null?void 0:_.isRTL(T.floating)),ze=L||(Pe||!re?[Ex(a)]:nY(a)),Je=H!=="none";!L&&Je&&ze.push(...lY(a,re,H,Re));const Xe=[a,...ze],yt=await m0(e,pe),mt=[];let je=((r=h.flip)==null?void 0:r.overflows)||[];if(E&&mt.push(yt[ge]),k){const Ee=TR(o,d,Re);mt.push(yt[Ee[0]],yt[Ee[1]])}if(je=[...je,{placement:o,overflows:mt}],!mt.every(Ee=>Ee<=0)){var ke,We;const Ee=(((ke=h.flip)==null?void 0:ke.index)||0)+1,st=Xe[Ee];if(st&&(!(k==="alignment"?Se!==$u(st):!1)||je.every(nt=>$u(nt.placement)===Se?nt.overflows[0]>0:!0)))return{data:{index:Ee,overflows:je},reset:{placement:st}};let _t=(We=je.filter(ht=>ht.overflows[0]<=0).sort((ht,nt)=>ht.overflows[1]-nt.overflows[1])[0])==null?void 0:We.placement;if(!_t)switch(O){case"bestFit":{var Ce;const ht=(Ce=je.filter(nt=>{if(Je){const rt=$u(nt.placement);return rt===Se||rt==="y"}return!0}).map(nt=>[nt.placement,nt.overflows.filter(rt=>rt>0).reduce((rt,Wt)=>rt+Wt,0)]).sort((nt,rt)=>nt[1]-rt[1])[0])==null?void 0:Ce[0];ht&&(_t=ht);break}case"initialPlacement":_t=a;break}if(o!==_t)return{reset:{placement:_t}}}return{}}}};function lA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function cA(t){return wR.some(e=>t[e]>=0)}const mY=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:i}=e,{strategy:r="referenceHidden",...o}=Ad(t,e);switch(r){case"referenceHidden":{const h=await m0(e,{...o,elementContext:"reference"}),d=lA(h,i.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:cA(d)}}}case"escaped":{const h=await m0(e,{...o,altBoundary:!0}),d=lA(h,i.floating);return{data:{escapedOffsets:d,escaped:cA(d)}}}default:return{}}}}},gY=new Set(["left","top"]);async function yY(t,e){const{placement:i,platform:r,elements:o}=t,h=await(r.isRTL==null?void 0:r.isRTL(o.floating)),d=gc(i),a=fl(i),_=$u(i)==="y",T=gY.has(d)?-1:1,E=h&&_?-1:1,k=Ad(e,t);let{mainAxis:L,crossAxis:O,alignmentAxis:H}=typeof k=="number"?{mainAxis:k,crossAxis:0,alignmentAxis:null}:{mainAxis:k.mainAxis||0,crossAxis:k.crossAxis||0,alignmentAxis:k.alignmentAxis};return a&&typeof H=="number"&&(O=a==="end"?H*-1:H),_?{x:O*E,y:L*T}:{x:L*T,y:O*E}}const _Y=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var i,r;const{x:o,y:h,placement:d,middlewareData:a}=e,_=await yY(e,t);return d===((i=a.offset)==null?void 0:i.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:o+_.x,y:h+_.y,data:{..._,placement:d}}}}},vY=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:i,y:r,placement:o}=e,{mainAxis:h=!0,crossAxis:d=!1,limiter:a={fn:pe=>{let{x:ge,y:Se}=pe;return{x:ge,y:Se}}},..._}=Ad(t,e),T={x:i,y:r},E=await m0(e,_),k=$u(gc(o)),L=SR(k);let O=T[L],H=T[k];if(h){const pe=L==="y"?"top":"left",ge=L==="y"?"bottom":"right",Se=O+E[pe],Pe=O-E[ge];O=cC(Se,O,Pe)}if(d){const pe=k==="y"?"top":"left",ge=k==="y"?"bottom":"right",Se=H+E[pe],Pe=H-E[ge];H=cC(Se,H,Pe)}const re=a.fn({...e,[L]:O,[k]:H});return{...re,data:{x:re.x-i,y:re.y-r,enabled:{[L]:h,[k]:d}}}}}};function ew(){return typeof window<"u"}function Tm(t){return ER(t)?(t.nodeName||"").toLowerCase():"#document"}function uo(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function wl(t){var e;return(e=(ER(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function ER(t){return ew()?t instanceof Node||t instanceof uo(t).Node:!1}function Ca(t){return ew()?t instanceof Element||t instanceof uo(t).Element:!1}function gl(t){return ew()?t instanceof HTMLElement||t instanceof uo(t).HTMLElement:!1}function uA(t){return!ew()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof uo(t).ShadowRoot}const bY=new Set(["inline","contents"]);function W0(t){const{overflow:e,overflowX:i,overflowY:r,display:o}=Ea(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+i)&&!bY.has(o)}const xY=new Set(["table","td","th"]);function wY(t){return xY.has(Tm(t))}const SY=[":popover-open",":modal"];function tw(t){return SY.some(e=>{try{return t.matches(e)}catch{return!1}})}const TY=["transform","translate","scale","rotate","perspective"],CY=["transform","translate","scale","rotate","perspective","filter"],EY=["paint","layout","strict","content"];function iw(t){const e=w$(),i=Ca(t)?Ea(t):t;return TY.some(r=>i[r]?i[r]!=="none":!1)||(i.containerType?i.containerType!=="normal":!1)||!e&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!e&&(i.filter?i.filter!=="none":!1)||CY.some(r=>(i.willChange||"").includes(r))||EY.some(r=>(i.contain||"").includes(r))}function IY(t){let e=ju(t);for(;gl(e)&&!im(e);){if(iw(e))return e;if(tw(e))return null;e=ju(e)}return null}function w$(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const $Y=new Set(["html","body","#document"]);function im(t){return $Y.has(Tm(t))}function Ea(t){return uo(t).getComputedStyle(t)}function rw(t){return Ca(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ju(t){if(Tm(t)==="html")return t;const e=t.assignedSlot||t.parentNode||uA(t)&&t.host||wl(t);return uA(e)?e.host:e}function IR(t){const e=ju(t);return im(e)?t.ownerDocument?t.ownerDocument.body:t.body:gl(e)&&W0(e)?e:IR(e)}function g0(t,e,i){var r;e===void 0&&(e=[]),i===void 0&&(i=!0);const o=IR(t),h=o===((r=t.ownerDocument)==null?void 0:r.body),d=uo(o);if(h){const a=uC(d);return e.concat(d,d.visualViewport||[],W0(o)?o:[],a&&i?g0(a):[])}return e.concat(o,g0(o,[],i))}function uC(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function $R(t){const e=Ea(t);let i=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=gl(t),h=o?t.offsetWidth:i,d=o?t.offsetHeight:r,a=Tx(i)!==h||Tx(r)!==d;return a&&(i=h,r=d),{width:i,height:r,$:a}}function S$(t){return Ca(t)?t:t.contextElement}function Pf(t){const e=S$(t);if(!gl(e))return pl(1);const i=e.getBoundingClientRect(),{width:r,height:o,$:h}=$R(e);let d=(h?Tx(i.width):i.width)/r,a=(h?Tx(i.height):i.height)/o;return(!d||!Number.isFinite(d))&&(d=1),(!a||!Number.isFinite(a))&&(a=1),{x:d,y:a}}const PY=pl(0);function PR(t){const e=uo(t);return!w$()||!e.visualViewport?PY:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function MY(t,e,i){return e===void 0&&(e=!1),!i||e&&i!==uo(t)?!1:e}function vd(t,e,i,r){e===void 0&&(e=!1),i===void 0&&(i=!1);const o=t.getBoundingClientRect(),h=S$(t);let d=pl(1);e&&(r?Ca(r)&&(d=Pf(r)):d=Pf(t));const a=MY(h,i,r)?PR(h):pl(0);let _=(o.left+a.x)/d.x,T=(o.top+a.y)/d.y,E=o.width/d.x,k=o.height/d.y;if(h){const L=uo(h),O=r&&Ca(r)?uo(r):r;let H=L,re=uC(H);for(;re&&r&&O!==H;){const pe=Pf(re),ge=re.getBoundingClientRect(),Se=Ea(re),Pe=ge.left+(re.clientLeft+parseFloat(Se.paddingLeft))*pe.x,Re=ge.top+(re.clientTop+parseFloat(Se.paddingTop))*pe.y;_*=pe.x,T*=pe.y,E*=pe.x,k*=pe.y,_+=Pe,T+=Re,H=uo(re),re=uC(H)}}return Ix({width:E,height:k,x:_,y:T})}function nw(t,e){const i=rw(t).scrollLeft;return e?e.left+i:vd(wl(t)).left+i}function MR(t,e){const i=t.getBoundingClientRect(),r=i.left+e.scrollLeft-nw(t,i),o=i.top+e.scrollTop;return{x:r,y:o}}function kY(t){let{elements:e,rect:i,offsetParent:r,strategy:o}=t;const h=o==="fixed",d=wl(r),a=e?tw(e.floating):!1;if(r===d||a&&h)return i;let _={scrollLeft:0,scrollTop:0},T=pl(1);const E=pl(0),k=gl(r);if((k||!k&&!h)&&((Tm(r)!=="body"||W0(d))&&(_=rw(r)),gl(r))){const O=vd(r);T=Pf(r),E.x=O.x+r.clientLeft,E.y=O.y+r.clientTop}const L=d&&!k&&!h?MR(d,_):pl(0);return{width:i.width*T.x,height:i.height*T.y,x:i.x*T.x-_.scrollLeft*T.x+E.x+L.x,y:i.y*T.y-_.scrollTop*T.y+E.y+L.y}}function AY(t){return Array.from(t.getClientRects())}function DY(t){const e=wl(t),i=rw(t),r=t.ownerDocument.body,o=ad(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),h=ad(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let d=-i.scrollLeft+nw(t);const a=-i.scrollTop;return Ea(r).direction==="rtl"&&(d+=ad(e.clientWidth,r.clientWidth)-o),{width:o,height:h,x:d,y:a}}const hA=25;function zY(t,e){const i=uo(t),r=wl(t),o=i.visualViewport;let h=r.clientWidth,d=r.clientHeight,a=0,_=0;if(o){h=o.width,d=o.height;const E=w$();(!E||E&&e==="fixed")&&(a=o.offsetLeft,_=o.offsetTop)}const T=nw(r);if(T<=0){const E=r.ownerDocument,k=E.body,L=getComputedStyle(k),O=E.compatMode==="CSS1Compat"&&parseFloat(L.marginLeft)+parseFloat(L.marginRight)||0,H=Math.abs(r.clientWidth-k.clientWidth-O);H<=hA&&(h-=H)}else T<=hA&&(h+=T);return{width:h,height:d,x:a,y:_}}const OY=new Set(["absolute","fixed"]);function RY(t,e){const i=vd(t,!0,e==="fixed"),r=i.top+t.clientTop,o=i.left+t.clientLeft,h=gl(t)?Pf(t):pl(1),d=t.clientWidth*h.x,a=t.clientHeight*h.y,_=o*h.x,T=r*h.y;return{width:d,height:a,x:_,y:T}}function dA(t,e,i){let r;if(e==="viewport")r=zY(t,i);else if(e==="document")r=DY(wl(t));else if(Ca(e))r=RY(e,i);else{const o=PR(t);r={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return Ix(r)}function kR(t,e){const i=ju(t);return i===e||!Ca(i)||im(i)?!1:Ea(i).position==="fixed"||kR(i,e)}function LY(t,e){const i=e.get(t);if(i)return i;let r=g0(t,[],!1).filter(a=>Ca(a)&&Tm(a)!=="body"),o=null;const h=Ea(t).position==="fixed";let d=h?ju(t):t;for(;Ca(d)&&!im(d);){const a=Ea(d),_=iw(d);!_&&a.position==="fixed"&&(o=null),(h?!_&&!o:!_&&a.position==="static"&&!!o&&OY.has(o.position)||W0(d)&&!_&&kR(t,d))?r=r.filter(E=>E!==d):o=a,d=ju(d)}return e.set(t,r),r}function FY(t){let{element:e,boundary:i,rootBoundary:r,strategy:o}=t;const d=[...i==="clippingAncestors"?tw(e)?[]:LY(e,this._c):[].concat(i),r],a=d[0],_=d.reduce((T,E)=>{const k=dA(e,E,o);return T.top=ad(k.top,T.top),T.right=tm(k.right,T.right),T.bottom=tm(k.bottom,T.bottom),T.left=ad(k.left,T.left),T},dA(e,a,o));return{width:_.right-_.left,height:_.bottom-_.top,x:_.left,y:_.top}}function NY(t){const{width:e,height:i}=$R(t);return{width:e,height:i}}function BY(t,e,i){const r=gl(e),o=wl(e),h=i==="fixed",d=vd(t,!0,h,e);let a={scrollLeft:0,scrollTop:0};const _=pl(0);function T(){_.x=nw(o)}if(r||!r&&!h)if((Tm(e)!=="body"||W0(o))&&(a=rw(e)),r){const O=vd(e,!0,h,e);_.x=O.x+e.clientLeft,_.y=O.y+e.clientTop}else o&&T();h&&!r&&o&&T();const E=o&&!r&&!h?MR(o,a):pl(0),k=d.left+a.scrollLeft-_.x-E.x,L=d.top+a.scrollTop-_.y-E.y;return{x:k,y:L,width:d.width,height:d.height}}function MS(t){return Ea(t).position==="static"}function pA(t,e){if(!gl(t)||Ea(t).position==="fixed")return null;if(e)return e(t);let i=t.offsetParent;return wl(t)===i&&(i=i.ownerDocument.body),i}function AR(t,e){const i=uo(t);if(tw(t))return i;if(!gl(t)){let o=ju(t);for(;o&&!im(o);){if(Ca(o)&&!MS(o))return o;o=ju(o)}return i}let r=pA(t,e);for(;r&&wY(r)&&MS(r);)r=pA(r,e);return r&&im(r)&&MS(r)&&!iw(r)?i:r||IY(t)||i}const jY=async function(t){const e=this.getOffsetParent||AR,i=this.getDimensions,r=await i(t.floating);return{reference:BY(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function UY(t){return Ea(t).direction==="rtl"}const hC={convertOffsetParentRelativeRectToViewportRelativeRect:kY,getDocumentElement:wl,getClippingRect:FY,getOffsetParent:AR,getElementRects:jY,getClientRects:AY,getDimensions:NY,getScale:Pf,isElement:Ca,isRTL:UY};function DR(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function VY(t,e){let i=null,r;const o=wl(t);function h(){var a;clearTimeout(r),(a=i)==null||a.disconnect(),i=null}function d(a,_){a===void 0&&(a=!1),_===void 0&&(_=1),h();const T=t.getBoundingClientRect(),{left:E,top:k,width:L,height:O}=T;if(a||e(),!L||!O)return;const H=kv(k),re=kv(o.clientWidth-(E+L)),pe=kv(o.clientHeight-(k+O)),ge=kv(E),Pe={rootMargin:-H+"px "+-re+"px "+-pe+"px "+-ge+"px",threshold:ad(0,tm(1,_))||1};let Re=!0;function ze(Je){const Xe=Je[0].intersectionRatio;if(Xe!==_){if(!Re)return d();Xe?d(!1,Xe):r=setTimeout(()=>{d(!1,1e-7)},1e3)}Xe===1&&!DR(T,t.getBoundingClientRect())&&d(),Re=!1}try{i=new IntersectionObserver(ze,{...Pe,root:o.ownerDocument})}catch{i=new IntersectionObserver(ze,Pe)}i.observe(t)}return d(!0),h}function GY(t,e,i,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:h=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:_=!1}=r,T=S$(t),E=o||h?[...T?g0(T):[],...g0(e)]:[];E.forEach(ge=>{o&&ge.addEventListener("scroll",i,{passive:!0}),h&&ge.addEventListener("resize",i)});const k=T&&a?VY(T,i):null;let L=-1,O=null;d&&(O=new ResizeObserver(ge=>{let[Se]=ge;Se&&Se.target===T&&O&&(O.unobserve(e),cancelAnimationFrame(L),L=requestAnimationFrame(()=>{var Pe;(Pe=O)==null||Pe.observe(e)})),i()}),T&&!_&&O.observe(T),O.observe(e));let H,re=_?vd(t):null;_&&pe();function pe(){const ge=vd(t);re&&!DR(re,ge)&&i(),re=ge,H=requestAnimationFrame(pe)}return i(),()=>{var ge;E.forEach(Se=>{o&&Se.removeEventListener("scroll",i),h&&Se.removeEventListener("resize",i)}),k?.(),(ge=O)==null||ge.disconnect(),O=null,_&&cancelAnimationFrame(H)}}const qY=_Y,HY=pY,ZY=vY,fA=fY,WY=mY,YY=hY,XY=(t,e,i)=>{const r=new Map,o={platform:hC,...i},h={...o.platform,_c:r};return uY(t,e,{...o,platform:h})};function sw(t,e,{signal:i,edges:r}={}){let o,h=null;const d=r!=null&&r.includes("leading"),a=r==null||r.includes("trailing"),_=()=>{h!==null&&(t.apply(o,h),o=void 0,h=null)},T=()=>{a&&_(),O()};let E=null;const k=()=>{E!=null&&clearTimeout(E),E=setTimeout(()=>{E=null,T()},e)},L=()=>{E!==null&&(clearTimeout(E),E=null)},O=()=>{L(),o=void 0,h=null},H=()=>{_()},re=function(...pe){if(i?.aborted)return;o=this,h=pe;const ge=E==null;k(),d&&ge&&_()};return re.schedule=k,re.cancel=O,re.flush=H,i?.addEventListener("abort",O,{once:!0}),re}function JY(t){return t}function KY(t){return t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}function QY(t){return eX(t)}function kS(t){return t.assignedSlot?t.assignedSlot:t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}function eX(t){for(let e=t;e;e=kS(e))if(e instanceof Element&&getComputedStyle(e).display==="none")return null;for(let e=kS(t);e;e=kS(e)){if(!(e instanceof Element))continue;const i=getComputedStyle(e);if(i.display!=="contents"&&(i.position!=="static"||iw(i)||e.tagName==="BODY"))return e}return null}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */(function(){{const e=hC.getOffsetParent;hC.getOffsetParent=i=>e(i,QY)}})();function mA(t){const e=window.devicePixelRatio||1;return Math.round(t*e)/e}const zR=(async(t,{referenceEl:e,floatingEl:i,overlayPositioning:r="absolute",placement:o,flipDisabled:h,flipPlacements:d,offsetDistance:a,offsetSkidding:_,arrowEl:T,type:E})=>{if(!e||!i)return;const k=Z0(i)==="rtl",{x:L,y:O,placement:H,strategy:re,middlewareData:pe}=await XY(e,i,{strategy:r,placement:o==="auto"||o==="auto-start"||o==="auto-end"?void 0:gA(o,k),middleware:rX({placement:o,flipDisabled:h,flipPlacements:d?.map(Re=>gA(Re,k)),offsetDistance:a,offsetSkidding:_,arrowEl:T,type:E})});if(T&&pe.arrow){const{x:Re,y:ze}=pe.arrow,Je=H.split("-")[0],Xe=Re!=null?"left":"top",yt=oX[Je],mt={left:"",top:"",bottom:"",right:""};"floatingLayout"in t&&(t.floatingLayout=Je==="left"||Je==="right"?"horizontal":"vertical"),Object.assign(T.style,{...mt,[Xe]:`${Xe=="left"?Re:ze}px`,[Je]:"100%",transform:yt})}const Se=pe.hide?.referenceHidden?"hidden":null,Pe=Se?"none":null;i.setAttribute(tX,H),Object.assign(i.style,{pointerEvents:Pe,position:re,transform:`translate(${mA(L)}px,${mA(O)}px)`,visibility:Se})}),tX="data-placement",OR=["top","bottom","right","left","top-start","top-end","bottom-start","bottom-end","right-start","right-end","left-start","left-end","leading","trailing","leading-start","leading-end","trailing-start","trailing-end"],y0="bottom-start",iX="bottom-end",rm={animation:"calcite-floating-ui-anim",animationActive:"calcite-floating-ui-anim--active"};function rX({placement:t,flipDisabled:e,flipPlacements:i,offsetDistance:r,offsetSkidding:o,arrowEl:h,type:d}){const a=[ZY(),WY()];return d==="menu"&&a.push(fA({fallbackPlacements:i||["top-start","top","top-end","bottom-start","bottom","bottom-end"]})),a.push(qY({mainAxis:typeof r=="number"?r:0,crossAxis:typeof o=="number"?o:0})),t==="auto"||t==="auto-start"||t==="auto-end"?a.push(HY({alignment:t==="auto-start"?"start":t==="auto-end"?"end":null})):e||a.push(fA(i?{fallbackPlacements:i}:{})),h&&a.push(YY({element:h})),a}function nX(t){return OR.includes(t)}function RR(t,e){const i=t.filter(nX);return i.length!==t.length&&console.warn(`${e.tagName}: Invalid value found in: flipPlacements. Try any of these: ${OR.map(r=>`"${r}"`).join(", ").trim()}`,{el:e}),i}function gA(t,e=!1){const i=["left","right"];return e&&i.reverse(),t.replace(/leading/gi,i[0]).replace(/trailing/gi,i[1])}async function T$(t,e,i=!1){if(!t.open||!e.floatingEl||!e.referenceEl)return;if(Object.assign(e.floatingEl.style,{display:"block",position:e.overlayPositioning??"absolute"}),!_0.get(t))return LR(t);await(i?sX(t):zR)(t,e)}function sX(t){let e=$x.get(t);return e||(e=sw(zR,g$.reposition,{edges:["leading","trailing"]}),$x.set(t,e),e)}const oX={top:"",left:"rotate(-90deg)",bottom:"rotate(180deg)",right:"rotate(90deg)"},_0=new WeakMap,$x=new WeakMap;async function LR(t){const{referenceEl:e,floatingEl:i}=t;if(!i.isConnected)return;const r=GY;_0.set(t,{state:"pending"});let o;const h=r(e,i,()=>{const d=t.reposition();o||(o=d)});return _0.set(t,{state:"active",cleanUp:h}),o}function C$(t){const{floatingEl:e}=t;e&&Object.assign(e.style,{display:"",pointerEvents:"",position:"",transform:"",visibility:""})}async function dc(t){const{floatingEl:e,referenceEl:i}=t;if(C$(t),!(!e||!i)&&(ow(t),!!t.open))return LR(t)}function ow(t){const e=_0.get(t);e?.state==="active"&&e.cleanUp(),_0.delete(t),$x.get(t)?.cancel(),$x.delete(t)}const yA=4,_A=Math.ceil(Math.hypot(yA,yA));/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function aX(){const{disabled:t}=this;t||HTMLElement.prototype.click.call(this)}function FR(t){t.target.disabled&&t.preventDefault()}const NR=["mousedown","mouseup","click"];function BR(t){t.target.disabled&&(t.stopImmediatePropagation(),t.preventDefault())}const Px={capture:!0};function mo(t){if(t.disabled){t.el.setAttribute("aria-disabled","true"),t.el.contains(document.activeElement)&&document.activeElement.blur(),lX(t);return}uX(t),t.el.removeAttribute("aria-disabled")}function lX(t){t.el.click=aX,cX(t.el)}function cX(t){t.addEventListener("pointerdown",FR,Px),NR.forEach(e=>t.addEventListener(e,BR,Px))}function uX(t){delete t.el.click,hX(t.el)}function hX(t){t.removeEventListener("pointerdown",FR,Px),NR.forEach(e=>t.removeEventListener(e,BR,Px))}const dX={container:"interaction-container"},go=({children:t,disabled:e})=>Ne`<div class=${Fe(dX.container)} .inert=${e}>${t}</div>`;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function E$(t){return t==="Enter"||t===" "}const aw=["0","1","2","3","4","5","6","7","8","9"];/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function vA(t){return t[t.openProp||"open"]}async function Y0(t){await t.updateComplete,vA(t)?t.onBeforeOpen():t.onBeforeClose(),await t.updateComplete,t.transitionEl&&await HW(t.transitionEl,t.transitionProp),vA(t)?t.onOpen():t.onClose()}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function pX(t,e,i){return e?`${t}-${e}`:i?`${t}-${i}`:`${t}-m`}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function Br(t){return t==="l"?"m":"s"}async function fX(t){await t.componentOnReady(),await t.updateComplete}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const zs=()=>y$((t,e)=>{let i;function r(){i?.abort()}return e.onLoad(()=>{t.listen("focus",()=>{i=new AbortController,t.el.addEventListener("focusout",r,{signal:i.signal})})}),e.onDisconnected(()=>{t.el.removeEventListener("focusout",r)}),async(o,h)=>{if(t.disabled)return;const d=gX(o());if(!d)return;const{target:a,includeContainer:_,strategy:T}=d,E=J1(t.el),k=E.activeElement;if(await fX(t),!(k!==E.activeElement||i&&!i?.signal.aborted))return t.el.removeEventListener("focus",r),f0(a,_,T,t.el,h)}});function mX(t){return"target"in t&&("includeContainer"in t||"strategy"in t)}function gX(t){if(t)return mX(t)?t:{target:t}}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const yX={trigger:"trigger"},AS={content:"content",wrapper:"wrapper",triggerContainer:"trigger-container"},bA="calcite-dropdown",Av={menuButton:t=>`${bA}-${t}-menubutton`,menu:t=>`${bA}-${t}-menu`},_X=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block}.wrapper{--calcite-floating-ui-z-index: var(--calcite-z-index-dropdown);inline-size:max-content;display:none;max-inline-size:100vw;max-block-size:100vh;inset-block-start:0;left:0;z-index:var(--calcite-floating-ui-z-index)}@starting-style{.wrapper{opacity:0;inset-block-start:0;left:0}}.wrapper .calcite-floating-ui-anim{position:relative;transition-duration:var(--calcite-floating-ui-transition);transition-property:inset-block-start,left,opacity,display;transition-behavior:allow-discrete;opacity:0;box-shadow:0 0 16px #00000029;z-index:var(--calcite-z-index);border-radius:.25rem}.wrapper[data-placement^=bottom] .calcite-floating-ui-anim{inset-block-start:-5px}.wrapper[data-placement^=top] .calcite-floating-ui-anim{inset-block-start:5px}.wrapper[data-placement^=left] .calcite-floating-ui-anim{left:5px}.wrapper[data-placement^=right] .calcite-floating-ui-anim{left:-5px}.wrapper[data-placement] .calcite-floating-ui-anim--active{opacity:1;inset-block-start:0;left:0}@starting-style{.wrapper[data-placement] .calcite-floating-ui-anim--active{opacity:0}}.content{max-height:45vh;width:auto;overflow-y:auto;overflow-x:hidden;inline-size:var(--calcite-dropdown-width, var(--calcite-internal-dropdown-width));background-color:var(--calcite-dropdown-background-color, var(--calcite-color-foreground-1))}.trigger-container{position:relative;display:flex;height:100%;flex:1 1 auto;word-wrap:break-word;word-break:break-word}.width-s{--calcite-internal-dropdown-width: 12rem}.width-m{--calcite-internal-dropdown-width: 14rem}.width-l{--calcite-internal-dropdown-width: 16rem}@media (forced-colors: active){:host([open]) .wrapper{border:var(--calcite-border-width-sm) solid canvasText}}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}`,r0=class r0 extends ji{constructor(){super(),this.focusLastDropdownItem=!1,this.groups=[],this.guid=Hu(),this.items=[],this.mutationObserver=qo("mutation",()=>this.updateItems()),this.transitionProp="opacity",this.resizeObserver=qo("resize",e=>this.resizeObserverCallback(e)),this.focusSetter=zs()(this),this.closeOnSelectDisabled=!1,this.disabled=!1,this.maxItems=0,this.offsetDistance=0,this.offsetSkidding=0,this.open=!1,this.overlayPositioning="absolute",this.placement=y0,this.scale="m",this.selectedItems=[],this.type="click",this.calciteDropdownBeforeClose=vt({cancelable:!1}),this.calciteDropdownBeforeOpen=vt({cancelable:!1}),this.calciteDropdownClose=vt({cancelable:!1}),this.calciteDropdownOpen=vt({cancelable:!1}),this.calciteDropdownSelect=vt({cancelable:!1}),this.listenOn(window,"click",this.closeCalciteDropdownOnClick),this.listen("calciteInternalDropdownCloseRequest",this.closeCalciteDropdownOnEvent),this.listenOn(window,"calciteDropdownOpen",this.closeCalciteDropdownOnOpenEvent),this.listen("pointerenter",this.pointerEnterHandler),this.listen("pointerleave",this.pointerLeaveHandler),this.listen("calciteInternalDropdownItemKeyEvent",this.calciteInternalDropdownItemKeyEvent),this.listen("calciteInternalDropdownItemSelect",this.handleItemSelect)}async reposition(e=!1){const{filteredFlipPlacements:i,floatingEl:r,offsetDistance:o,offsetSkidding:h,overlayPositioning:d,placement:a,referenceEl:_}=this;return T$(this,{floatingEl:r,referenceEl:_,offsetDistance:o,offsetSkidding:h,overlayPositioning:d,placement:a,flipPlacements:i,type:"menu"},e)}async setFocus(e){return this.focusSetter(()=>this.referenceEl,e)}connectedCallback(){super.connectedCallback(),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0}),this.setFilteredPlacements(),this.updateItems(),dc(this)}willUpdate(e){e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler(),e.has("disabled")&&(this.hasUpdated||this.disabled!==!1)&&this.handleDisabledChange(this.disabled),e.has("flipPlacements")&&this.flipPlacementsHandler(),e.has("maxItems")&&this.hasUpdated&&this.setMaxScrollerHeight(),this.hasUpdated&&(e.has("offsetDistance")&&this.offsetDistance!==0||e.has("offsetSkidding")&&this.offsetSkidding!==0||e.has("overlayPositioning")&&this.overlayPositioning!=="absolute"||e.has("placement")&&this.placement!==y0)&&this.reposition(!0),e.has("scale")&&(this.hasUpdated||this.scale!=="m")&&this.handlePropsChange()}updated(){mo(this)}loaded(){this.updateSelectedItems(),dc(this)}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.resizeObserver?.disconnect(),ow(this)}openHandler(){Y0(this),!this.disabled&&this.reposition(!0)}handleDisabledChange(e){e||(this.open=!1)}flipPlacementsHandler(){this.setFilteredPlacements(),this.reposition(!0)}handlePropsChange(){this.updateItems(),this.updateGroupProps()}closeCalciteDropdownOnClick(e){this.disabled||!this.open||e.composedPath().includes(this.el)||this.closeCalciteDropdown(!1)}closeCalciteDropdownOnEvent(e){this.closeCalciteDropdown(),e.stopPropagation()}closeCalciteDropdownOnOpenEvent(e){e.composedPath().includes(this.el)||(this.open=!1)}pointerEnterHandler(){this.disabled||this.type!=="hover"||this.toggleDropdown()}pointerLeaveHandler(){this.disabled||this.type!=="hover"||this.closeCalciteDropdown()}getTraversableItems(){return this.items.filter(e=>!e.disabled&&!e.hidden)}calciteInternalDropdownItemKeyEvent(e){const{keyboardEvent:i}=e.detail,r=i.target,o=this.getTraversableItems();switch(i.key){case"Tab":this.open=!1,this.updateTabIndexOfItems(r);break;case"ArrowDown":Mv(o,r,"next");break;case"ArrowUp":Mv(o,r,"previous");break;case"Home":Mv(o,r,"first");break;case"End":Mv(o,r,"last");break}e.stopPropagation()}handleItemSelect(e){this.updateSelectedItems(),e.stopPropagation(),this.calciteDropdownSelect.emit(),(!this.closeOnSelectDisabled||e.detail.requestedDropdownGroup.selectionMode==="none")&&this.closeCalciteDropdown(),e.stopPropagation()}setFilteredPlacements(){const{el:e,flipPlacements:i}=this;this.filteredFlipPlacements=i?RR(i,e):null}updateTriggers(e){this.triggers=e.target.assignedElements({flatten:!0}),this.reposition(!0)}updateItems(){this.items=this.groups.map(e=>Array.from(e?.querySelectorAll("calcite-dropdown-item"))).reduce((e,i)=>[...e,...i],[]),this.updateSelectedItems(),this.reposition(!0),this.items.forEach(e=>e.scale=this.scale)}updateGroups(e){const i=e.target.assignedElements({flatten:!0}).filter(r=>r?.matches("calcite-dropdown-group"));this.groups=i,this.updateItems(),this.updateGroupProps()}updateGroupProps(){this.groups.forEach((e,i)=>{e.scale=this.scale,e.position=i})}resizeObserverCallback(e){e.forEach(({target:i})=>{i===this.referenceEl?this.setDropdownWidth():i===this.scrollerEl&&this.setMaxScrollerHeight()})}setDropdownWidth(){const{referenceEl:e,scrollerEl:i}=this;!i||!e||(i.style.minWidth=`${e.clientWidth}px`)}setMaxScrollerHeight(){const{maxItems:e,items:i,scrollerEl:r}=this;if(!r)return;const o=i.length>=e&&e>0?this.getYDistanceFromScroller(i.at(e-1)):0;r.style.maxBlockSize=o>0?`${o}px`:"",this.reposition(!0)}setScrollerAndTransitionEl(e){bx(this.resizeObserver,this.scrollerEl,e),this.scrollerEl=e,this.transitionEl=e}onBeforeOpen(){this.focusOnFirstActiveOrDefaultItem(),this.calciteDropdownBeforeOpen.emit()}onOpen(){this.calciteDropdownOpen.emit()}onBeforeClose(){this.calciteDropdownBeforeClose.emit()}onClose(){this.calciteDropdownClose.emit(),C$(this)}setReferenceEl(e){bx(this.resizeObserver,this.referenceEl,e),this.referenceEl=e,dc(this)}setFloatingEl(e){this.floatingEl=e,dc(this)}keyDownHandler(e){if(!e.composedPath().includes(this.referenceEl))return;const{defaultPrevented:i,key:r}=e;if(!i){if(r==="Escape"){this.closeCalciteDropdown(),e.preventDefault();return}if(this.open&&e.shiftKey&&r==="Tab"){this.closeCalciteDropdown(),e.preventDefault();return}E$(r)?(this.toggleDropdown(),e.preventDefault()):(r==="ArrowDown"||r==="ArrowUp")&&(e.preventDefault(),this.focusLastDropdownItem=r==="ArrowUp",this.open=!0)}}updateSelectedItems(){this.selectedItems=this.items.filter(e=>e.selected)}getYDistanceFromScroller(e){const i=e.getBoundingClientRect();return e.offsetTop+i.height}closeCalciteDropdown(e=!0){this.open=!1,e&&f0(this.triggers[0])}async focusOnFirstActiveOrDefaultItem(){const i=this.getTraversableItems().find(r=>r.selected)||(this.focusLastDropdownItem?this.items.at(-1):this.items[0]);this.focusLastDropdownItem=!1,i&&(await this.updateComplete,await oC(),await oC(),await f0(i),i.scrollIntoView({block:"nearest"}))}toggleDropdown(){this.open=!this.open}updateTabIndexOfItems(e){this.items.forEach(i=>{i.tabIndex=e!==i?-1:0})}render(){const{open:e,guid:i}=this;return go({disabled:this.disabled,children:Ne`<div class=${Fe(AS.triggerContainer)} id=${Av.menuButton(i)??ut} @click=${this.toggleDropdown} @keydown=${this.keyDownHandler} ${hi(this.setReferenceEl)}><slot aria-controls=${Av.menu(i)??ut} .ariaExpanded=${e} aria-haspopup=menu name=${yX.trigger} @slotchange=${this.updateTriggers}></slot></div><div .ariaHidden=${!e} class=${Fe({[AS.wrapper]:!0,[pX("width",this.width,this.widthScale)]:!!(this.width||this.widthScale)})} ${hi(this.setFloatingEl)}><div aria-labelledby=${Av.menuButton(i)??ut} class=${Fe({[AS.content]:!0,[rm.animation]:!0,[rm.animationActive]:e})} id=${Av.menu(i)??ut} role=menu ${hi(this.setScrollerAndTransitionEl)}><slot @slotchange=${this.updateGroups}></slot></div></div>`})}};r0.properties={closeOnSelectDisabled:[7,{},{reflect:!0,type:Boolean}],disabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],maxItems:[11,{},{reflect:!0,type:Number}],offsetDistance:[11,{},{type:Number,reflect:!0}],offsetSkidding:[11,{},{reflect:!0,type:Number}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}],selectedItems:[0,{},{attribute:!1}],type:[3,{},{reflect:!0}],widthScale:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]},r0.shadowRootOptions={mode:"open",delegatesFocus:!0},r0.styles=_X;let dC=r0;ar("calcite-dropdown",dC);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ai=xm(class extends wm{constructor(){super(...arguments),this.key=ut}render(t,e){return this.key=t,e}update(t,[e,i]){return e!==this.key&&(m$(t),this.key=e),i}});/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const vX=["calcite-input","calcite-input-number","calcite-input-text","calcite-text-area"];function bX(t){return`${t.split("-").map((r,o)=>o===0?r:`${r[0].toUpperCase()}${r.slice(1)}`).join("")}${vX.includes(t)?"Input":"Change"}`}const pC="hidden-form-input";function I$(t){return"checked"in t}const fC=new WeakMap,$$=new WeakSet;function xX(t,e){if(Sm(e.parentElement,"[form]"))return!0;const r="calciteInternalFormComponentRegister";let o=!1;return t.addEventListener(r,h=>{o=h.composedPath().some(d=>$$.has(d)),h.stopPropagation()},{once:!0}),e.dispatchEvent(new CustomEvent(r,{bubbles:!0,composed:!0})),o}function wX(t,{status:e,message:i,icon:r}){"status"in t&&(t.status=e),"validationIcon"in t&&typeof t.validationIcon!="string"&&(t.validationIcon=r),"validationMessage"in t&&!t.validationMessage&&(t.validationMessage=i)}function jR(t){return t.nodeName==="CALCITE-RADIO-BUTTON"?Sm(t,"calcite-radio-button-group"):t}const SX=new CustomEvent("calciteInvalid",{bubbles:!0,composed:!0});function xA(t){const e=t?.target,i=e?.validationMessage,r=jR(e?.parentElement);if(!r)return;const o=r?.nodeName?.toLowerCase(),h=o?.split("-");if(h.length<2||h[0]!=="calcite")return;t?.preventDefault(),"validity"in r&&(r.validity=e?.validity),r.dispatchEvent(SX),wX(r,{message:i,icon:!0,status:"invalid"});const d=bX(o);r.addEventListener(d,()=>{"status"in r&&(r.status="idle"),"validationIcon"in r&&(r.validationIcon===""||r.validationIcon===!0)&&(r.validationIcon=!1),"validationMessage"in r&&r.validationMessage===i&&(r.validationMessage=""),"validity"in r&&(r.validity=e?.validity)},{once:!0})}function lw(t){const{formEl:e}=t;return e?(e.addEventListener("invalid",xA,!0),e.requestSubmit(),e.removeEventListener("invalid",xA,!0),requestAnimationFrame(()=>{const i=e.querySelectorAll("[status=invalid]");for(const r of i)if(r?.validationMessage){r?.setFocus();break}}),!0):!1}function UR(t){t.formEl?.reset()}function VR(t){const{el:e,value:i}=t,r=P$(t);if(!r||xX(r,e))return;t.formEl=r,t.defaultValue=i,I$(t)&&(t.defaultChecked=t.checked);const o=TX.bind(t);r.addEventListener("reset",o),fC.set(t.el,o),$$.add(e)}function P$(t){const{el:e,form:i}=t;return i?K1(e,{id:i}):Sm(e,"form")}function TX(){if("status"in this&&(this.status="idle"),"validationIcon"in this&&(this.validationIcon=!1),"validationMessage"in this&&(this.validationMessage=""),I$(this)){this.checked=this.defaultChecked;return}this.value=this.defaultValue,this.onFormReset?.()}function GR(t){const{el:e,formEl:i}=t;if(!i)return;const r=fC.get(e);i.removeEventListener("reset",r),fC.delete(e),t.formEl=null,$$.delete(e)}function CX(t,e){t.defaultValue=e}const mC="calciteInternalHiddenInputInput",qR=t=>{t.target.dispatchEvent(new CustomEvent(mC,{bubbles:!0}))},wA=t=>t.removeEventListener("input",qR);function EX(t){const{el:e,formEl:i,name:r,value:o}=t,{ownerDocument:h}=e,d=e.querySelectorAll(`input[slot="${pC}"]`);if(!i||!r){d.forEach(k=>{wA(k),k.remove()});return}const a=Array.isArray(o)?o:[o],_=[],T=new Set;d.forEach(k=>{const L=a.find(O=>O==k.value);L!=null?(T.add(L),SA(t,k,L)):_.push(k)});let E;a.forEach(k=>{if(T.has(k))return;let L=_.pop();L||(L=h.createElement("input"),L.ariaHidden="true",L.slot=pC),E||(E=h.createDocumentFragment()),E.append(L),L.addEventListener("input",qR),SA(t,L,k)}),E&&e.append(E),_.forEach(k=>{wA(k),k.remove()})}function SA(t,e,i){const{defaultValue:r,disabled:o,form:h,name:d,required:a}=t;e.defaultValue=r,e.disabled=o,e.name=d,e.required=a,e.tabIndex=-1,h?e.setAttribute("form",h):e.removeAttribute("form"),I$(t)?(e.checked=t.checked,e.defaultChecked=t.defaultChecked,e.value=t.checked?i||"on":""):e.value=i||"",t.syncHiddenFormInput?.(e);const _=jR(t.el);if(_&&"validity"in _)for(const T in{...e?.validity})_.validity[T]=e.validity[T]}const HR=({component:t})=>(EX(t),Ne`<slot name=${pC}></slot>`);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const sa={button:"button",buttonTextVisible:"button--text-visible",buttonCompact:"button--compact",indicatorText:"indicator-text",iconContainer:"icon-container",slotContainer:"slot-container",slotContainerHidden:"slot-container--hidden",textContainer:"text-container",textContainerVisible:"text-container--visible",indicatorWithIcon:"indicator-with-icon",indicatorWithoutIcon:"indicator-without-icon"},TA="calcite-action",IX={button:t=>`${TA}-${t}-button`,indicator:t=>`${TA}-${t}-indicator`},$X={tooltip:"tooltip"},PX=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;cursor:pointer;background-color:transparent;--calcite-internal-action-text-color: var(--calcite-color-text-3);border-radius:var(--calcite-action-corner-radius, var(--calcite-action-corner-radius-start-start, var(--calcite-corner-radius)) var(--calcite-action-corner-radius-start-end, var(--calcite-corner-radius)) var(--calcite-action-corner-radius-end-end, var(--calcite-corner-radius)) var(--calcite-action-corner-radius-end-start, var(--calcite-corner-radius)))}.interaction-container{border-radius:inherit}:host([width=full]){flex:1 0 auto}:host([width=full]) .button{justify-content:center}:host([width=full]) .button .text-container--visible{flex:none}:host([drag-handle]){cursor:move;--calcite-internal-action-text-color: var(--calcite-color-border-input);--calcite-internal-action-padding-inline: var(--calcite-spacing-xxs)}.button{border-radius:inherit;position:relative;margin:0;display:flex;inline-size:auto;align-items:center;justify-content:flex-start;border-style:none;font-family:var(--calcite-font-family);font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-medium);outline-color:transparent;background-color:var(--calcite-action-background-color, var(--calcite-color-foreground-1));color:var(--calcite-action-text-color, var(--calcite-internal-action-text-color));text-align:unset;flex:1 0 auto;cursor:inherit}.button:hover{background-color:var(--calcite-action-background-color-hover, var(--calcite-color-foreground-2));color:var(--calcite-action-text-color-press, var(--calcite-action-text-color-pressed, var(--calcite-color-text-1)))}.button:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.button:active{background-color:var(--calcite-action-background-color-press, var(--calcite-action-background-color-pressed, var(--calcite-color-foreground-3)))}.icon-container{pointer-events:none;margin:0;display:flex;align-items:center;justify-content:center;min-inline-size:1rem;min-block-size:1.5rem}.text-container{margin:0;inline-size:0px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.5rem;opacity:0;transition-property:opacity;transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.4,0,.2,1);transition-property:inline-size}.text-container--visible{inline-size:auto;flex:1 1 auto;opacity:1}:host([active]) .button{background-color:var(--calcite-action-background-color, var(--calcite-color-foreground-3));color:var(--calcite-action-text-color-press, var(--calcite-action-text-color-pressed, var(--calcite-color-text-1)))}:host([active]) .button:hover{background-color:var(--calcite-action-background-color-hover, var(--calcite-color-foreground-3))}:host([active]) .button:active{background-color:var(--calcite-action-background-color-press, var(--calcite-action-background-color-pressed, var(--calcite-color-foreground-3)))}:host([loading]) .button:hover,:host([loading]) .button:focus{background-color:var(--calcite-action-background-color, var(--calcite-color-foreground-1))}:host([loading]) .text-container{opacity:var(--calcite-opacity-disabled)}:host([loading]) calcite-loader[inline]{margin-inline-end:0px}:host([appearance=transparent]):host([active]) .button{background-color:var(--calcite-color-transparent-press)}:host([appearance=transparent]) .button{background-color:transparent;transition-property:box-shadow;transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.4,0,.2,1)}:host([appearance=transparent]) .button:hover{background-color:var(--calcite-color-transparent-hover)}:host([appearance=transparent]) .button:active{background-color:var(--calcite-color-transparent-press)}:host([active-descendant]) .button{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([scale=s]) .button{font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-normal);padding-inline:var(--calcite-internal-action-padding-inline, .5rem);padding-block:var(--calcite-internal-action-padding-block, var(--calcite-spacing-xxs))}:host([scale=s]) .button--text-visible .icon-container{margin-inline-end:.5rem}:host([scale=m]) .button{font-size:var(--calcite-font-size--1);line-height:1rem;font-weight:var(--calcite-font-weight-normal);padding-inline:var(--calcite-internal-action-padding-inline, 1rem);padding-block:var(--calcite-internal-action-padding-block, var(--calcite-spacing-md))}:host([scale=m]) .button--text-visible .icon-container{margin-inline-end:.75rem}:host([scale=l]) .button{font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-normal);padding-inline:var(--calcite-internal-action-padding-inline, 1.25rem);padding-block:var(--calcite-internal-action-padding-block, var(--calcite-spacing-xl))}:host([scale=l]) .button--text-visible .icon-container{margin-inline-end:1rem}:host([alignment=center]) .button{justify-content:center}:host([alignment=end]) .button{justify-content:flex-end}:host([alignment=center]) .button .text-container--visible,:host([alignment=end]) .button .text-container--visible{flex:0 1 auto}:host([scale=s][compact]) .button,:host([scale=m][compact]) .button,:host([scale=l][compact]) .button{padding-inline:0px}.slot-container{display:flex}.slot-container--hidden{display:none}.button--text-visible{inline-size:100%}.indicator-with-icon{position:relative}.indicator-with-icon:after{content:"";position:absolute;block-size:.5rem;inline-size:.5rem;border-radius:9999px;inset-block-end:-.275rem;inset-inline-end:-.275rem;background-color:var(--calcite-action-indicator-color, var(--calcite-color-brand))}.indicator-without-icon{margin-inline:.25rem;inline-size:1rem;position:relative}.indicator-without-icon:after{content:"";position:absolute;block-size:.5rem;inline-size:.5rem;border-radius:9999px;inset-block-end:-.275rem;inset-inline-end:-.275rem;background-color:var(--calcite-action-indicator-color, var(--calcite-color-brand))}.indicator-text{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) .button,:host([disabled]) .button:hover,:host([disabled]) .button:focus{cursor:default;opacity:var(--calcite-opacity-disabled);background-color:var(--calcite-action-background-color, var(--calcite-action-background-color, var(--calcite-color-foreground-1)))}:host([disabled]):host([active]) .button,:host([disabled]):host([active]) .button:hover,:host([disabled]):host([active]) .button:focus{opacity:var(--calcite-opacity-disabled);background-color:var(--calcite-action-background-color-press, var(--calcite-action-background-color-press, var(--calcite-action-background-color-pressed, var(--calcite-color-foreground-3))))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}`,w1=class w1 extends ji{constructor(){super(...arguments),this.guid=Hu(),this.buttonEl=Yn(),this.buttonId=IX.button(this.guid),this.mutationObserver=qo("mutation",()=>this.requestUpdate()),this.messages=fo({blocking:!0}),this.focusSetter=zs()(this),this.active=!1,this.activeDescendant=!1,this.appearance="solid",this.compact=!1,this.disabled=!1,this.dragHandle=!1,this.iconFlipRtl=!1,this.indicator=!1,this.loading=!1,this.scale="m",this.width="auto",this.textEnabled=!1,this.type="button"}async setFocus(e){return this.focusSetter(()=>this.buttonEl.value,e)}connectedCallback(){super.connectedCallback(),this.formEl=P$(this),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}updated(){mo(this)}disconnectedCallback(){super.disconnectedCallback(),this.formEl=null,this.mutationObserver?.disconnect()}handleClick(){const{type:e}=this;e==="submit"?lw(this):e==="reset"&&UR(this)}handleTooltipSlotChange(e){const r=e.target.assignedElements({flatten:!0}).filter(o=>o?.matches("calcite-tooltip"))[0];r&&(r.referenceElement=this.buttonEl.value)}storeIndicatorEl(e){this.indicatorEl=e}renderTextContainer(){const{text:e,textEnabled:i}=this,r={[sa.textContainer]:!0,[sa.textContainerVisible]:i};return e?ai("text-container",Ne`<div class=${Fe(r)}>${e}</div>`):null}renderIndicatorText(){const{indicator:e,messages:i,buttonId:r}=this;return Ne`<div aria-labelledby=${r??Ou} aria-live=polite class=${Fe(sa.indicatorText)} role=region ${hi(this.storeIndicatorEl)}>${e?i.indicator:null}</div>`}renderIconContainer(){const{loading:e,icon:i,scale:r,el:o,iconFlipRtl:h,indicator:d}=this,a=r==="l"?"l":"m",_=e?Ne`<calcite-loader inline .label=${this.messages.loading} .scale=${a}></calcite-loader>`:null,T=i?Ne`<calcite-icon class=${Fe({[sa.indicatorWithIcon]:d})} .flipRtl=${h} .icon=${i} .scale=${Br(this.scale)}></calcite-icon>`:null,E=_||T,k=E||o.children?.length,L=Ne`<div class=${Fe({[sa.slotContainer]:!0,[sa.slotContainerHidden]:e})}><slot></slot></div>`;return k?ai("icon-container",Ne`<div aria-hidden=true class=${Fe(sa.iconContainer)}>${E}${L}</div>`):null}renderButton(){const{compact:e,disabled:i,icon:r,loading:o,textEnabled:h,label:d,text:a,indicator:_,indicatorEl:T,buttonId:E,messages:k}=this,L=d||a||"",O=_?k.indicatorLabel.replace("{label}",L):L,H={[sa.button]:!0,[sa.buttonTextVisible]:h,[sa.buttonCompact]:e},re=Ne`${this.renderIconContainer()}${this.renderTextContainer()}${!r&&_&&ai("indicator-no-icon",Ne`<div class=${Fe(sa.indicatorWithoutIcon)}></div>`)||""}`,pe=_&&T?[T]:[],ge=[...this.aria?.controlsElements??[],...pe];return this.dragHandle?Ne`<span .ariaBusy=${o} .ariaControlsElements=${ge} .ariaDescribedByElements=${this.aria?.describedByElements} .ariaExpanded=${this.aria?.expanded} .ariaHasPopup=${this.aria?.hasPopup} .ariaLabel=${O} .ariaLabelledByElements=${this.aria?.labelledByElements} .ariaOwnsElements=${this.aria?.ownsElements} .ariaPressed=${this.aria?.pressed} class=${Fe(H)} id=${E??Ou} role=button tabindex=${this.disabled?null:0} ${hi(this.buttonEl)}>${re}</span>`:Ne`<button .ariaBusy=${o} .ariaControlsElements=${ge} .ariaDescribedByElements=${this.aria?.describedByElements} .ariaExpanded=${this.aria?.expanded} .ariaHasPopup=${this.aria?.hasPopup} .ariaLabel=${O} .ariaLabelledByElements=${this.aria?.labelledByElements} .ariaOwnsElements=${this.aria?.ownsElements} .ariaPressed=${this.aria?.pressed} class=${Fe(H)} .disabled=${i} id=${E??Ou} @click=${this.handleClick} ${hi(this.buttonEl)}>${re}</button>`}render(){return go({disabled:this.disabled,children:Ne`${this.renderButton()}<slot name=${$X.tooltip} @slotchange=${this.handleTooltipSlotChange}></slot>${this.renderIndicatorText()}`})}};w1.properties={aria:[0,{},{attribute:!1}],active:[7,{},{reflect:!0,type:Boolean}],activeDescendant:[7,{},{reflect:!0,type:Boolean}],alignment:[3,{},{reflect:!0}],appearance:[3,{},{reflect:!0}],compact:[7,{},{reflect:!0,type:Boolean}],disabled:[7,{},{reflect:!0,type:Boolean}],dragHandle:[7,{},{reflect:!0,type:Boolean}],form:[3,{},{reflect:!0}],icon:[3,{},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],indicator:[7,{},{reflect:!0,type:Boolean}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}],scale:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}],text:1,textEnabled:[7,{},{reflect:!0,type:Boolean}],type:[3,{},{reflect:!0}]},w1.styles=PX;let gC=w1;ar("calcite-action",gC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const hu={container:"container",containerNone:"container--none-selection",icon:"dropdown-item-icon",iconEnd:"dropdown-item-icon--end",iconStart:"dropdown-item-icon--start",itemContent:"dropdown-item-content",link:"dropdown-link"},CA={check:"check",bulletPoint:"bullet-point"};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const MX=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{position:relative;display:flex;flex-grow:1;align-items:center;outline-color:transparent}.container{position:relative;display:flex;flex-grow:1;cursor:pointer;align-items:center;text-decoration-line:none;color:var(--calcite-dropdown-item-text-color, var(--calcite-color-text-3));text-align:start;outline-color:transparent}.container a{outline:none;position:relative;display:flex;flex-grow:1;cursor:pointer;align-items:center;text-decoration-line:none;color:var(--calcite-dropdown-item-text-color, var(--calcite-color-text-3))}.dropdown-item-content{flex:1 1 auto;padding-block:.125rem}.dropdown-item-icon{position:relative;opacity:0;transition-timing-function:cubic-bezier(.4,0,.2,1);transform:scale(.9)}:host([scale=s]) .container{padding-block:.25rem;padding-inline:.5rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) .dropdown-item-icon,:host([scale=s]) .dropdown-item-icon--start{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .dropdown-item-icon--end{padding-inline-start:var(--calcite-spacing-sm)}:host([scale=m]) .container{padding-block:.5rem;padding-inline:.75rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) .dropdown-item-icon,:host([scale=m]) .dropdown-item-icon--start{padding-inline-end:var(--calcite-spacing-md)}:host([scale=m]) .dropdown-item-icon--end{padding-inline-start:var(--calcite-spacing-md)}:host([scale=l]) .container{padding-block:.625rem;padding-inline:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .dropdown-item-icon,:host([scale=l]) .dropdown-item-icon--start{padding-inline-end:var(--calcite-spacing-lg)}:host([scale=l]) .dropdown-item-icon--end{padding-inline-start:var(--calcite-spacing-lg)}:host(:focus) .container{text-decoration-line:none;outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host(:hover:not([disabled])) .container{background-color:var(--calcite-dropdown-item-background-color-hover, var(--calcite-color-foreground-2))}:host(:active:not([disabled])) .container{background-color:var(--calcite-dropdown-item-background-color-press, var(--calcite-color-foreground-3))}:host(:hover:not([disabled])) .container,:host(:active:not([disabled])) .container{text-decoration-line:none;color:var(--calcite-dropdown-item-text-color-press, var(--calcite-color-text-1))}:host(:hover:not([disabled])) .dropdown-link,:host(:active:not([disabled])) .dropdown-link{color:var(--calcite-dropdown-item-text-color-press, var(--calcite-color-text-1))}:host([selected]) .container:not(.container--none-selection),:host([selected]) .dropdown-link{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-dropdown-item-text-color-press, var(--calcite-color-text-1))}:host([selected]) .container:not(.container--none-selection) calcite-icon,:host([selected]) .dropdown-link calcite-icon{color:var(--calcite-dropdown-item-icon-color-press, var(--calcite-color-brand))}:host(:hover:not([disabled])) .dropdown-item-icon{color:var(--calcite-dropdown-item-icon-color-hover)}:host([selected]) .dropdown-item-icon{opacity:1}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}`,S1=class S1 extends ji{constructor(){super(),this.childLink=Yn(),this.focusSetter=zs()(this),this.disabled=!1,this.scale="m",this.selected=!1,this.selectionMode="single",this.calciteDropdownItemSelect=vt({cancelable:!1}),this.calciteInternalDropdownCloseRequest=vt({cancelable:!1}),this.calciteInternalDropdownItemKeyEvent=vt({cancelable:!1}),this.calciteInternalDropdownItemSelect=vt({cancelable:!1}),this.listen("click",this.onClick),this.listen("keydown",this.keyDownHandler),this.listenOn(document.body,"calciteInternalDropdownItemChange",this.updateActiveItemOnChange)}async setFocus(e){return this.focusSetter(()=>this.el,e)}connectedCallback(){super.connectedCallback(),this.initialize()}load(){this.initialize()}updated(){mo(this)}onClick(){this.emitRequestedItem()}keyDownHandler(e){switch(e.key){case" ":case"Enter":this.emitRequestedItem(),this.href&&this.childLink.value.click(),e.preventDefault();break;case"Escape":this.calciteInternalDropdownCloseRequest.emit(),e.preventDefault();break;case"Tab":this.calciteInternalDropdownItemKeyEvent.emit({keyboardEvent:e});break;case"ArrowUp":case"ArrowDown":case"Home":case"End":e.preventDefault(),this.calciteInternalDropdownItemKeyEvent.emit({keyboardEvent:e});break}}updateActiveItemOnChange(e){e.composedPath().includes(this.parentDropdownGroupEl)&&(this.requestedDropdownGroup=e.detail.requestedDropdownGroup,this.requestedDropdownItem=e.detail.requestedDropdownItem,this.determineActiveItem()),e.stopPropagation()}initialize(){this.parentDropdownGroupEl=this.el.closest("calcite-dropdown-group"),this.selectionMode==="none"&&(this.selected=!1)}determineActiveItem(){switch(this.selectionMode){case"multiple":this.el===this.requestedDropdownItem&&(this.selected=!this.selected);break;case"single":this.el===this.requestedDropdownItem?this.selected=!0:this.requestedDropdownGroup===this.parentDropdownGroupEl&&(this.selected=!1);break;case"none":this.selected=!1;break}}emitRequestedItem(){this.calciteDropdownItemSelect.emit(),this.calciteInternalDropdownItemSelect.emit({requestedDropdownItem:this.el,requestedDropdownGroup:this.parentDropdownGroupEl})}render(){const{href:e,selectionMode:i,label:r,iconFlipRtl:o}=this,h=Ne`<calcite-icon class=${Fe(hu.iconStart)} .flipRtl=${o==="start"||o==="both"} .icon=${this.iconStart} .scale=${Br(this.scale)}></calcite-icon>`,d=Ne`<span class=${Fe(hu.itemContent)}><slot></slot></span>`,a=Ne`<calcite-icon class=${Fe(hu.iconEnd)} .flipRtl=${o==="end"||o==="both"} .icon=${this.iconEnd} .scale=${Br(this.scale)}></calcite-icon>`,_=this.iconStart&&this.iconEnd?[h,d,a]:this.iconStart?[h,d]:this.iconEnd?[d,a]:d,T=e?Ne`<a .ariaLabel=${r} class=${Fe(hu.link)} href=${e??Ou} rel=${this.rel??Ou} tabindex=-1 target=${this.target??Ou} ${hi(this.childLink)}>${_}</a>`:_,E=e?null:i==="single"?"menuitemradio":i==="multiple"?"menuitemcheckbox":"menuitem",k=i!=="none"?Q1(this.selected):null,{disabled:L}=this;return this.el.ariaChecked=k,this.el.ariaLabel=e?"":r,this.el.role=E,X1(this.el,"tabIndex",L?-1:0),go({disabled:L,children:Ne`<div class=${Fe({[hu.container]:!0,[hu.containerNone]:i==="none"})}>${i!=="none"?Ne`<calcite-icon class=${Fe(hu.icon)} .icon=${i==="multiple"?CA.check:CA.bulletPoint} .scale=${Br(this.scale)}></calcite-icon>`:null}${T}</div>`})}};S1.properties={disabled:[7,{},{reflect:!0,type:Boolean}],href:[3,{},{reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],label:1,rel:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}],selected:[7,{},{reflect:!0,type:Boolean}],selectionMode:1,target:[3,{},{reflect:!0}]},S1.styles=MX;let yC=S1;ar("calcite-dropdown-item",yC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const EA={title:"dropdown-title",separator:"dropdown-separator"},kX=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{display:block}.container{text-align:start}.dropdown-title{margin-block-end:-1px;display:block;cursor:default;overflow-wrap:break-word;border-width:0px;border-block-end-width:1px;border-style:solid;font-weight:var(--calcite-font-weight-bold);border-color:var(--calcite-dropdown-group-border-color, var(--calcite-color-border-3));color:var(--calcite-dropdown-group-title-text-color, var(--calcite-color-text-2))}.dropdown-separator{display:block;block-size:1px;background-color:var(--calcite-dropdown-group-border-color, var(--calcite-color-border-3))}:host([scale=s]){font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) .dropdown-title{padding:.5rem}:host([scale=m]){font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) .dropdown-title{padding:.75rem}:host([scale=l]){font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .dropdown-title{padding:1rem}:host([hidden]){display:none}[hidden]{display:none}`,n0=class n0 extends ji{constructor(){super(),this.mutationObserver=qo("mutation",()=>this.updateItems()),this.position=-1,this.scale="m",this.selectionMode="single",this.calciteInternalDropdownItemChange=vt({cancelable:!1}),this.listen("calciteInternalDropdownItemSelect",this.updateActiveItemOnChange)}connectedCallback(){super.connectedCallback(),this.updateItems(),this.mutationObserver?.observe(this.el,{childList:!0})}willUpdate(e){e.has("selectionMode")&&(this.hasUpdated||this.selectionMode!=="single")&&this.updateItems()}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect()}updateActiveItemOnChange(e){this.requestedDropdownGroup=e.detail.requestedDropdownGroup,this.requestedDropdownItem=e.detail.requestedDropdownItem,this.calciteInternalDropdownItemChange.emit({requestedDropdownGroup:this.requestedDropdownGroup,requestedDropdownItem:this.requestedDropdownItem})}updateItems(){Array.from(this.el.querySelectorAll("calcite-dropdown-item")).forEach(e=>e.selectionMode=this.selectionMode)}render(){const e=this.groupTitle?Ne`<span aria-hidden=true class=${Fe(EA.title)}>${this.groupTitle}</span>`:null,i=this.position>0?Ne`<div class=${Fe(EA.separator)} role=separator></div>`:null;return this.el.ariaLabel=this.groupTitle,this.el.role="group",Ne`<div class=${Fe({[hu.container]:!0})}>${i}${e}<slot></slot></div>`}};n0.properties={groupTitle:[3,{},{reflect:!0}],position:[9,{},{type:Number}],scale:[3,{},{reflect:!0}],selectionMode:[3,{},{reflect:!0}]},n0.shadowRootOptions={mode:"open",delegatesFocus:!0},n0.styles=kX;let _C=n0;ar("calcite-dropdown-group",_C);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const IA={handle:"handle",dropdown:"dropdown"},$A={drag:"drag",blank:"blank"},DS={label:"{label}",position:"{position}",total:"{total}"},PA=["top","up","down","bottom"],AX={trigger:"trigger"},zS={add:"add",move:"move",reorder:"reorder"},DX=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex}.dropdown{block-size:100%}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}:host([hidden]){display:none}[hidden]{display:none}`,T1=class T1 extends ji{constructor(){super(...arguments),this.focusSetter=zs()(this),this.disabled=!1,this.messages=fo({blocking:!0}),this.addToItems=[],this.moveToItems=[],this.open=!1,this.overlayPositioning="absolute",this.placement=y0,this.scale="m",this.sortDisabled=!1,this.calciteSortHandleBeforeClose=vt({cancelable:!1}),this.calciteSortHandleBeforeOpen=vt({cancelable:!1}),this.calciteSortHandleClose=vt({cancelable:!1}),this.calciteSortHandleMove=vt({cancelable:!0}),this.calciteSortHandleAdd=vt({cancelable:!0}),this.calciteSortHandleOpen=vt({cancelable:!1}),this.calciteSortHandleReorder=vt({cancelable:!0})}get hasSetInfo(){return typeof this.setPosition=="number"&&typeof this.setSize=="number"}get hasValidSetInfo(){return this.hasSetInfo?this.setPosition>0&&this.setSize>1:!0}get hasReorderItems(){return!this.sortDisabled&&this.hasValidSetInfo}get hasNoItems(){return!this.hasReorderItems&&this.moveToItems.length<1&&this.addToItems.length<1}async setFocus(e){return this.focusSetter(()=>this.dropdownEl,e)}willUpdate(e){e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler()}updated(){mo(this)}openHandler(){if(this.disabled){this.open=!1;return}this.dropdownEl&&(this.dropdownEl.open=this.open)}setDropdownEl(e){e&&(this.dropdownEl=e,this.openHandler())}getLabel(){const{label:e,messages:i,setPosition:r,setSize:o,hasSetInfo:h}=this;if(!h)return e??"";let d=e?i.repositionLabel.replace(DS.label,e):i.reposition;return d=d.replace(DS.position,r?r.toString():""),d.replace(DS.total,o?o.toString():"")}handleBeforeOpen(e){e.stopPropagation(),this.calciteSortHandleBeforeOpen.emit()}handleOpen(e){e.stopPropagation(),this.calciteSortHandleOpen.emit(),this.open=!0}handleBeforeClose(e){e.stopPropagation(),this.calciteSortHandleBeforeClose.emit()}handleClose(e){e.stopPropagation(),this.calciteSortHandleClose.emit(),this.open=!1}handleReorder(e){this.calciteSortHandleReorder.emit({reorder:e.target.dataset.value})}handleMoveTo(e){const i=e.target.dataset.id,r=this.moveToItems.find(o=>o.id===i);this.calciteSortHandleMove.emit({moveTo:r})}handleAddTo(e){const i=e.target.dataset.id,r=this.addToItems.find(o=>o.id===i);this.calciteSortHandleAdd.emit({addTo:r})}render(){const{disabled:e,flipPlacements:i,open:r,overlayPositioning:o,placement:h,scale:d,widthScale:a,hasNoItems:_}=this,T=this.getLabel(),E=e||_;return go({disabled:e,children:Ne`<calcite-dropdown class=${Fe(IA.dropdown)} .disabled=${E} .flipPlacements=${i} @calciteDropdownBeforeClose=${this.handleBeforeClose} @calciteDropdownBeforeOpen=${this.handleBeforeOpen} @calciteDropdownClose=${this.handleClose} @calciteDropdownOpen=${this.handleOpen} .overlayPositioning=${o} .placement=${h} .scale=${d} .widthScale=${a} ${hi(this.setDropdownEl)}><calcite-action .active=${r} appearance=transparent .aria=${{expanded:r}} class=${Fe(IA.handle)} .dragHandle=${!0} .icon=${e?$A.blank:$A.drag} .label=${T} .scale=${d} slot=${AX.trigger} .text=${T} title=${T??ut}></calcite-action>${this.renderReorderGroup()}${this.renderMoveToGroup()}${this.renderAddToGroup()}</calcite-dropdown>`})}renderAddToItem(e){return ai(e.id,Ne`<calcite-dropdown-item data-id=${e.id??ut} .label=${e.label} @calciteDropdownItemSelect=${this.handleAddTo}>${e.label}</calcite-dropdown-item>`)}renderMoveToItem(e){return ai(e.id,Ne`<calcite-dropdown-item data-id=${e.id??ut} .label=${e.label} @calciteDropdownItemSelect=${this.handleMoveTo}>${e.label}</calcite-dropdown-item>`)}renderReorderGroup(){return this.hasReorderItems?ai("reorder",Ne`<calcite-dropdown-group .groupTitle=${this.messages.reorder} id=${zS.reorder} .scale=${this.scale} selection-mode=none>${this.renderTop()}${this.renderUp()}${this.renderDown()}${this.renderBottom()}</calcite-dropdown-group>`):null}renderAddToGroup(){const{messages:e,addToItems:i,scale:r}=this;return i.length?ai("add-to-items",Ne`<calcite-dropdown-group .groupTitle=${e.addTo} id=${zS.add} .scale=${r} selection-mode=none>${i.map(o=>this.renderAddToItem(o))}</calcite-dropdown-group>`):null}renderMoveToGroup(){const{messages:e,moveToItems:i,scale:r}=this;return i.length?ai("move-to-items",Ne`<calcite-dropdown-group .groupTitle=${e.moveTo} id=${zS.move} .scale=${r} selection-mode=none>${i.map(o=>this.renderMoveToItem(o))}</calcite-dropdown-group>`):null}renderDropdownItem(e,i){return ai(PA[e],Ne`<calcite-dropdown-item data-value=${PA[e]??ut} .label=${i} @calciteDropdownItemSelect=${this.handleReorder}>${i}</calcite-dropdown-item>`)}renderTop(){const{setPosition:e}=this;return e!==1&&e!==2?this.renderDropdownItem(0,this.messages.moveToTop):null}renderUp(){return this.setPosition!==1?this.renderDropdownItem(1,this.messages.moveUp):null}renderDown(){return this.setPosition!==this.setSize?this.renderDropdownItem(2,this.messages.moveDown):null}renderBottom(){const{setPosition:e,setSize:i}=this;return e!==i&&e!==i-1?this.renderDropdownItem(3,this.messages.moveToBottom):null}};T1.properties={disabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],label:1,messageOverrides:[0,{},{attribute:!1}],messages:[0,{},{attribute:!1}],addToItems:[0,{},{attribute:!1}],moveToItems:[0,{},{attribute:!1}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}],setPosition:[9,{},{type:Number}],setSize:[9,{},{type:Number}],sortDisabled:[7,{},{reflect:!0,type:Boolean}],widthScale:[3,{},{reflect:!0}]},T1.styles=DX;let vC=T1;ar("calcite-sort-handle",vC);/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const M$=Symbol.for(""),zX=t=>{if(t?.r===M$)return t?._$litStatic$},OX=t=>({_$litStatic$:t,r:M$}),v0=(t,...e)=>({_$litStatic$:e.reduce(((i,r,o)=>i+(h=>{if(h._$litStatic$!==void 0)return h._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${h}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(r)+t[o+1]),t[0]),r:M$}),MA=new Map,RX=t=>(e,...i)=>{const r=i.length;let o,h;const d=[],a=[];let _,T=0,E=!1;for(;T<r;){for(_=e[T];T<r&&(h=i[T],(o=zX(h))!==void 0);)_+=o+e[++T],E=!0;T!==r&&a.push(h),d.push(_),T++}if(T===r&&d.push(e[r]),E){const k=d.join("$$lit$$");(e=MA.get(k))===void 0&&(d.raw=d,MA.set(k,e=d)),i=a}return t(e,...i)},k$=RX(Ne);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const ZR=({children:t,...e})=>{const i=e.level?OX(`h${e.level}`):v0`div`;return ai(e.key,k$`<${i} class=${Fe(e.class)}>${t}</${i}>`)};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const kA={arrow:"calcite-floating-ui-arrow",arrowStroke:"calcite-floating-ui-arrow__stroke"},LX={width:12,height:6,strokeWidth:1},FX=({floatingLayout:t,key:e,ref:i})=>{const{width:r,height:o,strokeWidth:h}=LX,d=r/2,a=t==="vertical",_=`M0,0 H${r} L${r-d},${o} Q${d},${o} ${d},${o} Z`;return ai(e,Ne`<svg aria-hidden=true class=${Fe(kA.arrow)} height=${r} viewBox=${`0 0 ${r} ${r+(a?0:h)}`} width=${r+(a?h:0)} ${hi(i)}>${h0`${h0`<path class=${Fe(kA.arrowStroke)} d=${_??ut} fill=none stroke-width=${h+1} />`||""}<path d=${_??ut} stroke=none />`}</svg>`)};/*!
* tabbable 6.3.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var WR=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],Mx=WR.join(","),YR=typeof Element>"u",bd=YR?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,kx=!YR&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t?.ownerDocument},b0=function(e,i){var r;i===void 0&&(i=!0);var o=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"inert"),h=o===""||o==="true",d=h||i&&e&&b0(e.parentNode);return d},NX=function(e){var i,r=e==null||(i=e.getAttribute)===null||i===void 0?void 0:i.call(e,"contenteditable");return r===""||r==="true"},XR=function(e,i,r){if(b0(e))return[];var o=Array.prototype.slice.apply(e.querySelectorAll(Mx));return i&&bd.call(e,Mx)&&o.unshift(e),o=o.filter(r),o},Ax=function(e,i,r){for(var o=[],h=Array.from(e);h.length;){var d=h.shift();if(!b0(d,!1))if(d.tagName==="SLOT"){var a=d.assignedElements(),_=a.length?a:d.children,T=Ax(_,!0,r);r.flatten?o.push.apply(o,T):o.push({scopeParent:d,candidates:T})}else{var E=bd.call(d,Mx);E&&r.filter(d)&&(i||!e.includes(d))&&o.push(d);var k=d.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(d),L=!b0(k,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(d));if(k&&L){var O=Ax(k===!0?d.children:k.children,!0,r);r.flatten?o.push.apply(o,O):o.push({scopeParent:d,candidates:O})}else h.unshift.apply(h,d.children)}}return o},JR=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},Jh=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||NX(e))&&!JR(e)?0:e.tabIndex},BX=function(e,i){var r=Jh(e);return r<0&&i&&!JR(e)?0:r},jX=function(e,i){return e.tabIndex===i.tabIndex?e.documentOrder-i.documentOrder:e.tabIndex-i.tabIndex},KR=function(e){return e.tagName==="INPUT"},UX=function(e){return KR(e)&&e.type==="hidden"},VX=function(e){var i=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(r){return r.tagName==="SUMMARY"});return i},GX=function(e,i){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===i)return e[r]},qX=function(e){if(!e.name)return!0;var i=e.form||kx(e),r=function(a){return i.querySelectorAll('input[type="radio"][name="'+a+'"]')},o;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")o=r(window.CSS.escape(e.name));else try{o=r(e.name)}catch(d){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",d.message),!1}var h=GX(o,e.form);return!h||h===e},HX=function(e){return KR(e)&&e.type==="radio"},ZX=function(e){return HX(e)&&!qX(e)},WX=function(e){var i,r=e&&kx(e),o=(i=r)===null||i===void 0?void 0:i.host,h=!1;if(r&&r!==e){var d,a,_;for(h=!!((d=o)!==null&&d!==void 0&&(a=d.ownerDocument)!==null&&a!==void 0&&a.contains(o)||e!=null&&(_=e.ownerDocument)!==null&&_!==void 0&&_.contains(e));!h&&o;){var T,E,k;r=kx(o),o=(T=r)===null||T===void 0?void 0:T.host,h=!!((E=o)!==null&&E!==void 0&&(k=E.ownerDocument)!==null&&k!==void 0&&k.contains(o))}}return h},AA=function(e){var i=e.getBoundingClientRect(),r=i.width,o=i.height;return r===0&&o===0},YX=function(e,i){var r=i.displayCheck,o=i.getShadowRoot;if(r==="full-native"&&"checkVisibility"in e){var h=e.checkVisibility({checkOpacity:!1,opacityProperty:!1,contentVisibilityAuto:!0,visibilityProperty:!0,checkVisibilityCSS:!0});return!h}if(getComputedStyle(e).visibility==="hidden")return!0;var d=bd.call(e,"details>summary:first-of-type"),a=d?e.parentElement:e;if(bd.call(a,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="full-native"||r==="legacy-full"){if(typeof o=="function"){for(var _=e;e;){var T=e.parentElement,E=kx(e);if(T&&!T.shadowRoot&&o(T)===!0)return AA(e);e.assignedSlot?e=e.assignedSlot:!T&&E!==e.ownerDocument?e=E.host:e=T}e=_}if(WX(e))return!e.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return AA(e);return!1},XX=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var i=e.parentElement;i;){if(i.tagName==="FIELDSET"&&i.disabled){for(var r=0;r<i.children.length;r++){var o=i.children.item(r);if(o.tagName==="LEGEND")return bd.call(i,"fieldset[disabled] *")?!0:!o.contains(e)}return!0}i=i.parentElement}return!1},Dx=function(e,i){return!(i.disabled||b0(i)||UX(i)||YX(i,e)||VX(i)||XX(i))},bC=function(e,i){return!(ZX(i)||Jh(i)<0||!Dx(e,i))},JX=function(e){var i=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(i)||i>=0)},QR=function(e){var i=[],r=[];return e.forEach(function(o,h){var d=!!o.scopeParent,a=d?o.scopeParent:o,_=BX(a,d),T=d?QR(o.candidates):a;_===0?d?i.push.apply(i,T):i.push(a):r.push({documentOrder:h,tabIndex:_,item:o,isScope:d,content:T})}),r.sort(jX).reduce(function(o,h){return h.isScope?o.push.apply(o,h.content):o.push(h.content),o},[]).concat(i)},KX=function(e,i){i=i||{};var r;return i.getShadowRoot?r=Ax([e],i.includeContainer,{filter:bC.bind(null,i),flatten:!1,getShadowRoot:i.getShadowRoot,shadowRootFilter:JX}):r=XR(e,i.includeContainer,bC.bind(null,i)),QR(r)},QX=function(e,i){i=i||{};var r;return i.getShadowRoot?r=Ax([e],i.includeContainer,{filter:Dx.bind(null,i),flatten:!0,getShadowRoot:i.getShadowRoot}):r=XR(e,i.includeContainer,Dx.bind(null,i)),r},Fp=function(e,i){if(i=i||{},!e)throw new Error("No node provided");return bd.call(e,Mx)===!1?!1:bC(i,e)},eJ=WR.concat("iframe").join(","),OS=function(e,i){if(i=i||{},!e)throw new Error("No node provided");return bd.call(e,eJ)===!1?!1:Dx(i,e)};/*!
* focus-trap 7.6.6
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function xC(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function tJ(t){if(Array.isArray(t))return xC(t)}function iJ(t,e,i){return(e=aJ(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function rJ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function nJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DA(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,r)}return i}function zA(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?DA(Object(i),!0).forEach(function(r){iJ(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):DA(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function sJ(t){return tJ(t)||rJ(t)||lJ(t)||nJ()}function oJ(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aJ(t){var e=oJ(t,"string");return typeof e=="symbol"?e:e+""}function lJ(t,e){if(t){if(typeof t=="string")return xC(t,e);var i={}.toString.call(t).slice(8,-1);return i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set"?Array.from(t):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?xC(t,e):void 0}}var OA={activateTrap:function(e,i){if(e.length>0){var r=e[e.length-1];r!==i&&r._setPausedState(!0)}var o=e.indexOf(i);o===-1||e.splice(o,1),e.push(i)},deactivateTrap:function(e,i){var r=e.indexOf(i);r!==-1&&e.splice(r,1),e.length>0&&!e[e.length-1]._isManuallyPaused()&&e[e.length-1]._setPausedState(!1)}},cJ=function(e){return e.tagName&&e.tagName.toLowerCase()==="input"&&typeof e.select=="function"},uJ=function(e){return e?.key==="Escape"||e?.key==="Esc"||e?.keyCode===27},Fy=function(e){return e?.key==="Tab"||e?.keyCode===9},hJ=function(e){return Fy(e)&&!e.shiftKey},dJ=function(e){return Fy(e)&&e.shiftKey},RA=function(e){return setTimeout(e,0)},Yg=function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return typeof e=="function"?e.apply(void 0,r):e},Dv=function(e){return e.target.shadowRoot&&typeof e.composedPath=="function"?e.composedPath()[0]:e.target},pJ=[],fJ=function(e,i){var r=i?.document||document,o=i?.trapStack||pJ,h=zA({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:hJ,isKeyBackward:dJ},i),d={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,manuallyPaused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},a,_=function(Ce,Ee,st){return Ce&&Ce[Ee]!==void 0?Ce[Ee]:h[st||Ee]},T=function(Ce,Ee){var st=typeof Ee?.composedPath=="function"?Ee.composedPath():void 0;return d.containerGroups.findIndex(function(_t){var ht=_t.container,nt=_t.tabbableNodes;return ht.contains(Ce)||st?.includes(ht)||nt.find(function(rt){return rt===Ce})})},E=function(Ce){var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},st=Ee.hasFallback,_t=st===void 0?!1:st,ht=Ee.params,nt=ht===void 0?[]:ht,rt=h[Ce];if(typeof rt=="function"&&(rt=rt.apply(void 0,sJ(nt))),rt===!0&&(rt=void 0),!rt){if(rt===void 0||rt===!1)return rt;throw new Error("`".concat(Ce,"` was specified but was not a node, or did not return a node"))}var Wt=rt;if(typeof rt=="string"){try{Wt=r.querySelector(rt)}catch(ei){throw new Error("`".concat(Ce,'` appears to be an invalid selector; error="').concat(ei.message,'"'))}if(!Wt&&!_t)throw new Error("`".concat(Ce,"` as selector refers to no known node"))}return Wt},k=function(){var Ce=E("initialFocus",{hasFallback:!0});if(Ce===!1)return!1;if(Ce===void 0||Ce&&!OS(Ce,h.tabbableOptions))if(T(r.activeElement)>=0)Ce=r.activeElement;else{var Ee=d.tabbableGroups[0],st=Ee&&Ee.firstTabbableNode;Ce=st||E("fallbackFocus")}else Ce===null&&(Ce=E("fallbackFocus"));if(!Ce)throw new Error("Your focus-trap needs to have at least one focusable element");return Ce},L=function(){if(d.containerGroups=d.containers.map(function(Ce){var Ee=KX(Ce,h.tabbableOptions),st=QX(Ce,h.tabbableOptions),_t=Ee.length>0?Ee[0]:void 0,ht=Ee.length>0?Ee[Ee.length-1]:void 0,nt=st.find(function(ei){return Fp(ei)}),rt=st.slice().reverse().find(function(ei){return Fp(ei)}),Wt=!!Ee.find(function(ei){return Jh(ei)>0});return{container:Ce,tabbableNodes:Ee,focusableNodes:st,posTabIndexesFound:Wt,firstTabbableNode:_t,lastTabbableNode:ht,firstDomTabbableNode:nt,lastDomTabbableNode:rt,nextTabbableNode:function(en){var hn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,tn=Ee.indexOf(en);return tn<0?hn?st.slice(st.indexOf(en)+1).find(function(Qn){return Fp(Qn)}):st.slice(0,st.indexOf(en)).reverse().find(function(Qn){return Fp(Qn)}):Ee[tn+(hn?1:-1)]}}}),d.tabbableGroups=d.containerGroups.filter(function(Ce){return Ce.tabbableNodes.length>0}),d.tabbableGroups.length<=0&&!E("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(d.containerGroups.find(function(Ce){return Ce.posTabIndexesFound})&&d.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},O=function(Ce){var Ee=Ce.activeElement;if(Ee)return Ee.shadowRoot&&Ee.shadowRoot.activeElement!==null?O(Ee.shadowRoot):Ee},H=function(Ce){if(Ce!==!1&&Ce!==O(document)){if(!Ce||!Ce.focus){H(k());return}Ce.focus({preventScroll:!!h.preventScroll}),d.mostRecentlyFocusedNode=Ce,cJ(Ce)&&Ce.select()}},re=function(Ce){var Ee=E("setReturnFocus",{params:[Ce]});return Ee||(Ee===!1?!1:Ce)},pe=function(Ce){var Ee=Ce.target,st=Ce.event,_t=Ce.isBackward,ht=_t===void 0?!1:_t;Ee=Ee||Dv(st),L();var nt=null;if(d.tabbableGroups.length>0){var rt=T(Ee,st),Wt=rt>=0?d.containerGroups[rt]:void 0;if(rt<0)ht?nt=d.tabbableGroups[d.tabbableGroups.length-1].lastTabbableNode:nt=d.tabbableGroups[0].firstTabbableNode;else if(ht){var ei=d.tabbableGroups.findIndex(function(_o){var dn=_o.firstTabbableNode;return Ee===dn});if(ei<0&&(Wt.container===Ee||OS(Ee,h.tabbableOptions)&&!Fp(Ee,h.tabbableOptions)&&!Wt.nextTabbableNode(Ee,!1))&&(ei=rt),ei>=0){var en=ei===0?d.tabbableGroups.length-1:ei-1,hn=d.tabbableGroups[en];nt=Jh(Ee)>=0?hn.lastTabbableNode:hn.lastDomTabbableNode}else Fy(st)||(nt=Wt.nextTabbableNode(Ee,!1))}else{var tn=d.tabbableGroups.findIndex(function(_o){var dn=_o.lastTabbableNode;return Ee===dn});if(tn<0&&(Wt.container===Ee||OS(Ee,h.tabbableOptions)&&!Fp(Ee,h.tabbableOptions)&&!Wt.nextTabbableNode(Ee))&&(tn=rt),tn>=0){var Qn=tn===d.tabbableGroups.length-1?0:tn+1,rn=d.tabbableGroups[Qn];nt=Jh(Ee)>=0?rn.firstTabbableNode:rn.firstDomTabbableNode}else Fy(st)||(nt=Wt.nextTabbableNode(Ee))}}else nt=E("fallbackFocus");return nt},ge=function(Ce){var Ee=Dv(Ce);if(!(T(Ee,Ce)>=0)){if(Yg(h.clickOutsideDeactivates,Ce)){a.deactivate({returnFocus:h.returnFocusOnDeactivate});return}Yg(h.allowOutsideClick,Ce)||Ce.preventDefault()}},Se=function(Ce){var Ee=Dv(Ce),st=T(Ee,Ce)>=0;if(st||Ee instanceof Document)st&&(d.mostRecentlyFocusedNode=Ee);else{Ce.stopImmediatePropagation();var _t,ht=!0;if(d.mostRecentlyFocusedNode)if(Jh(d.mostRecentlyFocusedNode)>0){var nt=T(d.mostRecentlyFocusedNode),rt=d.containerGroups[nt].tabbableNodes;if(rt.length>0){var Wt=rt.findIndex(function(ei){return ei===d.mostRecentlyFocusedNode});Wt>=0&&(h.isKeyForward(d.recentNavEvent)?Wt+1<rt.length&&(_t=rt[Wt+1],ht=!1):Wt-1>=0&&(_t=rt[Wt-1],ht=!1))}}else d.containerGroups.some(function(ei){return ei.tabbableNodes.some(function(en){return Jh(en)>0})})||(ht=!1);else ht=!1;ht&&(_t=pe({target:d.mostRecentlyFocusedNode,isBackward:h.isKeyBackward(d.recentNavEvent)})),H(_t||d.mostRecentlyFocusedNode||k())}d.recentNavEvent=void 0},Pe=function(Ce){var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;d.recentNavEvent=Ce;var st=pe({event:Ce,isBackward:Ee});st&&(Fy(Ce)&&Ce.preventDefault(),H(st))},Re=function(Ce){(h.isKeyForward(Ce)||h.isKeyBackward(Ce))&&Pe(Ce,h.isKeyBackward(Ce))},ze=function(Ce){uJ(Ce)&&Yg(h.escapeDeactivates,Ce)!==!1&&(Ce.preventDefault(),a.deactivate())},Je=function(Ce){var Ee=Dv(Ce);T(Ee,Ce)>=0||Yg(h.clickOutsideDeactivates,Ce)||Yg(h.allowOutsideClick,Ce)||(Ce.preventDefault(),Ce.stopImmediatePropagation())},Xe=function(){if(d.active)return OA.activateTrap(o,a),d.delayInitialFocusTimer=h.delayInitialFocus?RA(function(){H(k())}):H(k()),r.addEventListener("focusin",Se,!0),r.addEventListener("mousedown",ge,{capture:!0,passive:!1}),r.addEventListener("touchstart",ge,{capture:!0,passive:!1}),r.addEventListener("click",Je,{capture:!0,passive:!1}),r.addEventListener("keydown",Re,{capture:!0,passive:!1}),r.addEventListener("keydown",ze),a},yt=function(){if(d.active)return r.removeEventListener("focusin",Se,!0),r.removeEventListener("mousedown",ge,!0),r.removeEventListener("touchstart",ge,!0),r.removeEventListener("click",Je,!0),r.removeEventListener("keydown",Re,!0),r.removeEventListener("keydown",ze),a},mt=function(Ce){var Ee=Ce.some(function(st){var _t=Array.from(st.removedNodes);return _t.some(function(ht){return ht===d.mostRecentlyFocusedNode})});Ee&&H(k())},je=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(mt):void 0,ke=function(){je&&(je.disconnect(),d.active&&!d.paused&&d.containers.map(function(Ce){je.observe(Ce,{subtree:!0,childList:!0})}))};return a={get active(){return d.active},get paused(){return d.paused},activate:function(Ce){if(d.active)return this;var Ee=_(Ce,"onActivate"),st=_(Ce,"onPostActivate"),_t=_(Ce,"checkCanFocusTrap");_t||L(),d.active=!0,d.paused=!1,d.nodeFocusedBeforeActivation=O(r),Ee?.();var ht=function(){_t&&L(),Xe(),ke(),st?.()};return _t?(_t(d.containers.concat()).then(ht,ht),this):(ht(),this)},deactivate:function(Ce){if(!d.active)return this;var Ee=zA({onDeactivate:h.onDeactivate,onPostDeactivate:h.onPostDeactivate,checkCanReturnFocus:h.checkCanReturnFocus},Ce);clearTimeout(d.delayInitialFocusTimer),d.delayInitialFocusTimer=void 0,yt(),d.active=!1,d.paused=!1,ke(),OA.deactivateTrap(o,a);var st=_(Ee,"onDeactivate"),_t=_(Ee,"onPostDeactivate"),ht=_(Ee,"checkCanReturnFocus"),nt=_(Ee,"returnFocus","returnFocusOnDeactivate");st?.();var rt=function(){RA(function(){nt&&H(re(d.nodeFocusedBeforeActivation)),_t?.()})};return nt&&ht?(ht(re(d.nodeFocusedBeforeActivation)).then(rt,rt),this):(rt(),this)},pause:function(Ce){return d.active?(d.manuallyPaused=!0,this._setPausedState(!0,Ce)):this},unpause:function(Ce){return d.active?(d.manuallyPaused=!1,o[o.length-1]!==this?this:this._setPausedState(!1,Ce)):this},updateContainerElements:function(Ce){var Ee=[].concat(Ce).filter(Boolean);return d.containers=Ee.map(function(st){return typeof st=="string"?r.querySelector(st):st}),d.active&&L(),ke(),this}},Object.defineProperties(a,{_isManuallyPaused:{value:function(){return d.manuallyPaused}},_setPausedState:{value:function(Ce,Ee){if(d.paused===Ce)return this;if(d.paused=Ce,Ce){var st=_(Ee,"onPause"),_t=_(Ee,"onPostPause");st?.(),yt(),ke(),_t?.()}else{var ht=_(Ee,"onUnpause"),nt=_(Ee,"onPostUnpause");ht?.(),L(),Xe(),ke(),nt?.()}return this}}}),a.updateContainerElements(e),a};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const hb=new WeakSet;function mJ(t,e){return hb.has(t)||f0(e),!1}function gJ(t,e){const i=e?.fallbackFocus||t,r=e?.clickOutsideDeactivates??!0;return{fallbackFocus:i,...e,document:t.ownerDocument,tabbableOptions:v$,trapStack:GZ,clickOutsideDeactivates:o=>(hb.has(t)||hb.add(t),typeof r=="function"?r(o):r),onPostDeactivate:()=>{hb.delete(t)},setReturnFocus:o=>{const h=typeof e?.setReturnFocus=="function"?e.setReturnFocus(o):e?.setReturnFocus;return h===void 0?mJ(t,o):h}}}function LA(t,{focusTrapOptions:e},i){return!e?.extraContainers&&!i?t:[t,...FA(e?.extraContainers),...FA(i)]}function FA(t=[]){return Array.isArray(t)?t:[t]}const yJ=t=>y$((e,i)=>{let r,o,h;const d=t.focusTrapOptions;i.onConnected(()=>{e[t.triggerProp]&&r&&a.activate()}),i.onUpdate(_=>{e.hasUpdated&&_.has("focusTrapDisabled")&&(e.focusTrapDisabled?a.deactivate():a.activate())}),i.onDisconnected(()=>a.deactivate());const a={activate:()=>{const _=o||e.el;if(_.isConnected){if(!r){const T={...d,...e.focusTrapOptions};h||=LA(_,e),r=fJ(h,gJ(_,T))}(typeof e.focusTrapDisabledOverride=="function"?!e.focusTrapDisabledOverride():!e.focusTrapDisabled)&&r.activate()}},deactivate:()=>r?.deactivate(),overrideFocusTrapEl:_=>{if(r)throw new Error("Focus trap already created");o=_},setExtraContainers:_=>{const T=o||e.el;h=LA(T,e,_)},updateContainerElements:()=>r?.updateContainerElements(h)};return a});/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const _J=5;function vJ({startX:t,startY:e,endX:i,endY:r}){return Math.hypot(i-t,r-e)>_J}class bJ{constructor(){this.registeredElements=new Map,this.registeredElementCount=0,this.queryPopover=e=>{const{registeredElements:i}=this,r=e.find(o=>i.has(o));return i.get(r)},this.togglePopovers=e=>{const i=e.composedPath(),r=this.queryPopover(i);r&&!r.triggerDisabled&&(r.open=!r.open),Array.from(this.registeredElements.values()).filter(o=>o!==r&&o.autoClose&&o.open&&!i.includes(o)).forEach(o=>o.open=!1)},this.keyDownHandler=e=>{e.defaultPrevented||(e.key==="Escape"?this.closeAllPopovers():E$(e.key)&&this.togglePopovers(e))},this.pointerDownHandler=e=>{if(e.defaultPrevented||!yR(e))return;const{clientX:i,clientY:r}=e;this.pointerDownPosition={x:i,y:r}},this.clickHandler=e=>{GW(e)||e.defaultPrevented||this.pointerDownPosition&&vJ({endY:e.clientY,endX:e.clientX,startY:this.pointerDownPosition.y,startX:this.pointerDownPosition.x})||(this.pointerDownPosition=void 0,this.togglePopovers(e))}}registerElement(e,i){this.registeredElementCount++,this.registeredElements.set(e,i),this.registeredElementCount===1&&this.addListeners()}unregisterElement(e){this.registeredElements.delete(e)&&this.registeredElementCount--,this.registeredElementCount===0&&this.removeListeners()}closeAllPopovers(){Array.from(this.registeredElements.values()).forEach(e=>e.open=!1)}addListeners(){window.addEventListener("pointerdown",this.pointerDownHandler),window.addEventListener("click",this.clickHandler),window.addEventListener("keydown",this.keyDownHandler)}removeListeners(){window.removeEventListener("pointerdown",this.pointerDownHandler),window.removeEventListener("click",this.clickHandler),window.removeEventListener("keydown",this.keyDownHandler)}}const oa={positionContainer:"position-container",container:"container",closeButtonContainer:"close-button-container",closeButton:"close-button",content:"content",hasHeader:"has-header",header:"header",headerContainer:"header-container",heading:"heading"},NA="auto",BA="aria-controls",jA="aria-expanded",xJ=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{display:contents;--calcite-floating-ui-z-index: var(--calcite-popover-z-index, var(--calcite-z-index-popup))}.position-container{inline-size:max-content;display:none;max-inline-size:100vw;max-block-size:100vh;inset-block-start:0;left:0;z-index:var(--calcite-floating-ui-z-index)}@starting-style{.position-container{opacity:0;inset-block-start:0;left:0}}.position-container{max-inline-size:var(--calcite-popover-max-size-x, 100vw)}.position-container .calcite-floating-ui-anim{position:relative;transition-duration:var(--calcite-floating-ui-transition);transition-property:inset-block-start,left,opacity,display;transition-behavior:allow-discrete;opacity:0;box-shadow:0 0 16px #00000029;z-index:var(--calcite-z-index);border-radius:.25rem}.position-container[data-placement^=bottom] .calcite-floating-ui-anim{inset-block-start:-5px}.position-container[data-placement^=top] .calcite-floating-ui-anim{inset-block-start:5px}.position-container[data-placement^=left] .calcite-floating-ui-anim{left:5px}.position-container[data-placement^=right] .calcite-floating-ui-anim{left:-5px}.position-container[data-placement] .calcite-floating-ui-anim--active{opacity:1;inset-block-start:0;left:0}@starting-style{.position-container[data-placement] .calcite-floating-ui-anim--active{opacity:0}}.calcite-floating-ui-arrow{pointer-events:none;position:absolute;z-index:calc(var(--calcite-z-index) * -1);fill:var(--calcite-color-foreground-1)}.calcite-floating-ui-arrow__stroke{stroke:var(--calcite-color-border-3)}:host([scale=s]) .heading{padding:.5rem .75rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=m]) .heading{padding:.75rem 1rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([scale=l]) .heading{padding:1rem 1.25rem;font-size:var(--calcite-font-size-1);line-height:1.375}.position-container .calcite-floating-ui-anim{border-width:1px;border-style:solid;background-color:var(--calcite-popover-background-color, var(--calcite-color-foreground-1));border-color:var(--calcite-popover-border-color, var(--calcite-color-border-3));border-radius:var(--calcite-popover-corner-radius, var(--calcite-corner-radius-round))}.calcite-floating-ui-arrow{fill:var(--calcite-popover-background-color, var(--calcite-color-foreground-1))}.calcite-floating-ui-arrow__stroke{stroke:var(--calcite-popover-border-color, var(--calcite-color-border-3))}.header{display:flex;flex:1 1 auto;align-items:stretch;justify-content:flex-start;border-width:0px;border-bottom-width:1px;border-style:solid;border-block-end-color:var(--calcite-popover-border-color, var(--calcite-color-border-3))}.heading{margin:0;display:block;flex:1 1 auto;align-self:center;white-space:normal;font-weight:var(--calcite-font-weight-medium);word-wrap:break-word;word-break:break-word;color:var(--calcite-popover-text-color, var(--calcite-color-text-1))}.header-container{position:relative;display:flex;height:100%;flex-direction:row;flex-wrap:nowrap;border-radius:.25rem;color:var(--calcite-popover-text-color, var(--calcite-color-text-1))}.header-container.has-header{flex-direction:column}.content{display:flex;height:100%;width:100%;flex-direction:column;flex-wrap:nowrap;align-self:center;word-wrap:break-word;word-break:break-word}.close-button-container{display:flex;overflow:hidden;flex:0 0 auto;border-start-end-radius:var(--calcite-popover-corner-radius, var(--calcite-corner-radius-round));border-end-end-radius:var(--calcite-popover-corner-radius, var(--calcite-corner-radius-round));--calcite-action-corner-radius-start-end: var(--calcite-popover-corner-radius, var(--calcite-corner-radius-sharp));--calcite-action-corner-radius-end-end: var(--calcite-popover-corner-radius, var(--calcite-corner-radius-sharp))}::slotted(calcite-panel),::slotted(calcite-flow){height:100%}:host([hidden]){display:none}[hidden]{display:none}`,UA=new bJ,C1=class C1 extends ji{constructor(){super(...arguments),this.focusTrap=yJ({triggerProp:"open",focusTrapOptions:{allowOutsideClick:!0,escapeDeactivates:e=>(e.defaultPrevented||(this.open=!1,e.preventDefault()),!1)}})(this),this.guid=`calcite-popover-${Hu()}`,this.hasLoaded=!1,this.mutationObserver=qo("mutation",()=>this.focusTrap.updateContainerElements()),this.transitionProp="opacity",this.messages=fo(),this.focusSetter=zs()(this),this.floatingLayout="vertical",this.autoClose=!1,this.closable=!1,this.flipDisabled=!1,this.focusTrapDisabled=!1,this.offsetDistance=_A,this.offsetSkidding=0,this.open=!1,this.overlayPositioning="absolute",this.placement=NA,this.pointerDisabled=!1,this.scale="m",this.triggerDisabled=!1,this.calcitePopoverBeforeClose=vt({cancelable:!1}),this.calcitePopoverBeforeOpen=vt({cancelable:!1}),this.calcitePopoverClose=vt({cancelable:!1}),this.calcitePopoverOpen=vt({cancelable:!1})}async reposition(e=!1){const{referenceEl:i,placement:r,overlayPositioning:o,flipDisabled:h,filteredFlipPlacements:d,offsetDistance:a,offsetSkidding:_,arrowEl:T,floatingEl:E}=this;return T$(this,{floatingEl:E,referenceEl:i,overlayPositioning:o,placement:r,flipDisabled:h,flipPlacements:d,offsetDistance:a,offsetSkidding:_,arrowEl:T,type:"popover"},e)}async setFocus(e){return this.focusSetter(()=>this.el,e)}async updateFocusTrapElements(){this.focusTrap.updateContainerElements()}connectedCallback(){super.connectedCallback(),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0}),this.setFilteredPlacements(),requestAnimationFrame(()=>this.setUpReferenceElement(this.hasLoaded))}willUpdate(e){e.has("flipPlacements")&&this.flipPlacementsHandler(),e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler(),(e.has("offsetDistance")&&(this.hasUpdated||this.offsetDistance!==_A)||e.has("offsetSkidding")&&(this.hasUpdated||this.offsetSkidding!==0)||e.has("overlayPositioning")&&(this.hasUpdated||this.overlayPositioning!=="absolute")||e.has("placement")&&(this.hasUpdated||this.placement!==NA))&&this.reposition(!0),e.has("referenceElement")&&this.referenceElementHandler()}loaded(){this.referenceElement&&!this.referenceEl&&this.setUpReferenceElement(),this.hasLoaded=!0}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.removeReferences(),ow(this)}flipPlacementsHandler(){this.setFilteredPlacements(),this.reposition(!0)}openHandler(){Y0(this),this.reposition(!0),this.setExpandedAttr()}referenceElementHandler(){this.setUpReferenceElement(),this.reposition(!0)}setFloatingEl(e){this.floatingEl=e,e&&requestAnimationFrame(()=>this.setUpReferenceElement())}setTransitionEl(e){e&&(this.transitionEl=e)}setFilteredPlacements(){const{el:e,flipPlacements:i}=this;this.filteredFlipPlacements=i?RR(i,e):null}setUpReferenceElement(e=!0){this.removeReferences(),this.referenceEl=this.getReferenceElement(),dc(this);const{el:i,referenceElement:r,referenceEl:o}=this;e&&r&&!o&&console.warn(`${i.tagName}: reference-element id "${r}" was not found.`,{el:i}),this.addReferences()}getId(){return this.el.id||this.guid}setExpandedAttr(){const{referenceEl:e,open:i}=this;e&&"setAttribute"in e&&e.setAttribute(jA,Q1(i))}addReferences(){const{referenceEl:e}=this;if(!e)return;const i=this.getId();"setAttribute"in e&&e.setAttribute(BA,i),UA.registerElement(e,this.el),this.setExpandedAttr()}removeReferences(){const{referenceEl:e}=this;e&&("removeAttribute"in e&&(e.removeAttribute(BA),e.removeAttribute(jA)),UA.unregisterElement(e))}getReferenceElement(){const{referenceElement:e,el:i}=this;return(typeof e=="string"?K1(i,{id:e}):e)||null}hide(){this.open=!1}onBeforeOpen(){this.calcitePopoverBeforeOpen.emit()}onOpen(){this.calcitePopoverOpen.emit(),this.focusTrap.activate()}onBeforeClose(){this.calcitePopoverBeforeClose.emit()}onClose(){this.calcitePopoverClose.emit(),C$(this),this.focusTrap.deactivate()}storeArrowEl(e){this.arrowEl=e,this.reposition(!0)}renderCloseButton(){const{messages:e,closable:i}=this;return i?ai(oa.closeButtonContainer,Ne`<div class=${Fe(oa.closeButtonContainer)}><calcite-action appearance=transparent class=${Fe(oa.closeButton)} @click=${this.hide} .scale=${this.scale} .text=${e.close}><calcite-icon icon=x .scale=${Br(this.scale)}></calcite-icon></calcite-action></div>`):null}renderHeader(){const{heading:e,headingLevel:i}=this,r=e?ZR({class:oa.heading,level:i,children:e}):null;return r?ai(oa.header,Ne`<div class=${Fe(oa.header)}>${r}${this.renderCloseButton()}</div>`):null}render(){const{referenceEl:e,heading:i,label:r,open:o,pointerDisabled:h,floatingLayout:d}=this,a=e&&o,_=!a,T=h?null:ai("floating-arrow",FX({floatingLayout:d,ref:this.storeArrowEl}));return this.el.inert=_,this.el.ariaLabel=r,this.el.ariaLive="polite",X1(this.el,"id",this.getId()),this.el.role="dialog",Ne`<div class=${Fe(oa.positionContainer)} ${hi(this.setFloatingEl)}><div class=${Fe({[oa.container]:!0,[rm.animation]:!0,[rm.animationActive]:a})} ${hi(this.setTransitionEl)}>${T}<div class=${Fe({[oa.hasHeader]:!!i,[oa.headerContainer]:!0})}>${this.renderHeader()}<div class=${Fe(oa.content)}><slot></slot></div>${i?null:this.renderCloseButton()}</div></div></div>`}};C1.properties={floatingLayout:[16,{},{state:!0}],referenceEl:[16,{},{state:!0}],autoClose:[7,{},{reflect:!0,type:Boolean}],closable:[7,{},{reflect:!0,type:Boolean}],flipDisabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],focusTrapDisabled:[7,{},{reflect:!0,type:Boolean}],focusTrapOptions:[0,{},{attribute:!1}],heading:1,headingLevel:[11,{},{type:Number,reflect:!0}],label:1,messageOverrides:[0,{},{attribute:!1}],offsetDistance:[11,{},{type:Number,reflect:!0}],offsetSkidding:[11,{},{reflect:!0,type:Number}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],pointerDisabled:[7,{},{reflect:!0,type:Boolean}],referenceElement:1,scale:[3,{},{reflect:!0}],triggerDisabled:[7,{},{reflect:!0,type:Boolean}]},C1.styles=xJ;let wC=C1;ar("calcite-popover",wC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function VA(t,e){return(t+e)%e}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const GA={menu:"menu",defaultTrigger:"default-trigger"},RS="calcite-action-menu",LS={button:t=>`${RS}-${t}-menu-button`,menu:t=>`${RS}-${t}-menu`,action:(t,e)=>`${RS}-${t}-action-${e}`},qA={tooltip:"tooltip",trigger:"trigger"},wJ={menu:"ellipsis"};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const SJ=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;display:flex;flex-direction:column;font-size:var(--calcite-font-size-1)}::slotted(calcite-action-group:not(:last-of-type)){border-block-end-width:var(--calcite-border-width-sm)}.default-trigger{position:relative;block-size:100%;flex:0 1 auto;align-self:stretch}slot[name=trigger]::slotted(calcite-action),calcite-action::slotted([slot=trigger]){position:relative;block-size:100%;flex:0 1 auto;align-self:stretch}.menu{display:flex;max-block-size:45vh;flex-direction:column;flex-wrap:nowrap;overflow-y:auto;overflow-x:hidden;outline:2px solid transparent;outline-offset:2px;gap:var(--calcite-action-menu-items-space, 0)}:host([hidden]){display:none}[hidden]{display:none}`,TJ=["ArrowUp","ArrowDown","End","Home"],E1=class E1 extends ji{constructor(){super(...arguments),this.guid=Hu(),this.actionElements=[],this.menuButtonClick=()=>{this.toggleOpen()},this.menuButtonId=LS.button(this.guid),this.menuButtonKeyDown=e=>{const{key:i}=e,{actionElements:r,activeMenuItemIndex:o,open:h}=this;if(r.length){if(E$(i)){if(e.preventDefault(),!h){this.toggleOpen();return}const d=r[o];d?d.click():this.toggleOpen(!1)}if(i==="Tab"){this.open=!1;return}if(i==="Escape"){this.toggleOpen(!1),e.preventDefault();return}this.handleActionNavigation(e,i,r)}},this.menuId=LS.menu(this.guid),this._open=!1,this.updateAction=(e,i)=>{const{guid:r,activeMenuItemIndex:o}=this,h=LS.action(r,i);e.tabIndex=-1,e.setAttribute("role","menuitem"),e.id||(e.id=h),e.activeDescendant=i===o},this.focusSetter=zs()(this),this.activeMenuItemIndex=-1,this.appearance="solid",this.expanded=!1,this.overlayPositioning="absolute",this.placement="auto",this.scale="m",this.calciteActionMenuCollapse=vt({cancelable:!1}),this.calciteActionMenuExpand=vt({cancelable:!1}),this.calciteActionMenuOpen=vt({cancelable:!1})}get open(){return this._open}set open(e){const i=this._open;e!==i&&(this._open=e,this.openHandler(e))}async setFocus(e){return this.focusSetter(()=>this.menuButtonEl,e)}connectedCallback(){super.connectedCallback(),this.connectMenuButtonEl()}willUpdate(e){e.has("expanded")&&(this.hasUpdated||this.expanded!==!1)&&this.expandedHandler(),e.has("activeMenuItemIndex")&&(this.hasUpdated||this.activeMenuItemIndex!==-1)&&this.updateActions(this.actionElements),e.has("expanded")&&this.hasUpdated&&(this.expanded?this.calciteActionMenuExpand.emit():this.calciteActionMenuCollapse.emit())}disconnectedCallback(){super.disconnectedCallback(),this.disconnectMenuButtonEl()}expandedHandler(){this.open=!1,this.setTooltipReferenceElement()}openHandler(e){this.menuButtonEl&&(this.menuButtonEl.active=e,this.menuButtonEl.aria={expanded:e}),this.popoverEl&&(this.popoverEl.open=e),this.activeMenuItemIndex=this.open?0:-1,this.calciteActionMenuOpen.emit(),this.setTooltipReferenceElement()}connectMenuButtonEl(){const{menuButtonId:e,menuId:i,open:r,label:o}=this,h=this.slottedMenuButtonEl||this.defaultMenuButtonEl;this.menuButtonEl!==h&&(this.disconnectMenuButtonEl(),this.menuButtonEl=h,this.setTooltipReferenceElement(),h&&(h.active=r,h.setAttribute("aria-controls",i),h.setAttribute("aria-expanded",Q1(r)),h.setAttribute("aria-haspopup","true"),h.id||(h.id=e),h.label||(h.label=o),h.text||(h.text=o),h.addEventListener("click",this.menuButtonClick),h.addEventListener("keydown",this.menuButtonKeyDown)))}disconnectMenuButtonEl(){const{menuButtonEl:e}=this;e&&(e.removeEventListener("click",this.menuButtonClick),e.removeEventListener("keydown",this.menuButtonKeyDown),this.menuButtonEl=null)}setMenuButtonEl(e){const i=e.target.assignedElements({flatten:!0}).filter(r=>r?.matches("calcite-action"));this.slottedMenuButtonEl=i[0],this.connectMenuButtonEl()}setDefaultMenuButtonEl(e){this.defaultMenuButtonEl=e,this.connectMenuButtonEl()}setPopoverEl(e){e&&(this.popoverEl=e,e.open=this.open)}handleCalciteActionClick(){this.open=!1,this.setFocus()}updateTooltip(e){const i=e.target.assignedElements({flatten:!0}).filter(r=>r?.matches("calcite-tooltip"));this.tooltipEl=i[0],this.setTooltipReferenceElement()}setTooltipReferenceElement(){const{tooltipEl:e,expanded:i,menuButtonEl:r,open:o}=this;e&&(e.referenceElement=!i&&!o?r:null)}updateActions(e){e?.forEach(this.updateAction)}async handleDefaultSlotChange(e){const i=e.target.assignedElements({flatten:!0}).reduce((r,o)=>o?.matches("calcite-action")?(r.push(o),r):o?.matches("calcite-action-group")?r.concat(Array.from(o.querySelectorAll("calcite-action"))):r,[]);await this.componentOnReady(),this.actionElements=i.filter(r=>!r.disabled&&!r.hidden)}isValidKey(e,i){return!!i.find(r=>r===e)}handleActionNavigation(e,i,r){if(!this.isValidKey(i,TJ))return;if(e.preventDefault(),!this.open){this.toggleOpen(),(i==="Home"||i==="ArrowDown")&&(this.activeMenuItemIndex=0),(i==="End"||i==="ArrowUp")&&(this.activeMenuItemIndex=r.length-1);return}i==="Home"&&(this.activeMenuItemIndex=0),i==="End"&&(this.activeMenuItemIndex=r.length-1);const o=this.activeMenuItemIndex;i==="ArrowUp"&&(this.activeMenuItemIndex=VA(Math.max(o-1,-1),r.length)),i==="ArrowDown"&&(this.activeMenuItemIndex=VA(o+1,r.length))}toggleOpen(e=!this.open){this.open=e}handlePopoverOpen(e){e.stopPropagation(),this.open=!0,this.setFocus()}handlePopoverClose(e){e.stopPropagation(),this.open=!1}renderMenuButton(){const{appearance:e,label:i,scale:r,expanded:o}=this;return Ne`<slot name=${qA.trigger} @slotchange=${this.setMenuButtonEl}><calcite-action .appearance=${e} .aria=${{expanded:o}} class=${Fe(GA.defaultTrigger)} .icon=${wJ.menu} .scale=${r} .text=${i} .textEnabled=${o} ${hi(this.setDefaultMenuButtonEl)}></calcite-action></slot>`}renderMenuItems(){const{actionElements:e,activeMenuItemIndex:i,menuId:r,menuButtonEl:o,label:h,placement:d,overlayPositioning:a,flipPlacements:_}=this,E=e[i]?.id||null;return Ne`<calcite-popover auto-close .flipPlacements=${_} focus-trap-disabled .label=${h} offset-distance=0 @calcitePopoverClose=${this.handlePopoverClose} @calcitePopoverOpen=${this.handlePopoverOpen} .overlayPositioning=${a} .placement=${d} pointer-disabled .referenceElement=${o} trigger-disabled ${hi(this.setPopoverEl)}><div aria-activedescendant=${E??ut} aria-labelledby=${o?.id??ut} class=${Fe(GA.menu)} id=${r??ut} @click=${this.handleCalciteActionClick} role=menu tabindex=-1><slot @slotchange=${this.handleDefaultSlotChange}></slot></div></calcite-popover>`}render(){return Ne`${this.renderMenuButton()}${this.renderMenuItems()}<slot name=${qA.tooltip} @slotchange=${this.updateTooltip}></slot>`}};E1.properties={activeMenuItemIndex:[16,{},{state:!0}],menuButtonEl:[16,{},{state:!0}],appearance:[3,{},{reflect:!0}],expanded:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],label:1,open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}]},E1.styles=SJ;let SC=E1;ar("calcite-action-menu",SC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const eL=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host(.calcite-sortable--chosen),:host(.calcite-sortable--drag),:host(.calcite-sortable--fallback),:host(.calcite-sortable--ghost){position:relative;overflow:hidden}:host(.calcite-sortable--ghost):before{content:"";position:absolute;inset-block:0px;inset-inline-start:0px;inset-inline-end:0px;z-index:var(--calcite-z-index);box-sizing:border-box;border-width:1px;border-style:dashed;border-color:var(--calcite-color-brand);background-color:var(--calcite-color-foreground-2)}:host(.calcite-sortable--drag){--tw-shadow: 0 6px 20px -4px rgba(0, 0, 0, .1), 0 4px 12px -2px rgba(0, 0, 0, .08);--tw-shadow-colored: 0 6px 20px -4px var(--tw-shadow-color), 0 4px 12px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}`;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Ah={content:"content",toggle:"toggle",header:"header"},hr={actionsEnd:"actions-end",container:"container",content:"content",contentStart:"content-start",controlContainer:"control-container",description:"description",header:"header",headerContainer:"header-container",headerHasContent:"header--has-content",heading:"heading",icon:"icon",iconStart:"icon--start",iconEnd:"icon--end",iconEndContainer:"icon-end-container",invalid:"invalid",statusIcon:"status-icon",title:"title",toggle:"toggle",toggleIcon:"toggle-icon",valid:"valid"},Xg={actionsEnd:"actions-end",contentStart:"content-start",control:"control",headerMenuActions:"header-menu-actions",icon:"icon"},FS={expanded:"chevron-up",collapsed:"chevron-down",valid:"check-circle",invalid:"exclamation-mark-triangle"},CJ=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host{--calcite-icon-size: 1rem;--calcite-spacing-eighth: .125rem;--calcite-spacing-quarter: .25rem;--calcite-spacing-half: .5rem;--calcite-spacing-three-quarters: .75rem;--calcite-spacing: 1rem;--calcite-spacing-plus-quarter: 1.25rem;--calcite-spacing-plus-half: 1.5rem;--calcite-spacing-double: 2rem;--calcite-menu-min-width: 10rem;--calcite-header-min-height: 3rem;--calcite-footer-min-height: 3rem}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host([scale=s]) .header{gap:var(--calcite-spacing-sm)}:host([scale=s]) .header--has-content{padding:var(--calcite-spacing-sm)}:host([scale=s]) .icon-end-container{gap:var(--calcite-spacing-sm);padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .heading{font-size:var(--calcite-font-size-sm)}:host([scale=s]) .description{font-size:var(--calcite-font-size-xs)}:host([scale=s]){--calcite-internal-block-padding-block: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-xxs)) );--calcite-internal-block-padding-inline: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-sm)) )}:host([scale=m]) .header{gap:var(--calcite-spacing-md)}:host([scale=m]) .header--has-content{padding:var(--calcite-spacing-md)}:host([scale=m]) .icon-end-container{gap:var(--calcite-spacing-md);padding-inline-end:var(--calcite-spacing-md)}:host([scale=m]) .heading{font-size:var(--calcite-font-size)}:host([scale=m]) .description{font-size:var(--calcite-font-size-sm)}:host([scale=m]){--calcite-internal-block-padding-block: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-sm)) );--calcite-internal-block-padding-inline: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-md)) )}:host([scale=l]) .header{gap:var(--calcite-spacing-lg)}:host([scale=l]) .header--has-content{padding:var(--calcite-spacing-lg)}:host([scale=l]) .icon-end-container{gap:var(--calcite-spacing-lg);padding-inline-end:var(--calcite-spacing-lg)}:host([scale=l]) .heading{font-size:var(--calcite-font-size-md)}:host([scale=l]) .description{font-size:var(--calcite-font-size)}:host([scale=l]){--calcite-internal-block-padding-block: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-md)) );--calcite-internal-block-padding-inline: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-lg)) )}:host{display:flex;flex-shrink:0;flex-grow:0;flex-direction:column;border-width:0px;border-block-end-width:1px;border-style:solid;padding:0;transition-property:margin;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.215,.44,.42,.88);flex-basis:auto;border-color:var(--calcite-block-border-color, var(--calcite-color-border-3))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.header{margin:0;display:flex;align-content:space-between;align-items:center;fill:var(--calcite-color-text-2);color:var(--calcite-color-text-2)}.heading{margin:0;padding:0;font-weight:var(--calcite-font-weight-medium)}.header .heading{flex:1 1 auto;padding:.5rem}.header{justify-content:flex-start}.header,.toggle{grid-area:header}.header-container{display:grid;align-items:stretch;grid-template:auto/auto 1fr auto auto auto auto;grid-template-areas:"handle header icon-end control menu actions-end"}.icon--start,.icon--end{color:var(--calcite-block-icon-color, var(--calcite-color-text-3))}.actions-end{grid-area:actions-end}.toggle{margin:0;display:flex;cursor:pointer;flex-wrap:nowrap;align-items:center;justify-content:space-between;border-style:none;padding:0;font-family:var(--calcite-font-family);outline-color:transparent;text-align:initial;background-color:var(--calcite-block-header-background-color, transparent)}.toggle:hover{background-color:var(--calcite-block-header-background-color-hover, var(--calcite-color-foreground-2))}.toggle:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.toggle:active{background-color:var(--calcite-block-header-background-color-press, var(--calcite-color-foreground-3))}calcite-loader[inline]{align-self:center}calcite-sort-handle{grid-area:handle}.title{display:flex;flex-direction:column}.header .title .heading{padding:0;transition-property:color;transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.4,0,.2,1);word-wrap:break-word;word-break:break-word;color:var(--calcite-block-heading-text-color, var(--calcite-color-text-2));font-weight:var(--calcite-font-weight-medium);line-height:var(--calcite-font-line-height-relative-snug)}.description{padding:0;word-wrap:break-word;word-break:break-word;color:var(--calcite-block-description-text-color, var(--calcite-color-text-3));font-weight:var(--calcite-font-weight-regular);line-height:var(--calcite-font-line-height-relative-snug)}.icon{display:flex}.status-icon.valid{color:var(--calcite-color-status-success)}.status-icon.invalid{color:var(--calcite-color-status-danger)}@keyframes spin{0%{transform:rotate(0)}50%{transform:rotate(180deg)}to{transform:rotate(360deg)}}.icon-end-container{display:flex;align-items:center;grid-area:icon-end}.toggle-icon{align-self:center;justify-self:end;transition-property:color;transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.4,0,.2,1);color:var(--calcite-block-icon-color, var(--calcite-color-text-3))}.toggle:hover .toggle-icon{color:var(--calcite-block-icon-color-hover, var(--calcite-color-text-1))}.container{position:relative;display:flex;block-size:100%;flex-direction:column}.content{position:relative;min-block-size:0px;flex:1 1 0%}@keyframes in{0%{opacity:0}to{opacity:1}}.content{animation:in var(--calcite-internal-animation-timing-slow) ease-in-out;padding-block:var(--calcite-internal-block-padding-block);padding-inline:var(--calcite-internal-block-padding-inline)}.content-start{display:flex;align-items:center;color:var(--calcite-block-text-color, var(--calcite-color-text-3))}.control-container{margin:0;display:flex;grid-area:control}calcite-action-menu{grid-area:menu}.actions-end{display:flex;align-items:stretch}:host([expanded]){margin-block:.5rem}:host([expanded]) .header .title .heading{color:var(--calcite-block-heading-text-color, var(--calcite-block-heading-text-color-press, var(--calcite-color-text-1)))}:host([expanded]) .description{color:var(--calcite-block-description-text-color, var(--calcite-color-text-2))}:host([expanded]) .icon--start,:host([expanded]) .icon--end{color:var(--calcite-block-icon-color, var(--calcite-color-text-1))}:host([expanded][scale=s]){margin-block:var(--calcite-spacing-xxs)}:host([expanded][scale=l]){margin-block:var(--calcite-spacing-md)}:host([hidden]){display:none}[hidden]{display:none}`,I1=class I1 extends ji{constructor(){super(...arguments),this.transitionProp="margin-top",this.blockSectionChildren=[],this.messages=fo(),this.focusSetter=zs()(this),this.hasContentStart=!1,this.hasControl=!1,this.hasEndActions=!1,this.hasIcon=!1,this.hasMenuActions=!1,this.collapsible=!1,this.disabled=!1,this.dragDisabled=!1,this.dragHandle=!1,this.expanded=!1,this.loading=!1,this.menuPlacement=iX,this.addToItems=[],this.moveToItems=[],this.sortDisabled=!1,this.overlayPositioning="absolute",this.scale="m",this.setPosition=null,this.setSize=null,this.sortHandleOpen=!1,this.calciteInternalBlockUpdateSortMenuItems=vt({cancelable:!1}),this.calciteBlockBeforeClose=vt({cancelable:!1}),this.calciteBlockBeforeOpen=vt({cancelable:!1}),this.calciteBlockClose=vt({cancelable:!1}),this.calciteBlockCollapse=vt({cancelable:!1}),this.calciteBlockExpand=vt({cancelable:!1}),this.calciteBlockOpen=vt({cancelable:!1}),this.calciteBlockSortHandleBeforeClose=vt({cancelable:!1}),this.calciteBlockSortHandleBeforeOpen=vt({cancelable:!1}),this.calciteBlockSortHandleClose=vt({cancelable:!1}),this.calciteBlockSortHandleOpen=vt({cancelable:!1}),this.calciteBlockToggle=vt({cancelable:!1})}get open(){return this.expanded}set open(e){Sx.deprecated("property",{name:"open",removalVersion:4,suggested:"expanded"}),this.expanded=e}async setFocus(e){return this.focusSetter(()=>this.el,e)}connectedCallback(){super.connectedCallback(),this.transitionEl=this.el}load(){!this.heading&&!this.label&&Sx.warn(`${this.el.tagName} is missing both heading & label. Please provide a heading or label for the component to be accessible.`)}willUpdate(e){e.has("expanded")&&(this.hasUpdated||this.expanded!==!1)&&Y0(this),e.has("sortHandleOpen")&&(this.hasUpdated||this.sortHandleOpen!==!1)&&this.sortHandleOpenHandler(),e.has("expanded")&&this.hasUpdated&&(this.expanded?this.calciteBlockExpand.emit():this.calciteBlockCollapse.emit()),e.has("scale")&&this.hasUpdated&&this.updateBlockSectionScale()}updated(){mo(this)}onBeforeOpen(){this.calciteBlockBeforeOpen.emit()}onOpen(){this.calciteBlockOpen.emit()}onBeforeClose(){this.calciteBlockBeforeClose.emit()}onClose(){this.calciteBlockClose.emit()}sortHandleOpenHandler(){this.sortHandleEl&&(this.sortHandleEl.open=this.sortHandleOpen)}setSortHandleEl(e){this.sortHandleEl=e,this.sortHandleOpenHandler()}handleSortHandleBeforeOpen(e){e.stopPropagation(),this.calciteBlockSortHandleBeforeOpen.emit()}handleSortHandleBeforeClose(e){e.stopPropagation(),this.calciteBlockSortHandleBeforeClose.emit()}handleSortHandleClose(e){e.stopPropagation(),this.sortHandleOpen=!1,this.calciteBlockSortHandleClose.emit()}handleSortHandleOpen(e){e.stopPropagation(),this.sortHandleOpen=!0,this.calciteBlockSortHandleOpen.emit()}onHeaderClick(){this.expanded=!this.expanded,this.calciteBlockToggle.emit()}controlSlotChangeHandler(e){this.hasControl=Cr(e)}menuActionsSlotChangeHandler(e){this.hasMenuActions=Cr(e)}iconSlotChangeHandler(e){this.hasIcon=Cr(e)}actionsEndSlotChangeHandler(e){this.hasEndActions=Cr(e)}handleContentStartSlotChange(e){this.hasContentStart=Cr(e)}handleDefaultSlotChange(e){this.blockSectionChildren=gR(e,"calcite-block-section"),this.updateBlockSectionScale()}updateBlockSectionScale(){this.blockSectionChildren.forEach(e=>{e.scale=this.scale})}renderScrim(){const{loading:e}=this,i=Ne`<slot @slotchange=${this.handleDefaultSlotChange}></slot>`;return[e?Ne`<calcite-scrim .loading=${e}></calcite-scrim>`:null,i]}renderLoaderStatusIcon(){const{loading:e,messages:i,status:r}=this;return e?ai("loader",Ne`<div class=${Fe(hr.icon)}><calcite-loader inline .label=${i.loading} .scale=${this.scale}></calcite-loader></div>`):r?ai("status-icon",Ne`<div class=${Fe(hr.icon)}><calcite-icon class=${Fe({[hr.statusIcon]:!0,[hr.valid]:r=="valid",[hr.invalid]:r=="invalid"})} .icon=${FS[r]} .scale=${Br(this.scale)}></calcite-icon></div>`):ai("icon-slot",Ne`<div class=${Fe(hr.icon)} .hidden=${!this.hasIcon}>${ai("icon-slot",Ne`<slot name=${Xg.icon} @slotchange=${this.iconSlotChangeHandler}></slot>`)}</div>`)}renderActionsEnd(){return Ne`<div class=${Fe(hr.actionsEnd)} .hidden=${!this.hasEndActions}><slot name=${Xg.actionsEnd} @slotchange=${this.actionsEndSlotChangeHandler}></slot></div>`}renderContentStart(){return Ne`<div class=${Fe(hr.contentStart)} .hidden=${!this.hasContentStart}><slot name=${Xg.contentStart} @slotchange=${this.handleContentStartSlotChange}></slot></div>`}renderTitle(){const{heading:e,headingLevel:i,description:r}=this;return e||r?Ne`<div class=${Fe(hr.title)}>${ZR({class:hr.heading,level:i,children:e})}${r?Ne`<div class=${Fe(hr.description)}>${r}</div>`:null}</div>`:null}renderIcon(e){const{iconFlipRtl:i}=this,r=i==="both"||e==="start"?i==="start":i==="end",o=e==="start"?this.iconStart:this.iconEnd,h=e==="start"?hr.iconStart:hr.iconEnd;if(o)return ai(o,Ne`<calcite-icon class=${Fe(h)} .flipRtl=${r} .icon=${o} .scale=${Br(this.scale)}></calcite-icon>`)}render(){const{collapsible:e,loading:i,expanded:r,label:o,heading:h,messages:d,description:a,menuFlipPlacements:_,menuPlacement:T,moveToItems:E,addToItems:k,setPosition:L,setSize:O,dragDisabled:H,sortDisabled:re,iconEnd:pe,hasContentStart:ge,iconStart:Se}=this,Pe=r?d.collapse:d.expand,Re=!!(h||a||ge||Se||i||status),ze=Ne`<header class=${Fe({[hr.header]:!0,[hr.headerHasContent]:Re})} id=${Ah.header}>${this.renderIcon("start")}${this.renderContentStart()}${this.renderLoaderStatusIcon()}${this.renderTitle()}</header>`,Je=r?FS.expanded:FS.collapsed,Xe=Ne`<div class=${Fe(hr.headerContainer)}>${this.dragHandle?Ne`<calcite-sort-handle .addToItems=${k} .disabled=${H} .label=${h||o} .moveToItems=${E} @calciteSortHandleBeforeClose=${this.handleSortHandleBeforeClose} @calciteSortHandleBeforeOpen=${this.handleSortHandleBeforeOpen} @calciteSortHandleClose=${this.handleSortHandleClose} @calciteSortHandleOpen=${this.handleSortHandleOpen} overlay-positioning=fixed .scale=${this.scale} .setPosition=${L} .setSize=${O} .sortDisabled=${re} ${hi(this.setSortHandleEl)}></calcite-sort-handle>`:null}${e?Ne`<button aria-controls=${Ah.content} aria-describedby=${Ah.header} .ariaExpanded=${e?r:null} class=${Fe(hr.toggle)} id=${Ah.toggle} @click=${this.onHeaderClick} title=${Pe??ut}>${ze}<div class=${Fe(hr.iconEndContainer)}>${this.renderIcon("end")}<calcite-icon class=${Fe(hr.toggleIcon)} .icon=${Je} .scale=${Br(this.scale)}></calcite-icon></div></button>`:ze}${pe&&!e?Ne`<div class=${Fe(hr.iconEndContainer)}>${this.renderIcon("end")}</div>`:null}<div aria-labelledby=${Ah.header} class=${Fe(hr.controlContainer)} .hidden=${!this.hasControl}><slot name=${Xg.control} @slotchange=${this.controlSlotChangeHandler}></slot></div><calcite-action-menu .flipPlacements=${_??["top","bottom"]} .hidden=${!this.hasMenuActions} .label=${d.options} .overlayPositioning=${this.overlayPositioning} .placement=${T} .scale=${this.scale}><slot name=${Xg.headerMenuActions} @slotchange=${this.menuActionsSlotChangeHandler}></slot></calcite-action-menu>${this.renderActionsEnd()}</div>`;return go({disabled:this.disabled,children:Ne`<article aria-label=${o??ut} .ariaBusy=${i} class=${Fe({[hr.container]:!0})}>${Xe}<section aria-labelledby=${Ah.toggle} class=${Fe(hr.content)} .hidden=${!r} id=${Ah.content}>${this.renderScrim()}</section></article>`})}};I1.properties={hasContentStart:[16,{},{state:!0}],hasControl:[16,{},{state:!0}],hasEndActions:[16,{},{state:!0}],hasIcon:[16,{},{state:!0}],hasMenuActions:[16,{},{state:!0}],collapsible:[7,{},{reflect:!0,type:Boolean}],description:1,disabled:[7,{},{reflect:!0,type:Boolean}],dragDisabled:[7,{},{reflect:!0,type:Boolean}],dragHandle:[7,{},{reflect:!0,type:Boolean}],expanded:[7,{},{reflect:!0,type:Boolean}],heading:1,headingLevel:[11,{},{type:Number,reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],loading:[7,{},{reflect:!0,type:Boolean}],label:1,menuFlipPlacements:[0,{},{attribute:!1}],menuPlacement:[3,{},{reflect:!0}],messageOverrides:[0,{},{attribute:!1}],addToItems:[0,{},{attribute:!1}],moveToItems:[0,{},{attribute:!1}],sortDisabled:[5,{},{type:Boolean}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}],setPosition:[9,{},{type:Number}],setSize:[9,{},{type:Number}],sortHandleOpen:[7,{},{reflect:!0,type:Boolean}],status:[3,{},{reflect:!0}]},I1.styles=[CJ,eL];let TC=I1;ar("calcite-block",TC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Np={container:"container",actionsStart:"actions-start",contentStart:"content-start",content:"content",contentEnd:"content-end",actionsEnd:"actions-end"},gf={actionsStart:"actions-start",contentStart:"content-start",contentEnd:"content-end",actionsEnd:"actions-end"};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const EJ=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]) .content{cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) .content *,:host([disabled]) .content ::slotted(*){pointer-events:none}:host{display:flex;flex:1 1 0%;flex-direction:column}.container{display:flex;flex:1 1 auto;align-items:stretch;font-weight:var(--calcite-font-weight-normal);color:var(--calcite-color-text-2)}.content{display:flex;flex:1 1 auto;flex-direction:column;justify-content:center;font-size:var(--calcite-font-size--2);line-height:1.375;padding-inline:var(--calcite-stack-padding-inline, .75rem);padding-block:var(--calcite-stack-padding-block, .5rem)}.content-start{justify-content:flex-start}.content-end{justify-content:flex-end}.content-start,.content-end{flex:0 1 auto}.content-start ::slotted(calcite-icon),.content-end ::slotted(calcite-icon){margin-inline:.75rem;align-self:center}.actions-start,.actions-end,.content-start,.content-end{display:flex;align-items:center}.actions-start ::slotted(calcite-action),.actions-start ::slotted(calcite-action-menu),.actions-start ::slotted(calcite-handle),.actions-start ::slotted(calcite-dropdown),.actions-end ::slotted(calcite-action),.actions-end ::slotted(calcite-action-menu),.actions-end ::slotted(calcite-handle),.actions-end ::slotted(calcite-dropdown){align-self:stretch;color:inherit}:host([hidden]){display:none}[hidden]{display:none}`,$1=class $1 extends ji{constructor(){super(...arguments),this.hasActionsEnd=!1,this.hasActionsStart=!1,this.hasContentEnd=!1,this.hasContentStart=!1,this.disabled=!1}handleActionsStartSlotChange(e){this.hasActionsStart=Cr(e)}handleActionsEndSlotChange(e){this.hasActionsEnd=Cr(e)}handleContentStartSlotChange(e){this.hasContentStart=Cr(e)}handleContentEndSlotChange(e){this.hasContentEnd=Cr(e)}renderActionsStart(){const{hasActionsStart:e}=this;return ai("actions-start-container",Ne`<div class=${Fe(Np.actionsStart)} .hidden=${!e}><slot name=${gf.actionsStart} @slotchange=${this.handleActionsStartSlotChange}></slot></div>`)}renderActionsEnd(){const{hasActionsEnd:e}=this;return ai("actions-end-container",Ne`<div class=${Fe(Np.actionsEnd)} .hidden=${!e}><slot name=${gf.actionsEnd} @slotchange=${this.handleActionsEndSlotChange}></slot></div>`)}renderContentStart(){const{hasContentStart:e}=this;return Ne`<div class=${Fe(Np.contentStart)} .hidden=${!e}><slot name=${gf.contentStart} @slotchange=${this.handleContentStartSlotChange}></slot></div>`}renderDefaultContent(){return Ne`<div class=${Fe(Np.content)}><slot></slot></div>`}renderContentEnd(){const{hasContentEnd:e}=this;return Ne`<div class=${Fe(Np.contentEnd)} .hidden=${!e}><slot name=${gf.contentEnd} @slotchange=${this.handleContentEndSlotChange}></slot></div>`}render(){return Ne`<div class=${Fe(Np.container)}>${this.renderActionsStart()}${this.renderContentStart()}${this.renderDefaultContent()}${this.renderContentEnd()}${this.renderActionsEnd()}</div>`}};$1.properties={hasActionsEnd:[16,{},{state:!0}],hasActionsStart:[16,{},{state:!0}],hasContentEnd:[16,{},{state:!0}],hasContentStart:[16,{},{state:!0}],disabled:[7,{},{reflect:!0,type:Boolean}]},$1.styles=EJ;let CC=$1;ar("calcite-stack",CC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const HA={valid:"check-circle",invalid:"exclamation-mark-triangle",idle:"information"},IJ=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;display:flex;block-size:auto;inline-size:100%;align-items:center;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-text-1);opacity:1;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;margin-block-start:var(--calcite-input-message-spacing, var(--calcite-input-message-spacing-value, var(--calcite-spacing-xxs)))}.calcite-input-message-icon{pointer-events:none;display:inline-flex;flex-shrink:0;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;margin-inline-end:var(--calcite-spacing-sm)}:host([status=invalid]) .calcite-input-message-icon{color:var(--calcite-input-message-icon-color, var(--calcite-icon-color, var(--calcite-color-status-danger)))}:host([status=valid]) .calcite-input-message-icon{color:var(--calcite-input-message-icon-color, var(--calcite-icon-color, var(--calcite-color-status-success)))}:host([status=idle]) .calcite-input-message-icon{color:var(--calcite-input-message-icon-color, var(--calcite-icon-color, var(--calcite-color-brand)))}:host([scale=s]){font-size:var(--calcite-font-size--3);line-height:.75rem}:host([scale=m]){font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=l]){font-size:var(--calcite-font-size--1);line-height:1rem}:host([hidden]){display:none}[hidden]{display:none}`,$J={inputMessageIcon:"calcite-input-message-icon"},P1=class P1 extends ji{constructor(){super(...arguments),this.iconFlipRtl=!1,this.scale="m",this.status="idle"}connectedCallback(){super.connectedCallback(),this.requestedIcon=em(HA,this.icon,this.status)}willUpdate(e){(e.has("status")&&(this.hasUpdated||this.status!=="idle")||e.has("icon"))&&(this.requestedIcon=em(HA,this.icon,this.status))}render(){const e=this.el.hidden;return X1(this.el,"calcite-hydrated-hidden",e),Ne`${this.renderIcon(this.requestedIcon)}<slot></slot>`}renderIcon(e){if(e)return Ne`<calcite-icon class=${Fe($J.inputMessageIcon)} .flipRtl=${this.iconFlipRtl} .icon=${e} scale=s></calcite-icon>`}};P1.properties={icon:[3,{converter:_d},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}]},P1.styles=IJ;let EC=P1;ar("calcite-input-message",EC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const PJ=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{position:relative;display:block;inline-size:100%}.track,.bar{position:absolute;inset-block-start:0px;block-size:2px}.track{z-index:var(--calcite-z-index);inline-size:100%;overflow:hidden;background-color:var(--calcite-progress-background-color, var(--calcite-color-border-3))}.bar{z-index:var(--calcite-z-index);background-color:var(--calcite-progress-fill-color, var(--calcite-color-brand))}@media (forced-colors: active){.track{background-color:highlightText}.bar{background-color:linkText}}.indeterminate{inline-size:20%;animation:looping-progress-bar-ani calc(var(--calcite-internal-animation-timing-medium) / var(--calcite-internal-duration-factor) * 11 / var(--calcite-internal-duration-factor)) linear infinite}.indeterminate.calcite--rtl{animation-name:looping-progress-bar-ani-rtl}.reversed{animation-direction:reverse}.text{padding-inline:0px;padding-block:1rem 0px;text-align:center;font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-progress-text-color, var(--calcite-color-text-2))}@keyframes looping-progress-bar-ani{0%{transform:translate3d(-100%,0,0)}50%{inline-size:40%}to{transform:translate3d(600%,0,0)}}@keyframes looping-progress-bar-ani-rtl{0%{transform:translate3d(100%,0,0)}50%{inline-size:40%}to{transform:translate3d(-600%,0,0)}}:host([hidden]){display:none}[hidden]{display:none}`,NS={track:"track",bar:"bar",text:"text"},M1=class M1 extends ji{constructor(){super(...arguments),this.reversed=!1,this.type="determinate",this.value=0}render(){const e=this.type==="determinate",i=e?{width:`${this.value}%`}:{},r=Z0(this.el);return Ne`<div .ariaLabel=${this.label||this.text} .ariaValueMax=${e?"100":void 0} .ariaValueMin=${e?"0":void 0} .ariaValueNow=${e?this.value:void 0} role=progressbar><div class=${Fe(NS.track)}><div class=${Fe({[NS.bar]:!0,indeterminate:this.type==="indeterminate",[JO.rtl]:r==="rtl",reversed:this.reversed})} style=${XO(i)}></div></div>${this.text?Ne`<div class=${Fe(NS.text)}>${this.text}</div>`:null}</div>`}};M1.properties={label:1,reversed:[7,{},{reflect:!0,type:Boolean}],text:1,type:[3,{},{reflect:!0}],value:[9,{},{type:Number}]},M1.styles=PJ;let IC=M1;ar("calcite-progress",IC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const tL="calciteInternalLabelClick",A$="calciteInternalLabelConnected",$C="calciteInternalLabelDisconnected",ZA="calcite-label",nm=new WeakMap,Ny=new WeakMap,x0=new WeakMap,zx=new WeakMap,ld=new Set,MJ=t=>{const{id:e}=t,i=e&&K1(t,{selector:`${ZA}[for="${e}"]`});if(i)return i;const r=Sm(t,ZA);return!r||kJ(r,t)?null:r};function kJ(t,e){let i;const r="custom-element-ancestor-check",o=d=>{d.stopImmediatePropagation();const a=d.composedPath();i=a.slice(a.indexOf(e),a.indexOf(t))};return t.addEventListener(r,o,{once:!0}),e.dispatchEvent(new CustomEvent(r,{composed:!0,bubbles:!0})),t.removeEventListener(r,o),i.filter(d=>d!==e&&d!==t).filter(d=>d.tagName?.includes("-")).length>0}function X0(t){if(!t)return;const e=MJ(t.el);if(Ny.has(e)&&e===t.labelEl||!e&&ld.has(t))return;const i=DJ.bind(t);if(e){t.labelEl=e;const r=nm.get(e)||[];r.push(t),nm.set(e,r.sort(iL)),Ny.has(t.labelEl)||(Ny.set(t.labelEl,WA),t.labelEl.addEventListener(tL,WA)),ld.delete(t),document.removeEventListener(A$,x0.get(t)),zx.set(t,i),document.addEventListener($C,i)}else ld.has(t)||(i(),document.removeEventListener($C,zx.get(t)))}function D$(t){if(!t||(ld.delete(t),document.removeEventListener(A$,x0.get(t)),document.removeEventListener($C,zx.get(t)),x0.delete(t),zx.delete(t),!t.labelEl))return;const e=nm.get(t.labelEl);e.length===1&&(t.labelEl.removeEventListener(tL,Ny.get(t.labelEl)),Ny.delete(t.labelEl)),nm.set(t.labelEl,e.filter(i=>i!==t).sort(iL)),t.labelEl=null}function iL(t,e){return qW(t.el,e.el)?-1:1}function Ox(t){return t.label||t.labelEl?.textContent?.trim()||""}function WA(t){const e=t.detail.sourceEvent.target,i=nm.get(this),r=i.find(d=>d.el===e);if(i.includes(r))return;const h=i[0];h.disabled||h.onLabelClick(t)}function AJ(){ld.has(this)&&X0(this)}function DJ(){ld.add(this);const t=x0.get(this)||AJ.bind(this);x0.set(this,t),document.addEventListener(A$,t)}async function wpe(t){if(await t.componentOnReady(),nm.has(t))return;const i=t.ownerDocument?.getElementById(t.for);i&&requestAnimationFrame(()=>{for(const r of ld)if(r.el===i){X0(r);break}})}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const zJ=new RegExp("\\.(0+)?$"),OJ=new RegExp("0+$"),Oi=class Oi{constructor(e){if(e instanceof Oi)return e;const[i,r]=GJ(e).split(".").concat("");this.value=BigInt(i+r.padEnd(Oi.DECIMALS,"0").slice(0,Oi.DECIMALS))+BigInt(Oi.ROUNDED&&r[Oi.DECIMALS]>="5"),this.isNegative=e.charAt(0)==="-"}getIntegersAndDecimals(){const e=this.value.toString().replace("-","").padStart(Oi.DECIMALS+1,"0"),i=e.slice(0,-Oi.DECIMALS),r=e.slice(-Oi.DECIMALS).replace(OJ,"");return{integers:i,decimals:r}}toString(){const{integers:e,decimals:i}=this.getIntegersAndDecimals();return`${this.isNegative?"-":""}${e}${i.length?"."+i:""}`}formatToParts(e){const{integers:i,decimals:r}=this.getIntegersAndDecimals(),o=e.numberFormatter.formatToParts(BigInt(i));return this.isNegative&&o.unshift({type:"minusSign",value:e.minusSign}),r.length&&(o.push({type:"decimal",value:e.decimal}),r.split("").forEach(h=>o.push({type:"fraction",value:h}))),o}format(e){const{integers:i,decimals:r}=this.getIntegersAndDecimals(),o=`${this.isNegative?e.minusSign:""}${e.numberFormatter.format(BigInt(i))}`,h=r.length?`${e.decimal}${r.split("").map(d=>e.numberFormatter.format(Number(d))).join("")}`:"";return`${o}${h}`}add(e){return Oi.fromBigInt(this.value+new Oi(e).value)}subtract(e){return Oi.fromBigInt(this.value-new Oi(e).value)}multiply(e){return Oi._divRound(this.value*new Oi(e).value,Oi.SHIFT)}divide(e){return Oi._divRound(this.value*Oi.SHIFT,new Oi(e).value)}};Oi.DECIMALS=100,Oi.ROUNDED=!0,Oi.SHIFT=BigInt("1"+"0".repeat(Oi.DECIMALS)),Oi._divRound=(e,i)=>Oi.fromBigInt(e/i+(Oi.ROUNDED?e*BigInt(2)/i%BigInt(2):BigInt(0))),Oi.fromBigInt=e=>Object.assign(Object.create(Oi.prototype),{value:e,isNegative:e<BigInt(0)});let sm=Oi;function ac(t){return!(!t||isNaN(Number(t)))}function RJ(t){return!t||!qJ(t)?"":Rx(t,e=>{let i=!1;const r=e.split("").filter((o,h)=>o.match(/\./g)&&!i?(i=!0,!0):o.match(/-/g)&&h===0?!0:aw.includes(o)).join("");return ac(r)?new sm(r).toString():""})}const rL=/^([-0])0+(?=\d)/,LJ=/(?!^\.)\.$/,FJ=/(?!^-)-/g,NJ=/^-\b0\b\.?0*$/,BJ=/0*$/,jJ=new Set(["e","E","-",",",".",...aw]),UJ=t=>{const e=Array.from(t).filter(i=>jJ.has(i)).join("");return Rx(e,i=>{const r=i.replace(FJ,"").replace(LJ,"").replace(rL,"$1");return ac(r)?NJ.test(r)?r:VJ(r):i})};function VJ(t){const e=t.split(".")[1],i=new sm(t).toString(),[r,o]=i.split(".");return e&&o!==e?`${r}.${e}`:i}function Rx(t,e){if(!t)return t;const i=t.toLowerCase().indexOf("e")+1;return i?t.replace(/[eE]*$/g,"").substring(0,i).concat(t.slice(i).replace(/[eE]/g,"")).split(/[eE]/).map((r,o)=>e(o===1?r.replace(/\./g,""):r)).join("e").replace(/^e/,"1e"):e(t)}function GJ(t){const e=t.split(/[eE]/);if(e.length===1)return t;const i=+t;if(Number.isSafeInteger(i))return`${i}`;const r=t.charAt(0)==="-",o=+e[1],h=e[0].split("."),d=(r?h[0].substring(1):h[0])||"",a=h[1]||"",_=(k,L)=>{const O=Math.abs(L)-k.length,H=O>0?`${"0".repeat(O)}${k}`:k;return`${H.slice(0,L)}.${H.slice(L)}`},T=(k,L)=>{const O=L>k.length?`${k}${"0".repeat(L-k.length)}`:k;return`${O.slice(0,L)}.${O.slice(L)}`},E=o>0?`${d}${T(a,o)}`:`${_(d,o)}${a}`;return`${r?"-":""}${E.charAt(0)==="."?"0":""}${E.replace(zJ,"").replace(rL,"")}`}function qJ(t){return aw.some(e=>t.includes(e))}function HJ(t,e,i){const r=e.split(".")[1];if(r){const o=r.match(BJ)[0];if(o&&i.delocalize(t).length!==e.length&&r.indexOf("e")===-1){const h=i.decimal;return t=t.includes(h)?t:`${t}${h}`,t.padEnd(t.length+o.length,i.localize("0"))}}return t}const Lx="en",ZJ=["ar","bg","bs","ca","cs","da","de","de-AT","de-CH","el",Lx,"en-AU","en-CA","en-GB","es","es-MX","et","fi","fr","fr-CH","he","hi","hr","hu","id","it","it-CH","ja","ko","lt","lv","mk","no","nl","pl","pt","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"];new Map(Object.entries({bg:{am:"..",pm:".."},bs:{am:"prijepodne",pm:"popodne"},ca:{am:"a.m.",pm:"p.m."},cs:{am:"dop.",pm:"odp."},es:{am:"a.m.",pm:"p.m."},"es-mx":{am:"a.m.",pm:"p.m."},"es-MX":{am:"a.m.",pm:"p.m."},fi:{am:"ap.",pm:"ip."},he:{am:"",pm:""},hu:{am:"de. ",pm:"du."},lt:{am:"priepiet",pm:"popiet"},lv:{am:"priekpusdien",pm:"pcpusdien"},mk:{am:".",pm:"."},no:{am:"a.m.",pm:"p.m."},nl:{am:"a.m.",pm:"p.m."},"pt-pt":{am:"da manh",pm:"da tarde"},"pt-PT":{am:"da manh",pm:"da tarde"},ro:{am:"a.m.",pm:"p.m."},sl:{am:"dop.",pm:"pop."},sv:{am:"fm",pm:"em"},th:{am:"",pm:""},tr:{am:"",pm:"S"},uk:{am:"",pm:""},vi:{am:"SA",pm:"CH"}}));const WJ=["arab","arabext","latn"],BS=[...ZJ],nL=t=>WJ.includes(t),jS=new Intl.NumberFormat().resolvedOptions().numberingSystem,sL=jS==="arab"||!nL(jS)?"latn":jS,YJ=t=>nL(t)?t:sL;function XJ(t){return t?BS.includes(t)?t:(t=t.toLowerCase(),t.includes("-")&&(t=t.replace(/(\w+)-(\w+)/,(e,i,r)=>`${i}-${r.toUpperCase()}`),BS.includes(t)||(t=t.split("-")[0])),t==="nb"||t==="nn"?"no":t==="zh"?"zh-CN":BS.includes(t)?t:(console.warn(`Translations for the "${t}" locale are not available and will fall back to the default, English (en).`),Lx)):Lx}class JJ{constructor(){this.delocalize=e=>this._numberFormatOptions?Rx(e,i=>i.replace(new RegExp(`[${this._minusSign}]`,"g"),"-").replace(new RegExp(`[${this._group}]`,"g"),"").replace(new RegExp(`[${this._decimal}]`,"g"),".").replace(new RegExp(`[${this._digits.join("")}]`,"g"),this._getDigitIndex)):e,this.localize=e=>this._numberFormatOptions?Rx(e,i=>ac(i.trim())?new sm(i.trim()).format(this).replace(new RegExp(`[${this._actualGroup}]`,"g"),this._group):i):e}get group(){return this._group}get decimal(){return this._decimal}get minusSign(){return this._minusSign}get digits(){return this._digits}get numberFormatter(){return this._numberFormatter}get numberFormatOptions(){return this._numberFormatOptions}set numberFormatOptions(e){if(e.locale=XJ(e?.locale),e.numberingSystem=YJ(e?.numberingSystem),!this._numberFormatOptions&&e.locale===Lx&&e.numberingSystem===sL&&Object.keys(e).length===2||JSON.stringify(this._numberFormatOptions)===JSON.stringify(e))return;this._numberFormatOptions=e,this._numberFormatter=new Intl.NumberFormat(this._numberFormatOptions.locale,this._numberFormatOptions),this._digits=[...new Intl.NumberFormat(this._numberFormatOptions.locale,{useGrouping:!1,numberingSystem:this._numberFormatOptions.numberingSystem}).format(9876543210)].reverse();const i=new Map(this._digits.map((o,h)=>[o,h])),r=new Intl.NumberFormat(this._numberFormatOptions.locale,{numberingSystem:this._numberFormatOptions.numberingSystem}).formatToParts(-123456789e-1);this._actualGroup=r.find(o=>o.type==="group").value,this._group=this._actualGroup.trim().length===0||this._actualGroup==" "?"":this._actualGroup,this._decimal=e.locale==="bs"||e.locale==="mk"?",":r.find(o=>o.type==="decimal").value,this._minusSign=r.find(o=>o.type==="minusSign").value,this._getDigitIndex=o=>i.get(o)}}const Do=new JJ;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const tu={alignmentCenter:"internal-label-alignment--center",alignmentEnd:"internal-label-alignment--end",container:"internal-label--container",requiredIndicator:"internal-label-required--indicator",spacingBottom:"internal-label-spacing--bottom",spacingInlineEnd:"internal-label-spacing-inline--end",spacingInlineStart:"internal-label-spacing-inline--start",text:"internal-label--text"},oL=({alignmentCenter:t,bottomSpacingDisabled:e,labelText:i,onClick:r,required:o,spacingInlineEnd:h,spacingInlineStart:d,tooltipText:a})=>Ne`<div class=${Fe({[tu.alignmentCenter]:t,[tu.alignmentEnd]:!t,[tu.container]:!0,[tu.spacingBottom]:!e,[tu.spacingInlineEnd]:h,[tu.spacingInlineStart]:d})} @click=${r}><div class=${Fe(tu.text)}>${i}${o&&Ne`<span aria-hidden=true class=${Fe(tu.requiredIndicator)} title=${a??ut}>*</span>`||""}</div><slot name=label-content></slot></div>`;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const KJ={validationContainer:"validation-container"},QJ=()=>{},aL=({scale:t,status:e,id:i,icon:r,message:o,ref:h})=>Ne`<div class=${Fe(KJ.validationContainer)} ${hi(h||QJ)}><calcite-input-message aria-live=polite .icon=${r} id=${i??ut} .scale=${t} .status=${e}>${o}</calcite-input-message></div>`;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const eK=["date","datetime-local","month","number","range","time","week"],tK=["email","password","search","tel","text","url"],iK=["email","password","search","tel","text","textarea","url"];function Bp(t,e,i,r){const o=i.toLowerCase(),h=t[i];r&&h!=null?e.setAttribute(o,`${h}`):e.removeAttribute(o)}function rK(t,e,i){i.type=t==="textarea"?"text":t;const r=eK.includes(t),o=e;Bp(o,i,"min",r),Bp(o,i,"max",r),Bp(o,i,"step",r);const h=iK.includes(t),d=e;Bp(d,i,"minLength",h),Bp(d,i,"maxLength",h);const a=tK.includes(t);Bp(d,i,"pattern",a)}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Mn={loader:"loader",clearButton:"clear-button",editingEnabled:"editing-enabled",inlineChild:"inline-child",inputIcon:"icon",prefix:"prefix",suffix:"suffix",numberButtonWrapper:"number-button-wrapper",buttonItemHorizontal:"number-button-item--horizontal",wrapper:"element-wrapper",inputWrapper:"wrapper",actionWrapper:"action-wrapper",numberButtonItem:"number-button-item",hasSuffix:"has-suffix",hasPrefix:"has-prefix"},US={validationMessage:"inputValidationMessage"},YA={tel:"phone",password:"lock",email:"email-address",date:"calendar",time:"clock",search:"search"},nK={action:"action"},XA={up:"up",down:"down"},VS={chevronUp:"chevron-up",chevronDown:"chevron-down",close:"x"},sK=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}:host([scale=s]) input,:host([scale=s]) .prefix,:host([scale=s]) .suffix{block-size:1.5rem;padding-inline:.5rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) input[type=file],:host([scale=s]) textarea{min-block-size:1.5rem}:host([scale=s]) .number-button-wrapper,:host([scale=s]) .action-wrapper{block-size:1.5rem}:host([scale=s]) .clear-button{min-block-size:1.5rem;min-inline-size:1.5rem}:host([scale=s]) textarea{block-size:auto;padding-block:.25rem;padding-inline:.5rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=m]) input,:host([scale=m]) .prefix,:host([scale=m]) .suffix{block-size:2rem;padding-inline:.75rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) textarea,:host([scale=m]) input[type=file]{min-block-size:2rem}:host([scale=m]) .number-button-wrapper,:host([scale=m]) .action-wrapper{block-size:2rem}:host([scale=m]) .clear-button{min-block-size:2rem;min-inline-size:2rem}:host([scale=m]) textarea{block-size:auto;padding-block:.5rem;padding-inline:.75rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=l]) input,:host([scale=l]) .prefix,:host([scale=l]) .suffix{block-size:2.75rem;padding-inline:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) textarea,:host([scale=l]) input[type=file]{min-block-size:2.75rem}:host([scale=l]) .number-button-wrapper,:host([scale=l]) .action-wrapper{block-size:2.75rem}:host([scale=l]) .clear-button{min-block-size:2.75rem;min-inline-size:2.75rem}:host([scale=l]) textarea{block-size:auto;padding-block:.75rem;padding-inline:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([disabled]) textarea{resize:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}textarea,input{position:relative;margin:0;box-sizing:border-box;display:flex;max-block-size:100%;inline-size:100%;max-inline-size:100%;flex:1 1 0%;text-overflow:ellipsis;border-width:1px;border-style:solid;font-family:inherit;font-weight:var(--calcite-font-weight-normal);border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-background-color, var(--calcite-color-foreground-1));color:var(--calcite-input-text-color, var(--calcite-color-text-1));transition:var(--calcite-animation-timing),block-size 0,outline-offset 0s;-webkit-appearance:none}textarea:placeholder-shown,input:placeholder-shown{text-overflow:ellipsis}textarea{border-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}input{border-start-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}.has-prefix input{border-start-start-radius:0;border-end-start-radius:0}.has-suffix input,.element-wrapper:has(.clear-button) input,:host([number-button-type=vertical][type=number]) input,:host([number-button-type=horizontal]) .has-suffix .suffix,:host([number-button-type=vertical][type=number]) .has-suffix .suffix,:host([number-button-type=vertical][type=number]) .clear-button,:host([number-button-type=horizontal][type=number]) .clear-button{border-start-end-radius:0;border-end-end-radius:0}:host([number-button-type=horizontal]) input{border-start-start-radius:0;border-start-end-radius:0;border-end-start-radius:0;border-end-end-radius:0}.has-prefix .prefix:first-child,:host([number-button-type=horizontal]) .number-button-item[data-adjustment=down]{border-start-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}.has-suffix .suffix,:host([number-button-type=vertical][type=number][read-only]) .has-suffix .suffix,:host([clearable]) .clear-button,:host([number-button-type=horizontal]) .number-button-item[data-adjustment=up]{border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}:host([clearable]) .has-suffix .clear-button{border-end-end-radius:0;border-start-end-radius:0}:host([number-button-type=vertical]) .number-button-item[data-adjustment=down]{border-block-start-width:0px;border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}:host([number-button-type=vertical]) .number-button-item[data-adjustment=up]{border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}input[type=search]::-webkit-search-decoration{-webkit-appearance:none}input:focus,textarea:focus{border-color:var(--calcite-color-brand);color:var(--calcite-input-text-color, var(--calcite-color-text-1))}input[readonly],textarea[readonly]{font-weight:var(--calcite-font-weight-medium);background-color:var(--calcite-input-background-color, var(--calcite-color-background))}input[readonly]:focus,textarea[readonly]:focus{color:var(--calcite-input-text-color, var(--calcite-color-text-1))}textarea,input{outline-color:transparent}textarea:focus,input:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([status=invalid]) input,:host([status=invalid]) textarea{border-color:var(--calcite-color-status-danger)}:host([status=invalid]) input:focus,:host([status=invalid]) textarea:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-status-danger);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([scale=s]) .icon{inset-inline-start:.5rem}:host([scale=m]) .icon{inset-inline-start:.75rem}:host([scale=l]) .icon{inset-inline-start:1rem}:host([icon][scale=s]) input{padding-inline-start:2rem}:host([icon][scale=m]) input{padding-inline-start:2.5rem}:host([icon][scale=l]) input{padding-inline-start:3.5rem}.element-wrapper{position:relative;order:3;display:inline-flex;flex:1 1 0%;align-items:center;isolation:isolate}.icon{pointer-events:none;position:absolute;display:block;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-icon-color, var(--calcite-color-text-3));z-index:var(--calcite-z-index)}input[type=text]::-ms-clear,input[type=text]::-ms-reveal{display:none;block-size:0px;inline-size:0px}input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration,input[type=date]::-webkit-clear-button,input[type=time]::-webkit-clear-button{display:none}.clear-button{pointer-events:initial;order:4;margin:0;box-sizing:border-box;display:flex;min-block-size:100%;cursor:pointer;align-items:center;justify-content:center;align-self:stretch;border-width:1px;border-style:solid;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;outline-color:transparent;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-actions-background-color, var(--calcite-color-foreground-1));border-inline-start-width:0px}.clear-button calcite-icon{transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-actions-icon-color, var(--calcite-color-text-3))}.clear-button:hover{background-color:var(--calcite-input-actions-background-color-hover, var(--calcite-color-foreground-2))}.clear-button:hover calcite-icon{color:var(--calcite-input-actions-icon-color-hover, var(--calcite-color-text-1))}.clear-button:active{background-color:var(--calcite-input-actions-background-color-press, var(--calcite-color-foreground-3))}.clear-button:active calcite-icon{color:var(--calcite-input-actions-icon-color-press, var(--calcite-color-text-1))}.clear-button:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.clear-button:disabled{opacity:var(--calcite-opacity-disabled)}.loader{inset-block-start:1px;inset-inline:1px;pointer-events:none;position:absolute;display:block;--calcite-progress-background-color: var(--calcite-input-loading-background-color);--calcite-progress-fill-color: var(--calcite-input-loading-fill-color)}.action-wrapper{order:7;display:flex}.prefix,.suffix{box-sizing:border-box;display:flex;block-size:auto;min-block-size:100%;-webkit-user-select:none;user-select:none;align-content:center;align-items:center;overflow-wrap:break-word;border-width:1px;border-style:solid;font-weight:var(--calcite-font-weight-medium);line-height:1;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input))}.prefix{order:2;border-inline-end-width:0px;inline-size:var(--calcite-input-prefix-size, auto);background-color:var(--calcite-input-prefix-background-color, var(--calcite-color-background));color:var(--calcite-input-prefix-text-color, var(--calcite-color-text-2))}.suffix{order:5;border-inline-start-width:0px;inline-size:var(--calcite-input-suffix-size, auto);background-color:var(--calcite-input-suffix-background-color, var(--calcite-color-background));color:var(--calcite-input-suffix-text-color, var(--calcite-color-text-2))}:host([alignment=start]) textarea,:host([alignment=start]) input{text-align:start}:host([alignment=end]) textarea,:host([alignment=end]) input{text-align:end}input[type=number]{-moz-appearance:textfield}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;-moz-appearance:textfield;margin:0}.number-button-wrapper{pointer-events:none;order:6;box-sizing:border-box;display:flex;flex-direction:column;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out}:host([number-button-type=vertical]) .wrapper{flex-direction:row;display:flex}:host([number-button-type=vertical]) input,:host([number-button-type=vertical]) textarea{order:2}:host([number-button-type=horizontal]) .calcite--rtl .number-button-item[data-adjustment=down] calcite-icon{transform:rotate(-90deg)}:host([number-button-type=horizontal]) .calcite--rtl .number-button-item[data-adjustment=up] calcite-icon{transform:rotate(-90deg)}.number-button-item.number-button-item--horizontal{border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));order:1;max-block-size:100%;min-block-size:100%;align-self:stretch;border-width:1px;border-style:solid}.number-button-item.number-button-item--horizontal[data-adjustment=down] calcite-icon,.number-button-item.number-button-item--horizontal[data-adjustment=up] calcite-icon{transform:rotate(90deg)}.number-button-item.number-button-item--horizontal[data-adjustment=down]{border-inline-end-width:0px}.number-button-item.number-button-item--horizontal[data-adjustment=up]{border-inline-start-width:0px;order:5}.number-button-item{max-block-size:50%;min-block-size:50%;pointer-events:initial;margin:0;box-sizing:border-box;display:flex;cursor:pointer;align-items:center;align-self:center;border-width:1px;border-style:solid;background-color:var(--calcite-color-foreground-1);padding-block:0px;padding-inline:.5rem;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-actions-background-color, var(--calcite-color-foreground-1));border-inline-start-width:0px}.number-button-item calcite-icon{pointer-events:none;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-actions-icon-color, var(--calcite-color-text-3))}.number-button-item:hover{background-color:var(--calcite-input-actions-background-color-hover, var(--calcite-color-foreground-2))}.number-button-item:hover calcite-icon{color:var(--calcite-input-actions-icon-color-hover, var(--calcite-color-text-1))}.number-button-item:active{background-color:var(--calcite-input-actions-background-color-press, var(--calcite-color-foreground-3))}.number-button-item:active calcite-icon{color:var(--calcite-input-actions-icon-color-press, var(--calcite-color-text-1))}.number-button-item:disabled{pointer-events:none}.wrapper{position:relative;display:flex;flex-direction:row;align-items:center;border-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));box-shadow:var(--calcite-input-shadow, var(--calcite-shadow-none))}input[type=date]::-webkit-input-placeholder{visibility:hidden!important}:host([type=color]) input{padding:.25rem}:host([type=file]) input{cursor:pointer;border-width:1px;border-style:dashed;background-color:var(--calcite-color-foreground-1);text-align:center;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));block-size:initial}:host([type=file][scale=s]) input{padding-block:1px;padding-inline:.5rem}:host([type=file][scale=m]) input{padding-block:.25rem;padding-inline:.75rem}:host([type=file][scale=l]) input{padding-block:.5rem;padding-inline:1rem}:host(.no-bottom-border) input{border-block-end-width:0px}:host(.border-top-color-one) input{border-block-start-color:var(--calcite-color-border-1)}input.inline-child{background-color:transparent;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out}input.inline-child .editing-enabled{background-color:inherit}input.inline-child:not(.editing-enabled){display:flex;cursor:pointer;text-overflow:ellipsis;border-color:transparent;padding-inline-start:0}:host([type=datetime-local]) .element-wrapper{inline-size:100%}:host([type=datetime-local]) .element-wrapper input{display:inline-block;min-inline-size:0}.internal-label-alignment--center{align-items:center}.internal-label-alignment--end{align-items:end}.internal-label--container{display:flex;justify-content:space-between;color:var(--calcite-color-text-1)}.internal-label-required--indicator{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-status-danger);padding-inline:var(--calcite-spacing-base)}.internal-label-required--indicator:hover{cursor:help}.internal-label--text{line-height:1}:host([scale=s]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-xxs)}:host([scale=s]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label--text{font-size:var(--calcite-font-size--2)}:host([scale=m]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label--text{font-size:var(--calcite-font-size--1)}:host([scale=l]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=l]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-md)}:host([scale=l]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-md)}:host([scale=l]) .internal-label--text{font-size:var(--calcite-font-size-0)}.validation-container{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch}:host([scale=m]) .validation-container,:host([scale=l]) .validation-container{padding-block-start:.5rem}:host([scale=s]) .validation-container{padding-block-start:.25rem}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}::placeholder{font-weight:var(--calcite-font-weight-normal);color:var(--calcite-input-placeholder-text-color, var(--calcite-color-text-3))}`,k1=class k1 extends ji{constructor(){super(),this.actionWrapperRef=Yn(),this.attributeWatch=_$(["autofocus","enterkeyhint","inputmode","spellcheck"],this.handleGlobalAttributesChanged),this.childRef=Yn(),this.childElType="input",this.childNumberRef=Yn(),this.inputWrapperRef=Yn(),this.onHiddenFormInputInput=e=>{e.target.name===this.name&&this.setValue({value:e.target.value,origin:"direct"}),this.setFocus(),e.stopPropagation()},this.previousValueOrigin="initial",this.userChangedValue=!1,this._value="",this.messages=fo(),this.focusSetter=zs()(this),this.slottedActionElDisabledInternally=!1,this.alignment="start",this.clearable=!1,this.disabled=!1,this.editingEnabled=!1,this.groupSeparator=!1,this.iconFlipRtl=!1,this.loading=!1,this.localeFormat=!1,this.multiple=!1,this.numberButtonType="vertical",this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.type="text",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.calciteInputChange=vt({cancelable:!1}),this.calciteInputInput=vt(),this.calciteInternalInputBlur=vt({cancelable:!1}),this.calciteInternalInputFocus=vt({cancelable:!1}),this.listen("click",this.clickHandler),this.listen("keydown",this.keyDownHandler)}get value(){return this._value}set value(e){const i=this._value;e!==i&&(this._value=e,this.valueWatcher(e,i),e&&this._value===""&&this.setValue({origin:"reset",value:i}))}async selectText(){(this.type==="number"?this.childNumberRef:this.childRef).value?.select()}async setFocus(e){return this.focusSetter(()=>this.type==="number"?this.childNumberRef.value:this.childRef.value,e)}connectedCallback(){super.connectedCallback(),this.inlineEditableEl=this.el.closest("calcite-inline-editable"),this.inlineEditableEl&&(this.editingEnabled=this.inlineEditableEl.editingEnabled||!1),X0(this),VR(this),this.el.addEventListener(mC,this.onHiddenFormInputInput)}async load(){this.childElType=this.type==="textarea"?"textarea":"input",this.maxString=this.max?.toString(),this.minString=this.min?.toString(),this.requestedIcon=em(YA,this.icon,this.type),this.setPreviousEmittedValue(this.value),this.setPreviousValue(this.value),this.type==="number"&&(this.value==="Infinity"||this.value==="-Infinity"?(this.displayedValue=this.value,this.previousEmittedValue=this.value):(this.warnAboutInvalidNumberValue(this.value),this.setValue({origin:"connected",value:ac(this.value)?this.value:""})))}willUpdate(e){e.has("max")&&(this.maxString=this.max?.toString()||null),e.has("min")&&(this.minString=this.min?.toString()||null),(e.has("icon")||e.has("type")&&(this.hasUpdated||this.type!=="text"))&&(this.requestedIcon=em(YA,this.icon,this.type))}updated(){mo(this)}disconnectedCallback(){super.disconnectedCallback(),D$(this),GR(this),this.el.removeEventListener(mC,this.onHiddenFormInputInput)}get isClearable(){return!this.isTextarea&&(this.clearable||this.type==="search")&&this.value?.length>0}get isTextarea(){return this.childElType==="textarea"}handleGlobalAttributesChanged(){this.requestUpdate()}valueWatcher(e,i){if(!this.userChangedValue){if(this.type==="number"&&(e==="Infinity"||e==="-Infinity")){this.displayedValue=e,this.previousEmittedValue=e;return}this.setValue({origin:"direct",previousValue:i,value:e==null||e==""?"":this.type==="number"?ac(e)?e:this.previousValue||"":e}),this.warnAboutInvalidNumberValue(e)}this.userChangedValue=!1}keyDownHandler(e){this.readOnly||this.disabled||e.defaultPrevented||(this.isClearable&&e.key==="Escape"&&(this.clearInputValue(e),e.preventDefault()),e.key==="Enter"&&lw(this)&&e.preventDefault())}onLabelClick(){this.setFocus()}incrementOrDecrementNumberValue(e,i,r,o){const{value:h}=this;if(h==="Infinity"||h==="-Infinity")return;const d=e==="up"?1:-1,a=this.step==="any"?1:Math.abs(this.step||1),T=new sm(h!==""?h:"0").add(`${a*d}`),E=()=>typeof r=="number"&&!isNaN(r)&&T.subtract(`${r}`).isNegative,k=()=>typeof i=="number"&&!isNaN(i)&&!T.subtract(`${i}`).isNegative,L=E()?`${r}`:k()?`${i}`:T.toString();this.setValue({committing:!0,nativeEvent:o,origin:"user",value:L})}clearInputValue(e){this.setValue({committing:!0,nativeEvent:e,origin:"user",value:""})}emitChangeIfUserModified(){this.previousValueOrigin==="user"&&this.value!==this.previousEmittedValue&&(this.calciteInputChange.emit(),this.setPreviousEmittedValue(this.value))}inputBlurHandler(){window.clearInterval(this.nudgeNumberValueIntervalId),this.calciteInternalInputBlur.emit(),this.emitChangeIfUserModified()}clickHandler(e){if(this.disabled)return;const i=e.composedPath();!i.includes(this.inputWrapperRef.value)||i.includes(this.actionWrapperRef.value)||this.setFocus()}inputFocusHandler(){this.calciteInternalInputFocus.emit()}inputInputHandler(e){this.disabled||this.readOnly||(this.type==="file"&&(this.files=this.childRef.value.files),this.setValue({nativeEvent:e,origin:"user",value:e.target.value}))}inputKeyDownHandler(e){this.disabled||this.readOnly||e.key==="Enter"&&this.emitChangeIfUserModified()}inputNumberInputHandler(e){if(this.disabled||this.readOnly||this.value==="Infinity"||this.value==="-Infinity")return;const i=e.target.value;Do.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator};const r=Do.delocalize(i);e.inputType==="insertFromPaste"?(ac(r)||e.preventDefault(),this.setValue({nativeEvent:e,origin:"user",value:RJ(r)}),this.childNumberRef.value.value=this.displayedValue):this.setValue({nativeEvent:e,origin:"user",value:r})}inputNumberKeyDownHandler(e){if(this.type!=="number"||this.disabled||this.readOnly)return;if(this.value==="Infinity"||this.value==="-Infinity"){e.preventDefault(),(e.key==="Backspace"||e.key==="Delete")&&this.clearInputValue(e);return}if(e.key==="ArrowUp"){e.preventDefault(),this.nudgeNumberValue("up",e);return}if(e.key==="ArrowDown"){this.nudgeNumberValue("down",e);return}const i=[...aw,"ArrowLeft","ArrowRight","Backspace","Delete","Enter","Escape","Tab"];if(e.altKey||e.ctrlKey||e.metaKey)return;const r=e.shiftKey&&e.key==="Tab";if(i.includes(e.key)||r){e.key==="Enter"&&this.emitChangeIfUserModified();return}Do.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator},!(e.key===Do.decimal&&(!this.value&&!this.childNumberRef.value.value||this.value&&this.childNumberRef.value.value.indexOf(Do.decimal)===-1))&&(/[eE]/.test(e.key)&&(!this.value&&!this.childNumberRef.value.value||this.value&&!/[eE]/.test(this.childNumberRef.value.value))||e.key==="-"&&(!this.value&&!this.childNumberRef.value.value||this.value&&this.childNumberRef.value.value.split("-").length<=2)||e.preventDefault())}nudgeNumberValue(e,i){if(i instanceof KeyboardEvent&&i.repeat||this.type!=="number")return;const r=this.maxString?parseFloat(this.maxString):null,o=this.minString?parseFloat(this.minString):null,h=150;this.incrementOrDecrementNumberValue(e,r,o,i),this.nudgeNumberValueIntervalId&&window.clearInterval(this.nudgeNumberValueIntervalId);let d=!0;this.nudgeNumberValueIntervalId=window.setInterval(()=>{if(d){d=!1;return}this.incrementOrDecrementNumberValue(e,r,o,i)},h)}numberButtonPointerUpAndOutHandler(){window.clearInterval(this.nudgeNumberValueIntervalId)}numberButtonPointerDownHandler(e){if(!yR(e))return;e.preventDefault();const i=e.target.dataset.adjustment;this.disabled||this.nudgeNumberValue(i,e)}syncHiddenFormInput(e){rK(this.type,this,e)}setInputValue(e){const i=this.type==="number"?this.childNumberRef:this.childRef;i.value&&(i.value.value=e)}setPreviousEmittedValue(e){this.previousEmittedValue=this.normalizeValue(e)}normalizeValue(e){return this.type==="number"?ac(e)?e:"":e}setPreviousValue(e){this.previousValue=this.normalizeValue(e)}setValue({committing:e=!1,nativeEvent:i,origin:r,previousValue:o,value:h}){if(this.setPreviousValue(o??this.value),this.previousValueOrigin=r,this.type==="number"){Do.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator,signDisplay:"never"};const d=this.previousValue?.length>h.length||this.value?.length>h.length,a=h.charAt(h.length-1)===".",_=a&&d?h:UJ(h),T=h&&!_?ac(this.previousValue)?this.previousValue:"":_;let E=Do.localize(T);r!=="connected"&&!a&&(E=HJ(E,T,Do)),this.displayedValue=a&&d?`${E}${Do.decimal}`:E,this.userChangedValue=r==="user"&&this.value!==T,this.value=["-","."].includes(T)?"":T}else this.userChangedValue=r==="user"&&this.value!==h,this.value=h;r==="direct"&&(this.setInputValue(h),this.previousEmittedValue=h),i&&(this.calciteInputInput.emit().defaultPrevented?(this.value=this.previousValue,this.displayedValue=this.type==="number"?Do.localize(this.previousValue):this.previousValue):e&&this.emitChangeIfUserModified())}inputKeyUpHandler(){window.clearInterval(this.nudgeNumberValueIntervalId)}warnAboutInvalidNumberValue(e){this.type==="number"&&e&&!ac(e)&&console.warn(`The specified value "${e}" cannot be parsed, or is out of range.`)}render(){const e=Z0(this.el),i=Ne`<div class=${Fe(Mn.loader)}><calcite-progress .label=${this.messages.loading} type=indeterminate></calcite-progress></div>`,r=Ne`<button .ariaLabel=${this.messages.clear} class=${Fe(Mn.clearButton)} .disabled=${this.disabled||this.readOnly} @click=${this.clearInputValue} tabindex=-1 title=${this.messages.clear??ut} type=button><calcite-icon .icon=${VS.close} .scale=${Br(this.scale)}></calcite-icon></button>`,o=Ne`<calcite-icon class=${Fe(Mn.inputIcon)} .flipRtl=${this.iconFlipRtl} .icon=${this.requestedIcon} .scale=${Br(this.scale)}></calcite-icon>`,h=this.numberButtonType==="horizontal",d=Ne`<button aria-hidden=true class=${Fe({[Mn.numberButtonItem]:!0,[Mn.buttonItemHorizontal]:h})} data-adjustment=${XA.up} .disabled=${this.disabled||this.readOnly} @pointerdown=${this.numberButtonPointerDownHandler} @pointerout=${this.numberButtonPointerUpAndOutHandler} @pointerup=${this.numberButtonPointerUpAndOutHandler} tabindex=-1 type=button><calcite-icon .icon=${VS.chevronUp} .scale=${Br(this.scale)}></calcite-icon></button>`,a=Ne`<button aria-hidden=true class=${Fe({[Mn.numberButtonItem]:!0,[Mn.buttonItemHorizontal]:h})} data-adjustment=${XA.down} .disabled=${this.disabled||this.readOnly} @pointerdown=${this.numberButtonPointerDownHandler} @pointerout=${this.numberButtonPointerUpAndOutHandler} @pointerup=${this.numberButtonPointerUpAndOutHandler} tabindex=-1 type=button><calcite-icon .icon=${VS.chevronDown} .scale=${Br(this.scale)}></calcite-icon></button>`,_=Ne`<div class=${Fe(Mn.numberButtonWrapper)}>${d}${a}</div>`,T=Ne`<div class=${Fe(Mn.prefix)}>${this.prefixText}</div>`,E=Ne`<div class=${Fe(Mn.suffix)}>${this.suffixText}</div>`,k=this.el.autofocus,L=this.el.enterKeyHint,O=this.el.inputMode,H=this.type==="number"?ai("localized-input",Ne`<input accept=${this.accept??ut} aria-errormessage=${US.validationMessage} .ariaInvalid=${this.status==="invalid"} .ariaLabel=${Ox(this)} autocomplete=${this.autocomplete??ut} .autofocus=${k} value=${this.defaultValue??ut} .disabled=${this.disabled?!0:null} enterkeyhint=${L??ut} inputmode=${O??ut} maxlength=${this.maxLength??ut} minlength=${this.minLength??ut} .multiple=${this.multiple} name=${ut} @blur=${this.inputBlurHandler} @focus=${this.inputFocusHandler} @input=${this.inputNumberInputHandler} @keydown=${this.inputNumberKeyDownHandler} @keyup=${this.inputKeyUpHandler} pattern=${this.pattern??ut} placeholder=${(this.placeholder||"")??ut} .readOnly=${this.readOnly} .required=${this.required} type=text .value=${q3(this.displayedValue??"")} ${hi(this.childNumberRef)}>`):null,re=this.childElType==="input"?v0`input`:v0`textarea`,pe=this.type!=="number"?k$`<${re} accept=${this.accept??ut} aria-errormessage=${US.validationMessage} .ariaInvalid=${this.status==="invalid"} .ariaLabel=${Ox(this)} autocomplete=${this.autocomplete??ut} .autofocus=${k} class=${Fe({[Mn.editingEnabled]:this.editingEnabled,[Mn.inlineChild]:!!this.inlineEditableEl})} .defaultValue=${this.defaultValue??""} .disabled=${this.disabled?!0:null} enterkeyhint=${L??ut} inputmode=${O??ut} max=${this.maxString??ut} maxlength=${this.maxLength??ut} min=${this.minString??ut} minlength=${this.minLength??ut} .multiple=${this.multiple} name=${this.name??ut} @blur=${this.inputBlurHandler} @focus=${this.inputFocusHandler} @input=${this.inputInputHandler} @keydown=${this.inputKeyDownHandler} @keyup=${this.inputKeyUpHandler} pattern=${this.pattern??ut} placeholder=${(this.placeholder||"")??ut} .readOnly=${this.readOnly} .required=${this.required?!0:null} spellcheck=${this.el.spellcheck??ut} step=${this.step??ut} tabindex=${(this.disabled||this.inlineEditableEl&&!this.editingEnabled?-1:null)??ut} type=${this.type??ut} .value=${q3(this.value??"")} ${hi(this.childRef)}></${re}>`:null;return go({disabled:this.disabled,children:Ne`${this.labelText&&oL({labelText:this.labelText,onClick:this.onLabelClick,required:this.required,tooltipText:this.messages.required})||""}<div class=${Fe({[Mn.inputWrapper]:!0,[JO.rtl]:e==="rtl",[Mn.hasSuffix]:this.suffixText,[Mn.hasPrefix]:this.prefixText})} ${hi(this.inputWrapperRef)}>${this.type==="number"&&this.numberButtonType==="horizontal"&&!this.readOnly?a:null}${this.prefixText?T:null}<div class=${Fe(Mn.wrapper)}>${H}${pe}${this.isClearable?r:null}${this.requestedIcon?o:null}${this.loading?i:null}</div><div class=${Fe(Mn.actionWrapper)} ${hi(this.actionWrapperRef)}><slot name=${nK.action}></slot></div>${this.type==="number"&&this.numberButtonType==="vertical"&&!this.readOnly?_:null}${this.suffixText?E:null}${this.type==="number"&&this.numberButtonType==="horizontal"&&!this.readOnly?d:null}${HR({component:this})}</div>${this.validationMessage&&this.status==="invalid"?aL({icon:this.validationIcon,id:US.validationMessage,message:this.validationMessage,scale:this.scale,status:this.status}):null}`})}};k1.properties={displayedValue:[16,{},{state:!0}],slottedActionElDisabledInternally:[16,{},{state:!0}],accept:1,alignment:[3,{},{reflect:!0}],autocomplete:[0,{},{attribute:!1}],clearable:[7,{},{reflect:!0,type:Boolean}],disabled:[7,{},{reflect:!0,type:Boolean}],editingEnabled:[7,{},{reflect:!0,type:Boolean}],files:[0,{},{attribute:!1}],form:[3,{},{reflect:!0}],groupSeparator:[7,{},{reflect:!0,type:Boolean}],icon:[3,{converter:_d},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],label:1,labelText:1,loading:[7,{},{reflect:!0,type:Boolean}],localeFormat:[5,{},{type:Boolean}],max:[11,{},{reflect:!0,type:Number}],maxLength:[11,{},{reflect:!0,type:Number}],messageOverrides:[0,{},{attribute:!1}],min:[11,{},{reflect:!0,type:Number}],minLength:[11,{},{reflect:!0,type:Number}],multiple:[5,{},{type:Boolean}],name:[3,{},{reflect:!0}],numberButtonType:[3,{},{reflect:!0}],numberingSystem:[3,{},{reflect:!0}],pattern:1,placeholder:1,prefixText:1,readOnly:[7,{},{reflect:!0,type:Boolean}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}],step:[3,{},{reflect:!0}],suffixText:1,type:[3,{},{reflect:!0}],validationIcon:[3,{converter:_d},{reflect:!0}],validationMessage:1,validity:[0,{},{attribute:!1}],value:1},k1.styles=sK;let PC=k1;ar("calcite-input",PC);function lL(t){if(t==null)return"";if(typeof t=="string")return t;if(Array.isArray(t))return t.map(lL).join(",");const e=String(t);return e==="0"&&Object.is(Number(t),-0)?"-0":e}function oK(t,e=JY){if(t==null)return t;for(const i in t)if(e(t[i],i,t)===!1)break;return t}function cL(t){return KY(lL(t))}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const GS=(t,e,i)=>{const r=cL(e),o=new RegExp(r,"i");t.length===0&&console.warn(`No data was passed to the filter function.
    The data argument should be an array of objects`);const h=(d,a,_)=>{if(d?.constant||d?.filterDisabled)return!0;let T=!1;return oK(d,(E,k)=>{typeof E=="function"||E==null||_&&!_.includes(k)||(Array.isArray(E)||typeof E=="object"&&E!==null?h(E,a)&&(T=!0):a.test(E)&&(T=!0))}),T};return t.filter(d=>h(d,o,i))};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const z$=()=>y$((t,e)=>{const i=new Set;return e.onDisconnected(()=>{i.forEach(r=>r.cancel())}),{add:r=>{[r].flat().forEach(o=>i.add(o))},resources:i}});/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const aK={container:"container"},lK={search:"search"},cK=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;inline-size:100%}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{display:flex;inline-size:100%}:host([scale=s]) .container{padding:var(--calcite-filter-content-space, var(--calcite-spacing-sm))}:host([scale=m]) .container{padding:var(--calcite-filter-content-space, var(--calcite-spacing-md))}:host([scale=l]) .container{padding:var(--calcite-filter-content-space, var(--calcite-spacing-lg))}label{position:relative;margin-block:0px;display:flex;inline-size:100%;align-items:center;overflow:hidden}calcite-input{inline-size:100%;--calcite-input-background-color: var(--calcite-filter-input-background-color);--calcite-input-border-color: var(--calcite-filter-input-border-color);--calcite-input-corner-radius: var(--calcite-filter-input-corner-radius);--calcite-input-shadow: var(--calcite-filter-input-shadow);--calcite-input-icon-color: var(--calcite-filter-input-icon-color);--calcite-input-text-color: var(--calcite-filter-input-text-color);--calcite-input-placeholder-text-color: var(--calcite-filter-input-placeholder-text-color);--calcite-input-actions-background-color: var(--calcite-filter-input-actions-background-color);--calcite-input-actions-background-color-hover: var(--calcite-filter-input-actions-background-color-hover);--calcite-input-actions-background-color-press: var(--calcite-filter-input-actions-background-color-press);--calcite-input-actions-icon-color: var(--calcite-filter-input-actions-icon-color);--calcite-input-actions-icon-color-hover: var(--calcite-filter-input-actions-icon-color-hover);--calcite-input-actions-icon-color-press: var(--calcite-filter-input-actions-icon-color-press)}:host([hidden]){display:none}[hidden]{display:none}`,s0=class s0 extends ji{constructor(){super(...arguments),this.cancelable=z$()(this),this.filterDebounced=sw((e,i=!1,r)=>this.updateFiltered(GS(this.items??[],e,this.filterProps),i,r),g$.filter),this.textInput=Yn(),this._value="",this.messages=fo(),this.focusSetter=zs()(this),this.disabled=!1,this.filteredItems=[],this.items=[],this.scale="m",this.calciteFilterChange=vt({cancelable:!1})}get value(){return this._value}set value(e){const i=this._value;e!==i&&(this._value=e,this.valueHandler(e))}async filter(e=this.value){return new Promise(i=>{this.value=e,this.updateFiltered(GS(this.items??[],e,this.filterProps),!1,i)})}async setFocus(e){return this.focusSetter(()=>this.textInput.value,e)}connectedCallback(){super.connectedCallback(),this.cancelable.add(this.filterDebounced)}async load(){this.updateFiltered(GS(this.items??[],this.value,this.filterProps))}willUpdate(e){(e.has("items")&&(this.hasUpdated||this.items?.length>0)||e.has("filterProps"))&&this.filterDebounced(this.value)}updated(){mo(this)}valueHandler(e){this.filterDebounced(e)}inputHandler(e){const i=e.target;this.value=i.value,this.filterDebounced(i.value,!0)}keyDownHandler(e){e.defaultPrevented||(e.key==="Escape"&&(this.clear(),e.preventDefault()),e.key==="Enter"&&e.preventDefault())}clear(){this.value="",this.filterDebounced("",!0),this.setFocus()}updateFiltered(e,i=!1,r){this.filteredItems=e,i&&this.calciteFilterChange.emit(),r?.()}render(){const{disabled:e,scale:i}=this;return go({disabled:e,children:Ne`<div class=${Fe(aK.container)}><label><calcite-input clearable .disabled=${e} .icon=${lK.search} .label=${this.label??this.messages.label} .messageOverrides=${{clear:this.messages.clear}} @keydown=${this.keyDownHandler} @calciteInputInput=${this.inputHandler} .placeholder=${this.placeholder} .scale=${i} type=text .value=${this.value} ${hi(this.textInput)}></calcite-input></label></div>`})}};s0.properties={disabled:[7,{},{reflect:!0,type:Boolean}],filterProps:[0,{},{attribute:!1}],filteredItems:[0,{},{attribute:!1}],items:[0,{},{attribute:!1}],label:1,messageOverrides:[0,{},{attribute:!1}],placeholder:1,scale:[3,{},{reflect:!0}],value:1},s0.shadowRootOptions={mode:"open",delegatesFocus:!0},s0.styles=cK;let MC=s0;ar("calcite-filter",MC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const By="calcite-list",Fx="calcite-list-item-group",pc="calcite-list-item";function kC(t){const e=t.parentElement?.closest(pc);e&&(e.open=!0,kC(e))}function uK(t){const e=t.assignedElements({flatten:!0}),i=e.filter(h=>h?.matches(Fx)).map(h=>Array.from(h.querySelectorAll(pc))).flat(),r=e.filter(h=>h?.matches(pc));return{lists:e.filter(h=>h?.matches(By)),items:i.concat(r)}}function hK(t){const e=t.assignedElements({flatten:!0}).filter(r=>r.matches(pc)),i=e.filter(r=>!r.filterHidden);e.forEach(r=>{const o=i.indexOf(r);r.setPosition=o===-1?void 0:o+1,r.setSize=o===-1?void 0:i.length})}function dK(t,e=!1){const i=e?"ancestor::calcite-list-item | ancestor::calcite-list-item-group":"ancestor::calcite-list-item";return document.evaluate(i,t,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength}function zv(t){return t.tagName==="CALCITE-LIST-ITEM"}/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function JA(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,r)}return i}function yl(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?JA(Object(i),!0).forEach(function(r){pK(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):JA(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function db(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?db=function(e){return typeof e}:db=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},db(t)}function pK(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function yc(){return yc=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},yc.apply(this,arguments)}function fK(t,e){if(t==null)return{};var i={},r=Object.keys(t),o,h;for(h=0;h<r.length;h++)o=r[h],!(e.indexOf(o)>=0)&&(i[o]=t[o]);return i}function mK(t,e){if(t==null)return{};var i=fK(t,e),r,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);for(o=0;o<h.length;o++)r=h[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}var gK="1.15.6";function fc(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var vc=fc(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),J0=fc(/Edge/i),KA=fc(/firefox/i),jy=fc(/safari/i)&&!fc(/chrome/i)&&!fc(/android/i),O$=fc(/iP(ad|od|hone)/i),uL=fc(/chrome/i)&&fc(/android/i),hL={capture:!1,passive:!1};function yi(t,e,i){t.addEventListener(e,i,!vc&&hL)}function fi(t,e,i){t.removeEventListener(e,i,!vc&&hL)}function Nx(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function dL(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function ga(t,e,i,r){if(t){i=i||document;do{if(e!=null&&(e[0]===">"?t.parentNode===i&&Nx(t,e):Nx(t,e))||r&&t===i)return t;if(t===i)break}while(t=dL(t))}return null}var QA=/\s+/g;function Qs(t,e,i){if(t&&e)if(t.classList)t.classList[i?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(QA," ").replace(" "+e+" "," ");t.className=(r+(i?" "+e:"")).replace(QA," ")}}function jt(t,e,i){var r=t&&t.style;if(r){if(i===void 0)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),e===void 0?i:i[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=i+(typeof i=="string"?"":"px")}}function Mf(t,e){var i="";if(typeof t=="string")i=t;else do{var r=jt(t,"transform");r&&r!=="none"&&(i=r+" "+i)}while(!e&&(t=t.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(i)}function pL(t,e,i){if(t){var r=t.getElementsByTagName(e),o=0,h=r.length;if(i)for(;o<h;o++)i(r[o],o);return r}return[]}function ml(){var t=document.scrollingElement;return t||document.documentElement}function Qr(t,e,i,r,o){if(!(!t.getBoundingClientRect&&t!==window)){var h,d,a,_,T,E,k;if(t!==window&&t.parentNode&&t!==ml()?(h=t.getBoundingClientRect(),d=h.top,a=h.left,_=h.bottom,T=h.right,E=h.height,k=h.width):(d=0,a=0,_=window.innerHeight,T=window.innerWidth,E=window.innerHeight,k=window.innerWidth),(e||i)&&t!==window&&(o=o||t.parentNode,!vc))do if(o&&o.getBoundingClientRect&&(jt(o,"transform")!=="none"||i&&jt(o,"position")!=="static")){var L=o.getBoundingClientRect();d-=L.top+parseInt(jt(o,"border-top-width")),a-=L.left+parseInt(jt(o,"border-left-width")),_=d+h.height,T=a+h.width;break}while(o=o.parentNode);if(r&&t!==window){var O=Mf(o||t),H=O&&O.a,re=O&&O.d;O&&(d/=re,a/=H,k/=H,E/=re,_=d+E,T=a+k)}return{top:d,left:a,bottom:_,right:T,width:k,height:E}}}function eD(t,e,i){for(var r=Pu(t,!0),o=Qr(t)[e];r;){var h=Qr(r)[i],d=void 0;if(d=o>=h,!d)return r;if(r===ml())break;r=Pu(r,!1)}return!1}function om(t,e,i,r){for(var o=0,h=0,d=t.children;h<d.length;){if(d[h].style.display!=="none"&&d[h]!==Ut.ghost&&(r||d[h]!==Ut.dragged)&&ga(d[h],i.draggable,t,!1)){if(o===e)return d[h];o++}h++}return null}function R$(t,e){for(var i=t.lastElementChild;i&&(i===Ut.ghost||jt(i,"display")==="none"||e&&!Nx(i,e));)i=i.previousElementSibling;return i||null}function zo(t,e){var i=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==Ut.clone&&(!e||Nx(t,e))&&i++;return i}function tD(t){var e=0,i=0,r=ml();if(t)do{var o=Mf(t),h=o.a,d=o.d;e+=t.scrollLeft*h,i+=t.scrollTop*d}while(t!==r&&(t=t.parentNode));return[e,i]}function yK(t,e){for(var i in t)if(t.hasOwnProperty(i)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t[i][r])return Number(i)}return-1}function Pu(t,e){if(!t||!t.getBoundingClientRect)return ml();var i=t,r=!1;do if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var o=jt(i);if(i.clientWidth<i.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||i.clientHeight<i.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!i.getBoundingClientRect||i===document.body)return ml();if(r||e)return i;r=!0}}while(i=i.parentNode);return ml()}function _K(t,e){if(t&&e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function qS(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var Uy;function fL(t,e){return function(){if(!Uy){var i=arguments,r=this;i.length===1?t.call(r,i[0]):t.apply(r,i),Uy=setTimeout(function(){Uy=void 0},e)}}}function vK(){clearTimeout(Uy),Uy=void 0}function mL(t,e,i){t.scrollLeft+=e,t.scrollTop+=i}function gL(t){var e=window.Polymer,i=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):i?i(t).clone(!0)[0]:t.cloneNode(!0)}function yL(t,e,i){var r={};return Array.from(t.children).forEach(function(o){var h,d,a,_;if(!(!ga(o,e.draggable,t,!1)||o.animated||o===i)){var T=Qr(o);r.left=Math.min((h=r.left)!==null&&h!==void 0?h:1/0,T.left),r.top=Math.min((d=r.top)!==null&&d!==void 0?d:1/0,T.top),r.right=Math.max((a=r.right)!==null&&a!==void 0?a:-1/0,T.right),r.bottom=Math.max((_=r.bottom)!==null&&_!==void 0?_:-1/0,T.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var Ms="Sortable"+new Date().getTime();function bK(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(o){if(!(jt(o,"display")==="none"||o===Ut.ghost)){t.push({target:o,rect:Qr(o)});var h=yl({},t[t.length-1].rect);if(o.thisAnimationDuration){var d=Mf(o,!0);d&&(h.top-=d.f,h.left-=d.e)}o.fromRect=h}})}},addAnimationState:function(r){t.push(r)},removeAnimationState:function(r){t.splice(yK(t,{target:r}),1)},animateAll:function(r){var o=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var h=!1,d=0;t.forEach(function(a){var _=0,T=a.target,E=T.fromRect,k=Qr(T),L=T.prevFromRect,O=T.prevToRect,H=a.rect,re=Mf(T,!0);re&&(k.top-=re.f,k.left-=re.e),T.toRect=k,T.thisAnimationDuration&&qS(L,k)&&!qS(E,k)&&(H.top-k.top)/(H.left-k.left)===(E.top-k.top)/(E.left-k.left)&&(_=wK(H,L,O,o.options)),qS(k,E)||(T.prevFromRect=E,T.prevToRect=k,_||(_=o.options.animation),o.animate(T,H,k,_)),_&&(h=!0,d=Math.max(d,_),clearTimeout(T.animationResetTimer),T.animationResetTimer=setTimeout(function(){T.animationTime=0,T.prevFromRect=null,T.fromRect=null,T.prevToRect=null,T.thisAnimationDuration=null},_),T.thisAnimationDuration=_)}),clearTimeout(e),h?e=setTimeout(function(){typeof r=="function"&&r()},d):typeof r=="function"&&r(),t=[]},animate:function(r,o,h,d){if(d){jt(r,"transition",""),jt(r,"transform","");var a=Mf(this.el),_=a&&a.a,T=a&&a.d,E=(o.left-h.left)/(_||1),k=(o.top-h.top)/(T||1);r.animatingX=!!E,r.animatingY=!!k,jt(r,"transform","translate3d("+E+"px,"+k+"px,0)"),this.forRepaintDummy=xK(r),jt(r,"transition","transform "+d+"ms"+(this.options.easing?" "+this.options.easing:"")),jt(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){jt(r,"transition",""),jt(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},d)}}}}function xK(t){return t.offsetWidth}function wK(t,e,i,r){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))*r.animation}var jp=[],HS={initializeByDefault:!0},K0={mount:function(e){for(var i in HS)HS.hasOwnProperty(i)&&!(i in e)&&(e[i]=HS[i]);jp.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),jp.push(e)},pluginEvent:function(e,i,r){var o=this;this.eventCanceled=!1,r.cancel=function(){o.eventCanceled=!0};var h=e+"Global";jp.forEach(function(d){i[d.pluginName]&&(i[d.pluginName][h]&&i[d.pluginName][h](yl({sortable:i},r)),i.options[d.pluginName]&&i[d.pluginName][e]&&i[d.pluginName][e](yl({sortable:i},r)))})},initializePlugins:function(e,i,r,o){jp.forEach(function(a){var _=a.pluginName;if(!(!e.options[_]&&!a.initializeByDefault)){var T=new a(e,i,e.options);T.sortable=e,T.options=e.options,e[_]=T,yc(r,T.defaults)}});for(var h in e.options)if(e.options.hasOwnProperty(h)){var d=this.modifyOption(e,h,e.options[h]);typeof d<"u"&&(e.options[h]=d)}},getEventProperties:function(e,i){var r={};return jp.forEach(function(o){typeof o.eventProperties=="function"&&yc(r,o.eventProperties.call(i[o.pluginName],e))}),r},modifyOption:function(e,i,r){var o;return jp.forEach(function(h){e[h.pluginName]&&h.optionListeners&&typeof h.optionListeners[i]=="function"&&(o=h.optionListeners[i].call(e[h.pluginName],r))}),o}};function SK(t){var e=t.sortable,i=t.rootEl,r=t.name,o=t.targetEl,h=t.cloneEl,d=t.toEl,a=t.fromEl,_=t.oldIndex,T=t.newIndex,E=t.oldDraggableIndex,k=t.newDraggableIndex,L=t.originalEvent,O=t.putSortable,H=t.extraEventProperties;if(e=e||i&&i[Ms],!!e){var re,pe=e.options,ge="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!vc&&!J0?re=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(re=document.createEvent("Event"),re.initEvent(r,!0,!0)),re.to=d||i,re.from=a||i,re.item=o||i,re.clone=h,re.oldIndex=_,re.newIndex=T,re.oldDraggableIndex=E,re.newDraggableIndex=k,re.originalEvent=L,re.pullMode=O?O.lastPutMode:void 0;var Se=yl(yl({},H),K0.getEventProperties(r,e));for(var Pe in Se)re[Pe]=Se[Pe];i&&i.dispatchEvent(re),pe[ge]&&pe[ge].call(e,re)}}var TK=["evt"],bs=function(e,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=r.evt,h=mK(r,TK);K0.pluginEvent.bind(Ut)(e,i,yl({dragEl:gt,parentEl:xr,ghostEl:Yt,rootEl:rr,nextEl:Nh,lastDownEl:pb,cloneEl:dr,cloneHidden:Tu,dragStarted:py,putSortable:zn,activeSortable:Ut.active,originalEvent:o,oldIndex:yf,oldDraggableIndex:Vy,newIndex:ro,newDraggableIndex:yu,hideGhostForTarget:xL,unhideGhostForTarget:wL,cloneNowHidden:function(){Tu=!0},cloneNowShown:function(){Tu=!1},dispatchSortableEvent:function(a){as({sortable:i,name:a,originalEvent:o})}},h))};function as(t){SK(yl({putSortable:zn,cloneEl:dr,targetEl:gt,rootEl:rr,oldIndex:yf,oldDraggableIndex:Vy,newIndex:ro,newDraggableIndex:yu},t))}var gt,xr,Yt,rr,Nh,pb,dr,Tu,yf,ro,Vy,yu,Ov,zn,tf=!1,Bx=!1,jx=[],Dh,aa,ZS,WS,iD,rD,py,Up,Gy,qy=!1,Rv=!1,fb,Vn,YS=[],AC=!1,Ux=[],cw=typeof document<"u",Lv=O$,nD=J0||vc?"cssFloat":"float",CK=cw&&!uL&&!O$&&"draggable"in document.createElement("div"),_L=(function(){if(cw){if(vc)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}})(),vL=function(e,i){var r=jt(e),o=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),h=om(e,0,i),d=om(e,1,i),a=h&&jt(h),_=d&&jt(d),T=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+Qr(h).width,E=_&&parseInt(_.marginLeft)+parseInt(_.marginRight)+Qr(d).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(h&&a.float&&a.float!=="none"){var k=a.float==="left"?"left":"right";return d&&(_.clear==="both"||_.clear===k)?"vertical":"horizontal"}return h&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||T>=o&&r[nD]==="none"||d&&r[nD]==="none"&&T+E>o)?"vertical":"horizontal"},EK=function(e,i,r){var o=r?e.left:e.top,h=r?e.right:e.bottom,d=r?e.width:e.height,a=r?i.left:i.top,_=r?i.right:i.bottom,T=r?i.width:i.height;return o===a||h===_||o+d/2===a+T/2},IK=function(e,i){var r;return jx.some(function(o){var h=o[Ms].options.emptyInsertThreshold;if(!(!h||R$(o))){var d=Qr(o),a=e>=d.left-h&&e<=d.right+h,_=i>=d.top-h&&i<=d.bottom+h;if(a&&_)return r=o}}),r},bL=function(e){function i(h,d){return function(a,_,T,E){var k=a.options.group.name&&_.options.group.name&&a.options.group.name===_.options.group.name;if(h==null&&(d||k))return!0;if(h==null||h===!1)return!1;if(d&&h==="clone")return h;if(typeof h=="function")return i(h(a,_,T,E),d)(a,_,T,E);var L=(d?a:_).options.group.name;return h===!0||typeof h=="string"&&h===L||h.join&&h.indexOf(L)>-1}}var r={},o=e.group;(!o||db(o)!="object")&&(o={name:o}),r.name=o.name,r.checkPull=i(o.pull,!0),r.checkPut=i(o.put),r.revertClone=o.revertClone,e.group=r},xL=function(){!_L&&Yt&&jt(Yt,"display","none")},wL=function(){!_L&&Yt&&jt(Yt,"display","")};cw&&!uL&&document.addEventListener("click",function(t){if(Bx)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Bx=!1,!1},!0);var zh=function(e){if(gt){e=e.touches?e.touches[0]:e;var i=IK(e.clientX,e.clientY);if(i){var r={};for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);r.target=r.rootEl=i,r.preventDefault=void 0,r.stopPropagation=void 0,i[Ms]._onDragOver(r)}}},$K=function(e){gt&&gt.parentNode[Ms]._isOutsideThisEl(e.target)};function Ut(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=yc({},e),t[Ms]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return vL(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(d,a){d.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Ut.supportPointer!==!1&&"PointerEvent"in window&&(!jy||O$),emptyInsertThreshold:5};K0.initializePlugins(this,t,i);for(var r in i)!(r in e)&&(e[r]=i[r]);bL(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:CK,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?yi(t,"pointerdown",this._onTapStart):(yi(t,"mousedown",this._onTapStart),yi(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(yi(t,"dragover",this),yi(t,"dragenter",this)),jx.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),yc(this,bK())}Ut.prototype={constructor:Ut,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Up=null)},_getDirection:function(e,i){return typeof this.options.direction=="function"?this.options.direction.call(this,e,i,gt):this.options.direction},_onTapStart:function(e){if(e.cancelable){var i=this,r=this.el,o=this.options,h=o.preventOnFilter,d=e.type,a=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,_=(a||e).target,T=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||_,E=o.filter;if(RK(r),!gt&&!(/mousedown|pointerdown/.test(d)&&e.button!==0||o.disabled)&&!T.isContentEditable&&!(!this.nativeDraggable&&jy&&_&&_.tagName.toUpperCase()==="SELECT")&&(_=ga(_,o.draggable,r,!1),!(_&&_.animated)&&pb!==_)){if(yf=zo(_),Vy=zo(_,o.draggable),typeof E=="function"){if(E.call(this,e,_,this)){as({sortable:i,rootEl:T,name:"filter",targetEl:_,toEl:r,fromEl:r}),bs("filter",i,{evt:e}),h&&e.preventDefault();return}}else if(E&&(E=E.split(",").some(function(k){if(k=ga(T,k.trim(),r,!1),k)return as({sortable:i,rootEl:k,name:"filter",targetEl:_,fromEl:r,toEl:r}),bs("filter",i,{evt:e}),!0}),E)){h&&e.preventDefault();return}o.handle&&!ga(T,o.handle,r,!1)||this._prepareDragStart(e,a,_)}}},_prepareDragStart:function(e,i,r){var o=this,h=o.el,d=o.options,a=h.ownerDocument,_;if(r&&!gt&&r.parentNode===h){var T=Qr(r);if(rr=h,gt=r,xr=gt.parentNode,Nh=gt.nextSibling,pb=r,Ov=d.group,Ut.dragged=gt,Dh={target:gt,clientX:(i||e).clientX,clientY:(i||e).clientY},iD=Dh.clientX-T.left,rD=Dh.clientY-T.top,this._lastX=(i||e).clientX,this._lastY=(i||e).clientY,gt.style["will-change"]="all",_=function(){if(bs("delayEnded",o,{evt:e}),Ut.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!KA&&o.nativeDraggable&&(gt.draggable=!0),o._triggerDragStart(e,i),as({sortable:o,name:"choose",originalEvent:e}),Qs(gt,d.chosenClass,!0)},d.ignore.split(",").forEach(function(E){pL(gt,E.trim(),XS)}),yi(a,"dragover",zh),yi(a,"mousemove",zh),yi(a,"touchmove",zh),d.supportPointer?(yi(a,"pointerup",o._onDrop),!this.nativeDraggable&&yi(a,"pointercancel",o._onDrop)):(yi(a,"mouseup",o._onDrop),yi(a,"touchend",o._onDrop),yi(a,"touchcancel",o._onDrop)),KA&&this.nativeDraggable&&(this.options.touchStartThreshold=4,gt.draggable=!0),bs("delayStart",this,{evt:e}),d.delay&&(!d.delayOnTouchOnly||i)&&(!this.nativeDraggable||!(J0||vc))){if(Ut.eventCanceled){this._onDrop();return}d.supportPointer?(yi(a,"pointerup",o._disableDelayedDrag),yi(a,"pointercancel",o._disableDelayedDrag)):(yi(a,"mouseup",o._disableDelayedDrag),yi(a,"touchend",o._disableDelayedDrag),yi(a,"touchcancel",o._disableDelayedDrag)),yi(a,"mousemove",o._delayedDragTouchMoveHandler),yi(a,"touchmove",o._delayedDragTouchMoveHandler),d.supportPointer&&yi(a,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(_,d.delay)}else _()}},_delayedDragTouchMoveHandler:function(e){var i=e.touches?e.touches[0]:e;Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){gt&&XS(gt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;fi(e,"mouseup",this._disableDelayedDrag),fi(e,"touchend",this._disableDelayedDrag),fi(e,"touchcancel",this._disableDelayedDrag),fi(e,"pointerup",this._disableDelayedDrag),fi(e,"pointercancel",this._disableDelayedDrag),fi(e,"mousemove",this._delayedDragTouchMoveHandler),fi(e,"touchmove",this._delayedDragTouchMoveHandler),fi(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,i){i=i||e.pointerType=="touch"&&e,!this.nativeDraggable||i?this.options.supportPointer?yi(document,"pointermove",this._onTouchMove):i?yi(document,"touchmove",this._onTouchMove):yi(document,"mousemove",this._onTouchMove):(yi(gt,"dragend",this),yi(rr,"dragstart",this._onDragStart));try{document.selection?mb(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,i){if(tf=!1,rr&&gt){bs("dragStarted",this,{evt:i}),this.nativeDraggable&&yi(document,"dragover",$K);var r=this.options;!e&&Qs(gt,r.dragClass,!1),Qs(gt,r.ghostClass,!0),Ut.active=this,e&&this._appendGhost(),as({sortable:this,name:"start",originalEvent:i})}else this._nulling()},_emulateDragOver:function(){if(aa){this._lastX=aa.clientX,this._lastY=aa.clientY,xL();for(var e=document.elementFromPoint(aa.clientX,aa.clientY),i=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(aa.clientX,aa.clientY),e!==i);)i=e;if(gt.parentNode[Ms]._isOutsideThisEl(e),i)do{if(i[Ms]){var r=void 0;if(r=i[Ms]._onDragOver({clientX:aa.clientX,clientY:aa.clientY,target:e,rootEl:i}),r&&!this.options.dragoverBubble)break}e=i}while(i=dL(i));wL()}},_onTouchMove:function(e){if(Dh){var i=this.options,r=i.fallbackTolerance,o=i.fallbackOffset,h=e.touches?e.touches[0]:e,d=Yt&&Mf(Yt,!0),a=Yt&&d&&d.a,_=Yt&&d&&d.d,T=Lv&&Vn&&tD(Vn),E=(h.clientX-Dh.clientX+o.x)/(a||1)+(T?T[0]-YS[0]:0)/(a||1),k=(h.clientY-Dh.clientY+o.y)/(_||1)+(T?T[1]-YS[1]:0)/(_||1);if(!Ut.active&&!tf){if(r&&Math.max(Math.abs(h.clientX-this._lastX),Math.abs(h.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(Yt){d?(d.e+=E-(ZS||0),d.f+=k-(WS||0)):d={a:1,b:0,c:0,d:1,e:E,f:k};var L="matrix(".concat(d.a,",").concat(d.b,",").concat(d.c,",").concat(d.d,",").concat(d.e,",").concat(d.f,")");jt(Yt,"webkitTransform",L),jt(Yt,"mozTransform",L),jt(Yt,"msTransform",L),jt(Yt,"transform",L),ZS=E,WS=k,aa=h}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Yt){var e=this.options.fallbackOnBody?document.body:rr,i=Qr(gt,!0,Lv,!0,e),r=this.options;if(Lv){for(Vn=e;jt(Vn,"position")==="static"&&jt(Vn,"transform")==="none"&&Vn!==document;)Vn=Vn.parentNode;Vn!==document.body&&Vn!==document.documentElement?(Vn===document&&(Vn=ml()),i.top+=Vn.scrollTop,i.left+=Vn.scrollLeft):Vn=ml(),YS=tD(Vn)}Yt=gt.cloneNode(!0),Qs(Yt,r.ghostClass,!1),Qs(Yt,r.fallbackClass,!0),Qs(Yt,r.dragClass,!0),jt(Yt,"transition",""),jt(Yt,"transform",""),jt(Yt,"box-sizing","border-box"),jt(Yt,"margin",0),jt(Yt,"top",i.top),jt(Yt,"left",i.left),jt(Yt,"width",i.width),jt(Yt,"height",i.height),jt(Yt,"opacity","0.8"),jt(Yt,"position",Lv?"absolute":"fixed"),jt(Yt,"zIndex","100000"),jt(Yt,"pointerEvents","none"),Ut.ghost=Yt,e.appendChild(Yt),jt(Yt,"transform-origin",iD/parseInt(Yt.style.width)*100+"% "+rD/parseInt(Yt.style.height)*100+"%")}},_onDragStart:function(e,i){var r=this,o=e.dataTransfer,h=r.options;if(bs("dragStart",this,{evt:e}),Ut.eventCanceled){this._onDrop();return}bs("setupClone",this),Ut.eventCanceled||(dr=gL(gt),dr.removeAttribute("id"),dr.draggable=!1,dr.style["will-change"]="",this._hideClone(),Qs(dr,this.options.chosenClass,!1),Ut.clone=dr),r.cloneId=mb(function(){bs("clone",r),!Ut.eventCanceled&&(r.options.removeCloneOnHide||rr.insertBefore(dr,gt),r._hideClone(),as({sortable:r,name:"clone"}))}),!i&&Qs(gt,h.dragClass,!0),i?(Bx=!0,r._loopId=setInterval(r._emulateDragOver,50)):(fi(document,"mouseup",r._onDrop),fi(document,"touchend",r._onDrop),fi(document,"touchcancel",r._onDrop),o&&(o.effectAllowed="move",h.setData&&h.setData.call(r,o,gt)),yi(document,"drop",r),jt(gt,"transform","translateZ(0)")),tf=!0,r._dragStartId=mb(r._dragStarted.bind(r,i,e)),yi(document,"selectstart",r),py=!0,window.getSelection().removeAllRanges(),jy&&jt(document.body,"user-select","none")},_onDragOver:function(e){var i=this.el,r=e.target,o,h,d,a=this.options,_=a.group,T=Ut.active,E=Ov===_,k=a.sort,L=zn||T,O,H=this,re=!1;if(AC)return;function pe(nt,rt){bs(nt,H,yl({evt:e,isOwner:E,axis:O?"vertical":"horizontal",revert:d,dragRect:o,targetRect:h,canSort:k,fromSortable:L,target:r,completed:Se,onMove:function(ei,en){return Fv(rr,i,gt,o,ei,Qr(ei),e,en)},changed:Pe},rt))}function ge(){pe("dragOverAnimationCapture"),H.captureAnimationState(),H!==L&&L.captureAnimationState()}function Se(nt){return pe("dragOverCompleted",{insertion:nt}),nt&&(E?T._hideClone():T._showClone(H),H!==L&&(Qs(gt,zn?zn.options.ghostClass:T.options.ghostClass,!1),Qs(gt,a.ghostClass,!0)),zn!==H&&H!==Ut.active?zn=H:H===Ut.active&&zn&&(zn=null),L===H&&(H._ignoreWhileAnimating=r),H.animateAll(function(){pe("dragOverAnimationComplete"),H._ignoreWhileAnimating=null}),H!==L&&(L.animateAll(),L._ignoreWhileAnimating=null)),(r===gt&&!gt.animated||r===i&&!r.animated)&&(Up=null),!a.dragoverBubble&&!e.rootEl&&r!==document&&(gt.parentNode[Ms]._isOutsideThisEl(e.target),!nt&&zh(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),re=!0}function Pe(){ro=zo(gt),yu=zo(gt,a.draggable),as({sortable:H,name:"change",toEl:i,newIndex:ro,newDraggableIndex:yu,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=ga(r,a.draggable,i,!0),pe("dragOver"),Ut.eventCanceled)return re;if(gt.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||H._ignoreWhileAnimating===r)return Se(!1);if(Bx=!1,T&&!a.disabled&&(E?k||(d=xr!==rr):zn===this||(this.lastPutMode=Ov.checkPull(this,T,gt,e))&&_.checkPut(this,T,gt,e))){if(O=this._getDirection(e,r)==="vertical",o=Qr(gt),pe("dragOverValid"),Ut.eventCanceled)return re;if(d)return xr=rr,ge(),this._hideClone(),pe("revert"),Ut.eventCanceled||(Nh?rr.insertBefore(gt,Nh):rr.appendChild(gt)),Se(!0);var Re=R$(i,a.draggable);if(!Re||AK(e,O,this)&&!Re.animated){if(Re===gt)return Se(!1);if(Re&&i===e.target&&(r=Re),r&&(h=Qr(r)),Fv(rr,i,gt,o,r,h,e,!!r)!==!1)return ge(),Re&&Re.nextSibling?i.insertBefore(gt,Re.nextSibling):i.appendChild(gt),xr=i,Pe(),Se(!0)}else if(Re&&kK(e,O,this)){var ze=om(i,0,a,!0);if(ze===gt)return Se(!1);if(r=ze,h=Qr(r),Fv(rr,i,gt,o,r,h,e,!1)!==!1)return ge(),i.insertBefore(gt,ze),xr=i,Pe(),Se(!0)}else if(r.parentNode===i){h=Qr(r);var Je=0,Xe,yt=gt.parentNode!==i,mt=!EK(gt.animated&&gt.toRect||o,r.animated&&r.toRect||h,O),je=O?"top":"left",ke=eD(r,"top","top")||eD(gt,"top","top"),We=ke?ke.scrollTop:void 0;Up!==r&&(Xe=h[je],qy=!1,Rv=!mt&&a.invertSwap||yt),Je=DK(e,r,h,O,mt?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,Rv,Up===r);var Ce;if(Je!==0){var Ee=zo(gt);do Ee-=Je,Ce=xr.children[Ee];while(Ce&&(jt(Ce,"display")==="none"||Ce===Yt))}if(Je===0||Ce===r)return Se(!1);Up=r,Gy=Je;var st=r.nextElementSibling,_t=!1;_t=Je===1;var ht=Fv(rr,i,gt,o,r,h,e,_t);if(ht!==!1)return(ht===1||ht===-1)&&(_t=ht===1),AC=!0,setTimeout(MK,30),ge(),_t&&!st?i.appendChild(gt):r.parentNode.insertBefore(gt,_t?st:r),ke&&mL(ke,0,We-ke.scrollTop),xr=gt.parentNode,Xe!==void 0&&!Rv&&(fb=Math.abs(Xe-Qr(r)[je])),Pe(),Se(!0)}if(i.contains(gt))return Se(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){fi(document,"mousemove",this._onTouchMove),fi(document,"touchmove",this._onTouchMove),fi(document,"pointermove",this._onTouchMove),fi(document,"dragover",zh),fi(document,"mousemove",zh),fi(document,"touchmove",zh)},_offUpEvents:function(){var e=this.el.ownerDocument;fi(e,"mouseup",this._onDrop),fi(e,"touchend",this._onDrop),fi(e,"pointerup",this._onDrop),fi(e,"pointercancel",this._onDrop),fi(e,"touchcancel",this._onDrop),fi(document,"selectstart",this)},_onDrop:function(e){var i=this.el,r=this.options;if(ro=zo(gt),yu=zo(gt,r.draggable),bs("drop",this,{evt:e}),xr=gt&&gt.parentNode,ro=zo(gt),yu=zo(gt,r.draggable),Ut.eventCanceled){this._nulling();return}tf=!1,Rv=!1,qy=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),DC(this.cloneId),DC(this._dragStartId),this.nativeDraggable&&(fi(document,"drop",this),fi(i,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),jy&&jt(document.body,"user-select",""),jt(gt,"transform",""),e&&(py&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),Yt&&Yt.parentNode&&Yt.parentNode.removeChild(Yt),(rr===xr||zn&&zn.lastPutMode!=="clone")&&dr&&dr.parentNode&&dr.parentNode.removeChild(dr),gt&&(this.nativeDraggable&&fi(gt,"dragend",this),XS(gt),gt.style["will-change"]="",py&&!tf&&Qs(gt,zn?zn.options.ghostClass:this.options.ghostClass,!1),Qs(gt,this.options.chosenClass,!1),as({sortable:this,name:"unchoose",toEl:xr,newIndex:null,newDraggableIndex:null,originalEvent:e}),rr!==xr?(ro>=0&&(as({rootEl:xr,name:"add",toEl:xr,fromEl:rr,originalEvent:e}),as({sortable:this,name:"remove",toEl:xr,originalEvent:e}),as({rootEl:xr,name:"sort",toEl:xr,fromEl:rr,originalEvent:e}),as({sortable:this,name:"sort",toEl:xr,originalEvent:e})),zn&&zn.save()):ro!==yf&&ro>=0&&(as({sortable:this,name:"update",toEl:xr,originalEvent:e}),as({sortable:this,name:"sort",toEl:xr,originalEvent:e})),Ut.active&&((ro==null||ro===-1)&&(ro=yf,yu=Vy),as({sortable:this,name:"end",toEl:xr,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){bs("nulling",this),rr=gt=xr=Yt=Nh=dr=pb=Tu=Dh=aa=py=ro=yu=yf=Vy=Up=Gy=zn=Ov=Ut.dragged=Ut.ghost=Ut.clone=Ut.active=null,Ux.forEach(function(e){e.checked=!0}),Ux.length=ZS=WS=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":gt&&(this._onDragOver(e),PK(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],i,r=this.el.children,o=0,h=r.length,d=this.options;o<h;o++)i=r[o],ga(i,d.draggable,this.el,!1)&&e.push(i.getAttribute(d.dataIdAttr)||OK(i));return e},sort:function(e,i){var r={},o=this.el;this.toArray().forEach(function(h,d){var a=o.children[d];ga(a,this.options.draggable,o,!1)&&(r[h]=a)},this),i&&this.captureAnimationState(),e.forEach(function(h){r[h]&&(o.removeChild(r[h]),o.appendChild(r[h]))}),i&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,i){return ga(e,i||this.options.draggable,this.el,!1)},option:function(e,i){var r=this.options;if(i===void 0)return r[e];var o=K0.modifyOption(this,e,i);typeof o<"u"?r[e]=o:r[e]=i,e==="group"&&bL(r)},destroy:function(){bs("destroy",this);var e=this.el;e[Ms]=null,fi(e,"mousedown",this._onTapStart),fi(e,"touchstart",this._onTapStart),fi(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(fi(e,"dragover",this),fi(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(i){i.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),jx.splice(jx.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Tu){if(bs("hideClone",this),Ut.eventCanceled)return;jt(dr,"display","none"),this.options.removeCloneOnHide&&dr.parentNode&&dr.parentNode.removeChild(dr),Tu=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Tu){if(bs("showClone",this),Ut.eventCanceled)return;gt.parentNode==rr&&!this.options.group.revertClone?rr.insertBefore(dr,gt):Nh?rr.insertBefore(dr,Nh):rr.appendChild(dr),this.options.group.revertClone&&this.animate(gt,dr),jt(dr,"display",""),Tu=!1}}};function PK(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Fv(t,e,i,r,o,h,d,a){var _,T=t[Ms],E=T.options.onMove,k;return window.CustomEvent&&!vc&&!J0?_=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(_=document.createEvent("Event"),_.initEvent("move",!0,!0)),_.to=e,_.from=t,_.dragged=i,_.draggedRect=r,_.related=o||e,_.relatedRect=h||Qr(e),_.willInsertAfter=a,_.originalEvent=d,t.dispatchEvent(_),E&&(k=E.call(T,_,d)),k}function XS(t){t.draggable=!1}function MK(){AC=!1}function kK(t,e,i){var r=Qr(om(i.el,0,i.options,!0)),o=yL(i.el,i.options,Yt),h=10;return e?t.clientX<o.left-h||t.clientY<r.top&&t.clientX<r.right:t.clientY<o.top-h||t.clientY<r.bottom&&t.clientX<r.left}function AK(t,e,i){var r=Qr(R$(i.el,i.options.draggable)),o=yL(i.el,i.options,Yt),h=10;return e?t.clientX>o.right+h||t.clientY>r.bottom&&t.clientX>r.left:t.clientY>o.bottom+h||t.clientX>r.right&&t.clientY>r.top}function DK(t,e,i,r,o,h,d,a){var _=r?t.clientY:t.clientX,T=r?i.height:i.width,E=r?i.top:i.left,k=r?i.bottom:i.right,L=!1;if(!d){if(a&&fb<T*o){if(!qy&&(Gy===1?_>E+T*h/2:_<k-T*h/2)&&(qy=!0),qy)L=!0;else if(Gy===1?_<E+fb:_>k-fb)return-Gy}else if(_>E+T*(1-o)/2&&_<k-T*(1-o)/2)return zK(e)}return L=L||d,L&&(_<E+T*h/2||_>k-T*h/2)?_>E+T/2?1:-1:0}function zK(t){return zo(gt)<zo(t)?1:-1}function OK(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,r=0;i--;)r+=e.charCodeAt(i);return r.toString(36)}function RK(t){Ux.length=0;for(var e=t.getElementsByTagName("input"),i=e.length;i--;){var r=e[i];r.checked&&Ux.push(r)}}function mb(t){return setTimeout(t,0)}function DC(t){return clearTimeout(t)}cw&&yi(document,"touchmove",function(t){(Ut.active||tf)&&t.cancelable&&t.preventDefault()});Ut.utils={on:yi,off:fi,css:jt,find:pL,is:function(e,i){return!!ga(e,i,e,!1)},extend:_K,throttle:fL,closest:ga,toggleClass:Qs,clone:gL,index:zo,nextTick:mb,cancelNextTick:DC,detectDirection:vL,getChild:om,expando:Ms};Ut.get=function(t){return t[Ms]};Ut.mount=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Ut.utils=yl(yl({},Ut.utils),r.utils)),K0.mount(r)})};Ut.create=function(t,e){return new Ut(t,e)};Ut.version=gK;var Xr=[],fy,zC,OC=!1,JS,KS,Vx,my;function LK(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(i){var r=i.originalEvent;this.sortable.nativeDraggable?yi(document,"dragover",this._handleAutoScroll):this.options.supportPointer?yi(document,"pointermove",this._handleFallbackAutoScroll):r.touches?yi(document,"touchmove",this._handleFallbackAutoScroll):yi(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(i){var r=i.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?fi(document,"dragover",this._handleAutoScroll):(fi(document,"pointermove",this._handleFallbackAutoScroll),fi(document,"touchmove",this._handleFallbackAutoScroll),fi(document,"mousemove",this._handleFallbackAutoScroll)),sD(),gb(),vK()},nulling:function(){Vx=zC=fy=OC=my=JS=KS=null,Xr.length=0},_handleFallbackAutoScroll:function(i){this._handleAutoScroll(i,!0)},_handleAutoScroll:function(i,r){var o=this,h=(i.touches?i.touches[0]:i).clientX,d=(i.touches?i.touches[0]:i).clientY,a=document.elementFromPoint(h,d);if(Vx=i,r||this.options.forceAutoScrollFallback||J0||vc||jy){QS(i,this.options,a,r);var _=Pu(a,!0);OC&&(!my||h!==JS||d!==KS)&&(my&&sD(),my=setInterval(function(){var T=Pu(document.elementFromPoint(h,d),!0);T!==_&&(_=T,gb()),QS(i,o.options,T,r)},10),JS=h,KS=d)}else{if(!this.options.bubbleScroll||Pu(a,!0)===ml()){gb();return}QS(i,this.options,Pu(a,!1),!1)}}},yc(t,{pluginName:"scroll",initializeByDefault:!0})}function gb(){Xr.forEach(function(t){clearInterval(t.pid)}),Xr=[]}function sD(){clearInterval(my)}var QS=fL(function(t,e,i,r){if(e.scroll){var o=(t.touches?t.touches[0]:t).clientX,h=(t.touches?t.touches[0]:t).clientY,d=e.scrollSensitivity,a=e.scrollSpeed,_=ml(),T=!1,E;zC!==i&&(zC=i,gb(),fy=e.scroll,E=e.scrollFn,fy===!0&&(fy=Pu(i,!0)));var k=0,L=fy;do{var O=L,H=Qr(O),re=H.top,pe=H.bottom,ge=H.left,Se=H.right,Pe=H.width,Re=H.height,ze=void 0,Je=void 0,Xe=O.scrollWidth,yt=O.scrollHeight,mt=jt(O),je=O.scrollLeft,ke=O.scrollTop;O===_?(ze=Pe<Xe&&(mt.overflowX==="auto"||mt.overflowX==="scroll"||mt.overflowX==="visible"),Je=Re<yt&&(mt.overflowY==="auto"||mt.overflowY==="scroll"||mt.overflowY==="visible")):(ze=Pe<Xe&&(mt.overflowX==="auto"||mt.overflowX==="scroll"),Je=Re<yt&&(mt.overflowY==="auto"||mt.overflowY==="scroll"));var We=ze&&(Math.abs(Se-o)<=d&&je+Pe<Xe)-(Math.abs(ge-o)<=d&&!!je),Ce=Je&&(Math.abs(pe-h)<=d&&ke+Re<yt)-(Math.abs(re-h)<=d&&!!ke);if(!Xr[k])for(var Ee=0;Ee<=k;Ee++)Xr[Ee]||(Xr[Ee]={});(Xr[k].vx!=We||Xr[k].vy!=Ce||Xr[k].el!==O)&&(Xr[k].el=O,Xr[k].vx=We,Xr[k].vy=Ce,clearInterval(Xr[k].pid),(We!=0||Ce!=0)&&(T=!0,Xr[k].pid=setInterval((function(){r&&this.layer===0&&Ut.active._onTouchMove(Vx);var st=Xr[this.layer].vy?Xr[this.layer].vy*a:0,_t=Xr[this.layer].vx?Xr[this.layer].vx*a:0;typeof E=="function"&&E.call(Ut.dragged.parentNode[Ms],_t,st,t,Vx,Xr[this.layer].el)!=="continue"||mL(Xr[this.layer].el,_t,st)}).bind({layer:k}),24))),k++}while(e.bubbleScroll&&L!==_&&(L=Pu(L,!1)));OC=T}},30),SL=function(e){var i=e.originalEvent,r=e.putSortable,o=e.dragEl,h=e.activeSortable,d=e.dispatchSortableEvent,a=e.hideGhostForTarget,_=e.unhideGhostForTarget;if(i){var T=r||h;a();var E=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:i,k=document.elementFromPoint(E.clientX,E.clientY);_(),T&&!T.el.contains(k)&&(d("spill"),this.onSpill({dragEl:o,putSortable:r}))}};function L$(){}L$.prototype={startIndex:null,dragStart:function(e){var i=e.oldDraggableIndex;this.startIndex=i},onSpill:function(e){var i=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var o=om(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(i,o):this.sortable.el.appendChild(i),this.sortable.animateAll(),r&&r.animateAll()},drop:SL};yc(L$,{pluginName:"revertOnSpill"});function F$(){}F$.prototype={onSpill:function(e){var i=e.dragEl,r=e.putSortable,o=r||this.sortable;o.captureAnimationState(),i.parentNode&&i.parentNode.removeChild(i),o.animateAll()},drop:SL};yc(F$,{pluginName:"removeOnSpill"});Ut.mount(new LK);Ut.mount(F$,L$);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const uw=new Set,FK={ghostClass:"calcite-sortable--ghost",chosenClass:"calcite-sortable--chosen",dragClass:"calcite-sortable--drag",fallbackClass:"calcite-sortable--fallback"};function NK(t){if(CL(t))return;TL(t),uw.add(t);const e="id",{group:i,handleSelector:r,dragSelector:o,sortDisabled:h}=t;t.sortable=Ut.create(t.el,{dataIdAttr:e,swapThreshold:.5,...FK,...!!o&&{draggable:o},...!!i&&{sort:!h,group:{name:i,...!!t.canPull&&{pull:(d,a,_,{newDraggableIndex:T,oldDraggableIndex:E})=>t.canPull({toEl:d.el,fromEl:a.el,dragEl:_,newIndex:T,oldIndex:E})},...!!t.canPut&&{put:(d,a,_,{newDraggableIndex:T,oldDraggableIndex:E})=>t.canPut({toEl:d.el,fromEl:a.el,dragEl:_,newIndex:T,oldIndex:E})}}},onMove:({from:d,dragged:a,to:_,related:T})=>{t.onDragMove&&t.onDragMove({fromEl:d,dragEl:a,toEl:_,relatedEl:T})},handle:r,filter:`${r}[disabled]`,onStart:({from:d,item:a,to:_,newDraggableIndex:T,oldDraggableIndex:E})=>{RC.active=!0,BK(),t.onDragStart({fromEl:d,dragEl:a,toEl:_,newIndex:T,oldIndex:E})},onEnd:({from:d,item:a,to:_,newDraggableIndex:T,oldDraggableIndex:E})=>{RC.active=!1,jK(),t.onDragEnd({fromEl:d,dragEl:a,toEl:_,newIndex:T,oldIndex:E})},onSort:({from:d,item:a,to:_,newDraggableIndex:T,oldDraggableIndex:E})=>{t.onDragSort({fromEl:d,dragEl:a,toEl:_,newIndex:T,oldIndex:E})}})}function TL(t){CL(t)||(uw.delete(t),t.sortable?.destroy(),t.sortable=null)}const RC={active:!1};function CL(t){return t.dragEnabled&&RC.active}function BK(){Array.from(uw).forEach(t=>t.onGlobalDragStart())}function jK(){Array.from(uw).forEach(t=>t.onGlobalDragEnd())}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Yl={container:"container",table:"table",scrim:"scrim",stack:"stack",tableContainer:"table-container",sticky:"sticky-pos",assistiveText:"assistive-text",containerHeight:"container-height"},eT={filterNoResults:"filter-no-results",filterActionsStart:"filter-actions-start",filterActionsEnd:"filter-actions-end"},UK=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{position:relative;background-color:var(--calcite-list-background-color, var(--calcite-color-foreground-1))}.container-height{block-size:100%}.table-container{box-sizing:border-box;display:flex;inline-size:100%;flex-direction:column;background-color:transparent}.table-container *{box-sizing:border-box}.table{inline-size:100%}.stack{--calcite-stack-padding-inline: 0;--calcite-stack-padding-block: 0}.sticky-pos{position:sticky;inset-block-start:0px;z-index:var(--calcite-z-index-sticky);background-color:var(--calcite-list-background-color, var(--calcite-color-foreground-1))}.assistive-text{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}:host([hidden]){display:none}[hidden]{display:none}`,VK=`${Fx}, ${pc}`,A1=class A1 extends ji{constructor(){super(),this.dragSelector=pc,this.focusableItems=[],this.handleSelector="calcite-sort-handle",this.listItems=[],this.listItemGroups=[],this.mutationObserver=qo("mutation",()=>{this.willPerformFilter=!0,this.updateListItemsDebounced()}),this.cancelable=z$()(this),this.updateListItemsDebounced=sw(this.updateListItems,g$.nextTick),this.visibleItems=[],this.willFilterEmit=!1,this.willPerformFilter=!1,this.messages=fo({blocking:!0}),this.focusSetter=zs()(this),this.dataForFilter=[],this.hasFilterActionsEnd=!1,this.hasFilterActionsStart=!1,this.hasFilterNoResults=!1,this.sortHandleMenuItems=[],this.disabled=!1,this.dragEnabled=!1,this.filterEnabled=!1,this.filteredData=[],this.filteredItems=[],this.interactionMode="interactive",this.loading=!1,this.displayMode="flat",this.scale="m",this.selectedItems=[],this.selectionAppearance="icon",this.selectionMode="none",this.sortDisabled=!1,this.calciteInternalListDefaultSlotChange=vt({cancelable:!1}),this.calciteListChange=vt({cancelable:!1}),this.calciteListDragEnd=vt({cancelable:!1}),this.calciteListDragStart=vt({cancelable:!1}),this.calciteListFilter=vt({cancelable:!1}),this.calciteListMoveHalt=vt({cancelable:!1}),this.calciteListOrderChange=vt({cancelable:!1}),this.listen("calciteInternalListItemToggle",this.handleCalciteListItemToggle),this.listen("calciteInternalFocusPreviousItem",this.handleCalciteInternalFocusPreviousItem),this.listen("calciteInternalListItemActive",this.handleCalciteInternalListItemActive),this.listen("calciteListItemSelect",this.handleCalciteListItemSelect),this.listen("calciteInternalAssistiveTextChange",this.handleCalciteInternalAssistiveTextChange),this.listen("calciteListItemSortHandleBeforeOpen",this.updateListItemsDebounced),this.listen("calciteSortHandleReorder",this.handleSortReorder),this.listen("calciteSortHandleMove",this.handleSortMove),this.listen("calciteSortHandleAdd",this.handleSortAdd),this.listen("calciteInternalListItemSelect",this.handleCalciteInternalListItemSelect),this.listen("calciteInternalListItemSelectMultiple",this.handleCalciteInternalListItemSelectMultiple),this.listen("calciteInternalListItemChange",this.handleCalciteInternalListItemChange),this.listen("calciteInternalListItemGroupDefaultSlotChange",this.handleCalciteInternalListItemGroupDefaultSlotChange)}get hasActiveFilter(){return this.filterEnabled&&this.filterText&&this.filteredItems.length!==this.visibleItems.length}get showNoResultsContainer(){return this.filterEnabled&&this.filterText&&this.hasFilterNoResults&&this.visibleItems.length&&!this.filteredItems.length}async setFocus(e){return this.focusSetter(()=>this.filterEnabled?this.filterEl:this.focusableItems.find(i=>i.active),e)}emitOrderChangeEvent(e){this.calciteListOrderChange.emit(e)}connectedCallback(){super.connectedCallback(),this.connectObserver(),this.willPerformFilter=!0,this.updateListItemsDebounced(),this.setUpSorting(),this.setParentList(),this.setListItemGroups(),this.cancelable.add(this.updateListItemsDebounced)}async load(){this.handleInteractionModeWarning()}willUpdate(e){(e.has("filterText")||e.has("filterProps")||e.has("filterPredicate"))&&this.performFilter(),(e.has("filterEnabled")&&(this.hasUpdated||this.filterEnabled!==!1)||e.has("group")||e.has("sortDisabled")&&(this.hasUpdated||this.sortDisabled!==!1)||e.has("dragEnabled")&&(this.hasUpdated||this.dragEnabled!==!1)||e.has("selectionMode")&&(this.hasUpdated||this.selectionMode!=="none")||e.has("selectionAppearance")&&(this.hasUpdated||this.selectionAppearance!=="icon")||e.has("displayMode")&&this.hasUpdated||e.has("scale")&&this.hasUpdated||e.has("canPull")&&this.hasUpdated||e.has("canPut")&&this.hasUpdated||e.has("filterPredicate")&&this.hasUpdated)&&this.handleListItemChange()}updated(){mo(this)}disconnectedCallback(){super.disconnectedCallback(),this.disconnectObserver(),TL(this)}updateListItems(){this.updateGroupItems();const{selectionAppearance:e,selectionMode:i,interactionMode:r,dragEnabled:o,el:h,filterEl:d,displayMode:a,scale:_,sortDisabled:T,sortHandleMenuItems:E}=this,k=Array.from(this.el.querySelectorAll(pc)),L=h,O=Array.from(L.children).filter(zv);if(k.forEach(H=>{H.scale=_,H.selectionAppearance=e,H.selectionMode=i,H.interactionMode=r,H.closest(By)===h&&(H.moveToItems=E.filter(re=>this.validateSortMenuItem({type:"move",fromEl:L,toEl:re.element,dragEl:H,newIndex:0,oldIndex:O.indexOf(H)})),H.addToItems=this.sortHandleMenuItems.filter(re=>this.validateSortMenuItem({type:"add",fromEl:L,toEl:re.element,dragEl:H,newIndex:0,oldIndex:O.indexOf(H)})),H.dragHandle=o,H.displayMode=a,H.sortDisabled=T)}),this.parentListEl){this.setUpSorting();return}this.listItems=k,this.filterEnabled&&this.willPerformFilter&&(this.willPerformFilter=!1,this.dataForFilter=this.getItemData(),d&&(d.items=this.dataForFilter,this.filterAndUpdateData())),this.visibleItems=this.listItems.filter(H=>!H.closed&&!H.hidden),this.updateFilteredItems(),this.borderItems(),this.focusableItems=this.filteredItems.filter(H=>!H.disabled),this.setActiveListItem(),this.updateSelectedItems(),this.setUpSorting()}handleListItemChange(){this.willPerformFilter=!0,this.updateListItemsDebounced()}handleCalciteListItemToggle(e){this.parentListEl||(e.stopPropagation(),this.borderItems())}handleCalciteInternalFocusPreviousItem(e){if(this.parentListEl)return;e.stopPropagation();const{focusableItems:i}=this,o=i.findIndex(h=>h.active)-1;i[o]&&this.focusRow(i[o])}handleCalciteInternalListItemActive(e){if(this.parentListEl)return;e.stopPropagation();const i=e.target,{listItems:r}=this;r.forEach(o=>{o.active=o===i})}handleCalciteListItemSelect(){this.parentListEl||this.updateSelectedItems(!0)}handleCalciteInternalAssistiveTextChange(e){this.assistiveText=e.detail.message,e.stopPropagation()}handleSortReorder(e){this.parentListEl||e.defaultPrevented||(e.preventDefault(),this.handleReorder(e))}handleSortAdd(e){this.parentListEl||e.defaultPrevented||(e.preventDefault(),this.handleAdd(e))}handleSortMove(e){this.parentListEl||e.defaultPrevented||(e.preventDefault(),this.handleMove(e))}handleCalciteInternalListItemSelect(e){if(this.parentListEl)return;e.stopPropagation();const i=e.target,{listItems:r,selectionMode:o}=this;i.selected&&(o==="single"||o==="single-persist")&&r.forEach(h=>h.selected=h===i),this.updateSelectedItems()}handleCalciteInternalListItemSelectMultiple(e){if(this.parentListEl)return;e.stopPropagation();const{target:i,detail:r}=e,{focusableItems:o,lastSelectedInfo:h}=this,d=i;if(r.selectMultiple&&h){const a=o.indexOf(d),_=o.indexOf(h.selectedItem),T=Math.min(_,a),E=Math.max(_,a);o.slice(T,E+1).forEach(k=>k.selected=h.selected)}else this.lastSelectedInfo={selectedItem:d,selected:d.selected}}handleCalciteInternalListItemChange(e){this.parentListEl||(e.stopPropagation(),this.updateListItemsDebounced())}handleCalciteInternalListItemGroupDefaultSlotChange(e){e.stopPropagation()}connectObserver(){this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}disconnectObserver(){this.mutationObserver?.disconnect()}setUpSorting(){const{dragEnabled:e,defaultSlotEl:i}=this;e&&(i&&hK(i),NK(this))}onGlobalDragStart(){this.disconnectObserver()}onGlobalDragEnd(){this.connectObserver()}onDragEnd(e){this.calciteListDragEnd.emit(e)}onDragStart(e){e.dragEl.sortHandleOpen=!1,this.calciteListDragStart.emit(e)}onDragSort(e){this.setParentList(),this.updateListItemsDebounced(),this.calciteListOrderChange.emit(e)}setParentList(){this.parentListEl=this.el.parentElement?.closest(By)}handleDefaultSlotChange(){this.parentListEl&&this.calciteInternalListDefaultSlotChange.emit()}setListItemGroups(){this.listItemGroups=Array.from(this.el.querySelectorAll(Fx))}handleFilterActionsStartSlotChange(e){this.hasFilterActionsStart=Cr(e)}handleFilterActionsEndSlotChange(e){this.hasFilterActionsEnd=Cr(e)}handleFilterNoResultsSlotChange(e){this.hasFilterNoResults=Cr(e)}setActiveListItem(){const{focusableItems:e}=this;e.some(i=>i.active)||e[0]&&(e[0].active=!0)}async updateSelectedItems(e=!1){await this.updateComplete,this.selectedItems=this.visibleItems.filter(i=>i.selected),e&&this.calciteListChange.emit()}filterElements({el:e,filteredItems:i,visibleParents:r}){const o=!r.has(e)&&!i.includes(e);e.filterHidden=o;const h=e.parentElement.closest(VK);h&&(o||r.add(h),this.filterElements({el:h,filteredItems:i,visibleParents:r}))}allParentListItemsExpanded(e){const i=e.parentElement?.closest(pc);if(i){if(!i.expanded)return!1}else return!0;return this.allParentListItemsExpanded(i)}borderItems(){const e=this.visibleItems.filter(i=>!i.filterHidden&&this.allParentListItemsExpanded(i));e.forEach(i=>i.bordered=i!==e[e.length-1])}updateFilteredItems(){const{visibleItems:e,filteredData:i,filterText:r,filterPredicate:o}=this,h=e?.filter(_=>e.every(T=>T===_||!_.contains(T))),d=o?e.filter(o):r?i.map(_=>_.el):e||[],a=new WeakSet;h.forEach(_=>this.filterElements({el:_,filteredItems:d,visibleParents:a})),this.filteredItems=d,this.willFilterEmit&&(this.willFilterEmit=!1,this.calciteListFilter.emit())}updateFilteredData(){const{filterEl:e}=this;e&&(e.filteredItems&&(this.filteredData=e.filteredItems),this.updateListItemsDebounced())}async filterAndUpdateData(){await this.filterEl?.filter(this.filterText),this.updateFilteredData()}get effectiveFilterProps(){return this.filterProps?this.filterProps.filter(e=>e!=="el"):["description","label","metadata","heading"]}performFilter(){const{filterEl:e,filterText:i,effectiveFilterProps:r}=this;e&&(e.value=i,e.filterProps=r,this.filterAndUpdateData())}setDefaultSlotEl(e){this.defaultSlotEl=e}setFilterEl(e){this.filterEl=e,this.performFilter()}handleFilterChange(e){e.stopPropagation();const{value:i}=e.currentTarget;this.filterText=i,this.willFilterEmit=!0,this.updateFilteredData()}getItemData(){return this.listItems.map(e=>({label:e.label,description:e.description,metadata:e.metadata,heading:this.getGroupHeading(e),el:e}))}getGroupHeading(e){return this.listItemGroups.filter(r=>r.contains(e)).map(r=>r.heading)}updateGroupItems(){const{el:e,group:i,scale:r}=this,o=J1(e),h=i?Array.from(o.querySelectorAll(`${By}[group="${i}"]`)).filter(a=>!a.disabled&&a.dragEnabled):[];this.sortHandleMenuItems=h.map(a=>({element:a,label:a.label??a.id,id:Hu()})),Array.from(this.el.querySelectorAll(Fx)).forEach(a=>{a.scale=r})}focusRow(e){const{focusableItems:i}=this;e&&(i.forEach(r=>r.active=r===e),e.setFocus())}isNavigable(e){const i=e.parentElement?.closest(pc);return i?i.expanded&&this.isNavigable(i):!0}handleListKeydown(e){if(e.defaultPrevented||this.parentListEl)return;const{key:i}=e,r=this.focusableItems.filter(h=>this.isNavigable(h)),o=r.findIndex(h=>h.active);if(i==="ArrowDown"){e.preventDefault();const h=e.target===this.filterEl?0:o+1;r[h]&&this.focusRow(r[h])}else if(i==="ArrowUp"){if(e.preventDefault(),o===0&&this.filterEnabled){this.filterEl.setFocus();return}const h=o-1;r[h]&&this.focusRow(r[h])}else if(i==="Home"){e.preventDefault();const h=r[0];h&&this.focusRow(h)}else if(i==="End"){e.preventDefault();const h=r[r.length-1];h&&this.focusRow(h)}}handleInteractionModeWarning(){this.interactionMode==="static"&&this.selectionMode!=="none"&&this.selectionAppearance==="border"&&console.warn('selection-appearance="border" requires interaction-mode="interactive"')}validateSortMenuItem({fromEl:e,toEl:i,dragEl:r,newIndex:o,oldIndex:h,type:d}){if(!e||!i||i===e||r.contains(i))return!1;const a=e.canPull?.({toEl:i,fromEl:e,dragEl:r,newIndex:o,oldIndex:h})??!0,_=i.canPut?.({toEl:i,fromEl:e,dragEl:r,newIndex:o,oldIndex:h})??!0;return(d==="add"?a==="clone":a===!0)&&_}handleAdd(e){const{addTo:i}=e.detail,r=e.target,o=r?.parentElement,h=i.element,a=Array.from(o.children).filter(zv).indexOf(r),_=0;if(!this.validateSortMenuItem({type:"add",fromEl:o,toEl:h,dragEl:r,newIndex:_,oldIndex:a}))return;r.sortHandleOpen=!1,this.disconnectObserver();const T=r.cloneNode();h.prepend(T),kC(r),this.updateListItemsDebounced(),this.connectObserver();const E={dragEl:r,fromEl:o,toEl:h,newIndex:_,oldIndex:a};this.calciteListOrderChange.emit(E),h.emitOrderChangeEvent(E)}handleMove(e){const{moveTo:i}=e.detail,r=e.target,o=r?.parentElement,h=i.element,a=Array.from(o.children).filter(zv).indexOf(r),_=0;if(!this.validateSortMenuItem({type:"move",fromEl:o,toEl:h,dragEl:r,newIndex:_,oldIndex:a}))return;r.sortHandleOpen=!1,this.disconnectObserver(),h.prepend(r),kC(r),this.updateListItemsDebounced(),this.connectObserver();const T={dragEl:r,fromEl:o,toEl:h,newIndex:_,oldIndex:a};this.calciteListOrderChange.emit(T),h.emitOrderChangeEvent(T)}handleReorder(e){const{reorder:i}=e.detail,r=e.target,o=r?.parentElement;if(!o)return;r.sortHandleOpen=!1;const h=Array.from(o.children).filter(zv),d=h.length-1,a=h.indexOf(r);let _=a;switch(i){case"top":_=0;break;case"bottom":_=d;break;case"up":_=a===0?0:a-1;break;case"down":_=a===d?d:a+1;break}this.disconnectObserver();const T=i==="up"||i==="top"?h[_]:h[_].nextSibling;o.insertBefore(r,T),this.updateListItemsDebounced(),this.connectObserver(),this.calciteListOrderChange.emit({dragEl:r,fromEl:o,toEl:o,newIndex:_,oldIndex:a})}render(){const{loading:e,label:i,disabled:r,dataForFilter:o,filterEnabled:h,filterPlaceholder:d,filterText:a,filterLabel:_,hasFilterActionsStart:T,hasFilterActionsEnd:E,effectiveFilterProps:k}=this;return go({disabled:this.disabled,children:Ne`<div class=${Fe({[Yl.container]:!0,[Yl.containerHeight]:this.listItems.length<1&&e})}>${this.dragEnabled?Ne`<span aria-live=assertive class=${Fe(Yl.assistiveText)}>${this.assistiveText}</span>`:null}${this.renderItemAriaLive()}${e?Ne`<calcite-scrim class=${Fe(Yl.scrim)} .loading=${e}></calcite-scrim>`:null}<div .ariaBusy=${e} .ariaLabel=${i||""} class=${Fe(Yl.table)} @keydown=${this.handleListKeydown} role=treegrid>${h||T||E?Ne`<div class=${Fe(Yl.sticky)} role=rowgroup><div role=row><div role=columnheader><calcite-stack class=${Fe(Yl.stack)}><slot name=${eT.filterActionsStart} @slotchange=${this.handleFilterActionsStartSlotChange} slot=${gf.actionsStart}></slot><calcite-filter .ariaLabel=${d} .disabled=${r} .filterProps=${k} .items=${o} .label=${_} @calciteFilterChange=${this.handleFilterChange} .placeholder=${d} .scale=${this.scale} .value=${a} ${hi(this.setFilterEl)}></calcite-filter><slot name=${eT.filterActionsEnd} @slotchange=${this.handleFilterActionsEndSlotChange} slot=${gf.actionsEnd}></slot></calcite-stack></div></div></div>`:null}<div class=${Fe(Yl.tableContainer)} role=rowgroup><slot @slotchange=${this.handleDefaultSlotChange} ${hi(this.setDefaultSlotEl)}></slot></div></div><div aria-live=polite data-test-id=no-results-container .hidden=${!this.showNoResultsContainer}><slot name=${eT.filterNoResults} @slotchange=${this.handleFilterNoResultsSlotChange}></slot></div></div>`})}renderItemAriaLive(){const{messages:e,filteredItems:i,parentListEl:r,messages:{_lang:o},numberingSystem:h}=this;return Do.numberFormatOptions={locale:o,numberingSystem:h},r?null:Ne`<div aria-live=polite class=${Fe(Yl.assistiveText)}>${this.hasActiveFilter?ai("aria-filter-enabled",Ne`<div>${e.filterEnabled}</div>`):null}${ai("aria-item-count",Ne`<div>${e.total.replace("{count}",Do.localize(i.length.toString()))}</div>`)}${i.length?ai("aria-item-list",Ne`<ol>${i.map(d=>Ne`<li>${d.label}</li>`)}</ol>`):null}</div>`}};A1.properties={assistiveText:[16,{},{state:!0}],dataForFilter:[16,{},{state:!0}],hasFilterActionsEnd:[16,{},{state:!0}],hasFilterActionsStart:[16,{},{state:!0}],hasFilterNoResults:[16,{},{state:!0}],sortHandleMenuItems:[16,{},{state:!0}],canPull:[0,{},{attribute:!1}],canPut:[0,{},{attribute:!1}],disabled:[7,{},{reflect:!0,type:Boolean}],dragEnabled:[7,{},{reflect:!0,type:Boolean}],filterEnabled:[7,{},{reflect:!0,type:Boolean}],filterPredicate:[0,{},{attribute:!1}],filterLabel:[3,{},{reflect:!0}],filterPlaceholder:[3,{},{reflect:!0}],filterProps:[0,{},{attribute:!1}],filterText:[3,{},{reflect:!0}],filteredData:[0,{},{attribute:!1}],filteredItems:[0,{},{attribute:!1}],group:[3,{},{reflect:!0}],interactionMode:[3,{},{reflect:!0}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}],displayMode:[3,{},{reflect:!0}],numberingSystem:1,scale:[3,{},{reflect:!0}],selectedItems:[0,{},{attribute:!1}],selectionAppearance:[3,{},{reflect:!0}],selectionMode:[3,{},{reflect:!0}],sortDisabled:[7,{},{reflect:!0,type:Boolean}]},A1.styles=UK;let LC=A1;ar("calcite-list",LC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const pi={actionsEnd:"actions-end",actionsStart:"actions-start",description:"description",close:"close",container:"container",containerHover:"container--hover",containerBorder:"container--border",containerBorderSelected:"container--border-selected",containerBorderUnselected:"container--border-unselected",content:"content",contentBottom:"content-bottom",contentContainer:"content-container",contentContainerHasCenterContent:"content-container--has-center-content",contentContainerSelectable:"content-container--selectable",contentContainerUnavailable:"content-container--unavailable",contentContainerWrapper:"content-container-wrapper",contentContainerWrapperBordered:"content-container-wrapper--bordered",contentEnd:"content-end",contentStart:"content-start",customContent:"custom-content",expandedContainer:"expanded-container",dragContainer:"drag-container",gridCell:"grid-cell",icon:"icon",nestedContainer:"nested-container",nestedContainerExpanded:"nested-container--expanded",label:"label",row:"row",selectionContainer:"selection-container",selectionContainerSingle:"selection-container--single",wrapper:"wrapper",wrapperBordered:"wrapper--bordered"},Vp={actionsStart:"actions-start",contentStart:"content-start",content:"content",contentBottom:"content-bottom",contentEnd:"content-end",actionsEnd:"actions-end"},GK=0,Xl={selectedMultiple:"check-square-f",selectedSingle:"circle-inset-large",unselectedMultiple:"square",unselectedSingle:"circle",collapsedLTR:"chevron-right",collapsedRTL:"chevron-left",open:"chevron-down",blank:"blank",close:"x"},oD="data-test-active";/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const aD={container:"container",heading:"heading"},qK=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;flex-direction:column}:host([filter-hidden]){display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{margin:0;display:flex;flex:1 1 0%;background-color:var(--calcite-list-background-color, var(--calcite-color-foreground-1));color:var(--calcite-list-color, var(--calcite-color-text-2))}.heading{font-weight:var(--calcite-font-weight-medium)}:host([scale=s]) .container{padding-inline:var(--calcite-spacing-sm)}:host([scale=s]) .heading{font-size:var(--calcite-font-size-sm);line-height:var(--calcite-font-line-height-fixed-base);padding-block:var(--calcite-spacing-sm) var(--calcite-spacing-xxs)}:host([scale=s]:not(:first-child)) .container{padding-block-start:var(--calcite-spacing-sm)}:host([scale=m]) .container{padding-inline:var(--calcite-spacing-md)}:host([scale=m]) .heading{font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-fixed-base);padding-block:var(--calcite-spacing-lg) var(--calcite-spacing-sm)}:host([scale=m]:not(:first-child)) .container{padding-block-start:var(--calcite-spacing-md)}:host([scale=l]) .container{padding-inline:var(--calcite-spacing-lg)}:host([scale=l]) .heading{font-size:var(--calcite-font-size-md);line-height:var(--calcite-font-line-height-fixed-lg);padding-block:var(--calcite-spacing-xl) var(--calcite-spacing-sm-plus, .625rem)}:host([scale=l]:not(:first-child)) .container{padding-block-start:var(--calcite-spacing-md-plus, .875rem)}.heading{padding:0}:host([hidden]){display:none}[hidden]{display:none}`,D1=class D1 extends ji{constructor(){super(...arguments),this.disabled=!1,this.filterHidden=!1,this.scale="m",this.calciteInternalListItemGroupDefaultSlotChange=vt({cancelable:!1})}updated(){mo(this)}handleDefaultSlotChange(){this.calciteInternalListItemGroupDefaultSlotChange.emit()}render(){const{disabled:e,heading:i}=this;return go({disabled:e,children:Ne`<div class=${Fe(aD.container)} role=row><div .ariaColSpan=${GK} class=${Fe(aD.heading)} role=cell>${i}</div></div><slot @slotchange=${this.handleDefaultSlotChange}></slot>`})}};D1.properties={disabled:[7,{},{reflect:!0,type:Boolean}],filterHidden:[7,{},{reflect:!0,type:Boolean}],heading:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}]},D1.styles=qK;let FC=D1;ar("calcite-list-item-group",FC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const HK=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;flex-direction:column}:host([filter-hidden]),:host([closed]){display:none}.wrapper--bordered{border-block-end:1px solid var(--calcite-list-border-color, var(--calcite-color-border-3))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{box-sizing:border-box;display:flex;flex:1 1 0%;overflow:hidden;background-color:var(--calcite-list-background-color, var(--calcite-color-foreground-1))}.container *{box-sizing:border-box}.container--hover:hover{cursor:pointer;background-color:var(--calcite-list-background-color-hover, var(--calcite-color-foreground-2))}.container:active{background-color:var(--calcite-list-background-color-press, var(--calcite-color-foreground-3))}.container--border{position:relative}.container--border:before{position:absolute;inline-size:var(--calcite-border-width-lg);inset-block:0;inset-inline-start:0;background-color:transparent;content:""}.container--border-selected:before{background-color:var(--calcite-list-selection-border-color, var(--calcite-color-brand))}.container--border-selected:focus{box-shadow:inset var(--calcite-border-width-lg) 0 0 0 var(--calcite-list-selection-border-color, var(--calcite-color-brand))}.nested-container{display:none;flex-direction:column;border-width:0px;border-style:solid;border-color:1px solid var(--calcite-list-border-color, var(--calcite-color-border-3));margin-inline-start:var(--calcite-list-spacing-indent, 1.5rem)}.nested-container--expanded{display:flex}.selection-container{display:flex;padding-block:0px;color:var(--calcite-list-icon-color, var(--calcite-color-border-input))}:host(:not([disabled]):not([selected])) .container:hover .selection-container--single{color:var(--calcite-list-icon-color, var(--calcite-color-border-input))}:host([selected]:hover) .selection-container,:host([selected]:hover) .selection-container--single,:host([selected]) .selection-container{color:var(--calcite-list-icon-color, var(--calcite-color-brand))}.content-container-wrapper{display:flex;flex:1 1 auto}.content-container-wrapper--bordered{border-block-end:1px solid var(--calcite-list-border-color, var(--calcite-color-border-3))}.content-container{display:flex;flex:1 1 auto;-webkit-user-select:none;user-select:none;align-items:stretch;font-weight:var(--calcite-font-weight-normal);color:var(--calcite-list-content-text-color, var(--calcite-color-text-2))}.content-container--unavailable{opacity:var(--calcite-opacity-disabled)}.row,.grid-cell{outline-color:transparent}.row{position:relative}.row:focus,.grid-cell:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.content,.custom-content{display:flex;flex:1 1 auto;flex-direction:column;justify-content:center;line-height:var(--calcite-font-line-height-relative-snug)}.label{color:var(--calcite-list-label-text-color, var(--calcite-color-text-1))}.description{color:var(--calcite-list-description-text-color, var(--calcite-color-text-3))}.icon{align-self:center;color:var(--calcite-list-icon-color, var(--calcite-color-text-3))}.icon:hover,.icon:active{color:var(--calcite-color-text-1)}:host([display-mode=flat][drag-handle]:is([selection-mode=none],[selection-appearance=border])) .drag-container{padding-inline-end:var(--calcite-spacing-xxs)}:host([scale=s]) .actions-start{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .content-container{gap:var(--calcite-spacing-sm);min-block-size:32px;padding-block:var(--calcite-spacing-xxs);padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .content,:host([scale=s]) .custom-content,:host([scale=s]) .label{font-size:var(--calcite-font-size--2)}:host([scale=s]) .description{font-size:var(--calcite-font-size--3)}:host([scale=s][display-mode=flat]:not([drag-handle])) .container{padding-inline-start:var(--calcite-spacing-sm)}:host([scale=s][display-mode=flat]:not([drag-handle])) .selection-container{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s][display-mode=flat][drag-handle]) .selection-container{padding-inline:var(--calcite-spacing-xxs) var(--calcite-spacing-sm)}:host([scale=s][display-mode=nested]) .selection-container{padding-inline-end:var(--calcite-spacing-xxs)}:host([scale=s][display-mode=nested][selection-appearance=icon]:not([selection-mode=none]):not([drag-handle])) .container{padding-inline-start:var(--calcite-spacing-sm)}:host([scale=s][display-mode=nested][selection-appearance=icon]:not([selection-mode=none]):not([drag-handle])) .selection-container{padding-inline-end:var(--calcite-spacing-xxs)}:host([scale=s][display-mode=nested][drag-handle]) .selection-container{padding-inline:var(--calcite-spacing-xxs)}:host([scale=m]) .actions-start{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=m]) .content-container{gap:var(--calcite-spacing-sm);min-block-size:40px;padding-block:var(--calcite-spacing-sm);padding-inline-end:var(--calcite-spacing-md)}:host([scale=m]) .content,:host([scale=m]) .custom-content{font-size:var(--calcite-font-size--2)}:host([scale=m]) .label{font-size:var(--calcite-font-size--1)}:host([scale=m]) .description{font-size:var(--calcite-font-size--2)}:host([scale=m][display-mode=flat]) .container{padding-inline-start:var(--calcite-spacing-md)}:host([scale=m][display-mode=flat]) .selection-container{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=m][display-mode=flat][drag-handle]) .container{padding-inline-start:0}:host([scale=m][display-mode=flat][drag-handle]) .selection-container{padding-inline:var(--calcite-spacing-xxs) var(--calcite-spacing-sm)}:host([scale=m][display-mode=nested]) .container{padding-inline-start:var(--calcite-spacing-xxs)}:host([scale=m][display-mode=nested]) .selection-container{padding-inline-end:var(--calcite-spacing-xxs)}:host([scale=m][display-mode=nested][selection-appearance=icon]:not([selection-mode=none]):not([drag-handle])) .container{padding-inline-start:var(--calcite-spacing-md)}:host([scale=m][display-mode=nested][drag-handle]) .container{padding-inline-start:0}:host([scale=m][display-mode=nested][drag-handle]) .selection-container{padding-inline:var(--calcite-spacing-xxs)}:host([scale=l]) .actions-start{padding-inline-end:var(--calcite-spacing-md)}:host([scale=l]) .content-container{gap:var(--calcite-spacing-md);min-block-size:56px;padding-block:.625rem;padding-inline-end:var(--calcite-spacing-lg)}:host([scale=l]) .content,:host([scale=l]) .custom-content,:host([scale=l]) .label{font-size:var(--calcite-font-size-0)}:host([scale=l]) .description{font-size:var(--calcite-font-size--1)}:host([scale=l]) .nested-container{margin-inline-start:1.75rem}:host([scale=l][display-mode=flat]) .container{padding-inline-start:var(--calcite-spacing-lg)}:host([scale=l][display-mode=flat]) .selection-container{padding-inline-end:var(--calcite-spacing-md)}:host([scale=l][display-mode=flat][drag-handle]) .container{padding-inline-start:0}:host([scale=l][display-mode=flat][drag-handle]) .selection-container{padding-inline-end:var(--calcite-spacing-md)}:host([scale=l][display-mode=nested]) .container{padding-inline-start:var(--calcite-spacing-xxs)}:host([scale=l][display-mode=nested][drag-handle]) .container{padding-inline-start:0}:host([scale=l][display-mode=nested][selection-appearance=icon]:not([selection-mode=none]):not([drag-handle])) .container{padding-inline-start:var(--calcite-spacing-lg)}.label,.description,.content-bottom{font-family:var(--calcite-font-family);font-weight:var(--calcite-font-weight-normal);word-wrap:break-word;word-break:break-word}:host([selected]) .label{font-weight:var(--calcite-font-weight-medium)}:host([selected]) .icon{color:var(--calcite-list-icon-color, var(--calcite-color-text-1))}:host([selected]) .description{color:var(--calcite-list-description-text-color, var(--calcite-color-text-2))}.content-start{justify-content:flex-start}.content-end{justify-content:flex-end}.content-start,.content-end{flex:1 1 auto}.content-start ::slotted(calcite-icon),.content-end ::slotted(calcite-icon){align-self:center}.content-bottom{display:flex;flex-direction:column}.content-container--has-center-content .content-start,.content-container--has-center-content .content-end{flex:0 1 auto}.expanded-container{color:var(--calcite-list-icon-color, var(--calcite-color-text-3));padding-inline:var(--calcite-spacing-xxs)}:host(:not([disabled])) .expanded-container:hover{color:var(--calcite-list-icon-color, var(--calcite-color-text-1))}.actions-start,.actions-end,.content-start,.content-end,.selection-container,.drag-container,.expanded-container{display:flex;align-items:center}.actions-start calcite-action,.actions-start calcite-sort-handle,.actions-end calcite-action,.actions-end calcite-sort-handle,.content-start calcite-action,.content-start calcite-sort-handle,.content-end calcite-action,.content-end calcite-sort-handle,.selection-container calcite-action,.selection-container calcite-sort-handle,.drag-container calcite-action,.drag-container calcite-sort-handle,.expanded-container calcite-action,.expanded-container calcite-sort-handle{align-self:stretch}.drag-container,.selection-container,.expanded-container{padding-block-end:var(--calcite-spacing-px)}.expanded-container,.selection-container{cursor:pointer}.actions-start,.actions-end{position:relative;padding:0}.actions-start ::slotted(calcite-action),.actions-start ::slotted(calcite-action-menu),.actions-start ::slotted(calcite-sort-handle),.actions-start ::slotted(calcite-dropdown),.actions-end ::slotted(calcite-action),.actions-end ::slotted(calcite-action-menu),.actions-end ::slotted(calcite-sort-handle),.actions-end ::slotted(calcite-dropdown){align-self:stretch;color:inherit}.row:focus .actions-start,.row:focus .actions-end{inset-block:.125rem}.row:focus .actions-start .close,.row:focus .actions-start ::slotted(calcite-action),.row:focus .actions-start ::slotted(calcite-action-menu),.row:focus .actions-start ::slotted(calcite-sort-handle),.row:focus .actions-start ::slotted(calcite-dropdown),.row:focus .actions-end .close,.row:focus .actions-end ::slotted(calcite-action),.row:focus .actions-end ::slotted(calcite-action-menu),.row:focus .actions-end ::slotted(calcite-sort-handle),.row:focus .actions-end ::slotted(calcite-dropdown){block-size:calc(100% - .25rem)}.row:focus:after,.row:focus:before{position:absolute;content:"";inline-size:.125rem;z-index:var(--calcite-z-index-header);background-color:var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));inset-block:0}.row:focus:before{inset-inline-start:0}.row:focus:after{inset-inline-end:0}.container--border:focus:before{display:none}::slotted(calcite-list:empty){border-block-start-width:0px}:host([hidden]){display:none}[hidden]{display:none}`,Nv=new Map,z1=class z1 extends ji{constructor(){super(),this.actionsEndRef=Yn(),this.actionsStartRef=Yn(),this.containerRef=Yn(),this.contentRef=Yn(),this.defaultSlotRef=Yn(),this.handleGridRef=Yn(),this.messages=fo(),this.focusSetter=zs()(this),this.hasActionsEnd=!1,this.hasActionsStart=!1,this.hasContentBottom=!1,this.hasContentEnd=!1,this.hasContentStart=!1,this.hasCustomContent=!1,this.level=null,this.expandable=!1,this.active=!1,this.bordered=!1,this.sortDisabled=!1,this.closable=!1,this.closed=!1,this.disabled=!1,this.dragDisabled=!1,this.dragHandle=!1,this.expanded=!1,this.filterHidden=!1,this.interactionMode=null,this.displayMode="flat",this.addToItems=[],this.moveToItems=[],this.scale="m",this.selected=!1,this.selectionAppearance=null,this.selectionMode=null,this.sortHandleOpen=!1,this.unavailable=!1,this.calciteInternalFocusPreviousItem=vt({cancelable:!1}),this.calciteInternalListItemActive=vt({cancelable:!1}),this.calciteInternalListItemChange=vt({cancelable:!1}),this.calciteInternalListItemSelect=vt({cancelable:!1}),this.calciteInternalListItemSelectMultiple=vt({cancelable:!1}),this.calciteInternalListItemToggle=vt({cancelable:!1}),this.calciteListItemClose=vt({cancelable:!1}),this.calciteListItemCollapse=vt({cancelable:!1}),this.calciteListItemExpand=vt({cancelable:!1}),this.calciteListItemSelect=vt({cancelable:!1}),this.calciteListItemSortHandleBeforeClose=vt({cancelable:!1}),this.calciteListItemSortHandleBeforeOpen=vt({cancelable:!1}),this.calciteListItemSortHandleClose=vt({cancelable:!1}),this.calciteListItemSortHandleOpen=vt({cancelable:!1}),this.calciteListItemToggle=vt({cancelable:!1}),this.listen("calciteInternalListItemGroupDefaultSlotChange",this.handleCalciteInternalListDefaultSlotChanges),this.listen("calciteInternalListDefaultSlotChange",this.handleCalciteInternalListDefaultSlotChanges)}get open(){return this.expanded}set open(e){Sx.deprecated("property",{name:"open",removalVersion:4,suggested:"expanded"}),this.expanded=e}async setFocus(e){return this.focusSetter(()=>{const{containerRef:i,parentListEl:r}=this,o=Nv.get(r);if(typeof o=="number"){const h=this.getGridCells()[o];if(h){this.focusCell(h);return}}return{target:i.value,includeContainer:!0,strategy:"focusable"}},e)}connectedCallback(){super.connectedCallback();const{el:e}=this;this.parentListEl=e.closest(By),this.level=dK(e)+1,this.setSelectionDefaults()}disconnectedCallback(){super.disconnectedCallback(),Nv.clear()}willUpdate(e){e.has("active")&&(this.hasUpdated||this.active!==!1)&&this.activeHandler(this.active),e.has("closed")&&(this.hasUpdated||this.closed!==!1)&&this.handleClosedChange(),e.has("disabled")&&(this.hasUpdated||this.disabled!==!1)&&this.handleDisabledChange(),e.has("selected")&&(this.hasUpdated||this.selected!==!1)&&this.handleSelectedChange(),e.has("sortHandleOpen")&&(this.hasUpdated||this.sortHandleOpen!==!1)&&this.sortHandleOpenHandler(),e.has("displayMode")&&this.hasUpdated&&this.handleExpandableChange(this.defaultSlotRef.value),e.has("expanded")&&this.hasUpdated&&(this.expanded?(this.handleExpandedChange(),this.calciteListItemExpand.emit()):this.calciteListItemCollapse.emit())}updated(){mo(this)}activeHandler(e){e||this.focusCell(null,!1)}handleClosedChange(){this.emitCalciteInternalListItemChange()}handleDisabledChange(){this.emitCalciteInternalListItemChange()}handleExpandedChange(){this.emitCalciteInternalListItemToggle()}handleSelectedChange(){this.calciteInternalListItemSelect.emit()}sortHandleOpenHandler(){this.sortHandleEl&&(this.sortHandleEl.open=this.sortHandleOpen)}handleCalciteInternalListDefaultSlotChanges(e){e.stopPropagation(),this.handleExpandableChange(this.defaultSlotRef.value)}setSortHandleEl(e){this.sortHandleEl=e,this.sortHandleOpenHandler()}handleSortHandleBeforeOpen(e){e.stopPropagation(),this.calciteListItemSortHandleBeforeOpen.emit()}handleSortHandleBeforeClose(e){e.stopPropagation(),this.calciteListItemSortHandleBeforeClose.emit()}handleSortHandleClose(e){e.stopPropagation(),this.sortHandleOpen=!1,this.calciteListItemSortHandleClose.emit()}handleSortHandleOpen(e){e.stopPropagation(),this.sortHandleOpen=!0,this.calciteListItemSortHandleOpen.emit()}emitInternalListItemActive(){this.calciteInternalListItemActive.emit()}emitCalciteInternalListItemToggle(){this.calciteInternalListItemToggle.emit()}emitCalciteInternalListItemChange(){this.calciteInternalListItemChange.emit()}handleCloseClick(){this.closed=!0,this.calciteListItemClose.emit()}handleContentSlotChange(e){this.hasCustomContent=Cr(e)}handleActionsStartSlotChange(e){this.hasActionsStart=Cr(e)}handleActionsEndSlotChange(e){this.hasActionsEnd=Cr(e)}handleContentStartSlotChange(e){this.hasContentStart=Cr(e)}handleContentEndSlotChange(e){this.hasContentEnd=Cr(e)}handleContentBottomSlotChange(e){this.hasContentBottom=Cr(e)}setSelectionDefaults(){const{parentListEl:e,selectionMode:i,selectionAppearance:r}=this;e&&(i||(this.selectionMode=e.selectionMode),r||(this.selectionAppearance=e.selectionAppearance))}handleExpandableChange(e){if(!e)return;const i=uK(e);i.lists.forEach(r=>{r.displayMode=this.displayMode}),this.expandable=this.displayMode==="nested"&&(i.lists.length>0||i.items.length>0)}handleDefaultSlotChange(e){this.handleExpandableChange(e.target)}handleToggleClick(){this.toggle()}toggle(e=!this.expanded){this.expanded=e,this.calciteListItemToggle.emit()}handleItemClick(e){e.defaultPrevented||this.toggleSelected(e.shiftKey)}async toggleSelected(e){const{selectionMode:i,selected:r}=this;this.disabled||(i==="multiple"||i==="single"?this.selected=!r:i==="single-persist"&&(this.selected=!0),this.calciteInternalListItemSelectMultiple.emit({selectMultiple:e&&i==="multiple"}),await this.updateComplete,this.calciteListItemSelect.emit())}getGridCells(){return[this.handleGridRef.value,this.actionsStartRef.value,this.contentRef.value,this.actionsEndRef.value].filter(e=>e&&!e.hidden)}handleItemKeyDown(e){if(e.defaultPrevented)return;const{key:i}=e,r=e.composedPath(),{containerRef:o,actionsStartRef:{value:h},actionsEndRef:{value:d},expanded:a,expandable:_}=this,T=this.getGridCells(),E=T.findIndex(k=>r.includes(k));if(i==="Enter"&&!r.includes(h)&&!r.includes(d))e.preventDefault(),this.toggleSelected(e.shiftKey);else if(i==="ArrowRight"){e.preventDefault();const k=E+1;E===-1?!a&&_?(this.toggle(!0),this.focusCell(null)):T[0]&&this.focusCell(T[0]):T[E]&&T[k]&&this.focusCell(T[k])}else if(i==="ArrowLeft"){e.preventDefault();const k=E-1;E===-1?(this.focusCell(null),a&&_?this.toggle(!1):this.calciteInternalFocusPreviousItem.emit()):E===0?(this.focusCell(null),o.value.focus()):T[E]&&T[k]&&this.focusCell(T[k])}}focusCellNull(){this.focusCell(null)}setFocusCell(e,i,r){const{parentListEl:o}=this;r&&Nv.set(o,null);const h=this.getGridCells();h.forEach(d=>{d.removeAttribute("tabindex"),d.removeAttribute(oD)}),e&&(e===i?e.tabIndex=0:e.removeAttribute("tabindex"),e.setAttribute(oD,""),r&&Nv.set(o,h.indexOf(e)))}focusCell(e,i=!0){const r=mR(e);this.setFocusCell(e,r,i),r?.focus()}renderSelected(){const{selected:e,selectionMode:i,selectionAppearance:r}=this;return i==="none"||r==="border"?null:ai("selection-container",Ne`<div class=${Fe({[pi.selectionContainer]:!0,[pi.selectionContainerSingle]:i==="single"||i==="single-persist"})} @click=${this.handleItemClick}><calcite-icon .icon=${e?i==="multiple"?Xl.selectedMultiple:Xl.selectedSingle:i==="multiple"?Xl.unselectedMultiple:Xl.unselectedSingle} .scale=${Br(this.scale)}></calcite-icon></div>`)}renderDragHandle(){const{label:e,dragHandle:i,dragDisabled:r,setPosition:o,setSize:h,moveToItems:d,sortDisabled:a,addToItems:_}=this;return i?ai("drag-handle-container",Ne`<div .ariaLabel=${e} class=${Fe({[pi.dragContainer]:!0,[pi.gridCell]:!0})} role=gridcell ${hi(this.handleGridRef)}><calcite-sort-handle .addToItems=${_} .disabled=${r} .label=${e} .moveToItems=${d} @calciteSortHandleBeforeClose=${this.handleSortHandleBeforeClose} @calciteSortHandleBeforeOpen=${this.handleSortHandleBeforeOpen} @calciteSortHandleClose=${this.handleSortHandleClose} @calciteSortHandleOpen=${this.handleSortHandleOpen} overlay-positioning=fixed .scale=${this.scale} .setPosition=${o} .setSize=${h} .sortDisabled=${a} ${hi(this.setSortHandleEl)}></calcite-sort-handle></div>`):null}renderExpanded(){const{el:e,expanded:i,expandable:r,messages:o,displayMode:h,scale:d}=this;if(h!=="nested")return null;const a=Z0(e),_=r?i?Xl.open:a==="rtl"?Xl.collapsedRTL:Xl.collapsedLTR:Xl.blank,T=Br(d),E=r?i?o.collapse:o.expand:void 0,k=r?this.handleToggleClick:void 0;return ai("expanded-container",Ne`<div class=${Fe(pi.expandedContainer)} @click=${k} title=${E??ut}>${ai(_,Ne`<calcite-icon .icon=${_} .scale=${T}></calcite-icon>`)}</div>`)}renderActionsStart(){const{label:e,hasActionsStart:i}=this;return ai("actions-start-container",Ne`<div .ariaLabel=${e} class=${Fe({[pi.actionsStart]:!0,[pi.gridCell]:!0})} .hidden=${!i} role=gridcell ${hi(this.actionsStartRef)}><slot name=${Vp.actionsStart} @slotchange=${this.handleActionsStartSlotChange}></slot></div>`)}renderActionsEnd(){const{label:e,hasActionsEnd:i,closable:r,messages:o}=this;return ai("actions-end-container",Ne`<div .ariaLabel=${e} class=${Fe({[pi.actionsEnd]:!0,[pi.gridCell]:!0})} .hidden=${!(i||r)} role=gridcell ${hi(this.actionsEndRef)}><slot name=${Vp.actionsEnd} @slotchange=${this.handleActionsEndSlotChange}></slot>${r?ai("close-action",Ne`<calcite-action appearance=transparent class=${Fe(pi.close)} .icon=${Xl.close} .label=${o.close} @click=${this.handleCloseClick} .scale=${this.scale} .text=${o.close}></calcite-action>`):null}</div>`)}renderContentStart(){const{hasContentStart:e}=this;return Ne`<div class=${Fe(pi.contentStart)} .hidden=${!e}><slot name=${Vp.contentStart} @slotchange=${this.handleContentStartSlotChange}></slot></div>`}renderCustomContent(){const{hasCustomContent:e}=this;return Ne`<div class=${Fe(pi.customContent)} .hidden=${!e}><slot name=${Vp.content} @slotchange=${this.handleContentSlotChange}></slot></div>`}renderIconStart(){const{iconStart:e,iconFlipRtl:i,scale:r}=this;return e?ai("icon-start",Ne`<calcite-icon class=${Fe(pi.icon)} .flipRtl=${i==="both"||i==="start"} .icon=${e} .scale=${Br(r)}></calcite-icon>`):null}renderIconEnd(){const{iconEnd:e,iconFlipRtl:i,scale:r}=this;return e?ai("icon-end",Ne`<calcite-icon class=${Fe(pi.icon)} .flipRtl=${i==="both"||i==="end"} .icon=${e} .scale=${Br(r)}></calcite-icon>`):null}renderContentEnd(){const{hasContentEnd:e}=this;return Ne`<div class=${Fe(pi.contentEnd)} .hidden=${!e}><slot name=${Vp.contentEnd} @slotchange=${this.handleContentEndSlotChange}></slot></div>`}renderContentBottom(){const{hasContentBottom:e}=this;return Ne`<div class=${Fe(pi.contentBottom)} .hidden=${!e}><slot name=${Vp.contentBottom} @slotchange=${this.handleContentBottomSlotChange}></slot></div>`}renderDefaultContainer(){return Ne`<div class=${Fe({[pi.nestedContainer]:!0,[pi.nestedContainerExpanded]:this.expandable&&this.expanded})}><slot @slotchange=${this.handleDefaultSlotChange} ${hi(this.defaultSlotRef)}></slot></div>`}renderContentProperties(){const{label:e,description:i,hasCustomContent:r}=this;return!r&&(e||i)?ai("content",Ne`<div class=${Fe(pi.content)}>${e?ai("label",Ne`<div class=${Fe(pi.label)}>${e}</div>`):null}${i?ai("description",Ne`<div class=${Fe(pi.description)}>${i}</div>`):null}</div>`):null}renderContentContainer(){const{description:e,label:i,selectionMode:r,hasCustomContent:o,unavailable:h}=this,d=o||!!i||!!e,a=[this.renderContentStart(),this.renderCustomContent(),this.renderIconStart(),this.renderContentProperties(),this.renderIconEnd(),this.renderContentEnd()];return ai("content-container",Ne`<div .ariaLabel=${i} class=${Fe({[pi.gridCell]:!0,[pi.contentContainer]:!0,[pi.contentContainerUnavailable]:h,[pi.contentContainerSelectable]:r!=="none",[pi.contentContainerHasCenterContent]:d})} @click=${this.handleItemClick} role=gridcell ${hi(this.contentRef)}>${a}</div>`)}render(){const{expandable:e,expanded:i,level:r,active:o,label:h,selected:d,selectionAppearance:a,selectionMode:_,interactionMode:T,closed:E,filterHidden:k,bordered:L,disabled:O,hasContentBottom:H}=this,re=L&&H,pe=L&&!H,ge=_!=="none"&&a==="border",Se=ge&&d,Pe=ge&&!d,Re=T==="interactive"||T==="static"&&_!=="none"&&a==="border";return go({disabled:O,children:Ne`<div class=${Fe({[pi.wrapper]:!0,[pi.wrapperBordered]:re})}><div .ariaExpanded=${e?i:null} .ariaLabel=${h} .ariaLevel=${r} .ariaSelected=${d} class=${Fe({[pi.row]:!0,[pi.container]:!0,[pi.containerHover]:Re,[pi.containerBorder]:ge,[pi.containerBorderSelected]:Se,[pi.containerBorderUnselected]:Pe})} .hidden=${E||k} @focus=${this.focusCellNull} @focusin=${this.emitInternalListItemActive} @keydown=${this.handleItemKeyDown} role=row .tabIndex=${o?0:-1} ${hi(this.containerRef)}>${this.renderDragHandle()}${this.renderSelected()}${this.renderExpanded()}<div class=${Fe({[pi.contentContainerWrapper]:!0,[pi.contentContainerWrapperBordered]:pe})}>${this.renderActionsStart()}${this.renderContentContainer()}${this.renderActionsEnd()}</div></div>${this.renderContentBottom()}</div>${this.renderDefaultContainer()}`})}};z1.properties={hasActionsEnd:[16,{},{state:!0}],hasActionsStart:[16,{},{state:!0}],hasContentBottom:[16,{},{state:!0}],hasContentEnd:[16,{},{state:!0}],hasContentStart:[16,{},{state:!0}],hasCustomContent:[16,{},{state:!0}],level:[16,{},{state:!0}],expandable:[16,{},{state:!0}],parentListEl:[16,{},{state:!0}],active:[5,{},{type:Boolean}],bordered:[5,{},{type:Boolean}],sortDisabled:[5,{},{type:Boolean}],closable:[7,{},{reflect:!0,type:Boolean}],closed:[7,{},{reflect:!0,type:Boolean}],description:1,disabled:[7,{},{reflect:!0,type:Boolean}],dragDisabled:[7,{},{reflect:!0,type:Boolean}],dragHandle:[7,{},{reflect:!0,type:Boolean}],expanded:[7,{},{reflect:!0,type:Boolean}],filterHidden:[7,{},{reflect:!0,type:Boolean}],interactionMode:1,label:1,messageOverrides:[0,{},{attribute:!1}],metadata:[0,{},{attribute:!1}],displayMode:[3,{},{reflect:!0}],addToItems:[0,{},{attribute:!1}],moveToItems:[0,{},{attribute:!1}],open:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],selected:[7,{},{reflect:!0,type:Boolean}],selectionAppearance:[3,{},{reflect:!0}],selectionMode:[3,{},{reflect:!0}],setPosition:[9,{},{type:Number}],setSize:[9,{},{type:Number}],sortHandleOpen:[7,{},{reflect:!0,type:Boolean}],unavailable:[7,{},{reflect:!0,type:Boolean}],value:1,iconStart:[3,{},{reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}]},z1.styles=[HK,eL];let NC=z1;ar("calcite-list-item",NC);let Mu;const kn=globalThis;function Ve(t){return typeof Mu[t]=="function"?Mu[t]=Mu[t](kn):Mu[t]}Mu=kn.dojoConfig?.has||kn.esriConfig?.has?{...kn.dojoConfig?.has,...kn.esriConfig?.has}:{},Ve.add=(t,e,i,r)=>{(r||Mu[t]===void 0)&&(Mu[t]=e),i&&Ve(t)},Ve.cache=Mu,Ve.add("big-integer-warning-enabled",!0),Ve.add("esri-deprecation-warnings",!0),Ve.add("esri-tests-disable-screenshots",!1),Ve.add("esri-tests-use-full-window",!1),Ve.add("esri-tests-post-to-influx",!0),Ve.add("esri-cim-animations-enable-status","enabled"),Ve.add("esri-cim-animations-spotlight",!1),Ve.add("esri-cim-animations-freeze-time",!1),(()=>{Ve.add("host-webworker",kn.WorkerGlobalScope!==void 0&&self instanceof kn.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(Ve.add("host-browser",t),Ve.add("host-node",!(typeof kn.process!="object"||!kn.process.versions?.node||!kn.process.versions.v8)),Ve.add("dom",t),Ve("host-browser")){const e=navigator,i=e.userAgent,r=e.appVersion,o=parseFloat(r);if(Ve.add("wp",parseFloat(i.split("Windows Phone")[1])||void 0),Ve.add("msapp",parseFloat(i.split("MSAppHost/")[1])||void 0),Ve.add("khtml",r.includes("Konqueror")?o:void 0),Ve.add("edge",parseFloat(i.split("Edge/")[1])||void 0),Ve.add("opr",parseFloat(i.split("OPR/")[1])||void 0),Ve.add("webkit",!Ve("wp")&&!Ve("edge")&&parseFloat(i.split("WebKit/")[1])||void 0),Ve.add("chrome",!Ve("edge")&&!Ve("opr")&&parseFloat(i.split("Chrome/")[1])||void 0),Ve.add("android",!Ve("wp")&&parseFloat(i.split("Android ")[1])||void 0),Ve.add("safari",!r.includes("Safari")||Ve("wp")||Ve("chrome")||Ve("android")||Ve("edge")||Ve("opr")?void 0:parseFloat(r.split("Version/")[1])),Ve.add("mac",r.includes("Macintosh")),!Ve("wp")&&/(iPhone|iPod|iPad)/.test(i)){const h=RegExp.$1.replace(/P/,"p"),d=/OS ([\d_]+)/.test(i)?RegExp.$1:"1",a=parseFloat(d.replace(/_/,".").replaceAll("_",""));Ve.add(h,a),Ve.add("ios",a)}Ve("webkit")||(!i.includes("Gecko")||Ve("wp")||Ve("khtml")||Ve("edge")||Ve.add("mozilla",o),Ve("mozilla")&&Ve.add("ff",parseFloat(i.split("Firefox/")[1]||i.split("Minefield/")[1])||void 0))}})(),(()=>{if(kn.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&Ve.add("esri-mobile",e),i&&Ve.add("esri-iPhone",i),Ve.add("esri-geolocation",!!navigator.geolocation)}Ve.add("esri-wasm","WebAssembly"in kn),Ve.add("esri-performance-mode-frames-between-render",20),Ve.add("esri-force-performance-mode",!1),Ve.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in kn,e=kn.crossOriginIsolated===!1;return t&&!e}),Ve.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),Ve.add("esri-atomics","Atomics"in kn),Ve.add("esri-workers","Worker"in kn),Ve.add("web-feat:cache","caches"in kn),Ve.add("esri-workers-arraybuffer-transfer",!Ve("safari")||Number(Ve("safari"))>=12),Ve.add("workers-pool-size",8),Ve.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),Ve.add("featurelayer-simplify-payload-size-factors",[1,1,4]),Ve.add("featurelayer-fast-triangulation-enabled",!0),Ve.add("featurelayer-animation-enabled",!0),Ve.add("featurelayer-snapshot-enabled",!0),Ve.add("featurelayer-snapshot-initial-tolerance",0),Ve.add("featurelayer-snapshot-point-min-threshold",8e4),Ve.add("featurelayer-snapshot-point-max-threshold",4e5),Ve.add("featurelayer-snapshot-multipoint-min-threshold",2e4),Ve.add("featurelayer-snapshot-multipoint-max-threshold",1e5),Ve.add("featurelayer-snapshot-polygon-min-threshold",2e3),Ve.add("featurelayer-snapshot-polygon-max-threshold",2e3),Ve.add("featurelayer-snapshot-polyline-min-threshold",2e3),Ve.add("featurelayer-snapshot-polyline-max-threshold",2e3),Ve.add("featurelayer-snapshot-max-vertex-count",25e4),Ve.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!0),Ve.add("featurelayer-snapshot-concurrency",4),Ve.add("featurelayer-snapshot-coverage",.1),Ve.add("featurelayer-query-max-depth",4),Ve.add("featurelayer-query-pausing-enabled",!1),Ve.add("featurelayer-query-tile-concurrency",4),Ve.add("featurelayer-query-tile-max-features",6e5),Ve.add("featurelayer-advanced-symbols",!1),Ve.add("featurelayer-pbf",!0),Ve.add("featurelayer-pbf-statistics",!1),Ve.add("feature-layers-workers",!0),Ve.add("feature-polyline-generalization-factor",1),Ve.add("parquetlayer-full-query-feature-count",2e4),Ve.add("parquetlayer-hittest-max-feature-count",1),Ve.add("parquetlayer-persistence-enabled",!1),Ve.add("mapview-transitions-duration",200),Ve.add("mapview-essential-goto-duration",200),Ve.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),Ve.add("mapserver-pbf-version-support",10.81),Ve.add("mapservice-popup-identify-max-tolerance",20),Ve.add("request-queue-concurrency-hosted",16),Ve.add("request-queue-concurrency-non-hosted",4),Ve.add("curve-densification-coarse-segments",128),Ve.add("curve-densification-max-segments",2e3),Ve.add("curve-densification-min-segments",3),Ve.add("curve-densification-pixel-deviation",.5),Ve.add("view-readyState-waiting-delay",1e3),Ve.add("gradient-depth-bias",.01),Ve.add("gradient-depth-epsilon",1e-8),Ve.add("enable-feature:esri-compress-textures",!0),Ve("host-webworker")||Ve("host-browser")&&(Ve.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),Ve.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function Spe(t){}function Tpe(t){return t}var Es;let ZK=(Es=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*Es._m}getInt(){return this._seed=(Es._a*this._seed+Es._c)%Es._m,this._seed}getFloat(){return this.getInt()/(Es._m-1)}getIntRange(e,i){return Math.round(this.getFloatRange(e,i))}getFloatRange(e,i){const r=i-e;return e+this.getInt()/Es._m*r}},Es._m=2147483647,Es._a=48271,Es._c=0,Es);const Cpe=1.5;function Epe(t,e){return e?t.filter((i,r,o)=>o.findIndex(e.bind(null,i))===r):Array.from(new Set(t))}function WK(t,e,i,r,o,h,d){if(t==null&&r==null)return!0;e=Math.max(0,e),o=Math.max(0,o),i=Math.max(0,i<0?(t?.length??0)+i:i),h=Math.max(0,h<0?(r?.length??0)+h:h);const a=i-e;if(t==null||r==null||a!==h-o)return!1;if(d){for(let _=0;_<a;_++)if(!d(t[e+_],r[o+_]))return!1}else for(let _=0;_<a;_++)if(t[e+_]!==r[o+_])return!1;return!0}function hw(t,e,i){return WK(t,0,t?.length??0,e,0,e?.length??0,i)}function Ipe(){return(t,e)=>{if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}}function $pe(t,e,i){let r,o;return i?(r=e.filter(h=>!t.some(d=>i(d,h))),o=t.filter(h=>!e.some(d=>i(d,h)))):(r=e.filter(h=>!t.includes(h)),o=t.filter(h=>!e.includes(h))),{added:r,removed:o}}let EL=class{constructor(){this.last=0}};const IL=new EL;function BC(t,e,i,r){r=r||IL;const o=Math.max(0,r.last-10);for(let d=o;d<i;++d)if(t[d]===e)return r.last=d,d;const h=Math.min(o,i);for(let d=0;d<h;++d)if(t[d]===e)return r.last=d,d;return-1}function Mpe(t,e,i,r){const o=t.length,h=BC(t,e,o,r);if(h!==-1)return t[h]=t[o-1],t.pop(),e}const la=new Set;function YK(t,e,i=t.length,r=e.length,o,h){if(r===0||i===0)return i;la.clear();for(let a=0;a<r;++a)la.add(e[a]);o=o||IL;const d=Math.max(0,o.last-10);for(let a=d;a<i;++a)if(la.has(t[a])&&(h?.push(t[a]),la.delete(t[a]),t[a]=t[i-1],--i,--a,la.size===0||i===0))return la.clear(),i;for(let a=0;a<d;++a)if(la.has(t[a])&&(h?.push(t[a]),la.delete(t[a]),t[a]=t[i-1],--i,--a,la.size===0||i===0))return la.clear(),i;return la.clear(),i}function XK(t){return t?(lD.seed=t,()=>lD.getFloat()):Math.random}const lD=new ZK;function kpe(t,e){if(!t)return t;const i=XK(e);for(let r=t.length-1;r>0;r--){const o=Math.floor(i()*(r+1)),h=t[r];t[r]=t[o],t[o]=h}return t}function JK(t,e){const i=t.indexOf(e);return i!==-1?(t.splice(i,1),e):null}function yb(t,e){return t!=null}function Ape(t){return t instanceof ArrayBuffer}function N$(t){return t?.constructor?.name==="Int8Array"}function $L(t){return t?.constructor?.name==="Uint8Array"}function PL(t){return t?.constructor?.name==="Uint8ClampedArray"}function B$(t){return t?.constructor?.name==="Int16Array"}function ML(t){return t?.constructor?.name==="Uint16Array"}function j$(t){return t?.constructor?.name==="Int32Array"}function kL(t){return t?.constructor?.name==="Uint32Array"}function KK(t){return t?.constructor?.name==="Float16Array"}function dw(t){return t?.constructor?.name==="Float32Array"}function pw(t){return t?.constructor?.name==="Float64Array"}function QK(t){return"buffer"in t}const AL=1024;function Dpe(t){return pw(t)||dw(t)||j$(t)||B$(t)||N$(t)}function zpe(t){return pw(t)||dw(t)}function Ope(t){return pw(t)?179769e303:KK(t)?65504:dw(t)?3402823e32:kL(t)?4294967295:ML(t)?65535:$L(t)||PL(t)?255:j$(t)?2147483647:B$(t)?32767:N$(t)?127:256}const Rpe=-32768,Lpe=-2147483648;function Fpe(t,e){let i;for(i in t)t.hasOwnProperty(i)&&t[i]===void 0&&delete t[i];return t}function dt(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=RL(t);if(e!=null)return e;if(DL(t))return t.clone();if(zL(t))return t.map(dt);if(OL(t))throw new Error("Trying to clone an unclonable Accessor instance");const i={};for(const r of Object.getOwnPropertyNames(t))i[r]=dt(t[r]);return i}function jC(t,e){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const i=RL(t);if(i!=null)return i;if(zL(t)){let o=!0;const h=t.map(d=>{const a=jC(d,e);return d!=null&&a==null&&(o=!1),a});return o?h:null}if(DL(t))return t.clone(e);if(t instanceof File||t instanceof Blob)return t;if(OL(t))return null;const r=new(Object.getPrototypeOf(t)).constructor;for(const o of Object.getOwnPropertyNames(t)){const h=t[o],d=jC(h);if(h!=null&&d==null)return null;r[o]=d}return r}function DL(t){return typeof t.clone=="function"}function zL(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function OL(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function cD(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function RL(t){if(N$(t)||$L(t)||PL(t)||B$(t)||ML(t)||j$(t)||kL(t)||dw(t)||pw(t))return t.slice();if(t instanceof Date)return new Date(t);if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[i,r]of t)e.set(i,dt(r));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(dt(i));return e}return null}function U$(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function eQ(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&hw(t,e):t instanceof Set?e instanceof Set&&iQ(t,e):t instanceof Map?e instanceof Map&&rQ(t,e):!!cD(t)&&cD(e)&&tQ(t,e))}function tQ(t,e){if(t===null||e===null)return!1;const i=Object.keys(t);if(e===null||Object.keys(e).length!==i.length)return!1;for(const r of i)if(t[r]!==e[r]||!Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function iQ(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function rQ(t,e){if(t.size!==e.size)return!1;for(const[i,r]of t){const o=e.get(i);if(o!==r||o===void 0&&!e.has(i))return!1}return!0}function nQ(t,e,i=!1){return FL(t,e,i)}function fw(t,e){if(e!=null)return e[t]||LL(t.split("."),!1,e)}function Cm(t,e,i){const r=t.split("."),o=r.pop(),h=LL(r,!0,i);h&&o&&(h[o]=e)}function uD(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const i=e;if(t.length!==i.length)return!0;for(let r=0;r<t.length;r++)if(uD(t[r],i[r]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const i in t)if(uD(t[i],e[i]))return!0;return!1}return t!==e}function LL(t,e,i){let r=i;for(const o of t){if(r==null)return;if(!(o in r)){if(!e)return;r[o]={}}r=r[o]}return r}function FL(t,e,i){return e?Object.keys(e).reduce((r,o)=>{if(o==="__proto__")return r;let h=r[o],d=e[o];return h===d?r:h===void 0?(r[o]=dt(d),r):(Array.isArray(d)||Array.isArray(r)?(h=h?Array.isArray(h)?r[o]=h.slice():r[o]=[h]:r[o]=[],d&&(Array.isArray(d)||(d=[d]),i?d.forEach(a=>{h.includes(a)||h.push(a)}):r[o]=d.slice())):d&&typeof d=="object"?r[o]=FL(h,d,i):r.hasOwnProperty(o)&&!e.hasOwnProperty(o)||(r[o]=d),r)},t||{}):t}function Npe(t,e){for(const i of Object.entries(t))if(e===i[1])return i[0]}function Bpe(t,e){return Object.values(t).includes(e)}const Ai={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(nQ(Ai,globalThis.esriConfig,!0),delete Ai.has),!Ai.assetsPath){{const t="4.34";Ai.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Ai.defaultAssetsPath=Ai.assetsPath}const sQ=/\{([^}]+)\}/g;function hD(t){return t??""}function V$(t,e){return e?t.replaceAll(sQ,typeof e=="object"?(i,r)=>hD(fw(r,e)):(i,r)=>hD(e(r))):t}function jpe(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,i=>e?.includes(i)?i:`\\${i}`)}function NL(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}let dD;function Upe(t){return dD??=new DOMParser,dD.parseFromString(t||"","text/html").body.innerText||""}const pD={info:0,warn:1,error:2,none:3};var Or;let ui=(Or=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,Or._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=Or.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,Or._loggers.get(e)||new Or({module:e})}_log(e,i,...r){if(this._matchLevel(e)){if(i!=="always"&&!Or._throttlingDisabled){const o=aQ(r),h=this._loggedMessages[e].get(o);if(i==="once"&&h!=null||i==="oncePerTick"&&h&&h>=Or._tickCounter)return;this._loggedMessages[e].set(o,Or._tickCounter),Or._scheduleTickCounterIncrement()}for(const o of Ai.log.interceptors)if(o(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,i){let r=this;for(;r!=null;){const o=r[e];if(o!=null)return o;r=r.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",oQ)}_matchLevel(e){const i=Ai.log.level||"warn";return pD[this._parentWithMember("level",i)]<=pD[e]}static _scheduleTickCounterIncrement(){Or._tickCounterScheduled||(Or._tickCounterScheduled=!0,Promise.resolve().then(()=>{Or._tickCounter++,Or._tickCounterScheduled=!1}))}},Or._loggers=new Map,Or._tickCounter=0,Or._tickCounterScheduled=!1,Or._throttlingDisabled=!1,Or);function oQ(t,e,...i){console[t](`[${e}]`,...i)}function aQ(...t){return NL(JSON.stringify(t,(i,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}const lQ={remove:()=>{}};function un(t){return t?{remove(){t&&(t(),t=void 0)}}:lQ}function cQ(t){t.forEach(e=>e?.remove())}function G$(t){return un(()=>cQ(t))}function uQ(t){return un(()=>t?.abort())}function Vpe(t){return{[Symbol.dispose](){t.remove()}}}function Uu(t){return t.__accessor__??null}function hQ(t,e){return t?.metadata?.[e]!=null}function _b(t,e,i){return i?Gx(t,e,{policy:i,path:""}):Gx(t,e,null)}function Gx(t,e,i){return e?Object.keys(e).reduce((r,o)=>{const h=o;if(h==="__proto__")return r;let d=null,a="merge";if(i&&(d=i.path?`${i.path}.${o}`:o,a=i.policy(d)),a==="replace"||a==="replace-arrays"&&Array.isArray(r[h]))return r[h]=e[h],r;if(r[h]===void 0)return r[h]=dt(e[h]),r;let _=r[h],T=e[h];if(_===T)return r;if(Array.isArray(T)||Array.isArray(r))_=_?Array.isArray(_)?r[h]=_.slice():r[h]=[_]:r[h]=[],T&&(Array.isArray(T)||(T=[T]),T.forEach(E=>{_.includes(E)||_.push(E)}));else if(T&&typeof T=="object")if(i){const E=i.path;i.path=d,r[h]=Gx(_,T,i),i.path=E}else r[h]=Gx(_,T,null);else r.hasOwnProperty(o)&&!e.hasOwnProperty(o)||(r[h]=T);return r},t||{}):t}function BL(t){return Array.isArray(t)?t:t.split(".")}function fD(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function dQ(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...fD(i));return e}return fD(t)}function jL(t,e,i,r){const o=dQ(e);if(o.length!==1){const h=o.map(d=>r(t,d,i));return G$(h)}return r(t,o[0],i)}const Ji={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let mw=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const qx=new mw,gy=[];let Hy=qx;function Zt(t){Hy.onAccessed(t)}let vb=!1,bb=!1;function _c(t,e,i){if(vb)return q$(t,e,i);let r=null;return UL(t),r=e.call(i),VL(),r}function pQ(t,e){return _c(qx,t,e)}function q$(t,e,i){const r=vb;vb=!0,UL(t);let o=null;try{o=e.call(i)}catch(h){bb&&ui.getLogger("esri.core.accessorSupport.tracking").error(h)}return VL(),vb=r,o}function UL(t){Hy=t,gy.push(t)}function VL(){const t=gy.length;if(t>1){const e=gy.pop();Hy=gy[t-2],e.onTrackingEnd()}else if(t===1){const e=gy.pop();Hy=qx,e.onTrackingEnd()}else Hy=qx}function GL(t,e){if(e.flags&Ji.DepTrackingInitialized)return;e.flags|=Ji.DepTrackingInitialized;const i=bb;bb=!1,e.flags&Ji.AutoTracked?q$(e.trackingTarget,e.metadata.get,t):qL(t,e),bb=i}const fQ=[];function qL(t,e){e.flags&Ji.ExplicitlyTracking||(e.flags|=Ji.ExplicitlyTracking,q$(e.trackingTarget,()=>{const i=e.metadata.dependsOn||fQ;for(const r of i)if(typeof r!="string"||r.includes(".")){const o=BL(r);for(let h=0,d=t;h<o.length&&d!=null&&typeof d=="object";++h)d=mD(d,o[h],h!==o.length-1)}else mD(t,r,!1)}),e.flags&=-129)}function mD(t,e,i){const r=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const h=parseInt(r,10);if(!isNaN(h))return Array.isArray(t)?t[h]:t.at(h)}const o=Uu(t);if(o){const h=o.propertiesByName.get(r);h&&(Zt(h),GL(t,h))}return i?t[r]:void 0}let mQ=class{constructor(e,i){this._observers=e,this._observer=i}remove(){JK(this._observers,this._observer)}},HL=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return gQ;this._observers==null&&(this._observers=[]);const i=this._observers;let r=!1,o=!1;const h=i.length;for(let d=0;d<h;++d){const a=i[d];if(a.destroyed)o=!0;else if(a===e){r=!0;break}}return r||(i.push(e),o&&this._removeDestroyedObservers()),new mQ(i,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const i=e.length;let r=0;for(let o=0;o<i;++o){for(;o+r<i&&e[o+r].destroyed;)++r;if(r>0){if(!(o+r<i))break;e[o]=e[o+r]}}e.length=i-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const i of e)i.onCommitted();this._observers=null}}};const gQ=un();let ZL=class extends HL{notify(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onInvalidated(),r.onCommitted()}}},gw=class extends mw{constructor(e){super(new yQ(e)),this._observer&&gD.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&gD.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},yQ=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=_Q}};const gD=new FinalizationRegistry(t=>{t.deref()?.destroy()});function _Q(){}function WL(){return new ZL}function vQ(t){return new gw(t)}function YL(t){Zt(t)}function bQ(t,e){return _c(t,e)}/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const xQ=Ui`:host{display:block;box-sizing:border-box;*,*:before,*:after{box-sizing:inherit}}:host([hidden]){display:none}:host(:not(arcgis-basemap-gallery-item,arcgis-layer-list-item,arcgis-print-custom-text-elements,arcgis-print-dpi-input,arcgis-print-export-button,arcgis-print-exported-link,arcgis-print-exports-panel,arcgis-print-format-select,arcgis-print-layout-advanced-options,arcgis-print-layout-panel,arcgis-print-main-panel,arcgis-print-map-only-advanced-options,arcgis-print-map-only-panel,arcgis-print-out-spatial-reference-input,arcgis-print-preview-input,arcgis-print-scale-section,arcgis-print-template-select,arcgis-print-template-selector,arcgis-labeled-switch,arcgis-measurement-content,arcgis-version-management-service-item,arcgis-version-management-version-item,arcgis-version-management-version-list,arcgis-version-management-version-properties,arcgis-video-player-action-bar,arcgis-video-player-actions-group,arcgis-video-player-controls-group,arcgis-video-player-metadata,arcgis-video-player-settings,arcgis-video-player-slider)){font-family:var(--calcite-font-family)}`,Q0=YO({defaultAssetPath:"https://js.arcgis.com/4.34/map-components/",hydratedAttribute:"hydrated",commonStyles:xQ}),{customElement:XL,getAssetPath:wQ,setAssetPath:Xpe}=Q0;Q0.t=YL;Q0.o=WL;Q0.c=vQ;Q0.r=bQ;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const JL={widget:"esri-widget"};function H$(t){return SQ(t)||KL(t)}function SQ(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function KL(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function QL(t,e,i){if(!H$(t))throw new TypeError("target is not a Evented or EventTarget object");return KL(t)?TQ(t,e,i):t.on(e,i)}function TQ(t,e,i,r){if(Array.isArray(e)){const o=e.slice();for(const h of o)t.addEventListener(h,i,r);return un(()=>{for(const h of o)t.removeEventListener(h,i,r)})}return t.addEventListener(e,i,r),un(()=>t.removeEventListener(e,i,r))}function e4(t,e,i){if(!H$(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const r=QL(t,e,o=>{r.remove(),i.call(t,o)});return r}function t4(t,e){if(t==null)throw new Error(e??"value is None")}function xb(t){return t?.destroy(),null}function Jpe(t){return t?.dispose(),null}function e_(t){return t?.remove(),null}function CQ(t){return t?.abort(),null}function Kpe(t){return t?.release(),null}function Qpe(t,e,i){return t!=null&&e!=null?i!=null?i(t,e):t.equals(e):t===e}function Hx(t,e){let i;return t.some((r,o)=>(i=e(r,o),i!=null)),i??void 0}function EQ(t){return{setTimeout:(e,i)=>{const r=t.setTimeout(e,i);return un(()=>t.clearTimeout(r))}}}const IQ=EQ(globalThis);function $Q(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(i,r)=>r===""?"$":(fw(r,e)??"").toString())}let i4=class{constructor(e,i,r=void 0){this.name=e,this.details=r,this.message=(i&&$Q(i,r))??""}toString(){return"["+this.name+"]: "+this.message}},Ot=class r4 extends i4{constructor(e,i,r){super(e,i,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return dt(i)}catch{return"[object]"}}))}}catch(e){throw ui.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new r4(e.name,e.message,e.details)}};Ot.prototype.type="error";function As(t="Aborted"){return new Ot("AbortError",t)}function w0(t,e="Aborted"){if(Vu(t))throw As(e)}function yw(t){return t instanceof AbortSignal?t:t?.signal??void 0}function Vu(t){const e=yw(t);return e!=null&&e.aborted}function PQ(t){if(Dd(t))throw t}function tfe(t){if(!Dd(t))throw t}function S0(t,e){const i=yw(t);if(i!=null){if(!i.aborted)return e4(i,"abort",()=>e());e()}}function MQ(t,e){const i=yw(t);if(i!=null)return w0(i),e4(i,"abort",()=>e(As()))}function ife(t,e){return yw(e)==null?t:new Promise((i,r)=>{let o=S0(e,()=>r(As()));const h=()=>{o=e_(o)};t.then(h,h),t.then(i,r)})}function Dd(t){return t?.name==="AbortError"}async function rfe(t){try{return await t}catch(e){if(!Dd(e))throw e;return}}async function yy(t){if(!t)return;if(typeof t.forEach!="function"){const i=Object.keys(t),r=i.map(d=>t[d]),o=await yy(r),h={};return i.map((d,a)=>h[d]=o[a]),h}const e=t;return Promise.allSettled(e).then(i=>Array.from(e,(r,o)=>{const h=i[o];return h.status==="fulfilled"?{promise:r,value:h.value}:{promise:r,error:h.reason}}))}async function nfe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function sfe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function n4(t,e=void 0,i){const r=new AbortController;return S0(i,()=>r.abort()),new Promise((o,h)=>{let d=setTimeout(()=>{d=0,o(e)},t);S0(r,()=>{d&&(clearTimeout(d),h(As()))})})}function s4(t){return t&&typeof t.then=="function"}function yD(t){return s4(t)?t:Promise.resolve(t)}function ofe(t,e=-1){let i,r,o,h,d=null;const a=(..._)=>{if(i){r=_,h&&h.reject(As()),h=am();const L=h.promise;if(d){const O=d;d=null,O.abort()}return L}if(o=h||am(),h=null,e>0){const L=new AbortController;i=yD(t(..._,L.signal));const O=i;n4(e).then(()=>{i===O&&(h?L.abort():d=L)})}else i=1,i=yD(t(..._));const T=()=>{const L=r;r=o=i=d=null,L!=null&&a(...L)},E=i,k=o;return E.then(T,T),E.then(k.resolve,k.reject),k.promise};return a}function am(){let t,e;const i=new Promise((o,h)=>{t=o,e=h}),r=o=>{t(o)};return r.resolve=o=>t(o),r.reject=o=>e(o),r.timeout=(o,h)=>IQ.setTimeout(()=>r.reject(h),o),r.promise=i,r}function afe(t,e){e.then(t.resolve,t.reject)}async function lfe(t){await Promise.resolve(),w0(t)}function kQ(t){return t?.release&&typeof t.release=="function"}function AQ(t){return t?.acquire&&typeof t.acquire=="function"}var Nu;let _w=(Nu=class{constructor(e,i,r,o=1,h=0){this._creator=e,this._acquireFunction=i,this._releaseFunction=r,this.allocationSize=o,this._pool=new Array(h),this._initialSize=h;for(let d=0;d<h;d++)this._pool[d]=this._creator();this.allocationSize=Math.max(o,1)}destroy(){this.prune(0)}acquire(...e){let i;if(Nu.test.disabled)i=this._creator();else{if(this._pool.length===0){const r=this.allocationSize;for(let o=0;o<r;o++)this._pool[o]=this._creator()}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...e):AQ(i)&&i.acquire(...e),i}release(e){e&&!Nu.test.disabled&&(this._releaseFunction?this._releaseFunction(e):kQ(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let i=e;i<this._pool.length;++i){const r=this._pool[i];this._dispose(r)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},Nu.test={disabled:!!Ve("esri-tests-disable-memory-pools")},Nu);function DQ(t){t.length=0}let _u=class{constructor(e=50,i=50){this._pool=new _w(()=>[],void 0,DQ,i,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return tT.acquire()}static release(e){return tT.release(e)}static prune(){tT.prune()}};const tT=new _u(100);let zQ=class extends _w{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const i=super.acquire(...e);return this._set.delete(i),i}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const Bv=[];function o4(t){Bv.push(t),Bv.length===1&&queueMicrotask(()=>{const e=Bv.slice();Bv.length=0;for(const i of e)i()})}let a4=class{constructor(e,i=30){this.name=e,this._counter=0,this._samples=new Array(i)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,i)=>e-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,i)=>e+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const Zx=(t,e,i,r)=>{let o=e,h=e;const d=i>>>1,a=t[o-1];for(;h<=d;){h=o<<1,h<i&&r(t[h-1],t[h])<0&&++h;const _=t[h-1];if(r(_,a)<=0)break;t[o-1]=_,o=h}t[o-1]=a},l4=(t,e)=>t<e?-1:t>e?1:0;function OQ(t,e,i,r){i===void 0&&(i=t.length),r===void 0&&(r=l4);for(let h=i>>>1;h>e;h--)Zx(t,h,i,r);const o=e+1;for(let h=i-1;h>e;h--){const d=t[e];t[e]=t[h],t[h]=d,Zx(t,o,h,r)}}function*RQ(t,e,i,r){i===void 0&&(i=t.length),r===void 0&&(r=l4);for(let h=i>>>1;h>e;h--)Zx(t,h,i,r),yield;const o=e+1;for(let h=i-1;h>e;h--){const d=t[e];t[e]=t[h],t[h]=d,Zx(t,o,h,r),yield}}const LQ=1.5,FQ=1.1;let c4=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new EL,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>_D(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const i=new Array;for(let r=0;r<this._length;r++){const o=this.data[r];e(o)&&i.push(o)}return i}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,i){const r=this.data.indexOf(e,i);return r!==-1&&r<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let i=e;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,i=e.length){for(let r=0;r<i;r++)this.data[this._length++]=e[r]}fill(e,i){for(let r=0;r<i;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,_D(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const i=BC(this.data,e,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(BC(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,i=e.length,r){this.length=YK(this.data,e,this.length,i,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,i){if(e>=this.length||i>=this.length||e===i)return;const r=this.data[e];this.data[e]=this.data[i],this.data[i]=r}sort(e){OQ(this.data,0,this.length,e)}iterableSort(e){return RQ(this.data,0,this.length,e)}some(e,i){for(let r=0;r<this.length;++r)if(e.call(i,this.data[r],r,this.data))return!0;return!1}find(e,i){const{data:r,length:o}=this;for(let h=0;h<o;++h)if(e.call(i,r[h]))return r[h]}filterInPlace(e,i){let r=0;for(let o=0;o<this._length;++o){const h=this.data[o];e.call(i,h,o,this.data)&&(this.data[o]=this.data[r],this.data[r]=h,r++)}if(this._deallocator)for(let o=r;o<this._length;o++)this.data[o]=this._deallocator(this.data[o]);return this._length=r,this._shrink(),this}forAll(e,i){const{data:r,length:o}=this;for(let h=0;h<o;++h)e.call(i,r[h],h,r)}forEach(e,i){this.data.slice(0,this.length).forEach(e,i)}map(e,i){const r=new Array(this.length);for(let o=0;o<this.length;++o)r[o]=e.call(i,this.data[o],o,this.data);return r}reduce(e,i){let r=i;for(let o=0;o<this.length;++o)r=e(r,this.data[o],o,this.data);return r}has(e){const i=this.length,r=this.data;for(let o=0;o<i;++o)if(r[o]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function _D(t){t.data.length>LQ*t.length&&(t.data.length=Math.floor(t.length*FQ))}let NQ=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}};const BQ=["prepare","preRender","render","postRender","update","finish"],UC=[];new c4;const VC={willDispatch:!1};function u4(t){const e=new NQ(t);return UC.push(e),VC.willDispatch||(VC.willDispatch=!0,o4(jQ)),e}new c4;function jQ(){for(;UC.length;){const t=UC.shift();t.isActive&&t.callback()}VC.willDispatch=!1}function UQ(t=1,e){const i=am(),r=()=>{Vu(e)?i.reject(As()):t===0?i():(--t,o4(()=>r()))};return r(),i.promise}function VQ(t){return UQ(1,t)}async function ffe(t){await VQ(t),await new Promise(e=>requestAnimationFrame(()=>{t?.aborted||e()}))}BQ.map(t=>new a4(t));new a4("total");function mfe(t,e){for(const i of t.values())if(e(i))return!0;return!1}function vD(t,e){if(!e)return t;for(const i of e)i!=null&&t.add(i);return t}function gfe(t,e){return e!=null&&t.add(e),t}function h4(t,e){const i=new Set;return vD(i,t),vD(i,e),i}function yfe(t,e){const i=new Set;for(const r of e)t.has(r)&&i.add(r);return i}function _fe(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const i of t)if(!e.has(i))return!1;return!0}function vfe(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function bfe(t,e){const i=new Set(t);for(const r of e)i.delete(r);return i}let GQ=0;function wb(){return++GQ}function d4(t,e){const i=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const o=parseInt(i,10);if(!isNaN(o))return Array.isArray(e)?e[o]:e.at(o)}const r=Uu(e);return hQ(r,i)?r.get(i):e[i]}function p4(t,e,i){if(t==null)return t;const r=d4(e[i],t);return!r&&i<e.length-1?void 0:i===e.length-1?r:p4(r,e,i+1)}function t_(t,e,i=0){return typeof e!="string"||e.includes(".")?p4(t,BL(e),i):d4(e,t)}function lm(t,e){return t_(t,e)}function bD(t,e){return t_(e,t)!==void 0}const ao={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};let kf=!1;const Wx=[];function f4(t,e){let i=new gw(h),r=null,o=!1;function h(){if(!i||o)return;if(kf)return void g4(h);const a=r;i.clear(),kf=!0,o=!0,r=_c(i,t),o=!1,kf=!1,e(r,a),y4()}function d(){i&&(i.destroy(),i=null,r=null)}return o=!0,r=_c(i,t),o=!1,un(d)}function m4(t,e){let i=new gw(o),r=null;function o(){e(r,d)}function h(){i&&(i.destroy(),i=null),r=null}function d(){return i?(i.clear(),r=_c(i,t),r):null}return d(),un(h)}function xfe(t,e){let i=!1,r=!1;const o=!!e?.sync;let h=new gw(()=>{i||r||(r=!0,o?d():queueMicrotask(d))});function d(){r=!1,h&&!i&&(kf?g4(d):(h.clear(),kf=!0,i=!0,_c(h,t),i=!1,kf=!1,y4()))}function a(){h&&(h.destroy(),h=null)}return i=!0,_c(h,t),i=!1,un(a)}function g4(t){Wx.includes(t)||Wx.unshift(t)}function y4(){for(;Wx.length;)Wx.pop()()}var dd;let Z$=(dd=class{constructor(){this.uid=wb(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,i,r,o,h){return this.pool.acquire(0,e,i,r,o,h,U$)}static acquireTracked(e,i,r,o){return this.pool.acquire(1,e,i,r,null,null,o)}notify(e,i){this.type===0?this.callback.call(this.target,e,i,this.path,this.target):this.callback.call(null,e,i,void 0,void 0)}acquire(e,i,r,o,h,d,a){this.uid=wb(),this.removed=!1,this.type=e,this.oldValue=i,this.callback=r,this.getValue=o,this.target=h,this.path=d,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=wb(),this.removed=!0}},dd.pool=new zQ(()=>new dd),dd);const Sb=new _u,Ru=new Set;let Yx;function Xx(t){Ru.delete(t),Ru.add(t),qQ()}function qQ(){Yx||(Yx=u4(WQ))}function HQ(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function ZQ(t){for(const e of Ru.values())e.target===t&&(e.removed=!0)}function WQ(){let t=10;for(;Yx&&t--;){Yx=null;const e=YQ(),i=Sb.acquire();for(const r of e){const o=r.uid;HQ(r),o===r.uid&&r.removed&&i.push(r)}for(const r of Ru)r.removed&&(i.push(r),Ru.delete(r));for(const r of i)Z$.pool.release(r);Sb.release(i),Sb.release(e),XQ.forEach(r=>r())}}function YQ(){const t=Sb.acquire();t.length=Ru.size;let e=0;for(const i of Ru)t[e]=i,++e;return Ru.clear(),t}const XQ=new Set;function JQ(t,e,i){let r=jL(t,e,i,(o,h,d)=>{let a,_,T=m4(()=>t_(o,h),(E,k)=>{o.__accessor__?.lifecycle===ao.DESTROYED||a&&a.uid!==_?r.remove():(a||(a=Z$.acquireUntracked(E,d,k,o,h),_=a.uid),Xx(a))});return un(()=>{T.remove(),a&&(a.uid!==_||a.removed||(a.removed=!0,Xx(a)),a=null),r=T=null})});return r}function KQ(t,e,i){const r=jL(t,e,i,(o,h,d)=>{let a=!1;return f4(()=>t_(o,h),(_,T)=>{o.__accessor__.lifecycle!==ao.DESTROYED?a||(a=!0,U$(T,_)||d.call(o,_,T,h,o),a=!1):r.remove()})});return r}function QQ(t,e,i,r=!1){return t.__accessor__&&t.__accessor__.lifecycle!==ao.DESTROYED?r?KQ(t,e,i):JQ(t,e,i):un()}function eee(t,e,i){let r,o,h=m4(t,(d,a)=>{r&&r.uid!==o?h.remove():(r||(r=Z$.acquireTracked(d,e,a,i),o=r.uid),Xx(r))});return un(()=>{h.remove(),r&&(r.uid!==o||r.removed||(r.removed=!0,Xx(r)),r=null),h=null})}function tee(t,e,i){let r=!1;return f4(t,(o,h)=>{r||(r=!0,i(h,o)||e(o,h),r=!1)})}function iee(t,e,i=!1,r=eQ){return i?tee(t,e,r):eee(t,e,r)}function _l(t,e,i={}){return W$(t,e,i,v4)}function GC(t,e,i={}){return W$(t,e,i,b4)}function W$(t,e,i={},r){let o=null;const h=i.once?(d,a)=>{r(d)&&(e_(o),e(d,a))}:(d,a)=>{r(d)&&e(d,a)};if(o=iee(t,h,i.sync,i.equals),i.initial){const d=t();h(d,d)}return o}function _4(t,e,i,r={}){let o=null,h=null,d=null;function a(){o&&h&&(h.remove(),r.onListenerRemove?.(o),o=null,h=null)}function _(E){r.once&&r.once&&e_(d),i(E)}const T=_l(t,(E,k)=>{a(),H$(E)&&(o=E,h=QL(E,e,_),r.onListenerAdd?.(E))},{sync:r.sync,initial:!0});return d=un(()=>{T.remove(),a()}),d}function ree(t,e){return nee(t,b4,e)}function nee(t,e,i){if(Vu(i))return Promise.reject(As());const r=t();if(e?.(r))return Promise.resolve(r);let o=null;function h(){o=e_(o)}return new Promise((d,a)=>{o=G$([S0(i,()=>{h(),a(As())}),W$(t,_=>{h(),d(_)},{sync:!1,once:!0},e??v4)])})}function v4(t){return!0}function b4(t){return!!t}const see={sync:!0},xD={initial:!0},wfe={sync:!0,initial:!0};let vl=class{constructor(e,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=oee(e),this.apiValues=wD(this._apiToJSON),this.jsonValues=wD(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,o,h)=>{const d=this.toJSON(r);d!==void 0&&Cm(h,d,o)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const i=this._apiToJSON[e];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function oee(t){const e={};for(const i in t)e[t[i]]=i;return e}function wD(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}function yo(){return function(t,e){return new vl(t,{ignoreUnknown:!0,...e})}}let Zy;const aee=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,qC=globalThis.document?.documentElement;function x4(){const t=qC?.getAttribute("lang"),e=globalThis.navigator?.language;return aee??t??e??"en"}function cd(){return Zy===void 0&&(Zy=x4()),Zy}const lee=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function Y$(t=cd()){return S4(t)?.language}function w4(t=cd()){const e=S4(t);return e?.language&&e?.extlang?t.replace(`${e.language}-`,""):t}function S4(t=cd()){return lee.exec(t)?.groups}const Tb=[];function Tfe(t){return Tb.push(t),un(()=>{Tb.splice(Tb.indexOf(t),1)})}const Cb=[];function X$(t){return Cb.push(t),un(()=>Cb.splice(Cb.indexOf(t),1))}function SD(){const t=x4();Zy!==t&&([...Cb].forEach(e=>e(t)),Zy=t,[...Tb].forEach(e=>e(t)))}globalThis.addEventListener?.("languagechange",SD),qC&&new MutationObserver(()=>{SD()}).observe(qC,{attributeFilter:["lang"]});const cm="system",cee="unknown",J$="UTC",uee=Intl.DateTimeFormat().resolvedOptions().timeZone;class zd extends Error{}class hee extends zd{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class dee extends zd{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class pee extends zd{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class _f extends zd{}class T4 extends zd{constructor(e){super(`Invalid unit ${e}`)}}class Zn extends zd{}class iu extends zd{constructor(){super("Zone is an abstract class")}}const bt="numeric",Ia="short",ho="long",Jx={year:bt,month:bt,day:bt},C4={year:bt,month:Ia,day:bt},fee={year:bt,month:Ia,day:bt,weekday:Ia},E4={year:bt,month:ho,day:bt},I4={year:bt,month:ho,day:bt,weekday:ho},$4={hour:bt,minute:bt},P4={hour:bt,minute:bt,second:bt},M4={hour:bt,minute:bt,second:bt,timeZoneName:Ia},k4={hour:bt,minute:bt,second:bt,timeZoneName:ho},A4={hour:bt,minute:bt,hourCycle:"h23"},D4={hour:bt,minute:bt,second:bt,hourCycle:"h23"},z4={hour:bt,minute:bt,second:bt,hourCycle:"h23",timeZoneName:Ia},O4={hour:bt,minute:bt,second:bt,hourCycle:"h23",timeZoneName:ho},R4={year:bt,month:bt,day:bt,hour:bt,minute:bt},L4={year:bt,month:bt,day:bt,hour:bt,minute:bt,second:bt},F4={year:bt,month:Ia,day:bt,hour:bt,minute:bt},N4={year:bt,month:Ia,day:bt,hour:bt,minute:bt,second:bt},mee={year:bt,month:Ia,day:bt,weekday:Ia,hour:bt,minute:bt},B4={year:bt,month:ho,day:bt,hour:bt,minute:bt,timeZoneName:Ia},j4={year:bt,month:ho,day:bt,hour:bt,minute:bt,second:bt,timeZoneName:Ia},U4={year:bt,month:ho,day:bt,weekday:ho,hour:bt,minute:bt,timeZoneName:ho},V4={year:bt,month:ho,day:bt,weekday:ho,hour:bt,minute:bt,second:bt,timeZoneName:ho};class i_{get type(){throw new iu}get name(){throw new iu}get ianaName(){return this.name}get isUniversal(){throw new iu}offsetName(e,i){throw new iu}formatOffset(e,i){throw new iu}offset(e){throw new iu}equals(e){throw new iu}get isValid(){throw new iu}}let iT=null;class vw extends i_{static get instance(){return iT===null&&(iT=new vw),iT}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return e6(e,i,r)}formatOffset(e,i){return Wy(this.offset(e),i)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const HC=new Map;function gee(t){let e=HC.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),HC.set(t,e)),e}const yee={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function _ee(t,e){const i=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,o,h,d,a,_,T,E]=r;return[d,o,h,a,_,T,E]}function vee(t,e){const i=t.formatToParts(e),r=[];for(let o=0;o<i.length;o++){const{type:h,value:d}=i[o],a=yee[h];h==="era"?r[a]=d:qt(a)||(r[a]=parseInt(d,10))}return r}const rT=new Map;class $a extends i_{static create(e){let i=rT.get(e);return i===void 0&&rT.set(e,i=new $a(e)),i}static resetCache(){rT.clear(),HC.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=$a.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return e6(e,i,r,this.name)}formatOffset(e,i){return Wy(this.offset(e),i)}offset(e){if(!this.valid)return NaN;const i=new Date(e);if(isNaN(i))return NaN;const r=gee(this.name);let[o,h,d,a,_,T,E]=r.formatToParts?vee(r,i):_ee(r,i);a==="BC"&&(o=-Math.abs(o)+1);const L=xw({year:o,month:h,day:d,hour:_===24?0:_,minute:T,second:E,millisecond:0});let O=+i;const H=O%1e3;return O-=H>=0?H:1e3+H,(L-O)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let TD={};function bee(t,e={}){const i=JSON.stringify([t,e]);let r=TD[i];return r||(r=new Intl.ListFormat(t,e),TD[i]=r),r}const ZC=new Map;function WC(t,e={}){const i=JSON.stringify([t,e]);let r=ZC.get(i);return r===void 0&&(r=new Intl.DateTimeFormat(t,e),ZC.set(i,r)),r}const YC=new Map;function xee(t,e={}){const i=JSON.stringify([t,e]);let r=YC.get(i);return r===void 0&&(r=new Intl.NumberFormat(t,e),YC.set(i,r)),r}const XC=new Map;function wee(t,e={}){const{base:i,...r}=e,o=JSON.stringify([t,r]);let h=XC.get(o);return h===void 0&&(h=new Intl.RelativeTimeFormat(t,e),XC.set(o,h)),h}let _y=null;function See(){return _y||(_y=new Intl.DateTimeFormat().resolvedOptions().locale,_y)}const JC=new Map;function G4(t){let e=JC.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),JC.set(t,e)),e}const KC=new Map;function Tee(t){let e=KC.get(t);if(!e){const i=new Intl.Locale(t);e="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,"minimalDays"in e||(e={...q4,...e}),KC.set(t,e)}return e}function Cee(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const i=t.indexOf("-u-");if(i===-1)return[t];{let r,o;try{r=WC(t).resolvedOptions(),o=t}catch{const _=t.substring(0,i);r=WC(_).resolvedOptions(),o=_}const{numberingSystem:h,calendar:d}=r;return[o,h,d]}}function Eee(t,e,i){return(i||e)&&(t.includes("-u-")||(t+="-u"),i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`)),t}function Iee(t){const e=[];for(let i=1;i<=12;i++){const r=zt.utc(2009,i,1);e.push(t(r))}return e}function $ee(t){const e=[];for(let i=1;i<=7;i++){const r=zt.utc(2016,11,13+i);e.push(t(r))}return e}function jv(t,e,i,r){const o=t.listingMode();return o==="error"?null:o==="en"?i(e):r(e)}function Pee(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||G4(t.locale).numberingSystem==="latn"}class Mee{constructor(e,i,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:o,floor:h,...d}=r;if(!i||Object.keys(d).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=xee(e,a)}}format(e){if(this.inf){const i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{const i=this.floor?Math.floor(e):iP(e,3);return Kr(i,this.padTo)}}}class kee{constructor(e,i,r){this.opts=r,this.originalZone=void 0;let o;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const d=-1*(e.offset/60),a=d>=0?`Etc/GMT+${d}`:`Etc/GMT${d}`;e.offset!==0&&$a.create(a).valid?(o=a,this.dt=e):(o="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,o=e.zone.name):(o="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const h={...this.opts};h.timeZone=h.timeZone||o,this.dtf=WC(i,h)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(i=>{if(i.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:r}}else return i}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class Aee{constructor(e,i,r){this.opts={style:"long",...r},!i&&K4()&&(this.rtf=wee(e,r))}format(e,i){return this.rtf?this.rtf.format(e,i):ete(i,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,i){return this.rtf?this.rtf.formatToParts(e,i):[]}}const q4={firstDay:1,minimalDays:4,weekend:[6,7]};class ki{static fromOpts(e){return ki.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,i,r,o,h=!1){const d=e||Tr.defaultLocale,a=d||(h?"en-US":See()),_=i||Tr.defaultNumberingSystem,T=r||Tr.defaultOutputCalendar,E=eE(o)||Tr.defaultWeekSettings;return new ki(a,_,T,E,d)}static resetCache(){_y=null,ZC.clear(),YC.clear(),XC.clear(),JC.clear(),KC.clear()}static fromObject({locale:e,numberingSystem:i,outputCalendar:r,weekSettings:o}={}){return ki.create(e,i,r,o)}constructor(e,i,r,o,h){const[d,a,_]=Cee(e);this.locale=d,this.numberingSystem=i||a||null,this.outputCalendar=r||_||null,this.weekSettings=o,this.intl=Eee(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=h,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Pee(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:ki.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,eE(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,i=!1){return jv(this,e,r6,()=>{const r=this.intl==="ja"||this.intl.startsWith("ja-");i&=!r;const o=i?{month:e,day:"numeric"}:{month:e},h=i?"format":"standalone";if(!this.monthsCache[h][e]){const d=r?a=>this.dtFormatter(a,o).format():a=>this.extract(a,o,"month");this.monthsCache[h][e]=Iee(d)}return this.monthsCache[h][e]})}weekdays(e,i=!1){return jv(this,e,o6,()=>{const r=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},o=i?"format":"standalone";return this.weekdaysCache[o][e]||(this.weekdaysCache[o][e]=$ee(h=>this.extract(h,r,"weekday"))),this.weekdaysCache[o][e]})}meridiems(){return jv(this,void 0,()=>a6,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[zt.utc(2016,11,13,9),zt.utc(2016,11,13,19)].map(i=>this.extract(i,e,"dayperiod"))}return this.meridiemCache})}eras(e){return jv(this,e,l6,()=>{const i={era:e};return this.eraCache[e]||(this.eraCache[e]=[zt.utc(-40,1,1),zt.utc(2017,1,1)].map(r=>this.extract(r,i,"era"))),this.eraCache[e]})}extract(e,i,r){const o=this.dtFormatter(e,i),h=o.formatToParts(),d=h.find(a=>a.type.toLowerCase()===r);return d?d.value:null}numberFormatter(e={}){return new Mee(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,i={}){return new kee(e,this.intl,i)}relFormatter(e={}){return new Aee(this.intl,this.isEnglish(),e)}listFormatter(e={}){return bee(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||G4(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Q4()?Tee(this.locale):q4}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let nT=null;class ps extends i_{static get utcInstance(){return nT===null&&(nT=new ps(0)),nT}static instance(e){return e===0?ps.utcInstance:new ps(e)}static parseSpecifier(e){if(e){const i=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new ps(ww(i[1],i[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Wy(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Wy(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,i){return Wy(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class Dee extends i_{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Cu(t,e){if(qt(t)||t===null)return e;if(t instanceof i_)return t;if(Nee(t)){const i=t.toLowerCase();return i==="default"?e:i==="local"||i==="system"?vw.instance:i==="utc"||i==="gmt"?ps.utcInstance:ps.parseSpecifier(i)||$a.create(t)}else return Lu(t)?ps.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new Dee(t)}const K$={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},CD={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},zee=K$.hanidec.replace(/[\[|\]]/g,"").split("");function Oee(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);if(t[i].search(K$.hanidec)!==-1)e+=zee.indexOf(t[i]);else for(const o in CD){const[h,d]=CD[o];r>=h&&r<=d&&(e+=r-h)}}return parseInt(e,10)}else return e}const QC=new Map;function Ree(){QC.clear()}function ca({numberingSystem:t},e=""){const i=t||"latn";let r=QC.get(i);r===void 0&&(r=new Map,QC.set(i,r));let o=r.get(e);return o===void 0&&(o=new RegExp(`${K$[i]}${e}`),r.set(e,o)),o}let ED=()=>Date.now(),ID="system",$D=null,PD=null,MD=null,kD=60,AD,DD=null;class Tr{static get now(){return ED}static set now(e){ED=e}static set defaultZone(e){ID=e}static get defaultZone(){return Cu(ID,vw.instance)}static get defaultLocale(){return $D}static set defaultLocale(e){$D=e}static get defaultNumberingSystem(){return PD}static set defaultNumberingSystem(e){PD=e}static get defaultOutputCalendar(){return MD}static set defaultOutputCalendar(e){MD=e}static get defaultWeekSettings(){return DD}static set defaultWeekSettings(e){DD=eE(e)}static get twoDigitCutoffYear(){return kD}static set twoDigitCutoffYear(e){kD=e%100}static get throwOnInvalid(){return AD}static set throwOnInvalid(e){AD=e}static resetCaches(){ki.resetCache(),$a.resetCache(),zt.resetCache(),Ree()}}class ba{constructor(e,i){this.reason=e,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const H4=[0,31,59,90,120,151,181,212,243,273,304,334],Z4=[0,31,60,91,121,152,182,213,244,274,305,335];function Bo(t,e){return new ba("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function Q$(t,e,i){const r=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const o=r.getUTCDay();return o===0?7:o}function W4(t,e,i){return i+(r_(t)?Z4:H4)[e-1]}function Y4(t,e){const i=r_(t)?Z4:H4,r=i.findIndex(h=>h<e),o=e-i[r];return{month:r+1,day:o}}function eP(t,e){return(t-e+7)%7+1}function Kx(t,e=4,i=1){const{year:r,month:o,day:h}=t,d=W4(r,o,h),a=eP(Q$(r,o,h),i);let _=Math.floor((d-a+14-e)/7),T;return _<1?(T=r-1,_=T0(T,e,i)):_>T0(r,e,i)?(T=r+1,_=1):T=r,{weekYear:T,weekNumber:_,weekday:a,...Sw(t)}}function zD(t,e=4,i=1){const{weekYear:r,weekNumber:o,weekday:h}=t,d=eP(Q$(r,1,e),i),a=Af(r);let _=o*7+h-d-7+e,T;_<1?(T=r-1,_+=Af(T)):_>a?(T=r+1,_-=Af(r)):T=r;const{month:E,day:k}=Y4(T,_);return{year:T,month:E,day:k,...Sw(t)}}function sT(t){const{year:e,month:i,day:r}=t,o=W4(e,i,r);return{year:e,ordinal:o,...Sw(t)}}function OD(t){const{year:e,ordinal:i}=t,{month:r,day:o}=Y4(e,i);return{year:e,month:r,day:o,...Sw(t)}}function RD(t,e){if(!qt(t.localWeekday)||!qt(t.localWeekNumber)||!qt(t.localWeekYear)){if(!qt(t.weekday)||!qt(t.weekNumber)||!qt(t.weekYear))throw new _f("Cannot mix locale-based week fields with ISO-based week fields");return qt(t.localWeekday)||(t.weekday=t.localWeekday),qt(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),qt(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Lee(t,e=4,i=1){const r=bw(t.weekYear),o=jo(t.weekNumber,1,T0(t.weekYear,e,i)),h=jo(t.weekday,1,7);return r?o?h?!1:Bo("weekday",t.weekday):Bo("week",t.weekNumber):Bo("weekYear",t.weekYear)}function Fee(t){const e=bw(t.year),i=jo(t.ordinal,1,Af(t.year));return e?i?!1:Bo("ordinal",t.ordinal):Bo("year",t.year)}function X4(t){const e=bw(t.year),i=jo(t.month,1,12),r=jo(t.day,1,Qx(t.year,t.month));return e?i?r?!1:Bo("day",t.day):Bo("month",t.month):Bo("year",t.year)}function J4(t){const{hour:e,minute:i,second:r,millisecond:o}=t,h=jo(e,0,23)||e===24&&i===0&&r===0&&o===0,d=jo(i,0,59),a=jo(r,0,59),_=jo(o,0,999);return h?d?a?_?!1:Bo("millisecond",o):Bo("second",r):Bo("minute",i):Bo("hour",e)}function qt(t){return typeof t>"u"}function Lu(t){return typeof t=="number"}function bw(t){return typeof t=="number"&&t%1===0}function Nee(t){return typeof t=="string"}function Bee(t){return Object.prototype.toString.call(t)==="[object Date]"}function K4(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Q4(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function jee(t){return Array.isArray(t)?t:[t]}function LD(t,e,i){if(t.length!==0)return t.reduce((r,o)=>{const h=[e(o),o];return r&&i(r[0],h[0])===r[0]?r:h},null)[1]}function Uee(t,e){return e.reduce((i,r)=>(i[r]=t[r],i),{})}function um(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function eE(t){if(t==null)return null;if(typeof t!="object")throw new Zn("Week settings must be an object");if(!jo(t.firstDay,1,7)||!jo(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!jo(e,1,7)))throw new Zn("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function jo(t,e,i){return bw(t)&&t>=e&&t<=i}function Vee(t,e){return t-e*Math.floor(t/e)}function Kr(t,e=2){const i=t<0;let r;return i?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function vu(t){if(!(qt(t)||t===null||t===""))return parseInt(t,10)}function Oh(t){if(!(qt(t)||t===null||t===""))return parseFloat(t)}function tP(t){if(!(qt(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function iP(t,e,i="round"){const r=10**e;switch(i){case"expand":return t>0?Math.ceil(t*r)/r:Math.floor(t*r)/r;case"trunc":return Math.trunc(t*r)/r;case"round":return Math.round(t*r)/r;case"floor":return Math.floor(t*r)/r;case"ceil":return Math.ceil(t*r)/r;default:throw new RangeError(`Value rounding ${i} is out of range`)}}function r_(t){return t%4===0&&(t%100!==0||t%400===0)}function Af(t){return r_(t)?366:365}function Qx(t,e){const i=Vee(e-1,12)+1,r=t+(e-i)/12;return i===2?r_(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function xw(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function FD(t,e,i){return-eP(Q$(t,1,e),i)+e-1}function T0(t,e=4,i=1){const r=FD(t,e,i),o=FD(t+1,e,i);return(Af(t)-r+o)/7}function tE(t){return t>99?t:t>Tr.twoDigitCutoffYear?1900+t:2e3+t}function e6(t,e,i,r=null){const o=new Date(t),h={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(h.timeZone=r);const d={timeZoneName:e,...h},a=new Intl.DateTimeFormat(i,d).formatToParts(o).find(_=>_.type.toLowerCase()==="timezonename");return a?a.value:null}function ww(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const r=parseInt(e,10)||0,o=i<0||Object.is(i,-0)?-r:r;return i*60+o}function t6(t){const e=Number(t);if(typeof t=="boolean"||t===""||!Number.isFinite(e))throw new Zn(`Invalid unit value ${t}`);return e}function e1(t,e){const i={};for(const r in t)if(um(t,r)){const o=t[r];if(o==null)continue;i[e(r)]=t6(o)}return i}function Wy(t,e){const i=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),o=t>=0?"+":"-";switch(e){case"short":return`${o}${Kr(i,2)}:${Kr(r,2)}`;case"narrow":return`${o}${i}${r>0?`:${r}`:""}`;case"techie":return`${o}${Kr(i,2)}${Kr(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Sw(t){return Uee(t,["hour","minute","second","millisecond"])}const Gee=["January","February","March","April","May","June","July","August","September","October","November","December"],i6=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],qee=["J","F","M","A","M","J","J","A","S","O","N","D"];function r6(t){switch(t){case"narrow":return[...qee];case"short":return[...i6];case"long":return[...Gee];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const n6=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],s6=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Hee=["M","T","W","T","F","S","S"];function o6(t){switch(t){case"narrow":return[...Hee];case"short":return[...s6];case"long":return[...n6];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const a6=["AM","PM"],Zee=["Before Christ","Anno Domini"],Wee=["BC","AD"],Yee=["B","A"];function l6(t){switch(t){case"narrow":return[...Yee];case"short":return[...Wee];case"long":return[...Zee];default:return null}}function Xee(t){return a6[t.hour<12?0:1]}function Jee(t,e){return o6(e)[t.weekday-1]}function Kee(t,e){return r6(e)[t.month-1]}function Qee(t,e){return l6(e)[t.year<0?0:1]}function ete(t,e,i="always",r=!1){const o={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},h=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&h){const k=t==="days";switch(e){case 1:return k?"tomorrow":`next ${o[t][0]}`;case-1:return k?"yesterday":`last ${o[t][0]}`;case 0:return k?"today":`this ${o[t][0]}`}}const d=Object.is(e,-0)||e<0,a=Math.abs(e),_=a===1,T=o[t],E=r?_?T[1]:T[2]||T[1]:_?o[t][0]:t;return d?`${a} ${E} ago`:`in ${a} ${E}`}function ND(t,e){let i="";for(const r of t)r.literal?i+=r.val:i+=e(r.val);return i}const tte={D:Jx,DD:C4,DDD:E4,DDDD:I4,t:$4,tt:P4,ttt:M4,tttt:k4,T:A4,TT:D4,TTT:z4,TTTT:O4,f:R4,ff:F4,fff:B4,ffff:U4,F:L4,FF:N4,FFF:j4,FFFF:V4};class Xn{static create(e,i={}){return new Xn(e,i)}static parseFormat(e){let i=null,r="",o=!1;const h=[];for(let d=0;d<e.length;d++){const a=e.charAt(d);a==="'"?((r.length>0||o)&&h.push({literal:o||/^\s+$/.test(r),val:r===""?"'":r}),i=null,r="",o=!o):o||a===i?r+=a:(r.length>0&&h.push({literal:/^\s+$/.test(r),val:r}),r=a,i=a)}return r.length>0&&h.push({literal:o||/^\s+$/.test(r),val:r}),h}static macroTokenToFormatOpts(e){return tte[e]}constructor(e,i){this.opts=i,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...i}).format()}dtFormatter(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i})}formatDateTime(e,i){return this.dtFormatter(e,i).format()}formatDateTimeParts(e,i){return this.dtFormatter(e,i).formatToParts()}formatInterval(e,i){return this.dtFormatter(e.start,i).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,i){return this.dtFormatter(e,i).resolvedOptions()}num(e,i=0,r=void 0){if(this.opts.forceSimple)return Kr(e,i);const o={...this.opts};return i>0&&(o.padTo=i),r&&(o.signDisplay=r),this.loc.numberFormatter(o).format(e)}formatDateTimeFromString(e,i){const r=this.loc.listingMode()==="en",o=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",h=(O,H)=>this.loc.extract(e,O,H),d=O=>e.isOffsetFixed&&e.offset===0&&O.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,O.format):"",a=()=>r?Xee(e):h({hour:"numeric",hourCycle:"h12"},"dayperiod"),_=(O,H)=>r?Kee(e,O):h(H?{month:O}:{month:O,day:"numeric"},"month"),T=(O,H)=>r?Jee(e,O):h(H?{weekday:O}:{weekday:O,month:"long",day:"numeric"},"weekday"),E=O=>{const H=Xn.macroTokenToFormatOpts(O);return H?this.formatWithSystemDefault(e,H):O},k=O=>r?Qee(e,O):h({era:O},"era"),L=O=>{switch(O){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return d({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return d({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return d({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return o?h({day:"numeric"},"day"):this.num(e.day);case"dd":return o?h({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return T("short",!0);case"cccc":return T("long",!0);case"ccccc":return T("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return T("short",!1);case"EEEE":return T("long",!1);case"EEEEE":return T("narrow",!1);case"L":return o?h({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return o?h({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return _("short",!0);case"LLLL":return _("long",!0);case"LLLLL":return _("narrow",!0);case"M":return o?h({month:"numeric"},"month"):this.num(e.month);case"MM":return o?h({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return _("short",!1);case"MMMM":return _("long",!1);case"MMMMM":return _("narrow",!1);case"y":return o?h({year:"numeric"},"year"):this.num(e.year);case"yy":return o?h({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return o?h({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return o?h({year:"numeric"},"year"):this.num(e.year,6);case"G":return k("short");case"GG":return k("long");case"GGGGG":return k("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return E(O)}};return ND(Xn.parseFormat(i),L)}formatDurationFromString(e,i){const r=this.opts.signMode==="negativeLargestOnly"?-1:1,o=E=>{switch(E[0]){case"S":return"milliseconds";case"s":return"seconds";case"m":return"minutes";case"h":return"hours";case"d":return"days";case"w":return"weeks";case"M":return"months";case"y":return"years";default:return null}},h=(E,k)=>L=>{const O=o(L);if(O){const H=k.isNegativeDuration&&O!==k.largestUnit?r:1;let re;return this.opts.signMode==="negativeLargestOnly"&&O!==k.largestUnit?re="never":this.opts.signMode==="all"?re="always":re="auto",this.num(E.get(O)*H,L.length,re)}else return L},d=Xn.parseFormat(i),a=d.reduce((E,{literal:k,val:L})=>k?E:E.concat(L),[]),_=e.shiftTo(...a.map(o).filter(E=>E)),T={isNegativeDuration:_<0,largestUnit:Object.keys(_.values)[0]};return ND(d,h(_,T))}}const c6=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Em(...t){const e=t.reduce((i,r)=>i+r.source,"");return RegExp(`^${e}$`)}function Im(...t){return e=>t.reduce(([i,r,o],h)=>{const[d,a,_]=h(e,o);return[{...i,...d},a||r,_]},[{},null,1]).slice(0,2)}function $m(t,...e){if(t==null)return[null,null];for(const[i,r]of e){const o=i.exec(t);if(o)return r(o)}return[null,null]}function u6(...t){return(e,i)=>{const r={};let o;for(o=0;o<t.length;o++)r[t[o]]=vu(e[i+o]);return[r,null,i+o]}}const h6=/(?:([Zz])|([+-]\d\d)(?::?(\d\d))?)/,ite=`(?:${h6.source}?(?:\\[(${c6.source})\\])?)?`,rP=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,d6=RegExp(`${rP.source}${ite}`),nP=RegExp(`(?:[Tt]${d6.source})?`),rte=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,nte=/(\d{4})-?W(\d\d)(?:-?(\d))?/,ste=/(\d{4})-?(\d{3})/,ote=u6("weekYear","weekNumber","weekDay"),ate=u6("year","ordinal"),lte=/(\d{4})-(\d\d)-(\d\d)/,p6=RegExp(`${rP.source} ?(?:${h6.source}|(${c6.source}))?`),cte=RegExp(`(?: ${p6.source})?`);function Df(t,e,i){const r=t[e];return qt(r)?i:vu(r)}function ute(t,e){return[{year:Df(t,e),month:Df(t,e+1,1),day:Df(t,e+2,1)},null,e+3]}function Pm(t,e){return[{hours:Df(t,e,0),minutes:Df(t,e+1,0),seconds:Df(t,e+2,0),milliseconds:tP(t[e+3])},null,e+4]}function n_(t,e){const i=!t[e]&&!t[e+1],r=ww(t[e+1],t[e+2]),o=i?null:ps.instance(r);return[{},o,e+3]}function s_(t,e){const i=t[e]?$a.create(t[e]):null;return[{},i,e+1]}const hte=RegExp(`^T?${rP.source}$`),dte=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function pte(t){const[e,i,r,o,h,d,a,_,T]=t,E=e[0]==="-",k=_&&_[0]==="-",L=(O,H=!1)=>O!==void 0&&(H||O&&E)?-O:O;return[{years:L(Oh(i)),months:L(Oh(r)),weeks:L(Oh(o)),days:L(Oh(h)),hours:L(Oh(d)),minutes:L(Oh(a)),seconds:L(Oh(_),_==="-0"),milliseconds:L(tP(T),k)}]}const fte={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function sP(t,e,i,r,o,h,d){const a={year:e.length===2?tE(vu(e)):vu(e),month:i6.indexOf(i)+1,day:vu(r),hour:vu(o),minute:vu(h)};return d&&(a.second=vu(d)),t&&(a.weekday=t.length>3?n6.indexOf(t)+1:s6.indexOf(t)+1),a}const mte=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function gte(t){const[,e,i,r,o,h,d,a,_,T,E,k]=t,L=sP(e,o,r,i,h,d,a);let O;return _?O=fte[_]:T?O=0:O=ww(E,k),[L,new ps(O)]}function yte(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const _te=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,vte=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,bte=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function BD(t){const[,e,i,r,o,h,d,a]=t;return[sP(e,o,r,i,h,d,a),ps.utcInstance]}function xte(t){const[,e,i,r,o,h,d,a]=t;return[sP(e,a,i,r,o,h,d),ps.utcInstance]}const wte=Em(rte,nP),Ste=Em(nte,nP),Tte=Em(ste,nP),Cte=Em(d6),f6=Im(ute,Pm,n_,s_),Ete=Im(ote,Pm,n_,s_),Ite=Im(ate,Pm,n_,s_),$te=Im(Pm,n_,s_);function Pte(t){return $m(t,[wte,f6],[Ste,Ete],[Tte,Ite],[Cte,$te])}function Mte(t){return $m(yte(t),[mte,gte])}function kte(t){return $m(t,[_te,BD],[vte,BD],[bte,xte])}function Ate(t){return $m(t,[dte,pte])}const Dte=Im(Pm);function zte(t){return $m(t,[hte,Dte])}const Ote=Em(lte,cte),Rte=Em(p6),Lte=Im(Pm,n_,s_);function Fte(t){return $m(t,[Ote,f6],[Rte,Lte])}const jD="Invalid Duration",m6={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},Nte={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...m6},$o=146097/400,Gp=146097/4800,Bte={years:{quarters:4,months:12,weeks:$o/7,days:$o,hours:$o*24,minutes:$o*24*60,seconds:$o*24*60*60,milliseconds:$o*24*60*60*1e3},quarters:{months:3,weeks:$o/28,days:$o/4,hours:$o*24/4,minutes:$o*24*60/4,seconds:$o*24*60*60/4,milliseconds:$o*24*60*60*1e3/4},months:{weeks:Gp/7,days:Gp,hours:Gp*24,minutes:Gp*24*60,seconds:Gp*24*60*60,milliseconds:Gp*24*60*60*1e3},...m6},td=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],jte=td.slice(0).reverse();function Jl(t,e,i=!1){const r={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new xi(r)}function g6(t,e){let i=e.milliseconds??0;for(const r of jte.slice(1))e[r]&&(i+=e[r]*t[r].milliseconds);return i}function UD(t,e){const i=g6(t,e)<0?-1:1;td.reduceRight((r,o)=>{if(qt(e[o]))return r;if(r){const h=e[r]*i,d=t[o][r],a=Math.floor(h/d);e[o]+=a*i,e[r]-=a*d*i}return o},null),td.reduce((r,o)=>{if(qt(e[o]))return r;if(r){const h=e[r]%1;e[r]-=h,e[o]+=h*t[r][o]}return o},null)}function VD(t){const e={};for(const[i,r]of Object.entries(t))r!==0&&(e[i]=r);return e}class xi{constructor(e){const i=e.conversionAccuracy==="longterm"||!1;let r=i?Bte:Nte;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||ki.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,i){return xi.fromObject({milliseconds:e},i)}static fromObject(e,i={}){if(e==null||typeof e!="object")throw new Zn(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new xi({values:e1(e,xi.normalizeUnit),loc:ki.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(e){if(Lu(e))return xi.fromMillis(e);if(xi.isDuration(e))return e;if(typeof e=="object")return xi.fromObject(e);throw new Zn(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,i){const[r]=Ate(e);return r?xi.fromObject(r,i):xi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,i){const[r]=zte(e);return r?xi.fromObject(r,i):xi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,i=null){if(!e)throw new Zn("need to specify a reason the Duration is invalid");const r=e instanceof ba?e:new ba(e,i);if(Tr.throwOnInvalid)throw new pee(r);return new xi({invalid:r})}static normalizeUnit(e){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!i)throw new T4(e);return i}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,i={}){const r={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?Xn.create(this.loc,r).formatDurationFromString(this,e):jD}toHuman(e={}){if(!this.isValid)return jD;const i=e.showZeros!==!1,r=td.map(o=>{const h=this.values[o];return qt(h)||h===0&&!i?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:o.slice(0,-1)}).format(h)}).filter(o=>o);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=iP(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},zt.fromMillis(i,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?g6(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const i=xi.fromDurationLike(e),r={};for(const o of td)(um(i.values,o)||um(this.values,o))&&(r[o]=i.get(o)+this.get(o));return Jl(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const i=xi.fromDurationLike(e);return this.plus(i.negate())}mapUnits(e){if(!this.isValid)return this;const i={};for(const r of Object.keys(this.values))i[r]=t6(e(this.values[r],r));return Jl(this,{values:i},!0)}get(e){return this[xi.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const i={...this.values,...e1(e,xi.normalizeUnit)};return Jl(this,{values:i})}reconfigure({locale:e,numberingSystem:i,conversionAccuracy:r,matrix:o}={}){const d={loc:this.loc.clone({locale:e,numberingSystem:i}),matrix:o,conversionAccuracy:r};return Jl(this,d)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return UD(this.matrix,e),Jl(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=VD(this.normalize().shiftToAll().toObject());return Jl(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(d=>xi.normalizeUnit(d));const i={},r={},o=this.toObject();let h;for(const d of td)if(e.indexOf(d)>=0){h=d;let a=0;for(const T in r)a+=this.matrix[T][d]*r[T],r[T]=0;Lu(o[d])&&(a+=o[d]);const _=Math.trunc(a);i[d]=_,r[d]=(a*1e3-_*1e3)/1e3}else Lu(o[d])&&(r[d]=o[d]);for(const d in r)r[d]!==0&&(i[h]+=d===h?r[d]:r[d]/this.matrix[h][d]);return UD(this.matrix,i),Jl(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=this.values[i]===0?0:-this.values[i];return Jl(this,{values:e},!0)}removeZeros(){if(!this.isValid)return this;const e=VD(this.values);return Jl(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function i(r,o){return r===void 0||r===0?o===void 0||o===0:r===o}for(const r of td)if(!i(this.values[r],e.values[r]))return!1;return!0}}const qp="Invalid Interval";function Ute(t,e){return!t||!t.isValid?Sr.invalid("missing or invalid start"):!e||!e.isValid?Sr.invalid("missing or invalid end"):e<t?Sr.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Sr{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,i=null){if(!e)throw new Zn("need to specify a reason the Interval is invalid");const r=e instanceof ba?e:new ba(e,i);if(Tr.throwOnInvalid)throw new dee(r);return new Sr({invalid:r})}static fromDateTimes(e,i){const r=Jg(e),o=Jg(i),h=Ute(r,o);return h??new Sr({start:r,end:o})}static after(e,i){const r=xi.fromDurationLike(i),o=Jg(e);return Sr.fromDateTimes(o,o.plus(r))}static before(e,i){const r=xi.fromDurationLike(i),o=Jg(e);return Sr.fromDateTimes(o.minus(r),o)}static fromISO(e,i){const[r,o]=(e||"").split("/",2);if(r&&o){let h,d;try{h=zt.fromISO(r,i),d=h.isValid}catch{d=!1}let a,_;try{a=zt.fromISO(o,i),_=a.isValid}catch{_=!1}if(d&&_)return Sr.fromDateTimes(h,a);if(d){const T=xi.fromISO(o,i);if(T.isValid)return Sr.after(h,T)}else if(_){const T=xi.fromISO(r,i);if(T.isValid)return Sr.before(a,T)}}return Sr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",i){if(!this.isValid)return NaN;const r=this.start.startOf(e,i);let o;return i?.useLocaleWeeks?o=this.end.reconfigure({locale:r.locale}):o=this.end,o=o.startOf(e,i),Math.floor(o.diff(r,e).get(e))+(o.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:i}={}){return this.isValid?Sr.fromDateTimes(e||this.s,i||this.e):this}splitAt(...e){if(!this.isValid)return[];const i=e.map(Jg).filter(d=>this.contains(d)).sort((d,a)=>d.toMillis()-a.toMillis()),r=[];let{s:o}=this,h=0;for(;o<this.e;){const d=i[h]||this.e,a=+d>+this.e?this.e:d;r.push(Sr.fromDateTimes(o,a)),o=a,h+=1}return r}splitBy(e){const i=xi.fromDurationLike(e);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:r}=this,o=1,h;const d=[];for(;r<this.e;){const a=this.start.plus(i.mapUnits(_=>_*o));h=+a>+this.e?this.e:a,d.push(Sr.fromDateTimes(r,h)),r=h,o+=1}return d}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const i=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return i>=r?null:Sr.fromDateTimes(i,r)}union(e){if(!this.isValid)return this;const i=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return Sr.fromDateTimes(i,r)}static merge(e){const[i,r]=e.sort((o,h)=>o.s-h.s).reduce(([o,h],d)=>h?h.overlaps(d)||h.abutsStart(d)?[o,h.union(d)]:[o.concat([h]),d]:[o,d],[[],null]);return r&&i.push(r),i}static xor(e){let i=null,r=0;const o=[],h=e.map(_=>[{time:_.s,type:"s"},{time:_.e,type:"e"}]),d=Array.prototype.concat(...h),a=d.sort((_,T)=>_.time-T.time);for(const _ of a)r+=_.type==="s"?1:-1,r===1?i=_.time:(i&&+i!=+_.time&&o.push(Sr.fromDateTimes(i,_.time)),i=null);return Sr.merge(o)}difference(...e){return Sr.xor([this].concat(e)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:qp}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=Jx,i={}){return this.isValid?Xn.create(this.s.loc.clone(i),e).formatInterval(this):qp}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:qp}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:qp}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:qp}toFormat(e,{separator:i="  "}={}){return this.isValid?`${this.s.toFormat(e)}${i}${this.e.toFormat(e)}`:qp}toDuration(e,i){return this.isValid?this.e.diff(this.s,e,i):xi.invalid(this.invalidReason)}mapEndpoints(e){return Sr.fromDateTimes(e(this.s),e(this.e))}}class Uv{static hasDST(e=Tr.defaultZone){const i=zt.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(e){return $a.isValidZone(e)}static normalizeZone(e){return Cu(e,Tr.defaultZone)}static getStartOfWeek({locale:e=null,locObj:i=null}={}){return(i||ki.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:i=null}={}){return(i||ki.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:i=null}={}){return(i||ki.create(e)).getWeekendDays().slice()}static months(e="long",{locale:i=null,numberingSystem:r=null,locObj:o=null,outputCalendar:h="gregory"}={}){return(o||ki.create(i,r,h)).months(e)}static monthsFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:o=null,outputCalendar:h="gregory"}={}){return(o||ki.create(i,r,h)).months(e,!0)}static weekdays(e="long",{locale:i=null,numberingSystem:r=null,locObj:o=null}={}){return(o||ki.create(i,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:o=null}={}){return(o||ki.create(i,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return ki.create(e).meridiems()}static eras(e="short",{locale:i=null}={}){return ki.create(i,null,"gregory").eras(e)}static features(){return{relative:K4(),localeWeek:Q4()}}}function GD(t,e){const i=o=>o.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=i(e)-i(t);return Math.floor(xi.fromMillis(r).as("days"))}function Vte(t,e,i){const r=[["years",(_,T)=>T.year-_.year],["quarters",(_,T)=>T.quarter-_.quarter+(T.year-_.year)*4],["months",(_,T)=>T.month-_.month+(T.year-_.year)*12],["weeks",(_,T)=>{const E=GD(_,T);return(E-E%7)/7}],["days",GD]],o={},h=t;let d,a;for(const[_,T]of r)i.indexOf(_)>=0&&(d=_,o[_]=T(t,e),a=h.plus(o),a>e?(o[_]--,t=h.plus(o),t>e&&(a=t,o[_]--,t=h.plus(o))):t=a);return[t,o,a,d]}function Gte(t,e,i,r){let[o,h,d,a]=Vte(t,e,i);const _=e-o,T=i.filter(k=>["hours","minutes","seconds","milliseconds"].indexOf(k)>=0);T.length===0&&(d<e&&(d=o.plus({[a]:1})),d!==o&&(h[a]=(h[a]||0)+_/(d-o)));const E=xi.fromObject(h,r);return T.length>0?xi.fromMillis(_,r).shiftTo(...T).plus(E):E}const qte="missing Intl.DateTimeFormat.formatToParts support";function Ei(t,e=i=>i){return{regex:t,deser:([i])=>e(Oee(i))}}const Hte="",y6=`[ ${Hte}]`,_6=new RegExp(y6,"g");function Zte(t){return t.replace(/\./g,"\\.?").replace(_6,y6)}function qD(t){return t.replace(/\./g,"").replace(_6," ").toLowerCase()}function ua(t,e){return t===null?null:{regex:RegExp(t.map(Zte).join("|")),deser:([i])=>t.findIndex(r=>qD(i)===qD(r))+e}}function HD(t,e){return{regex:t,deser:([,i,r])=>ww(i,r),groups:e}}function Vv(t){return{regex:t,deser:([e])=>e}}function Wte(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Yte(t,e){const i=ca(e),r=ca(e,"{2}"),o=ca(e,"{3}"),h=ca(e,"{4}"),d=ca(e,"{6}"),a=ca(e,"{1,2}"),_=ca(e,"{1,3}"),T=ca(e,"{1,6}"),E=ca(e,"{1,9}"),k=ca(e,"{2,4}"),L=ca(e,"{4,6}"),O=pe=>({regex:RegExp(Wte(pe.val)),deser:([ge])=>ge,literal:!0}),re=(pe=>{if(t.literal)return O(pe);switch(pe.val){case"G":return ua(e.eras("short"),0);case"GG":return ua(e.eras("long"),0);case"y":return Ei(T);case"yy":return Ei(k,tE);case"yyyy":return Ei(h);case"yyyyy":return Ei(L);case"yyyyyy":return Ei(d);case"M":return Ei(a);case"MM":return Ei(r);case"MMM":return ua(e.months("short",!0),1);case"MMMM":return ua(e.months("long",!0),1);case"L":return Ei(a);case"LL":return Ei(r);case"LLL":return ua(e.months("short",!1),1);case"LLLL":return ua(e.months("long",!1),1);case"d":return Ei(a);case"dd":return Ei(r);case"o":return Ei(_);case"ooo":return Ei(o);case"HH":return Ei(r);case"H":return Ei(a);case"hh":return Ei(r);case"h":return Ei(a);case"mm":return Ei(r);case"m":return Ei(a);case"q":return Ei(a);case"qq":return Ei(r);case"s":return Ei(a);case"ss":return Ei(r);case"S":return Ei(_);case"SSS":return Ei(o);case"u":return Vv(E);case"uu":return Vv(a);case"uuu":return Ei(i);case"a":return ua(e.meridiems(),0);case"kkkk":return Ei(h);case"kk":return Ei(k,tE);case"W":return Ei(a);case"WW":return Ei(r);case"E":case"c":return Ei(i);case"EEE":return ua(e.weekdays("short",!1),1);case"EEEE":return ua(e.weekdays("long",!1),1);case"ccc":return ua(e.weekdays("short",!0),1);case"cccc":return ua(e.weekdays("long",!0),1);case"Z":case"ZZ":return HD(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return HD(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return Vv(/[a-z_+-/]{1,256}?/i);case" ":return Vv(/[^\S\n\r]/);default:return O(pe)}})(t)||{invalidReason:qte};return re.token=t,re}const Xte={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function Jte(t,e,i){const{type:r,value:o}=t;if(r==="literal"){const _=/^\s+$/.test(o);return{literal:!_,val:_?" ":o}}const h=e[r];let d=r;r==="hour"&&(e.hour12!=null?d=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?d="hour12":d="hour24":d=i.hour12?"hour12":"hour24");let a=Xte[d];if(typeof a=="object"&&(a=a[h]),a)return{literal:!1,val:a}}function Kte(t){return[`^${t.map(i=>i.regex).reduce((i,r)=>`${i}(${r.source})`,"")}$`,t]}function Qte(t,e,i){const r=t.match(e);if(r){const o={};let h=1;for(const d in i)if(um(i,d)){const a=i[d],_=a.groups?a.groups+1:1;!a.literal&&a.token&&(o[a.token.val[0]]=a.deser(r.slice(h,h+_))),h+=_}return[r,o]}else return[r,{}]}function eie(t){const e=h=>{switch(h){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,r;return qt(t.z)||(i=$a.create(t.z)),qt(t.Z)||(i||(i=new ps(t.Z)),r=t.Z),qt(t.q)||(t.M=(t.q-1)*3+1),qt(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),qt(t.u)||(t.S=tP(t.u)),[Object.keys(t).reduce((h,d)=>{const a=e(d);return a&&(h[a]=t[d]),h},{}),i,r]}let oT=null;function tie(){return oT||(oT=zt.fromMillis(1555555555555)),oT}function iie(t,e){if(t.literal)return t;const i=Xn.macroTokenToFormatOpts(t.val),r=w6(i,e);return r==null||r.includes(void 0)?t:r}function v6(t,e){return Array.prototype.concat(...t.map(i=>iie(i,e)))}class b6{constructor(e,i){if(this.locale=e,this.format=i,this.tokens=v6(Xn.parseFormat(i),e),this.units=this.tokens.map(r=>Yte(r,e)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){const[r,o]=Kte(this.units);this.regex=RegExp(r,"i"),this.handlers=o}}explainFromTokens(e){if(this.isValid){const[i,r]=Qte(e,this.regex,this.handlers),[o,h,d]=r?eie(r):[null,null,void 0];if(um(r,"a")&&um(r,"H"))throw new _f("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:i,matches:r,result:o,zone:h,specificOffset:d}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function x6(t,e,i){return new b6(t,i).explainFromTokens(e)}function rie(t,e,i){const{result:r,zone:o,specificOffset:h,invalidReason:d}=x6(t,e,i);return[r,o,h,d]}function w6(t,e){if(!t)return null;const r=Xn.create(e,t).dtFormatter(tie()),o=r.formatToParts(),h=r.resolvedOptions();return o.map(d=>Jte(d,t,h))}const aT="Invalid DateTime",ZD=864e13;function vy(t){return new ba("unsupported zone",`the zone "${t.name}" is not supported`)}function lT(t){return t.weekData===null&&(t.weekData=Kx(t.c)),t.weekData}function cT(t){return t.localWeekData===null&&(t.localWeekData=Kx(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function Rh(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new zt({...i,...e,old:i})}function S6(t,e,i){let r=t-e*60*1e3;const o=i.offset(r);if(e===o)return[r,e];r-=(o-e)*60*1e3;const h=i.offset(r);return o===h?[r,o]:[t-Math.min(o,h)*60*1e3,Math.max(o,h)]}function Gv(t,e){t+=e*60*1e3;const i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function Eb(t,e,i){return S6(xw(t),e,i)}function WD(t,e){const i=t.o,r=t.c.year+Math.trunc(e.years),o=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,h={...t.c,year:r,month:o,day:Math.min(t.c.day,Qx(r,o))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},d=xi.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=xw(h);let[_,T]=S6(a,i,t.zone);return d!==0&&(_+=d,T=t.zone.offset(_)),{ts:_,o:T}}function Hp(t,e,i,r,o,h){const{setZone:d,zone:a}=i;if(t&&Object.keys(t).length!==0||e){const _=e||a,T=zt.fromObject(t,{...i,zone:_,specificOffset:h});return d?T:T.setZone(a)}else return zt.invalid(new ba("unparsable",`the input "${o}" can't be parsed as ${r}`))}function qv(t,e,i=!0){return t.isValid?Xn.create(ki.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function uT(t,e,i){const r=t.c.year>9999||t.c.year<0;let o="";if(r&&t.c.year>=0&&(o+="+"),o+=Kr(t.c.year,r?6:4),i==="year")return o;if(e){if(o+="-",o+=Kr(t.c.month),i==="month")return o;o+="-"}else if(o+=Kr(t.c.month),i==="month")return o;return o+=Kr(t.c.day),o}function YD(t,e,i,r,o,h,d){let a=!i||t.c.millisecond!==0||t.c.second!==0,_="";switch(d){case"day":case"month":case"year":break;default:if(_+=Kr(t.c.hour),d==="hour")break;if(e){if(_+=":",_+=Kr(t.c.minute),d==="minute")break;a&&(_+=":",_+=Kr(t.c.second))}else{if(_+=Kr(t.c.minute),d==="minute")break;a&&(_+=Kr(t.c.second))}if(d==="second")break;a&&(!r||t.c.millisecond!==0)&&(_+=".",_+=Kr(t.c.millisecond,3))}return o&&(t.isOffsetFixed&&t.offset===0&&!h?_+="Z":t.o<0?(_+="-",_+=Kr(Math.trunc(-t.o/60)),_+=":",_+=Kr(Math.trunc(-t.o%60))):(_+="+",_+=Kr(Math.trunc(t.o/60)),_+=":",_+=Kr(Math.trunc(t.o%60)))),h&&(_+="["+t.zone.ianaName+"]"),_}const T6={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},nie={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},sie={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Ib=["year","month","day","hour","minute","second","millisecond"],oie=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],aie=["year","ordinal","hour","minute","second","millisecond"];function $b(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new T4(t);return e}function XD(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return $b(t)}}function lie(t){if(by===void 0&&(by=Tr.now()),t.type!=="iana")return t.offset(by);const e=t.name;let i=iE.get(e);return i===void 0&&(i=t.offset(by),iE.set(e,i)),i}function JD(t,e){const i=Cu(e.zone,Tr.defaultZone);if(!i.isValid)return zt.invalid(vy(i));const r=ki.fromObject(e);let o,h;if(qt(t.year))o=Tr.now();else{for(const _ of Ib)qt(t[_])&&(t[_]=T6[_]);const d=X4(t)||J4(t);if(d)return zt.invalid(d);const a=lie(i);[o,h]=Eb(t,a,i)}return new zt({ts:o,zone:i,loc:r,o:h})}function KD(t,e,i){const r=qt(i.round)?!0:i.round,o=qt(i.rounding)?"trunc":i.rounding,h=(a,_)=>(a=iP(a,r||i.calendary?0:2,i.calendary?"round":o),e.loc.clone(i).relFormatter(i).format(a,_)),d=a=>i.calendary?e.hasSame(t,a)?0:e.startOf(a).diff(t.startOf(a),a).get(a):e.diff(t,a).get(a);if(i.unit)return h(d(i.unit),i.unit);for(const a of i.units){const _=d(a);if(Math.abs(_)>=1)return h(_,a)}return h(t>e?-0:0,i.units[i.units.length-1])}function QD(t){let e={},i;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],i=Array.from(t).slice(0,t.length-1)):i=Array.from(t),[e,i]}let by;const iE=new Map;class zt{constructor(e){const i=e.zone||Tr.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new ba("invalid input"):null)||(i.isValid?null:vy(i));this.ts=qt(e.ts)?Tr.now():e.ts;let o=null,h=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(i))[o,h]=[e.old.c,e.old.o];else{const a=Lu(e.o)&&!e.old?e.o:i.offset(this.ts);o=Gv(this.ts,a),r=Number.isNaN(o.year)?new ba("invalid input"):null,o=r?null:o,h=r?null:a}this._zone=i,this.loc=e.loc||ki.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=o,this.o=h,this.isLuxonDateTime=!0}static now(){return new zt({})}static local(){const[e,i]=QD(arguments),[r,o,h,d,a,_,T]=i;return JD({year:r,month:o,day:h,hour:d,minute:a,second:_,millisecond:T},e)}static utc(){const[e,i]=QD(arguments),[r,o,h,d,a,_,T]=i;return e.zone=ps.utcInstance,JD({year:r,month:o,day:h,hour:d,minute:a,second:_,millisecond:T},e)}static fromJSDate(e,i={}){const r=Bee(e)?e.valueOf():NaN;if(Number.isNaN(r))return zt.invalid("invalid input");const o=Cu(i.zone,Tr.defaultZone);return o.isValid?new zt({ts:r,zone:o,loc:ki.fromObject(i)}):zt.invalid(vy(o))}static fromMillis(e,i={}){if(Lu(e))return e<-ZD||e>ZD?zt.invalid("Timestamp out of range"):new zt({ts:e,zone:Cu(i.zone,Tr.defaultZone),loc:ki.fromObject(i)});throw new Zn(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,i={}){if(Lu(e))return new zt({ts:e*1e3,zone:Cu(i.zone,Tr.defaultZone),loc:ki.fromObject(i)});throw new Zn("fromSeconds requires a numerical input")}static fromObject(e,i={}){e=e||{};const r=Cu(i.zone,Tr.defaultZone);if(!r.isValid)return zt.invalid(vy(r));const o=ki.fromObject(i),h=e1(e,XD),{minDaysInFirstWeek:d,startOfWeek:a}=RD(h,o),_=Tr.now(),T=qt(i.specificOffset)?r.offset(_):i.specificOffset,E=!qt(h.ordinal),k=!qt(h.year),L=!qt(h.month)||!qt(h.day),O=k||L,H=h.weekYear||h.weekNumber;if((O||E)&&H)throw new _f("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(L&&E)throw new _f("Can't mix ordinal dates with month/day");const re=H||h.weekday&&!O;let pe,ge,Se=Gv(_,T);re?(pe=oie,ge=nie,Se=Kx(Se,d,a)):E?(pe=aie,ge=sie,Se=sT(Se)):(pe=Ib,ge=T6);let Pe=!1;for(const je of pe){const ke=h[je];qt(ke)?Pe?h[je]=ge[je]:h[je]=Se[je]:Pe=!0}const Re=re?Lee(h,d,a):E?Fee(h):X4(h),ze=Re||J4(h);if(ze)return zt.invalid(ze);const Je=re?zD(h,d,a):E?OD(h):h,[Xe,yt]=Eb(Je,T,r),mt=new zt({ts:Xe,zone:r,o:yt,loc:o});return h.weekday&&O&&e.weekday!==mt.weekday?zt.invalid("mismatched weekday",`you can't specify both a weekday of ${h.weekday} and a date of ${mt.toISO()}`):mt.isValid?mt:zt.invalid(mt.invalid)}static fromISO(e,i={}){const[r,o]=Pte(e);return Hp(r,o,i,"ISO 8601",e)}static fromRFC2822(e,i={}){const[r,o]=Mte(e);return Hp(r,o,i,"RFC 2822",e)}static fromHTTP(e,i={}){const[r,o]=kte(e);return Hp(r,o,i,"HTTP",i)}static fromFormat(e,i,r={}){if(qt(e)||qt(i))throw new Zn("fromFormat requires an input string and a format");const{locale:o=null,numberingSystem:h=null}=r,d=ki.fromOpts({locale:o,numberingSystem:h,defaultToEN:!0}),[a,_,T,E]=rie(d,e,i);return E?zt.invalid(E):Hp(a,_,r,`format ${i}`,e,T)}static fromString(e,i,r={}){return zt.fromFormat(e,i,r)}static fromSQL(e,i={}){const[r,o]=Fte(e);return Hp(r,o,i,"SQL",e)}static invalid(e,i=null){if(!e)throw new Zn("need to specify a reason the DateTime is invalid");const r=e instanceof ba?e:new ba(e,i);if(Tr.throwOnInvalid)throw new hee(r);return new zt({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,i={}){const r=w6(e,ki.fromObject(i));return r?r.map(o=>o?o.val:null).join(""):null}static expandFormat(e,i={}){return v6(Xn.parseFormat(e),ki.fromObject(i)).map(o=>o.val).join("")}static resetCache(){by=void 0,iE.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?lT(this).weekYear:NaN}get weekNumber(){return this.isValid?lT(this).weekNumber:NaN}get weekday(){return this.isValid?lT(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?cT(this).weekday:NaN}get localWeekNumber(){return this.isValid?cT(this).weekNumber:NaN}get localWeekYear(){return this.isValid?cT(this).weekYear:NaN}get ordinal(){return this.isValid?sT(this.c).ordinal:NaN}get monthShort(){return this.isValid?Uv.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Uv.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Uv.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Uv.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,i=6e4,r=xw(this.c),o=this.zone.offset(r-e),h=this.zone.offset(r+e),d=this.zone.offset(r-o*i),a=this.zone.offset(r-h*i);if(d===a)return[this];const _=r-d*i,T=r-a*i,E=Gv(_,d),k=Gv(T,a);return E.hour===k.hour&&E.minute===k.minute&&E.second===k.second&&E.millisecond===k.millisecond?[Rh(this,{ts:_}),Rh(this,{ts:T})]:[this]}get isInLeapYear(){return r_(this.year)}get daysInMonth(){return Qx(this.year,this.month)}get daysInYear(){return this.isValid?Af(this.year):NaN}get weeksInWeekYear(){return this.isValid?T0(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?T0(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:i,numberingSystem:r,calendar:o}=Xn.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:i,numberingSystem:r,outputCalendar:o}}toUTC(e=0,i={}){return this.setZone(ps.instance(e),i)}toLocal(){return this.setZone(Tr.defaultZone)}setZone(e,{keepLocalTime:i=!1,keepCalendarTime:r=!1}={}){if(e=Cu(e,Tr.defaultZone),e.equals(this.zone))return this;if(e.isValid){let o=this.ts;if(i||r){const h=e.offset(this.ts),d=this.toObject();[o]=Eb(d,h,e)}return Rh(this,{ts:o,zone:e})}else return zt.invalid(vy(e))}reconfigure({locale:e,numberingSystem:i,outputCalendar:r}={}){const o=this.loc.clone({locale:e,numberingSystem:i,outputCalendar:r});return Rh(this,{loc:o})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const i=e1(e,XD),{minDaysInFirstWeek:r,startOfWeek:o}=RD(i,this.loc),h=!qt(i.weekYear)||!qt(i.weekNumber)||!qt(i.weekday),d=!qt(i.ordinal),a=!qt(i.year),_=!qt(i.month)||!qt(i.day),T=a||_,E=i.weekYear||i.weekNumber;if((T||d)&&E)throw new _f("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(_&&d)throw new _f("Can't mix ordinal dates with month/day");let k;h?k=zD({...Kx(this.c,r,o),...i},r,o):qt(i.ordinal)?(k={...this.toObject(),...i},qt(i.day)&&(k.day=Math.min(Qx(k.year,k.month),k.day))):k=OD({...sT(this.c),...i});const[L,O]=Eb(k,this.o,this.zone);return Rh(this,{ts:L,o:O})}plus(e){if(!this.isValid)return this;const i=xi.fromDurationLike(e);return Rh(this,WD(this,i))}minus(e){if(!this.isValid)return this;const i=xi.fromDurationLike(e).negate();return Rh(this,WD(this,i))}startOf(e,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const r={},o=xi.normalizeUnit(e);switch(o){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(o==="weeks")if(i){const h=this.loc.getStartOfWeek(),{weekday:d}=this;d<h&&(r.weekNumber=this.weekNumber-1),r.weekday=h}else r.weekday=1;if(o==="quarters"){const h=Math.ceil(this.month/3);r.month=(h-1)*3+1}return this.set(r)}endOf(e,i){return this.isValid?this.plus({[e]:1}).startOf(e,i).minus(1):this}toFormat(e,i={}){return this.isValid?Xn.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):aT}toLocaleString(e=Jx,i={}){return this.isValid?Xn.create(this.loc.clone(i),e).formatDateTime(this):aT}toLocaleParts(e={}){return this.isValid?Xn.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:i=!1,suppressMilliseconds:r=!1,includeOffset:o=!0,extendedZone:h=!1,precision:d="milliseconds"}={}){if(!this.isValid)return null;d=$b(d);const a=e==="extended";let _=uT(this,a,d);return Ib.indexOf(d)>=3&&(_+="T"),_+=YD(this,a,i,r,o,h,d),_}toISODate({format:e="extended",precision:i="day"}={}){return this.isValid?uT(this,e==="extended",$b(i)):null}toISOWeekDate(){return qv(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:i=!1,includeOffset:r=!0,includePrefix:o=!1,extendedZone:h=!1,format:d="extended",precision:a="milliseconds"}={}){return this.isValid?(a=$b(a),(o&&Ib.indexOf(a)>=3?"T":"")+YD(this,d==="extended",i,e,r,h,a)):null}toRFC2822(){return qv(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return qv(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?uT(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:i=!1,includeOffsetSpace:r=!0}={}){let o="HH:mm:ss.SSS";return(i||e)&&(r&&(o+=" "),i?o+="z":e&&(o+="ZZ")),qv(this,o,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():aT}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const i={...this.c};return e.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,i="milliseconds",r={}){if(!this.isValid||!e.isValid)return xi.invalid("created by diffing an invalid DateTime");const o={locale:this.locale,numberingSystem:this.numberingSystem,...r},h=jee(i).map(xi.normalizeUnit),d=e.valueOf()>this.valueOf(),a=d?this:e,_=d?e:this,T=Gte(a,_,h,o);return d?T.negate():T}diffNow(e="milliseconds",i={}){return this.diff(zt.now(),e,i)}until(e){return this.isValid?Sr.fromDateTimes(this,e):this}hasSame(e,i,r){if(!this.isValid)return!1;const o=e.valueOf(),h=this.setZone(e.zone,{keepLocalTime:!0});return h.startOf(i,r)<=o&&o<=h.endOf(i,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const i=e.base||zt.fromObject({},{zone:this.zone}),r=e.padding?this<i?-e.padding:e.padding:0;let o=["years","months","days","hours","minutes","seconds"],h=e.unit;return Array.isArray(e.unit)&&(o=e.unit,h=void 0),KD(i,this.plus(r),{...e,numeric:"always",units:o,unit:h})}toRelativeCalendar(e={}){return this.isValid?KD(e.base||zt.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(zt.isDateTime))throw new Zn("min requires all arguments be DateTimes");return LD(e,i=>i.valueOf(),Math.min)}static max(...e){if(!e.every(zt.isDateTime))throw new Zn("max requires all arguments be DateTimes");return LD(e,i=>i.valueOf(),Math.max)}static fromFormatExplain(e,i,r={}){const{locale:o=null,numberingSystem:h=null}=r,d=ki.fromOpts({locale:o,numberingSystem:h,defaultToEN:!0});return x6(d,e,i)}static fromStringExplain(e,i,r={}){return zt.fromFormatExplain(e,i,r)}static buildFormatParser(e,i={}){const{locale:r=null,numberingSystem:o=null}=i,h=ki.fromOpts({locale:r,numberingSystem:o,defaultToEN:!0});return new b6(h,e)}static fromFormatParser(e,i,r={}){if(qt(e)||qt(i))throw new Zn("fromFormatParser requires an input string and a format parser");const{locale:o=null,numberingSystem:h=null}=r,d=ki.fromOpts({locale:o,numberingSystem:h,defaultToEN:!0});if(!d.equals(i.locale))throw new Zn(`fromFormatParser called with a locale of ${d}, but the format parser was created for ${i.locale}`);const{result:a,zone:_,specificOffset:T,invalidReason:E}=i.explainFromTokens(e);return E?zt.invalid(E):Hp(a,_,r,`format ${i.format}`,e,T)}static get DATE_SHORT(){return Jx}static get DATE_MED(){return C4}static get DATE_MED_WITH_WEEKDAY(){return fee}static get DATE_FULL(){return E4}static get DATE_HUGE(){return I4}static get TIME_SIMPLE(){return $4}static get TIME_WITH_SECONDS(){return P4}static get TIME_WITH_SHORT_OFFSET(){return M4}static get TIME_WITH_LONG_OFFSET(){return k4}static get TIME_24_SIMPLE(){return A4}static get TIME_24_WITH_SECONDS(){return D4}static get TIME_24_WITH_SHORT_OFFSET(){return z4}static get TIME_24_WITH_LONG_OFFSET(){return O4}static get DATETIME_SHORT(){return R4}static get DATETIME_SHORT_WITH_SECONDS(){return L4}static get DATETIME_MED(){return F4}static get DATETIME_MED_WITH_SECONDS(){return N4}static get DATETIME_MED_WITH_WEEKDAY(){return mee}static get DATETIME_FULL(){return B4}static get DATETIME_FULL_WITH_SECONDS(){return j4}static get DATETIME_HUGE(){return U4}static get DATETIME_HUGE_WITH_SECONDS(){return V4}}function Jg(t){if(zt.isDateTime(t))return t;if(t&&t.valueOf&&Lu(t.valueOf()))return zt.fromJSDate(t);if(t&&typeof t=="object")return zt.fromObject(t);throw new Zn(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const cie={dateStyle:void 0,year:void 0,month:void 0,day:void 0,weekday:void 0},uie={timeStyle:void 0,hour12:void 0,hourCycle:void 0,hour:void 0,minute:void 0,second:void 0},C6={timeZone:J$},Ka={year:"numeric",month:"numeric",day:"numeric"},Kg={year:"numeric",month:"long",day:"numeric"},Qg={year:"numeric",month:"short",day:"numeric"},ey={year:"numeric",month:"long",weekday:"long",day:"numeric"},bu={hour:"numeric",minute:"numeric"},Bh={...bu,second:"numeric"},E6={hourCycle:"h23"},ty={...bu,...E6},iy={...Bh,...E6},I6={"short-date":Ka,"short-date-short-time":{...Ka,...bu},"short-date-short-time-24":{...Ka,...ty},"short-date-long-time":{...Ka,...Bh},"short-date-long-time-24":{...Ka,...iy},"short-date-le":Ka,"short-date-le-short-time":{...Ka,...bu},"short-date-le-short-time-24":{...Ka,...ty},"short-date-le-long-time":{...Ka,...Bh},"short-date-le-long-time-24":{...Ka,...iy},"long-month-day-year":Kg,"long-month-day-year-short-time":{...Kg,...bu},"long-month-day-year-short-time-24":{...Kg,...ty},"long-month-day-year-long-time":{...Kg,...Bh},"long-month-day-year-long-time-24":{...Kg,...iy},"day-short-month-year":Qg,"day-short-month-year-short-time":{...Qg,...bu},"day-short-month-year-short-time-24":{...Qg,...ty},"day-short-month-year-long-time":{...Qg,...Bh},"day-short-month-year-long-time-24":{...Qg,...iy},"long-date":ey,"long-date-short-time":{...ey,...bu},"long-date-short-time-24":{...ey,...ty},"long-date-long-time":{...ey,...Bh},"long-date-long-time-24":{...ey,...iy},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":bu,"long-time":Bh},hie=yo()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),$6={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},die=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),pie=die.find(({type:t})=>t==="month")?.value.toLowerCase();function P6(){const t=Y$();return(t&&$6[t])??w4()}pie!=="mart"&&($6.bs="sr-Latn-CS");let rE=new WeakMap;const Tw=I6["short-date-short-time"];function fie(t){let e=rE.get(t);if(!e){const i=P6(),r=oP(t.timeZone??cm),o={...t,timeZone:r};e=new Intl.DateTimeFormat(i,o),rE.set(t,e)}return e}function Cfe(t){return I6[t]}function Efe(t){const{dateStyle:e,timeStyle:i,hour12:r,year:o,month:h}=t,d={};return e?d.dateStyle=e:o&&(d.year=o,d.month=h||void 0),i&&!d.year&&(d.timeStyle=i,d.hour12=r==="auto"?void 0:r==="always"),d}function Gu(t,e=Tw){return fie(e).format(t)}function Ife(t,e=Tw){return Gu(new Date(t),{...e,...C6,...uie})}function $fe(t,e=Tw){return Gu(new Date(`1970-01-01T${t}Z`),{...e,...C6,...cie})}function Pfe(t,e=Tw){if(e.timeZone)return Gu(new Date(t),e);const i=zt.fromISO(t,{setZone:!0}),r=i.offset===0?J$:e.timeZone,o={...e,timeZone:r};return i.toLocaleString(o,{locale:P6()})}function oP(t){switch(t){case cm:return uee;case cee:return J$;default:return t}}X$(()=>{rE=new WeakMap});const mie={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let Pb=new WeakMap,M6={};function gie(t){const e=t||M6;if(!Pb.has(e)){const i=Y$(),r=i&&mie[i]||w4();Pb.set(e,new Intl.NumberFormat(r,t))}return Pb.get(e)}function Mfe(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function kfe(t){const{minimumFractionDigits:e,maximumFractionDigits:i,useGrouping:r}=t;return{minimumFractionDigits:e,maximumFractionDigits:i,useGrouping:r==="auto"?"auto":r==="always"}}function t1(t,e){return Object.is(t,-0)&&(t=0),gie(e).format(t)}X$(()=>{Pb=new WeakMap,M6={}});const k6=()=>ui.getLogger("esri.intl.substitute");function aP(t,e,i={}){const{format:r={}}=i;return V$(t,o=>yie(o,e,r))}function yie(t,e,i){let r,o;const h=t.indexOf(":");if(h===-1?r=t.trim():(r=t.slice(0,h).trim(),o=t.slice(h+1).trim()),!r)return"";const d=fw(r,e);if(d==null)return"";const a=(o?i?.[o]:null)??i?.[r];return a?_ie(d,a):o?vie(d,o):lP(d)}function _ie(t,e){switch(e.type){case"date":return Gu(t,e.intlOptions);case"number":return t1(t,e.intlOptions);default:return k6().warn("missing format descriptor for key {key}"),lP(t)}}function vie(t,e){switch(e.toLowerCase()){case"dateformat":return Gu(t);case"numberformat":return t1(t);default:return k6().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?Gu(t):/^numberformat/i.test(e)?t1(t):lP(t)}}function lP(t){switch(typeof t){case"string":return t;case"number":return t1(t);case"boolean":return""+t;default:return t instanceof Date?Gu(t):""}}const A6={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function bie(t){return t in A6}function e5(t){if(bie(t)){const e=A6[t];return e===!0?t:e}return null}const xy=[],zf=new Map;function t5(t){for(const e of zf.keys())D6(t.pattern,e)&&zf.delete(e)}function xie(t){return xy.includes(t)||(t5(t),xy.unshift(t)),un(()=>{const e=xy.indexOf(t);e>-1&&(xy.splice(e,1),t5(t))})}async function Afe(t){const e=cd();zf.has(t)||zf.set(t,Sie(t,e));const i=zf.get(t);return i&&await Tie.add(i),i}function wie(t){const e=Y$(t);return e?e5(t)??e5(e):null}async function Sie(t,e){const i=[];for(const r of xy)if(D6(r.pattern,t))try{return await r.fetchMessageBundle(t,e)}catch(o){i.push(o)}throw i.length?new Ot("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i}):new Ot("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function D6(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}X$(()=>{zf.clear()});const Tie=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=am())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};function i1(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const Cie=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,Eie={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function i5(t){const e=t?.match(Cie);if(!e)return null;const[,i,r,o]=e;if(!i)return null;let h=null,d=null,a=null;const{devext:_,qaext:T,www:E}=Eie;if(r)if(h=i,o)switch(o.toLowerCase()){case"devext":({customBaseUrl:d,portalHostname:a}=_);break;case"qa":({customBaseUrl:d,portalHostname:a}=T);break;default:return null}else({customBaseUrl:d,portalHostname:a}=E);else switch(i.toLowerCase()){case"devext":({customBaseUrl:d,portalHostname:a}=_);break;case"qaext":({customBaseUrl:d,portalHostname:a}=T);break;case"www":({customBaseUrl:d,portalHostname:a}=E);break;default:return null}return{customBaseUrl:d,isPortal:!1,portalHostname:a,urlKey:h}}function z6(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function O6(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,r=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):i.test(t)?t=t.replace(i,"https://devext.arcgis.com"):r.test(t)&&(t=t.replace(r,"https://qaext.arcgis.com")),t}function Iie(t){const e=atob(t),i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i.buffer}function $ie(t){const e=new Uint8Array(t);let i="";for(let r=0;r<e.length;r++)i+=String.fromCharCode(e[r]);return btoa(i)}const Pie=()=>ui.getLogger("esri.core.urlUtils"),Mm=Ai.request,r5="esri/config: esriConfig.request.proxyUrl is not set.",R6=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,L6=/^\s*http:/i,Mie=/^\s*https:/i,kie=/^\s*file:/i,F6=/:\d+$/,Aie=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Die=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),zie=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let Of=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(Die);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(zie),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const Hv={},Oie=new Of(Ai.applicationUrl);let Jn=Oie;const Rie=Lie();let cP=Rie;const uP=()=>Jn,zfe=()=>cP;function Lie(){const t=Jn.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${Jn.scheme}://${Jn.host}${Jn.port!=null?`:${Jn.port}`:""}`}${e}`}function Ho(t){if(!t)return null;const e={path:null,query:null},i=new Of(t),r=t.indexOf("?");return i.query===null?e.path=t:(e.path=t.slice(0,r),e.query=hP(i.query)),i.fragment&&(e.hash=i.fragment,i.query===null&&(e.path=e.path.slice(0,e.path.length-(i.fragment.length+1)))),e}function hP(t){const e=t.split("&"),i={};for(const r of e){if(!r)continue;const o=r.indexOf("=");let h,d;o<0?(h=decodeURIComponent(r),d=""):(h=decodeURIComponent(r.slice(0,o)),d=decodeURIComponent(r.slice(o+1)));let a=i[h];typeof a=="string"&&(a=i[h]=[a]),Array.isArray(a)?a.push(d):i[h]=d}return i}function C0(t,e){return t?Object.keys(t).map(i=>{const r=t[i];if(r==null)return"";const o=encodeURIComponent(i)+"=",h=e?.[i];return h?o+encodeURIComponent(h(r)):Array.isArray(r)?r.map(d=>i1(d)?o+encodeURIComponent(JSON.stringify(d)):o+encodeURIComponent(d)).join("&"):i1(r)?o+encodeURIComponent(JSON.stringify(r)):o+encodeURIComponent(r)}).filter(i=>i).join("&"):""}function N6(t=!1){let e,i=Mm.proxyUrl;if(typeof t=="string"){e=Vie(t);const r=Cw(t);r&&(i=r.proxyUrl)}else e=!!t;if(!i)throw Pie().warn(r5),new Ot("urlUtils:proxy-not-set",r5);return e&&nE()&&(i=gP(i)),Ho(i)}function Ofe(t,e=!1){const i=Cw(t);let r,o;if(i){const h=dP(i.proxyUrl);r=h.path,o=h.query?hP(h.query):null}else if(e){const h=N6(t);r=h.path,o=h.query}if(r){const h=Ho(t);t=r+"?"+h.path;const d=C0({...o,...h.query});d&&(t=`${t}?${d}`)}return t}const ry={path:"",query:""};function dP(t){const e=t.indexOf("?");return e!==-1?(ry.path=t.slice(0,e),ry.query=t.slice(e+1)):(ry.path=t,ry.query=null),ry}function B6(t){return t=(t=n1(t=Wie(t=dP(t).path),!0)).toLowerCase()}function Fie(t){const e={proxyUrl:t.proxyUrl,urlPrefix:B6(t.urlPrefix)},i=Mm.proxyRules,r=e.urlPrefix;let o=i.length;for(let h=0;h<i.length;h++){const d=i[h].urlPrefix;if(r.startsWith(d)){if(r.length===d.length)return-1;o=h;break}d.startsWith(r)&&(o=h+1)}return i.splice(o,0,e),o}function Cw(t){const e=Mm.proxyRules,i=B6(t);for(let r=0;r<e.length;r++)if(i.startsWith(e[r].urlPrefix))return e[r]}function Rfe(t,e){if(!t||!e)return!1;t=r1(t),e=r1(e);const i=i5(t),r=i5(e);return i!=null&&r!=null?i.portalHostname===r.portalHostname:i==null&&r==null&&xd(t,e,!0)}function Nie(t,e){return t=r1(t),e=r1(e),n1(t)===n1(e)}function r1(t){const e=(t=Fu(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function n5(t,e=Mm.interceptors){const i=r=>r instanceof RegExp?r.test(t):typeof r=="string"?t.startsWith(r):r==null;if(e){for(const r of e)if(Array.isArray(r.urls)){if(r.urls.some(i))return r}else if(i(r.urls))return r}return null}function xd(t,e,i=!1){if(!t||!e)return!1;const r=oE(t),o=oE(e);return!(!i&&r.scheme!==o.scheme)&&r.host!=null&&o.host!=null&&r.host.toLowerCase()===o.host.toLowerCase()&&r.port===o.port}function pP(t){if(typeof t=="string"){if(!wa(t))return!0;t=oE(t)}if(xd(t,Jn))return!0;const e=Mm.trustedServers||[];for(let i=0;i<e.length;i++){const r=Bie(e[i]);for(let o=0;o<r.length;o++)if(xd(t,r[o]))return!0}return!1}function Bie(t){return Hv[t]||(mP(t)||Zu(t)?Hv[t]=[new Of(o_(t))]:Hv[t]=[new Of(`http://${t}`),new Of(`https://${t}`)]),Hv[t]}function o_(t,e=cP,i){return Zu(t)?i?.preserveProtocolRelative?t:Jn.scheme==="http"&&Jn.authority===po(t).slice(2)?`http:${t}`:`https:${t}`:mP(t)?t:Ew(t.startsWith("/")?Zie(e):e,t)}function j6(t,e=cP,i){if(t==null||!wa(t))return t;const r=Fu(t),o=r.toLowerCase(),h=Fu(e).toLowerCase().replace(/\/+$/,""),d=i?Fu(i).toLowerCase().replace(/\/+$/,""):null;if(d&&!h.startsWith(d))return t;const a=(k,L,O)=>(O=k.indexOf(L,O))===-1?k.length:O;let _=a(o,"/",o.indexOf("//")+2),T=-1;for(;o.slice(0,_+1)===h.slice(0,_)+"/"&&(T=_+1,_!==o.length);)_=a(o,"/",_+1);if(T===-1||d&&T<d.length)return t;t=r.slice(T);const E=h.slice(T-1).replaceAll(/[^/]+/g,"").length;if(E>0)for(let k=0;k<E;k++)t=`../${t}`;else t=`./${t}`;return t}function Fu(t){return t=Jie(t=Xie(t=Yie(t=o_(t=t.trim()))))}function Ew(...t){const e=t.filter(yb);if(!e?.length)return;const i=[];if(wa(e[0])){const o=e[0],h=o.indexOf("//");h!==-1&&(i.push(o.slice(0,h+1)),qie(e[0])&&(i[0]+="/"),e[0]=o.slice(h+2))}else e[0].startsWith("/")&&i.push("");const r=e.reduce((o,h)=>h?o.concat(h.split("/")):o,[]);for(let o=0;o<r.length;o++){const h=r[o];h===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!h&&o===r.length-1||h&&(h!=="."||i.length===0))&&i.push(h)}return i.join("/")}function po(t,e=!1){if(t==null||fP(t)||km(t))return null;let i=t.indexOf("://");if(i===-1&&Zu(t))i=2;else{if(i===-1)return null;i+=3}const r=t.indexOf("/",i);return r!==-1&&(t=t.slice(0,r)),e&&(t=n1(t,!0)),t}function wa(t){return Zu(t)||mP(t)}function fP(t){return t!=null&&t.startsWith("blob:")}function km(t){return t!=null&&t.startsWith("data:")}function jie(t){const e=E0(t);return e?.isBase64?Iie(e.data):null}function Lfe(t){return $ie(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const Uie=/^data:(.*?)(;base64)?,(.*)$/;function E0(t){const e=t.match(Uie);if(!e)return null;const[,i,r,o]=e;return{mediaType:i,isBase64:!!r,data:o}}function U6(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function Ffe(t){return(await fetch(t)).blob()}function Nfe(t){const e=jie(t);if(!e)return null;const i=E0(t);return new Blob([e],{type:i.mediaType})}function Zu(t){return t!=null&&t.startsWith("/")&&t[1]==="/"}function mP(t){return t!=null&&R6.test(t)}function Vie(t){return t!=null&&Mie.test(t)||Jn.scheme==="https"&&Zu(t)}function Gie(t){return t!=null&&L6.test(t)||Jn.scheme==="http"&&Zu(t)}function qie(t){return t!=null&&kie.test(t)}function gP(t){return Zu(t)?`https:${t}`:t.replace(L6,"https:")}function Hie(){return Jn.scheme==="http"}function nE(){return Jn.scheme==="https"}function n1(t,e=!1){return Zu(t)?t.slice(2):(t=t.replace(R6,""),e&&t.length>1&&t.startsWith("/")&&t[1]==="/"&&(t=t.slice(2)),t)}function Zie(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return i===-1?t:t.slice(0,i)}function Bfe(t){let e=0;if(wa(t)){const r=t.indexOf("//");r!==-1&&(e=r+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function jfe(t,e){if(!t)return"";const i=Ho(t).path.replace(/\/+$/,""),r=i.slice(i.lastIndexOf("/")+1);if(!e?.length)return r;const o=new RegExp(`\\.(${e.join("|")})$`,"i");return r.replace(o,"")}function Wie(t){return t.endsWith("/")?t:`${t}/`}function V6(t){return t.replace(/\/+$/,"")}function Yie(t){if(/^https?:\/\//i.test(t)){const e=dP(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function Xie(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function Jie(t){const e=Mm.httpsDomains;if(!Gie(t))return t;const i=t.indexOf("/",7);let r;if(r=i===-1?t:t.slice(0,i),r=r.toLowerCase().slice(7),F6.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","")}return Hie()&&r===Jn.authority&&!Aie.test(t)||(nE()&&r===Jn.authority||e&&e.some(o=>r===o||r.endsWith(`.${o}`))||nE()&&!Cw(t))&&(t=gP(t)),t}function sE(t,e,i){if(!(e&&i&&t&&wa(t)))return t;const r=t.indexOf("//"),o=t.indexOf("/",r+2),h=t.indexOf(":",r+2),d=Math.min(o<0?t.length:o,h<0?t.length:h);return t.slice(r+2,d).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,r+2)}${i}${t.slice(d)}`}function Kie(t,e){const i=new URL(t);return i.host=e,i.port&&!F6.test(e)&&(i.port=""),i.toString()}function Ufe(t){return new URL(t).host}function oE(t){return typeof t=="string"?new Of(o_(t)):(t.scheme||(t.scheme=Jn.scheme),t)}function G6(t,e){const i=Ho(t),r=Object.keys(i.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),i.path}function Qie(t,e,i){const r=Ho(t),o=r.query||{};return o[e]=String(i),`${r.path}?${C0(o)}`}function hT(t,e){if(!e)return t;const i=Ho(t),r=i.query||{};for(const[h,d]of Object.entries(e))d!=null&&(r[h]=d);const o=C0(r);return o?`${i.path}?${o}`:i.path}function Vfe(t){if(t==null)return null;const e=t.match(q6);return e?e[2]:null}function s5(t){if(t==null)return null;const e=t.match(q6);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function Gfe(t){return typeof t=="string"?E0(t)??{data:t}:new Promise((e,i)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(E0(r.result)),r.onerror=o=>i(o)})}const q6=/([^.]*)\.([^/]*)$/;Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const ere="4.34";let Ni,tre=ere;function qfe(t){Ni=t}function Hfe(t){const e=Ni?.findCredential(t);return e?.token?Qie(t,"token",e.token):t}tre="4.34.8",Ve("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),Ve("host-webworker");function Zfe(t,e){for(const i of t.values())if(e(i))return!0;return!1}function H6(t,e,i){const r=t.get(e);if(r!==void 0)return r;const o=i();return t.set(e,o),o}function Wfe(t){const e=new Map;return i=>(e.has(i)||e.set(i,t(i)),e.get(i))}function a_(t,e){const i=e?.url?.path;if(t&&i&&(t=o_(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const r=j6(t,e.portalItem.itemUrl);r!=null&&r.startsWith(ire)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(r).path)}return(t=aE(t,e?.portal))&&$w.test(t)?W6(t):t}function Iw(t,e,i=0){if((t=t&&$w.test(t)?Y6(t):t)==null)return t;!wa(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let r=o_(t);if(e){const o=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(o){const h=aE(o,e.portal),d=aE(r,e.portal);r=j6(d,h,h),r!=null&&r!==d&&r!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=Z6(r,e?.portal),wa(r)&&(r=Fu(r)),e?.resources&&e?.portalItem&&!wa(r)&&!km(r)&&i===0&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(r),compress:!1}),r}function yP(t,e,i){return a_(t,i)}function hm(t,e,i,r){const o=Iw(t,r);o!==void 0&&(e[i]=o)}const $w=/\/items\/([^/]+)\/resources\/(.*)/,ire="./resources/";function rre(t){return(t?.match($w)??null)?.[1]??null}function nre(t){const e=t?.match($w)??null;if(e==null)return null;const i=e[2],r=i.lastIndexOf("/");if(r===-1){const{path:d,extension:a}=s5(i);return{prefix:null,filename:d,extension:a}}const{path:o,extension:h}=s5(i.slice(r+1));return{prefix:i.slice(0,r),filename:o,extension:h}}function Z6(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?sE(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function aE(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,r=uP();return xd(r,`${r.scheme}://${i}`)?sE(t,e.portalHostname,i):sE(t,i,e.portalHostname)}function W6(t){if(!t)return t||null;let e=t;return e&&Ni&&!Ni.findCredential(e)&&(e=O6(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function Y6(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Ni&&!Ni.findCredential(e)&&(e=O6(e)),e}const Yfe=Object.freeze(Object.defineProperty({__proto__:null,ensureMainOnlineDomain:Z6,fromCDNUrl:Y6,fromJSON:a_,itemIdFromResourceUrl:rre,prefixAndFilenameFromResourceUrl:nre,read:yP,toCDNUrl:W6,toJSON:Iw,write:hm},Symbol.toStringTag,{value:"Module"})),X6={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},J6=Object.values(X6),K6=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${J6.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),sre=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${J6.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),ore=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function Xfe(t){return K6.test(t)}function Pw(t){if(t==null)return null;const e=Ho(t),i=e?.path.match(K6)||e?.path.match(sre);if(!i)return null;const[,r,o,h,d]=i,a=o.indexOf("/");return{title:Q6(a!==-1?o.slice(a+1):o),serverType:X6[h.toLowerCase()],sublayer:d!=null&&d!==""?parseInt(d,10):null,url:{path:r}}}function are(t){const e=Ho(t).path.match(ore);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function Q6(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function Jfe(t,e){const i=[];if(t){const r=Pw(t);r!=null&&r.title&&i.push(r.title)}if(e){const r=Q6(e);i.push(r)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function o5(t){let e=po(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function Kfe(t,e){return t&&V6(G6(t,e))}function Qfe(t){let{url:e}=t;if(!e)return{url:e};e=G6(e,t.logger);const i=Ho(e),r=Pw(i.path);let o;if(r!=null)r.sublayer!=null&&t.layer.layerId==null&&(o=r.sublayer),e=r.url.path;else if(t.nonStandardUrlAllowed){const h=are(i.path);h!=null&&(e=h.serviceUrl,o=h.sublayerId)}return{url:V6(e),layerId:o}}function eme(t,e,i,r,o){hm(e,r,"url",o),r.url&&t.layerId!=null&&(r.url=Ew(r.url,i,t.layerId.toString()))}function tme(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),r=e.includes("/mapserver/wmsserver"),o=e.includes("/imageserver/wmsserver"),h=e.includes("/wmsserver");return i&&(r||o||h)}const lre=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function _P(t){if(!vP(t))return null;const e=r=>r instanceof RegExp?r.test(t):typeof r=="string"&&t.startsWith(r),i=Ai.apiKeys;if(Array.isArray(i.scopes)){for(const r of i.scopes)if(Array.isArray(r.urls)){if(r.urls.some(e))return r.token}else if(e(r.urls))return r.token}return i.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?i.basemapStyles:Ai.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?Ai.apiKey:null}function a5(){return Ai.apiKey!=null||Ai.apiKeys.basemapStyles!=null}function eF(t,e){return e?vP(t):_P(t)!=null}function vP(t){const e=po(t,!0);return!!e&&!lre.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function cre(t,e,i=!1,r){return new Promise((o,h)=>{if(Vu(r))return void h(l5());let d=()=>{T(),h(new Error(`Unable to load ${e}`))},a=async()=>{const E=t;try{await E.decode()}catch{}T(),o(E)},_=()=>{if(!t)return;const E=t;T(),E.src="",h(l5())};const T=()=>{t&&(t.removeEventListener("error",d),t.removeEventListener("load",a),d=null,a=null,t=null,r?.removeEventListener("abort",_),_=null,i&&URL.revokeObjectURL(e))};r?.addEventListener("abort",_),t.addEventListener("error",d),t.addEventListener("load",a)})}function l5(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const tF="Timeout exceeded";function ure(){return new Error(tF)}function ime(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===tF}function hre(t){Ai.request.crossOriginNoCorsDomains||(Ai.request.crossOriginNoCorsDomains={});const e=Ai.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[po(i)??""]=0:(e[po("http://"+i)??""]=0,e[po("https://"+i)??""]=0)}function dre(t){const e=Ai.request.crossOriginNoCorsDomains;if(e){let i=po(t);if(i)return i=i.toLowerCase(),!xd(i,uP())&&e[i]<Date.now()-36e5}return!1}async function pre(t){const e=Ho(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const i=Ai.request.crossOriginNoCorsDomains,r=po(t);i&&r&&(i[r.toLowerCase()]=Date.now())}const lE=new Map;function fre(t,e){const i=e?.preferredHost;if(!i||xd(t,`https://${i}`,!0))return;const r=Pw(t);if(!r||r.serverType!=="FeatureServer"||z6(t))return;const o=r.url.path.toLowerCase();lE.has(o)||lE.set(o,i)}function c5(t){const e=Pw(t)?.url.path.toLowerCase();if(!e)return t;const i=lE.get(e);return i?Kie(t,i):t}async function wn(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=hP(e.query.toString().replaceAll("+"," ")));const i=km(t),r=fP(t);r||i||(t=Fu(t));const o={url:t,requestOptions:{...e}},h=O=>({data:O,getAllHeaders:dm,getHeader:dm,httpStatus:200,requestOptions:o.requestOptions,url:o.url}),d=n5(t,Fo.internalInterceptors);if(d){const O=await h5(d,o);if(O!=null)return h(O)}let a=n5(t);if(a){const O=await h5(a,o);if(O!=null)return h(O);a.after||a.error||(a=null)}if(t=o.url,(e=o.requestOptions).responseType==="image"&&(Ve("host-webworker")||Ve("host-node")))throw Sa("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),o);if(e.method==="head"){if(e.body)throw Sa("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),o);if(i||r)throw Sa("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),o)}if(await vre(),s1)return s1.execute(t,e);const _=new AbortController,T=S0(e,()=>_.abort()),E={controller:_,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:o,redoRequest:!1,useIdentity:Fo.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},k=e.useRequestQueue?Tre(E):uE(E),L=await k.finally(()=>T?.remove());return a?.after?.(L),L}let s1,iF=!1;const Fo=Ai.request,rF="FormData"in globalThis,mre=new Set([499,498,403,401]),gre=new Set(["COM_0056","COM_0057","SB_0008"]),yre=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],dm=()=>null,o1=Symbol();function _re(t){const e=po(t);e&&!wn._corsServers.includes(e)&&wn._corsServers.push(e)}function u5(t){const e=po(t);return!e||e.endsWith(".arcgis.com")||wn._corsServers.includes(e)||pP(e)}function Sa(t,e,i,r){let o;const h={url:i.url,requestOptions:i.requestOptions,getAllHeaders:dm,getHeader:dm,ssl:!1};if(e instanceof Ot)return e.details?(e.details=dt(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=h,e;if(e){const d=r&&(()=>Array.from(r.headers)),a=r&&(E=>r.headers.get(E)),_=r?.status,T=e.message;T&&(o=T),d&&a&&(h.getAllHeaders=d,h.getHeader=a),h.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||_||0,h.subCode=e.subcode,h.messageCode=e.messageCode,typeof e.details=="string"?(h.messages=[e.details],o??=e.details):(h.messages=e.details,o??=h.messages?.[0]),h.raw=o1 in e?e[o1]:e}return o??="Error",Dd(e)?As():new Ot(t,o,h)}async function vre(){Ve("host-webworker")&&(!s1&&globalThis.invokeStaticMessage?s1=await Kn(()=>import("./request-D2uOsRWz.js"),__vite__mapDeps([0,1,2,3])):iF=!0)}async function cE(){Ni||await Kn(()=>import("./IdentityManager-BV7fJ-wC.js"),__vite__mapDeps([4,1,2,5,6,3]))}async function bre(t){const e=t.params.url,i=t.params.requestOptions,r=t.controller.signal,o=i.body;let h=null,d=null;if(rF&&"HTMLFormElement"in globalThis&&(o instanceof FormData?h=o:o instanceof HTMLFormElement&&(h=new FormData(o))),typeof o=="string"&&(d=o),t.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},keepalive:i.keepAlive??!1,method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:Fo.priority,redirect:"follow",signal:r},(h||d)&&(t.fetchOptions.body=h||d),(iF||i.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||i.query?.token||h?.get("token")),!t.hasToken){const a=_P(e);a&&(i.query??={},i.query.token=a,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!nF(e)&&!Vu(r)){let a;i.authMode==="immediate"?(await cE(),a=await Ni.getCredential(e,{signal:r})):i.authMode==="no-prompt"?(await cE(),a=await Ni.getCredential(e,{prompt:!1,signal:r}).catch(()=>{})):Ni&&(a=Ni.findCredential(e)),a&&(t.credential=a,t.credentialToken=a.token,t.useSSL=!!a.ssl)}}function nF(t){return yre.some(e=>e.test(t))}async function xre(t){let e=t.params.url,i=c5(e);const r=t.params.requestOptions,o=t.fetchOptions??{},h=fP(e)||km(e),d=r.responseType||"json",a=h?0:r.timeout!=null?r.timeout:Fo.timeout;let _=!1;if(!h){t.useSSL&&(e=gP(e));let O={...r.query};t.credentialToken&&(O.token=t.credentialToken);let H=C0(O);Ve("esri-url-encodes-apostrophe")&&(H=H.replaceAll("'","%27"));const re=i.length+1+H.length;let pe;_=r.method==="delete"||r.method==="post"||r.method==="put"||!!r.body||re>Fo.maxUrlLength;const ge=r.useProxy||!!Cw(e);if(ge){const Se=N6(e);pe=Se.path,!_&&pe.length+1+re>Fo.maxUrlLength&&(_=!0),Se.query&&(O={...Se.query,...O})}if(o.method==="HEAD"&&(_||ge)){if(_)throw re>Fo.maxUrlLength?Sa("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):Sa("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(ge)throw Sa("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}_?(o.method=r.method==="delete"?"DELETE":r.method==="put"?"PUT":"POST",r.body?e=hT(e,O):(o.body=C0(O),o.headers||(o.headers={}),o.headers["Content-Type"]="application/x-www-form-urlencoded")):e=hT(e,O),ge&&(t.useProxy=!0,e=`${pe}?${e}`),O.token&&rF&&o.body instanceof FormData&&!z6(e)&&o.body.set("token",O.token),r.hasOwnProperty("withCredentials")?t.withCredentials=r.withCredentials:xd(e,uP())||(pP(e)||Ni&&Ni.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(o.credentials="include",dre(e)&&await pre(_?hT(e,O):e)),i=c5(e)}let T,E,k=0,L=!1;a>0&&(k=setTimeout(()=>{L=!0,t.controller.abort()},a));try{if(r.responseType==="native-request-init")E=o,E.url=i,r.signal?E.signal=r.signal:delete E.signal;else if(r.responseType!=="image"||o.cache!=="default"||o.keepalive||o.method!=="GET"||_||wre(r.headers)||!h&&!t.useProxy&&Fo.proxyUrl&&!u5(e)){if(wn._beforeFetch&&await wn._beforeFetch(e,o),T=await fetch(i,o),wn._afterFetch&&await wn._afterFetch(T),t.useProxy||_re(e),r.responseType==="native")E=T;else if(o.method!=="HEAD")if(T.ok){switch(d){case"array-buffer":E=await T.arrayBuffer();break;case"blob":case"image":E=await T.blob();break;default:E=await T.text()}if(k&&(clearTimeout(k),k=0),d==="json"||d==="xml"||d==="document")if(E)switch(d){case"json":E=JSON.parse(E);break;case"xml":E=d5(E,"application/xml");break;case"document":E=d5(E,"text/html")}else E=null;if(E){if(d==="array-buffer"||d==="blob"){const O=T.headers.get("Content-Type");if(O&&/application\/json|text\/plain/i.test(O)&&E[d==="blob"?"size":"byteLength"]<=750)try{const H=await new Response(E).json();H.error&&(E=H)}catch{}}d==="image"&&E instanceof Blob&&(E=await p5(URL.createObjectURL(E),t,!0))}}else{E=await T.text();try{E=JSON.parse(E)}catch{}}}else E=await p5(i,t)}catch(O){if(O.name==="AbortError")throw L?ure():As("Request canceled");if(!(!T&&O instanceof TypeError&&Fo.proxyUrl)||r.body||r.method==="delete"||r.method==="head"||r.method==="post"||r.method==="put"||t.useProxy||u5(e))throw O;t.redoRequest=!0,Fie({proxyUrl:Fo.proxyUrl,urlPrefix:po(e)??""})}finally{k&&clearTimeout(k)}return[T,E]}async function h5(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,r;try{r=await t.before(e)}catch(o){i=Sa("request:interceptor",o,e)}if((r instanceof Error||r instanceof Ot)&&(i=Sa("request:interceptor",r,e)),i)throw t.error&&t.error(i),i;return r}}function wre(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function d5(t,e){let i;try{i=new DOMParser().parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}wn._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],wn._beforeFetch=void 0,wn._afterFetch=void 0;const Sre=new Map;async function Tre(t){const e=Ere(t.params.url);if(!e)return uE(t);const{QueueProcessor:i}=await Kn(()=>import("./QueueProcessor-CbnWEMZ1.js"),__vite__mapDeps([7,8,9,10,1,2,3]));return H6(Sre,e.origin,()=>{const o=e.isHosted?Ve("request-queue-concurrency-hosted"):Ve("request-queue-concurrency-non-hosted");return new i({concurrency:o,process:h=>{if(Vu(h.params.requestOptions))throw Sa("",As("Request canceled"),h.params);return uE(h)}})}).push(t)}async function uE(t){let e,i;await bre(t);try{do[e,i]=await xre(t);while(!await Cre(t,e,i))}catch(h){const d=Sa("request:server",h,t.params,e);throw d.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(d),d}const r=t.params.url;if(i)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!t.hasToken&&!t.credentialToken&&i.user?.username&&!pP(r)){const h=po(r,!0);h&&Fo.trustedServers.push(h)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&hre(i.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&fre(r,i);const o=t.credential;if(o&&Ni){let d=Ni.findServerInfo(o.server)?.owningSystemUrl;if(d){d=d.replace(/\/?$/,"/sharing");const a=Ni.findCredential(d,o.userId);a&&Ni._getIdenticalSvcIdx(d,a)===-1&&a.resources.unshift(d)}}return{data:i,getAllHeaders:e?()=>Array.from(e.headers):dm,getHeader:e?h=>e.headers.get(h):dm,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function Cre(t,e,i){if(t.redoRequest)return t.redoRequest=!1,!1;const r=t.params.requestOptions;if(!e||r.responseType==="native"||r.responseType==="native-request-init")return!0;let o,h;if(i&&(i.error&&typeof i.error=="object"?o=i.error:i.status==="error"&&Array.isArray(i.messages)&&(o={...i},o[o1]=i,o.details=i.messages)),!o&&!e.ok)throw o=new Error(`Unable to load ${e.url} status: ${e.status}`),o[o1]=i,o;let d,a=null;o&&(h=Number(o.code),a=o.hasOwnProperty("subcode")?Number(o.subcode):null,d=o.messageCode,d=d?.toUpperCase());const _=r.authMode;if(h===403&&(a===4||o.message?.toLowerCase().includes("ssl")&&!o.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(_!=="no-prompt"||h===498)&&h!==void 0&&mre.has(h)&&!nF(t.params.url)&&(h!==403||(!d||!gre.has(d))&&(a==null||a===2&&t.credentialToken))){await cE();try{const T=await Ni.getCredential(t.params.url,{error:Sa("request:server",o,t.params),credential:t.credential,prompt:_!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=T,t.credentialToken=T.token,t.useSSL=t.useSSL||T.ssl,!1}catch(T){if(_==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;o=T}}if(o)throw o;return!0}function p5(t,e,i=!1){const r=e.controller.signal,o=new Image;return e.withCredentials?o.crossOrigin="use-credentials":o.crossOrigin="anonymous",o.alt="",o.fetchPriority=Fo.priority,o.src=t,cre(o,t,i,r)}function Ere(t){let e,i;return typeof t=="string"?(e=po(t,!0),i=o5(t)):(e=t.origin,i=o5(t.toString())),e==null?null:{origin:e,isHosted:i}}async function Ire(t,e,i,r){const o=e.exec(i);if(!o)throw new Ot("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const h=o[1]?`${o[1]}/`:"",d=o[2],a=wie(r),_=`${h}${d}.json`,T=a?`${h}${d}_${a}.json`:_;let E;try{E=await f5(t(T))}catch(k){if(T===_)throw new Ot("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:k});try{E=await f5(t(_))}catch(L){throw new Ot("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:L})}}return E}async function f5(t){if(m5.fetchBundleAsset!=null)return m5.fetchBundleAsset(t);const e=await wn(t,{responseType:"text"});return JSON.parse(e.data)}let $re=class{constructor({base:e="",pattern:i,location:r=new URL(window.location.href)}){let o;o=typeof r=="string"?h=>new URL(h,new URL(r,window.location.href)).href:r instanceof URL?h=>new URL(h,r).href:r,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=o,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,i){return Ire(this.getAssetUrl,this.matcher,e,i)}};function Pre(t){return new $re(t)}const m5={};function bP(t){if(!Ai.assetsPath)throw ui.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Ot("assets:path-not-set","config.assetsPath is not set");return Ew(Ai.assetsPath,t)}xie(Pre({pattern:"esri/",location:bP}));/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const g5="arcgis-search-result-renderer",y5={base:g5,moreResults:`${g5}__more-results`},Mre=Ui`.esri-widget__heading{color:var(--calcite-color-text-2);margin:0 0 .5rem;font-weight:var(--calcite-font-weight-semibold)}h1.esri-widget__heading{font-size:var(--calcite-font-size-xl)}h2.esri-widget__heading{font-size:var(--calcite-font-size-md)}h3.esri-widget__heading,h4.esri-widget__heading,h5.esri-widget__heading,h6.esri-widget__heading{font-size:var(--calcite-font-size)}.esri-widget{--esri-widget-padding-x: 15px;--esri-widget-padding-y: var(--calcite-spacing-md);--esri-widget-padding: var(--esri-widget-padding-y) var(--esri-widget-padding-x);box-sizing:border-box;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget *,.esri-widget :before,.esri-widget :after{box-sizing:inherit}.esri-widget.esri-widget--disabled>*{opacity:.4;pointer-events:none}.esri-widget.esri-widget--compact{--esri-widget-padding-y: 0;--esri-widget-padding-x: 0}.esri-widget__anchor{color:var(--calcite-color-text-2)}.esri-widget__anchor:hover{color:var(--calcite-color-text-3)}.esri-widget__anchor:hover,.esri-widget__anchor:focus{text-decoration:underline}.esri-widget__anchor--disabled{opacity:.4;pointer-events:none}.esri-widget__header{background-color:var(--calcite-color-foreground-1);flex:1 0 100%;justify-content:space-between;align-items:center;width:100%;min-height:48px;padding:12px 0 12px 15px;display:flex}.esri-widget__header .esri-widget__heading{width:calc(100% - 48px);text-align:initial;color:var(--calcite-color-text-1);align-items:center;margin:0;padding:0;display:flex}.esri-widget__header-button{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);border:none;flex:0 0 48px;justify-content:center;align-self:stretch;align-items:center;width:48px;padding:0;display:flex}.esri-widget__footer{background-color:var(--calcite-color-foreground-1);justify-content:center;align-items:center;width:100%;min-height:48px;display:flex}.esri-widget__footer-pagination{color:var(--calcite-color-text-2);justify-content:space-between;align-items:center;display:flex}.esri-widget__footer-pagination-previous-button,.esri-widget__footer-pagination-next-button{cursor:pointer;background-color:var(--calcite-color-foreground-1);border:0;margin:0 7px;padding:12px 15px;transition:background-color .125s ease-in-out}.esri-widget__footer-pagination-previous-button:hover,.esri-widget__footer-pagination-previous-button:focus,.esri-widget__footer-pagination-next-button:hover,.esri-widget__footer-pagination-next-button:focus{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1)}.esri-menu{visibility:hidden;z-index:1;background-clip:padding;background-color:var(--calcite-color-foreground-1);background-clip:padding-box;width:100%;max-height:0;margin:2px 0 0;padding:0;font-size:var(--calcite-font-size);line-height:var(--calcite-spacing-xl);position:absolute;top:100%;left:0;overflow:hidden;box-shadow:0 1px 2px #0000004d}.esri-menu .esri-menu__header{color:var(--calcite-color-text-inverse);background-color:var(--calcite-color-inverse);padding:6px 12px}.esri-menu__list{margin:0;padding:0;list-style:none}.esri-menu__list-item{cursor:pointer;border-top:1px solid #adadad4d;border-left:3px solid #0000;padding:.8em 1em}.esri-menu__list-item [class^=esri-icon-],.esri-menu__list-item [class*=" esri-icon-"]{padding-right:2.8px}.esri-menu__list-item:first-child{border-top:none}.esri-menu__list-item--focus,.esri-menu__list-item:hover,.esri-menu__list-item:focus{background-color:var(--calcite-color-foreground-1)}.esri-menu__list-item:active{background-color:var(--calcite-color-foreground-current)}.esri-menu__list-item--active,.esri-menu__list-item--active:hover,.esri-menu__list-item--active:focus{background-color:var(--calcite-color-foreground-1);border-left-color:var(--calcite-color-brand)}.esri-widget__table{border-collapse:collapse;color:var(--calcite-color-text-1);border:none;width:100%;line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget__table tr:nth-child(odd){background-color:var(--calcite-color-transparent)}.esri-widget__table tr:nth-child(2n){background-color:var(--calcite-color-transparent-press)}.esri-widget__table tr a{color:var(--calcite-color-text-2)}.esri-widget__table tr a:hover,.esri-widget__table tr a:focus{color:var(--calcite-color-text-1)}.esri-widget__table tr td,.esri-widget__table tr th{vertical-align:top;word-break:break-word;padding:.5em .7em;font-size:var(--calcite-font-size-sm);font-weight:var(--calcite-font-weight-regular)}.esri-widget__table tr th{text-align:left;border-right:3px solid #0000000d;width:50%}.esri-widget__table tr td{width:50%}.esri-input{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1);border:1px solid #959595;font-size:var(--calcite-font-size)}.esri-input::-ms-clear{display:none}.esri-input::placeholder{opacity:1;color:var(--calcite-color-text-2)}.esri-input:placeholder-shown{text-overflow:ellipsis}.esri-input[type=text],.esri-input[type=password],.esri-input[type=number]{height:32px;padding:0 .5em}calcite-combobox.esri-input{border:none}.esri-widget__content--empty{text-align:center;color:var(--calcite-color-border-input);flex-flow:column wrap;align-items:center;padding:18px 22px;display:flex}.esri-widget__content--empty h1.esri-widget__heading,.esri-widget__content--empty h2.esri-widget__heading,.esri-widget__content--empty h3.esri-widget__heading,.esri-widget__content--empty h4.esri-widget__heading,.esri-widget__content--empty h5.esri-widget__heading{font-weight:var(--calcite-font-weight-regular)}.esri-widget__content-illustration--empty{width:128px;padding:1rem 0}.esri-widget__content-icon--empty{width:32px;padding:.5rem 0}.esri-select{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background:var(--calcite-color-foreground-1) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='-8 -8 32 32' width='32' height='32'%3E%3Cpath d='M8 11.207l-4-4V5.793l4 4 4-4v1.414z' fill='%23adadad' fillrule='nonzero'/%3E%3C/svg%3E") 100% no-repeat;border:1px solid #959595;border-radius:0;width:100%;height:32px;margin:0;padding:0 .5em;font-family:inherit;font-size:.85em;display:block}.esri-select[disabled]{cursor:auto}.esri-select::-ms-expand{display:none}.esri-disabled a,.esri-disabled [role=menu],.esri-disabled [role=checkbox],.esri-disabled [class^=esri-icon-],.esri-disabled [class*=" esri-icon-"]{color:var(--calcite-color-text-3)}.keynav-mode .esri-widget:focus,.keynav-mode .esri-widget :focus{z-index:1;outline-offset:2px;outline:2px solid #adadad}.esri-widget__loader-animation{border:.15em solid #adadad4d;border-top-color:var(--calcite-color-border-input);border-radius:100%;width:1em;height:1em;font-size:var(--calcite-font-size-md);animation:1.25s linear infinite esri-rotate;display:block;transform:translateZ(0)}:dir(rtl) .esri-widget__table th{text-align:right;border-left:3px solid #0000000d;border-right:none}:dir(rtl) .esri-select{background-position:0}:dir(rtl) .esri-menu__list-item{border-left:none;border-right:3px solid #0000}:dir(rtl) .esri-menu__list-item [class^=esri-icon-],:dir(rtl) .esri-menu__list-item [class*=" esri-icon-"]{padding-left:2px;padding-right:0}:dir(rtl) .esri-menu__list-item--active{border-right-color:var(--calcite-color-brand)}.esri-icon-font-fallback-text{clip:rect(0 0 0 0);width:1px;height:1px;position:absolute;overflow:hidden}.esri-rotating{animation:1.25s linear infinite esri-rotate;transform:translateZ(0)}.esri-clearfix:before,.esri-clearfix:after{content:" ";display:table}.esri-clearfix:after{clear:both}.esri-interactive{cursor:pointer}.esri-hidden{display:none!important}.esri-invisible{visibility:hidden!important}.esri-offscreen{position:absolute;top:-999em;left:-999em}.esri-match-height{flex-direction:column;flex:auto;display:flex;overflow:hidden}.arcgis-search-result-renderer calcite-block,.arcgis-search-result-renderer calcite-block[expanded]{margin-block:0;margin-block-start:var(--calcite-spacing-md);border:0}`;var pd;let kre=(pd=class extends ji{constructor(){super(...arguments),this._resultCount=0,this._showMoreResultsOpen=!1,this.autoDestroyDisabled=!1,this.arcgisReady=vt()}async destroy(){await this.manager.destroy()}loaded(){this.manager.onLifecycle(()=>[_l(()=>[this.viewModel?.results,this.viewModel?.resultCount],()=>{this._results=this.viewModel?.results,this._resultCount=this.viewModel?.resultCount??0,this._showMoreResultsOpen=!1},{initial:!0}),_l(()=>this.viewModel?.selectedResult,e=>this._selectedResult=e,{initial:!0})])}_selectResult(e){this._showMoreResultsOpen=!1,this.viewModel?.select(e)}_getSourceName(e,i){return i===-1?this.messages?.all??"":e.name}_toggleShowMoreResults(e){this._showMoreResultsOpen=e;const i=this.viewModel?.view?.popup;i&&"reposition"in i&&i.reposition()}render(){return Ne`<div class=${Fe(eR(y5.base,JL.widget))}>${this._selectedResult?.name??""}${this._renderMoreResults()}</div>`}_renderMoreResults(){const{_resultCount:e,_results:i}=this;return!e||e<2||!i?null:Ne`<calcite-block class=${Fe(y5.moreResults)} collapsible .expanded=${this._showMoreResultsOpen} .heading=${aP(this.messages?.showMoreResults??"",{count:e-1})} @calciteBlockClose=${()=>this._toggleShowMoreResults(!1)} @calciteBlockOpen=${()=>this._toggleShowMoreResults(!0)}>${i.map(r=>this._renderMoreResultsList(r,i?.length>1))}</calcite-block>`}_renderMoreResultsList(e,i){const{results:r}=e;if(!(r?.length??0)||!r)return null;const o=this._getSourceName(e.source,e.sourceIndex),h=r.filter(d=>d!==this._selectedResult).map(d=>this._renderListItem(d));return Ne`<calcite-list .label=${o}>${i?ai(`group-${e.sourceIndex}`,Ne`<calcite-list-item-group .heading=${o}>${h}</calcite-list-item-group>`):h}</calcite-list>`}_renderListItem(e){return ai(`result-${e.sourceIndex}-${e.key}`,Ne`<calcite-list-item .label=${e.name} @calciteListItemSelect=${()=>this._selectResult(e)}></calcite-list-item>`)}},pd.properties={_results:16,_resultCount:16,_selectedResult:16,_showMoreResultsOpen:16,messages:0,autoDestroyDisabled:5,viewModel:0},pd.styles=Mre,pd);XL("arcgis-search-result-renderer",kre);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Ks={buttonLoader:"calcite-button--loader",content:"content",contentSlotted:"content--slotted",icon:"icon",iconStart:"icon--start",iconEnd:"icon--end",loadingIn:"loading-in",loadingOut:"loading-out",iconStartEmpty:"icon-start-empty",iconEndEmpty:"icon-end-empty",buttonPadding:"button-padding",buttonPaddingShrunk:"button-padding--shrunk"},Are=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block;inline-size:auto;vertical-align:middle;border-radius:var(--calcite-button-corner-radius, var(--calcite-internal-button-corner-radius, 0))}:host a,:host button{--calcite-internal-button-content-margin: .5rem;--calcite-internal-button-padding-x: 7px;--calcite-internal-button-padding-y: 3px;position:relative;box-sizing:border-box;display:flex;block-size:100%;inline-size:100%;cursor:pointer;-webkit-user-select:none;user-select:none;appearance:none;align-items:center;justify-content:center;border-style:none;text-align:center;font-family:inherit;font-weight:var(--calcite-font-weight-normal);text-decoration-line:none;outline-color:transparent;box-shadow:var(--calcite-button-shadow, var(--calcite-shadow-none));background-color:var(--calcite-button-background-color, var(--calcite-internal-button-background-color, var(--calcite-color-transparent)));border-block-start-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-block-start-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-block-end-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-block-end-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-inline-start-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-inline-start-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-inline-end-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-inline-end-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-style:solid;border-width:var(--calcite-border-width-sm);border-radius:var(--calcite-button-corner-radius, var(--calcite-internal-button-corner-radius, 0));color:var(--calcite-button-text-color, var(--calcite-internal-button-text-color, currentColor));padding-block:var(--calcite-internal-button-padding-y);padding-inline:var(--calcite-internal-button-padding-x);transition:color var(--calcite-animation-timing) ease-in-out,background-color var(--calcite-animation-timing) ease-in-out,box-shadow var(--calcite-animation-timing) ease-in-out,outline-color var(--calcite-internal-animation-timing-fast) ease-in-out}:host a:hover,:host button:hover{text-decoration-line:none}:host a:focus,:host button:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(var(--calcite-spacing-base) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host a span,:host button span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host a calcite-loader,:host button calcite-loader{color:var(--calcite-button-loader-color, var(--calcite-internal-button-loader-color, var(--calcite-button-text-color, var(--calcite-internal-button-text-color))))}:host([round]){--calcite-internal-button-corner-radius: 50px}.content{margin-inline:var(--calcite-internal-button-content-margin)}.icon-start-empty .content{margin-inline-start:unset}.icon-end-empty .content{margin-inline-end:unset}:host([scale=m]) button,:host([scale=m]) a{--calcite-internal-button-content-margin: .75rem}:host([scale=l]) button,:host([scale=l]) a{--calcite-internal-button-content-margin: 1rem}:host([width=auto]){inline-size:auto}:host([width=half]){inline-size:50%}:host([width=full]){inline-size:100%}:host([alignment=center]:not([width=auto])) a,:host([alignment=center]:not([width=auto])) button{justify-content:center}:host([alignment=start]:not([width=auto])) a,:host([alignment=start]:not([width=auto])) button{justify-content:flex-start}:host([alignment=end]:not([width=auto])) a,:host([alignment=end]:not([width=auto])) button{justify-content:flex-end}:host([alignment*=space-between]:not([width=auto])) a,:host([alignment*=space-between]:not([width=auto])) button{justify-content:space-between}:host([alignment=icon-start-space-between]:not([width=auto])) .icon--start{margin-inline-end:auto}:host([alignment=icon-start-space-between]:not([width=auto])) a,:host([alignment=icon-start-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=icon-end-space-between]:not([width=auto])) .icon--end{margin-inline-start:auto}:host([alignment=icon-end-space-between]:not([width=auto])) a,:host([alignment=icon-end-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=center]) a:not(.content--slotted) .icon--start+.icon--end,:host([alignment=center]) button:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:var(--calcite-internal-button-content-margin)}.icon--start,.icon--end{color:var(--calcite-button-icon-color, var(--calcite-icon-color, var(--calcite-ui-icon-color)))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}@keyframes loader-in{0%{inline-size:0;opacity:0;transform:scale(.5)}to{inline-size:1em;opacity:1;transform:scale(1)}}@keyframes loader-out{0%{inline-size:1em;opacity:1;transform:scale(1)}to{inline-size:0;opacity:0;transform:scale(.5)}}.calcite-button--loader{display:flex}.calcite-button--loader calcite-loader{margin:0}:host([loading]) button.content--slotted .calcite-button--loader calcite-loader,:host([loading]) a.content--slotted .calcite-button--loader calcite-loader{margin-inline-end:var(--calcite-internal-button-content-margin)}:host([loading]) button:not(.content--slotted) .icon--start,:host([loading]) button:not(.content--slotted) .icon--end,:host([loading]) a:not(.content--slotted) .icon--start,:host([loading]) a:not(.content--slotted) .icon--end{display:none}:host([appearance]) button,:host([appearance]) a{--calcite-internal-button-border-color: var(--calcite-color-transparent);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([kind=brand]) button,:host([kind=brand]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=brand]) button:hover,:host([kind=brand]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-brand-hover)}:host([kind=brand]) button:active,:host([kind=brand]) a:active{--calcite-internal-button-background-color: var(--calcite-color-brand-press)}:host([kind=danger]) button,:host([kind=danger]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=danger]) button:hover,:host([kind=danger]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-status-danger-hover)}:host([kind=danger]) button:active,:host([kind=danger]) a:active{--calcite-internal-button-background-color: var(--calcite-color-status-danger-press)}:host([kind=neutral]) button,:host([kind=neutral]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-background-color: var(--calcite-color-foreground-3);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([kind=neutral]) button:hover,:host([kind=neutral]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-foreground-2)}:host([kind=neutral]) button:active,:host([kind=neutral]) a:active{--calcite-internal-button-background-color: var(--calcite-color-foreground-1)}:host([kind=inverse]) button,:host([kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=inverse]) button:hover,:host([kind=inverse]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-inverse-hover)}:host([kind=inverse]) button:active,:host([kind=inverse]) a:active{--calcite-internal-button-background-color: var(--calcite-color-inverse-press)}:host([appearance=outline-fill]) button,:host([appearance=outline-fill]) a{--calcite-internal-button-background-color: var(--calcite-color-foreground-1);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([appearance=outline-fill]) button:hover,:host([appearance=outline-fill]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-foreground-2)}:host([appearance=outline-fill]) button:active,:host([appearance=outline-fill]) a:active{--calcite-internal-button-background-color: var(--calcite-color-foreground-3)}:host([appearance=outline-fill][kind=brand]) button,:host([appearance=outline-fill][kind=brand]) a{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=brand]) button:hover,:host([appearance=outline-fill][kind=brand]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-brand-hover);--calcite-internal-button-text-color: var(--calcite-color-brand-hover)}:host([appearance=outline-fill][kind=brand]) button:focus,:host([appearance=outline-fill][kind=brand]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=brand]) button:active,:host([appearance=outline-fill][kind=brand]) a:active{--calcite-internal-button-border-color: var(--calcite-color-brand-press);--calcite-internal-button-text-color: var(--calcite-color-brand-press)}:host([appearance=outline-fill][kind=brand]) button calcite-loader,:host([appearance=outline-fill][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=danger]) button,:host([appearance=outline-fill][kind=danger]) a{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=danger]) button:hover,:host([appearance=outline-fill][kind=danger]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover)}:host([appearance=outline-fill][kind=danger]) button:focus,:host([appearance=outline-fill][kind=danger]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=danger]) button:active,:host([appearance=outline-fill][kind=danger]) a:active{--calcite-internal-button-border-color: var(--calcite-color-status-danger-press);--calcite-internal-button-text-color: var(--calcite-color-status-danger-press)}:host([appearance=outline-fill][kind=danger]) button calcite-loader,:host([appearance=outline-fill][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=neutral]) button,:host([appearance=outline-fill][kind=neutral]) a{--calcite-internal-button-border-color: var(--calcite-color-border-1);--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline-fill][kind=neutral]) button:hover,:host([appearance=outline-fill][kind=neutral]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-border-input)}:host([appearance=outline-fill][kind=neutral]) button:focus,:host([appearance=outline-fill][kind=neutral]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:active,:host([appearance=outline-fill][kind=neutral]) a:active{--calcite-internal-button-border-color: var(--calcite-color-text-3)}:host([appearance=solid][kind=neutral]) button:hover,:host([appearance=solid][kind=neutral]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-border-3)}:host([appearance=solid][kind=neutral]) button:active,:host([appearance=solid][kind=neutral]) a:active{--calcite-internal-button-background-color: var(--calcite-color-border-2)}:host([appearance=outline-fill][kind=inverse]) button,:host([appearance=outline-fill][kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline-fill][kind=inverse]) button:hover,:host([appearance=outline-fill][kind=inverse]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-inverse-hover)}:host([appearance=outline-fill][kind=inverse]) button:focus,:host([appearance=outline-fill][kind=inverse]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-inverse)}:host([appearance=outline-fill][kind=inverse]) button:active,:host([appearance=outline-fill][kind=inverse]) a:active{--calcite-internal-button-border-color: var(--calcite-color-inverse-press)}:host([appearance=outline]) button,:host([appearance=outline]) a{--calcite-internal-button-background-color: var(--calcite-color-transparent);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([appearance=outline]) button:hover,:host([appearance=outline]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-transparent-hover)}:host([appearance=outline]) button:active,:host([appearance=outline]) a:active{--calcite-internal-button-background-color: var(--calcite-color-transparent-press)}:host([appearance=outline][kind=brand]) button,:host([appearance=outline][kind=brand]) a{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline][kind=brand]) button:hover,:host([appearance=outline][kind=brand]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-brand-hover);--calcite-internal-button-text-color: var(--calcite-color-brand-hover)}:host([appearance=outline][kind=brand]) button:focus,:host([appearance=outline][kind=brand]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand)}:host([appearance=outline][kind=brand]) button:active,:host([appearance=outline][kind=brand]) a:active{--calcite-internal-button-border-color: var(--calcite-color-brand-press);--calcite-internal-button-text-color: var(--calcite-color-brand-press)}:host([appearance=outline][kind=brand]) button calcite-loader,:host([appearance=outline][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline][kind=danger]) button,:host([appearance=outline][kind=danger]) a{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=danger]) button:hover,:host([appearance=outline][kind=danger]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover)}:host([appearance=outline][kind=danger]) button:focus,:host([appearance=outline][kind=danger]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=danger]) button:active,:host([appearance=outline][kind=danger]) a:active{--calcite-internal-button-border-color: var(--calcite-color-status-danger-press);--calcite-internal-button-text-color: var(--calcite-color-status-danger-press)}:host([appearance=outline][kind=danger]) button calcite-loader,:host([appearance=outline][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=neutral]) button,:host([appearance=outline][kind=neutral]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-border-1);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline][kind=neutral]) button:hover,:host([appearance=outline][kind=neutral]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-border-input)}:host([appearance=outline][kind=neutral]) button:focus,:host([appearance=outline][kind=neutral]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-foreground-3)}:host([appearance=outline][kind=neutral]) button:active,:host([appearance=outline][kind=neutral]) a:active{--calcite-internal-button-border-color: var(--calcite-color-text-3)}:host([appearance=outline][kind=inverse]) button,:host([appearance=outline][kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline][kind=inverse]) button:hover,:host([appearance=outline][kind=inverse]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-inverse-hover)}:host([appearance=outline][kind=inverse]) button:focus,:host([appearance=outline][kind=inverse]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-inverse)}:host([appearance=outline][kind=inverse]) button:active,:host([appearance=outline][kind=inverse]) a:active{--calcite-internal-button-border-color: var(--calcite-color-inverse-press)}:host([appearance=outline-fill][split-child=primary]) button,:host([appearance=outline][split-child=primary]) button,:host([appearance=outline-fill][split-child=primary]) a,:host([appearance=outline][split-child=primary]) a{border-inline-end-width:0;border-inline-start-width:1px}:host([appearance=outline-fill][split-child=secondary]) button,:host([appearance=outline][split-child=secondary]) button,:host([appearance=outline-fill][split-child=secondary]) a,:host([appearance=outline][split-child=secondary]) a{border-inline-start-width:0;border-inline-end-width:1px}:host([appearance=transparent]) button,:host([appearance=transparent]) a{--calcite-internal-button-background-color: var(--calcite-color-transparent)}:host([appearance=transparent]) button:hover,:host([appearance=transparent]) button:focus,:host([appearance=transparent]) a:hover,:host([appearance=transparent]) a:focus{--calcite-internal-button-background-color: var(--calcite-color-transparent-hover)}:host([appearance=transparent]) button:active,:host([appearance=transparent]) a:active{--calcite-internal-button-background-color: var(--calcite-color-transparent-press)}:host([appearance=transparent]:not(.enable-editing-button)) button,:host([appearance=transparent]:not(.enable-editing-button)) a{background-color:var(--calcite-color-transparent)}:host([appearance=transparent]:not(.enable-editing-button)) button:hover,:host([appearance=transparent]:not(.enable-editing-button)) a:hover{background-color:var(--calcite-color-transparent-hover)}:host([appearance=transparent]:not(.enable-editing-button)) button:active,:host([appearance=transparent]:not(.enable-editing-button)) a:active{background-color:var(--calcite-color-transparent-press)}:host([appearance=transparent][kind=brand]) button,:host([appearance=transparent][kind=brand]) a{--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=brand]) button:hover,:host([appearance=transparent][kind=brand]) a:hover{--calcite-internal-button-text-color: var(--calcite-color-brand-hover)}:host([appearance=transparent][kind=brand]) button:focus,:host([appearance=transparent][kind=brand]) a:focus{--calcite-internal-button-text-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=brand]) button:active,:host([appearance=transparent][kind=brand]) a:active{--calcite-internal-button-text-color: var(--calcite-color-brand-press)}:host([appearance=transparent][kind=brand]) button calcite-loader,:host([appearance=transparent][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=danger]) button,:host([appearance=transparent][kind=danger]) a{--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=danger]) button:hover,:host([appearance=transparent][kind=danger]) a:hover{--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover)}:host([appearance=transparent][kind=danger]) button:focus,:host([appearance=transparent][kind=danger]) a:focus{--calcite-internal-button-text-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=danger]) button:active,:host([appearance=transparent][kind=danger]) a:active{--calcite-internal-button-text-color: var(--calcite-color-status-danger-press)}:host([appearance=transparent][kind=danger]) button calcite-loader,:host([appearance=transparent][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) button,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) a,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) calcite-loader{--calcite-internal-button-text-color: var(--calcite-color-text-1)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button{--calcite-internal-button-text-color: var(--calcite-color-text-3)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button:hover{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-padding-y: 0}:host(.confirm-changes-button) button:focus,:host(.cancel-editing-button) button:focus,:host(.enable-editing-button) button:focus{outline-offset:-2px}:host([appearance=transparent][kind=inverse]) button:hover,:host([appearance=transparent][kind=inverse]) a:hover{background-color:var(--calcite-color-transparent-inverse-hover)}:host([appearance=transparent][kind=inverse]) button:active,:host([appearance=transparent][kind=inverse]) a:active{background-color:var(--calcite-color-transparent-inverse-press)}:host([appearance=transparent][kind=inverse]) button calcite-loader,:host([appearance=transparent][kind=inverse]) a calcite-loader{--calcite-internal-button-text-color: var(--calcite-color-text-inverse)}:host([scale=s]) button.content--slotted,:host([scale=s]) a.content--slotted{font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s][appearance=transparent]) button.content--slotted,:host([scale=s][appearance=transparent]) a.content--slotted{--calcite-internal-button-padding-x: .5rem}:host([scale=s]) button,:host([scale=s]) a{--calcite-internal-button-padding-y: 3px}:host([scale=m]) button.content--slotted,:host([scale=m]) a.content--slotted{--calcite-internal-button-padding-x: 11px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) button,:host([scale=m]) a{--calcite-internal-button-padding-y: 7px}:host([scale=m][appearance=transparent]) button.content--slotted,:host([scale=m][appearance=transparent]) a.content--slotted{--calcite-internal-button-padding-x: .75rem}:host([scale=l]) button.content--slotted,:host([scale=l]) a.content--slotted{--calcite-internal-button-padding-x: 15px;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .button-padding{--calcite-internal-button-padding-x: 1rem;--calcite-internal-button-padding-y: 11px}:host([scale=l]) .button-padding--shrunk{--calcite-internal-button-padding-y: 9px}:host([scale=s]) button:not(.content--slotted),:host([scale=s]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 3px;inline-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:1.5rem}:host([scale=m]) button:not(.content--slotted),:host([scale=m]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 7px;inline-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2rem}:host([scale=l]) button:not(.content--slotted),:host([scale=l]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 9px;inline-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2.75rem}:host(:is([scale=s],[scale=m],[scale=l])[width=full]) a:not(.content--slotted),:host(:is([scale=s],[scale=m],[scale=l])[width=full]) button:not(.content--slotted){inline-size:var(--calcite-container-size-content-fluid)}:host([scale=l][appearance=transparent]) button:not(.content--slotted),:host([scale=l][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-y: .625rem}:host([scale=s][icon-start][icon-end]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 23px;block-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=s][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 1.5rem}:host([scale=m][icon-start][icon-end]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 2rem;block-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=m][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 33px}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 43px;block-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted) .icon--start+.icon--end,:host([scale=l][icon-start][icon-end]) a:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:1rem}:host([scale=l][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 2.75rem}:host([hidden]){display:none}[hidden]{display:none}`,O1=class O1 extends ji{constructor(){super(...arguments),this.attributeWatch=_$(["aria-expanded"],this.handleGlobalAttributesChanged),this.contentRef=Yn(),this.mutationObserver=qo("mutation",()=>this.updateHasContent()),this.resizeObserver=qo("resize",()=>this.setTooltipText()),this.focusSetter=zs()(this),this.messages=fo(),this.hasContent=!1,this.alignment="center",this.appearance="solid",this.disabled=!1,this.download=!1,this.kind="brand",this.loading=!1,this.round=!1,this.scale="m",this.splitChild=!1,this.type="button",this.width="auto"}async setFocus(e){return this.focusSetter(()=>this.childEl,e)}connectedCallback(){super.connectedCallback(),this.setupTextContentObserver(),X0(this),this.formEl=P$(this)}async load(){this.updateHasContent()}updated(){mo(this)}loaded(){this.setTooltipText()}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),D$(this),this.resizeObserver?.disconnect(),this.formEl=null}handleGlobalAttributesChanged(){this.requestUpdate()}updateHasContent(){this.hasContent=BW(this.el)}setupTextContentObserver(){this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}onLabelClick(){this.handleClick(),this.setFocus()}handleClick(){const{type:e}=this;this.href||(e==="submit"?lw(this):e==="reset"&&UR(this))}setTooltipText(){const{contentRef:{value:e}}=this;e&&(this.tooltipText=e.offsetWidth<e.scrollWidth&&this.el.innerText||null)}setChildEl(e){bx(this.resizeObserver,this.childEl,e),this.childEl=e}render(){const e=this.href?"a":"button",i=this.href?v0`a`:v0`button`,r=this.loading?Ne`<div class=${Fe(Ks.buttonLoader)}><calcite-loader class=${Fe(this.loading?Ks.loadingIn:Ks.loadingOut)} inline .label=${this.messages.loading} .scale=${this.scale==="l"?"m":"s"}></calcite-loader></div>`:null,o=!this.iconStart&&!this.iconEnd,h=Ne`<calcite-icon class=${Fe({[Ks.icon]:!0,[Ks.iconStart]:!0})} .flipRtl=${this.iconFlipRtl==="start"||this.iconFlipRtl==="both"} .icon=${this.iconStart} .scale=${Br(this.scale)}></calcite-icon>`,d=Ne`<calcite-icon class=${Fe({[Ks.icon]:!0,[Ks.iconEnd]:!0})} .flipRtl=${this.iconFlipRtl==="end"||this.iconFlipRtl==="both"} .icon=${this.iconEnd} .scale=${Br(this.scale)}></calcite-icon>`,a=Ne`<span class=${Fe(Ks.content)} ${hi(this.contentRef)}><slot></slot></span>`;return go({disabled:this.disabled,children:k$`<${i} .ariaBusy=${this.loading} .ariaExpanded=${this.el.ariaExpanded?this.el.ariaExpanded:null} .ariaLabel=${this.loading?this.messages.loading:Ox(this)} aria-live=polite class=${Fe({[Ks.buttonPadding]:o,[Ks.buttonPaddingShrunk]:!o,[Ks.contentSlotted]:this.hasContent,[Ks.iconStartEmpty]:!this.iconStart,[Ks.iconEndEmpty]:!this.iconEnd})} .disabled=${e==="button"?this.disabled:null} download=${(e==="a"?this.download===!0||this.download===""?"":this.download||null:null)??ut} href=${(e==="a"&&this.href)??ut} name=${(e==="button"&&this.name)??ut} @click=${this.handleClick} rel=${(e==="a"&&this.rel)??ut} tabindex=${(this.disabled?-1:null)??ut} target=${(e==="a"&&this.target)??ut} title=${this.tooltipText??ut} type=${(e==="button"?this.type:null)??ut} ${hi(this.setChildEl)}>${r}${this.iconStart?h:null}${this.hasContent?a:null}${this.iconEnd?d:null}</${i}>`})}};O1.properties={hasContent:[16,{},{state:!0}],tooltipText:[16,{},{state:!0}],alignment:[3,{},{reflect:!0}],appearance:[3,{},{reflect:!0}],disabled:[7,{},{reflect:!0,type:Boolean}],download:[3,{converter:_d},{reflect:!0}],form:[3,{},{reflect:!0}],href:[3,{},{reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],kind:[3,{},{reflect:!0}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}],name:[3,{},{reflect:!0}],rel:[3,{},{reflect:!0}],round:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],splitChild:[3,{},{reflect:!0}],target:[3,{},{reflect:!0}],type:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]},O1.styles=Are;let hE=O1;ar("calcite-button",hE);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Dre={textMatch:"text-match"};function _5({text:t,pattern:e}){if(!e||!t)return t;const i=t.split(e);return i.length>1&&(i[1]=Ne`<mark class=${Fe(Dre.textMatch)}>${i[1]}</mark>`),i}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const ru={container:"container",containerActive:"container--active",contentCenter:"content-center",description:"description",heading:"heading",iconEnd:"icon-end",iconStart:"icon-start",scale:t=>`scale--${t}`},v5={contentEnd:"content-end",contentStart:"content-start"},zre="autocomplete-item",Ore={host:t=>`${zre}-${t}`},Rre=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}.scale--s{font-size:var(--calcite-font-size--2);line-height:1rem;--calcite-internal-autocomplete-item-spacing-unit-l: .5rem;--calcite-internal-autocomplete-item-spacing-unit-s: .25rem;--calcite-internal-autocomplete-item-description-font-size: var(--calcite-font-size-xs)}.scale--m{font-size:var(--calcite-font-size--1);line-height:1rem;--calcite-internal-autocomplete-item-spacing-unit-l: .75rem;--calcite-internal-autocomplete-item-spacing-unit-s: .375rem;--calcite-internal-autocomplete-item-description-font-size: var(--calcite-font-size-sm)}.scale--l{font-size:var(--calcite-font-size-0);line-height:1.25rem;--calcite-internal-autocomplete-item-spacing-unit-l: 1rem;--calcite-internal-autocomplete-item-spacing-unit-s: .625rem;--calcite-internal-autocomplete-item-description-font-size: var(--calcite-font-size)}:host{display:flex}.container{position:relative;box-sizing:border-box;display:flex;inline-size:100%;min-inline-size:100%;cursor:pointer;align-items:center;outline-color:transparent;background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-1));color:var(--calcite-autocomplete-text-color, var(--calcite-color-text-3));gap:var(--calcite-internal-autocomplete-item-spacing-unit-l);padding-inline:var(--calcite-internal-autocomplete-item-spacing-unit-l);padding-block:var(--calcite-internal-autocomplete-item-spacing-unit-s);word-wrap:break-word;word-break:break-word;justify-content:space-around}.description{color:var(--calcite-autocomplete-description-text-color);font-size:var(--calcite-internal-autocomplete-item-description-font-size)}.heading{color:var(--calcite-autocomplete-heading-text-color, var(--calcite-color-text-1))}.heading,.description{line-height:var(--calcite-font-line-height-relative-snug)}:host(:hover:not([disabled])) .container{background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-2))}:host(:hover:not([disabled])) .container .description{color:var(--calcite-autocomplete-description-text-color, var(--calcite-color-text-2))}.container--active{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.content-center{display:flex;flex-direction:column;flex-grow:1;padding-block:0}.text-match{background-color:transparent;color:inherit;font-weight:var(--calcite-font-weight-bold)}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}`,R1=class R1 extends ji{constructor(){super(...arguments),this.active=!1,this.disabled=!1,this.guid=Ore.host(Hu()),this.scale="m",this.calciteAutocompleteItemSelect=vt({cancelable:!1})}emitSelectEvent(){this.calciteAutocompleteItemSelect.emit()}updated(){mo(this)}handleClick(e){e.preventDefault(),this.emitSelectEvent()}render(){const{active:e,description:i,heading:r,disabled:o,inputValueMatchPattern:h}=this;return go({disabled:o,children:Ne`<div class=${Fe({[ru.container]:!0,[ru.containerActive]:e&&!o,[ru.scale(this.scale)]:!0})} @click=${this.handleClick}>${this.renderIcon("start")}<slot name=${v5.contentStart}></slot><div class=${Fe(ru.contentCenter)}><div class=${Fe(ru.heading)}>${_5({text:r,pattern:h})}</div><div class=${Fe(ru.description)}>${_5({text:i,pattern:h})}</div></div><slot name=${v5.contentEnd}></slot>${this.renderIcon("end")}</div>`})}renderIcon(e){const{iconFlipRtl:i}=this,r=e==="start"?this.iconStart:this.iconEnd;return r?Ne`<calcite-icon class=${Fe(e==="start"?ru.iconStart:ru.iconEnd)} .flipRtl=${i===e||i==="both"} .icon=${r} .scale=${Br(this.scale)}></calcite-icon>`:null}};R1.properties={active:[5,{},{type:Boolean}],description:1,disabled:[7,{},{reflect:!0,type:Boolean}],guid:1,heading:1,iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],inputValueMatchPattern:[2,{},{reflect:!0,attribute:!1}],label:1,scale:1,value:1},R1.styles=Rre;let dE=R1;ar("calcite-autocomplete-item",dE);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const b5=(t,e,i)=>{const r=new Map;for(let o=e;o<=i;o++)r.set(t[o],o);return r},Lre=xm(class extends wm{constructor(t){if(super(t),t.type!==ol.CHILD)throw Error("repeat() can only be used in text expressions")}dt(t,e,i){let r;i===void 0?i=e:e!==void 0&&(r=e);const o=[],h=[];let d=0;for(const a of t)o[d]=r?r(a,d):d,h[d]=i(a,d),d++;return{values:h,keys:o}}render(t,e,i){return this.dt(t,e,i).values}update(t,[e,i,r]){const o=DZ(t),{values:h,keys:d}=this.dt(e,i,r);if(!Array.isArray(o))return this.ut=d,h;const a=this.ut??=[],_=[];let T,E,k=0,L=o.length-1,O=0,H=h.length-1;for(;k<=L&&O<=H;)if(o[k]===null)k++;else if(o[L]===null)L--;else if(a[k]===d[O])_[O]=kh(o[k],h[O]),k++,O++;else if(a[L]===d[H])_[H]=kh(o[L],h[H]),L--,H--;else if(a[k]===d[H])_[H]=kh(o[k],h[H]),Wg(t,_[H+1],o[k]),k++,H--;else if(a[L]===d[O])_[O]=kh(o[L],h[O]),Wg(t,o[k],o[L]),L--,O++;else if(T===void 0&&(T=b5(d,O,H),E=b5(a,k,L)),T.has(a[k]))if(T.has(a[L])){const re=E.get(d[O]),pe=re!==void 0?o[re]:null;if(pe===null){const ge=Wg(t,o[k]);kh(ge,h[O]),_[O]=ge}else _[O]=kh(pe,h[O]),Wg(t,o[k],pe),o[re]=null;O++}else TS(o[L]),L--;else TS(o[k]),k++;for(;O<=H;){const re=Wg(t,_[H+1]);kh(re,h[O]),_[O++]=re}for(;k<=L;){const re=o[k++];re!==null&&TS(re)}return this.ut=d,m$(t,_),lo}});/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Fre=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{position:relative;display:block}.input-container{position:relative;display:flex;flex:1 1 auto;flex-wrap:nowrap}.input{width:100%;--calcite-input-prefix-size: var(--calcite-autocomplete-input-prefix-size);--calcite-input-suffix-size: var(--calcite-autocomplete-input-suffix-size);--calcite-input-background-color: var(--calcite-autocomplete-input-background-color);--calcite-input-border-color: var(--calcite-autocomplete-input-border-color);--calcite-input-corner-radius: var(--calcite-autocomplete-input-corner-radius);--calcite-input-shadow: var(--calcite-autocomplete-input-shadow);--calcite-input-icon-color: var(--calcite-autocomplete-input-icon-color);--calcite-input-text-color: var(--calcite-autocomplete-input-text-color);--calcite-input-placeholder-text-color: var(--calcite-autocomplete-input-placeholder-text-color);--calcite-input-actions-background-color: var(--calcite-autocomplete-input-actions-background-color);--calcite-input-actions-background-color-hover: var(--calcite-autocomplete-input-actions-background-color-hover);--calcite-input-actions-background-color-press: var(--calcite-autocomplete-input-actions-background-color-press);--calcite-input-actions-icon-color: var(--calcite-autocomplete-input-actions-icon-color);--calcite-input-actions-icon-color-hover: var(--calcite-autocomplete-input-actions-icon-color-hover);--calcite-input-actions-icon-color-press: var(--calcite-autocomplete-input-actions-icon-color-press);--calcite-input-loading-background-color: var(--calcite-autocomplete-input-loading-background-color);--calcite-input-loading-fill-color: var(--calcite-autocomplete-input-loading-fill-color);--calcite-input-prefix-background-color: var(--calcite-autocomplete-input-prefix-background-color);--calcite-input-prefix-text-color: var(--calcite-autocomplete-input-prefix-text-color);--calcite-input-suffix-background-color: var(--calcite-autocomplete-input-suffix-background-color);--calcite-input-suffix-text-color: var(--calcite-autocomplete-input-suffix-text-color)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.content-container{box-sizing:border-box;width:100%}.floating-ui-container{--calcite-floating-ui-z-index: var(--calcite-z-index-dropdown);inline-size:max-content;display:none;max-inline-size:100vw;max-block-size:100vh;inset-block-start:0;left:0;z-index:var(--calcite-floating-ui-z-index)}@starting-style{.floating-ui-container{opacity:0;inset-block-start:0;left:0}}.floating-ui-container .calcite-floating-ui-anim{position:relative;transition-duration:var(--calcite-floating-ui-transition);transition-property:inset-block-start,left,opacity,display;transition-behavior:allow-discrete;opacity:0;box-shadow:0 0 16px #00000029;z-index:var(--calcite-z-index);border-radius:.25rem}.floating-ui-container[data-placement^=bottom] .calcite-floating-ui-anim{inset-block-start:-5px}.floating-ui-container[data-placement^=top] .calcite-floating-ui-anim{inset-block-start:5px}.floating-ui-container[data-placement^=left] .calcite-floating-ui-anim{left:5px}.floating-ui-container[data-placement^=right] .calcite-floating-ui-anim{left:-5px}.floating-ui-container[data-placement] .calcite-floating-ui-anim--active{opacity:1;inset-block-start:0;left:0}@starting-style{.floating-ui-container[data-placement] .calcite-floating-ui-anim--active{opacity:0}}.content-container .calcite-floating-ui-anim{max-height:45vh;width:100%;overflow-y:auto;color:var(--calcite-autocomplete-text-color, var(--calcite-color-text-1));background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-1));border-radius:var(--calcite-autocomplete-corner-radius, var(--calcite-corner-radius-round))}.content--hidden{display:none}@media (forced-colors: active){.floating-ui-container--active{border:1px solid canvasText}}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.internal-label-alignment--center{align-items:center}.internal-label-alignment--end{align-items:end}.internal-label--container{display:flex;justify-content:space-between;color:var(--calcite-color-text-1)}.internal-label-required--indicator{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-status-danger);padding-inline:var(--calcite-spacing-base)}.internal-label-required--indicator:hover{cursor:help}.internal-label--text{line-height:1}:host([scale=s]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-xxs)}:host([scale=s]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label--text{font-size:var(--calcite-font-size--2)}:host([scale=m]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label--text{font-size:var(--calcite-font-size--1)}:host([scale=l]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=l]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-md)}:host([scale=l]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-md)}:host([scale=l]) .internal-label--text{font-size:var(--calcite-font-size-0)}.validation-container{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch}:host([scale=m]) .validation-container,:host([scale=l]) .validation-container{padding-block-start:.5rem}:host([scale=s]) .validation-container{padding-block-start:.25rem}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}`,x5={contentBottom:"content-bottom",contentTop:"content-top"},Kl={inputContainer:"input-container",input:"input",contentContainer:"content-container",contentAnimation:"content-animation",content:"content",contentHidden:"content--hidden",floatingUIContainer:"floating-ui-container",floatingUIContainerActive:"floating-ui-container--active",screenReadersOnly:"screen-readers-only"},w5="autocomplete",dT={validationMessage:"autocompleteValidationMessage",input:t=>`${w5}-input-${t}`,list:t=>`${w5}-list-${t}`},Nre="calcite-autocomplete-item-group",Bre="calcite-autocomplete-item",L1=class L1 extends ji{constructor(){super(),this.guid=Hu(),this.attributeWatch=_$(["autofocus","enterkeyhint","inputmode"],this.handleGlobalAttributesChanged),this.inputId=dT.input(this.guid),this.listId=dT.list(this.guid),this.messages=fo(),this.transitionProp="opacity",this.mutationObserver=qo("mutation",()=>this.getAllItemsDebounced()),this.focusSetter=zs()(this),this.resizeObserver=qo("resize",()=>{this.setFloatingElSize()}),this.cancelable=z$()(this),this.getAllItemsDebounced=sw(this.getAllItems,0),this.activeDescendant="",this.activeIndex=-1,this.hasContentBottom=!1,this.hasContentTop=!1,this.items=[],this.groups=[],this.alignment="start",this.disabled=!1,this.iconFlipRtl=!1,this.loading=!1,this.open=!1,this.overlayPositioning="absolute",this.placement=y0,this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.value="",this.calciteAutocompleteBeforeClose=vt({cancelable:!1}),this.calciteAutocompleteBeforeOpen=vt({cancelable:!1}),this.calciteAutocompleteChange=vt({cancelable:!1}),this.calciteAutocompleteClose=vt({cancelable:!1}),this.calciteAutocompleteOpen=vt({cancelable:!1}),this.calciteAutocompleteTextChange=vt({cancelable:!1}),this.calciteAutocompleteTextInput=vt({cancelable:!1}),this.listenOn(document,"click",this.documentClickHandler),this.listen("calciteAutocompleteItemSelect",this.handleAutocompleteItemSelect)}get isOpen(){return this.open&&(this.hasContentTop||this.hasContentBottom||this.items.length>0)}get enabledItems(){return this.items.filter(e=>!e.disabled)}async reposition(e=!1){const{floatingEl:i,referenceEl:r,placement:o,overlayPositioning:h,flipPlacements:d}=this;return T$(this,{floatingEl:i,referenceEl:r,overlayPositioning:h,placement:o,flipPlacements:d,type:"menu"},e)}async scrollContentTo(e){this.transitionEl?.scrollTo(e)}async selectText(){return this.referenceEl.selectText()}async setFocus(e){return this.focusSetter(()=>this.referenceEl,e)}connectedCallback(){super.connectedCallback(),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0}),X0(this),VR(this),this.defaultInputValue=this.inputValue||"",this.getAllItemsDebounced(),dc(this),this.cancelable.add(this.getAllItemsDebounced)}async load(){this.getAllItemsDebounced()}willUpdate(e){e.has("disabled")&&(this.hasUpdated||this.disabled!==!1)&&this.handleDisabledChange(this.disabled),e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler(),(e.has("flipPlacements")||e.has("overlayPositioning")&&(this.hasUpdated||this.overlayPositioning!=="absolute")||e.has("placement")&&(this.hasUpdated||this.placement!==y0))&&this.reposition(!0);let i=!1;e.has("inputValue")&&(this.hasUpdated||this.inputValue)&&(this.inputValueMatchPattern=this.inputValue&&new RegExp(`(${cL(this.inputValue)})`,"i"),this.updateItems(),this.updateGroups(),i=!0),!i&&e.has("scale")&&(this.hasUpdated||this.scale!=="m")&&(this.updateItems(),this.updateGroups(),i=!0),!i&&e.has("activeIndex")&&(this.hasUpdated||this.activeIndex!==-1)&&this.updateItems()}updated(){mo(this)}loaded(){CX(this,this.value||""),this.defaultInputValue=this.inputValue||"",dc(this)}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.resizeObserver?.disconnect(),D$(this),GR(this),ow(this)}setFloatingElSize(){const{referenceEl:e,floatingEl:i}=this;!e||!i||(i.style.inlineSize=`${e.clientWidth}px`)}handleGlobalAttributesChanged(){this.requestUpdate()}handleDisabledChange(e){e||(this.open=!1)}openHandler(){if(Y0(this),this.open||(this.activeIndex=-1),this.disabled){this.open=!1;return}this.setFloatingElSize(),this.reposition(!0)}async documentClickHandler(e){this.disabled||e.composedPath().includes(this.el)||(this.open=!1)}async handleAutocompleteItemSelect(e){this.value=e.target.value,this.emitChange(),await this.setFocus(),this.open=!1}onLabelClick(){this.setFocus()}onFormReset(){this.inputValue=this.defaultInputValue}onBeforeOpen(){this.calciteAutocompleteBeforeOpen.emit()}onOpen(){this.calciteAutocompleteOpen.emit()}onBeforeClose(){this.calciteAutocompleteBeforeClose.emit()}onClose(){this.calciteAutocompleteClose.emit()}emitChange(){this.calciteAutocompleteChange.emit()}updateGroups(){this.groups.forEach((e,i,r)=>{e.scale=this.scale,i===0&&(e.disableSpacing=!0);const o=r[i+1];o&&(o.disableSpacing=e.children.length===0)})}updateItems(){let e=null;this.items.forEach(i=>{i.scale=this.scale,i.inputValueMatchPattern=this.inputValueMatchPattern}),this.enabledItems.forEach((i,r)=>{const o=r===this.activeIndex;o&&(e=i.guid),i.active=o}),this.activeDescendant=e}handleInputFocus(){this.open=!0}handleContentTopSlotChange(e){this.hasContentTop=Cr(e)}handleContentBottomSlotChange(e){this.hasContentBottom=Cr(e)}getAllItems(){const{el:e}=this;this.groups=Array.from(e.querySelectorAll(Nre)),this.items=Array.from(e.querySelectorAll(Bre)),this.updateItems(),this.updateGroups()}setReferenceEl(e){bx(this.resizeObserver,this.referenceEl,e),this.referenceEl=e,dc(this)}keyDownHandler(e){const{defaultPrevented:i,key:r}=e;if(i)return;const{open:o,activeIndex:h,enabledItems:d}=this,a=d.length&&h>-1?d[h]:null;switch(r){case"Escape":o&&(this.open=!1,e.preventDefault());break;case"Tab":this.open=!1;break;case"Enter":o&&a?(this.value=a.value,a.emitSelectEvent(),this.open=!1,e.preventDefault()):e.defaultPrevented||lw(this)&&e.preventDefault();break;case"ArrowDown":d.length&&(this.open=!0,this.activeIndex=h!==-1?Math.min(h+1,d.length-1):0,this.scrollToActiveItem(),e.preventDefault());break;case"ArrowUp":d.length&&(this.open=!0,this.activeIndex=h!==-1?Math.max(h-1,0):d.length-1,this.scrollToActiveItem(),e.preventDefault());break;case"Home":d.length&&(this.open=!0,this.activeIndex=0,this.scrollToActiveItem(),e.preventDefault());break;case"End":d.length&&(this.open=!0,this.activeIndex=d.length-1,this.scrollToActiveItem(),e.preventDefault());break}}scrollToActiveItem(){this.enabledItems[this.activeIndex]?.scrollIntoView({block:"nearest"})}changeHandler(e){e.stopPropagation(),this.inputValue=e.target.value,this.calciteAutocompleteTextChange.emit()}inputClickHandler(e){e.defaultPrevented||(this.open=!0)}inputHandler(e){e.stopPropagation(),this.inputValue=e.target.value,this.open=this.inputValue?.length>0,this.calciteAutocompleteTextInput.emit()}setFloatingEl(e){this.floatingEl=e,dc(this)}setTransitionEl(e){e&&(this.transitionEl=e)}render(){const{disabled:e,listId:i,inputId:r,isOpen:o}=this,h=this.el.autofocus,d=this.el.enterKeyHint,a=this.el.inputMode;return go({disabled:e,children:Ne`${this.labelText&&oL({labelText:this.labelText,onClick:this.onLabelClick,required:this.required,tooltipText:this.messages.required})||""}<div class=${Fe(Kl.inputContainer)}><calcite-input .alignment=${this.alignment} aria-activedescendant=${this.activeDescendant??ut} aria-controls=${i??ut} aria-label=${Ox(this)??ut} aria-owns=${i??ut} aria-autocomplete=list .ariaExpanded=${o} aria-haspopup=listbox .autocomplete=${this.autocomplete} .autofocus=${h} class=${Fe(Kl.input)} clearable .disabled=${e} enterkeyhint=${d??ut} .form=${this.form} .icon=${this.icon??!0} .iconFlipRtl=${this.iconFlipRtl} id=${r??ut} inputmode=${a??ut} .label=${this.label} .loading=${this.loading} .maxLength=${this.maxLength} .messageOverrides=${this.messages} .minLength=${this.minLength} .name=${this.name} @click=${this.inputClickHandler} @keydown=${this.keyDownHandler} @calciteInputChange=${this.changeHandler} @calciteInputInput=${this.inputHandler} @calciteInternalInputFocus=${this.handleInputFocus} .pattern=${this.pattern} .placeholder=${this.placeholder} .prefixText=${this.prefixText} .readOnly=${this.readOnly} .required=${this.required} role=combobox .scale=${this.scale} .status=${this.status} .suffixText=${this.suffixText} type=search .value=${this.inputValue} ${hi(this.setReferenceEl)}></calcite-input>${this.renderListBox()}<div class=${Fe({[Kl.contentContainer]:!0,[Kl.floatingUIContainer]:!0,[Kl.floatingUIContainerActive]:o})} ${hi(this.setFloatingEl)}><div class=${Fe({[Kl.contentAnimation]:!0,[rm.animation]:!0,[rm.animationActive]:o})} ${hi(this.setTransitionEl)}><div class=${Fe({[Kl.content]:!0,[Kl.contentHidden]:!o})}><slot name=${x5.contentTop} @slotchange=${this.handleContentTopSlotChange}></slot><slot aria-hidden=true></slot><slot name=${x5.contentBottom} @slotchange=${this.handleContentBottomSlotChange}></slot></div></div></div></div>${HR({component:this})}${this.validationMessage&&this.status==="invalid"?aL({icon:this.validationIcon,id:dT.validationMessage,message:this.validationMessage,scale:this.scale,status:this.status}):null}`})}renderListBox(){return Ne`<ul aria-labelledby=${this.inputId??ut} aria-live=polite class=${Fe(Kl.screenReadersOnly)} id=${this.listId??ut} role=listbox tabindex=-1>${this.renderListBoxOptions()}</ul>`}renderListBoxOptions(){return Lre(this.items.filter(e=>!!(e.label||e.heading)),e=>e.guid,e=>Ne`<li .ariaDisabled=${e.disabled} .ariaLabel=${e.label} id=${e.guid??ut} role=option tabindex=-1>${e.heading}${e.description}</li>`)}};L1.properties={activeDescendant:[16,{},{state:!0}],activeIndex:[16,{},{state:!0}],hasContentBottom:[16,{},{state:!0}],hasContentTop:[16,{},{state:!0}],items:[16,{},{state:!0}],groups:[16,{},{state:!0}],alignment:[3,{},{reflect:!0}],autocomplete:[0,{},{attribute:!1}],disabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],form:[3,{},{reflect:!0}],icon:[3,{converter:_d},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],inputValue:1,label:1,labelText:1,loading:[7,{},{reflect:!0,type:Boolean}],maxLength:[11,{},{reflect:!0,type:Number}],messageOverrides:[0,{},{attribute:!1}],minLength:[11,{},{reflect:!0,type:Number}],name:[3,{},{reflect:!0}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],pattern:1,placeholder:1,placement:[3,{},{reflect:!0}],prefixText:1,readOnly:[7,{},{reflect:!0,type:Boolean}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}],suffixText:1,validationIcon:[3,{converter:_d},{reflect:!0}],validationMessage:1,validity:[0,{},{attribute:!1}],value:1},L1.styles=Fre;let pE=L1;ar("calcite-autocomplete",pE);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Zv={container:"container",containerNoSpacing:"container--no-spacing",heading:"heading",scale:t=>`scale--${t}`},jre=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}.scale--s{font-size:var(--calcite-font-size--2);line-height:1rem;--calcite-internal-autocomplete-item-group-spacing-unit: .5rem}.scale--m{font-size:var(--calcite-font-size--1);line-height:1rem;--calcite-internal-autocomplete-item-group-spacing-unit: .75rem}.scale--l{font-size:var(--calcite-font-size-0);line-height:1.25rem;--calcite-internal-autocomplete-item-group-spacing-unit: 1rem}:host{margin:0;display:flex;flex-direction:column}.container{display:flex;flex-direction:column;background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-1));padding-block-start:var(--calcite-internal-autocomplete-item-group-spacing-unit)}.container--no-spacing{padding-block-start:0}.heading{border:0 solid;box-sizing:border-box;inline-size:100%;min-inline-size:0px;max-inline-size:100%;border-block-end-width:1px;font-weight:var(--calcite-font-weight-bold);word-wrap:break-word;word-break:break-word;color:var(--calcite-autocomplete-text-color, var(--calcite-color-text-2));border-block-end-color:var(--calcite-autocomplete-border-color, var(--calcite-color-border-3));padding-block:var(--calcite-internal-autocomplete-item-group-spacing-unit);padding-inline:var(--calcite-internal-autocomplete-item-group-spacing-unit)}:host([hidden]){display:none}[hidden]{display:none}`,F1=class F1 extends ji{constructor(){super(...arguments),this.disableSpacing=!1,this.scale="m"}render(){const{scale:e}=this;return Ne`<div aria-label=${this.label??this.heading??Ou} class=${Fe({[Zv.container]:!0,[Zv.containerNoSpacing]:this.disableSpacing,[Zv.scale(e)]:!0})} role=group><div class=${Fe(Zv.heading)} role=presentation>${this.heading}</div><slot></slot></div>`}};F1.properties={disableSpacing:[5,{},{type:Boolean}],heading:1,label:1,scale:1},F1.styles=jre;let fE=F1;ar("calcite-autocomplete-item-group",fE);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const S5={brand:"lightbulb",danger:"exclamationMarkTriangle",info:"information",success:"checkCircle",warning:"exclamationMarkTriangle"};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Wv={title:"title",message:"message",link:"link",actionsEnd:"actions-end"},ny={actionsEnd:"actions-end",close:"notice-close",container:"container",content:"notice-content",icon:"notice-icon"},Ure=Ui`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([scale=s]){--calcite-notice-spacing-token-small: .5rem;--calcite-notice-spacing-token-large: .75rem}:host([scale=s]) .container slot[name=title]::slotted(*),:host([scale=s]) .container *::slotted([slot=title]){margin-block:.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=s]) .container slot[name=message]::slotted(*),:host([scale=s]) .container *::slotted([slot=message]){margin-block:.125rem;font-size:var(--calcite-font-size--2);line-height:1.375}:host([scale=s]) ::slotted(calcite-link){margin-block:.125rem;font-size:var(--calcite-font-size--2);line-height:1.375}:host([scale=s]) .notice-close{padding:.5rem}:host([scale=m]){--calcite-notice-spacing-token-small: .75rem;--calcite-notice-spacing-token-large: 1rem}:host([scale=m]) .container slot[name=title]::slotted(*),:host([scale=m]) .container *::slotted([slot=title]){margin-block:.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([scale=m]) .container slot[name=message]::slotted(*),:host([scale=m]) .container *::slotted([slot=message]){margin-block:.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=m]) ::slotted(calcite-link){margin-block:.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=l]){--calcite-notice-spacing-token-small: 1rem;--calcite-notice-spacing-token-large: 1.25rem}:host([scale=l]) .container slot[name=title]::slotted(*),:host([scale=l]) .container *::slotted([slot=title]){margin-block:.125rem;font-size:var(--calcite-font-size-1);line-height:1.375}:host([scale=l]) .container slot[name=message]::slotted(*),:host([scale=l]) .container *::slotted([slot=message]){margin-block:.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([scale=l]) ::slotted(calcite-link){margin-block:.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([width=auto]){--calcite-notice-width: auto}:host([width=half]){--calcite-notice-width: 50%}:host([width=full]){--calcite-notice-width: 100%}:host{margin-inline:auto;display:none;max-inline-size:100%;align-items:center;inline-size:var(--calcite-notice-width)}.container{pointer-events:none;margin-block:0px;box-sizing:border-box;display:flex;inline-size:100%;opacity:0;overflow:hidden;max-block-size:0;transition-property:opacity,max-block-size;transition-duration:var(--calcite-animation-timing);text-align:start;border-inline-start:var(--calcite-border-width-md) solid;box-shadow:0 0 0 0 transparent;background-color:var(--calcite-notice-background-color, var(--calcite-color-foreground-1))}.notice-close{outline-color:transparent}.notice-close:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host{display:flex}:host([open]) .container{pointer-events:auto;max-block-size:100%;align-items:center;opacity:1;--tw-shadow: 0 4px 8px -1px rgba(0, 0, 0, .08), 0 2px 4px -1px rgba(0, 0, 0, .04);--tw-shadow-colored: 0 4px 8px -1px var(--tw-shadow-color), 0 2px 4px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow);overflow:visible}.container slot[name=title]::slotted(*),.container *::slotted([slot=title]){margin:0;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-notice-title-text-color, var(--calcite-color-text-1))}.container slot[name=message]::slotted(*),.container *::slotted([slot=message]){margin:0;display:inline;font-weight:var(--calcite-font-weight-normal);margin-inline-end:var(--calcite-notice-spacing-token-small);color:var(--calcite-notice-content-text-color, var(--calcite-color-text-2))}.notice-content{box-sizing:border-box;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto;display:flex;min-inline-size:0px;flex-direction:column;overflow-wrap:break-word;flex:1 1 0;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:0 var(--calcite-notice-spacing-token-small)}.notice-content:first-of-type:not(:only-child){padding-inline-start:var(--calcite-notice-spacing-token-large)}.notice-content:only-of-type{padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large)}.notice-icon{display:flex;align-items:center;box-sizing:border-box;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto}.notice-close{display:flex;cursor:pointer;align-items:center;align-self:stretch;border-style:none;background-color:transparent;outline:2px solid transparent;outline-offset:2px;box-sizing:border-box;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto;-webkit-appearance:none;color:var(--calcite-notice-close-icon-color, var(--calcite-color-text-3))}.notice-close:hover,.notice-close:focus{background-color:var(--calcite-notice-close-background-color-focus, var(--calcite-color-foreground-2));color:var(--calcite-notice-close-icon-color-hover, var(--calcite-color-text-1))}.notice-close:active{background-color:var(--calcite-notice-close-background-color-press, var(--calcite-color-foreground-3))}.actions-end{display:flex;align-self:stretch}:host([kind=brand]) .container{border-color:var(--calcite-color-brand)}:host([kind=brand]) .container .notice-icon{color:var(--calcite-color-brand)}:host([kind=info]) .container{border-color:var(--calcite-color-status-info)}:host([kind=info]) .container .notice-icon{color:var(--calcite-color-status-info)}:host([kind=danger]) .container{border-color:var(--calcite-color-status-danger)}:host([kind=danger]) .container .notice-icon{color:var(--calcite-color-status-danger)}:host([kind=success]) .container{border-color:var(--calcite-color-status-success)}:host([kind=success]) .container .notice-icon{color:var(--calcite-color-status-success)}:host([kind=warning]) .container{border-color:var(--calcite-color-status-warning)}:host([kind=warning]) .container .notice-icon{color:var(--calcite-color-status-warning)}:host([hidden]){display:none}[hidden]{display:none}`,N1=class N1 extends ji{constructor(){super(...arguments),this.closeButton=Yn(),this.transitionProp="opacity",this.messages=fo(),this.focusSetter=zs()(this),this.hasActionEnd=!1,this.closable=!1,this.iconFlipRtl=!1,this.kind="brand",this.open=!1,this.scale="m",this.width="auto",this.calciteNoticeBeforeClose=vt({cancelable:!1}),this.calciteNoticeBeforeOpen=vt({cancelable:!1}),this.calciteNoticeClose=vt({cancelable:!1}),this.calciteNoticeOpen=vt({cancelable:!1})}async setFocus(e){return this.focusSetter(()=>this.el.querySelector("calcite-link")||this.closeButton.value,e)}async load(){this.requestedIcon=em(S5,this.icon,this.kind)}willUpdate(e){e.has("open")&&(this.hasUpdated||this.open!==!1)&&Y0(this),(e.has("icon")||e.has("kind")&&(this.hasUpdated||this.kind!=="brand"))&&(this.requestedIcon=em(S5,this.icon,this.kind))}onBeforeClose(){this.calciteNoticeBeforeClose.emit()}onBeforeOpen(){this.calciteNoticeBeforeOpen.emit()}onClose(){this.calciteNoticeClose.emit()}onOpen(){this.calciteNoticeOpen.emit()}setTransitionEl(e){e&&(this.transitionEl=e)}close(){this.open=!1}handleActionsEndSlotChange(e){this.hasActionEnd=Cr(e)}render(){const e=Ne`<button .ariaLabel=${this.messages.close} class=${Fe(ny.close)} @click=${this.close} ${hi(this.closeButton)}><calcite-icon icon=x .scale=${Br(this.scale)}></calcite-icon></button>`;return Ne`<div class=${Fe(ny.container)} ${hi(this.setTransitionEl)}>${this.requestedIcon?Ne`<div class=${Fe(ny.icon)}><calcite-icon .flipRtl=${this.iconFlipRtl} .icon=${this.requestedIcon} .scale=${Br(this.scale)}></calcite-icon></div>`:null}<div class=${Fe(ny.content)}><slot name=${Wv.title}></slot><slot name=${Wv.message}></slot><slot name=${Wv.link}></slot></div><div class=${Fe(ny.actionsEnd)} .hidden=${!this.hasActionEnd}><slot name=${Wv.actionsEnd} @slotchange=${this.handleActionsEndSlotChange}></slot></div>${this.closable?e:null}</div>`}};N1.properties={hasActionEnd:[16,{},{state:!0}],closable:[7,{},{reflect:!0,type:Boolean}],icon:[3,{converter:_d},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],kind:[3,{},{reflect:!0}],messageOverrides:[0,{},{attribute:!1}],open:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]},N1.styles=Ure;let mE=N1;ar("calcite-notice",mE);function P(t,e,i,r){var o=arguments.length,h=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,i):r,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(d=t[a])&&(h=(o<3?d(h):o>3?d(e,i,h):d(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h}function nme(t,e,i){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,o;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],i&&(o=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");o&&(r=function(){try{o.call(this)}catch(h){return Promise.reject(h)}}),t.stack.push({value:e,dispose:r,async:i})}else i&&t.stack.push({async:!0});return e}var Vre=typeof SuppressedError=="function"?SuppressedError:function(t,e,i){var r=new Error(i);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function sme(t){function e(h){t.error=t.hasError?new Vre(h,t.error,"An error was suppressed during disposal."):h,t.hasError=!0}var i,r=0;function o(){for(;i=t.stack.pop();)try{if(!i.async&&r===1)return r=0,t.stack.push(i),Promise.resolve().then(o);if(i.dispose){var h=i.dispose.call(i.value);if(i.async)return r|=2,Promise.resolve(h).then(o,function(d){return e(d),o()})}else r|=1}catch(d){e(d)}if(r===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return o()}const T5=new WeakMap;function Gre(t,e,i=!1){const r=` DEPRECATED - ${e}`;if(!i)return void t.warn(r);let o=T5.get(t);o||(o=new Set,T5.set(t,o)),o.has(e)||(o.add(e),t.warn(r))}function ome(t,e,i={}){Ve("esri-deprecation-warnings")&&pm(t,`Module: ${e}`,i)}function sF(t,e,i={}){if(Ve("esri-deprecation-warnings")){const{moduleName:r}=i;pm(t,`Function: ${(r?r+"::":"")+e+"()"}`,i)}}function C5(t,e,i={}){if(Ve("esri-deprecation-warnings")){const{moduleName:r}=i;pm(t,`Property: ${(r?r+"::":"")+e}`,i)}}function qre(t,e,i={}){Ve("esri-deprecation-warnings")&&pm(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...i})}function pm(t,e,i={}){if(Ve("esri-deprecation-warnings")){const{replacement:r,version:o,see:h,warnOnce:d}=i;let a=e;if(r&&(a+=`
	 Replacement: ${r}`),o&&(a+=`
	 Version: ${o}`),h)if(Array.isArray(h)){a+=`
	 See for more details:`;for(const _ of h)a+=`
		${_}`}else a+=`
	 See ${h} for more details.`;Gre(t,a,d)}}function ame(t){const e=[];return function*(){yield*e;let i,r=e.length;for(;!(i=t.next()).done;)for(e.push(i.value),yield i.value;++r<e.length;)yield e[r]}}function lme(t,e){for(const i of t)if(i!=null&&e(i))return i}function E5(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let xP=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(i=>{e+=i.length}),e}add(e,i){if(E5(e)){const r=this._getOrCreateGroup(i);for(const o of e)$5(o)&&r.push(o)}else $5(e)&&this._getOrCreateGroup(i).push(e);return this}forEach(e,i){if(typeof e=="function")this._groups.forEach(r=>r.forEach(e));else{const r=this._getGroup(e);r&&i&&r.forEach(i)}}has(e){return this._groups.has(Yv(e))}remove(e){if(typeof e!="string"&&E5(e)){for(const i of e)this.remove(i);return this}return this.has(e)?(I5(this._getGroup(e)),this._groups.delete(Yv(e)),this):this}removeAll(){return this._groups.forEach(I5),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const i=[];return this._groups.set(Yv(e),i),i}_getGroup(e){return this._groups.get(Yv(e))}};function Yv(t){return t||"_default_"}function I5(t){for(const e of t)e instanceof xP?e.removeAll():e.remove()}function $5(t){return t!=null&&(!!t.remove||t instanceof xP)}const oF=Symbol("Accessor-beforeDestroy");function Am(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const r in e)e[r]=dt(e[r]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function Mw(t,e){const i=Am(t);let r=i[e];return r||(r=i[e]={}),r}function Hre(t,e){return _b(t,e,Wre)}const Zre=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Wre(t){return Zre.test(t)?"replace":"merge"}let P5=class extends HL{constructor(e,i){super(),this.propertyName=e,this.metadata=i,this.trackingTarget=new mw(this),this.flags=0,this.flags=Ji.Dirty|(i.nonNullable?Ji.NonNullable:0)|(i.hasOwnProperty("value")?Ji.HasDefaultValue:0)|(i.get===void 0?Ji.DepTrackingInitialized:0)|(i.dependsOn===void 0?Ji.AutoTracked:0)}destroy(){this.flags&Ji.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&Zt(this);const i=e.store,r=this.propertyName,o=this.flags,h=i.get(r);if(o&Ji.Computing||~o&Ji.Dirty&&i.has(r))return h;this.flags|=Ji.Computing;const d=e.host;let a;o&Ji.AutoTracked?a=_c(this.trackingTarget,this.metadata.get,d):(qL(d,this),a=this.metadata.get.call(d)),this.flags|=Ji.DepTrackingInitialized,i.set(r,a,1);const _=i.get(r);return _===h?this.flags&=-2:pQ(this.commit,this),this.flags&=-5,_}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&Ji.Overridden&&(this.flags|=Ji.Dirty);const e=this._observers;if(e&&e.length>0)for(const i of e)i.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onCommitted()}}};const hme=8;function aF(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"link-chart":return 6;case"user":return 7;default:return null}}function gE(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"link-chart";case 7:return"user"}}function Yre(t){return gE(t)}let Xre=class lF{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new lF;return this._values.forEach((r,o)=>{e&&e.has(o)||i.set(o,dt(r))}),i}get(e){return this._values.get(e)}originOf(){return 7}keys(){return[...this._values.keys()]}set(e,i){this._values.set(e,i)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,i){return this.has(e)}isBelowOrigin(e,i){return!this.has(e)}forEach(e){this._values.forEach(e)}};function Zp(t,e,i){return t!==void 0}function M5(t,e,i,r){return t!==void 0&&(!(i==null&&t.flags&Ji.NonNullable)||(r.lifecycle,!1))}let Jre=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=ao.INITIALIZING,this.store=new Xre,this.mutable=!0,this._origin=7;const i=this.host.constructor.__accessorMetadata__;for(const r in i){const o=new P5(r,i[r]);this.propertiesByName.set(r,o)}this.metadata=i}initialize(){this.lifecycle=ao.CONSTRUCTING}constructed(){this.lifecycle=ao.CONSTRUCTED}destroy(){this.lifecycle=ao.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==ao.INITIALIZING}get(e){const i=this.propertiesByName.get(e);if(!Zp(i))return;if(i.metadata.get)return i.getComputed(this);this.mutable&&Zt(i);const r=this.store;return r.has(e)?r.get(e):i.metadata.value}originOf(e){const i=this.store.originOf(e);if(i===void 0){const r=this.propertiesByName.get(e);if(r!==void 0&&r.flags&Ji.HasDefaultValue)return"defaults"}return gE(i)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const i=this.propertiesByName.get(e);if(Zp(i))return this.store.has(e)?this.store.get(e):i.metadata.value}internalSet(e,i){const r=this.propertiesByName.get(e);Zp(r)&&this._internalSet(r,i)}getDependsInfo(e,i,r){const o=this.propertiesByName.get(i);if(!Zp(o))return"";const h=new mw,d=_c(h,()=>o.metadata.get?.call(e));let a=`${r}${e.declaredClass.split(".").pop()}.${i}: ${d}
`;const _=h.accessed??new Set;if(_.size===0)return a;r+="  ";for(const T of _)T instanceof P5&&(a+=`${r}${T.propertyName}: undefined
`);return a}setAtOrigin(e,i,r){const o=this.propertiesByName.get(e);if(Zp(o))return this._setAtOrigin(o,i,r)}isOverridden(e){const i=this.propertiesByName.get(e);return i!==void 0&&!!(i.flags&Ji.Overridden)}clearOrigin(e,i){const r=this.store,o=this.propertiesByName.get(e);if(!Zp(o))return;const h=r.isAtOrigin(e,i)&&!(o.flags&Ji.Overridden);r.delete(e,i),h&&o.notifyChange()}clearOverride(e){const i=this.propertiesByName.get(e);i&&i.flags&Ji.Overridden&&(i.flags&=-3,i.notifyChange())}override(e,i){const r=this.propertiesByName.get(e);if(!M5(r,e,i,this))return;const o=r.metadata.cast;if(o){const h=this._cast(o,i),{valid:d,value:a}=h;if(pT.release(h),!d)return;i=a}r.flags|=Ji.Overridden,this._internalSet(r,i)}set(e,i){const r=this.propertiesByName.get(e);if(!M5(r,e,i,this))return;const o=r.metadata.cast;if(o){const d=this._cast(o,i),{valid:a,value:_}=d;if(pT.release(d),!a)return;i=_}const h=r.metadata.set;h?h.call(this.host,i):this._internalSet(r,i)}setDefaultOrigin(e){this._origin=aF(e)}getDefaultOrigin(){return gE(this._origin)}notifyChange(e){const i=this.propertiesByName.get(e);i!==void 0&&i.notifyChange()}invalidate(e){const i=this.propertiesByName.get(e);i!==void 0&&i.invalidate()}commit(e){const i=this.propertiesByName.get(e);i!==void 0&&i.commit()}_internalSet(e,i){const r=this.lifecycle!==ao.INITIALIZING?this._origin:0;this._setAtOrigin(e,i,r)}_setAtOrigin(e,i,r){const o=this.store,h=e.propertyName;if(o.isAtOrigin(h,r)&&U$(i,o.get(h))&&~e.flags&Ji.Overridden)return;const d=o.isBelowOrigin(h,r)||o.isAtOrigin(h,r);d&&e.invalidate(),o.set(h,i,r),d&&e.commit(),GL(this.host,e)}_cast(e,i){const r=pT.acquire();return r.valid=!0,r.value=i,e&&(r.value=e.call(this.host,i,r)),r}},Kre=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const pT=new _w(()=>new Kre);function a1(t,e,i){if(t&&e)if(typeof e=="object")for(const r of Object.getOwnPropertyNames(e))a1(t,r,e[r]);else{if(e.includes(".")){const o=e.split("."),h=o.splice(-1,1)[0];return void a1(lm(t,o),h,i)}const r=t.__accessor__;r!=null&&Qre(e,r),t[e]=i}}function Qre(t,e){if(Ve("esri-unknown-property-errors")&&!ene(t,e))throw new Ot("set:unknown-property",tne(t,e))}function ene(t,e){return e.metadata[t]!=null}function tne(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let ine;function rne(){return ine}const ud=()=>ui.getLogger("esri.core.accessorSupport.ensureTypes");function nne(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(ud().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function sne(t){return t==null?t:!!t}function one(t){return t==null?t:t.toString()}function kw(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function wP(t){return t==null?t:Math.round(parseFloat(t))}function ane(t){return null}function lne(t,e){return i=>{let r=t(i);return e.step!=null&&(r=Math.round(r/e.step)*e.step),e.min!=null&&(r=Math.max(e.min,r)),e.max!=null&&(r=Math.min(e.max,r)),r}}function cF(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function l1(t,e){return e!=null&&t&&!(e instanceof t)}function uF(t){return t&&"isCollection"in t}function k5(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function cne(t,e){if(!e?.constructor||!uF(e.constructor))return yE(t,e)?e:new t(e);const i=k5(t.prototype.itemType),r=k5(e.constructor.prototype.itemType);return i?r?i===r?e:i.prototype.isPrototypeOf(r.prototype)?new t(e):(yE(t,e),e):new t(e):e}function yE(t,e){return!!cF(e)&&(ud().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+Aw(t)+"'"),!0)}function hF(t,e){return e==null?e:uF(t)?cne(t,e):l1(t,e)?yE(t,e)?e:new t(e):e}function Aw(t){return t?.prototype?.declaredClass||"unknown"}const une=new WeakMap;function hne(t){switch(t){case Number:return e=>kw(e);case Er:return wP;case Boolean:return sne;case String:return one;case Date:return nne;case SP:return ane;default:return H6(une,t,()=>hF.bind(null,t))}}function Ds(t,e){const i=hne(t);return arguments.length===1?i:i(e)}function I0(t,e,i){return arguments.length===1?I0.bind(null,t):e&&(Array.isArray(e)?e.map(r=>t(r,i)):[t(e,i)])}function dne(t,e){return arguments.length===1?I0(i=>Ds(t,i)):I0(i=>Ds(t,i),e)}function dF(t,e,i){return e!==0&&Array.isArray(i)?i.map(r=>dF(t,e-1,r)):t(i)}function c1(t,e,i){if(arguments.length===2)return h=>c1(t,e,h);if(!i)return i;i=dF(t,e,i);let r=e,o=i;for(;r>0&&Array.isArray(o);)r--,o=o[0];if(o!==void 0)for(let h=0;h<r;h++)i=[i];return i}function pne(t,e,i){return arguments.length===2?c1(r=>Ds(t,r),e):c1(r=>Ds(t,r),e,i)}function pF(t){return!!Array.isArray(t)&&!t.some(e=>{const i=typeof e;return!(i==="string"||i==="number"||i==="function"&&t.length>1)})}function _E(t,e){if(arguments.length===2)return _E(t).call(null,e);const i=new Set,r=t.filter(a=>typeof a!="function"),o=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||i.add(a);let h=null,d=null;return(a,_)=>{if(a==null)return a;const T=typeof a,E=T==="string"||T==="number";return E&&(i.has(a)||o.some(k=>T==="string"&&k===String||T==="number"&&k===Number))||T==="object"&&o.some(k=>!l1(k,a))?a:(E&&r.length?(h||(h=r.map(k=>typeof k=="string"?`'${k}'`:`${k}`).join(", ")),ud().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${h}`)):typeof a=="object"&&o.length?(d||(d=o.map(k=>Aw(k)).join(", ")),ud().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${d}`)):ud().error("Accessor#set",`'${a}' is not a valid value for this property`),_&&(_.valid=!1),null)}}function fm(t,e){if(arguments.length===2)return fm(t).call(null,e);const i={},r=[],o=[];for(const _ in t.typeMap){const T=t.typeMap[_];i[_]=Ds(T),r.push(Aw(T)),o.push(_)}const h=()=>`'${r.join("', '")}'`,d=()=>`'${o.join("', '")}'`,a=typeof t.key=="string"?_=>_[t.key]:t.key;return _=>{if(t.base&&!l1(t.base,_)||_==null)return _;const T=a(_)||t.defaultKeyValue,E=i[T];if(!E)return ud().error("Accessor#set",`Invalid property value, value needs to be one of ${h()}, or a plain object that can autocast (having .type = ${d()})`),null;if(!l1(t.typeMap[T],_))return _;if(typeof t.key=="string"&&!cF(_)){const k={};for(const L in _)L!==t.key&&(k[L]=_[L]);return E(k)}return E(_)}}let Er=class{},SP=class{};const gme={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function fne(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function fF(t){switch(t.type){case"native":return Ds(t.value);case"array":return I0(fF(t.value));case"one-of":return mne(t);default:return null}}function mne(t){let e=null;return(i,r)=>bE(i,t)?i:(e==null&&(e=vE(t)),ud().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),r&&(r.valid=!1),null)}function vE(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Er:return"integer";case Date:return"date";case SP:return"null";default:return Aw(t.value)}case"array":return`array of ${vE(t.value)}`;case"one-of":{const e=t.values.map(i=>vE(i));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function bE(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case Er:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case SP:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(i=>!bE(i,e.value));case"one-of":return e.values.some(i=>bE(t,i))}}function R(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,i),o=Mw(e,i);r&&(r.get||r.set?(o.get=r.get||o.get,o.set=r.set||o.set):"value"in r&&("value"in t&&ui.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),o.value=t.value=r.value)),t.readOnly!=null&&(o.readOnly=t.readOnly);const h=t.aliasOf;if(h){const _=typeof h=="string"?h:h.source,T=typeof h=="string"?null:h.overridable===!0;let E;o.dependsOn=[_],o.get=function(){let k=lm(this,_);if(typeof k=="function"){E||(E=_.split(".").slice(0,-1).join("."));const L=lm(this,E);L&&(k=k.bind(L))}return k},o.readOnly||(o.set=T?function(k){this._override(i,k)}:function(k){a1(this,_,k)})}const d=t.type,a=t.types;if(!o.cast){let _;d?_=gne(d):a&&(_=Array.isArray(a)?I0(fm(a[0])):fm(a)),t.cast=yne(t.cast,_)}Hre(o,t),t.range&&(o.cast=lne(o.cast,t.range))}}function mF(t,e,i){const r=Mw(t,i);r.json||(r.json={});let o=r.json;return e!==void 0&&(o.origins||(o.origins={}),o.origins[e]||(o.origins[e]={}),o=o.origins[e]),o}function gne(t){let e=0,i=t;if(fne(t))return fF(t);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],e++;const r=i;if(pF(r))return e===0?_E(r):c1(_E(r),e);if(e===1)return dne(r);if(e>1)return pne(r,e);const o=t;return o.from?o.from:Ds(o)}function yne(t,e){if(t||e)return t?e?(i,r)=>e(t(i,r),r):t:e}function _ne(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const r in i)if(e[r]){const o=e[r];i[r].forEach(h=>{e[h]=o}),delete e[r]}}}let $0=class extends i4{constructor(e,i,r){super(e,i,r)}};$0.prototype.type="warning";function gF(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}function vne(t,e){return TP(t,"any",e?.origin)}function u1(t,e){return TP(t,"read",e?.origin)}function yF(t,e){return TP(t,"write",e?.origin)}function TP(t,e,i){let r=t?.json;if(r?.origins&&i){let o;o=i==="link-chart"?r.origins[i]&&(e==="any"||e in r.origins[i])?r.origins[i]:r.origins["web-map"]:r.origins[i],o&&(e==="any"||e in o)&&(r=o)}return r}const xE=()=>ui.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function A5(t,e,i){t&&(!i&&!e.read||e.read?.reader||e.read?.enabled===!1||wne(t)&&Cm("read.reader",_F(t),e))}function _F(t){const e=t.ndimArray??0;if(e>1)return xne(t);if(e===1)return D5(t);if("type"in t&&bF(t.type)){const i=t.type.prototype?.itemType?.Type,r=D5(typeof i=="function"?{type:i}:{types:i});return(o,h,d)=>{const a=r(o,h,d);return a&&new t.type(a)}}return CP(t)}function CP(t){return"type"in t?bne(t.type):Sne(t.types)}function bne(t){return t.prototype.read?(e,i,r)=>{if(e==null)return e;const o=typeof e;if(o!=="object")return void xE().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${o}'`);const h=new t;return h.read(e,r),h}:t.fromJSON}function vF(t,e,i,r){return r!==0&&Array.isArray(e)?e.map(o=>vF(t,o,i,r-1)):t(e,void 0,i)}function xne(t){const e=CP(t),i=vF.bind(null,e),r=t.ndimArray??0;return(o,h,d)=>{if(o==null)return o;o=i(o,d,r);let a=r,_=o;for(;a>0&&Array.isArray(_);)a--,_=_[0];if(_!==void 0)for(let T=0;T<a;T++)o=[o];return o}}function D5(t){const e=CP(t);return(i,r,o)=>{if(i==null)return i;if(Array.isArray(i)){const d=[];for(const a of i){const _=e(a,void 0,o);_!==void 0&&d.push(_)}return d}const h=e(i,void 0,o);return h!==void 0?[h]:void 0}}function bF(t){if(!gF(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?EP(e.Type):xF(e.Type))}function wne(t){return"types"in t?xF(t.types):EP(t.type)}function EP(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||bF(t))}function xF(t){for(const e in t.typeMap)if(!EP(t.typeMap[e]))return!1;return!0}function Sne(t){let e=null;const i=t.errorContext??"type",r=t.validate;return(o,h,d)=>{if(o==null)return o;const a=typeof o;if(a!=="object")return void xE().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=Cne(t));const _=t.key;if(typeof _!="string")return;const T=o[Tne(_,e,d)],E=T?e[T]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!E){const L=`Type '${T||"unknown"}' is not supported`;return d?.messages&&o&&d.messages.push(new $0(`${i}:unsupported`,L,{definition:o,context:d})),void xE().error(L)}const k=new E;return k.read(o,d),r?r(k):k}}function Tne(t,e,i){const r=Object.values(e)[0],o=Am(r.prototype)[t],h=u1(o,i),d=h?.read?.source;return d&&typeof d=="string"?d:t}function Cne(t){const e={};for(const i in t.typeMap){const r=t.typeMap[i],o=Am(r.prototype);if(typeof t.key=="function")continue;const h=o[t.key];if(!h)continue;if(h.json?.type&&Array.isArray(h.json.type)&&h.json.type.length===1&&typeof h.json.type[0]=="string"){e[h.json.type[0]]=r;continue}const d=h.json?.write;if(!d?.writer){e[i]=r;continue}const a=d.target,_=typeof a=="string"?a:t.key,T={};d.writer(i,T,_),T[_]&&(e[T[_]]=r)}return e}function Ene(t){if(t.json||(t.json={}),O5(t.json),R5(t.json),z5(t.json),t.json.origins)for(const e in t.json.origins)O5(t.json.origins[e]),R5(t.json.origins[e]),z5(t.json.origins[e]);return!0}function z5(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function O5(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function R5(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function L5(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const i=t?.ndimArray??0;t&&(i===1||"type"in t&&gF(t.type))?e.write.writer=Mne:i>1?e.write.writer=kne(i):e.types?Array.isArray(e.types)?e.write.writer=$ne(e.types[0]):e.write.writer=Ine(e.types):e.write.writer=P0}function Ine(t){return(e,i,r,o)=>e?wF(e,t,o)?P0(e,i,r,o):void 0:P0(e,i,r,o)}function wF(t,e,i){for(const r in e.typeMap)if(t instanceof e.typeMap[r])return!0;if(i?.messages){const r=e.errorContext??"type",o=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new Ot(`${r}:unsupported`,o,{definition:t,context:i})),ui.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(o)}return!1}function $ne(t){return(e,i,r,o)=>!e||!Array.isArray(e)?P0(e,i,r,o):P0(e.filter(h=>wF(h,t,o)),i,r,o)}function P0(t,e,i,r){Cm(i,h1(t,r),e)}function h1(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?Pne(t):t}function Pne(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function Mne(t,e,i,r){let o;t===null?o=null:t&&typeof t.map=="function"?(o=t.map(h=>h1(h,r)),typeof o.toArray=="function"&&(o=o.toArray())):o=[h1(t,r)],Cm(i,o,e)}function SF(t,e,i){return i!==0&&Array.isArray(t)?t.map(r=>SF(r,e,i-1)):h1(t,e)}function kne(t){return(e,i,r,o)=>{let h;if(e===null)h=null;else{h=SF(e,o,t);let d=t,a=h;for(;d>0&&Array.isArray(a);)d--,a=a[0];if(a!==void 0)for(let _=0;_<d;_++)h=[h]}Cm(r,h,i)}}function Ane(t){const e=Dne(t);if(t.json.origins)for(const i in t.json.origins){const r=t.json.origins[i],o=r.types?zne(r):e;A5(o,r,!1),r.types&&!r.write&&t.json.write?.enabled&&(r.write={...t.json.write}),L5(o,r)}A5(e,t.json,!0),L5(e,t.json)}function Dne(t){return t.json.types?wE(t.json):t.type?TF(t):wE(t)}function zne(t){return t.type?TF(t):wE(t)}function TF(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!pF(i);)i=i[0],e++;return{type:i,ndimArray:e}}function wE(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function One(t){Ene(t)&&(_ne(t),Ane(t))}const fT=new Set,mT=new Set;function Ge(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,Lne(e);const i=[],r=[];let o=e.prototype;for(;o;)o.hasOwnProperty("initialize")&&!fT.has(o.initialize)&&(fT.add(o.initialize),i.push(o.initialize)),o.hasOwnProperty("destroy")&&!mT.has(o.destroy)&&(mT.add(o.destroy),r.push(o.destroy)),o=Object.getPrototypeOf(o);fT.clear(),mT.clear();const h=class extends e{constructor(...a){if(super(...a),this.constructor===h&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let _=i.length-1;_>=0;_--)i[_].call(this)}}),r.length){let _=!1;const T=this[oF];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!_){this.__accessor__.lifecycle=ao.DESTROYING,_=!0,T.call(this);for(let E=0;E<r.length;E++)r[E].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};h.__accessorMetadata__=Am(e.prototype),h.prototype.declaredClass=t;const d=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(h,"name",{value:d,configurable:!0}),h}}function Rne(t,e){return e.get==null?function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r===void 0)return;i.mutable&&Zt(r);const o=i.store;return o.has(t)?o.get(t):r.metadata.value}:function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r!==void 0)return r.getComputed(i)}}function Lne(t){const e=t.prototype,i=Am(e),r={};for(const o of Object.getOwnPropertyNames(i)){const h=i[o];One(h),r[o]={enumerable:!0,configurable:!0,get:Rne(o,h),set(d){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&h.readOnly?F5("read-only",o):a.lifecycle===ao.CONSTRUCTED&&h.constructOnly?F5("construct-only",o):void a.set(o,d)}else Object.defineProperty(this,o,{enumerable:!0,configurable:!0,writable:!0,value:d})}}}Object.defineProperties(t.prototype,r)}const F5=(t,e)=>{ui.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var N5,B5;function Fne(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const nu=Symbol("Accessor-Handles"),gT=Symbol("Accessor-Initialized");var Bu;let Ln=(Bu=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:r,constructor:o}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const h=this;class d extends h{constructor(..._){super(..._),this.inherited=null,o&&o.apply(this,_)}}Am(d.prototype);for(const a in e){const _=e[a];d.prototype[a]=typeof _=="function"?function(...T){const E=this.inherited;let k;this.inherited=function(...L){if(h.prototype[a])return h.prototype[a].apply(this,L)};try{k=_.apply(this,T)}catch(L){throw this.inherited=E,L}return this.inherited=E,k}:e[a]}for(const a in i){const _=Fne(i[a]);R(_)(d.prototype,a)}return Ge(r)(d)}static freeze(e){return e instanceof Bu?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof Bu?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[N5]=null,this[B5]=!1,this.constructor===Bu)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new Jre(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),e.length>0&&(i.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,i=e.ctorArgs;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize(),this[gT]=!0}initialize(){}[oF](){this[nu]=xb(this[nu])}destroy(){this.destroyed||(ZQ(this),this.__accessor__.destroy(),rne()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[gT]}get destroyed(){return this.__accessor__?.lifecycle===ao.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===ao.DESTROYING||!1}commitProperty(e){lm(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,i){return a1(this,e,i),this}watch(e,i,r){return sF(ui.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),QQ(this,e,i,r)}addHandles(e,i){if(this.destroyed){const r=Array.isArray(e)?e:[e];for(const o of r)o.remove();return}(this[nu]??=new xP).add(e,i)}removeHandles(e){this[nu]?.remove(e)}removeAllHandles(){this[nu]?.removeAll()}removeHandlesReference(e){this[nu]?.removeReference(e)}hasHandles(e){return this[nu]?.has(e)===!0}_override(e,i){i===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,i){i==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,i){return this.__accessor__.internalSet(e,i),this}},N5=nu,B5=gT,Bu);const Nne=Symbol("ClonableMixin"),ms=t=>{var o;var e;const i=t;let r=(o=class extends i{constructor(){super(...arguments),this[e]=!0}clone(h){const d=Uu(this);t4(d,"unable to clone instance of non-accessor class");const a=d.metadata,_=d.store,T={},E=new Map;for(const L in a){const O=a[L],H=_?.originOf(L),re=O.clonable;if(O.readOnly||re===!1||H!==7&&H!==0&&H!==5&&H!==4)continue;const pe=this[L];let ge=null;if(typeof re=="function")ge=re(pe,h);else if(re==="reference")ge=pe;else if(ge=jC(pe,h),pe!=null&&ge==null)continue;H===0?E.set(L,ge):T[L]=ge}const k=new(Object.getPrototypeOf(this)).constructor(T);if(E.size){const L=Uu(k)?.store;if(L)for(const[O,H]of E)L.set(O,H,0)}return k}},e=Nne,o);return r=P([Ge("esri.core.Clonable")],r),r},_me=ms(Ln),IP=t=>{const e=t;class i extends e{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(o,h){let d=this._listenersMap?.get(o);if(!d)return!1;let a=!1;for(const _ of d.slice()){const T="deref"in _?_.deref():_;T?T?.call(this,h):a=!0}return a&&(d=d.filter(_=>!("deref"in _)||_.deref()!=null),this._listenersMap.set(o,d)),d.length>0}on(o,h){if(Array.isArray(o)){const a=o.map(_=>this.on(_,h));return G$(a)}if(o.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const d=this._listenersMap.get(o)||[];return d.push(h),this._listenersMap.set(o,d),un(()=>{const a=this._listenersMap?.get(o),_=a?.indexOf(h)??-1;_>=0&&a.splice(_,1)})}once(o,h){const d=this.on(o,a=>{d.remove(),("deref"in h?h.deref():h)?.call(null,a)});return d}hasEventListener(o){const h=this._listenersMap?.get(o);return h!=null&&h.length>0}}return i},Bne=IP(class{}),vme=Bne,CF=IP(Ln);function jne(t){return(e,i)=>{e[i]=t}}var Ql;let Une=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},Vne=class{constructor(e,i,r,o,h){this.target=e,this.added=i,this.removed=r,this.start=o,this.deleteCount=h}};const Po=new _w(()=>new Une,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function j5(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function yT(t){return t?t instanceof xu?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function _T(t){if(t?.length)return t[0]}function Gne(t,e,i,r){const o=Math.min(t.length-i,e.length-r);let h=0;for(;h<o&&t[i+h]===e[r+h];)h++;return h}function EF(t,e,i,r){e&&e.forEach((o,h,d)=>{t.push(o),EF(t,i.call(r,o,h,d),i,r)})}const su=new Set,ou=new Set,au=new Set,vT=new Map;let qne=0,xu=Ql=class extends CF{static ofType(t){if(!t)return Ql;if(vT.has(t))return vT.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const r in t.typeMap){const o=t.typeMap[r].prototype.declaredClass;e?e+=` | ${o}`:e=o}let i=class extends Ql{};return P([jne({Type:t,ensureType:typeof t=="function"?Ds(t):fm(t)})],i.prototype,"itemType",void 0),i=P([Ge(`esri.core.Collection<${e}>`)],i),vT.set(t,i),i}static isCollection(t){return t!=null&&t instanceof Ql}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new ZL,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:qne++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Ql?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),super.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return Zt(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,yT(t)),this._emitAfterChanges(1))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:super.hasEventListener(t))}on(t,e){if(this.destroyed)return un();if(t==="change"){const i=this._chgListeners,r={removed:!1,callback:e};return i.push(r),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),un(()=>{r.removed=!0,i.splice(i.indexOf(r),1)})}return super.on(t,e)}once(t,e){const i="deref"in e?()=>e.deref():()=>e,r=this.on(t,o=>{i()?.call(null,o),r.remove()});return r}add(t,e){if(Zt(this._observable),this._emitBeforeChanges(1))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(Zt(this._observable),!t?.length)return this;if(this._emitBeforeChanges(1))return this;const i=this.getNextIndex(e);return this._splice(i,0,yT(t)),this._emitAfterChanges(1),this}at(t){if(Zt(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(Zt(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._removeAllRaw();return this._emitAfterChanges(2),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return Zt(this._observable),this._createNewInstance({items:this._items.map(dt)})}concat(...t){Zt(this._observable);const e=t.map(yT);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(Zt(this._observable),!this.length||this._emitBeforeChanges(2))return;const i=this._splice(0,this.length),r=i.length;for(let o=0;o<r;o++)t.call(e,i[o],o,i);this._emitAfterChanges(2)}destroyAll(){this.drain(j5)}destroyMany(t){const e=this.removeMany(t);return e.forEach(j5),e}every(t,e){return Zt(this._observable),this._items.every(t,e)}filter(t,e){Zt(this._observable);const i=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:i})}find(t,e){return Zt(this._observable),this._items.find(t,e)}findIndex(t,e){return Zt(this._observable),this._items.findIndex(t,e)}flatten(t,e){Zt(this._observable);const i=[];return EF(i,this,t,e),new Ql(i)}forEach(t,e){return Zt(this._observable),this._items.forEach(t,e)}getItemAt(t){return Zt(this._observable),this._items[t]}getNextIndex(t){Zt(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return Zt(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return Zt(this._observable),this._items.indexOf(t,e)}join(t=","){return Zt(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return Zt(this._observable),this._items.lastIndexOf(t,e)}map(t,e){Zt(this._observable);const i=this._items.map(t,e);return new Ql({items:i})}reorder(t,e=this.length-1){Zt(this._observable);const i=this.indexOf(t);if(i!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(4))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(4)}return t}}pop(){if(Zt(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=_T(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return Zt(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,t),this._emitAfterChanges(1)),this.length}reduce(t,e){Zt(this._observable);const i=this._items;return arguments.length===2?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){Zt(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return Zt(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(Zt(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=_T(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(Zt(this._observable),!t?.length||this._emitBeforeChanges(2))return[];const e=t instanceof Ql?t.toArray():t,i=this._items,r=[],o=e.length;for(let h=0;h<o;h++){const d=e[h],a=i.indexOf(d);if(a>-1){const _=1+Gne(e,i,h+1,a+1),T=this._splice(a,_);T&&T.length>0&&r.push.apply(r,T),h+=_-1}}return this._emitAfterChanges(2),r}reverse(){if(Zt(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(4),this}shift(){if(Zt(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=_T(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return Zt(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return Zt(this._observable),this._items.some(t,e)}sort(t){if(Zt(this._observable),!this.length||this._emitBeforeChanges(4)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(4),this}_requiresSort(t=(e,i)=>e===i?0:e<i?-1:1){const e=this.length-1;for(let i=0;i<e;i++)if(t(this.items[i],this.items[i+1])>0)return!0;return!1}splice(t,e,...i){Zt(this._observable),arguments.length===1&&(e=this.length),e??=0;const r=(e?2:0)|(i.length?1:0);if(this._emitBeforeChanges(r))return[];const o=this._splice(t,e,i)||[];return this._emitAfterChanges(r),o}toArray(){return Zt(this._observable),this._items.slice()}toJSON(t){return Zt(this._observable),this.toArray().map(e=>i1(e)?e.toJSON(t):e)}toLocaleString(){return Zt(this._observable),this._items.toLocaleString()}toString(){return Zt(this._observable),this._items.toString()}unshift(...t){return Zt(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const r=this._items,o=this.itemType;let h,d;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=u4(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(d=r.splice(t,e),this.hasEventListener("before-remove")){const a=Po.acquire();a.target=this,a.cancellable=!0;for(let _=0,T=d.length;_<T;_++)h=d[_],a.reset(h),this.emit("before-remove",a),a.defaultPrevented&&(d.splice(_,1),r.splice(t,0,h),t+=1,_-=1,T-=1);Po.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=Po.acquire();a.target=this,a.cancellable=!1;const _=d.length;for(let T=0;T<_;T++)a.reset(d[T]),this.emit("after-remove",a);Po.release(a)}}if(i?.length){if(o){const E=[];for(const k of i){const L=o.ensureType(k);L==null&&k!=null||E.push(L)}i=E}const a=this.hasEventListener("before-add"),_=this.hasEventListener("after-add"),T=t===this.length;if(a||_){const E=Po.acquire();E.target=this,E.cancellable=!0;const k=Po.acquire();k.target=this,k.cancellable=!1;for(const L of i)a?(E.reset(L),this.emit("before-add",E),E.defaultPrevented||(T?r.push(L):r.splice(t++,0,L),this._set("length",r.length),_&&(k.reset(L),this.emit("after-add",k)))):(T?r.push(L):r.splice(t++,0,L),this._set("length",r.length),k.reset(L),this.emit("after-add",k));Po.release(k),Po.release(E)}else{if(T)for(const E of i)r.push(E);else r.splice(t,0,...i);this._set("length",r.length)}}if((i?.length||d?.length)&&this._notifyChangeEvent(i,d),this.hasEventListener("after-splice")){const a=new Vne(this,i,d,t,e);this.emit("after-splice",a)}return d}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Po.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Po.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Po.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Po.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const i=e.changes;su.clear(),ou.clear(),au.clear();for(const{added:_,removed:T}of i){if(_)if(au.size===0&&ou.size===0)for(const E of _)su.add(E);else for(const E of _)ou.has(E)?(au.add(E),ou.delete(E)):au.has(E)||su.add(E);if(T)if(au.size===0&&su.size===0)for(const E of T)ou.add(E);else for(const E of T)su.has(E)?su.delete(E):(au.delete(E),ou.add(E))}const r=_u.acquire();su.forEach(_=>{r.push(_)});const o=_u.acquire();ou.forEach(_=>{o.push(_)});const h=this._items,d=e.items,a=_u.acquire();if(au.forEach(_=>{d.indexOf(_)!==h.indexOf(_)&&a.push(_)}),e.listeners&&(r.length||o.length||a.length)){const _={target:this,added:r,removed:o,moved:a},T=e.listeners.length;for(let E=0;E<T;E++){const k=e.listeners[E];k.removed||k.callback.call(this,_)}}_u.release(r),_u.release(o),_u.release(a)}su.clear(),ou.clear(),au.clear()}};P([R()],xu.prototype,"_updating",void 0),P([R()],xu.prototype,"length",void 0),P([R()],xu.prototype,"items",null),P([R({readOnly:!0})],xu.prototype,"updating",null),xu=Ql=P([Ge("esri.core.Collection")],xu);const nr=xu;let Hne=class IF{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new IF;return this._values.forEach((r,o)=>{e&&e.has(o)||i.set(o,dt(r.value),r.origin)}),i}get(e,i){i=this._normalizeOrigin(i);const r=this._values.get(e);return i==null||r?.origin===i?r?.value:void 0}originOf(e){return this._values.get(e)?.origin??7}keys(e){e=this._normalizeOrigin(e);const i=[...this._values.keys()];return e==null?i:i.filter(r=>this._values.get(r)?.origin===e)}set(e,i,r){if((r=this._normalizeOrigin(r))===0){const o=this._values.get(e);if(o?.origin!=null&&o.origin>r)return}this._values.set(e,new Zne(i,r))}delete(e,i){(i=this._normalizeOrigin(i))!=null&&this._values.get(e)?.origin!==i||this._values.delete(e)}has(e,i){return(i=this._normalizeOrigin(i))!=null?this._values.get(e)?.origin===i:this._values.has(e)}isAtOrigin(e,i){return i=this._normalizeOrigin(i),this.has(e,i)&&this.originOf(e)===i}isBelowOrigin(e,i){return i=this._normalizeOrigin(i),!this.has(e)||this.originOf(e)<i}forEach(e){this._values.forEach(({value:i},r)=>e(i,r))}_normalizeOrigin(e){if(e!=null)return e===0?e:7}},Zne=class{constructor(e,i){this.value=e,this.origin=i}};function Wne(t,e,i){e.keys().forEach(o=>{i.set(o,e.get(o),0)});const r=t.metadata;Object.keys(r).forEach(o=>{t.internalGet(o)&&i.set(o,t.internalGet(o),0)})}function Yne(t,e,i){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const r=t.read.source;if(typeof r=="string"){if(r===e||r.includes(".")&&r.startsWith(e)&&bD(r,i))return!0}else for(const o of r)if(o===e||o.includes(".")&&o.startsWith(e)&&bD(o,i))return!0;return!1}function Xne(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function Jne(t,e,i,r,o){let h=u1(e[i],o);Xne(h)&&(t[i]=!0);for(const d of Object.getOwnPropertyNames(e))h=u1(e[d],o),Yne(h,i,r)&&(t[d]=!0)}function Kne(t,e,i,r){const o=i.metadata,h=vne(o[e],r),d=h?.default;if(d===void 0)return;const a=typeof d=="function"?d.call(t,e,r):d;a!==void 0&&i.set(e,a)}const $F={origin:"service"};function Qne(t,e,i=$F){if(!e||typeof e!="object")return;const r=Uu(t),o=r.metadata,h={};for(const d of Object.getOwnPropertyNames(e))Jne(h,o,d,e,i);r.setDefaultOrigin(i.origin);for(const d of Object.getOwnPropertyNames(h)){const a=u1(o[d],i).read,_=a?.source;let T;T=_&&typeof _=="string"?t_(e,_):e[d],a?.reader&&(T=a.reader.call(t,T,e,i)),T!==void 0&&r.set(d,T)}if(!i||!i.ignoreDefaults){r.setDefaultOrigin("defaults");for(const d of Object.getOwnPropertyNames(o))h[d]||Kne(t,d,r,i)}r.setDefaultOrigin("user")}function Sme(t,e,i,r=$F){const o={...r,messages:[]};i(o),o.messages?.forEach(h=>{h.type!=="warning"||t.loaded?r?.messages&&r.messages.push(h):t.loadWarnings.push(h)})}function ese(t,e,i,r,o){const h={};return e.write?.writer?.call(t,r,h,i,o),h}function PF(t,e,i,r,o,h){if(!r?.write)return!1;const d=lm(t,i);if(!o&&r.write.overridePolicy){const a=r.write.overridePolicy.call(t,d,i,h??void 0);a!==void 0&&(o=a)}if(o||(o=r.write),!o||o.enabled===!1||o.layerContainerTypes&&h?.layerContainerType&&!o.layerContainerTypes.includes(h.layerContainerType))return!1;if((d===null&&!o.allowNull&&!o.writerEnsuresNonNull||d===void 0)&&o.isRequired){const a=new Ot("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return a&&h?.messages?h.messages.push(a):a&&!h&&ui.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(d===void 0||d===null&&!o.allowNull&&!o.writerEnsuresNonNull||!o.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===0)&&tse(t,i,h,r,d)||!o.ignoreOrigin&&h?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(i)<aF(h.origin))}function tse(t,e,i,r,o){const h=r.default;if(h===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(o);if(typeof h=="function"){if(Array.isArray(o)){const d=h.call(t,e,i??void 0);return hw(d,o)}return!1}return h===o}function Tme(t,e,i,r){const o=Uu(t),h=o.metadata,d=yF(h[e],r);return!!d&&PF(t,o,e,d,i,r)}function ise(t,e,i){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return _b(e,t.toJSON(i));const r=Uu(t),o=r.metadata;for(const h in o){const d=yF(o[h],i);if(!PF(t,r,h,d,void 0,i))continue;const a=lm(t,h),_=ese(t,d,d.write&&typeof d.write.target=="string"?d.write.target:h,a,i);Object.keys(_).length>0&&(e=_b(e,_),i?.resources?.pendingOperations?.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then(()=>_b(e,_,()=>"replace-arrays"))),i?.writtenProperties&&i.writtenProperties.push({target:t,propName:h,oldOrigin:Yre(r.store.originOf(h)),newOrigin:i.origin}))}return e}const MF=t=>{const e=t;let i=class extends e{constructor(...r){super(...r);const o=Uu(this),h=o.store,d=new Hne;o.store=d,Wne(o,h,d)}read(r,o){Qne(this,r,o)}write(r,o){return ise(this,r??{},o)}toJSON(r){return this.write({},r)}static fromJSON(r,o){return rse.call(this,r,o)}};return i=P([Ge("esri.core.JSONSupport")],i),i.prototype.toJSON.isDefaultToJSON=!0,i};function rse(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}const Lt=MF(Ln),nse=Object.prototype.toString;function sse(t){const e="__accessorMetadata__"in t?Ds(t):t;return function(...i){if(i.push(e),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return ose.apply(this,i)}}function ose(t,e,i,r){Mw(t,e).cast=r}function ase(t){return(e,i)=>{Mw(e,t).cast=e[i]}}function l_(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&nse.call(t[0])==="[object Function]"?sse(t[0]):t.length===1&&typeof t[0]=="string"?ase(t[0]):void 0}function Fr(t,e,i){let r,o;return e===void 0||Array.isArray(e)?(o=t,i=e,r=[void 0]):(o=e,r=Array.isArray(t)?t:[t]),(h,d)=>{const a=h.constructor.prototype;r.forEach(_=>{const T=mF(h,_,o);T.read&&typeof T.read=="object"||(T.read={}),T.read.reader=a[d],i&&(T.read.source=(T.read.source||[]).concat(i))})}}function Bi(t,e,i){let r,o;return e===void 0?(o=t,r=[void 0]):typeof e!="string"?(o=t,r=[void 0],i=e):(o=e,r=Array.isArray(t)?t:[t]),(h,d)=>{const a=h.constructor.prototype;for(const _ of r){const T=mF(h,_,o);T.write&&typeof T.write=="object"||(T.write={}),i&&(T.write.target=i),T.write.writer=a[d]}}}let bT;async function lse(){return bT==null&&(bT=Kn(()=>import("./WhereClauseCache-BUlCZXcv.js"),__vite__mapDeps([11,12,13,14,15,16,1,2,3])).then(t=>new t.WhereClauseCache(500,500))),bT}async function cse(t,e){const i=await lse(),r=i.get(t,e);if(r==null)throw i.getError(t,e);return r}function Cme(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function Eme(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function Ime(t){return typeof t=="number"}function $me(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function Pme(t){return typeof t=="boolean"}function c_(t){return typeof t=="string"||t instanceof String}function use(t){return t==null||c_(t)}function Mme(t){return Array.isArray(t)}function kme(t){return t?.declaredClass==="esri.Graphic"}function Ame(t){return t instanceof Date}const hse="HH:mm",dse="HH:mm:ss",pse="HH:mm:ss.SSS",fse=[pse,dse,hse,"TT"],mse="yyyy-MM-dd";function U5(t){if(!t||!c_(t))return null;const e=zt.fromFormat(t,mse);return e.isValid?e:null}function V5(t){return t&&c_(t)?Hx(fse,e=>{const i=zt.fromFormat(t,e);return i.isValid?i:null})??null:null}function G5(t){if(!t||!c_(t))return null;const e=zt.fromISO(t);return e.isValid?e:null}const kF=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function gse(t){return t!=null&&kF.has(t.type)}function AF(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function DF(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function zF(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const yse=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);h4(kF,yse);function Dme(t,e){const i=t?.domain;if(!i||i.type!=="range")return;const r="range"in i?i.range[0]:i.minValue,o="range"in i?i.range[1]:i.maxValue,h=gse(t);return AF(t)||zF(t)||DF(t)?{..._se(t,o,r),isInteger:h}:{min:r!=null&&typeof r=="number"?r:null,max:o!=null&&typeof o=="number"?o:null,rawMin:r,rawMax:o,isInteger:h}}function _se(t,e,i){return AF(t)?{min:U5(i)?.toMillis(),max:U5(e)?.toMillis(),rawMin:i,rawMax:e}:zF(t)?{min:V5(i)?.toMillis(),max:V5(e)?.toMillis(),rawMin:i,rawMax:e}:DF(t)?{min:G5(i)?.toMillis(),max:G5(e)?.toMillis(),rawMin:i,rawMax:e}:{max:null,min:null}}function vse(t){if(!t)return;const e=t.match(bse);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const bse=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-z_][a-z0-9_]*))$/i;function zme(t){return t.match(xse)?.[1]?.replaceAll("\\'","'")??null}const xse=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let xT;function wse(){return xT||(xT=(async()=>{const[t,e,i]=await Promise.all([Kn(()=>import("./arcadeUtils-CXTTrxqJ.js").then(r=>r.q),__vite__mapDeps([17,1,2,18,16,14,15,19,20,21,22,23,24,25,26,27,13,28,29,3,5,30,31,32])),Kn(()=>import("./batchExec-HQK5TTZx.js"),__vite__mapDeps([33,7,8,9,10,1,2,3])),Kn(()=>import("./aiServices-mlv-OxXJ.js").then(r=>r.ay),__vite__mapDeps([18,16,14,15,19,20,21]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:i,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel,Pixel:t.Pixel}})()),xT}const Sse=/^([0-9_])/,Tse=/[^a-z0-9_\u0080-\uffff]+/gi;function Ome(t){return t==null?null:t.trim().replaceAll(Tse,"_").replace(Sse,"F$1")||null}const Cse=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],Ese=["field","normalizationField"];function Rme(t,e){if(t!=null&&e!=null){for(const i of Array.isArray(t)?t:[t])if(q5(Cse,i,e),"visualVariables"in i&&i.visualVariables)for(const r of i.visualVariables)q5(Ese,r,e)}}function q5(t,e,i){if(t)for(const r of t){const o=fw(r,e),h=o&&typeof o!="function"&&i.get(o);h&&Cm(r,h.name,e)}}function Lme(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const i=e.get(t.startField),r=e.get(t.endField);t.startField=i?.name??null,t.endField=r?.name??null}else{const i=e.get(t.startTimeField),r=e.get(t.endTimeField);t.startTimeField=i?.name??null,t.endTimeField=r?.name??null}}const wT=new Set;function OF(t,e){return t&&e?(wT.clear(),$P(wT,t,e),Array.from(wT).sort()):[]}function $P(t,e,i){if(i)if(e?.fields?.length)if(i.includes("*"))for(const{name:r}of e.fields)t.add(r);else for(const r of i)SE(t,e,r);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const r of i)r!=null&&t.add(r)}}function SE(t,e,i){if(typeof i=="string")if(e){const r=e.get(i);r&&t.add(r.name)}else t.add(i)}function Fme(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(i=>i.name):e}async function RF(t,e,i,r){if(!r)return;const o=vse(r);if(o)SE(t,e,o);else{const{arcadeUtils:h}=await wse(),d=h.extractFieldNames(r,i?.partitions??e?.fields?.map(a=>a.name));for(const a of d)SE(t,i?.index??e,a)}}async function Nme(t,e,i){if(i&&i!=="1=1"){const r=await cse(i,e);if(!r.isStandardized)throw new Ot("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});$P(t,e,r.fieldNames)}}function Bme({displayField:t,fields:e}){return t||(e?.length?Ise(e):null)}function Ise(t){return ST(t,"name-or-title")||ST(t,"unique-identifier")||ST(t,"type-or-category")||$se(t)}function $se(t){for(const e of t){if(!e?.name)continue;const i=e.name.toLowerCase();if(i.includes("name")||i.includes("title"))return e.name}return null}function ST(t,e){for(const i of t)if(i?.valueType&&i.valueType===e)return i.name;return null}function jme(t){return t?OF(t.fieldsIndex,LF(t)):[]}function Pse(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?OF(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}const Mse=new Set(["oid","global-id","guid"]),kse=new Set(["oid","global-id"]),Ase=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function Dse(t){const e=new Set;FF(t).forEach(r=>e.add(r)),Pse(t).forEach(r=>e.add(r.toLowerCase()));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach(r=>e.add(r.toLowerCase())),Object.values(i.transformFieldRoles).forEach(r=>e.add(r.toLowerCase()))),Array.from(e)}function LF(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:r,editDateField:o,editorField:h}=e;return[i,r,o,h].filter(Boolean)}function FF(t){return LF(t).map(e=>e.toLowerCase())}function Ume(t,e){return t.editable&&!Mse.has(t.type)&&!FF(e).includes(t.name?.toLowerCase()??"")}function Vme(t,e){const i=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&i===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&i===e.globalIdField.toLowerCase()||Dse(e).includes(i)||kse.has(t.type)||Ase.some(r=>r.test(i)))}function Gme(t){const e=t.defaultValue;return e!==void 0&&BF(t,e)?e:t.nullable?null:void 0}function qme(t){const e=typeof t=="string"?{type:t}:t;return Vse(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function NF(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function zse(t){return t===null||NF(t)}function Ose(t){return t===null||Number.isInteger(t)}function Rse(){return!0}function BF(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=t.nullable?Ose:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?zse:NF;break;case"string":case"esriFieldTypeString":i=t.nullable?use:c_;break;default:i=Rse}return arguments.length===1?i:i(e)}const Lse=["integer","small-integer","big-integer","long"],Fse=["single","double"],Nse=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],Bse=["esriFieldTypeSingle","esriFieldTypeDouble"],jF=new Set([...Lse,...Nse]),jse=new Set([...Fse,...Bse]),Use=h4(jF,jse);function Hme(t){return t!=null&&jF.has(t.type)}function UF(t){return t!=null&&Use.has(t.type)}function Vse(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function Gse(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function qse(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function Hse(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function Zse(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function Zme(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function Wme(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function Yme(t,e){return Wse(t,e)===null}function Xme(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function Wse(t,e){return t==null||t.nullable&&e===null?null:BF(t,e)?UF(t)&&!Yse(t.type,Number(e))?"numeric-range-validation-error::out-of-range":null:"type-validation-error::invalid-type"}function Yse(t,e){const i=typeof t=="string"?VF(t):t;if(!i)return!1;const r=i.min,o=i.max;return i.isInteger?Number.isInteger(e)&&e>=r&&e<=o:e>=r&&e<=o}function VF(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return Xse;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return Jse;case"esriFieldTypeBigInteger":case"big-integer":return Kse;case"esriFieldTypeSingle":case"single":return Qse;case"esriFieldTypeDouble":case"double":return eoe}}const Xse={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},Jse={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},Kse={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},Xv=(2-2**-23)*2**127,Qse={min:-Xv,max:Xv,isInteger:!1,rawMin:-Xv,rawMax:Xv},eoe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function Jme(t,e,i){switch(t){case"domain-validation-error::invalid-coded-value":return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"domain-validation-error::value-out-of-range":return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"type-validation-error::invalid-type":return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case"numeric-range-validation-error::out-of-range":{const{min:r,max:o}=VF(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${r} to ${o}`}}}function Kme(t,e){return!toe(t,e,null)}function toe(t,e,i){if(!t?.attributes||!e)return!0;const r=new Set(Object.keys(t.attributes));let o=!1;for(const h of e)if(!r.has(h)&&(o=!0,i==null))break;return o}function Qme(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function ioe(t){const e=t?.match(/{[^}]+}/g);return e?e.map(i=>i.slice(1,-1).split(":")[0].trim()):[]}let Mb=class extends Lt{constructor(e){super(e),this.type=null}};P([R({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],Mb.prototype,"type",void 0),Mb=P([Ge("esri.popup.content.Content")],Mb);const bc=Mb,Jv=new vl({asc:"ascending",desc:"descending"});let wy=class extends ms(Lt){constructor(e){super(e),this.field=null,this.order="ascending"}};P([R({type:String,json:{write:!0}})],wy.prototype,"field",void 0),P([R({type:Jv.apiValues,json:{type:Jv.jsonValues,read:Jv.read,write:Jv.write}})],wy.prototype,"order",void 0),wy=P([Ge("esri.popup.support.AttachmentsOrderByInfo")],wy);const roe=wy;let Qa=class extends ms(bc){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};P([R({type:[String],json:{write:!0}})],Qa.prototype,"attachmentKeywords",void 0),P([R({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],Qa.prototype,"attachmentTypes",void 0),P([R({type:String,json:{write:!0}})],Qa.prototype,"description",void 0),P([R({type:["auto","preview","list"],json:{write:!0}})],Qa.prototype,"displayType",void 0),P([R({type:[roe],json:{write:!0}})],Qa.prototype,"orderByFields",void 0),P([R({type:String,json:{write:!0}})],Qa.prototype,"title",void 0),P([R({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Qa.prototype,"type",void 0),Qa=P([Ge("esri.popup.content.AttachmentsContent")],Qa);const M0=Qa;var TE;let jh=TE=class extends bc{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new TE({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?dt(this.outFields):null})}};P([R()],jh.prototype,"creator",void 0),P([R()],jh.prototype,"destroyer",void 0),P([R()],jh.prototype,"outFields",void 0),P([R({type:["custom"],readOnly:!0})],jh.prototype,"type",void 0),jh=TE=P([Ge("esri.popup.content.CustomContent")],jh);const noe=jh;var CE;let rf=CE=class extends Lt{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new CE({title:this.title,expression:this.expression})}};P([R({type:String,json:{write:!0}})],rf.prototype,"title",void 0),P([R({type:String,json:{write:!0}})],rf.prototype,"expression",void 0),P([R({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],rf.prototype,"returnType",void 0),rf=CE=P([Ge("esri.popup.ElementExpressionInfo")],rf);const soe=rf;var EE;let Sy=EE=class extends bc{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new EE({expressionInfo:this.expressionInfo?.clone()})}};P([R({type:soe,json:{write:!0}})],Sy.prototype,"expressionInfo",void 0),P([R({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],Sy.prototype,"type",void 0),Sy=EE=P([Ge("esri.popup.content.ExpressionContent")],Sy);const Dw=Sy;function mi(t,e={}){const i=t instanceof vl?t:new vl(t,e),{alwaysWriteDefaults:r,default:o,ignoreUnknown:h=!0,name:d,nonNullable:a,readOnly:_=!1}=e;return R({type:h?i.apiValues:String,json:{type:i.jsonValues,default:o,name:d,read:!_&&{reader:i.read},write:{writer:i.write,alwaysWriteDefaults:r}},nonNullable:a,readOnly:_})}let kb=class extends ms(Lt){constructor(e){super(e),this.type=null}};P([R({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],kb.prototype,"type",void 0),kb=P([Ge("esri.layers.support.FieldFormat")],kb);const PP=kb,GF="auto";let ec=class extends PP{constructor(e){super(e),this.dateStyle=null,this.hour12=GF,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};P([R({type:["full","long","medium","short"],json:{write:!0}})],ec.prototype,"dateStyle",void 0),P([R({type:["always","auto","never"],nonNullable:!0,json:{default:GF,write:!0}})],ec.prototype,"hour12",void 0),P([R({type:["long","short"],json:{write:!0}})],ec.prototype,"month",void 0),P([R({type:["full","long","medium","short"],json:{write:!0}})],ec.prototype,"timeStyle",void 0),P([R({type:["date-time"]})],ec.prototype,"type",void 0),P([R({type:["numeric"],json:{write:!0}})],ec.prototype,"year",void 0),ec=P([Ge("esri.layers.support.DateTimeFieldFormat")],ec);const hd=ec,H5={min:0,max:20},qF=2,HF=0,ZF="decimal",WF="auto";let du=class extends PP{constructor(e){super(e),this.maximumFractionDigits=qF,this.minimumFractionDigits=HF,this.style=ZF,this.type="number",this.useGrouping=WF}};P([R({type:Er,nonNullable:!0,range:H5,json:{default:qF,write:!0}})],du.prototype,"maximumFractionDigits",void 0),P([R({type:Er,nonNullable:!0,range:H5,json:{default:HF,write:!0}})],du.prototype,"minimumFractionDigits",void 0),P([R({type:["decimal"],nonNullable:!0,json:{default:ZF,write:!0}})],du.prototype,"style",void 0),P([R({type:["number"]})],du.prototype,"type",void 0),P([R({type:["always","auto","never"],nonNullable:!0,json:{default:WF,write:!0}})],du.prototype,"useGrouping",void 0),du=P([Ge("esri.layers.support.NumberFieldFormat")],du);const d1=du;let nf=class extends ms(Lt){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};P([mi(hie)],nf.prototype,"dateFormat",void 0),P([R({type:Boolean,json:{write:!0}})],nf.prototype,"digitSeparator",void 0),P([R({type:Er,json:{write:!0}})],nf.prototype,"places",void 0),nf=P([Ge("esri.popup.support.FieldInfoFormat")],nf);const Dm=nf,ooe={base:PP,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":hd,number:d1}};function age(t,e){const{format:i}=t;return e&&zw(e)?i?YF(i,e):Ab(e,{hour12:"always",useGrouping:"always"}):null}function YF(t,e){const{dateFormat:i}=t;if(!e)return i?W5(t):Z5(t);if(!zw(e))return;const r={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return XF(t);case"single":case"double":return Z5(t);case"date":case"timestamp-offset":return i?W5(t):Ab(e,r);case"date-only":return i?aoe(t):Ab(e);case"time-only":return i?loe(t):Ab(e,r)}}function zw(t){return UF(t)||Gse(t)||qse(t)||Zse(t)||Hse(t)}function XF(t){return new d1({useGrouping:t.digitSeparator?"always":"never"})}function Z5(t){const e=XF(t),{places:i}=t;return e.minimumFractionDigits=i??0,e.maximumFractionDigits=i??2,e}function W5(t){return new hd({dateStyle:JF(t),year:tN(t),month:QF(t),timeStyle:eN(t),hour12:KF(t)})}function aoe(t){return new hd({dateStyle:JF(t),year:tN(t),month:QF(t)})}function loe(t){return new hd({timeStyle:eN(t),hour12:KF(t)})}function JF(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function KF(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function QF(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function eN(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function tN(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function coe(t,e){const i=t.type==="number",r=t.type==="date-time";if(!e)return i?Y5(t):r?X5(t):null;if(zw(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return i?iN(t):null;case"single":case"double":return i?Y5(t):null;case"date":case"timestamp-offset":return r?X5(t):null;case"date-only":return r?uoe(t):null;case"time-only":return r?hoe(t):null}}function iN(t){return new Dm({digitSeparator:t.useGrouping!=="never"})}function Y5(t){const e=iN(t);return e.places=t.maximumFractionDigits,e}function X5(t){let e;const i=rN(t),r=nN(t),o=t.hour12==="never"?"24":null,h=t.year==="numeric"?"year":null,d=sN(t);return i&&r&&o?e=`${i}-${r}-${o}`:i&&r?e=`${i}-${r}`:i?e=i:h&&d?e=`${d}-${h}`:h&&(e=h),e?new Dm({dateFormat:e}):null}function uoe(t){let e;const i=rN(t),r=t.year==="numeric"?"year":null,o=sN(t);return i?e=i:r&&o?e=`${o}-${r}`:r&&(e=r),e?new Dm({dateFormat:e}):null}function hoe(t){let e;const i=nN(t),r=t.hour12==="never"?"24":null;return i&&r?e=`short-date-${i}-${r}`:i&&(e=`short-date-${i}`),e?new Dm({dateFormat:e}):null}function rN(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function nN(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function sN(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function Ab(t,e){if(!zw(t))return;const i=e?.useGrouping??"auto",r=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new d1({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:i});case"single":case"double":return new d1({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:i});case"date":case"timestamp-offset":return new hd({dateStyle:"short",timeStyle:"short",hour12:r});case"date-only":return new hd({dateStyle:"short"});case"time-only":return new hd({timeStyle:"short",hour12:r})}}let eo=class extends ms(Lt){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?coe(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?YF(e):null)}readFormat(e,i){if(!i.fieldFormat)return e?Dm.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};P([R({value:null,clonable:!1,types:ooe,json:{write:{overridePolicy(t,e,i){const{fieldName:r}=this;return{enabled:!!r&&!r.startsWith("expression/")&&!r.startsWith("relationships/")&&!!i?.writeFieldFormat}}}}})],eo.prototype,"fieldFormat",null),P([R({type:String,json:{write:!0}})],eo.prototype,"fieldName",void 0),P([R({value:null,clonable:!1,type:Dm,json:{write:!0}})],eo.prototype,"format",null),P([Fr("format")],eo.prototype,"readFormat",null),P([R({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],eo.prototype,"isEditable",void 0),P([R({type:String,json:{write:!0}})],eo.prototype,"label",void 0),P([R({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],eo.prototype,"statisticType",void 0),P([mi(new vl({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],eo.prototype,"stringFieldOption",void 0),P([R({type:String,json:{write:!0}})],eo.prototype,"tooltip",void 0),P([R({type:Boolean,json:{write:!0}})],eo.prototype,"visible",void 0),eo=P([Ge("esri.popup.FieldInfo")],eo);const oN=eo;var IE;let pu=IE=class extends bc{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new IE(dt({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};P([R({type:Object,json:{write:!0}})],pu.prototype,"attributes",void 0),P([R({type:String,json:{write:!0}})],pu.prototype,"description",void 0),P([R({type:[oN],json:{write:!0}})],pu.prototype,"fieldInfos",void 0),P([R({type:String,json:{write:!0}})],pu.prototype,"title",void 0),P([R({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],pu.prototype,"type",void 0),pu=IE=P([Ge("esri.popup.content.FieldsContent")],pu);const k0=pu;let Uh=class extends Lt{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};P([R({type:String,json:{write:!0}})],Uh.prototype,"altText",void 0),P([R({type:String,json:{write:!0}})],Uh.prototype,"caption",void 0),P([R({type:String,json:{write:!0}})],Uh.prototype,"title",void 0),P([R({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Uh.prototype,"type",void 0),Uh=P([Ge("esri.popup.content.mixins.MediaInfo")],Uh);const MP=Uh,p1={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function doe(t){return!!p1[t]||!!p1[t.toLowerCase()]}function aN(t){return p1[t]??p1[t.toLowerCase()]}function uge(t){return[...aN(t)]}function TT(t,e,i){i<0&&++i,i>1&&--i;const r=6*i;return r<1?t+(e-t)*r:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function poe(t,e,i,r=1){const o=(t%360+360)%360/360,h=i<=.5?i*(e+1):i+e-i*e,d=2*i-h;return[Math.round(255*TT(d,h,o+1/3)),Math.round(255*TT(d,h,o)),Math.round(255*TT(d,h,o-1/3)),r]}function hge(t){const e=t.length>5,i=e?8:4,r=(1<<i)-1,o=e?1:17,h=e?t.length===9:t.length===5;let d=+("0x"+t.slice(1));if(isNaN(d))return null;const a=[0,0,0,1];let _;return h&&(_=d&r,d>>=i,a[3]=o*_/255),_=d&r,d>>=i,a[2]=o*_,_=d&r,d>>=i,a[1]=o*_,_=d&r,d>>=i,a[0]=o*_,a}function lN(t){if(!t.startsWith("#")||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),i=parseInt(t.slice(2,3),16),r=parseInt(t.slice(3,4),16),o=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,i+16*i,r+16*r,(o+16*o)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function cN(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const i=e[2].split(/\s*,\s*/),r=e[1];if(r==="rgb"&&i.length===3||r==="rgba"&&i.length===4){if(i[0].endsWith("%")){const o=i.map(h=>2.56*parseFloat(h));return i.length===4&&(o[3]=parseFloat(i[3])),J5(o)}return J5(i.map(o=>parseFloat(o)))}if(r==="hsl"&&i.length===3||r==="hsla"&&i.length===4)return poe(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100,parseFloat(i[3]??"1"))}return null}function J5(t){return t[0]=Rf(t[0]),t[1]=Rf(t[1]),t[2]=Rf(t[2]),t[3]=t.length===4?hN(t[3]):1,t}function uN(t){let e=doe(t)?aN(t):null;return e??=cN(t),e??=lN(t),e}function dge(t){const e=uN(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function hN(t){return dN(t,0,1)}function Rf(t){return Math.round(dN(t,0,255))}function dN(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}const foe=2.2,moe=1/foe;function pge(t){return t**moe}const K5=new Float32Array(1);function fge(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function u_(t,e,i){return Math.min(Math.max(t,e),i)}function goe(t,e,i){return t+(e-t)*i}function mge(t,e,i,r,o){return goe(r,o,(t-e)/(i-e))}function gge(t){return t*Math.PI/180}function yge(t){return 180*t/Math.PI}function _ge(t){return Math.acos(u_(t,-1,1))}function vge(t){return Math.asin(u_(t,-1,1))}function Ta(t,e,i=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=i}function bge(t,e,i=1e-6){return!Ta(t,e,i)&&t>e}function xge(t,e,i=1e-6){return!Ta(t,e,i)&&t<e}function wge(t,e,i=1e-6){return Ta(t,e,i)||t>e}const f1=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function $E(t){return f1.setFloat64(0,t),f1.getBigInt64(0)}function yoe(t){return f1.setBigInt64(0,t),f1.getFloat64(0)}const Db=1000000n,_oe=pN(1);function pN(t){const e=$E(t=Math.abs(t)),i=yoe(e<=Db?Db:e-Db);return Math.abs(t-i)}function Sge(t,e,i=_oe){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(i!=null&&pN(Math.min(Math.abs(t),Math.abs(e)))<i)return Math.abs(t-e)<=i;const r=$E(t),o=$E(e);return r<0!=o<0?!1:!((r<o?o-r:r-o)>Db)}function fN(t,e,i=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const r=Math.abs(t-e),o=Math.abs(t),h=Math.abs(e);if(t===0||e===0||o<1e-12&&h<1e-12){if(r>.01*i)return!1}else if(r/(o+h)>i)return!1;return!0}function Tge(t){return mN(Math.max(-Q5,Math.min(t,Q5)))}function mN(t){return K5[0]=t,K5[0]}function Cge(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],r=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(Ta(e,1)&&Ta(i,1)&&Ta(r,1))}function Ege(t,e){return(t%e+e)%e}const Q5=mN(34028234663852886e22);function Ige(t,e,i){if(i===void 0||+i==0)return Math[t](e);if(e=+e,i=+i,isNaN(e)||typeof i!="number"||i%1!=0)return NaN;let r=e.toString().split("e");return r=(e=Math[t](+(r[0]+"e"+(r[1]?+r[1]-i:-i)))).toString().split("e"),+(r[0]+"e"+(r[1]?+r[1]+i:i))}function Kv(t){return u_(wP(t),0,255)}function Qv(t,e){const i=t.toString(16).padStart(2,"0");return e?i.slice(0,1):i}let or=class Mo{static blendColors(e,i,r,o=new Mo){return o.r=Math.round(e.r+(i.r-e.r)*r),o.g=Math.round(e.g+(i.g-e.g)*r),o.b=Math.round(e.b+(i.b-e.b)*r),o.a=e.a+(i.a-e.a)*r,o._sanitize()}static fromRgb(e,i){const r=cN(e);return r?Mo.fromArray(r,i):null}static fromHex(e,i=new Mo){const r=lN(e);return r?Mo.fromArray(r,i):null}static fromArray(e,i=new Mo){return i._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(e,i){const r=uN(e);return r?Mo.fromArray(r,i):null}static fromJSON(e){return e!=null?new Mo([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e,i){return e==null?null:(i??=[0,0,0,0],i[0]=e.r/255,i[1]=e.g/255,i[2]=e.b/255,i[3]=e.a!=null?e.a:1,i)}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Mo.fromString(e,this):Array.isArray(e)?Mo.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Mo||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const i=e?.capitalize??!1,r=e?.digits??6,o=r===3||r===4,h=r===4||r===8,d=`#${Qv(this.r,o)}${Qv(this.g,o)}${Qv(this.b,o)}${h?Qv(Math.round(255*this.a),o):""}`;return i?d.toUpperCase():d}toCss(e=!1){const i=this.r+", "+this.g+", "+this.b;return e?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const i=Kv(this.r),r=Kv(this.g),o=Kv(this.b);return e===0||this.a!==1?[i,r,o,Kv(255*this.a)]:[i,r,o]}clone(){return new Mo(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Rf(this.r),this.g=Rf(this.g),this.b=Rf(this.b),this.a=hN(this.a),this}_set(e,i,r,o){this.r=e,this.g=i,this.b=r,this.a=o}};or.prototype.declaredClass="esri.Color";var PE;let Vh=PE=class extends Ln{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new PE({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};P([R()],Vh.prototype,"color",void 0),P([R()],Vh.prototype,"fieldName",void 0),P([R()],Vh.prototype,"tooltip",void 0),P([R()],Vh.prototype,"value",void 0),Vh=PE=P([Ge("esri.popup.content.support.ChartMediaInfoValueSeries")],Vh);const voe=Vh;var ME;let fu=ME=class extends Lt{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new ME({colors:dt(this.colors),fields:dt(this.fields),normalizeField:this.normalizeField,series:dt(this.series),tooltipField:this.tooltipField})}};P([R({type:[or],json:{type:[[Er]],write:!0}})],fu.prototype,"colors",void 0),P([R({type:[String],json:{write:{isRequired:!0}}})],fu.prototype,"fields",void 0),P([R({type:String,json:{write:!0}})],fu.prototype,"normalizeField",void 0),P([R({type:[voe],json:{read:!1}})],fu.prototype,"series",void 0),P([R({type:String,json:{write:!0}})],fu.prototype,"tooltipField",void 0),fu=ME=P([Ge("esri.popup.content.support.ChartMediaInfoValue")],fu);const boe=fu;let Ty=class extends MP{constructor(e){super(e),this.type=null,this.value=void 0}};P([R({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Ty.prototype,"type",void 0),P([R({type:boe,json:{write:{isRequired:!0}}})],Ty.prototype,"value",void 0),Ty=P([Ge("esri.popup.content.mixins.ChartMediaInfo")],Ty);const Ow=Ty,Rw=yo()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var kE;let zb=kE=class extends Ow{constructor(t){super(t),this.type="bar-chart"}clone(){return new kE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};P([R({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:Rw.write,isRequired:!0}}})],zb.prototype,"type",void 0),zb=kE=P([Ge("esri.popup.content.BarChartMediaInfo")],zb);const gN=zb;var AE;let Ob=AE=class extends Ow{constructor(t){super(t),this.type="column-chart"}clone(){return new AE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};P([R({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:Rw.write,isRequired:!0}}})],Ob.prototype,"type",void 0),Ob=AE=P([Ge("esri.popup.content.ColumnChartMediaInfo")],Ob);const yN=Ob;var DE;let Cy=DE=class extends Lt{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new DE({linkURL:this.linkURL,sourceURL:this.sourceURL})}};P([R({type:String,json:{write:!0}})],Cy.prototype,"linkURL",void 0),P([R({type:String,json:{write:{isRequired:!0}}})],Cy.prototype,"sourceURL",void 0),Cy=DE=P([Ge("esri.popup.content.support.ImageMediaInfoValue")],Cy);const xoe=Cy;var zE;let sf=zE=class extends MP{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new zE({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};P([R({type:Number,json:{write:!0}})],sf.prototype,"refreshInterval",void 0),P([R({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],sf.prototype,"type",void 0),P([R({type:xoe,json:{write:{isRequired:!0}}})],sf.prototype,"value",void 0),sf=zE=P([Ge("esri.popup.content.ImageMediaInfo")],sf);const _N=sf;var OE;let Rb=OE=class extends Ow{constructor(t){super(t),this.type="line-chart"}clone(){return new OE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};P([R({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:Rw.write,isRequired:!0}}})],Rb.prototype,"type",void 0),Rb=OE=P([Ge("esri.popup.content.LineChartMediaInfo")],Rb);const vN=Rb;var RE;let Lb=RE=class extends Ow{constructor(t){super(t),this.type="pie-chart"}clone(){return new RE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};P([R({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:Rw.write,isRequired:!0}}})],Lb.prototype,"type",void 0),Lb=RE=P([Ge("esri.popup.content.PieChartMediaInfo")],Lb);const bN=Lb,LE={base:MP,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":gN,"column-chart":yN,"line-chart":vN,"pie-chart":bN,image:_N}};var FE;let da=FE=class extends bc{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?_N.fromJSON(e):e.type==="barchart"?gN.fromJSON(e):e.type==="columnchart"?yN.fromJSON(e):e.type==="linechart"?vN.fromJSON(e):e.type==="piechart"?bN.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(i=>i.toJSON())}clone(){return new FE(dt({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};P([R()],da.prototype,"activeMediaInfoIndex",void 0),P([R({type:Object,json:{write:!0}})],da.prototype,"attributes",void 0),P([R({type:String,json:{write:!0}})],da.prototype,"description",void 0),P([R({types:[LE]})],da.prototype,"mediaInfos",void 0),P([Fr("mediaInfos")],da.prototype,"readMediaInfos",null),P([Bi("mediaInfos")],da.prototype,"writeMediaInfos",null),P([R({type:String,json:{write:!0}})],da.prototype,"title",void 0),P([R({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],da.prototype,"type",void 0),da=FE=P([Ge("esri.popup.content.MediaContent")],da);const A0=da;var NE;let Ey=NE=class extends Lt{constructor(t){super(t),this.field=null,this.order=null}clone(){return new NE({field:this.field,order:this.order})}};P([R({type:String,json:{write:!0}})],Ey.prototype,"field",void 0),P([R({type:["asc","desc"],json:{write:!0}})],Ey.prototype,"order",void 0),Ey=NE=P([Ge("esri.popup.support.RelatedRecordsInfoFieldOrder")],Ey);const xN=Ey;let el=class extends ms(bc){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};P([R({type:String,json:{write:!0}})],el.prototype,"description",void 0),P([R({type:Number,json:{type:Er,write:!0}})],el.prototype,"displayCount",void 0),P([R({type:["list"],json:{write:{isRequired:!0}}})],el.prototype,"displayType",void 0),P([R({type:[xN],json:{write:!0}})],el.prototype,"orderByFields",void 0),P([R({type:Number,json:{type:Er,write:{isRequired:!0}}})],el.prototype,"relationshipId",void 0),P([R({type:String,json:{write:!0}})],el.prototype,"title",void 0),P([R({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],el.prototype,"type",void 0),el=P([Ge("esri.popup.content.RelationshipContent")],el);const D0=el;var BE;let Iy=BE=class extends bc{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new BE({text:this.text})}};P([R({type:String,json:{write:!0}})],Iy.prototype,"text",void 0),P([R({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Iy.prototype,"type",void 0),Iy=BE=P([Ge("esri.popup.content.TextContent")],Iy);const z0=Iy;let tc=class extends ms(Lt){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};P([R({type:String,json:{write:!0}})],tc.prototype,"title",void 0),P([R({type:String,json:{write:!0}})],tc.prototype,"description",void 0),P([R({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],tc.prototype,"type",void 0),P([R({type:Number,json:{type:Er,write:!0}})],tc.prototype,"associatedNetworkSourceId",void 0),P([R({type:Number,json:{type:Er,write:!0}})],tc.prototype,"associatedAssetGroup",void 0),P([R({type:Number,json:{type:Er,write:!0}})],tc.prototype,"associatedAssetType",void 0),tc=P([Ge("esri.popup.support.UtilityNetworkAssociationType")],tc);const woe=tc;let mu=class extends ms(bc){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};P([R({type:String,json:{write:!0}})],mu.prototype,"description",void 0),P([R({type:Number,json:{type:Er,write:!0}})],mu.prototype,"displayCount",void 0),P([R({type:String,json:{write:!0}})],mu.prototype,"title",void 0),P([R({type:[woe],json:{write:!0}})],mu.prototype,"associationTypes",void 0),P([mi({utilityNetworkAssociations:"utility-network-associations"})],mu.prototype,"type",void 0),mu=P([Ge("esri.popup.content.UtilityNetworkAssociationsContent")],mu);const kP=mu,Soe={base:null,key:"type",typeMap:{attachment:M0,media:A0,text:z0,expression:Dw,field:k0,relationship:D0,utilityNetworkAssociations:kP}},Toe={base:null,key:"type",typeMap:{attachment:M0,media:A0,text:z0,expression:Dw,field:k0,relationship:D0}};var jE;let Gh=jE=class extends Lt{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new jE({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};P([R({type:String,json:{write:!0}})],Gh.prototype,"name",void 0),P([R({type:String,json:{write:!0}})],Gh.prototype,"title",void 0),P([R({type:String,json:{write:!0}})],Gh.prototype,"expression",void 0),P([R({type:["string","number"],json:{write:!0}})],Gh.prototype,"returnType",void 0),Gh=jE=P([Ge("esri.popup.ExpressionInfo")],Gh);const Coe=Gh;var UE;let $y=UE=class extends Lt{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new UE({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};P([R({type:Boolean,json:{write:!0}})],$y.prototype,"returnTopmostRaster",void 0),P([R({type:Boolean,json:{write:!0}})],$y.prototype,"showNoDataRecords",void 0),$y=UE=P([Ge("esri.popup.LayerOptions")],$y);const Eoe=$y;var VE;let Py=VE=class extends Lt{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new VE({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?dt(this.orderByFields):null})}};P([R({type:Boolean,json:{write:!0}})],Py.prototype,"showRelatedRecords",void 0),P([R({type:[xN],json:{write:!0}})],Py.prototype,"orderByFields",void 0),Py=VE=P([Ge("esri.popup.RelatedRecordsInfo")],Py);const ez=Py;let wN=0;const Lw=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+wN++})}};return i=P([Ge("esri.core.Identifiable")],i),i},Age=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:wN++})}};return i=P([Ge("esri.core.Identifiable.NumericIdentifiable")],i),i};Lw(class{});var GE;let ko=GE=class extends Lw(Ln){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new GE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};P([R()],ko.prototype,"active",void 0),P([R()],ko.prototype,"className",void 0),P([R()],ko.prototype,"disabled",void 0),P([R()],ko.prototype,"icon",void 0),P([R()],ko.prototype,"id",void 0),P([R()],ko.prototype,"indicator",void 0),P([R()],ko.prototype,"title",void 0),P([R()],ko.prototype,"type",void 0),P([R()],ko.prototype,"visible",void 0),ko=GE=P([Ge("esri.support.actions.ActionBase")],ko);const AP=ko;var qE;let Fb=qE=class extends AP{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new qE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};P([R()],Fb.prototype,"image",void 0),Fb=qE=P([Ge("esri.support.actions.ActionButton")],Fb);const Ioe=Fb;var HE;let My=HE=class extends AP{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new HE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};P([R()],My.prototype,"image",void 0),P([R()],My.prototype,"value",void 0),My=HE=P([Ge("esri.support.actions.ActionToggle")],My);const $oe=My,sy="relationships/",tz="expression/",Poe=nr.ofType({key:"type",defaultKeyValue:"button",base:AP,typeMap:{button:Ioe,toggle:$oe}}),Moe={base:bc,key:"type",typeMap:{media:A0,custom:noe,text:z0,attachments:M0,fields:k0,expression:Dw,relationship:D0,utilityNetworkAssociations:kP}},SN=new Set(["attachments","fields","media","text","expression","relationship"]),koe=new Set([...SN,"utility-network-associations"]);let Yr=class extends ms(Lt){constructor(e){super(e),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(i=>fm(Moe,i)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||s4(e)?e:(ui.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,i){const{popupElements:r}=i;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,r):this._readPopupInfo(i)}writeWebSceneContent(e,i,r,o){this._writePopupTemplateContent(e,i,o)}writeWebMapContent(e,i,r,o){this._writePopupTemplateContent(e,i,o)}writeFieldInfos(e,i,r,o){const{content:h}=this,d=Array.isArray(h)?h:null,{writeFieldFormat:a,..._}=o||{};if(e){const T=d?d.filter(k=>k.type==="fields"):[],E=T.length&&T.every(k=>k.fieldInfos?.length);i.fieldInfos=e.filter(Boolean).map(k=>{const L=k.toJSON(_);return E&&(L.visible=!1),L})}if(d)for(const T of d)T.type==="fields"&&this._writeFieldsContent(T,i,_)}writeLayerOptions(e,i,r,o){i[r]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(o)}writeTitle(e,i){i.title=e||""}async collectRequiredFields(e,i,r){const o=this.expressionInfos||[];await this._collectExpressionInfoFields(e,i,r,[...o,...this._getContentExpressionInfos(this.content,o)]),$P(e,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e,i){const r=new Set;return await this.collectRequiredFields(r,e,i),[...r].sort()}_writePopupTemplateContent(e,i,r){typeof e!="string"?Array.isArray(e)&&(i.popupElements=e.filter(o=>r?.origin==="web-scene"?SN.has(o.type):koe.has(o.type)).map(o=>o?.toJSON(r)),i.popupElements.forEach(o=>{o.type==="attachments"?this._writeAttachmentContent(i):o.type==="media"?this._writeMediaContent(o,i):o.type==="text"?this._writeTextContent(o,i):o.type==="relationship"&&this._writeRelationshipContent(o,i)})):i.description=e}_writeFieldsContent(e,i,r){const o=e.fieldInfos;if(!Array.isArray(o)||!o.length)return;const h=i.fieldInfos;if(Array.isArray(h))for(const d of o){const a=h.find(_=>_.fieldName?.toLowerCase()===d.fieldName?.toLowerCase());a?a.visible=!0:h.push(d.toJSON(r))}else i.fieldInfos=o.map(d=>d.toJSON(r))}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,i){const r=e.orderByFields?.map(h=>this._toFieldOrderJSON(h,e.relationshipId))||[],o=[...i.relatedRecordsInfo?.orderByFields||[],...r];i.relatedRecordsInfo={showRelatedRecords:!0,...o?.length&&{orderByFields:o}}}_writeTextContent(e,i){!i.description&&e.text&&(i.description=e.text)}_writeMediaContent(e,i){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=dt(e.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...r]:i.mediaInfos=r}_readPopupInfoElements(e,i,r){const o={description:!1,mediaInfos:!1};return r.map(h=>h.type==="media"?(h.mediaInfos||!i||o.mediaInfos||(h.mediaInfos=i,o.mediaInfos=!0),A0.fromJSON(h)):h.type==="text"?(h.text||!e||o.description||(h.text=e,o.description=!0),z0.fromJSON(h)):h.type==="attachments"?M0.fromJSON(h):h.type==="fields"?k0.fromJSON(h):h.type==="expression"?Dw.fromJSON(h):h.type==="relationship"?D0.fromJSON(h):h.type==="utilityNetworkAssociations"?kP.fromJSON(h):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:i,order:r}=e;if(!i?.startsWith(sy))return null;const o=i.replace(sy,"").split("/");if(o.length!==2)return null;const h=parseInt(o[0],10),d=o[1];return!Number.isNaN(h)&&d?D0.fromJSON({relationshipId:h,orderByFields:[{field:d,order:r}]}):null}_toFieldOrderJSON(e,i){const{order:r,field:o}=e;return{field:`${sy}${i}/${o}`,order:r}}_readPopupInfo({description:e,mediaInfos:i,showAttachments:r,relatedRecordsInfo:o={showRelatedRecords:!1}}){const h=[];e?h.push(new z0({text:e})):h.push(new k0),Array.isArray(i)&&i.length&&h.push(A0.fromJSON({mediaInfos:i})),r&&h.push(M0.fromJSON({displayType:"auto"}));const{showRelatedRecords:d,orderByFields:a}=o;return d&&a?.length&&a.forEach(_=>{const T=this._toRelationshipContent(_);T&&h.push(T)}),h.length?h:e}_getContentElementFields(e){const i=e?.type;if(i==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(i==="custom")return e.outFields||[];if(i==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(i==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((o,h)=>[...o,...this._getMediaInfoFields(h)],[])]}return i==="text"?this._extractFieldNames(e.text):i==="relationship"||i==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:i,title:r,value:o}=e,h=o||{},{fields:d,normalizeField:a,tooltipField:_,sourceURL:T,linkURL:E}=h,k=[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(T),...this._extractFieldNames(E),...d??[]];return a&&k.push(a),_&&k.push(_),k}_getContentExpressionInfos(e,i){return Array.isArray(e)?e.reduce((r,o)=>[...r,...o.type==="expression"&&o.expressionInfo?[o.expressionInfo]:[]],i):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((i,r)=>[...i,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(e,i,r,o){o&&await Promise.all(o.map(h=>RF(e,i,r,h.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:i,visible:r})=>!(r!==void 0&&!r||!i||i.startsWith(sy)||i.startsWith(tz))).map(i=>i.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((i,r)=>[...i,...this._getActionFields(r)],[]):[]}_getActionFields(e){const{className:i,title:r,type:o}=e,h=o==="button"||o==="toggle"?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(h)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return ioe(e).filter(i=>!(i.startsWith(sy)||i.startsWith(tz)))}};P([R({type:Poe})],Yr.prototype,"actions",void 0),P([R()],Yr.prototype,"content",void 0),P([l_("content")],Yr.prototype,"castContent",null),P([Fr("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],Yr.prototype,"readContent",null),P([Bi("web-scene","content",{popupElements:{type:nr.ofType(Toe)},showAttachments:{type:Boolean},mediaInfos:{type:nr.ofType(LE)},description:{type:String},relatedRecordsInfo:{type:ez}})],Yr.prototype,"writeWebSceneContent",null),P([Bi("content",{popupElements:{type:nr.ofType(Soe)},showAttachments:{type:Boolean},mediaInfos:{type:nr.ofType(LE)},description:{type:String},relatedRecordsInfo:{type:ez}})],Yr.prototype,"writeWebMapContent",null),P([R({type:[Coe],json:{write:!0}})],Yr.prototype,"expressionInfos",void 0),P([R({type:[oN]})],Yr.prototype,"fieldInfos",void 0),P([Bi("fieldInfos")],Yr.prototype,"writeFieldInfos",null),P([R({type:Eoe})],Yr.prototype,"layerOptions",void 0),P([Bi("layerOptions")],Yr.prototype,"writeLayerOptions",null),P([R({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],Yr.prototype,"lastEditInfoEnabled",void 0),P([R()],Yr.prototype,"outFields",void 0),P([R()],Yr.prototype,"overwriteActions",void 0),P([R()],Yr.prototype,"returnGeometry",void 0),P([R({json:{type:String}})],Yr.prototype,"title",void 0),P([Bi("title")],Yr.prototype,"writeTitle",null),Yr=P([Ge("esri.PopupTemplate")],Yr);const O0=Yr;let DP=class{constructor(e,i,r,o,h,d){this.semiMajorAxis=e,this.flattening=i,this.outerAtmosphereRimWidth=r,this.atmosphereHeight=o,this.scaleHeight=h;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=d||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Pa=new DP(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),R0=new DP(3396190,1/169.8944472236118,23e4,6e4,.111),Fw=new DP(1737400,0,0,0,0);let CT,_e=null;function Aoe(){return!!_e}function Doe(){return!!Ve("esri-wasm")}function zoe(){return CT||(CT=Kn(async()=>{const{default:t}=await import("./pe-wasm-B87Q3u4k.js");return{default:t}},[]).then(({default:t})=>t({locateFile:e=>bP(`esri/geometry/support/${e}`)})).then(t=>{PN(t)}),CT)}const Nb={geogToProj(t,e,i){_e.ensureCache.prepare();const r=wd(i),o=i===r,h=_e.ensureFloat64(r),d=_e._pe_geog_to_proj(_e.getPointer(t),e,h);return d&&qu(i,e,h,o),d},projGeog(t,e,i,r){switch(r){case fr.PE_TRANSFORM_P_TO_G:return Nb.projToGeog(t,e,i);case fr.PE_TRANSFORM_G_TO_P:return Nb.geogToProj(t,e,i)}return 0},projToGeog:(t,e,i)=>Nb.projToGeogCenter(t,e,i,0),projToGeogCenter(t,e,i,r){_e.ensureCache.prepare();const o=wd(i),h=i===o,d=_e.ensureFloat64(o),a=_e._pe_proj_to_geog_center(_e.getPointer(t),e,d,r);return a&&qu(i,e,d,h),a}};let fr=class bi{static init(){bi.PE_BUFFER_MAX=_e.PeDefs.prototype.PE_BUFFER_MAX,bi.PE_NAME_MAX=_e.PeDefs.prototype.PE_NAME_MAX,bi.PE_MGRS_MAX=_e.PeDefs.prototype.PE_MGRS_MAX,bi.PE_USNG_MAX=_e.PeDefs.prototype.PE_USNG_MAX,bi.PE_DD_MAX=_e.PeDefs.prototype.PE_DD_MAX,bi.PE_DDM_MAX=_e.PeDefs.prototype.PE_DDM_MAX,bi.PE_DMS_MAX=_e.PeDefs.prototype.PE_DMS_MAX,bi.PE_UTM_MAX=_e.PeDefs.prototype.PE_UTM_MAX,bi.PE_PARM_MAX=_e.PeDefs.prototype.PE_PARM_MAX,bi.PE_TYPE_NONE=_e.PeDefs.prototype.PE_TYPE_NONE,bi.PE_TYPE_GEOGCS=_e.PeDefs.prototype.PE_TYPE_GEOGCS,bi.PE_TYPE_PROJCS=_e.PeDefs.prototype.PE_TYPE_PROJCS,bi.PE_TYPE_GEOGTRAN=_e.PeDefs.prototype.PE_TYPE_GEOGTRAN,bi.PE_TYPE_COORDSYS=_e.PeDefs.prototype.PE_TYPE_COORDSYS,bi.PE_TYPE_UNIT=_e.PeDefs.prototype.PE_TYPE_UNIT,bi.PE_TYPE_LINUNIT=_e.PeDefs.prototype.PE_TYPE_LINUNIT,bi.PE_STR_OPTS_NONE=_e.PeDefs.prototype.PE_STR_OPTS_NONE,bi.PE_STR_AUTH_NONE=_e.PeDefs.prototype.PE_STR_AUTH_NONE,bi.PE_STR_AUTH_TOP=_e.PeDefs.prototype.PE_STR_AUTH_TOP,bi.PE_STR_NAME_CANON=_e.PeDefs.prototype.PE_STR_NAME_CANON,bi.PE_STR_FMT_WKT=_e.PeDefs.prototype.PE_STR_FMT_WKT,bi.PE_STR_FMT_WKT2=_e.PeDefs.prototype.PE_STR_FMT_WKT2,bi.PE_PARM_X0=_e.PeDefs.prototype.PE_PARM_X0,bi.PE_PARM_ND=_e.PeDefs.prototype.PE_PARM_ND,bi.PE_TRANSFORM_1_TO_2=_e.PeDefs.prototype.PE_TRANSFORM_1_TO_2,bi.PE_TRANSFORM_2_TO_1=_e.PeDefs.prototype.PE_TRANSFORM_2_TO_1,bi.PE_TRANSFORM_P_TO_G=_e.PeDefs.prototype.PE_TRANSFORM_P_TO_G,bi.PE_TRANSFORM_G_TO_P=_e.PeDefs.prototype.PE_TRANSFORM_G_TO_P,bi.PE_HORIZON_RECT=_e.PeDefs.prototype.PE_HORIZON_RECT,bi.PE_HORIZON_POLY=_e.PeDefs.prototype.PE_HORIZON_POLY,bi.PE_HORIZON_LINE=_e.PeDefs.prototype.PE_HORIZON_LINE,bi.PE_HORIZON_DELTA=_e.PeDefs.prototype.PE_HORIZON_DELTA}},TN=null;const iz={},rz={},nz=t=>{const e=t.getType();switch(e){case fr.PE_TYPE_GEOGCS:t=_e.castObject(t,_e.PeGeogcs);break;case fr.PE_TYPE_PROJCS:t=_e.castObject(t,_e.PeProjcs);break;case fr.PE_TYPE_GEOGTRAN:t=_e.castObject(t,_e.PeGeogtran);break;default:e&fr.PE_TYPE_UNIT&&(t=_e.castObject(t,_e.PeUnit))}return t},of={initialize(){_e.PeFactory.prototype.initialize(null)},coordsys:t=>of.factoryByType(fr.PE_TYPE_COORDSYS,t),factoryByType(t,e){let i=null,r=iz[t];if(r||(r={},iz[t]=r),r.hasOwnProperty(String(e))&&(i=r[e],_e.compare(i,_e.NULL)&&(i=null)),!i){const o=_e.PeFactory.prototype.factoryByType(t,e);_e.compare(o,_e.NULL)||(i=nz(o),r[e]=i)}return i},fromString(t,e){let i=null,r=rz[t];if(r||(r={},rz[t]=r),r.hasOwnProperty(e)&&(i=r[e],_e.compare(i,_e.NULL)&&(i=null)),!i){const o=_e.PeFactory.prototype.fromString(t,e);_e.compare(o,_e.NULL)||(i=nz(o),r[e]=i)}return i},geogcs:t=>of.factoryByType(fr.PE_TYPE_GEOGCS,t),geogtran:t=>of.factoryByType(fr.PE_TYPE_GEOGTRAN,t),getCode:t=>_e.PeFactory.prototype.getCode(t),projcs:t=>of.factoryByType(fr.PE_TYPE_PROJCS,t),unit:t=>of.factoryByType(fr.PE_TYPE_UNIT,t)};let sz,CN=null;const zP={PE_GTLIST_OPTS_COMMON:0,init(){zP.PE_GTLIST_OPTS_COMMON=_e.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,sz=_e._pe_getPeGTlistExtendedEntrySize()},getGTlist(t,e,i,r,o,h){let d=null;const a=new _e.PeInteger(h);try{const _=_e.PeGTlistExtended.prototype.getGTlist(t,e,i,r,o,a);if((h=a.val)&&(d=[_],h>1)){const T=_e.getPointer(_);for(let E=1;E<h;E++)d.push(_e.wrapPointer(T+sz*E,_e.PeGTlistExtendedEntry))}}finally{_e.destroy(a)}return d}},Ooe={destroy(t){if(t?.length){for(const e of t)ma(e),e.getEntries().forEach(i=>{ma(i);const r=i.getGeogtran();ma(r),r.getParameters().forEach(ma),[r.getGeogcs1(),r.getGeogcs2()].forEach(o=>{ma(o);const h=o.getDatum();ma(h),ma(h.getSpheroid()),ma(o.getPrimem()),ma(o.getUnit())})});_e.PeGTlistExtendedEntry.prototype.Delete(t[0])}}},Roe={geogToGeog(t,e,i,r,o){_e.ensureCache.prepare();const h=wd(i),d=i===h,a=_e.ensureFloat64(h);let _=0;r&&(_=_e.ensureFloat64(r));const T=_e._pe_geog_to_geog(_e.getPointer(t),e,a,_,o);return T&&qu(i,e,a,d),T}},Loe={geodesicCoordinate(t,e,i,r,o,h,d,a){_e.PeLineType.prototype.geodesic_coordinate(t,e,i,r,o,h,d,a)},geodeticCoordinate(t,e,i,r,o,h,d,a,_){_e.PeLineType.prototype.geodetic_coordinate(t,e,i,r,o,h,d,a,_)},geodeticDistance(t,e,i,r,o,h,d,a,_,T){_e.PeLineType.prototype.geodetic_distance(t,e,i,r,o,h,d,a,_,T)},greatEllipticDistance(t,e,i,r,o,h,d,a,_){_e.PeLineType.prototype.great_elliptic_distance(t,e,i,r,o,h,d,a,_)}},Foe={phiToEta:(t,e)=>_e.PeMath.prototype.phi_to_eta(t,e),etaToPhi:(t,e)=>_e.PeMath.prototype.eta_to_phi(t,e),phiToPhig:(t,e)=>_e.PeMath.prototype.phi_to_phig(t,e),q:(t,e,i)=>_e.PeMath.prototype.q(t,e,i),q90:(t,e)=>_e.PeMath.prototype.q90(t,e)},ET=(t,e,i,r,o,h)=>{let d,a;switch(_e.ensureCache.prepare(),t){case"dd":d=_e._pe_geog_to_dd,a=fr.PE_DD_MAX;break;case"ddm":d=_e._pe_geog_to_ddm,a=fr.PE_DDM_MAX;break;case"dms":d=_e._pe_geog_to_dms,a=fr.PE_DMS_MAX}let _=0;e&&(_=_e.getPointer(e));const T=wd(r),E=_e.ensureFloat64(T),k=Nw(i,a),L=d(_,i,E,o,_e.ensureInt32(k));if(L)for(let O=0;O<i;O++)h[O]=_e.UTF8ToString(k[O]);return L},IT=(t,e,i,r,o)=>{let h;switch(_e.ensureCache.prepare(),t){case"dd":h=_e._pe_dd_to_geog;break;case"ddm":h=_e._pe_ddm_to_geog;break;case"dms":h=_e._pe_dms_to_geog}let d=0;e&&(d=_e.getPointer(e));const a=r.map(k=>_e.ensureString(k)),_=_e.ensureInt32(a),T=_e.ensureFloat64(new Array(2*i)),E=h(d,i,_,T);return E&&qu(o,i,T),E},Noe={geogToDms:(t,e,i,r,o)=>ET("dms",t,e,i,r,o),dmsToGeog:(t,e,i,r)=>IT("dms",t,e,i,r),geogToDdm:(t,e,i,r,o)=>ET("ddm",t,e,i,r,o),ddmToGeog:(t,e,i,r)=>IT("ddm",t,e,i,r),geogToDd:(t,e,i,r,o)=>ET("dd",t,e,i,r,o),ddToGeog:(t,e,i,r)=>IT("dd",t,e,i,r)};let EN=class af{static init(){af.PE_MGRS_STYLE_NEW=_e.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,af.PE_MGRS_STYLE_OLD=_e.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,af.PE_MGRS_STYLE_AUTO=_e.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,af.PE_MGRS_180_ZONE_1_PLUS=_e.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,af.PE_MGRS_ADD_SPACES=_e.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,i,r,o,h,d,a){_e.ensureCache.prepare();let _=0;e&&(_=_e.getPointer(e));const T=wd(r),E=_e.ensureFloat64(T),k=Nw(i,fr.PE_MGRS_MAX),L=_e.ensureInt32(k),O=_e._pe_geog_to_mgrs_extended(_,i,E,o,h,d,L);if(O)for(let H=0;H<i;H++)a[H]=_e.UTF8ToString(k[H]);return O}static mgrsToGeogExtended(e,i,r,o,h){_e.ensureCache.prepare();let d=0;e&&(d=_e.getPointer(e));const a=r.map(k=>_e.ensureString(k)),_=_e.ensureInt32(a),T=_e.ensureFloat64(new Array(2*i)),E=_e._pe_mgrs_to_geog_extended(d,i,_,o,T);return E&&qu(h,i,T),E}};const Boe={geogToUsng(t,e,i,r,o,h,d){_e.ensureCache.prepare();let a=0;t&&(a=_e.getPointer(t));const _=wd(i),T=_e.ensureFloat64(_),E=Nw(e,fr.PE_MGRS_MAX),k=_e.ensureInt32(E),L=_e._pe_geog_to_usng(a,e,T,r,o,h,k);if(L)for(let O=0;O<e;O++)d[O]=_e.UTF8ToString(E[O]);return L},usngToGeog(t,e,i,r){_e.ensureCache.prepare();let o=0;t&&(o=_e.getPointer(t));const h=i.map(T=>_e.ensureString(T)),d=_e.ensureInt32(h),a=_e.ensureFloat64(new Array(2*e)),_=_e._pe_usng_to_geog(o,e,d,a);return _&&qu(r,e,a),_}};let IN=class Bb{static init(){Bb.PE_UTM_OPTS_NONE=_e.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,Bb.PE_UTM_OPTS_ADD_SPACES=_e.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,Bb.PE_UTM_OPTS_NS=_e.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,i,r,o,h){_e.ensureCache.prepare();let d=0;e&&(d=_e.getPointer(e));const a=wd(r),_=_e.ensureFloat64(a),T=Nw(i,fr.PE_UTM_MAX),E=_e.ensureInt32(T),k=_e._pe_geog_to_utm(d,i,_,o,E);if(k)for(let L=0;L<i;L++)h[L]=_e.UTF8ToString(T[L]);return k}static utmToGeog(e,i,r,o,h){_e.ensureCache.prepare();let d=0;e&&(d=_e.getPointer(e));const a=r.map(k=>_e.ensureString(k)),_=_e.ensureInt32(a),T=_e.ensureFloat64(new Array(2*i)),E=_e._pe_utm_to_geog(d,i,_,o,T);return E&&qu(h,i,T),E}};var Is;let $N=(Is=class{static init(){Is.PE_PCSINFO_OPTION_NONE=_e.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,Is.PE_PCSINFO_OPTION_DOMAIN=_e.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,Is.PE_POLE_OUTSIDE_BOUNDARY=_e.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,Is.PE_POLE_POINT=_e.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,i=Is.PE_PCSINFO_OPTION_DOMAIN){let r=null,o=null;return Is.cache.has(e)&&(o=Is.cache.get(e),o[i]&&(r=o[i])),r||(r=_e.PePCSInfo.prototype.generate(e,i),o||(o=[],Is.cache.set(e,o)),o[i]=r),r}},Is.cache=new Map,Is);const joe={versionString:()=>_e.PeVersion.prototype.version_string()};function PN(t){function e(h,d,a){h[d]=a(h[d])}_e=t,fr.init(),zP.init(),EN.init(),IN.init(),$N.init(),TN=class extends _e.PeDouble{constructor(h=NaN){super(h)}destroy(){_e.destroy(this)}[Symbol.dispose](){this.destroy()}},CN=class extends _e.PeGCSExtent{destroy(){_e.destroy(this)}[Symbol.dispose](){this.destroy()}};const i=[_e.PeAngunit,_e.PeDatum,_e.PeGeogcs,_e.PeGeogtran,_e.PeObject,_e.PeParameter,_e.PePrimem,_e.PeProjcs,_e.PeSpheroid,_e.PeUnit];for(const h of i)e(h.prototype,"getName",d=>function(){return d.call(this,new Array(fr.PE_NAME_MAX))});for(const h of[_e.PeGeogtran,_e.PeProjcs])e(h.prototype,"getParameters",d=>function(){const a=new Array(fr.PE_PARM_MAX);let _=d.call(this);for(let T=0;T<a.length;T++){const E=_e.getValue(_,"*");a[T]=E?_e.wrapPointer(E,_e.PeParameter):null,_+=Int32Array.BYTES_PER_ELEMENT}return a});e(_e.PeHorizon.prototype,"getCoord",h=>function(d=!1){const a=this.getSize();if(!a)return null;const _=[];return qu(_,a,h.call(this),d),_}),e(_e.PeGTlistExtendedEntry.prototype,"getEntries",h=>{const d=_e._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const _=h.call(this);if(!_e.compare(_,_e.NULL)){a=[_];const T=this.getSteps();if(T>1){const E=_e.getPointer(_);for(let k=1;k<T;k++)a.push(_e.wrapPointer(E+d*k,_e.PeGTlistExtendedGTs))}}return a}});const r=_e._pe_getPeHorizonSize(),o=h=>function(){let d=this._cache;if(d||(d=new Map,this._cache=d),d.has(h))return d.get(h);let a=null;const _=h.call(this);if(!_e.compare(_,_e.NULL)){a=[_];const T=_.getNump();if(T>1){const E=_e.getPointer(_);for(let k=1;k<T;k++)a.push(_e.wrapPointer(E+r*k,_e.PeHorizon))}}return d.set(h,a),a};e(_e.PeProjcs.prototype,"horizonGcsGenerate",o),e(_e.PeProjcs.prototype,"horizonPcsGenerate",o),_e.PeObject.prototype.toString=function(h=fr.PE_STR_OPTS_NONE){_e.ensureCache.prepare();const d=_e.getPointer(this),a=_e.ensureInt8(new Array(fr.PE_BUFFER_MAX));return _e.UTF8ToString(_e._pe_object_to_string_ext(d,h,a))},_e.PeGeogcs.prototype.destroy=function(){this.Delete(),ma(this),this.ptr=0},_e.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},_e.PeProjcs.prototype.destroy=function(){this.Delete(),ma(this),this.ptr=0},_e.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function ma(t){if(!t)return;const e=_e.getClass(t);if(!e)return;const i=_e.getCache(e);if(!i)return;const r=_e.getPointer(t);r&&delete i[r]}function Nw(t,e){const i=[],r=new Array(e);for(let o=0;o<t;o++)i.push(_e.ensureInt8(r));return i}function wd(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function qu(t,e,i,r=!1){if(r)for(let o=0;o<2*e;o++)t[o]=_e.getValue(i+o*Float64Array.BYTES_PER_ELEMENT,"double");else{const o=t.length===0;for(let h=0;h<e;h++)o&&(t[h]=new Array(2)),t[h][0]=_e.getValue(i,"double"),t[h][1]=_e.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}const Oge=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:Nb,PeDefs:fr,get PeDouble(){return TN},PeFactory:of,get PeGCSExtent(){return CN},PeGTTransformations:Roe,PeGTlistExtended:zP,PeGTlistExtendedEntry:Ooe,PeLineType:Loe,PeMath:Foe,PeNotationDms:Noe,PeNotationMgrs:EN,PeNotationUsng:Boe,PeNotationUtm:IN,PePCSInfo:$N,PeVersion:joe,_init:PN,get _pe(){return _e},isLoaded:Aoe,isSupported:Doe,load:zoe},Symbol.toStringTag,{value:"Module"}));let y;const Z={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(y=2e3;y<=2045;y++)Z[y]=0;for(y=2056;y<=2065;y++)Z[y]=0;for(y=2067;y<=2135;y++)Z[y]=0;for(y=2137;y<=2154;y++)Z[y]=0;for(y=2161;y<=2170;y++)Z[y]=0;for(y=2172;y<=2193;y++)Z[y]=0;for(y=2195;y<=2198;y++)Z[y]=0;for(y=2200;y<=2203;y++)Z[y]=0;for(y=2205;y<=2217;y++)Z[y]=0;for(y=2222;y<=2224;y++)Z[y]=1;for(y=2225;y<=2250;y++)Z[y]=2;for(y=2251;y<=2253;y++)Z[y]=1;for(y=2257;y<=2264;y++)Z[y]=2;for(y=2274;y<=2279;y++)Z[y]=2;for(y=2280;y<=2282;y++)Z[y]=1;for(y=2283;y<=2289;y++)Z[y]=2;for(y=2290;y<=2292;y++)Z[y]=0;for(y=2308;y<=2313;y++)Z[y]=0;for(y=2315;y<=2491;y++)Z[y]=0;for(y=2494;y<=2866;y++)Z[y]=0;for(y=2867;y<=2869;y++)Z[y]=1;for(y=2870;y<=2888;y++)Z[y]=2;for(y=2891;y<=2895;y++)Z[y]=2;for(y=2896;y<=2898;y++)Z[y]=1;for(y=2902;y<=2908;y++)Z[y]=2;for(y=2915;y<=2920;y++)Z[y]=2;for(y=2921;y<=2923;y++)Z[y]=1;for(y=2924;y<=2930;y++)Z[y]=2;for(y=2931;y<=2962;y++)Z[y]=0;for(y=2964;y<=2968;y++)Z[y]=2;for(y=2969;y<=2973;y++)Z[y]=0;for(y=2975;y<=2991;y++)Z[y]=0;for(y=2995;y<=3051;y++)Z[y]=0;for(y=3054;y<=3079;y++)Z[y]=0;for(y=3081;y<=3088;y++)Z[y]=0;for(y=3092;y<=3101;y++)Z[y]=0;for(y=3106;y<=3138;y++)Z[y]=0;for(y=3146;y<=3151;y++)Z[y]=0;for(y=3153;y<=3166;y++)Z[y]=0;for(y=3168;y<=3172;y++)Z[y]=0;for(y=3174;y<=3203;y++)Z[y]=0;for(y=3294;y<=3358;y++)Z[y]=0;for(y=3367;y<=3403;y++)Z[y]=0;for(y=3408;y<=3416;y++)Z[y]=0;for(y=3417;y<=3438;y++)Z[y]=2;for(y=3441;y<=3446;y++)Z[y]=2;for(y=3447;y<=3450;y++)Z[y]=0;for(y=3451;y<=3459;y++)Z[y]=2;for(y=3460;y<=3478;y++)Z[y]=0;for(y=3554;y<=3559;y++)Z[y]=0;for(y=3560;y<=3570;y++)Z[y]=2;for(y=3571;y<=3581;y++)Z[y]=0;for(y=3594;y<=3597;y++)Z[y]=0;for(y=3601;y<=3604;y++)Z[y]=0;for(y=3637;y<=3639;y++)Z[y]=0;for(y=3665;y<=3667;y++)Z[y]=0;for(y=3693;y<=3695;y++)Z[y]=0;for(y=3701;y<=3727;y++)Z[y]=0;for(y=3728;y<=3739;y++)Z[y]=2;for(y=3740;y<=3751;y++)Z[y]=0;for(y=3753;y<=3760;y++)Z[y]=2;for(y=3761;y<=3773;y++)Z[y]=0;for(y=3775;y<=3777;y++)Z[y]=0;for(y=3779;y<=3781;y++)Z[y]=0;for(y=3783;y<=3785;y++)Z[y]=0;for(y=3788;y<=3791;y++)Z[y]=0;for(y=3797;y<=3802;y++)Z[y]=0;for(y=3814;y<=3816;y++)Z[y]=0;for(y=3825;y<=3829;y++)Z[y]=0;for(y=3832;y<=3841;y++)Z[y]=0;for(y=3844;y<=3852;y++)Z[y]=0;for(y=3873;y<=3885;y++)Z[y]=0;for(y=3890;y<=3893;y++)Z[y]=0;for(y=3907;y<=3912;y++)Z[y]=0;for(y=3942;y<=3950;y++)Z[y]=0;for(y=3968;y<=3970;y++)Z[y]=0;for(y=3973;y<=3976;y++)Z[y]=0;for(y=3986;y<=3989;y++)Z[y]=0;for(y=3994;y<=3997;y++)Z[y]=0;for(y=4048;y<=4051;y++)Z[y]=0;for(y=4056;y<=4063;y++)Z[y]=0;for(y=4093;y<=4096;y++)Z[y]=0;for(y=4390;y<=4398;y++)Z[y]=0;for(y=4399;y<=4413;y++)Z[y]=2;for(y=4418;y<=4433;y++)Z[y]=2;for(y=4455;y<=4457;y++)Z[y]=2;for(y=4484;y<=4489;y++)Z[y]=0;for(y=4491;y<=4554;y++)Z[y]=0;for(y=4568;y<=4589;y++)Z[y]=0;for(y=4652;y<=4656;y++)Z[y]=0;for(y=4766;y<=4800;y++)Z[y]=0;for(y=5014;y<=5016;y++)Z[y]=0;for(y=5069;y<=5072;y++)Z[y]=0;for(y=5105;y<=5130;y++)Z[y]=0;for(y=5167;y<=5188;y++)Z[y]=0;for(y=5253;y<=5259;y++)Z[y]=0;for(y=5269;y<=5275;y++)Z[y]=0;for(y=5292;y<=5311;y++)Z[y]=0;for(y=5329;y<=5331;y++)Z[y]=0;for(y=5343;y<=5349;y++)Z[y]=0;for(y=5355;y<=5357;y++)Z[y]=0;for(y=5387;y<=5389;y++)Z[y]=0;for(y=5459;y<=5463;y++)Z[y]=0;for(y=5479;y<=5482;y++)Z[y]=0;for(y=5518;y<=5520;y++)Z[y]=0;for(y=5530;y<=5539;y++)Z[y]=0;for(y=5550;y<=5552;y++)Z[y]=0;for(y=5562;y<=5583;y++)Z[y]=0;for(y=5623;y<=5625;y++)Z[y]=2;for(y=5631;y<=5639;y++)Z[y]=0;for(y=5649;y<=5653;y++)Z[y]=0;for(y=5663;y<=5680;y++)Z[y]=0;for(y=5682;y<=5685;y++)Z[y]=0;for(y=5875;y<=5877;y++)Z[y]=0;for(y=5896;y<=5899;y++)Z[y]=0;for(y=5921;y<=5940;y++)Z[y]=0;for(y=6050;y<=6125;y++)Z[y]=0;for(y=6244;y<=6275;y++)Z[y]=0;for(y=6328;y<=6348;y++)Z[y]=0;for(y=6350;y<=6356;y++)Z[y]=0;for(y=6366;y<=6372;y++)Z[y]=0;for(y=6381;y<=6387;y++)Z[y]=0;for(y=6393;y<=6404;y++)Z[y]=0;for(y=6480;y<=6483;y++)Z[y]=0;for(y=6511;y<=6514;y++)Z[y]=0;for(y=6579;y<=6581;y++)Z[y]=0;for(y=6619;y<=6624;y++)Z[y]=0;for(y=6625;y<=6627;y++)Z[y]=2;for(y=6628;y<=6632;y++)Z[y]=0;for(y=6634;y<=6637;y++)Z[y]=0;for(y=6669;y<=6692;y++)Z[y]=0;for(y=6707;y<=6709;y++)Z[y]=0;for(y=6720;y<=6723;y++)Z[y]=0;for(y=6732;y<=6738;y++)Z[y]=0;for(y=6931;y<=6933;y++)Z[y]=0;for(y=6956;y<=6959;y++)Z[y]=0;for(y=7005;y<=7007;y++)Z[y]=0;for(y=7057;y<=7070;y++)Z[y]=2;for(y=7074;y<=7082;y++)Z[y]=0;for(y=7109;y<=7118;y++)Z[y]=0;for(y=7119;y<=7127;y++)Z[y]=1;for(y=7374;y<=7376;y++)Z[y]=0;for(y=7528;y<=7586;y++)Z[y]=0;for(y=7587;y<=7645;y++)Z[y]=2;for(y=7692;y<=7696;y++)Z[y]=0;for(y=7755;y<=7787;y++)Z[y]=0;for(y=7791;y<=7795;y++)Z[y]=0;for(y=7799;y<=7801;y++)Z[y]=0;for(y=7803;y<=7805;y++)Z[y]=0;for(y=7825;y<=7831;y++)Z[y]=0;for(y=7845;y<=7859;y++)Z[y]=0;for(y=8013;y<=8032;y++)Z[y]=0;for(y=8065;y<=8068;y++)Z[y]=1;for(y=8518;y<=8529;y++)Z[y]=2;for(y=8533;y<=8536;y++)Z[y]=2;for(y=8538;y<=8540;y++)Z[y]=2;for(y=8677;y<=8679;y++)Z[y]=0;for(y=8836;y<=8840;y++)Z[y]=0;for(y=8857;y<=8859;y++)Z[y]=0;for(y=8908;y<=8910;y++)Z[y]=0;for(y=9154;y<=9159;y++)Z[y]=0;for(y=9205;y<=9218;y++)Z[y]=0;for(y=9271;y<=9273;y++)Z[y]=0;for(y=9295;y<=9297;y++)Z[y]=0;for(y=9356;y<=9360;y++)Z[y]=0;for(y=9404;y<=9407;y++)Z[y]=0;for(y=9476;y<=9482;y++)Z[y]=0;for(y=9487;y<=9494;y++)Z[y]=0;for(y=9697;y<=9699;y++)Z[y]=0;for(y=9821;y<=9865;y++)Z[y]=0;for(y=10285;y<=10291;y++)Z[y]=0;for(y=10314;y<=10317;y++)Z[y]=0;for(y=10448;y<=10465;y++)Z[y]=0;for(y=10726;y<=10729;y++)Z[y]=0;for(y=10731;y<=10733;y++)Z[y]=0;for(y=11114;y<=11118;y++)Z[y]=0;for(y=20004;y<=20032;y++)Z[y]=0;for(y=20047;y<=20049;y++)Z[y]=0;for(y=20062;y<=20092;y++)Z[y]=0;for(y=20135;y<=20138;y++)Z[y]=0;for(y=20248;y<=20258;y++)Z[y]=0;for(y=20348;y<=20358;y++)Z[y]=0;for(y=20436;y<=20440;y++)Z[y]=0;for(y=20822;y<=20824;y++)Z[y]=0;for(y=20904;y<=20932;y++)Z[y]=0;for(y=20934;y<=20936;y++)Z[y]=0;for(y=21004;y<=21032;y++)Z[y]=0;for(y=21035;y<=21037;y++)Z[y]=0;for(y=21095;y<=21097;y++)Z[y]=0;for(y=21148;y<=21150;y++)Z[y]=0;for(y=21207;y<=21264;y++)Z[y]=0;for(y=21307;y<=21364;y++)Z[y]=0;for(y=21413;y<=21423;y++)Z[y]=0;for(y=21453;y<=21463;y++)Z[y]=0;for(y=21473;y<=21483;y++)Z[y]=0;for(y=21780;y<=21782;y++)Z[y]=0;for(y=21891;y<=21894;y++)Z[y]=0;for(y=21896;y<=21899;y++)Z[y]=0;for(y=22171;y<=22177;y++)Z[y]=0;for(y=22181;y<=22187;y++)Z[y]=0;for(y=22191;y<=22197;y++)Z[y]=0;for(y=22207;y<=22222;y++)Z[y]=0;for(y=22229;y<=22232;y++)Z[y]=0;for(y=22234;y<=22236;y++)Z[y]=0;for(y=22243;y<=22250;y++)Z[y]=0;for(y=22262;y<=22265;y++)Z[y]=0;for(y=22307;y<=22322;y++)Z[y]=0;for(y=22348;y<=22357;y++)Z[y]=0;for(y=22407;y<=22422;y++)Z[y]=0;for(y=22462;y<=22465;y++)Z[y]=0;for(y=22521;y<=22525;y++)Z[y]=0;for(y=22607;y<=22622;y++)Z[y]=0;for(y=22641;y<=22646;y++)Z[y]=0;for(y=22648;y<=22657;y++)Z[y]=0;for(y=22707;y<=22722;y++)Z[y]=0;for(y=22762;y<=22765;y++)Z[y]=0;for(y=22807;y<=22822;y++)Z[y]=0;for(y=22991;y<=22994;y++)Z[y]=0;for(y=23028;y<=23038;y++)Z[y]=0;for(y=23301;y<=23333;y++)Z[y]=2;for(y=23830;y<=23853;y++)Z[y]=0;for(y=23866;y<=23872;y++)Z[y]=0;for(y=23877;y<=23884;y++)Z[y]=0;for(y=23886;y<=23894;y++)Z[y]=0;for(y=23946;y<=23948;y++)Z[y]=0;for(y=24311;y<=24313;y++)Z[y]=0;for(y=24342;y<=24347;y++)Z[y]=0;for(y=24370;y<=24374;y++)Z[y]=10;for(y=24375;y<=24381;y++)Z[y]=0;for(y=24718;y<=24721;y++)Z[y]=0;for(y=24817;y<=24821;y++)Z[y]=0;for(y=24877;y<=24882;y++)Z[y]=0;for(y=24891;y<=24893;y++)Z[y]=0;for(y=25391;y<=25395;y++)Z[y]=0;for(y=25828;y<=25838;y++)Z[y]=0;for(y=26191;y<=26195;y++)Z[y]=0;for(y=26391;y<=26393;y++)Z[y]=0;for(y=26701;y<=26722;y++)Z[y]=0;for(y=26729;y<=26799;y++)Z[y]=2;for(y=26801;y<=26803;y++)Z[y]=2;for(y=26811;y<=26813;y++)Z[y]=2;for(y=26847;y<=26870;y++)Z[y]=2;for(y=26891;y<=26899;y++)Z[y]=0;for(y=26901;y<=26923;y++)Z[y]=0;for(y=26929;y<=26946;y++)Z[y]=0;for(y=26948;y<=26998;y++)Z[y]=0;for(y=27037;y<=27040;y++)Z[y]=0;for(y=27205;y<=27232;y++)Z[y]=0;for(y=27258;y<=27260;y++)Z[y]=0;for(y=27391;y<=27398;y++)Z[y]=0;for(y=27561;y<=27564;y++)Z[y]=0;for(y=27571;y<=27574;y++)Z[y]=0;for(y=27581;y<=27584;y++)Z[y]=0;for(y=27591;y<=27594;y++)Z[y]=0;for(y=27700;y<=27707;y++)Z[y]=0;for(y=28191;y<=28193;y++)Z[y]=0;for(y=28348;y<=28358;y++)Z[y]=0;for(y=28402;y<=28432;y++)Z[y]=0;for(y=28462;y<=28492;y++)Z[y]=0;for(y=29118;y<=29122;y++)Z[y]=0;for(y=29168;y<=29172;y++)Z[y]=0;for(y=29177;y<=29185;y++)Z[y]=0;for(y=29187;y<=29195;y++)Z[y]=0;for(y=29900;y<=29903;y++)Z[y]=0;for(y=30161;y<=30179;y++)Z[y]=0;for(y=30491;y<=30494;y++)Z[y]=0;for(y=30729;y<=30732;y++)Z[y]=0;for(y=31251;y<=31259;y++)Z[y]=0;for(y=31265;y<=31268;y++)Z[y]=0;for(y=31275;y<=31279;y++)Z[y]=0;for(y=31281;y<=31297;y++)Z[y]=0;for(y=31461;y<=31469;y++)Z[y]=0;for(y=31491;y<=31495;y++)Z[y]=0;for(y=31917;y<=31922;y++)Z[y]=0;for(y=31965;y<=32e3;y++)Z[y]=0;for(y=32001;y<=32003;y++)Z[y]=2;for(y=32005;y<=32031;y++)Z[y]=2;for(y=32033;y<=32060;y++)Z[y]=2;for(y=32064;y<=32067;y++)Z[y]=2;for(y=32074;y<=32077;y++)Z[y]=2;for(y=32081;y<=32086;y++)Z[y]=0;for(y=32107;y<=32130;y++)Z[y]=0;for(y=32133;y<=32159;y++)Z[y]=0;for(y=32164;y<=32167;y++)Z[y]=2;for(y=32180;y<=32199;y++)Z[y]=0;for(y=32201;y<=32260;y++)Z[y]=0;for(y=32301;y<=32360;y++)Z[y]=0;for(y=32401;y<=32460;y++)Z[y]=0;for(y=32501;y<=32560;y++)Z[y]=0;for(y=32601;y<=32662;y++)Z[y]=0;for(y=32664;y<=32667;y++)Z[y]=2;for(y=32701;y<=32761;y++)Z[y]=0;for(y=53001;y<=53004;y++)Z[y]=0;for(y=53008;y<=53019;y++)Z[y]=0;for(y=53021;y<=53032;y++)Z[y]=0;for(y=53034;y<=53037;y++)Z[y]=0;for(y=53042;y<=53046;y++)Z[y]=0;for(y=53074;y<=53080;y++)Z[y]=0;for(y=54001;y<=54004;y++)Z[y]=0;for(y=54008;y<=54019;y++)Z[y]=0;for(y=54021;y<=54032;y++)Z[y]=0;for(y=54034;y<=54037;y++)Z[y]=0;for(y=54042;y<=54046;y++)Z[y]=0;for(y=54048;y<=54053;y++)Z[y]=0;for(y=54074;y<=54080;y++)Z[y]=0;for(y=54090;y<=54096;y++)Z[y]=0;for(y=54098;y<=54101;y++)Z[y]=0;for(y=65161;y<=65163;y++)Z[y]=0;for(y=102001;y<=102040;y++)Z[y]=0;for(y=102042;y<=102063;y++)Z[y]=0;for(y=102065;y<=102067;y++)Z[y]=0;for(y=102070;y<=102117;y++)Z[y]=0;for(y=102122;y<=102216;y++)Z[y]=0;for(y=102221;y<=102377;y++)Z[y]=0;for(y=102382;y<=102388;y++)Z[y]=0;for(y=102389;y<=102398;y++)Z[y]=2;for(y=102399;y<=102444;y++)Z[y]=0;for(y=102445;y<=102447;y++)Z[y]=2;for(y=102448;y<=102458;y++)Z[y]=0;for(y=102459;y<=102468;y++)Z[y]=2;for(y=102469;y<=102499;y++)Z[y]=0;for(y=102500;y<=102519;y++)Z[y]=1;for(y=102520;y<=102524;y++)Z[y]=0;for(y=102525;y<=102529;y++)Z[y]=2;for(y=102530;y<=102588;y++)Z[y]=0;for(y=102590;y<=102598;y++)Z[y]=0;for(y=102601;y<=102603;y++)Z[y]=0;for(y=102605;y<=102628;y++)Z[y]=0;for(y=102629;y<=102646;y++)Z[y]=2;for(y=102648;y<=102700;y++)Z[y]=2;for(y=102701;y<=102703;y++)Z[y]=0;for(y=102707;y<=102730;y++)Z[y]=2;for(y=102733;y<=102758;y++)Z[y]=2;for(y=102767;y<=102900;y++)Z[y]=0;for(y=102901;y<=102933;y++)Z[y]=2;for(y=102934;y<=102950;y++)Z[y]=13;for(y=102951;y<=102963;y++)Z[y]=0;for(y=102965;y<=102969;y++)Z[y]=0;for(y=102971;y<=102973;y++)Z[y]=0;for(y=102975;y<=102989;y++)Z[y]=0;for(y=102990;y<=102992;y++)Z[y]=1;for(y=102997;y<=103002;y++)Z[y]=0;for(y=103003;y<=103008;y++)Z[y]=2;for(y=103009;y<=103011;y++)Z[y]=0;for(y=103012;y<=103014;y++)Z[y]=2;for(y=103019;y<=103021;y++)Z[y]=0;for(y=103022;y<=103024;y++)Z[y]=2;for(y=103029;y<=103031;y++)Z[y]=0;for(y=103032;y<=103034;y++)Z[y]=2;for(y=103065;y<=103068;y++)Z[y]=0;for(y=103074;y<=103076;y++)Z[y]=0;for(y=103077;y<=103079;y++)Z[y]=1;for(y=103080;y<=103082;y++)Z[y]=0;for(y=103083;y<=103085;y++)Z[y]=2;for(y=103090;y<=103093;y++)Z[y]=0;for(y=103097;y<=103099;y++)Z[y]=0;for(y=103100;y<=103102;y++)Z[y]=2;for(y=103107;y<=103109;y++)Z[y]=0;for(y=103110;y<=103112;y++)Z[y]=2;for(y=103113;y<=103116;y++)Z[y]=0;for(y=103117;y<=103120;y++)Z[y]=2;for(y=103153;y<=103157;y++)Z[y]=0;for(y=103158;y<=103162;y++)Z[y]=2;for(y=103163;y<=103165;y++)Z[y]=0;for(y=103166;y<=103168;y++)Z[y]=1;for(y=103169;y<=103171;y++)Z[y]=2;for(y=103186;y<=103188;y++)Z[y]=0;for(y=103189;y<=103191;y++)Z[y]=2;for(y=103192;y<=103195;y++)Z[y]=0;for(y=103196;y<=103199;y++)Z[y]=2;for(y=103200;y<=103224;y++)Z[y]=0;for(y=103225;y<=103227;y++)Z[y]=1;for(y=103232;y<=103237;y++)Z[y]=0;for(y=103238;y<=103243;y++)Z[y]=2;for(y=103244;y<=103246;y++)Z[y]=0;for(y=103247;y<=103249;y++)Z[y]=2;for(y=103254;y<=103256;y++)Z[y]=0;for(y=103257;y<=103259;y++)Z[y]=2;for(y=103264;y<=103266;y++)Z[y]=0;for(y=103267;y<=103269;y++)Z[y]=2;for(y=103300;y<=103375;y++)Z[y]=0;for(y=103381;y<=103383;y++)Z[y]=0;for(y=103384;y<=103386;y++)Z[y]=1;for(y=103387;y<=103389;y++)Z[y]=0;for(y=103390;y<=103392;y++)Z[y]=2;for(y=103397;y<=103399;y++)Z[y]=0;for(y=103400;y<=103471;y++)Z[y]=2;for(y=103476;y<=103478;y++)Z[y]=0;for(y=103479;y<=103481;y++)Z[y]=2;for(y=103486;y<=103488;y++)Z[y]=0;for(y=103489;y<=103491;y++)Z[y]=2;for(y=103492;y<=103495;y++)Z[y]=0;for(y=103496;y<=103499;y++)Z[y]=2;for(y=103528;y<=103543;y++)Z[y]=0;for(y=103544;y<=103548;y++)Z[y]=2;for(y=103549;y<=103551;y++)Z[y]=0;for(y=103552;y<=103554;y++)Z[y]=1;for(y=103555;y<=103557;y++)Z[y]=2;for(y=103558;y<=103560;y++)Z[y]=0;for(y=103571;y<=103573;y++)Z[y]=0;for(y=103574;y<=103576;y++)Z[y]=2;for(y=103577;y<=103580;y++)Z[y]=0;for(y=103581;y<=103583;y++)Z[y]=2;for(y=103595;y<=103694;y++)Z[y]=0;for(y=103696;y<=103699;y++)Z[y]=0;for(y=103700;y<=103793;y++)Z[y]=2;for(y=103794;y<=103890;y++)Z[y]=0;for(y=103891;y<=103896;y++)Z[y]=2;for(y=103900;y<=103971;y++)Z[y]=2;for(y=103972;y<=103977;y++)Z[y]=0;for(y=112e3;y<=112101;y++)Z[y]=0;const MN=[102100,102113,3857,3785,900913],Uoe=[104905,104971],Voe=[104903],Goe=[4326,...MN,...Uoe,...Voe],L0=[-20037508342788905e-9,20037508342788905e-9],ZE=[-20037508342787e-6,20037508342787e-6],$T={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:L0,origin:ZE,dx:1e-5},kN={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:L0,origin:ZE,dx:1e-5},102100:$T,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:L0,origin:ZE,dx:1e-5},3857:$T,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:$T,104903:{wkTemplate:'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400,0,AUTHORITY["ESRI","107903"]],AUTHORITY["ESRI","106903"]],PRIMEM["Reference_Meridian",0,AUTHORITY["ESRI","108900"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["ESRI","104903"]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Sd(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const i=t.wkid,r=e.wkid;if(i!=null||r!=null){if(i===r||Td(t)&&Td(e))return!0;const d=t.latestWkid;if(d!=null&&r===d)return!0;const a=e.latestWkid;return a!=null&&i===a}let o,h;return t.wkt2&&e.wkt2?(o=t.wkt2,h=e.wkt2):t.wkt&&e.wkt&&(o=t.wkt,h=e.wkt),!(!o||!h)&&o.toUpperCase()===h.toUpperCase()}function jb(t){const e=t?.wkid;return e!=null&&e>=2e3&&kN[e]||null}function oz(t){if(!t)return;const{wkid:e,vcsWkid:i}=t;if(e)return i?JSON.stringify({wkid:e,vcsWkid:i}):String(e);const r=t.wkt||t.wkt2;return JSON.stringify(r?i?{wkt:r,vcsWkid:i}:{wkt:r}:{})}function h_(t){if(!AN(t))return!1;const{wkid:e}=t;if(e)return Z[e]==null;const i=t.wkt2||t.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function qoe(t){return!(Hoe(t)||Zoe(t))}function m1(t){return t?.wkid===4326}function Rge(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function Lge(t){return t?.wkid===4490}function Td(t){const e=t?.wkid;return e!=null&&e>=2e3&&MN.includes(e)}function Fge(t){return t?.wkid===32662}function Bw(t){return t===104971||t===104905}function Hoe(t){return Bw(t?.wkid)}function jw(t){return t===104903}function Zoe(t){return jw(t?.wkid)}function Woe(t){const e=t?.wkid;return e!=null&&e>=2e3&&Goe.includes(e)}function AN(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const DN={wkid:4326,wkt:V$(kN[4326].wkTemplate,{Central_Meridian:"0.0"})},zN={wkid:102100,latestWkid:3857},Yoe={wkid:32662};function OP(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const Xoe=OP(Pa),ON=OP(R0),RN=OP(Fw),Nge={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Pa.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},Joe=ON.wkt.toUpperCase(),Koe=RN.wkt.toUpperCase();function Qoe(t){if(t!=null&&AN(t)){const e=t.wkid,i=t.wkt2??t.wkt;if(Bw(e))return R0;const r=i?.toUpperCase();if(i&&r===Joe)return R0;if(jw(e)||r&&r===Koe)return Fw}return Pa}function Bge(t){return Bw(t)?R0:jw(t)?Fw:Pa}function eae(t){return Sd(t,Xoe)}function jge(t){return eae(t)||Sd(t,ON)||Sd(t,RN)}const LN=39.37,tae=Pa.radius*Math.PI/200,FN=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,mm=Z,NN=/UNIT\[([^\]]+)]/i,iae=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),rae=yo()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),ha=t=>t*t,lu=t=>t*t*t,F0={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:ha(.001)},"square-centimeters":{inBaseUnits:ha(.01)},"square-decimeters":{inBaseUnits:ha(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:ha(1e3)},"square-inches":{inBaseUnits:ha(.0254)},"square-feet":{inBaseUnits:ha(.3048)},"square-yards":{inBaseUnits:ha(.9144)},"square-miles":{inBaseUnits:ha(1609.344)},"square-nautical-miles":{inBaseUnits:ha(1852)},"square-us-feet":{inBaseUnits:ha(1200/3937)},acres:{inBaseUnits:.0015625*ha(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*lu(.001)},"cubic-centimeters":{inBaseUnits:1e3*lu(.01)},"cubic-decimeters":{inBaseUnits:1e3*lu(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*lu(1e3)},"cubic-inches":{inBaseUnits:1e3*lu(.0254)},"cubic-feet":{inBaseUnits:1e3*lu(.3048)},"cubic-yards":{inBaseUnits:1e3*lu(.9144)},"cubic-miles":{inBaseUnits:1e3*lu(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},nae=(()=>{const t={};for(const e in F0)for(const i in F0[e].units)t[i]=e;return t})();function sae(t,e,i){return t*F0[i].units[e].inBaseUnits}function oae(t,e,i){return t/F0[i].units[e].inBaseUnits}const aae=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function WE(t){const e=nae[t];if(!e)throw new Error("unknown type");return e}function az(t,e=null){return e=e||WE(t),F0[e].baseUnit===t}function N0(t,e,i){if(e===i)return t;const r=WE(e);if(r!==WE(i))throw new Error("incompatible units");const o=az(e,r)?t:sae(t,e,r);return az(i,r)?o:oae(o,i,r)}function Uge(t,e,i,r=!1){if(!r&&h_(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const o=d_(e);return o!==i&&(t=o?N0(t,o,i):N0(t*=xc(e),"meters",i)),t}function Vge(t,e,i,r=!1){if(!r&&h_(i))throw new Error("Unable to convert from a linear unit to an angular unit.");const o=d_(i);return e!==o&&(t=o?N0(t,e,o):N0(t,e,"meters")/xc(i)),t}function Gge(t,e,i){return N0(t,e,"meters")/(i*Math.PI/180)}function BN(t){return rae.fromJSON(t.toLowerCase())||null}function qge(t){if(t!=null&&!qoe(t))return 1;const e=xc(t);return e>1e5?1:e}function Hge(t){return xc(t)>=Qoe(t).metersPerDegree?"meters":d_(t)}function xc(t,e=Pa.metersPerDegree){return lae(t,!0)??e}function lae(t,e=!1){const i=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let o=null;if(i){if(Bw(i))return R0.metersPerDegree;if(jw(i))return Fw.metersPerDegree;o=mm.values[mm[i]],!o&&e&&iae.has(i)&&(o=tae)}else r&&(VN(r)?o=lz(FN.exec(r),o):UN(r)&&(o=lz(NN.exec(r),o)));return o}function Zge(t){return h_(t)?1:xc(t)}function lz(t,e){return t?.[1]?jN(t[1]):e}function jN(t){return parseFloat(t.split(",")[1])}function d_(t){const e=t?.wkid??null,i=t?.wkt2??t?.wkt??null;let r=null;if(e)r=mm.units[mm[e]];else if(i){const o=VN(i)?FN:UN(i)?NN:null;if(o){const h=o.exec(i);h?.[1]&&(r=uae(h[1]))}}return r!=null?BN(r):null}function Wge(t){const e=d_(t);return e==null?null:aae.get(e)}function UN(t){return/^GEOCCS/i.test(t)}function VN(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const cae=1e-7;function uae(t){let i=/[\\"']([^\\"']+)/.exec(t)?.[1];if(!i||!BN(i)){const r=jN(t);i=null;const o=mm.values;for(let h=0;h<o.length;++h)if(Math.abs(r-o[h])<cae){i=mm.units[h];break}}return i}const hae={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},dae={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},pae={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},Yge=yo()(hae),Xge=yo()(dae),Jge=yo()(pae);var tl,cl;let Rt=(cl=class extends Lt{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return tl.WebMercator;if(e?.wkid===4326)return tl.WGS84;const i=new tl;return i.read(e),i}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return m1(this)}get isWebMercator(){return Td(this)}get isGeographic(){return h_(this)}get isWrappable(){return Woe(this)}get metersPerUnit(){return xc(this)}get unit(){return d_(this)||(this.isGeographic?"degrees":null)}writeWkt(e,i){this.wkid||(i.wkt=e)}clone(){if(this===tl.WGS84)return new tl(DN);if(this===tl.WebMercator)return new tl(zN);const e=new tl;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=dt(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:i,referenceServiceName:r}=e.imageCoordinateSystem,{geodataXform:o}=e.imageCoordinateSystem,h=this.imageCoordinateSystem;return i==null||o?JSON.stringify(h)===JSON.stringify(e.imageCoordinateSystem):r?h.id===i&&h.referenceServiceName===r:h.id===i}return Sd(this,e)}toJSON(e){return this.write(void 0,e)}},tl=cl,cl.GCS_NAD_1927=null,cl.WGS84=null,cl.WebMercator=null,cl.PlateCarree=null,cl);P([R({readOnly:!0})],Rt.prototype,"isWGS84",null),P([R({readOnly:!0})],Rt.prototype,"isWebMercator",null),P([R({readOnly:!0})],Rt.prototype,"isGeographic",null),P([R({readOnly:!0})],Rt.prototype,"isWrappable",null),P([R({type:Er,json:{write:!0}})],Rt.prototype,"latestWkid",void 0),P([R({readOnly:!0})],Rt.prototype,"metersPerUnit",null),P([R({readOnly:!0})],Rt.prototype,"unit",null),P([R({type:Er,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Rt.prototype,"wkid",void 0),P([R({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Rt.prototype,"wkt",void 0),P([Bi("wkt"),Bi("web-scene","wkt")],Rt.prototype,"writeWkt",null),P([R({type:String,json:{write:!1}})],Rt.prototype,"wkt2",void 0),P([R({type:Er,json:{write:!0}})],Rt.prototype,"vcsWkid",void 0),P([R({type:Er,json:{write:!0}})],Rt.prototype,"latestVcsWkid",void 0),P([R()],Rt.prototype,"imageCoordinateSystem",void 0),Rt=tl=P([Ge("esri.geometry.SpatialReference")],Rt),Rt.prototype.toJSON.isDefaultToJSON=!0,Rt.GCS_NAD_1927=Ln.freeze(new Rt({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Rt.WGS84=Ln.freeze(new Rt(DN)),Rt.WebMercator=Ln.freeze(new Rt(zN)),Rt.PlateCarree=Ln.freeze(new Rt(Yoe));let Hn=class extends Lt{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Rt.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,i){if(e instanceof Rt)return e;if(e!=null){const r=new Rt;return r.read(e,i),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,i){this.cache[e]=i}};P([R()],Hn.prototype,"type",void 0),P([R({readOnly:!0})],Hn.prototype,"cache",null),P([R({readOnly:!0})],Hn.prototype,"extent",null),P([R({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Hn.prototype,"hasM",void 0),P([R({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Hn.prototype,"hasZ",void 0),P([R({type:Rt,json:{write:!0},value:Rt.WGS84})],Hn.prototype,"spatialReference",void 0),P([Fr("spatialReference")],Hn.prototype,"readSpatialReference",null),Hn=P([Ge("esri.geometry.Geometry")],Hn);function B0(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new Ot("internal:mesh","Mesh geometries are not supported for this operation")}function Qge(t){t.forEach(B0)}const fae=57.29577951308232,mae=.017453292519943;function cz(t){return t*fae}function uz(t){return t*mae}function eye(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Pa.radius))}function YE(t){return t.wkid!=null||t.wkt!=null}const PT=[0,0];function g1(t,e,i,r,o){const h=t,d=o;if(d.spatialReference=i,"x"in h&&"x"in d)[d.x,d.y]=e(h.x,h.y,PT,r);else if("xmin"in h&&"xmin"in d)[d.xmin,d.ymin]=e(h.xmin,h.ymin,PT,r),[d.xmax,d.ymax]=e(h.xmax,h.ymax,PT,r);else if("paths"in h&&"paths"in d||"rings"in h&&"rings"in d){const a="paths"in h?h.paths:h.rings,_=[];let T;for(let E=0;E<a.length;E++){const k=a[E];T=[],_.push(T);for(let L=0;L<k.length;L++)T.push(e(k[L][0],k[L][1],[0,0],r)),k[L].length>2&&T[L].push(k[L][2]),k[L].length>3&&T[L].push(k[L][3])}"paths"in d?d.paths=_:d.rings=_}else if("points"in h&&"points"in d){const a=h.points,_=[];for(let T=0;T<a.length;T++)_[T]=e(a[T][0],a[T][1],[0,0],r),a[T].length>2&&_[T].push(a[T][2]),a[T].length>3&&_[T].push(a[T][3]);d.points=_}return o}function Ub(t,e){const i=t&&(YE(t)?t:t.spatialReference),r=e&&(YE(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!i||!r)&&(!!Sd(r,i)||Td(r)&&m1(i)||Td(i)&&m1(r))}function GN(t,e){if(t==null)return null;const i=t.spatialReference,r=e&&(YE(e)?e:e.spatialReference);return Ub(i,r)?Sd(i,r)?dt(t):Td(r)?g1(t,vf,Rt.WebMercator,!1,dt(t)):m1(r)?g1(t,Uw,Rt.WGS84,!1,dt(t)):null:null}function vf(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const r=uz(e);return i[0]=uz(t)*Pa.radius,i[1]=Pa.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),i}function Uw(t,e,i=[0,0],r=!1){if(t===L0[0])i[0]=-180;else if(t===L0[1])i[0]=180;else{const o=cz(t/Pa.radius);i[0]=r?o:o-360*Math.floor((o+180)/360)}return i[1]=cz(Math.PI/2-2*Math.atan(Math.exp(-e/Pa.radius))),i}function Vb(t,e=!1,i=dt(t)){return B0(t),B0(i),g1(t,vf,Rt.WebMercator,e,i)}function eb(t,e=!1,i=dt(t)){return B0(t),B0(i),g1(t,Uw,Rt.WGS84,e,i)}function gae(t,e){const i=t.x-e.x,r=t.y-e.y,o=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(i*i+r*r+o*o)}function yae(t){return qN(t,HN)?.[0]??null}function _ae(t){return qN(t,HN)?.[1]??null}function qN({x:t,y:e,spatialReference:i},r=[0,0]){if(i){if(Td(i))return Uw(t,e,r);if(h_(i))return r[0]=t,r[1]=e,r}return null}const HN=[0,0];var Gb;const MT=[0,0];function hz(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let oi=Gb=class extends Hn{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Ln.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,r,o){let h;if(Array.isArray(t))h=t,o=e,t=h[0],e=h[1],i=h[2],r=h[3];else if(t&&typeof t=="object"){if(h=t,t=h.x!=null?h.x:h.longitude,e=h.y!=null?h.y:h.latitude,i=h.z,r=h.m,(o=h.spatialReference)&&o.declaredClass!=="esri.geometry.SpatialReference"&&(o=new Rt(o)),h.longitude!=null||h.latitude!=null){if(h.longitude==null)ui.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(h.latitude==null)ui.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!h.declaredClass&&o?.isWebMercator){const a=vf(h.longitude,h.latitude,MT);t=a[0],e=a[1]}}}else hz(i)?(o=i,i=null):hz(r)&&(o=r,r=null);const d={x:t,y:e};return d.x==null&&d.y!=null?ui.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):d.y==null&&d.x!=null&&ui.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),o!=null&&(d.spatialReference=o),i!=null&&(d.z=i),r!=null&&(d.m=r),d}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return _ae(this)}set latitude(t){const{spatialReference:e,x:i}=this;t!=null&&e&&(e.isWebMercator?this._set("y",vf(i,t,MT)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return yae(this)}set longitude(t){const{y:e,spatialReference:i}=this;t!=null&&i&&(i.isWebMercator?this._set("x",vf(t,e,MT)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new Gb;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return Gb.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:i,z:r,m:o,spatialReference:h}=this,{z:d,m:a}=t;let{x:_,y:T,spatialReference:E}=t;if(!h.equals(E))if(h.isWebMercator&&E.isWGS84)[_,T]=vf(_,T),E=h;else{if(!h.isWGS84||!E.isWebMercator)return!1;[_,T]=Uw(_,T),E=h}return e===_&&i===T&&r===d&&o===a&&h.wkid===E.wkid}offset(t,e,i){return this.x+=t,this.y+=e,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=jb(this.spatialReference);if(!t)return this;let e=this.x;const[i,r]=t.valid,o=2*r;let h;return e>r?(h=Math.ceil(Math.abs(e-r)/o),e-=h*o):e<i&&(h=Math.ceil(Math.abs(e-i)/o),e+=h*o),this._set("x",e),this}distance(t){return gae(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};P([R({readOnly:!0})],oi.prototype,"cache",null),P([R({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],oi.prototype,"hasM",null),P([R({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],oi.prototype,"hasZ",null),P([R({type:Number})],oi.prototype,"latitude",null),P([R({type:Number})],oi.prototype,"longitude",null),P([R({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),l_(t=>isNaN(t)?t:kw(t))],oi.prototype,"x",void 0),P([Bi("x")],oi.prototype,"writeX",null),P([Fr("x")],oi.prototype,"readX",null),P([R({type:Number,json:{write:!0}})],oi.prototype,"y",void 0),P([R({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],oi.prototype,"z",void 0),P([R({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],oi.prototype,"m",void 0),oi=Gb=P([Ge("esri.geometry.Point")],oi),oi.prototype.toJSON.isDefaultToJSON=!0;const kT=[0,0];function ZN(t,e){return e!=null&&us(t,e.x,e.y,e.z)}function tye(t,e){if(!e.points?.length)return!1;for(const i of e.points)if(!gm(t,i))return!1;return!0}function vae(t,e){const{xmin:i,ymin:r,zmin:o,xmax:h,ymax:d,zmax:a}=e;return t.hasZ&&e.hasZ?us(t,i,r,o)&&us(t,i,d,o)&&us(t,h,d,o)&&us(t,h,r,o)&&us(t,i,r,a)&&us(t,i,d,a)&&us(t,h,d,a)&&us(t,h,r,a):us(t,i,r)&&us(t,i,d)&&us(t,h,d)&&us(t,h,r)}function gm(t,e){return us(t,e[0],e[1])}function bae(t,e){return us(t,e[0],e[1],e[2])}function us(t,e,i,r){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(r==null||!t.hasZ||r>=t.zmin&&r<=t.zmax)}function xae(t,e){return kT[1]=e.y,kT[0]=e.x,wae(t,kT)}function wae(t,e){return WN(t.rings,e)}function WN(t,e){if(!t||t.length<1)return!1;if(Sae(t))return dz(!1,t,e);let i=!1;for(let r=0,o=t.length;r<o;r++)i=dz(i,t[r],e);return i}function Sae(t){return!Array.isArray(t[0][0])}function dz(t,e,i){const[r,o]=i;let h=t,d=0;for(let a=0,_=e.length;a<_;a++){d++,d===_&&(d=0);const[T,E]=e[a],[k,L]=e[d];(E<o&&L>=o||L<o&&E>=o)&&T+(o-E)/(L-E)*(k-T)<r&&(h=!h)}return h}function Tae(t,e){return ZN(t,e)}function Cae(t,e){const i=t.hasZ&&e.hasZ;let r,o,h;if(t.xmin<=e.xmin){if(r=e.xmin,t.xmax<r)return!1}else if(r=t.xmin,e.xmax<r)return!1;if(t.ymin<=e.ymin){if(o=e.ymin,t.ymax<o)return!1}else if(o=t.ymin,e.ymax<o)return!1;if(i&&e.hasZ){if(t.zmin<=e.zmin){if(h=e.zmin,t.zmax<h)return!1}else if(h=t.zmin,e.zmax<h)return!1}return!0}function Eae(t,e){const{points:i,hasZ:r}=e,o=r?bae:gm;for(const h of i)if(o(t,h))return!0;return!1}const Cd=[0,0],Ed=[0,0],Id=[0,0],$d=[0,0],Iae=[Cd,Ed,Id,$d],YN=[[Id,Cd],[Cd,Ed],[Ed,$d],[$d,Id]];function $ae(t,e){return Pae(t,e.rings)}function Pae(t,e){Cd[0]=t.xmin,Cd[1]=t.ymax,Ed[0]=t.xmax,Ed[1]=t.ymax,Id[0]=t.xmin,Id[1]=t.ymin,$d[0]=t.xmax,$d[1]=t.ymin;for(const i of Iae)if(WN(e,i))return!0;for(const i of e){if(!i.length)continue;let r=i[0];if(gm(t,r))return!0;for(let o=1;o<i.length;o++){const h=i[o];if(gm(t,h)||XN(r,h,YN))return!0;r=h}}return!1}function Mae(t,e){Cd[0]=t.xmin,Cd[1]=t.ymax,Ed[0]=t.xmax,Ed[1]=t.ymax,Id[0]=t.xmin,Id[1]=t.ymin,$d[0]=t.xmax,$d[1]=t.ymin;const i=e.paths;for(const r of i){if(!i.length)continue;let o=r[0];if(gm(t,o))return!0;for(let h=1;h<r.length;h++){const d=r[h];if(gm(t,d)||XN(o,d,YN))return!0;o=d}}return!1}const _n=[0,0];function kae(t){for(let e=0;e<t.length;e++){const i=t[e];for(let o=0;o<i.length-1;o++){const h=i[o],d=i[o+1];for(let a=e+1;a<t.length;a++)for(let _=0;_<t[a].length-1;_++){const T=t[a][_],E=t[a][_+1];if(XE(h,d,T,E,_n)&&!(_n[0]===h[0]&&_n[1]===h[1]||_n[0]===T[0]&&_n[1]===T[1]||_n[0]===d[0]&&_n[1]===d[1]||_n[0]===E[0]&&_n[1]===E[1]))return!0}}const r=i.length;if(!(r<=4))for(let o=0;o<r-3;o++){let h=r-1;o===0&&(h=r-2);const d=i[o],a=i[o+1];for(let _=o+2;_<h;_++){const T=i[_],E=i[_+1];if(XE(d,a,T,E,_n)&&!(_n[0]===d[0]&&_n[1]===d[1]||_n[0]===T[0]&&_n[1]===T[1]||_n[0]===a[0]&&_n[1]===a[1]||_n[0]===E[0]&&_n[1]===E[1]))return!0}}}return!1}function XN(t,e,i){for(let r=0;r<i.length;r++)if(XE(t,e,i[r][0],i[r][1]))return!0;return!1}function XE(t,e,i,r,o){const[h,d]=t,[a,_]=e,[T,E]=i,[k,L]=r,O=k-T,H=h-T,re=a-h,pe=L-E,ge=d-E,Se=_-d,Pe=pe*re-O*Se;if(Pe===0)return!1;const Re=(O*ge-pe*H)/Pe,ze=(re*ge-Se*H)/Pe;return Re>=0&&Re<=1&&ze>=0&&ze<=1&&(o&&(o[0]=h+Re*(a-h),o[1]=d+Re*(_-d)),!0)}function Aae(t){switch(t){case"esriGeometryEnvelope":case"extent":return Cae;case"esriGeometryMultipoint":case"multipoint":return Eae;case"esriGeometryPoint":case"point":return Tae;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return $ae;case"esriGeometryPolyline":case"polyline":return Mae}}var pa;function Dae(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function cu(t,e,i){return e==null?i:i==null?e:t(e,i)}let _i=pa=class extends Hn{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,r,o){return Dae(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Rt.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:r,spatialReference:o??Rt.WGS84}}static fromPoint(t){return new pa({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new oi({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new pa;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Ub(e,i)&&(t=e.isWebMercator?Vb(t):eb(t,!0)),t.type==="point"?ZN(this,t):t.type==="extent"&&vae(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Ub(e,i)&&(t=e.isWebMercator?Vb(t):eb(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,r=this.height*e;if(this.xmin+=i,this.ymin+=r,this.xmax-=i,this.ymax-=r,this.hasZ){const o=(this.zmax-this.zmin)*e;this.zmin+=o,this.zmax-=o}if(this.hasM){const o=(this.mmax-this.mmin)*e;this.mmin+=o,this.mmax-=o}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!Sd(e,i)&&Ub(e,i)&&(t=e.isWebMercator?Vb(t):eb(t,!0)),Aae(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=cu(Math.min,this.zmin,t.zmin),this.zmax=cu(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=cu(Math.min,this.mmin,t.mmin),this.mmax=cu(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=cu(Math.max,this.zmin,t.zmin),this.zmax=cu(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=cu(Math.max,this.mmin,t.mmin),this.mmax=cu(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=jb(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const r=e.isWebMercator?eb(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(r.x=AT(r.x,t).x),this.spatialReference=new Rt(V$((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(t){let e=null;const[i,r]=t.valid,o=this.xmin,h=this.xmax;return o>=i&&o<=r&&h>=i&&h<=r||(e=this.center),e}_normalize(t,e,i){const r=this.spatialReference;if(!r)return this;const o=i??jb(r);if(o==null)return this;const h=this._getParts(o).map(_=>_.extent);if(h.length<2)return h[0]||this;if(h.length>2)return t?this._shiftCM(o):this.set({xmin:o.valid[0],xmax:o.valid[1]});if(t)return this._shiftCM(o);if(e)return h;let d=!0,a=!0;return h.forEach(_=>{_.hasZ||(d=!1),_.hasM||(a=!1)}),{rings:h.map(_=>{const T=[[_.xmin,_.ymin],[_.xmin,_.ymax],[_.xmax,_.ymax],[_.xmax,_.ymin],[_.xmin,_.ymin]];if(d){const E=(_.zmax-_.zmin)/2;for(let k=0;k<T.length;k++)T[k].push(E)}if(a){const E=(_.mmax-_.mmin)/2;for(let k=0;k<T.length;k++)T[k].push(E)}return T}),hasZ:d,hasM:a,spatialReference:r}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:o,ymax:h,spatialReference:d}=this,a=this.width,_=this.xmin,T=this.xmax;let E;t=t||jb(d);const[k,L]=t.valid;E=AT(this.xmin,t);const O=E.x,H=E.frameId;E=AT(this.xmax,t);const re=E.x,pe=E.frameId,ge=O===re&&a>0;if(a>2*L){const Se=new pa(_<T?O:re,o,L,h,d),Pe=new pa(k,o,_<T?re:O,h,d),Re=new pa(0,o,L,h,d),ze=new pa(k,o,0,h,d),Je=[],Xe=[];Se.contains(Re)&&Je.push(H),Se.contains(ze)&&Xe.push(H),Pe.contains(Re)&&Je.push(pe),Pe.contains(ze)&&Xe.push(pe);for(let yt=H+1;yt<pe;yt++)Je.push(yt),Xe.push(yt);e.push({extent:Se,frameIds:[H]},{extent:Pe,frameIds:[pe]},{extent:Re,frameIds:Je},{extent:ze,frameIds:Xe})}else O>re||ge?e.push({extent:new pa(O,o,L,h,d),frameIds:[H]},{extent:new pa(k,o,re,h,d),frameIds:[pe]}):e.push({extent:new pa(O,o,re,h,d),frameIds:[H]});this.cache._parts=e}const i=this.hasZ,r=this.hasM;if(i||r){const o={};i&&(o.zmin=this.zmin,o.zmax=this.zmax),r&&(o.mmin=this.mmin,o.mmax=this.mmax);for(let h=0;h<e.length;h++)e[h].extent.set(o)}return e}};function AT(t,e){const[i,r]=e.valid,o=2*r;let h,d=0;return t>r?(h=Math.ceil(Math.abs(t-r)/o),t-=h*o,d=h):t<i&&(h=Math.ceil(Math.abs(t-i)/o),t+=h*o,d=-h),{x:t,frameId:d}}P([R({readOnly:!0})],_i.prototype,"cache",null),P([R({readOnly:!0})],_i.prototype,"center",null),P([R({readOnly:!0})],_i.prototype,"extent",null),P([R({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],_i.prototype,"hasM",null),P([R({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],_i.prototype,"hasZ",null),P([R({readOnly:!0})],_i.prototype,"height",null),P([R({readOnly:!0})],_i.prototype,"width",null),P([R({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],_i.prototype,"xmin",void 0),P([R({type:Number,json:{write:!0}})],_i.prototype,"ymin",void 0),P([R({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],_i.prototype,"mmin",void 0),P([R({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],_i.prototype,"zmin",void 0),P([R({type:Number,json:{write:!0}})],_i.prototype,"xmax",void 0),P([R({type:Number,json:{write:!0}})],_i.prototype,"ymax",void 0),P([R({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],_i.prototype,"mmax",void 0),P([R({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],_i.prototype,"zmax",void 0),_i=pa=P([Ge("esri.geometry.Extent")],_i),_i.prototype.toJSON.isDefaultToJSON=!0;function p_(t=Nae){return[t[0],t[1],t[2],t[3]]}function JN(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function zae(t,e,i,r,o=p_()){return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o}function iye(t,e=p_()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function rye(t,e,i=new _i){return i.xmin=t[0],i.ymin=t[1],i.xmax=t[2],i.ymax=t[3],i.spatialReference=e,i}function No(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Oae(t,e){e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e)}function Rae(t,e){e<t[1]&&(t[1]=e),e>t[3]&&(t[3]=e)}function nye(t,e,i){if(e!=null)if("length"in e)JE(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else JN(i,t)}function Lae(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function Fae(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function sye(t){return Lae(t)*Fae(t)}function oye(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function pz(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function aye(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function lye(t,e,i){return Math.max(e[0],t[0])-i<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-i<=Math.min(e[3],t[3])}function cye(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function uye(t){return t?JN(t,fz):p_(fz)}function JE(t){return t!=null&&t.length===4}function hye(t,e){return JE(t)&&JE(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const fz=[1/0,1/0,-1/0,-1/0],Nae=[0,0,0,0];let RP=1e-6;function Vw(){return RP}function Bae(t){RP=t}const KN=Math.random,jae=Math.PI/180,Uae=180/Math.PI;function Vae(t){return t*jae}function Gae(t){return t*Uae}function qae(t,e){return Math.abs(t-e)<=RP*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:KN,equals:qae,getEpsilon:Vw,setEpsilon:Bae,toDegree:Gae,toRadian:Vae},Symbol.toStringTag,{value:"Module"}));function Hae(t,e){return t[0]=e[0],t[1]=e[1],t}function Zae(t,e,i){return t[0]=e,t[1]=i,t}function Wae(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function QN(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function eB(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function tB(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function Yae(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Xae(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Jae(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function Kae(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function Qae(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function ele(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function tle(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t}function iB(t,e){const i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)}function LP(t,e){const i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r}function rB(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function nB(t){const e=t[0],i=t[1];return e*e+i*i}function ile(t,e){return t[0]=-e[0],t[1]=-e[1],t}function rle(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function nle(t,e){const i=e[0],r=e[1];let o=i*i+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t}function sle(t,e){return t[0]*e[0]+t[1]*e[1]}function ole(t,e,i){const r=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=r,t}function ale(t,e,i,r){const o=e[0],h=e[1];return t[0]=o+r*(i[0]-o),t[1]=h+r*(i[1]-h),t}function lle(t,e=1){const i=2*KN()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function cle(t,e,i){const r=e[0],o=e[1];return t[0]=i[0]*r+i[2]*o,t[1]=i[1]*r+i[3]*o,t}function ule(t,e,i){const r=e[0],o=e[1];return t[0]=i[0]*r+i[2]*o+i[4],t[1]=i[1]*r+i[3]*o+i[5],t}function hle(t,e,i){const r=e[0],o=e[1];return t[0]=i[0]*r+i[3]*o+i[6],t[1]=i[1]*r+i[4]*o+i[7],t}function dle(t,e,i){const r=e[0],o=e[1];return t[0]=i[0]*r+i[4]*o+i[12],t[1]=i[1]*r+i[5]*o+i[13],t}function ple(t,e,i,r){const o=e[0]-i[0],h=e[1]-i[1],d=Math.sin(r),a=Math.cos(r);return t[0]=o*a-h*d+i[0],t[1]=o*d+h*a+i[1],t}function fle(t,e){const i=t[0],r=t[1],o=e[0],h=e[1];let d=i*i+r*r;d>0&&(d=1/Math.sqrt(d));let a=o*o+h*h;a>0&&(a=1/Math.sqrt(a));const _=(i*o+r*h)*d*a;return _>1?0:_<-1?Math.PI:Math.acos(_)}function mle(t){return"vec2("+t[0]+", "+t[1]+")"}function gle(t,e){return t[0]===e[0]&&t[1]===e[1]}function yle(t,e){const i=t[0],r=t[1],o=e[0],h=e[1],d=Vw();return Math.abs(i-o)<=d*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-h)<=d*Math.max(1,Math.abs(r),Math.abs(h))}function _le(t,e,i,r,o){let h=e[0]-i[0],d=e[1]-i[1];const a=(r[0]*h+r[1]*d)*(o-1);return h=r[0]*a,d=r[1]*a,t[0]=e[0]+h,t[1]=e[1]+d,t}const vle=rB,ble=QN,xle=eB,wle=tB,Sle=iB,Tle=LP,Cle=nB;Object.freeze(Object.defineProperty({__proto__:null,add:Wae,angle:fle,ceil:Yae,copy:Hae,cross:ole,dist:Sle,distance:iB,div:wle,divide:tB,dot:sle,equals:yle,exactEquals:gle,floor:Xae,inverse:rle,len:vle,length:rB,lerp:ale,max:Kae,min:Jae,mul:xle,multiply:eB,negate:ile,normalize:nle,projectAndScale:_le,random:lle,rotate:ple,round:Qae,scale:ele,scaleAndAdd:tle,set:Zae,sqrDist:Tle,sqrLen:Cle,squaredDistance:LP,squaredLength:nB,str:mle,sub:ble,subtract:QN,transformMat2:cle,transformMat2d:ule,transformMat3:hle,transformMat4:dle},Symbol.toStringTag,{value:"Module"}));function lc(t,e,i,r){return t[0]=e[0]*(1-r)+i[0]*r,t[1]=e[1]*(1-r)+i[1]*r,t}function Uo(t,e){return LP(t,e)}function Ele(t,e,i,r,o){const[h,d]=e,[a,_]=i,[T,E]=r,[k,L]=o,O=(h-a)*(E-L)-(d-_)*(T-k);if(O===0)return null;const H=(h*_-d*a)*(T-k)-(h-a)*(T*L-E*k),re=(h*_-d*a)*(E-L)-(d-_)*(T*L-E*k);return t[0]=H/O,t[1]=re/O,t}const xa=2*Math.PI;function Yy(t,e){const i=Math.atan2(t,e);return i<0?i+xa:i}function sB(t){return Math.abs(t)%xa}function mz(t){const e=sB(t);return e<Math.PI?e:xa-e}function Gw(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function oB(t,e,i,r){if(Ta(sB(t-e),0))return i?[t,t]:[t,r?t-xa:t+xa];const[o,h]=r?[t-xa,t]:[t,t+xa];return[t,f_({min:o,max:h},e)]}function f_({min:t,max:e},i){let r;return r=e-i,r>=xa?(r-=r%xa,i+r):(r=i-t,r>=xa?(r-=r%xa,i-r):i)}function Ile(t,e){const i=f_(t,e);return i>t.min&&i<t.max?i:mz(i-t.min)<mz(i-t.max)?t.min:t.max}function aB(t,e,i,r=10){return e.map(o=>{let h=o;for(let d=0;d<r;d++){const[a,_,T,E,k,L]=i(h),O=t[0]-a,H=t[1]-_,re=-T,pe=-E;h+=-(2*O*re+2*H*pe)/(2*re*re+2*O*-k+2*pe*pe+2*H*-L||1e-6)}return h})}const $le=[0,0];function lB(t){const e=1-t,i=e*e,r=t*t;return[i*e,3*t*i,3*r*e,r*t]}function gz(t,e,i,r,o){const[h,d,a,_]=lB(o);return[t[0]*h+e[0]*d+i[0]*a+r[0]*_,t[1]*h+e[1]*d+i[1]*a+r[1]*_]}function yz(t,e,i,r,o){const[h,d,a,_]=lB(o);return t*h+e*d+i*a+r*_}function Ple(t,e,i){const r=t,[o,h,d]=e.b,a=lc([0,0],r,h,i),_=lc($le,h,d,i),T=lc([0,0],d,o,i),E=lc([0,0],a,_,i),k=lc([0,0],_,T,i);return[{b:[lc([],E,k,i),a,E]},{b:[[...o],k,T]}]}function dye(t,e,i){const r=t,[o,h,d]=e.b,a=aB(i,[.1,.5,.9],k=>{const L=1-k,[O,H]=gz(r,h,d,o,k);return[O,H,3*L*L*(h[0]-r[0])+6*L*k*(d[0]-h[0])+3*k*k*(o[0]-d[0]),3*L*L*(h[1]-r[1])+6*L*k*(d[1]-h[1])+3*k*k*(o[1]-d[1]),6*L*(d[0]-2*h[0]+r[0])+6*k*(o[0]-2*d[0]+h[0]),6*L*(d[1]-2*h[1]+r[1])+6*k*(o[1]-2*d[1]+h[1])]}).map(k=>Math.min(1,Math.max(0,k)));a.push(0,1);let _=1/0;const T=a.map(k=>{const L=gz(r,h,d,o,k),[O,H]=L,re=i[0]-O,pe=i[1]-H,ge=Math.sqrt(re*re+pe*pe);return _=Math.min(ge,_),{t:k,curvePoint:L,distance:ge}}),E=[];for(const k of T){const{t:L,distance:O}=k;fN(O,_)&&!E.some(({t:H})=>Ta(H,L))&&E.push(k)}return E}function Mle(t,e,i){const r=e,[o,h,d]=i.b;if(No(t,r),No(t,o),pz(t,h[0],h[1])&&pz(t,d[0],d[1]))return t;for(const a of _z(r[0],h[0],d[0],o[0]))a>0&&a<1&&Oae(t,yz(r[0],h[0],d[0],o[0],a));for(const a of _z(r[1],h[1],d[1],o[1]))a>0&&a<1&&Rae(t,yz(r[1],h[1],d[1],o[1],a));return t}function _z(t,e,i,r){const o=3*(3*(e-i)-t+r),h=6*(t-2*e+i),d=3*(e-t);if(o===0)return h!==0?[-d/h]:[];const a=Math.sqrt(h*h-4*o*d);return[(-h+a)/(2*o),(-h-a)/(2*o)]}function pye(t,e,i){let o=0,h=[e];for(let d=0;d<16;d++){let a=t;const _=[];for(const E of h)_.push(...Ple(a,E,.5)),a=E.b[0];h=_,a=t,o=0;let T=0;for(const E of h){const[k,L,O]=E.b,H=Math.sqrt(Uo(a,k));o+=(H+(Math.sqrt(Uo(a,L))+Math.sqrt(Uo(L,O))+Math.sqrt(Uo(O,k))))/2,T+=H,a=k}if(o-T<i)return o}return o}function kle(t,e,i){const[r,o]=t,[h,d]=e,[a,_]=i,[T,E]=[h-r,d-o];let k=T*(a-r)+E*(_-o);k/=T**2+E**2,k=u_(k,0,1);const L=lc([0,0],t,e,k);return{t:k,curvePoint:L,distance:Math.sqrt(Uo(L,i))}}let cB=class{constructor(e,i,r,o,h,d){this.cx=e,this.cy=i,this.radius=r,this.thetaStart=o,this.thetaEnd=h,this.isInvalid=d}get startPoint(){const{cx:e,cy:i,radius:r,thetaStart:o}=this;return[e+r*Math.cos(o),i+r*Math.sin(o)]}get endPoint(){const{cx:e,cy:i,radius:r,thetaEnd:o}=this;return[e+r*Math.cos(o),i+r*Math.sin(o)]}};function y1(t,e){const{cx:i,cy:r,radius:o}=t;return[i+o*Math.cos(e),r+o*Math.sin(e)]}function qb(t,e){if(t.isInvalid)return lc([0,0],t.startPoint,t.endPoint,e);const{thetaStart:i,thetaEnd:r}=t;return y1(t,i*(1-e)+r*e)}function mye(t,e){if(t.isInvalid)return kle(t.startPoint,t.endPoint,e);const{cx:i,cy:r,thetaStart:o,thetaEnd:h}=t,[d,a]=e,_=Ile(Gw(o,h),Math.atan2(a-r,d-i)),T=y1(t,_);return{t:(_-o)/(h-o),curvePoint:T,distance:Math.sqrt(Uo(e,T))}}function vz(t,e){if(e.isInvalid)return No(t,e.startPoint),No(t,e.endPoint),t;const{cx:i,cy:r,radius:o,thetaStart:h,thetaEnd:d}=e;No(t,y1(e,h)),No(t,y1(e,d));const a=Gw(h,d),_=Math.PI/2;let T=0;for(const E of[[i+o,r],[i,r+o],[i-o,r],[i,r-o]])T=f_(a,T),T>a.min&&T<a.max&&No(t,E),T+=_;return t}function gye(t){if(t.isInvalid)return 2*t.radius;const{radius:e,thetaStart:i,thetaEnd:r}=t;return e*Math.abs(r-i)}function Ale(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Dle(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Hb(t,e,i,r,o,h,d,a,_,T){return t[0]=e,t[1]=i,t[2]=r,t[3]=o,t[4]=h,t[5]=d,t[6]=a,t[7]=_,t[8]=T,t}function zle(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ole(t,e){if(t===e){const i=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Rle(t,e){const i=e[0],r=e[1],o=e[2],h=e[3],d=e[4],a=e[5],_=e[6],T=e[7],E=e[8],k=E*d-a*T,L=-E*h+a*_,O=T*h-d*_;let H=i*k+r*L+o*O;return H?(H=1/H,t[0]=k*H,t[1]=(-E*r+o*T)*H,t[2]=(a*r-o*d)*H,t[3]=L*H,t[4]=(E*i-o*_)*H,t[5]=(-a*i+o*h)*H,t[6]=O*H,t[7]=(-T*i+r*_)*H,t[8]=(d*i-r*h)*H,t):null}function Lle(t,e){const i=e[0],r=e[1],o=e[2],h=e[3],d=e[4],a=e[5],_=e[6],T=e[7],E=e[8];return t[0]=d*E-a*T,t[1]=o*T-r*E,t[2]=r*a-o*d,t[3]=a*_-h*E,t[4]=i*E-o*_,t[5]=o*h-i*a,t[6]=h*T-d*_,t[7]=r*_-i*T,t[8]=i*d-r*h,t}function Zb(t){const e=t[0],i=t[1],r=t[2],o=t[3],h=t[4],d=t[5],a=t[6],_=t[7],T=t[8];return e*(T*h-d*_)+i*(-T*o+d*a)+r*(_*o-h*a)}function uB(t,e,i){const r=e[0],o=e[1],h=e[2],d=e[3],a=e[4],_=e[5],T=e[6],E=e[7],k=e[8],L=i[0],O=i[1],H=i[2],re=i[3],pe=i[4],ge=i[5],Se=i[6],Pe=i[7],Re=i[8];return t[0]=L*r+O*d+H*T,t[1]=L*o+O*a+H*E,t[2]=L*h+O*_+H*k,t[3]=re*r+pe*d+ge*T,t[4]=re*o+pe*a+ge*E,t[5]=re*h+pe*_+ge*k,t[6]=Se*r+Pe*d+Re*T,t[7]=Se*o+Pe*a+Re*E,t[8]=Se*h+Pe*_+Re*k,t}function Fle(t,e,i){const r=e[0],o=e[1],h=e[2],d=e[3],a=e[4],_=e[5],T=e[6],E=e[7],k=e[8],L=i[0],O=i[1];return t[0]=r,t[1]=o,t[2]=h,t[3]=d,t[4]=a,t[5]=_,t[6]=L*r+O*d+T,t[7]=L*o+O*a+E,t[8]=L*h+O*_+k,t}function Nle(t,e,i){const r=e[0],o=e[1],h=e[2],d=e[3],a=e[4],_=e[5],T=e[6],E=e[7],k=e[8],L=Math.sin(i),O=Math.cos(i);return t[0]=O*r+L*d,t[1]=O*o+L*a,t[2]=O*h+L*_,t[3]=O*d-L*r,t[4]=O*a-L*o,t[5]=O*_-L*h,t[6]=T,t[7]=E,t[8]=k,t}function Ble(t,e,i){const r=i[0],o=i[1],h=i[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=h*e[6],t[7]=h*e[7],t[8]=h*e[8],t}function jle(t,e,i){const r=i[0],o=i[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t}function Ule(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Vle(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Gle(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function qle(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Hle(t,e){const i=e[0],r=e[1],o=e[2],h=e[3],d=i+i,a=r+r,_=o+o,T=i*d,E=r*d,k=r*a,L=o*d,O=o*a,H=o*_,re=h*d,pe=h*a,ge=h*_;return t[0]=1-k-H,t[3]=E-ge,t[6]=L+pe,t[1]=E+ge,t[4]=1-T-H,t[7]=O-re,t[2]=L-pe,t[5]=O+re,t[8]=1-T-k,t}function Zle(t,e){const i=e[0],r=e[1],o=e[2],h=e[4],d=e[5],a=e[6],_=e[8],T=e[9],E=e[10],k=E*d-a*T,L=-E*h+a*_,O=T*h-d*_,H=i*k+r*L+o*O;if(!H)return null;const re=1/H;return t[0]=k*re,t[1]=(-E*r+o*T)*re,t[2]=(a*r-o*d)*re,t[3]=L*re,t[4]=(E*i-o*_)*re,t[5]=(-a*i+o*h)*re,t[6]=O*re,t[7]=(-T*i+r*_)*re,t[8]=(d*i-r*h)*re,t}function Wle(t,e){const i=e[0],r=e[1],o=e[2],h=e[3],d=e[4],a=e[5],_=e[6],T=e[7],E=e[8],k=e[9],L=e[10],O=e[11],H=e[12],re=e[13],pe=e[14],ge=e[15],Se=i*a-r*d,Pe=i*_-o*d,Re=i*T-h*d,ze=r*_-o*a,Je=r*T-h*a,Xe=o*T-h*_,yt=E*re-k*H,mt=E*pe-L*H,je=E*ge-O*H,ke=k*pe-L*re,We=k*ge-O*re,Ce=L*ge-O*pe;let Ee=Se*Ce-Pe*We+Re*ke+ze*je-Je*mt+Xe*yt;return Ee?(Ee=1/Ee,t[0]=(a*Ce-_*We+T*ke)*Ee,t[1]=(_*je-d*Ce-T*mt)*Ee,t[2]=(d*We-a*je+T*yt)*Ee,t[3]=(o*We-r*Ce-h*ke)*Ee,t[4]=(i*Ce-o*je+h*mt)*Ee,t[5]=(r*je-i*We-h*yt)*Ee,t[6]=(re*Xe-pe*Je+ge*ze)*Ee,t[7]=(pe*Re-H*Xe-ge*Pe)*Ee,t[8]=(H*Je-re*Re+ge*Se)*Ee,t):null}function Yle(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Xle(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Jle(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function Kle(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function hB(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function Qle(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function ece(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t}function tce(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function ice(t,e){const i=t[0],r=t[1],o=t[2],h=t[3],d=t[4],a=t[5],_=t[6],T=t[7],E=t[8],k=e[0],L=e[1],O=e[2],H=e[3],re=e[4],pe=e[5],ge=e[6],Se=e[7],Pe=e[8],Re=Vw();return Math.abs(i-k)<=Re*Math.max(1,Math.abs(i),Math.abs(k))&&Math.abs(r-L)<=Re*Math.max(1,Math.abs(r),Math.abs(L))&&Math.abs(o-O)<=Re*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(h-H)<=Re*Math.max(1,Math.abs(h),Math.abs(H))&&Math.abs(d-re)<=Re*Math.max(1,Math.abs(d),Math.abs(re))&&Math.abs(a-pe)<=Re*Math.max(1,Math.abs(a),Math.abs(pe))&&Math.abs(_-ge)<=Re*Math.max(1,Math.abs(_),Math.abs(ge))&&Math.abs(T-Se)<=Re*Math.max(1,Math.abs(T),Math.abs(Se))&&Math.abs(E-Pe)<=Re*Math.max(1,Math.abs(E),Math.abs(Pe))}function rce(t){const e=Vw(),i=t[0],r=t[1],o=t[2],h=t[3],d=t[4],a=t[5],_=t[6],T=t[7],E=t[8];return Math.abs(1-(i*i+h*h+_*_))<=e&&Math.abs(1-(r*r+d*d+T*T))<=e&&Math.abs(1-(o*o+a*a+E*E))<=e}const nce=uB,sce=hB;Object.freeze(Object.defineProperty({__proto__:null,add:Kle,adjoint:Lle,copy:Dle,determinant:Zb,equals:ice,exactEquals:tce,frob:Jle,fromMat2d:qle,fromMat4:Ale,fromQuat:Hle,fromRotation:Vle,fromScaling:Gle,fromTranslation:Ule,identity:zle,invert:Rle,isOrthoNormal:rce,mul:nce,multiply:uB,multiplyScalar:Qle,multiplyScalarAndAdd:ece,normalFromMat4:Wle,normalFromMat4Legacy:Zle,projection:Yle,rotate:Nle,scale:Ble,scaleByVec2:jle,set:Hb,str:Xle,sub:sce,subtract:hB,translate:Fle,transpose:Ole},Symbol.toStringTag,{value:"Module"}));function FP(){return[1,0,0,0,1,0,0,0,1]}function oce(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function ace(t,e,i,r,o,h,d,a,_){return[t,e,i,r,o,h,d,a,_]}const lce=FP();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:lce,clone:oce,create:FP,fromValues:ace},Symbol.toStringTag,{value:"Module"}));const Wp=FP();function cce(t,e,i){const[r,o]=t,[h,d]=e,[a,_]=i;Hb(Wp,r,h,a,o,d,_,1,1,1);const T=Zb(Wp),E=4*T/(Uo(t,e)+Uo(e,i)+Uo(i,t));if(!isFinite(E)||Math.abs(E)<1e-8)return null;const k=r**2+o**2,L=h**2+d**2,O=a**2+_**2;Hb(Wp,k,L,O,o,d,_,1,1,1);const H=Zb(Wp);return Hb(Wp,k,L,O,r,h,a,1,1,1),[H/T*.5,Zb(Wp)/T*-.5]}function uce(t,e){const[i,r]=e.c,o=cce(t,r,i),h=o==null,d=o??lc([],t,i,.5),[a,_]=t,[T,E]=r,[k,L]=i,[O,H]=d,re=a-O,pe=_-H,ge=Math.sqrt(re*re+pe*pe),Se=Yy(_-H,a-O),Pe=Yy(E-H,T-O);let Re=Yy(L-H,k-O);return(Pe-Se)*(Re-Pe)<0&&(Re+=2*Math.sign(Se-Re)*Math.PI),new cB(O,H,ge,Se,Re,h)}function yye(t,e,i){const r=qb(t,i/2),o=qb(t,i),h=qb(t,(i+1)/2);return[{c:[o,r]},{c:[[...e.c[0]],h]}]}function NP(t){return"b"in t}function BP(t){return"c"in t}function qw(t){return Array.isArray(t)}function dB(t){return"a"in t&&t.a.length===4}function hce(t){return"a"in t&&t.a.length===7}function DT(t){return qw(t)?t:NP(t)?t.b[0]:BP(t)?t.c[0]:t.a[0]}function dce(t){if(NP(t)){const[e,i,r]=t.b;return{b:[[...e],[...i],[...r]]}}if(BP(t)){const[e,i]=t.c;return{c:[[...e],[...i]]}}if(qw(t))return[...t];if(dB(t)){const[e,i,r,o]=t.a;return{a:[[...e],[...i],r,o]}}if(hce(t)){const[e,i,r,o,h,d,a]=t.a;return{a:[[...e],[...i],r,o,h,d,a]}}return t}function pce(t,e){const[i,r,o,h]=e.a,[d,a]=t,[_,T]=i,[E,k]=r,L=d-E,O=a-k,H=Math.sqrt(L*L+O*O),re=_-E,pe=T-k,ge=Math.sqrt(re*re+pe*pe),Se=H===0||ge===0||!fN(H,ge),Pe=H,[Re,ze]=oB(Yy(a-k,d-E),Math.atan2(T-k,_-E),o,h);return new cB(E,k,Pe,Re,ze,Se)}function _ye(t,e,i){const{cx:r,cy:o,thetaStart:h,thetaEnd:d}=t,[a,_,T,E]=e.a,k=h*(1-i)+d*i;return[{a:[qb(t,i),[r,o],Math.abs(k-h)<Math.PI?1:0,E]},{a:[[...a],[r,o],Math.abs(d-k)<Math.PI?1:0,E]}]}let fce=class{constructor(e,i,r,o,h,d,a,_,T){this.cx=e,this.cy=i,this.a=r,this.b=o,this.cosR=h,this.sinR=d,this.u1=a,this.u2=_,this.isInvalid=T}};function pB(t,e){const[i,r,o,h,d,a,_]=e.a,[T,E]=t,[k,L]=i,[O,H]=r,re=a*_,pe=Math.cos(d),ge=Math.sin(d),[Se,Pe]=oB(Yy(1/re*(E-H)*pe-1/re*(T-O)*ge,1/a*(E-H)*ge+1/a*(T-O)*pe),Math.atan2(1/re*(L-H)*pe-1/re*(k-O)*ge,1/a*(L-H)*ge+1/a*(k-O)*pe),o,h);return new fce(O,H,a,re,pe,ge,Se,Pe,a===0||re===0)}function j0(t,e){const{a:i,b:r,cosR:o,sinR:h,cx:d,cy:a}=t,_=Math.cos(e),T=Math.sin(e);return[i*_*o-r*T*h+d,i*_*h+r*T*o+a]}function lf(t,e){const{u1:i,u2:r}=t;return j0(t,i*(1-e)+r*e)}function bye(t,e,i){if(i<0||i>1)return[];if(i===0||i===1)return[dce(e)];const[r,[o,h],d,a,_,T,E]=e.a,{u1:k,u2:L}=t,O=k*(1-i)+L*i;return[{a:[[...lf(t,i)],[o,h],Math.abs(O-k)<Math.PI?1:0,a,_,T,E]},{a:[[...r],[o,h],Math.abs(L-O)<Math.PI?1:0,a,_,T,E]}]}function xye(t,e){const{a:i,b:r,cosR:o,sinR:h,u1:d,u2:a}=t,_=Math.PI/6,T=aB(e,[1*_,2*_,4*_,5*_,7*_,8*_,10*_,11*_],re=>{const pe=Math.cos(re),ge=Math.sin(re),[Se,Pe]=j0(t,re);return[Se,Pe,-i*o*ge-r*h*pe,-i*h*ge+r*o*pe,-i*o*pe+r*h*ge,-i*h*pe-r*o*ge]}),E=Gw(d,a),k=new Set(T.map(re=>f_(E,re)).filter(re=>re>E.min&&re<E.max));k.add(d),k.add(a);let L,O,H=1/0;for(const re of k){const pe=j0(t,re),[ge,Se]=pe,Pe=e[0]-ge,Re=e[1]-Se,ze=Pe*Pe+Re*Re;ze<H&&(L=(re-d)/(a-d),O=pe,H=ze)}return{t:L,curvePoint:O,distance:Math.sqrt(H)}}function mce(t,e,i){const r=pB(e,i),{a:o,b:h,u1:d,u2:a,cosR:_,sinR:T,isInvalid:E}=r,k=i.a[0];if(No(t,e),No(t,k),E)return t;const L=Math.atan2(-h*T,o*_),O=L+Math.PI,H=Math.atan2(h*_,o*T),re=H+Math.PI,pe=Gw(d,a);for(const ge of[L,O,H,re].map(Se=>f_(pe,Se)))ge>pe.min&&ge<pe.max&&No(t,j0(r,ge));return t}function wye(t,e,i){const[r,o,h,d,a,_,T]=e.a,E=pB(t,e),{u1:k,u2:L,isInvalid:O}=E,H=L-k;if(O)return Math.sqrt(Uo(t,r));const re=14,pe=[0,0];let ge=0,Se=[lf(E,0),lf(E,.25),lf(E,.5),lf(E,.75),lf(E,1)];for(let Pe=0;Pe<re;Pe++){const Re=Se.length-1,ze=H/(2*Re),Je=[];for(let yt=0;yt<Re;yt++)Je.push(Se[yt]),Je.push(j0(E,k+(2*yt+1)*ze));Je.push(Se[Se.length-1]),Se=Je,ge=0;let Xe=0;for(let yt=1;yt<Se.length;yt++){const mt=Se[yt-1],je=Se[yt];if(ge+=Math.sqrt(Uo(mt,je)),yt>1){const ke=Se[yt-2],We=Ele(pe,ke,mt,o,je);Xe+=We?Math.sqrt(Uo(mt,We)):Math.abs(je[0]-mt[0])+Math.abs(je[1]-mt[1])}else Xe+=ge}if(Xe-ge<i)return ge}return ge}function gce(t,e,i){if(qw(i))return No(t,e),No(t,i),t;if(NP(i))return Mle(t,e,i);if(BP(i)){const r=uce(e,i);return vz(t,r)}if(dB(i)){const r=pce(e,i);return vz(t,r)}return mce(t,e,i)}function fB(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function mB(t){return t.points!==void 0}function gB(t){return t.x!==void 0&&t.y!==void 0}function yB(t){return t.paths!==void 0}function _B(t){return t.rings!==void 0}function vB(t){function e(i,r){return i==null?r:r==null?i:t(i,r)}return e}const ku=vB(Math.min),Au=vB(Math.max);function Sye(t,e){return yB(e)?ym(t,e.curvePaths??e.paths,!1,!1)??t:_B(e)?ym(t,e.curveRings??e.rings,!1,!1)??t:mB(e)?jP(t,e.points,!1,!1,!1,!1):fB(e)?bB(t,e):(gB(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Tye(t){let e,i,r,o;for(t.reset(),e=r=1/0,i=o=-1/0;t.nextPath();){const h=yce(t);e=Math.min(h[0],e),r=Math.min(h[1],r),i=Math.max(h[2],i),o=Math.max(h[3],o)}return p_([e,r,i,o])}function yce(t){let e,i,r,o;for(e=r=1/0,i=o=-1/0;t.nextPoint();)e=Math.min(t.x,e),r=Math.min(t.y,r),i=Math.max(t.x,i),o=Math.max(t.y,o);return p_([e,r,i,o])}function Cye(t,e){return yB(e)?ym(t,e.curvePaths??e.paths,!0,!1)??t:_B(e)?ym(t,e.curveRings??e.rings,!0,!1)??t:mB(e)?jP(t,e.points,!0,!1,!0,!1):fB(e)?bB(t,e,!0,!1,!0,!1):(gB(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function ym(t,e,i,r){const o=i?3:2;if(!e.length||!e[0].length)return null;let h,d,a,_,[T,E]=DT(e[0][0]),k=T,L=E;for(let O=0;O<e.length;O++){const H=e[O];for(let re=0;re<H.length;re++){const pe=DT(H[re]),[ge,Se]=pe;if(T=ku(T,ge),E=ku(E,Se),k=Au(k,ge),L=Au(L,Se),i&&pe.length>2){const Je=pe[2];h=ku(h,Je),d=Au(d,Je)}if(r&&pe.length>o){const Je=pe[o];a=ku(h,Je),_=Au(d,Je)}const Pe=H[re];if(qw(Pe)||re<1)continue;const Re=DT(H[re-1]),ze=zae(T,E,k,L);[T,E,k,L]=gce(ze,Re,Pe)}}return i?r?(t[0]=T,t[1]=E,t[2]=h,t[3]=a,t[4]=k,t[5]=L,t[6]=d,t[7]=_,t.length=8,t):(t[0]=T,t[1]=E,t[2]=h,t[3]=k,t[4]=L,t[5]=d,t.length=6,t):r?(t[0]=T,t[1]=E,t[2]=a,t[3]=k,t[4]=L,t[5]=_,t.length=6,t):(t[0]=T,t[1]=E,t[2]=k,t[3]=L,t.length=4,t)}function bB(t,e,i,r,o,h){const d=e.xmin,a=e.xmax,_=e.ymin,T=e.ymax;let E=e.zmin,k=e.zmax,L=e.mmin,O=e.mmax;return o?(E=E||0,k=k||0,h?(L=L||0,O=O||0,t[0]=d,t[1]=_,t[2]=E,t[3]=L,t[4]=a,t[5]=T,t[6]=k,t[7]=O,t):(t[0]=d,t[1]=_,t[2]=E,t[3]=a,t[4]=T,t[5]=k,t)):h?(L=L||0,O=O||0,t[0]=d,t[1]=_,t[2]=L,t[3]=a,t[4]=T,t[5]=O,t):(t[0]=d,t[1]=_,t[2]=a,t[3]=T,t)}function jP(t,e,i,r,o,h){const d=i?3:2,a=r&&h,_=i&&o;if(!e.length||!e[0].length)return null;let T,E,k,L,[O,H]=e[0],[re,pe]=e[0];for(let ge=0;ge<e.length;ge++){const Se=e[ge],[Pe,Re]=Se;if(O=ku(O,Pe),H=ku(H,Re),re=Au(re,Pe),pe=Au(pe,Re),_&&Se.length>2){const ze=Se[2];T=ku(T,ze),E=Au(E,ze)}if(a&&Se.length>d){const ze=Se[d];k=ku(T,ze),L=Au(E,ze)}}return o?(T=T||0,E=E||0,h?(k=k||0,L=L||0,t[0]=O,t[1]=H,t[2]=T,t[3]=k,t[4]=re,t[5]=pe,t[6]=E,t[7]=L,t):(t[0]=O,t[1]=H,t[2]=T,t[3]=re,t[4]=pe,t[5]=E,t)):h?(k=k||0,L=L||0,t[0]=O,t[1]=H,t[2]=k,t[3]=re,t[4]=pe,t[5]=L,t):(t[0]=O,t[1]=H,t[2]=re,t[3]=pe,t)}function _ce(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function vce(t){return t.points!==void 0}function bce(t){return t.x!==void 0&&t.y!==void 0}function xce(t){return t.paths!==void 0}function wce(t){return t.rings!==void 0}const UP=[];function xB(t,e,i,r){return{xmin:t,ymin:e,xmax:i,ymax:r}}function wB(t,e,i,r,o,h){return{xmin:t,ymin:e,zmin:i,xmax:r,ymax:o,zmax:h}}function SB(t,e,i,r,o,h){return{xmin:t,ymin:e,mmin:i,xmax:r,ymax:o,mmax:h}}function TB(t,e,i,r,o,h,d,a){return{xmin:t,ymin:e,zmin:i,mmin:r,xmax:o,ymax:h,zmax:d,mmax:a}}function VP(t,e=!1,i=!1){return e?i?TB(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):wB(t[0],t[1],t[2],t[3],t[4],t[5]):i?SB(t[0],t[1],t[2],t[3],t[4],t[5]):xB(t[0],t[1],t[2],t[3])}function Eye(t){return t?_ce(t)?t:bce(t)?Sce(t):wce(t)?EB(t):xce(t)?IB(t):vce(t)?CB(t):null:null}function CB(t){const{hasZ:e,hasM:i,points:r}=t,o=jP(UP,r,e??!1,i??!1,e??!1,i??!1);return o?VP(o,e,i):null}function Sce(t){const{x:e,y:i,z:r,m:o}=t,h=o!=null;return r!=null?h?TB(e,i,r,o,e,i,r,o):wB(e,i,r,e,i,r):h?SB(e,i,o,e,i,o):xB(e,i,e,i)}function EB(t){const{hasZ:e,hasM:i,rings:r,curveRings:o}=t,h=ym(UP,o??r,e??!1,i??!1);return h?VP(h,e,i):null}function IB(t){const{hasZ:e,hasM:i,paths:r,curvePaths:o}=t,h=ym(UP,o??r,e??!1,i??!1);return h?VP(h,e,i):null}function _m(t,e,i=!1){let{hasM:r,hasZ:o}=t;Array.isArray(e)?e.length!==4||r||o?e.length===3&&i&&!r?(o=!0,r=!1):e.length===3&&r&&o&&(r=!1,o=!1):(r=!0,o=!0):(o=!o&&e.hasZ&&(!r||e.hasM),r=!r&&e.hasM&&(!o||e.hasZ)),t.hasZ=o,t.hasM=r}var KE;function Tce(t){if(!t)return;let{points:e,hasM:i,hasZ:r,spatialReference:o}=t;switch(e??=[],e?.at(0)?.length){case 4:r??=!0,i??=!0;break;case 3:r??=i!==!0,i??=!r;break;default:r??=!1,i??=!1}return o??=Rt.WGS84,{...t,hasM:i,hasZ:r,points:e,spatialReference:o}}let rl=KE=class extends Hn{constructor(t){super(Tce(t)),this.points=[],this.type="multipoint"}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=CB(this);return t?new _i({...t,spatialReference:this.spatialReference}):null}writePoints(t,e){e.points=dt(this.points)}clone(){const{points:t,spatialReference:e,hasM:i,hasZ:r}=this;return new KE({points:dt(t),spatialReference:e.clone(),hasM:i,hasZ:r})}addPoint(t){return _m(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(i.z=e[2],r=3),this.hasM&&(i.m=e[r]),new oi(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new oi(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(_m(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};P([R({readOnly:!0})],rl.prototype,"cache",null),P([R({readOnly:!0})],rl.prototype,"extent",null),P([R({type:[[Number]],json:{write:{isRequired:!0}}})],rl.prototype,"points",void 0),P([Bi("points")],rl.prototype,"writePoints",null),rl=KE=P([Ge("esri.geometry.Multipoint")],rl),rl.prototype.toJSON.isDefaultToJSON=!0;function Iye(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function Cce(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function GP(t,e){const i=e[0]-t[0],r=e[1]-t[1];if(t.length>2&&e.length>2){const o=t[2]-e[2];return Math.sqrt(i*i+r*r+o*o)}return Math.sqrt(i*i+r*r)}function Ece(t,e,i){const r=t[0]+i*(e[0]-t[0]),o=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[r,o,t[2]+i*(e[2]-t[2])]:[r,o]}function $ye(t,e,i,r){const[o,h]=e,[d,a]=i,[_,T]=r,E=_-d,k=T-a,L=E*E+k*k,O=(o-d)*E+(h-a)*k,H=Math.min(1,Math.max(0,O/L));return t[0]=d+E*H,t[1]=a+k*H,t}function Pye(t,e,i,r,o,h){let d=i,a=r,_=o-d,T=h-a;if(_!==0||T!==0){const E=((t-d)*_+(e-a)*T)/(_*_+T*T);E>1?(d=o,a=h):E>0&&(d+=_*E,a+=T*E)}return _=t-d,T=e-a,_*_+T*T}function $B(t,e){return Ece(t,e,.5)}function Mye(t){const e=t.length;let i=0;for(let r=0;r<e-1;++r)i+=GP(t[r],t[r+1]);return i}function Ice(t,e=0,i=1){let r=0;const o=t.length;let h=t[0];for(let d=1;d<o;d++){const a=t[d];r+=(a[e]-h[e])*(a[i]+h[i]),h=a}if(PB(t)){const d=t[0];r+=(d[e]-h[e])*(d[i]+h[i])}return r>=0}function PB(t){const e=t.length;return e>0&&!hw(t[0],t[e-1])}function kye(t){if("rings"in t)for(const e of t.rings)PB(e)&&e.push(e[0].slice())}function Aye(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function $ce(t){return Pce(t.rings,t.hasZ??!1)}function MB(t){const e=$ce(t);if(!e)return null;const{hasZ:i,spatialReference:r}=t,[o,h,d]=e;return isNaN(o)||isNaN(h)||i&&isNaN(d)?null:{x:o,y:h,z:i?d:void 0,spatialReference:r}}function Pce(t,e){if(!t?.length)return null;const i=[],r=[],o=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let h=0,d=t.length;h<d;h++){const a=kB(t[h],e,o);a&&r.push(a)}if(r.sort((h,d)=>{let a=h[2]-d[2];return a===0&&e&&(a=h[4]-d[4]),a}),r.length&&(i[0]=r[0][0],i[1]=r[0][1],e&&(i[2]=r[0][3]),(i[0]<o[0]||i[0]>o[1]||i[1]<o[2]||i[1]>o[3]||e&&(i[2]<o[4]||i[2]>o[5]))&&(i.length=0)),!i.length){const h=t[0]&&t[0].length?Mce(t[0],e):null;if(!h)return null;i[0]=h[0],i[1]=h[1],e&&h.length>2&&(i[2]=h[2])}return i}function kB(t,e,i){let r=0,o=0,h=0,d=0,a=0;const _=t.length?t[0][0]:0,T=t.length?t[0][1]:0,E=t.length&&e?t[0][2]:0;for(let L=0;L<t.length;L++){const O=t[L],H=t[(L+1)%t.length],[re,pe,ge]=O,Se=re-_,Pe=pe-T,[Re,ze,Je]=H,Xe=Re-_,yt=ze-T,mt=Se*yt-Xe*Pe;if(d+=mt,r+=(Se+Xe)*mt,o+=(Pe+yt)*mt,e&&O.length>2&&H.length>2){const je=ge-E,ke=Je-E,We=Se*ke-Xe*je;h+=(je+ke)*We,a+=We}re<i[0]&&(i[0]=re),re>i[1]&&(i[1]=re),pe<i[2]&&(i[2]=pe),pe>i[3]&&(i[3]=pe),e&&(ge<i[4]&&(i[4]=ge),ge>i[5]&&(i[5]=ge))}if(d>0&&(d*=-1),a>0&&(a*=-1),!d)return null;d*=.5,a*=.5;const k=[r/(6*d)+_,o/(6*d)+T,d];return e&&(i[4]===i[5]||a===0?(k[3]=(i[4]+i[5])/2,k[4]=0):(k[3]=h/(6*a)+E,k[4]=a)),k}function Dye(t,e){let i=0,r=0,o=0;t.nextPoint();const h=t.pathSize?t.x:0,d=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const _=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const T=[t.x,t.y],[E,k]=_,L=E-h,O=k-d,[H,re]=T,pe=H-h,ge=re-d,Se=L*ge-pe*O;o+=Se,i+=(L+pe)*Se,r+=(O+ge)*Se,E<e[0]&&(e[0]=E),E>e[1]&&(e[1]=E),k<e[2]&&(e[2]=k),k>e[3]&&(e[3]=k)}return o>0&&(o*=-1),o?(o*=.5,[i/(6*o)+h,r/(6*o)+d,o]):null}function Mce(t,e){const i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let o=0,h=0,d=0,a=0;for(let _=0,T=t.length;_<T-1;_++){const E=t[_],k=t[_+1];if(E&&k){i[0]=E[0],i[1]=E[1],r[0]=k[0],r[1]=k[1],e&&E.length>2&&k.length>2&&(i[2]=E[2],r[2]=k[2]);const L=GP(i,r);if(L){o+=L;const O=$B(E,k);h+=L*O[0],d+=L*O[1],e&&O.length>2&&(a+=L*O[2])}}}return o>0?e?[h/o,d/o,a/o]:[h/o,d/o]:t.length?t[0]:null}function kce(t){const{hasZ:e,totalSize:i}=t;if(i===0)return null;const r=[],o=[],h=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const d=kB(Cce(t),t.hasZ,h);d&&o.push(d)}if(o.sort((d,a)=>{let _=d[2]-a[2];return _===0&&e&&(_=d[4]-a[4]),_}),o.length&&(r[0]=o[0][0],r[1]=o[0][1],e&&(r[2]=o[0][3]),(r[0]<h[0]||r[0]>h[1]||r[1]<h[2]||r[1]>h[3]||e&&(r[2]<h[4]||r[2]>h[5]))&&(r.length=0)),!r.length){t.reset(),t.nextPath();const d=t.pathSize?Ace(t):null;if(!d)return null;r[0]=d[0],r[1]=d[1],e&&d.length>2&&(r[2]=d[2])}return r}function Ace(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let o=0,h=0,d=0,a=0;if(t.nextPoint()){let _=t.x,T=t.y,E=t.z;for(;t.nextPoint();){const k=t.x,L=t.y,O=t.z;i[0]=_,i[1]=T,r[0]=k,r[1]=L,e&&(i[2]=E,r[2]=O);const H=GP(i,r);if(H){o+=H;const re=$B(i,r);h+=H*re[0],d+=H*re[1],e&&re.length>2&&(a+=H*re[2])}_=k,T=L,E=O}}return o>0?e?[h/o,d/o,a/o]:[h/o,d/o]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const Dce=1e-6;function zye(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<Dce){const o=kce(t);return o?[o[0],o[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)Oce(i,r,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=r[0],i[1]+=r[1],i}const zce=1/3;function Oce(t,e,i){if(!t||!i||i.pathSize<3)return null;i.nextPoint();const r=i.x,o=i.y;i.nextPoint();let h,d=i.x-r,a=i.y-o,_=0,T=0;for(;i.nextPoint();)_=i.x-r,T=i.y-o,h=.5*zce*(_*a-T*d),t[0]+=h*(d+_),t[1]+=h*(a+T),d=_,a=T;const E=i.getCurrentRingArea(),k=[r,o];return k[0]-=e[0],k[1]-=e[1],k[0]*=E,k[1]*=E,t[0]+=k[0],t[1]+=k[1],t}var Wb;function bz(t){return!Array.isArray(t[0])}function Rce(t){return typeof t[0]?.[0]=="number"}function Lce(t){if(!t)return;let{rings:e,hasM:i,hasZ:r,spatialReference:o}=t;switch(e??=[],Rce(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,i??=!0;break;case 3:r??=i!==!0,i??=!r;break;default:r??=!1,i??=!1}return o??=Rt.WGS84,{...t,hasM:i,hasZ:r,rings:e,spatialReference:o}}let Rn=Wb=class extends Hn{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:i}=t;let r=!1,o=!1;for(const d of e)d.hasZ&&(r=!0),d.hasM&&(o=!0);const h={rings:e.map(d=>{const a=[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]];if(r&&d.hasZ){const _=d.zmin+.5*(d.zmax-d.zmin);for(let T=0;T<a.length;T++)a[T].push(_)}if(o&&d.hasM){const _=d.mmin+.5*(d.mmax-d.mmin);for(let T=0;T<a.length;T++)a[T].push(_)}return a}),spatialReference:i};return r&&(h.hasZ=!0),o&&(h.hasM=!0),new Wb(h)}constructor(t){super(Lce(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){C5(ui.getLogger(this),"centroid",{replacement:"Please use centroidOperator.execute() instead.",version:"4.34",warnOnce:!0});const t=MB(this);return t?oi.fromJSON(t):null}writeCurveRings(t,e){e.curveRings=dt(t)}get extent(){const t=EB(this),{spatialReference:e}=this;return t?new _i({...t,spatialReference:e}):null}get isSelfIntersecting(){return C5(ui.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),kae(this.rings)}writeRings(t,e){e.rings=dt(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(bz(t)){const r=[];for(let o=0,h=t.length;o<h;o++)r[o]=t[o].toArray();e[i]=r}else e[i]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new Wb;return t.spatialReference=this.spatialReference,t.rings=dt(this.rings),t.curveRings=dt(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;if(e!=null!=(i!=null)||e!=null&&i!=null&&!e.equals(i)||this.rings.length!==t.rings.length)return!1;const r=([o,h,d,a],[_,T,E,k])=>o===_&&h===T&&(d==null&&E==null||d===E)&&(a==null&&k==null||a===k);for(let o=0;o<this.rings.length;o++){const h=this.rings[o],d=t.rings[o];if(!hw(h,d,r))return!1}return!0}contains(t){if(!t)return!1;const e=GN(t,this.spatialReference);return xae(this,e??t)}isClockwise(t){const e=bz(t)?t.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):t;return Ice(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],r=this.hasZ,o=this.hasM;return r&&!o?new oi(i[0],i[1],i[2],void 0,this.spatialReference):o&&!r?new oi(i[0],i[1],void 0,i[2],this.spatialReference):r&&o?new oi(i[0],i[1],i[2],i[3],this.spatialReference):new oi(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(_m(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new oi(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,r=e.map(o=>new oi(o,i));return this.notifyChange("rings"),r}setPoint(t,e,i){return this._validateInputs(t,e)?(_m(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const r=this.rings[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};P([R({readOnly:!0})],Rn.prototype,"cache",null),P([R({readOnly:!0})],Rn.prototype,"centroid",null),P([R({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Rn.prototype,"curveRings",void 0),P([Bi("curveRings")],Rn.prototype,"writeCurveRings",null),P([R({readOnly:!0})],Rn.prototype,"extent",null),P([R({readOnly:!0})],Rn.prototype,"isSelfIntersecting",null),P([R({type:[[[Number]]],json:{write:{isRequired:!0}}})],Rn.prototype,"rings",void 0),P([Bi("rings")],Rn.prototype,"writeRings",null),Rn=Wb=P([Ge("esri.geometry.Polygon")],Rn),Rn.prototype.toJSON.isDefaultToJSON=!0;var QE;function Fce(t){return!Array.isArray(t[0])}function Nce(t){return typeof t[0]?.[0]=="number"}function Bce(t){if(!t)return;let{paths:e,hasM:i,hasZ:r,spatialReference:o}=t;switch(e??=[],Nce(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,i??=!0;break;case 3:r??=i!==!0,i??=!r;break;default:r??=!1,i??=!1}return o??=Rt.WGS84,{...t,hasM:i,hasZ:r,paths:e,spatialReference:o}}let Oo=QE=class extends Hn{constructor(t){super(Bce(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=dt(t)}get extent(){const t=IB(this),{spatialReference:e}=this;return t?new _i({...t,spatialReference:e}):null}writePaths(t,e){e.paths=dt(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(Fce(t)){const r=[];for(let o=0,h=t.length;o<h;o++)r[o]=t[o].toArray();e[i]=r}else e[i]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new QE;return t.spatialReference=this.spatialReference,t.paths=dt(this.paths),t.curvePaths=dt(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],r=this.hasZ,o=this.hasM;return r&&!o?new oi(i[0],i[1],i[2],void 0,this.spatialReference):o&&!r?new oi(i[0],i[1],void 0,i[2],this.spatialReference):r&&o?new oi(i[0],i[1],i[2],i[3],this.spatialReference):new oi(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(_m(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,r=e.map(o=>new oi(o,i));return this.notifyChange("paths"),r}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new oi(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(_m(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const r=this.paths[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};P([R({readOnly:!0})],Oo.prototype,"cache",null),P([R({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Oo.prototype,"curvePaths",void 0),P([Bi("curvePaths")],Oo.prototype,"writeCurvePaths",null),P([R({readOnly:!0})],Oo.prototype,"extent",null),P([R({type:[[[Number]]],json:{write:{isRequired:!0}}})],Oo.prototype,"paths",void 0),P([Bi("paths")],Oo.prototype,"writePaths",null),Oo=QE=P([Ge("esri.geometry.Polyline")],Oo),Oo.prototype.toJSON.isDefaultToJSON=!0;function AB(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function DB(t){return t.points!==void 0}function zB(t){return t.x!==void 0&&t.y!==void 0}function OB(t){return t.paths!==void 0||t.curvePaths!==void 0}function RB(t){return t.rings!==void 0||t.curveRings!==void 0}function LB(t){return t==null?null:t instanceof Hn?t:zB(t)?oi.fromJSON(t):OB(t)?Oo.fromJSON(t):RB(t)?Rn.fromJSON(t):DB(t)?rl.fromJSON(t):AB(t)?_i.fromJSON(t):null}function qP(t){return t?zB(t)?"esriGeometryPoint":OB(t)?"esriGeometryPolyline":RB(t)?"esriGeometryPolygon":AB(t)?"esriGeometryEnvelope":DB(t)?"esriGeometryMultipoint":null:null}const jce={esriGeometryPoint:oi,esriGeometryPolyline:Oo,esriGeometryPolygon:Rn,esriGeometryEnvelope:_i,esriGeometryMultipoint:rl,esriGeometryMultiPatch:Rn};function Uce(t){return t&&jce[t]||null}const Oye=yo()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),Rye=yo()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),Vce={base:Hn,key:"type",typeMap:{extent:_i,multipoint:rl,point:oi,polyline:Oo,polygon:Rn}},FB=Symbol("idFieldsProviderSymbol");function Gce(t){return!!t&&FB in t}function xz(t){return Gce(t)?t[FB]:void 0}const NB=Symbol("popupProvider");function qce(t){return!!t&&NB in t}function Hce(t){return qce(t)?t[NB]:null}function Lye(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const i=[];for(const r of e.fieldNames)i.push(t.attributes[r]??null);return JSON.stringify(i)}}}function wz(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const i=e.uniqueIdFields.map(r=>t.attributes?.[r]);return JSON.stringify(i)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const Sz=new vl({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Zce=0,Nr=class extends Lt{constructor(e){super(e),this.id="sym"+Zce++,this.type=null,this.color=new or([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};P([R({type:Sz.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:Sz.write,isRequired:!0}}})],Nr.prototype,"type",void 0),P([R({type:or,json:{write:{allowNull:!0}}})],Nr.prototype,"color",void 0),P([Fr("color")],Nr.prototype,"readColor",null),Nr=P([Ge("esri.symbols.Symbol")],Nr);var eI;let $s=eI=class extends Nr{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const i=this.data.primitiveOverrides;if(i){const r=i.map(o=>{const h=o.valueExpressionInfo;return h?RF(t,e,null,h.expression):null});await Promise.all(r)}}}clone(){return new eI({data:dt(this.data)})}hash(){return NL(JSON.stringify(this.data)).toString()}};P([R({json:{write:!1}})],$s.prototype,"color",void 0),P([R({json:{write:!0}})],$s.prototype,"data",void 0),P([Fr("data",["symbol"])],$s.prototype,"readData",null),P([Bi("data",{})],$s.prototype,"writeData",null),P([mi({CIMSymbolReference:"cim"},{readOnly:!0})],$s.prototype,"type",void 0),$s=eI=P([Ge("esri.symbols.CIMSymbol")],$s);function Wce(t,e,i=nr){return e||(e=new i),e===t||e.destroyed||(e.removeAll(),Xce(t)?e.addMany(t):t&&e.add(t)),e}function Yce(t){return t}function Xce(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let Jce=class{constructor(){this._resolver=am(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(As())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=am(),i=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(i);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},o=>{this.isFulfilled()||this._allPromise!==r||Dd(o)||this._resolver.reject(o)}),e.resolve()}};const Kce=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),this._promiseProps=new Jce,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(r,o){return this._promiseProps.promise.then(()=>this).then(r,o)}catch(r){return this.when(null,r)}addResolvingPromise(r){r&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in r?r.when():r)}addResolvingTask(r){r&&!this._promiseProps.isFulfilled()&&(this.addHandles(uQ(r)),this._promiseProps.addResolvingPromise(r.promise))}};return i=P([Ge("esri.core.Promise")],i),i},Qce=Kce(Ln),eue="not-loaded",tue="loading",iue="failed",Tz="loaded",rue=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(o=>{const h=this.load.bind(this);this.load=d=>{const a=new Promise((_,T)=>{const E=MQ(d,T);this.destroyed&&T(new Ot("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(_,T).finally(()=>{E&&E.remove()})});if(this.loadStatus===eue){this._set("loadStatus",tue);const _=this._loadController=new AbortController;h({signal:_.signal})}return o(),a}})),this.when(()=>{this._set("loadStatus",Tz),this._loadController=null},o=>{this.destroyed||(this._set("loadStatus",iue),this._set("loadError",o),this._loadController=null)})}destroy(){this._loadController&&(this._loadController=CQ(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===Tz}get loadWarnings(){return this._get("loadWarnings")}load(r){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new Ot("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return P([R({readOnly:!0})],i.prototype,"loaded",null),P([R({readOnly:!0})],i.prototype,"loadError",void 0),P([R({clonable:!1})],i.prototype,"loadStatus",void 0),P([R({type:[$0],readOnly:!0})],i.prototype,"loadWarnings",null),i=P([Ge("esri.core.Loadable")],i),i},BB=rue(Qce);function Bye(t){return!(!t||!t.load)}let tb;function nue(t){return tb&&!tb.destroyed||(tb=t()),tb}var tI;const sue=new vl({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Rr=tI=class extends Ln{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new tI({categories:this.categories?dt(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map(d=>Array.isArray(d)?JSON.stringify(d):d));let r="";if(this.extent){const d=GN(this.extent,Rt.WGS84);d!=null&&(r=`${d.xmin},${d.ymin},${d.xmax},${d.ymax}`)}let o=this.query;!this.disableExtraQuery&&t.extraQuery&&(o="("+o+")"+t.extraQuery);const h={categories:i,bbox:r,q:o,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(h.sortField=this.sortField.split(",").map(d=>sue.toJSON(d.trim())).join(","),h.sortOrder=this.sortOrder),{query:{...e,...h}}}};P([R()],Rr.prototype,"categories",void 0),P([R()],Rr.prototype,"disableExtraQuery",void 0),P([R({type:_i})],Rr.prototype,"extent",void 0),P([R()],Rr.prototype,"filter",void 0),P([R()],Rr.prototype,"num",void 0),P([R()],Rr.prototype,"query",void 0),P([R()],Rr.prototype,"sortField",void 0),P([R()],Rr.prototype,"sortOrder",null),P([R()],Rr.prototype,"start",void 0),Rr=tI=P([Ge("esri.portal.PortalQueryParams")],Rr);var iI;let wr=iI=class extends Lt{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const i=e.categorySchema||[];return i.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):i})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new Ot("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new iI({sourceJSON:t});return e.read(t),e}queryItems(t,e){let i=Ds(Rr,t);const r=this.portal;return parseFloat(r.currentVersion)>5?(i=i||new Rr,r.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new Rr,i.query="group:"+this.id+(i.query?" "+i.query:""),r.queryItems(i,e))}_fetchCategorySchemaSet(t,e){const i=this.portal;return i.fetchSelf(i.authMode,!0,e).then(r=>{const o=r.contentCategorySetsGroupQuery;if(o){const h=new Rr({disableExtraQuery:!0,num:1,query:o});return i.queryGroups(h,e)}throw new Ot("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const o=r.results[0],h=new Rr({num:1,query:`typekeywords:"${t}"`});return o.queryItems(h,e)}throw new Ot("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",e).then(o=>{const h=o?.categorySchema;return h?.length?h:[]}):[])}};P([R()],wr.prototype,"access",void 0),P([R({type:Date})],wr.prototype,"created",void 0),P([R()],wr.prototype,"description",void 0),P([R()],wr.prototype,"id",void 0),P([R()],wr.prototype,"isInvitationOnly",void 0),P([R({type:Date})],wr.prototype,"modified",void 0),P([R()],wr.prototype,"owner",void 0),P([R()],wr.prototype,"portal",void 0),P([R()],wr.prototype,"snippet",void 0),P([R()],wr.prototype,"sortField",void 0),P([R()],wr.prototype,"sortOrder",void 0),P([R()],wr.prototype,"sourceJSON",void 0),P([R()],wr.prototype,"tags",void 0),P([R()],wr.prototype,"thumbnail",void 0),P([R({readOnly:!0})],wr.prototype,"thumbnailUrl",null),P([R()],wr.prototype,"title",void 0),P([R({readOnly:!0})],wr.prototype,"url",null),wr=iI=P([Ge("esri.portal.PortalGroup")],wr);let qh=class extends Ln{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};P([R()],qh.prototype,"nextQueryParams",void 0),P([R()],qh.prototype,"queryParams",void 0),P([R()],qh.prototype,"results",void 0),P([R()],qh.prototype,"total",void 0),qh=P([Ge("esri.portal.PortalQueryResult")],qh);let ic=class extends Lt{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Ot("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};P([R({type:Date})],ic.prototype,"created",void 0),P([R()],ic.prototype,"id",void 0),P([R()],ic.prototype,"portal",void 0),P([R()],ic.prototype,"title",void 0),P([R({readOnly:!0})],ic.prototype,"url",null),P([R()],ic.prototype,"username",void 0),ic=P([Ge("esri.portal.PortalFolder")],ic);var rI;let zi=rI=class extends Lt{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,i=t?.data,r=t?.folder,o={method:"post"};e&&(o.query=e.createPostQuery(),i!=null&&(typeof i=="string"?o.query.text=i:typeof i=="object"&&(o.query.text=JSON.stringify(i))));let h=this.userContentUrl;return r&&(h+="/"+(typeof r=="string"?r:r.id)),this.portal.request(h+"/addItem",o).then(d=>(e.id=d.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let i=this.userContentUrl;t.ownerFolder&&(i+="/"+t.ownerFolder);const r=e?{permanentDelete:!0}:{};await this.portal.request(i+`/items/${t.id}/delete`,{method:"post",query:r}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const i=this.userContentUrl+"/deleteItems",r=[],o=t.map(h=>h.id);if(o.length){const h={method:"post",query:{items:o.join(","),permanentDelete:e}},d=await this.portal.request(i,h);for(const a of d.results){const _=t.find(k=>a.itemId===k.id),T=a.success;let E=null;T?(_.id=null,_.portal=null):a.error&&(E=new Ot("portal:delete-item-failed",a.error.message,a.error)),r.push({item:_,success:T,error:E})}}return r}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let i;return i=e&&e.folders?e.folders.map(r=>{const o=ic.fromJSON(r);return o.portal=this.portal,o}):[],i})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(i=>{const r=wr.fromJSON(i);return r.portal=this.portal,r}):[],e})}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:i}=await Kn(()=>import("./PortalItem-B87a-lvs.js"),__vite__mapDeps([34,1,2,3])),r={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},o=await this.portal.request(e,{query:r});let h;return o?.items?(h=o.items.map(d=>{const a=i.fromJSON(d);return a.portal=this.portal,a}),await Promise.all(h.map(d=>d.load())),{items:h,nextStart:o.nextStart,total:o.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new wr({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Ot("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const i=this.userContentUrl,r=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(i+`/items/${t.id}/restore`,{method:"post",query:r})}toJSON(){throw new Ot("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new rI({sourceJSON:t});return e.read(t),e}};P([R()],zi.prototype,"access",void 0),P([R({type:Date})],zi.prototype,"created",void 0),P([R()],zi.prototype,"culture",void 0),P([R()],zi.prototype,"description",void 0),P([R()],zi.prototype,"email",void 0),P([R()],zi.prototype,"favGroupId",void 0),P([R()],zi.prototype,"fullName",void 0),P([R()],zi.prototype,"id",void 0),P([R({type:Date})],zi.prototype,"modified",void 0),P([R()],zi.prototype,"orgId",void 0),P([R()],zi.prototype,"portal",void 0),P([R()],zi.prototype,"preferredView",void 0),P([R()],zi.prototype,"privileges",void 0),P([R()],zi.prototype,"region",void 0),P([R()],zi.prototype,"role",void 0),P([R()],zi.prototype,"roleId",void 0),P([R()],zi.prototype,"sourceJSON",void 0),P([R()],zi.prototype,"thumbnail",void 0),P([R({readOnly:!0})],zi.prototype,"thumbnailUrl",null),P([R()],zi.prototype,"units",void 0),P([R({readOnly:!0})],zi.prototype,"userContentUrl",null),P([R({readOnly:!0})],zi.prototype,"url",null),P([R()],zi.prototype,"username",void 0),P([R()],zi.prototype,"userLicenseTypeId",void 0),P([R()],zi.prototype,"userType",void 0),zi=rI=P([Ge("esri.portal.PortalUser")],zi);var to;let oy;const Cz={PortalGroup:()=>Promise.resolve({default:wr}),PortalItem:()=>Kn(()=>import("./PortalItem-B87a-lvs.js"),__vite__mapDeps([34,1,2,3])),PortalUser:()=>Promise.resolve({default:zi})};var ul;let tt=(ul=class extends MF(BB){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.g3DTilesGalleryGroupQuery=null,this.g3dTilesEnabled=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Ai.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){Ez.unregister(this),this.defaultBasemap=xb(this.defaultBasemap),this.defaultDevBasemap=xb(this.defaultDevBasemap),this.defaultVectorBasemap=xb(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=e_(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const i of e)Ai.request.trustedServers.includes(i)||Ai.request.trustedServers.push(i);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,i=!e||this.canSearchPublic;return this.id&&!i?` AND orgid:${this.id}`:null}get hasAPIKey(){return eF(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get loaded(){return super.loaded}get restUrl(){let e=this.url;if(e){const i=e.indexOf("/sharing");e=i>0?e.slice(0,i):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,i=this.thumbnail;return e&&i?this._normalizeSSL(e+"/portals/self/resources/"+i):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let i=null;return e&&(i=zi.fromJSON(e),i.portal=this),i}load(e){const i=Kn(async()=>{const{default:r}=await import("./Basemap-2vIX0kFe.js");return{default:r}},__vite__mapDeps([35,1,2,36,37,34,3,38,39])).then(({default:r})=>{w0(e),oy=r}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(r=>{if(!this.hasAPIKey&&Ni){const o=Ni;this.credential=o.findCredential(this.restUrl),this.credential||this.authMode!==to.AUTH_MODE_AUTO&&this.authMode!==to.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=o.on("credential-create",oue(new WeakRef(this))),Ez.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(i),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),i=(await Kn(async()=>{const{default:r}=await import("./ElevationLayer-9sI3qKWa.js");return{default:r}},__vite__mapDeps([40,1,2,41,42,43,44,45,46,12,24,47,48,49,37,34,3,50,51,52,8]))).default;return e?e.map(r=>new i({id:r.id,url:r.url})):[]}async fetchBasemaps(e,i){const r=await this._fetchBasemaps(e,i);if(i?.include3d===!0&&this.use3dBasemaps!==!1){const o=await this._fetchBasemaps3D(e,i);r.unshift(...o)}return r}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const i=new Rr;i.query=this.default3DBasemapQuery,i.disableExtraQuery=!0;const r=(await this.queryItems(i,e)).results.find(o=>o.type==="Web Scene");return r?new oy({portalItem:r}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(i=>i.categorySchema):Vu(e)?Promise.reject(As()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then(i=>i.classificationSchema):null}fetchFeaturedGroups(e){const i=this.featuredGroups,r=new Rr({num:100,sortField:"title"});if(i?.length){const o=[];for(const h of i)o.push(`(title:"${h.title}" AND owner:${h.owner})`);return r.query=o.join(" OR "),this.queryGroups(r,e).then(h=>h.results)}return Vu(e)?Promise.reject(As()):Promise.resolve([])}fetchRegions(e){const i=this.user?.culture||this.culture||cd();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:i}})}fetchSettings(e){const i=this.user?.culture||this.culture||cd();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:i}})}static getDefault(){return nue(()=>new to)}queryGroups(e,i){return this.queryPortal("/community/groups",e,"PortalGroup",i)}queryItems(e,i){return this.queryPortal("/search",e,"PortalItem",i)}queryUsers(e,i){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",i)}fetchSelf(e=this.authMode,i=!1,r){const o=this.restUrl+"/portals/self",h={authMode:e,query:{culture:cd().toLowerCase()},withCredentials:!0,...r};return h.authMode==="auto"&&(h.authMode="no-prompt"),i&&(h.query.default=!0),this.request(o,h)}queryPortal(e,i,r,o){const h=Ds(Rr,i),d=a=>this.request(this.restUrl+e,{...h.toRequestOptions(this),...o}).then(_=>{const T=h.clone();return T.start=_.nextStart,new qh({nextQueryParams:T,queryParams:h,total:_.total,results:to._resultsToTypedArray(a,{portal:this},_,o)})}).then(_=>Promise.all(_.results.map(T=>typeof T.when=="function"?T.when():_)).then(()=>_,T=>(PQ(T),_)));return r&&Cz[r]?Cz[r]().then(({default:a})=>(w0(o),d(a))):d()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new Ot("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===to.AUTH_MODE_ANONYMOUS||this.authMode===to.AUTH_MODE_NO_PROMPT&&!Ni)return Promise.reject(new Ot("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=i=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(i||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=i,this.fetchSelf("immediate"))):this.user&&this.credential===i?null:(this.credential=i,this.fetchSelf("immediate"))).then(r=>{r&&(this.sourceJSON=r,this.read(r))});return Ni?Ni.getCredential(this.restUrl,{prompt:this.authMode!==to.AUTH_MODE_NO_PROMPT}).then(i=>e(i)):e(this.credential)}normalizeUrl(e){const i=this.credential?.token;return this._normalizeSSL(i?e+(e.includes("?")?"&":"?")+"token="+i:e)}requestToTypedArray(e,i,r){return this.request(e,i).then(o=>{const h=to._resultsToTypedArray(r,{portal:this},o);return Promise.all(h.map(d=>typeof d.when=="function"?d.when():o)).then(()=>h,()=>h)})}request(e,i={}){const r={f:"json",...i.query},{authMode:o=this.authMode===to.AUTH_MODE_ANONYMOUS||this.authMode===to.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:h=null,cacheBust:d=!1,method:a="auto",responseType:_="json",signal:T}=i,E={authMode:o,body:h,cacheBust:d,method:a,query:r,responseType:_,timeout:0,signal:T};return i.withCredentials&&(E.withCredentials=!0),wn(this._normalizeSSL(e),E).then(k=>k.data)}toJSON(){throw new Ot("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new to({sourceJSON:e})}_getHelperService(e){const i=this.helperServices?.[e];if(!i)throw new Ot("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return i}async _fetchBasemaps(e,i){const r=new Rr;r.query=e||(a5()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0;const o=await this.queryGroups(r,i);if(!o.total)return[];const h=o.results[0];r.num=100,r.query='type:"Web Map" -type:"Web Application"',r.sortField=h.sortField||"name",r.sortOrder=h.sortOrder||"desc";const d=await h.queryItems(r,i);return d.total?d.results.filter(a=>a.type==="Web Map").map(a=>new oy({portalItem:a})):[]}async _fetchBasemaps3D(e,i){const r=e||this.basemapGalleryGroupQuery3D;if(!r)return[];if(a5())return[];const o=new Rr({query:r,disableExtraQuery:!0}),h=await this.queryGroups(o,i);if(!h.total)return[];const d=h.results[0];o.num=100,o.query='type:"Web Scene"',o.sortField=d.sortField||"name",o.sortOrder=d.sortOrder||"desc";const a=await d.queryItems(o,i);return a.total?a.results.filter(_=>_.type==="Web Scene").map(_=>new oy({portalItem:_})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const i=oy.fromJSON(e);return i.portalItem={portal:this},i}return null}static _resultsToTypedArray(e,i,r,o){let h;if(r){const d=o!=null?o.signal:null;h=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(e||i)&&(h=h.map(a=>{const _=Object.assign(e?e.fromJSON(a):a,i);return typeof _.load=="function"&&_.load(d),_}))}else h=[];return h}},to=ul,ul.AUTH_MODE_ANONYMOUS="anonymous",ul.AUTH_MODE_AUTO="auto",ul.AUTH_MODE_IMMEDIATE="immediate",ul.AUTH_MODE_NO_PROMPT="no-prompt",ul);P([R()],tt.prototype,"access",void 0),P([R()],tt.prototype,"allSSL",void 0),P([R()],tt.prototype,"authMode",void 0),P([R()],tt.prototype,"authorizedCrossOriginDomains",void 0),P([Fr("authorizedCrossOriginDomains")],tt.prototype,"readAuthorizedCrossOriginDomains",null),P([R()],tt.prototype,"basemapGalleryGroupQuery",void 0),P([R({json:{name:"3DBasemapGalleryGroupQuery"}})],tt.prototype,"basemapGalleryGroupQuery3D",void 0),P([R({json:{name:"g3DTilesGalleryGroupQuery"}})],tt.prototype,"g3DTilesGalleryGroupQuery",void 0),P([R({json:{name:"g3dTilesEnabled"}})],tt.prototype,"g3dTilesEnabled",void 0),P([R()],tt.prototype,"bingKey",void 0),P([R()],tt.prototype,"canListApps",void 0),P([R()],tt.prototype,"canListData",void 0),P([R()],tt.prototype,"canListPreProvisionedItems",void 0),P([R()],tt.prototype,"canProvisionDirectPurchase",void 0),P([R()],tt.prototype,"canSearchPublic",void 0),P([R()],tt.prototype,"canShareBingPublic",void 0),P([R()],tt.prototype,"canSharePublic",void 0),P([R()],tt.prototype,"canSignInArcGIS",void 0),P([R()],tt.prototype,"canSignInIDP",void 0),P([R()],tt.prototype,"colorSetsGroupQuery",void 0),P([R()],tt.prototype,"commentsEnabled",void 0),P([R({type:Date})],tt.prototype,"created",void 0),P([R()],tt.prototype,"credential",void 0),P([R()],tt.prototype,"culture",void 0),P([R()],tt.prototype,"currentVersion",void 0),P([R()],tt.prototype,"customBaseUrl",void 0),P([R()],tt.prototype,"default3DBasemapQuery",void 0),P([R()],tt.prototype,"defaultBasemap",void 0),P([Fr("defaultBasemap")],tt.prototype,"readDefaultBasemap",null),P([R()],tt.prototype,"defaultDevBasemap",void 0),P([Fr("defaultDevBasemap")],tt.prototype,"readDefaultDevBasemap",null),P([R({type:_i})],tt.prototype,"defaultExtent",void 0),P([R()],tt.prototype,"defaultVectorBasemap",void 0),P([Fr("defaultVectorBasemap")],tt.prototype,"readDefaultVectorBasemap",null),P([R()],tt.prototype,"description",void 0),P([R()],tt.prototype,"devBasemapGalleryGroupQuery",void 0),P([R()],tt.prototype,"eueiEnabled",void 0),P([R({readOnly:!0})],tt.prototype,"extraQuery",null),P([R()],tt.prototype,"featuredGroups",void 0),P([R()],tt.prototype,"featuredItemsGroupQuery",void 0),P([R()],tt.prototype,"galleryTemplatesGroupQuery",void 0),P([R()],tt.prototype,"layoutGroupQuery",void 0),P([R()],tt.prototype,"livingAtlasGroupQuery",void 0),P([R({readOnly:!0})],tt.prototype,"hasAPIKey",null),P([R()],tt.prototype,"hasCategorySchema",void 0),P([R()],tt.prototype,"hasClassificationSchema",void 0),P([R()],tt.prototype,"helpBase",void 0),P([R()],tt.prototype,"helperServices",void 0),P([R()],tt.prototype,"helpMap",void 0),P([R()],tt.prototype,"homePageFeaturedContent",void 0),P([R()],tt.prototype,"homePageFeaturedContentCount",void 0),P([R()],tt.prototype,"httpPort",void 0),P([R()],tt.prototype,"httpsPort",void 0),P([R()],tt.prototype,"id",void 0),P([R()],tt.prototype,"ipCntryCode",void 0),P([R({readOnly:!0})],tt.prototype,"isOrganization",null),P([R()],tt.prototype,"isPortal",void 0),P([R()],tt.prototype,"isReadOnly",void 0),P([R({readOnly:!0})],tt.prototype,"itemPageUrl",null),P([R()],tt.prototype,"layerTemplatesGroupQuery",void 0),P([R()],tt.prototype,"maxTokenExpirationMinutes",void 0),P([R({type:Date})],tt.prototype,"modified",void 0),P([R()],tt.prototype,"name",void 0),P([R()],tt.prototype,"portalHostname",void 0),P([R()],tt.prototype,"portalMode",void 0),P([R()],tt.prototype,"portalProperties",void 0),P([R()],tt.prototype,"region",void 0),P([R()],tt.prototype,"recycleBinEnabled",void 0),P([R({readOnly:!0})],tt.prototype,"restUrl",null),P([R()],tt.prototype,"rotatorPanels",void 0),P([R()],tt.prototype,"showHomePageDescription",void 0),P([R()],tt.prototype,"sourceJSON",void 0),P([R()],tt.prototype,"staticImagesUrl",void 0),P([R({json:{name:"2DStylesGroupQuery"}})],tt.prototype,"stylesGroupQuery2d",void 0),P([R({json:{name:"stylesGroupQuery"}})],tt.prototype,"stylesGroupQuery3d",void 0),P([R()],tt.prototype,"supportsHostedServices",void 0),P([R()],tt.prototype,"symbolSetsGroupQuery",void 0),P([R()],tt.prototype,"templatesGroupQuery",void 0),P([R()],tt.prototype,"thumbnail",void 0),P([R({readOnly:!0})],tt.prototype,"thumbnailUrl",null),P([R()],tt.prototype,"units",void 0),P([R()],tt.prototype,"url",void 0),P([R()],tt.prototype,"urlKey",void 0),P([Fr("urlKey")],tt.prototype,"readUrlKey",null),P([R()],tt.prototype,"user",void 0),P([Fr("user")],tt.prototype,"readUser",null),P([R()],tt.prototype,"use3dBasemaps",void 0),P([R()],tt.prototype,"useDefault3dBasemap",void 0),P([R()],tt.prototype,"useStandardizedQuery",void 0),P([R()],tt.prototype,"useVectorBasemaps",void 0),P([R()],tt.prototype,"vectorBasemapGalleryGroupQuery",void 0),tt=to=P([Ge("esri.portal.Portal")],tt);const Ez=new FinalizationRegistry(t=>{t.remove()});function oue(t){const e=Ni;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch(()=>{})}}let ds=class extends Lt{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,i,r){e||(i[r]=e)}};P([R({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],ds.prototype,"enabled",void 0),P([Bi("enabled")],ds.prototype,"writeEnabled",null),P([R({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],ds.prototype,"type",void 0),ds=P([Ge("esri.symbols.Symbol3DLayer")],ds);const aue=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,lue="screenUtils.toPt: input not recognized!",jB=96;function Gye(t){return t?t/72*jB:0}function Pd(t){return t?72*t/jB:0}function sr(t){if(typeof t=="string"){const e=t.match(aue);if(e){const i=Number(e[1]),r=e[3]&&e[3].toLowerCase(),o=t.startsWith("-"),h=r==="px"?Pd(i):i;return o?-h:h}return console.warn(lue),null}return t}function qye(t=0,e=0){return{x:t,y:e}}function Hye(t=0,e=0){return[t,e]}function Zye(t=0,e=0,i=0){return[t,e,i]}function cue(t){const e=wP(100*(1-t));return Math.max(0,Math.min(e,100))}function uue(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}function hue(t,e){const i=e.transparency!=null?uue(e.transparency):1,r=e.color;return r&&Array.isArray(r)?new or([r[0]||0,r[1]||0,r[2]||0,i]):null}function due(t,e){e.color=t.toJSON().slice(0,3);const i=cue(t.a);i!==0&&(e.transparency=i)}function Wu(t){return{type:or,nonNullable:t?.nonNullable,json:{type:[Er],default:null,read:{source:["color","transparency"],reader:hue},write:{target:{color:{type:[Er],isRequired:t?.colorRequiredOnWrite},transparency:{type:Er}},writer:due}}}}const bl={type:Number,cast:sr,json:{write:!0}};let Hh=class extends Lt{constructor(e){super(e),this.color=new or([0,0,0,1]),this.extensionLength=0,this.size=Pd(1)}clone(){}cloneProperties(){return{color:dt(this.color),size:this.size,extensionLength:this.extensionLength}}};P([R({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Hh.prototype,"type",void 0),P([R(Wu({colorRequiredOnWrite:!0}))],Hh.prototype,"color",void 0),P([R({...bl,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],Hh.prototype,"extensionLength",void 0),P([R(bl)],Hh.prototype,"size",void 0),Hh=P([Ge("esri.symbols.edges.Edges3D")],Hh);const HP=Hh;var nI;let Yb=nI=class extends HP{constructor(t){super(t),this.type="sketch"}clone(){return new nI(this.cloneProperties())}};P([mi({sketch:"sketch"},{readOnly:!0})],Yb.prototype,"type",void 0),Yb=nI=P([Ge("esri.symbols.edges.SketchEdges3D")],Yb);const pue=Yb;var sI;let Xb=sI=class extends HP{constructor(t){super(t),this.type="solid"}clone(){return new sI(this.cloneProperties())}};P([mi({solid:"solid"},{readOnly:!0})],Xb.prototype,"type",void 0),Xb=sI=P([Ge("esri.symbols.edges.SolidEdges3D")],Xb);const fue=Xb,UB={types:{key:"type",base:HP,typeMap:{solid:fue,sketch:pue}},json:{write:!0}};var oI;let bf=oI=class extends Lt{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new oI(t)}};P([R({json:{write:!1}})],bf.prototype,"strength",void 0),P([R({json:{write:!1}})],bf.prototype,"source",void 0),bf=oI=P([Ge("esri.symbols.support.Symbol3DEmissive")],bf);var aI;let co=aI=class extends Lt{constructor(t){super(t),this.color=null,this.emissive=new bf({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new aI(t)}};P([R(Wu())],co.prototype,"color",void 0),P([R({type:bf,json:{write:!1}})],co.prototype,"emissive",void 0),co=aI=P([Ge("esri.symbols.support.Symbol3DMaterial")],co);var lI,Nf;let rc=(Nf=class extends ds{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new lI({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},lI=Nf,Nf);P([mi({Extrude:"extrude"},{readOnly:!0})],rc.prototype,"type",void 0),P([R({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],rc.prototype,"size",void 0),P([R({type:co,json:{write:!0}})],rc.prototype,"material",void 0),P([R({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],rc.prototype,"castShadows",void 0),P([R(UB)],rc.prototype,"edges",void 0),rc=lI=P([Ge("esri.symbols.ExtrudeSymbol3DLayer")],rc);let Xy=class extends Lt{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};P([R({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Xy.prototype,"type",void 0),Xy=P([Ge("esri.symbols.patterns.LinePattern3D")],Xy);const mue=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var cI;const gue=yo()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let id=cI=class extends Xy{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new cI(t)}};P([R({type:["style"],json:{write:{isRequired:!0}}})],id.prototype,"type",void 0),P([mi(gue),R({type:mue,json:{write:{isRequired:!0}}})],id.prototype,"style",void 0),id=cI=P([Ge("esri.symbols.patterns.LineStylePattern3D")],id);let Jy=class extends Lt{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};P([R({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Jy.prototype,"type",void 0),Jy=P([Ge("esri.symbols.patterns.Pattern3D")],Jy);const yue=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var uI;let xf=uI=class extends Jy{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new uI({style:this.style})}};P([R({type:["style"],json:{write:{isRequired:!0}}})],xf.prototype,"type",void 0),P([R({type:yue,json:{read:!0,write:{isRequired:!0}}})],xf.prototype,"style",void 0),xf=uI=P([Ge("esri.symbols.patterns.StylePattern3D")],xf);const _ue={types:{key:"type",base:Jy,typeMap:{style:xf}},json:{write:!0}},VB={types:{key:"type",base:Xy,typeMap:{style:id}},json:{write:!0}},Ky=new or("white"),vue=new or([255,255,255,0]);function bue(t){return t.r===0&&t.g===0&&t.b===0}var hI;let Qy=hI=class extends co{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new hI(t)}};P([mi({multiply:"multiply",replace:"replace",tint:"tint"})],Qy.prototype,"colorMixMode",void 0),Qy=hI=P([Ge("esri.symbols.support.Symbol3DFillMaterial")],Qy);function ZP(){return[0,0,0]}function xue(t){return[t[0],t[1],t[2]]}function zm(t,e,i){return[t,e,i]}function wue(t,e,i){return[t,e,i]}function Sue(t,e=ZP()){const i=Math.min(3,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function GB(){return ZP()}function qB(){return zm(1,1,1)}function HB(){return zm(1,0,0)}function ZB(){return zm(0,1,0)}function WB(){return zm(0,0,1)}const Tue=GB(),Cue=qB(),Eue=HB(),Iue=ZB(),$ue=WB();Object.freeze(Object.defineProperty({__proto__:null,ONES:Cue,UNIT_X:Eue,UNIT_Y:Iue,UNIT_Z:$ue,ZEROS:Tue,clone:xue,create:ZP,freeze:wue,fromArray:Sue,fromValues:zm,ones:qB,unitX:HB,unitY:ZB,unitZ:WB,zeros:GB},Symbol.toStringTag,{value:"Module"}));function WP(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Pue(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function Mue(t,e,i,r,o,h,d,a,_,T,E,k,L,O,H,re){return[t,e,i,r,o,h,d,a,_,T,E,k,L,O,H,re]}const kue=WP();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:kue,clone:Pue,create:WP,fromValues:Mue},Symbol.toStringTag,{value:"Module"}));function Aue(t){return t<=AL?new Array(t).fill(0):new Float64Array(t)}function Jye(t){return(QK(t)?t.byteLength/8:t.length)<=AL?Array.from(t):new Float64Array(t)}function Kye(t,e,i){return Array.isArray(t)?t.slice(e,e+i):t.subarray(e,e+i)}function Qye(t){return[...t]}function e0e(t){const e=WP();for(let i=0;i<16;++i)e[i]=t[i];return e}function m_(t=Fue){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function YP(t,e,i,r,o,h,d=m_()){return d[0]=t,d[1]=e,d[2]=i,d[3]=r,d[4]=o,d[5]=h,d}function t0e(t,e=m_()){return Due(t,0,t.length/3,e)}function Due(t,e,i,r=m_()){return YB(r,dI),zue(r,t,e,i),r}function i0e(t,e=Aue(24)){const[i,r,o,h,d,a]=t;return e[0]=i,e[1]=r,e[2]=o,e[3]=i,e[4]=r,e[5]=a,e[6]=i,e[7]=d,e[8]=o,e[9]=i,e[10]=d,e[11]=a,e[12]=h,e[13]=r,e[14]=o,e[15]=h,e[16]=r,e[17]=a,e[18]=h,e[19]=d,e[20]=o,e[21]=h,e[22]=d,e[23]=a,e}function r0e(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new _i(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function n0e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function s0e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function o0e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function zue(t,e,i=0,r=e.length/3){let o=t[0],h=t[1],d=t[2],a=t[3],_=t[4],T=t[5];for(let E=0;E<r;E++)o=Math.min(o,e[i+3*E]),h=Math.min(h,e[i+3*E+1]),d=Math.min(d,e[i+3*E+2]),a=Math.max(a,e[i+3*E]),_=Math.max(_,e[i+3*E+1]),T=Math.max(T,e[i+3*E+2]);t[0]=o,t[1]=h,t[2]=d,t[3]=a,t[4]=_,t[5]=T}function Oue(t){return t[0]>=t[3]?0:t[3]-t[0]}function Rue(t){return t[1]>=t[4]?0:t[4]-t[1]}function Lue(t){return t[2]>=t[5]?0:t[5]-t[2]}function a0e(t,e=[0,0,0]){return e[0]=Oue(t),e[1]=Rue(t),e[2]=Lue(t),e}function l0e(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function c0e(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function YB(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function u0e(t){return t?YB(t,dI):m_(dI)}function h0e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function d0e(t,e,i,r,o){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=r,t[4]=o,t[5]=Number.POSITIVE_INFINITY,t}function Iz(t){return t.length===6}function p0e(t,e,i){if(t==null||e==null)return t===e;if(!Iz(t)||!Iz(e))return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const dI=[1/0,1/0,1/0,-1/0,-1/0,-1/0],Fue=[0,0,0,0,0,0];m_();function f0e(t,{isPrimitive:e,width:i,depth:r,height:o}){const h=zm(i,r,o);let d;for(let a=0;a<3;a++){const _=h[a];if(_!=null){d=_/t[a];break}}for(let a=0;a<3;a++)h[a]==null&&(h[a]=t[a]*d);return h}const Nue=YP(-.5,-.5,-.5,.5,.5,.5),Bue=YP(-.5,-.5,0,.5,.5,1),jue=YP(-.5,-.5,0,.5,.5,.5);function m0e(t){switch(t){case"sphere":case"cube":case"diamond":return Nue;case"cylinder":case"cone":case"inverted-cone":return Bue;case"tetrahedron":return jue;default:return}}const XP=["butt","square","round"],Uue=[...XP,"none"],XB=["miter","bevel","round"];var pI;let Zh=pI=class extends Lt{constructor(t){super(t),this.color=new or([0,0,0,1]),this.size=Pd(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new pI(t)}};P([R(Wu({colorRequiredOnWrite:!0}))],Zh.prototype,"color",void 0),P([R({...bl,json:{write:{isRequired:!0}}})],Zh.prototype,"size",void 0),P([R(VB)],Zh.prototype,"pattern",void 0),P([R({type:XP,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Zh.prototype,"patternCap",void 0),Zh=pI=P([Ge("esri.symbols.support.Symbol3DOutline")],Zh);var Jb,Bf;let oo=(Bf=class extends ds{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new Jb(e)}static fromSimpleFillSymbol(e){const i=e.outline&&e.outline.style&&e.outline.style!=="solid"?new id({style:e.outline.style}):null,r={size:e.outline?.width??0,color:(e.outline?.color??Ky).clone(),pattern:i};return i&&e.outline?.cap&&(r.patternCap=e.outline.cap),new Jb({material:new Qy({color:(e.color??vue).clone()}),pattern:e.style&&e.style!=="solid"?new xf({style:e.style}):null,outline:r})}},Jb=Bf,Bf);P([mi({Fill:"fill"},{readOnly:!0})],oo.prototype,"type",void 0),P([R({type:Qy,json:{write:!0}})],oo.prototype,"material",void 0),P([R(_ue)],oo.prototype,"pattern",void 0),P([R({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],oo.prototype,"castShadows",void 0),P([R({type:Zh,json:{write:!0}})],oo.prototype,"outline",void 0),P([R(UB)],oo.prototype,"edges",void 0),oo=Jb=P([Ge("esri.symbols.FillSymbol3DLayer")],oo);var fI;const Vue=yo()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Wh=fI=class extends Lt{constructor(t){super(t)}readHref(t,e,i){return t?a_(t,i):e.dataURI}writeHref(t,e,i,r){t&&(km(t)?e.dataURI=t:(e.href=Iw(t,r),wa(e.href)&&(e.href=Fu(e.href))))}clone(){return new fI({href:this.href,primitive:this.primitive})}equals(t){return t.primitive===this.primitive&&t.href===this.href}};P([R({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Wh.prototype,"href",void 0),P([Fr("href")],Wh.prototype,"readHref",null),P([Bi("href",{href:{type:String},dataURI:{type:String}})],Wh.prototype,"writeHref",null),P([mi(Vue)],Wh.prototype,"primitive",void 0),Wh=fI=P([Ge("esri.symbols.support.IconSymbol3DLayerResource")],Wh);const g0e="circle";let Kb=class extends ms(Lt){constructor(e){super(e),this.mode="hidden"}equals(e){return this.mode===e.mode}};P([R({type:["adaptive","hidden","visible"],json:{write:{isRequired:!0}}})],Kb.prototype,"mode",void 0),Kb=P([Ge("esri.symbols.support.OccludedVisibility")],Kb);const JB=Kb;var mI;let wf=mI=class extends Ln{constructor(t){super(t),this.x=0,this.y=0}clone(){return new mI({x:this.x,y:this.y})}equals(t){return t.x===this.x&&t.y===this.y}};P([R({type:Number})],wf.prototype,"x",void 0),P([R({type:Number})],wf.prototype,"y",void 0),wf=mI=P([Ge("esri.symbols.support.Symbol3DAnchorPosition2D")],wf);var gI;let ky=gI=class extends Lt{constructor(t){super(t),this.color=new or([0,0,0,1]),this.size=Pd(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new gI(t)}equals(t){return t.size===this.size&&(this.color==null?t.color==null:this.color.equals(t.color))}};P([R(Wu({colorRequiredOnWrite:!0}))],ky.prototype,"color",void 0),P([R({...bl,json:{write:{isRequired:!0}}})],ky.prototype,"size",void 0),ky=gI=P([Ge("esri.symbols.support.Symbol3DIconOutline")],ky);var cf,jf;let bn=(jf=class extends ds{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0,this.occludedVisibility=null}clone(){return new cf({anchor:this.anchor,anchorPosition:dt(this.anchorPosition),enabled:this.enabled,material:dt(this.material),outline:dt(this.outline),resource:dt(this.resource),angle:this.angle,size:this.size,occludedVisibility:dt(this.occludedVisibility)})}static fromSimpleMarkerSymbol(e){const i=e.color||Ky,r=$z(e),o=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||Ky).clone()}:null;return new cf({size:e.size,angle:e.angle,resource:{primitive:que(()=>ui.getLogger(this.prototype),e.style)},material:{color:i},outline:o,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(e){const i=!e.color||bue(e.color)?Ky:e.color,r=$z(e);return new cf({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:i.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(e){return new cf({resource:{href:U6({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},cf=jf,jf);function $z(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,r=Pz(t.xoffset),o=Pz(t.yoffset);return(r||o)&&e&&i?{x:-r/e,y:o/i}:null}function Pz(t){return isFinite(t)?t:0}P([R({type:co,json:{write:!0}})],bn.prototype,"material",void 0),P([R({type:Wh,json:{write:!0}})],bn.prototype,"resource",void 0),P([mi({Icon:"icon"},{readOnly:!0})],bn.prototype,"type",void 0),P([R({...bl,json:{write:{isRequired:!0}}})],bn.prototype,"size",void 0),P([mi({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],bn.prototype,"anchor",void 0),P([R({type:wf,json:{type:[Number],read:{reader:t=>new wf({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],bn.prototype,"anchorPosition",void 0),P([R({type:ky,json:{write:!0}})],bn.prototype,"outline",void 0),P([R({type:Number,json:{write:!0,default:0}})],bn.prototype,"angle",void 0),P([R({type:JB})],bn.prototype,"occludedVisibility",void 0),bn=cf=P([Ge("esri.symbols.IconSymbol3DLayer")],bn);const Gue={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function que(t,e){return Gue[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const Hue=["begin","end","begin-end"],KB=["arrow","circle","square","diamond","cross","x"];let cc=class extends ms(Lt){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};P([R({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],cc.prototype,"type",void 0),P([R({type:Hue,json:{default:"begin-end",write:!0}})],cc.prototype,"placement",void 0),P([R({type:KB,json:{default:"arrow",write:!0}})],cc.prototype,"style",void 0),P([R({type:or,json:{type:[Er],default:null,write:!0}})],cc.prototype,"color",void 0),cc=P([Ge("esri.symbols.LineStyleMarker3D")],cc);var Qb,Uf;let Ts=(Uf=class extends ds{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Pd(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new Qb(e)}static fromSimpleLineSymbol(e){const i={enabled:!0,size:e.width??Pd(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new id({style:e.style}):null,material:new co({color:(e.color||Ky).clone()}),marker:e.marker?new cc({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new Qb(i)}},Qb=Uf,Uf);P([R({type:co,json:{write:!0}})],Ts.prototype,"material",void 0),P([mi({Line:"line"},{readOnly:!0})],Ts.prototype,"type",void 0),P([R({type:XB,json:{write:!0,default:"miter"}})],Ts.prototype,"join",void 0),P([R({type:XP,json:{write:!0,default:"butt"}})],Ts.prototype,"cap",void 0),P([R({...bl,json:{write:{isRequired:!0}}})],Ts.prototype,"size",void 0),P([R(VB)],Ts.prototype,"pattern",void 0),P([R({types:{key:"type",base:cc,typeMap:{style:cc}},json:{write:!0}})],Ts.prototype,"marker",void 0),Ts=Qb=P([Ge("esri.symbols.LineSymbol3DLayer")],Ts);var yI;const Zue=yo()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let Ay=yI=class extends Lt{clone(){return new yI({href:this.href,primitive:this.primitive})}};P([R({type:String,json:{read:yP,write:hm}})],Ay.prototype,"href",void 0),P([mi(Zue)],Ay.prototype,"primitive",void 0),Ay=yI=P([Ge("esri.symbols.support.ObjectSymbol3DLayerResource")],Ay);const v0e="sphere";var _I;let Kh=_I=class extends Ln{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new _I({x:this.x,y:this.y,z:this.z})}};P([R({type:Number})],Kh.prototype,"x",void 0),P([R({type:Number})],Kh.prototype,"y",void 0),P([R({type:Number})],Kh.prototype,"z",void 0),Kh=_I=P([Ge("esri.symbols.support.Symbol3DAnchorPosition3D")],Kh);var vI,Vf;let vn=(Vf=class extends ds{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new vI({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},vI=Vf,Vf);P([R({type:co,json:{write:!0}})],vn.prototype,"material",void 0),P([R({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],vn.prototype,"castShadows",void 0),P([R({type:Ay,json:{write:!0}})],vn.prototype,"resource",void 0),P([mi({Object:"object"},{readOnly:!0})],vn.prototype,"type",void 0),P([R({type:Number,json:{write:!0}})],vn.prototype,"width",void 0),P([R({type:Number,json:{write:!0}})],vn.prototype,"height",void 0),P([R({type:Number,json:{write:!0}})],vn.prototype,"depth",void 0),P([mi({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],vn.prototype,"anchor",void 0),P([R({type:Kh,json:{type:[Number],read:{reader:t=>new Kh({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],vn.prototype,"anchorPosition",void 0),P([R({type:Number,json:{write:!0}})],vn.prototype,"heading",void 0),P([R({type:Number,json:{write:!0}})],vn.prototype,"tilt",void 0),P([R({type:Number,json:{write:!0}})],vn.prototype,"roll",void 0),P([R({readOnly:!0})],vn.prototype,"isPrimitive",null),vn=vI=P([Ge("esri.symbols.ObjectSymbol3DLayer")],vn);var bI,Gf;let On=(Gf=class extends ds{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,i){return e??(i.height==null&&i.size!=null?i.size:void 0)}readHeight(e,i){return e??(i.width==null&&i.size!=null?i.size:void 0)}clone(){return new bI({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},bI=Gf,Gf);P([R({type:co,json:{write:!0}})],On.prototype,"material",void 0),P([R({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],On.prototype,"castShadows",void 0),P([mi({Path:"path"},{readOnly:!0})],On.prototype,"type",void 0),P([R({type:["circle","quad"],nonNullable:!0,json:{write:!0,default:"circle"}})],On.prototype,"profile",void 0),P([R({type:XB,nonNullable:!0,json:{write:!0,default:"miter"}})],On.prototype,"join",void 0),P([R({type:Uue,nonNullable:!0,json:{write:!0,default:"butt"}})],On.prototype,"cap",void 0),P([R({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],On.prototype,"width",void 0),P([Fr("width",["width","size","height"])],On.prototype,"readWidth",null),P([R({type:Number,json:{write:!0}})],On.prototype,"height",void 0),P([Fr("height",["height","size","width"])],On.prototype,"readHeight",null),P([R({type:["center","bottom","top"],nonNullable:!0,json:{write:!0,default:"center"}})],On.prototype,"anchor",void 0),P([R({type:["heading","all"],nonNullable:!0,json:{write:!0,default:"all"}})],On.prototype,"profileRotation",void 0),On=bI=P([Ge("esri.symbols.PathSymbol3DLayer")],On);const Wue=["none","underline","line-through"],Yue=["normal","italic","oblique"],Xue=["normal","lighter","bold","bolder"],QB={type:Number,cast:t=>{const e=kw(t);return e===0?1:u_(e,.1,4)},nonNullable:!0},Jue=["left","right","center"],Kue=["baseline","top","middle","bottom"],e8={type:Jue,nonNullable:!0},t8={type:Kue,nonNullable:!0};var xI;let Ro=xI=class extends Lt{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return sr(t)}clone(){return new xI({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};P([R({type:Wue,json:{default:"none",write:!0}})],Ro.prototype,"decoration",void 0),P([R({type:String,json:{write:!0}})],Ro.prototype,"family",void 0),P([R({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],Ro.prototype,"size",void 0),P([l_("size")],Ro.prototype,"castSize",null),P([R({type:Yue,json:{default:"normal",write:!0}})],Ro.prototype,"style",void 0),P([R({type:Xue,json:{default:"normal",write:!0}})],Ro.prototype,"weight",void 0),Ro=xI=P([Ge("esri.symbols.Font")],Ro);var wI;let Sf=wI=class extends Lt{constructor(){super(...arguments),this.color=new or([0,0,0,1]),this.size=0}clone(){const t={color:dt(this.color),size:this.size};return new wI(t)}};P([R(Wu())],Sf.prototype,"color",void 0),P([R(bl)],Sf.prototype,"size",void 0),Sf=wI=P([Ge("esri.symbols.support.Symbol3DHalo")],Sf);let e0=class extends ms(Lt){constructor(e){super(e),this.color=null}};P([R(Wu())],e0.prototype,"color",void 0),e0=P([Ge("esri.symbols.support.Symbol3DTextBackground")],e0);var ex,qf;let Jr=(qf=class extends ds{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline",this.occludedVisibility=null}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,i,r,o){const h={...o,textSymbol3D:!0};i.font=e.write({},h),delete i.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new ex({enabled:this.enabled,font:dt(this.font),halo:dt(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:dt(this.background),occludedVisibility:dt(this.occludedVisibility)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new ex({font:e.font!=null?e.font.clone():new Ro,halo:Que(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new co({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new e0({color:e.backgroundColor.clone()}):null})}},ex=qf,qf);function Que(t,e){return t&&e!=null&&e>0?new Sf({color:dt(t),size:e}):null}P([R({type:Ro,json:{write:!0}})],Jr.prototype,"font",null),P([Bi("font")],Jr.prototype,"writeFont",null),P([R({type:Sf,json:{write:!0}})],Jr.prototype,"halo",void 0),P([R({...e8,json:{default:"center",write:!0}})],Jr.prototype,"horizontalAlignment",void 0),P([R({...QB,json:{default:1,write:!0}})],Jr.prototype,"lineHeight",void 0),P([R({type:co,json:{write:!0}})],Jr.prototype,"material",void 0),P([R({type:e0,json:{write:!0}})],Jr.prototype,"background",void 0),P([R(bl)],Jr.prototype,"size",null),P([R({type:String,json:{write:!0}})],Jr.prototype,"text",void 0),P([mi({Text:"text"},{readOnly:!0})],Jr.prototype,"type",void 0),P([R({...t8,json:{default:"baseline",write:!0}})],Jr.prototype,"verticalAlignment",void 0),P([R({type:JB})],Jr.prototype,"occludedVisibility",void 0),Jr=ex=P([Ge("esri.symbols.TextSymbol3DLayer")],Jr);var SI,Hf;let nc=(Hf=class extends ds{constructor(e){super(e),this.color=TI.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new SI({color:this.color.clone(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},SI=Hf,Hf);P([R({type:or,nonNullable:!0,json:{type:[Er],write:(t,e,i)=>e[i]=t.toArray(1),default:()=>TI.clone(),defaultEquals:t=>t.toCss(!0)===TI.toCss(!0)}})],nc.prototype,"color",void 0),P([mi({Water:"water"},{readOnly:!0})],nc.prototype,"type",void 0),P([R({type:["small","medium","large"],json:{write:!0,default:"medium"}})],nc.prototype,"waterbodySize",void 0),P([R({type:Number,json:{write:!0,default:null}})],nc.prototype,"waveDirection",void 0),P([R({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],nc.prototype,"waveStrength",void 0),nc=SI=P([Ge("esri.symbols.WaterSymbol3DLayer")],nc);const TI=new or([0,119,190]);var CI;let uc=CI=class extends Ln{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new CI({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};P([R({type:String})],uc.prototype,"name",void 0),P([R({type:String})],uc.prototype,"styleUrl",void 0),P([R({type:String})],uc.prototype,"styleName",void 0),P([R({type:tt})],uc.prototype,"portal",void 0),uc=CI=P([Ge("esri.symbols.support.StyleOrigin")],uc);var EI;let t0=EI=class extends Ln{constructor(){super(...arguments),this.url=""}clone(){return new EI({url:this.url})}};P([R({type:String})],t0.prototype,"url",void 0),t0=EI=P([Ge("esri.symbols.support.Thumbnail")],t0);const i8={icon:bn,object:vn,line:Ts,path:On,fill:oo,extrude:rc,text:Jr,water:nc},ehe=nr.ofType({base:ds,key:"type",typeMap:i8,errorContext:"symbol-layer"});let Cs=class extends Nr{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=i?.type,o=r||nr;this._set("symbolLayers",new o)}get color(){return null}set color(e){this.constructed&&ui.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Wce(e,this._get("symbolLayers"))}readStyleOrigin(e,i,r){if(e.styleUrl&&e.name){const o=a_(e.styleUrl,r);return new uc({styleUrl:o,name:e.name})}if(e.styleName&&e.name)return new uc({portal:r?.portal||tt.getDefault(),styleName:e.styleName,name:e.name});r?.messages&&r.messages.push(new $0("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,i,r,o){if(e.styleUrl&&e.name){let h=Iw(e.styleUrl,o);wa(h)&&(h=Fu(h)),i.styleOrigin={styleUrl:h,name:e.name}}else e.styleName&&e.name&&(e.portal&&o?.portal&&!Nie(e.portal.restUrl,o.portal.restUrl)?o?.messages&&o.messages.push(new $0("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof ds||e&&i8[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};P([R({json:{read:!1,write:!1}})],Cs.prototype,"color",null),P([R({type:ehe,nonNullable:!0,json:{write:!0}}),l_(Yce)],Cs.prototype,"symbolLayers",null),P([R({type:uc})],Cs.prototype,"styleOrigin",void 0),P([Fr("styleOrigin")],Cs.prototype,"readStyleOrigin",null),P([Bi("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Cs.prototype,"writeStyleOrigin",null),P([R({type:t0,json:{read:!1}})],Cs.prototype,"thumbnail",void 0),P([R({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Cs.prototype,"type",void 0),Cs=P([Ge("esri.symbols.Symbol3D")],Cs);let Tf=class extends Lt{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};P([R({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],Tf.prototype,"type",void 0),P([R({readOnly:!0})],Tf.prototype,"visible",void 0),Tf=P([Ge("esri.symbols.callouts.Callout3D")],Tf);var II;let tx=II=class extends Lt{constructor(t){super(t),this.color=new or("white")}clone(){return new II({color:dt(this.color)})}};P([R(Wu({colorRequiredOnWrite:!0}))],tx.prototype,"color",void 0),tx=II=P([Ge("esri.symbols.callouts.LineCallout3DBorder")],tx);const the=tx;var $I;let sc=$I=class extends Tf{constructor(t){super(t),this.type="line",this.color=new or([0,0,0,1]),this.size=Pd(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new $I({color:dt(this.color),size:this.size,border:dt(this.border)})}};P([mi({line:"line"})],sc.prototype,"type",void 0),P([R(Wu({colorRequiredOnWrite:!0}))],sc.prototype,"color",void 0),P([R({...bl,json:{write:{isRequired:!0}}})],sc.prototype,"size",void 0),P([R({type:the,json:{write:!0}})],sc.prototype,"border",void 0),P([R({readOnly:!0})],sc.prototype,"visible",null),sc=$I=P([Ge("esri.symbols.callouts.LineCallout3D")],sc);function JP(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function r8(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!JP(t)}const n8={types:{key:"type",base:Tf,typeMap:{line:sc}},json:{write:!0}};var PI;let Eu=PI=class extends Lt{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new PI({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};P([R({...bl,json:{write:{isRequired:!0}}})],Eu.prototype,"screenLength",void 0),P([R({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Eu.prototype,"minWorldLength",void 0),P([R({type:Number,json:{write:!0}})],Eu.prototype,"maxWorldLength",void 0),Eu=PI=P([Ge("esri.symbols.support.Symbol3DVerticalOffset")],Eu);var ix;const s8=nr.ofType({base:null,key:"type",typeMap:{text:Jr}});let nl=ix=class extends Cs{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new s8,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return r8(this)}hasVisibleVerticalOffset(){return JP(this)}clone(){return new ix({styleOrigin:dt(this.styleOrigin),symbolLayers:dt(this.symbolLayers),thumbnail:dt(this.thumbnail),callout:dt(this.callout),verticalOffset:dt(this.verticalOffset)})}static fromTextSymbol(t){return new ix({symbolLayers:new nr([Jr.fromTextSymbol(t)])})}};P([R({type:Eu,json:{write:!0}})],nl.prototype,"verticalOffset",void 0),P([R(n8)],nl.prototype,"callout",void 0),P([R({json:{read:!1,write:!1}})],nl.prototype,"styleOrigin",void 0),P([R({type:s8})],nl.prototype,"symbolLayers",void 0),P([mi({LabelSymbol3D:"label-3d"},{readOnly:!0})],nl.prototype,"type",void 0),nl=ix=P([Ge("esri.symbols.LabelSymbol3D")],nl);var rx;const o8=nr.ofType({base:null,key:"type",typeMap:{line:Ts,path:On}}),ihe=nr.ofType({base:null,key:"type",typeMap:{line:Ts,path:On}});let Du=rx=class extends Cs{constructor(t){super(t),this.symbolLayers=new o8,this.type="line-3d"}clone(){return new rx({styleOrigin:dt(this.styleOrigin),symbolLayers:dt(this.symbolLayers),thumbnail:dt(this.thumbnail)})}static fromSimpleLineSymbol(t){return new rx({symbolLayers:new nr([Ts.fromSimpleLineSymbol(t)])})}};P([R({type:o8,json:{type:ihe}})],Du.prototype,"symbolLayers",void 0),P([mi({LineSymbol3D:"line-3d"},{readOnly:!0})],Du.prototype,"type",void 0),Du=rx=P([Ge("esri.symbols.LineSymbol3D")],Du);var nx;const a8=nr.ofType({base:null,key:"type",typeMap:{fill:oo}});let rd=nx=class extends Cs{constructor(t){super(t),this.symbolLayers=new a8,this.type="mesh-3d"}clone(){return new nx({styleOrigin:dt(this.styleOrigin),symbolLayers:dt(this.symbolLayers),thumbnail:dt(this.thumbnail)})}static fromSimpleFillSymbol(t){return new nx({symbolLayers:new nr([oo.fromSimpleFillSymbol(t)])})}};P([R({type:a8})],rd.prototype,"symbolLayers",void 0),P([mi({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],rd.prototype,"type",void 0),rd=nx=P([Ge("esri.symbols.MeshSymbol3D")],rd);let Dy=class extends Nr{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};P([mi({esriSLS:"simple-line"},{readOnly:!0})],Dy.prototype,"type",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],Dy.prototype,"width",void 0),Dy=P([Ge("esri.symbols.LineSymbol")],Dy);var MI;let il=MI=class extends Lt{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,r){e[i]=r?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,r){r?.origin==="web-map"||(e[i]=t)}clone(){return new MI({color:dt(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};P([R({type:["begin","end","begin-end"],json:{write:!0}})],il.prototype,"placement",void 0),P([mi({"line-marker":"line-marker"},{readOnly:!0}),R({json:{origins:{"web-map":{write:!1}}}})],il.prototype,"type",void 0),P([R({type:KB})],il.prototype,"style",void 0),P([Bi("style")],il.prototype,"writeStyle",null),P([R({type:or,value:null,json:{write:{allowNull:!0}}})],il.prototype,"color",null),P([Fr("color")],il.prototype,"readColor",null),P([Bi("color")],il.prototype,"writeColor",null),il=MI=P([Ge("esri.symbols.LineSymbolMarker")],il);const rhe=il;var kI;const zT=new vl({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Wn=kI=class extends Dy{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,r,o,h){if(t&&typeof t!="string")return t;const d={};return t!=null&&(d.style=t),e!=null&&(d.color=e),i!=null&&(d.width=sr(i)),r!=null&&(d.cap=r),o!=null&&(d.join=o),h!=null&&(d.miterLimit=sr(h)),d}clone(){return new kI({color:dt(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};P([mi({esriSLS:"simple-line"},{readOnly:!0})],Wn.prototype,"type",void 0),P([R({type:zT.apiValues,json:{read:zT.read,write:zT.write}})],Wn.prototype,"style",void 0),P([R({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&i?.origin==null})}}})],Wn.prototype,"cap",void 0),P([R({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&i?.origin==null})}}})],Wn.prototype,"join",void 0),P([R({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":rhe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Wn.prototype,"marker",void 0),P([R({type:Number,json:{read:!1,write:!1}})],Wn.prototype,"miterLimit",void 0),Wn=kI=P([Ge("esri.symbols.SimpleLineSymbol")],Wn);let Cf=class extends Nr{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};P([R({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Wn}},json:{default:null,write:!0}})],Cf.prototype,"outline",void 0),P([R({type:["simple-fill","picture-fill"],readOnly:!0})],Cf.prototype,"type",void 0),Cf=P([Ge("esri.symbols.FillSymbol")],Cf);function nhe(t,e,i){return e.imageData?U6({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):l8(e.url,i)}function l8(t,e){if(!wa(t)){const i=ohe(e);if(i)return Ew(i,"images",t)}return a_(t,e)}function she(t,e,i,r){if(km(t)){const o=E0(t);if(!o)return;e.contentType=o.mediaType,e.imageData=o.data,i&&i.imageData===e.imageData&&i.url&&hm(i.url,e,"url",r)}else hm(t,e,"url",r)}const c8={json:{read:{source:["imageData","url"],reader:nhe},write:{writer(t,e,i,r){she(t,e,this.source,r)}}}},u8={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const r={};return e.imageData&&(r.imageData=e.imageData),e.contentType&&(r.contentType=e.contentType),e.url&&(r.url=l8(e.url,i)),r}}}};function ohe(t){if(!t)return null;const{origin:e,layer:i}=t;if(e!=="service"&&e!=="portal-item")return null;const r=i?.type;return r==="feature"||r==="stream"?i.parsedUrl?.path:r==="map-image"||r==="tile"?t.url?.path:null}var AI;let xs=AI=class extends Cf{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const o={};return t&&(o.url=t),e&&(o.outline=e),i!=null&&(o.width=sr(i)),r!=null&&(o.height=sr(r)),o}clone(){const t=new AI({color:dt(this.color),height:this.height,outline:dt(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",dt(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};P([mi({esriPFS:"picture-fill"},{readOnly:!0})],xs.prototype,"type",void 0),P([R(c8)],xs.prototype,"url",void 0),P([R({type:Number,json:{write:!0}})],xs.prototype,"xscale",void 0),P([R({type:Number,json:{write:!0}})],xs.prototype,"yscale",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],xs.prototype,"width",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],xs.prototype,"height",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],xs.prototype,"xoffset",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],xs.prototype,"yoffset",void 0),P([R(u8)],xs.prototype,"source",void 0),xs=AI=P([Ge("esri.symbols.PictureFillSymbol")],xs);let oc=class extends Nr{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};P([R({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],oc.prototype,"angle",void 0),P([R({type:["simple-marker","picture-marker"],readOnly:!0})],oc.prototype,"type",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],oc.prototype,"xoffset",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],oc.prototype,"yoffset",void 0),P([R({cast:t=>t==="auto"?t:kw(sr(t)),json:{write:!0}})],oc.prototype,"size",void 0),oc=P([Ge("esri.symbols.MarkerSymbol")],oc);var DI;let hs=DI=class extends oc{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e!=null&&(r.width=sr(e)),i!=null&&(r.height=sr(i)),r}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new DI({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",dt(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};P([R({json:{write:!1}})],hs.prototype,"color",void 0),P([mi({esriPMS:"picture-marker"},{readOnly:!0})],hs.prototype,"type",void 0),P([R(c8)],hs.prototype,"url",void 0),P([R(u8)],hs.prototype,"source",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],hs.prototype,"height",void 0),P([Fr("height",["height","size"])],hs.prototype,"readHeight",null),P([R({type:Number,cast:sr,json:{write:!0}})],hs.prototype,"width",void 0),P([R({json:{write:!1}})],hs.prototype,"size",void 0),hs=DI=P([Ge("esri.symbols.PictureMarkerSymbol")],hs);var Yh;const h8=nr.ofType({base:null,key:"type",typeMap:{icon:bn,object:vn,text:Jr}});let al=Yh=class extends Cs{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new h8,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return r8(this)}hasVisibleVerticalOffset(){return JP(this)}clone(){return new Yh({verticalOffset:dt(this.verticalOffset),callout:dt(this.callout),styleOrigin:dt(this.styleOrigin),symbolLayers:dt(this.symbolLayers),thumbnail:dt(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Yh({symbolLayers:new nr([bn.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new Yh({symbolLayers:new nr([bn.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const i=t.data.symbol;return new Yh(i?.callout?{symbolLayers:new nr([bn.fromCIMSymbol(t)]),callout:new sc({size:.5,color:new or([0,0,0])}),verticalOffset:new Eu({screenLength:40})}:{symbolLayers:new nr([bn.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new Yh({symbolLayers:new nr([Jr.fromTextSymbol(t)])})}};P([R({type:Eu,json:{write:!0}})],al.prototype,"verticalOffset",void 0),P([R(n8)],al.prototype,"callout",void 0),P([R({type:h8,json:{origins:{"web-scene":{write:!0}}}})],al.prototype,"symbolLayers",void 0),P([mi({PointSymbol3D:"point-3d"},{readOnly:!0})],al.prototype,"type",void 0),al=Yh=P([Ge("esri.symbols.PointSymbol3D")],al);var zy;const d8=nr.ofType({base:null,key:"type",typeMap:{extrude:rc,fill:oo,icon:bn,line:Ts,object:vn,text:Jr,water:nc}});let zu=zy=class extends Cs{constructor(t){super(t),this.symbolLayers=new d8,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&pm(ui.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&pm(ui.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(_4(()=>this.symbolLayers,"after-add",({item:e})=>t(e),see))}clone(){return new zy({styleOrigin:dt(this.styleOrigin),symbolLayers:dt(this.symbolLayers),thumbnail:dt(this.thumbnail)})}static fromJSON(t){const e=new zy;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const i=e.symbolLayers.at(0),r=e.symbolLayers.at(1);!r.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(i.outline={size:r.size,color:r.material!=null?r.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new zy({symbolLayers:new nr([oo.fromSimpleFillSymbol(t)])})}};P([R({type:d8,json:{write:!0}})],zu.prototype,"symbolLayers",void 0),P([mi({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],zu.prototype,"type",void 0),zu=zy=P([Ge("esri.symbols.PolygonSymbol3D")],zu);var zI;const OT=new vl({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let ll=zI=class extends Cf{constructor(...t){super(...t),this.color=new or([0,0,0,.25]),this.outline=new Wn,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e&&(r.outline=e),i&&(r.color=i),r}clone(){return new zI({color:dt(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};P([R()],ll.prototype,"color",void 0),P([R()],ll.prototype,"outline",void 0),P([mi({esriSFS:"simple-fill"},{readOnly:!0})],ll.prototype,"type",void 0),P([R({type:OT.apiValues,json:{read:OT.read,write:OT.write}})],ll.prototype,"style",void 0),ll=zI=P([Ge("esri.symbols.SimpleFillSymbol")],ll);var OI;const RT=new vl({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let so=OI=class extends oc{constructor(...t){super(...t),this.color=new or([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Wn}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string")return t;const o={};return t&&(o.style=t),e!=null&&(o.size=sr(e)),i&&(o.outline=i),r&&(o.color=r),o}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new OI({angle:this.angle,color:dt(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};P([R()],so.prototype,"color",void 0),P([Bi("color")],so.prototype,"writeColor",null),P([mi({esriSMS:"simple-marker"},{readOnly:!0})],so.prototype,"type",void 0),P([R()],so.prototype,"size",void 0),P([R({type:RT.apiValues,json:{read:RT.read,write:RT.write}})],so.prototype,"style",void 0),P([R({type:String,json:{write:!0}})],so.prototype,"path",null),P([R({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Wn}},json:{default:null,write:!0}})],so.prototype,"outline",void 0),so=OI=P([Ge("esri.symbols.SimpleMarkerSymbol")],so);var RI;let Ri=RI=class extends Nr{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new Ro,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.text=t),e&&(r.font=e),i&&(r.color=i),r}writeLineWidth(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}castLineWidth(t){return sr(t)}writeLineHeight(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}clone(){return new RI({angle:this.angle,backgroundColor:dt(this.backgroundColor),borderLineColor:dt(this.borderLineColor),borderLineSize:this.borderLineSize,color:dt(this.color),font:this.font&&this.font.clone(),haloColor:dt(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};P([R({type:or,json:{write:!0}})],Ri.prototype,"backgroundColor",void 0),P([R({type:or,json:{write:!0}})],Ri.prototype,"borderLineColor",void 0),P([R({type:Number,json:{write:!0},cast:sr})],Ri.prototype,"borderLineSize",void 0),P([R({type:Ro,json:{write:!0}})],Ri.prototype,"font",void 0),P([R({...e8,json:{write:!0}})],Ri.prototype,"horizontalAlignment",void 0),P([R({type:Boolean,json:{write:!0}})],Ri.prototype,"kerning",void 0),P([R({type:or,json:{write:!0}})],Ri.prototype,"haloColor",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],Ri.prototype,"haloSize",void 0),P([R({type:Boolean,json:{write:!0}})],Ri.prototype,"rightToLeft",void 0),P([R({type:Boolean,json:{write:!0}})],Ri.prototype,"rotated",void 0),P([R({type:String,json:{write:!0}})],Ri.prototype,"text",void 0),P([mi({esriTS:"text"},{readOnly:!0})],Ri.prototype,"type",void 0),P([R({...t8,json:{write:!0}})],Ri.prototype,"verticalAlignment",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],Ri.prototype,"xoffset",void 0),P([R({type:Number,cast:sr,json:{write:!0}})],Ri.prototype,"yoffset",void 0),P([R({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Ri.prototype,"angle",void 0),P([R({type:Number,json:{write:!0}})],Ri.prototype,"width",void 0),P([R({type:Number})],Ri.prototype,"lineWidth",void 0),P([Bi("lineWidth")],Ri.prototype,"writeLineWidth",null),P([l_("lineWidth")],Ri.prototype,"castLineWidth",null),P([R(QB)],Ri.prototype,"lineHeight",void 0),P([Bi("lineHeight")],Ri.prototype,"writeLineHeight",null),Ri=RI=P([Ge("esri.symbols.TextSymbol")],Ri);var LI;let Ss=LI=class extends Nr{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:tt.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new LI({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){sF(ui.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new Ot("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,i=e?this._fetchCacheKey:null;if(e!=null){const d=i&&e.get(i);if(d)return d.clone()}const{resolveWebStyleSymbol:r}=await Kn(()=>import("./webStyleSymbolUtils-D_mE3Vw-.js"),__vite__mapDeps([53,54,55,56,57,58,1,2,3]));w0(t);const o=r(this,{portal:this.portal},t);o.catch(d=>{ui.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",d)});const h=await o;return e?.set(i,h.clone()),h}};P([R({json:{write:!1}})],Ss.prototype,"color",void 0),P([R({type:String,json:{write:!0}})],Ss.prototype,"styleName",void 0),P([R({type:tt,json:{write:!1}})],Ss.prototype,"portal",void 0),P([R({type:String,json:{read:yP,write:hm}})],Ss.prototype,"styleUrl",void 0),P([R({type:t0,json:{read:!1}})],Ss.prototype,"thumbnail",void 0),P([R({type:String,json:{write:!0}})],Ss.prototype,"name",void 0),P([mi({styleSymbolReference:"web-style"},{readOnly:!0})],Ss.prototype,"type",void 0),P([R()],Ss.prototype,"_fetchCacheKey",null),Ss=LI=P([Ge("esri.symbols.WebStyleSymbol")],Ss);function E0e(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function I0e(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const KP={base:Nr,key:"type",typeMap:{"simple-fill":ll,"picture-fill":xs,"picture-marker":hs,"simple-line":Wn,"simple-marker":so,text:Ri,"label-3d":nl,"line-3d":Du,"mesh-3d":rd,"point-3d":al,"polygon-3d":zu,"web-style":Ss,cim:$s},errorContext:"symbol"},$0e={base:Nr,key:"type",typeMap:{"picture-marker":hs,"simple-marker":so,"point-3d":al,cim:$s},errorContext:"symbol"},P0e={base:Nr,key:"type",typeMap:{"simple-line":Wn,"line-3d":Du,cim:$s},errorContext:"symbol"},M0e={base:Nr,key:"type",typeMap:{"simple-fill":ll,"picture-fill":xs,"polygon-3d":zu,cim:$s},errorContext:"symbol"},k0e={base:Nr,key:"type",typeMap:{"picture-marker":hs,"simple-marker":so,text:Ri,"web-style":Ss,cim:$s},errorContext:"symbol"},A0e=_F({types:KP}),D0e={base:Nr,key:"type",typeMap:{"simple-fill":ll,"picture-fill":xs,"picture-marker":hs,"simple-line":Wn,"simple-marker":so,text:Ri,"line-3d":Du,"mesh-3d":rd,"point-3d":al,"polygon-3d":zu,"web-style":Ss,cim:$s},errorContext:"symbol"},z0e={base:Nr,key:"type",typeMap:{text:Ri,"label-3d":nl},errorContext:"symbol"},O0e={base:Nr,key:"type",typeMap:{"line-3d":Du,"mesh-3d":rd,"point-3d":al,"polygon-3d":zu,"web-style":Ss,cim:$s},errorContext:"symbol"},R0e={base:Nr,key:"type",typeMap:{"label-3d":nl},errorContext:"symbol"},L0e=fm(KP);var FI;function ahe(t){if(!t)return null;const e={};for(const i in t){const r=LB(t[i]);r&&(e[i]=r)}return Object.keys(e).length!==0?e:null}function lhe(t){if(t==null)return null;const e={};for(const i in t){const r=t[i];r&&(e[i]=r.toJSON())}return Object.keys(e).length!==0?e:null}var Zf;let qn=(Zf=class extends ms(Lt){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:wb(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&qre(ui.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const i=this._get("aggregateGeometries");JSON.stringify(i)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const i=this._get("attributes");i!==e&&(this._set("attributes",e),this._notifyLayer("attributes",i,e))}set geometry(e){const i=this._get("geometry");i!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",i,e))}set popupTemplate(e){const i=this._get("popupTemplate");i!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",i,e))}set symbol(e){const i=this._get("symbol");i!==e&&(this._set("symbol",e),this._notifyLayer("symbol",i,e))}get version(){return this._version}set visible(e){const i=this._get("visible");i!==e&&(this._set("visible",e),this._notifyLayer("visible",i,e))}cloneShallow(){return new FI({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const i=Hce(this.origin);if(i)return i.popupTemplate??(e?i.defaultPopupTemplate:null)??null;const r=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const o of[r,this.sourceLayer,this.layer])if(o&&typeof o=="object"){if("popupTemplate"in o&&o.popupTemplate)return o.popupTemplate;if(e&&"defaultPopupTemplate"in o&&o.defaultPopupTemplate!=null)return o.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,i){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=i,this._notifyLayer("attributes",r,i,e)}else this.attributes={[e]:i}}getObjectId(){const e=xz(this.origin);if(e)return wz(this,e);const i=this.sourceLayer??this.layer;return i?wz(this,i):null}getGlobalId(){const e=xz(this.origin);if(e?.globalIdField)return this.getAttribute(e.globalIdField);const i=this.sourceLayer??this.layer;return i&&"globalIdField"in i&&i.globalIdField?this.getAttribute(i.globalIdField):null}toJSON(){return{aggregateGeometries:lhe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:i1(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:i}=this;if(i?.type==="mesh"){const r={origin:i.origin,transform:i.transform};this._notifyLayer("origin-transform",r,r,e.action)}}_notifyLayer(e,i,r,o){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const h={graphic:this,property:e,oldValue:i,newValue:r};e==="origin-transform"&&(h.action=o),e==="attributes"&&(h.attributeName=o),this.layer.graphicChanged(h)}_watchMeshGeometryChanges(){this.addHandles([GC(()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:i})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===i||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=i,this.notifyMeshTransformChanged())}),GC(()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,i)=>e===i,sync:!0})])}},FI=Zf,Zf);P([R({value:null,json:{read:ahe}})],qn.prototype,"aggregateGeometries",null),P([R({value:null})],qn.prototype,"attributes",null),P([R({value:null,types:Vce,json:{read:LB}})],qn.prototype,"geometry",null),P([R({type:Boolean})],qn.prototype,"isAggregate",void 0),P([R({clonable:!1})],qn.prototype,"layer",void 0),P([R({clonable:"reference"})],qn.prototype,"origin",void 0),P([R({type:O0,value:null})],qn.prototype,"popupTemplate",null),P([R({clonable:"reference"})],qn.prototype,"sourceLayer",void 0),P([R({value:null,types:KP})],qn.prototype,"symbol",null),P([R({clonable:!1,json:{read:!1,write:!1}})],qn.prototype,"_version",void 0),P([R({type:Boolean,value:!0})],qn.prototype,"visible",null),qn=FI=P([Ge("esri.Graphic")],qn);const p8=96;function F0e(t,e){const i=t.extent,r=t.width,o=xc(i?.spatialReference);return i&&r?i.width/r*o*LN*p8:0}function che(t,e){return t/(xc(e)*LN*p8)}function uhe(t,e){const i=t.extent,r=t.width-(t.padding?t.padding.left+t.padding.right:0),o=che(e,i.spatialReference);return i.clone().expand(o*r/i.width)}function N0e(t,e,i){return hhe(t,e)&&dhe(t,i)}function hhe(t,e){return e===0||Ta(t,e)||t<e}function dhe(t,e){return e===0||Ta(t,e)||t>e}function B0e(t,e){return Ta(t,e)?0:(t||Number.POSITIVE_INFINITY)>(e||Number.POSITIVE_INFINITY)?1:-1}function Mz(t){switch(t?.type){case"point":return t;case"extent":return t.center;case"polygon":{const e=MB(t);return e?oi.fromJSON(e):null}case"multipoint":case"polyline":return t.extent?.center;default:return null}}async function phe(t,e){if(t.hasZ||e.type==="2d")return t;const i=e.map?.ground;return i?.layers.length?(await i.queryElevation(t,{cache:e.basemapTerrain?.elevationQueryCache})).geometry:t}function NI(t,e,i){return f8(t.center,e,i)}function QP(t,e,i){switch(t?.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return f8(t,e,i);default:return null}}function f8(t,e,i){const r=t.hasZ?t.z:void 0;if(e?.map)return(i!=null?uhe(e,i):e.extent).clone().centerAt(t).set({zmax:r,zmin:r});const{x:o,y:h,spatialReference:d}=t;return new _i({xmin:o-.25,ymin:h-.25,xmax:o+.25,ymax:h+.25,spatialReference:d,zmin:r,zmax:r})}function kz(t){const{popupElement:e,popup:i}=t||{};return e??i??null}function fhe(t){return t!=null&&"open"in t&&"declaredClass"in t}function mhe(t){return!!t&&t.tagName.toLowerCase()==="arcgis-popup"&&"open"in t}function ghe(t,e){fhe(t)&&t.close(),e&&mhe(e)&&(e.visible=!1)}function yhe(t){return t&&typeof t.highlight=="function"}async function _he(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await Kn(async()=>{const{fromItem:r}=await import("./portalLayers-D3ZnkbtC.js");return{fromItem:r}},__vite__mapDeps([59,60,34,1,2,3,61,62,63,50,51]));try{return await i(e)}catch(r){const o=e?.portalItem,h=o?.id||"unset",d=o?.portal?.url||Ai.portalUrl;throw ui.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+d+"', id: '"+h+"')",r),r}}const Az={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function LT(t,e,i,r=cm){const o=new $a(oP(r)),h=zt.fromJSDate(t,{zone:o}),d=i==="decades"||i==="centuries"?"year":m8(i);return i==="decades"&&(e*=10),i==="centuries"&&(e*=100),h.plus({[d]:e}).toJSDate()}function j0e(t,e,i="milliseconds"){const r=t.getTime(),o=vhe(e,i,"milliseconds");return new Date(r+o)}function Dz(t,e,i=cm){const r=new $a(oP(i)),o=zt.fromJSDate(t,{zone:r});if(e==="decades"||e==="centuries"){const d=o.startOf("year"),{year:a}=d,_=a-a%(e==="decades"?10:100);return d.set({year:_}).toJSDate()}const h=m8(e);return o.startOf(h).toJSDate()}function vhe(t,e,i){return t===0?0:t*Az[e]/Az[i]}function m8(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var Ao,Wf;let no=(Wf=class extends Lt{static get allTime(){return zz}static get empty(){return bhe}static fromArray(e){return new Ao({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,i){return i.end!=null?new Date(i.end):null}writeEnd(e,i){i.end=e?.getTime()??null}get isAllTime(){return this.equals(Ao.allTime)}get isEmpty(){return this.equals(Ao.empty)}readStart(e,i){return i.start!=null?new Date(i.start):null}writeStart(e,i){i.start=e?.getTime()??null}clone(){return new Ao({end:this.end,start:this.start})}equals(e){if(!e)return!1;const i=this.start?.getTime()??this.start,r=this.end?.getTime()??this.end,o=e.start?.getTime()??e.start,h=e.end?.getTime()??e.end;return i===o&&r===h}expandTo(e,i=cm){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=Dz(r,e,i));let o=this.end;if(o){const h=Dz(o,e,i);o=o.getTime()===h.getTime()?h:LT(h,1,e,i)}return new Ao({start:r,end:o})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return Ao.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const i=this.start?.getTime()??-1/0,r=this.end?.getTime()??1/0,o=e.start?.getTime()??-1/0,h=e.end?.getTime()??1/0;let d,a;return o>=i&&o<=r?d=o:i>=o&&i<=h&&(d=i),r>=o&&r<=h?a=r:h>=i&&h<=r&&(a=h),d==null||a==null||isNaN(d)||isNaN(a)?Ao.empty:new Ao({start:d===-1/0?null:new Date(d),end:a===1/0?null:new Date(a)})}offset(e,i,r=cm){if(this.isEmpty||this.isAllTime)return this.clone();const o=new Ao,{start:h,end:d}=this;return h!=null&&(o.start=LT(h,e,i,r)),d!=null&&(o.end=LT(d,e,i,r)),o}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return zz.clone();const i=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new Ao({start:i,end:r})}},Ao=Wf,Wf);P([R({type:Date,json:{write:{allowNull:!0}}})],no.prototype,"end",void 0),P([Fr("end")],no.prototype,"readEnd",null),P([Bi("end")],no.prototype,"writeEnd",null),P([R({readOnly:!0,json:{read:!1}})],no.prototype,"isAllTime",null),P([R({readOnly:!0,json:{read:!1}})],no.prototype,"isEmpty",null),P([R({type:Date,json:{write:{allowNull:!0}}})],no.prototype,"start",void 0),P([Fr("start")],no.prototype,"readStart",null),P([Bi("start")],no.prototype,"writeStart",null),no=Ao=P([Ge("esri.time.TimeExtent")],no);const zz=new no,bhe=new no({start:void 0,end:void 0});let xhe=0,Dr=class extends IP(Lw(BB)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new _i(-180,-90,180,90,Rt.WGS84),this.id=Date.now().toString(16)+"-layer-"+xhe++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Rt.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const i=typeof e=="string"?{url:e}:e;return(await Kn(async()=>{const{fromUrl:r}=await import("./arcgisLayers-BaE4bUqN.js");return{fromUrl:r}},__vite__mapDeps([64,1,2,60,34,3,61,63]))).fromUrl(i)}static fromPortalItem(e){return _he(e)}initialize(){this.when().catch(e=>{Dd(e)||ui.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return this.attributionDataUrl!=null}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return Ho(this.url)}createLayerView(e,i){return Promise.reject(new Ot("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await wn(e,{query:{f:"json"},responseType:"json"})).data;throw new Ot("layer:no-attribution-data","Layer does not have attribution data")}};P([R({type:String})],Dr.prototype,"attributionDataUrl",void 0),P([R({readOnly:!0})],Dr.prototype,"effectiveVisible",null),P([R({type:_i})],Dr.prototype,"fullExtent",void 0),P([R({readOnly:!0})],Dr.prototype,"hasAttributionData",null),P([R({type:String,clonable:!1})],Dr.prototype,"id",void 0),P([R({type:Boolean,nonNullable:!0})],Dr.prototype,"legendEnabled",void 0),P([R({type:["show","hide","hide-children"]})],Dr.prototype,"listMode",void 0),P([R({type:Number,range:{min:0,max:1},nonNullable:!0})],Dr.prototype,"opacity",void 0),P([R({clonable:!1})],Dr.prototype,"parent",void 0),P([R({readOnly:!0})],Dr.prototype,"parsedUrl",null),P([R({type:Boolean,readOnly:!0})],Dr.prototype,"persistenceEnabled",void 0),P([R({type:Boolean})],Dr.prototype,"popupEnabled",void 0),P([R({type:Boolean})],Dr.prototype,"attributionVisible",void 0),P([R({type:Rt})],Dr.prototype,"spatialReference",void 0),P([R({type:String})],Dr.prototype,"title",void 0),P([R({readOnly:!0,json:{read:!1}})],Dr.prototype,"type",void 0),P([R()],Dr.prototype,"url",void 0),P([R({type:no})],Dr.prototype,"visibilityTimeExtent",void 0),P([R({type:Boolean,nonNullable:!0})],Dr.prototype,"visible",void 0),Dr=P([Ge("esri.layers.Layer")],Dr);function whe(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function V0e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}const G0e={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function q0e(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function H0e(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function Z0e(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}function She(t){return t?.type==="feature"&&t.source?.type==="feature-layer"}function The(t){return whe(t)&&She(t)}async function W0e(t,e){const i=Ni?.findServerInfo(t);if(i?.currentVersion!=null)return i.owningSystemUrl||null;const r=t.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const o=`${t.slice(0,r)}/rest/info`,h=e!=null?e.signal:null,{data:d}=await wn(o,{query:{f:"json"},responseType:"json",signal:h});return d?.owningSystemUrl||null}function Che(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function Y0e(t){return Che(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function Ehe(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function X0e(t){return!!Ehe(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function Ihe(t,e){return null}function J0e(t){return null}function $he(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function K0e(t,e){!e||!$he(t)||Ihe(t.url)}let zr=class extends Lw(Lt){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suffix="",this.suggestionsEnabled=null,this.withinViewEnabled=!1,this.zoomScale=null}};P([R()],zr.prototype,"autoNavigate",void 0),P([R()],zr.prototype,"filter",void 0),P([R()],zr.prototype,"getResults",void 0),P([R()],zr.prototype,"getSuggestions",void 0),P([R()],zr.prototype,"maxResults",void 0),P([R()],zr.prototype,"maxSuggestions",void 0),P([R()],zr.prototype,"minSuggestCharacters",void 0),P([R()],zr.prototype,"outFields",void 0),P([R()],zr.prototype,"placeholder",void 0),P([R()],zr.prototype,"popupEnabled",void 0),P([R({type:O0})],zr.prototype,"popupTemplate",void 0),P([R()],zr.prototype,"prefix",void 0),P([R()],zr.prototype,"resultGraphicEnabled",void 0),P([R()],zr.prototype,"resultSymbol",void 0),P([R()],zr.prototype,"suffix",void 0),P([R()],zr.prototype,"suggestionsEnabled",void 0),P([R()],zr.prototype,"withinViewEnabled",void 0),P([R()],zr.prototype,"zoomScale",void 0),zr=P([Ge("esri.widgets.Search.SearchSource")],zr);const eM=zr;let Xh=class extends ms(Lt){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};P([R({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Xh.prototype,"onFields",void 0),P([R({type:String,json:{write:!0}})],Xh.prototype,"operator",void 0),P([R({type:String,json:{write:!0}})],Xh.prototype,"searchTerm",void 0),P([R({type:String,json:{write:!0}})],Xh.prototype,"searchType",void 0),Xh=P([Ge("esri.rest.support.FullTextSearch")],Xh);const Phe=Xh,Mhe=/https?:\/\/services.*\.arcgis\.com/i,khe=/(?:\{([^}]+)\})/g,Lf=()=>ui.getLogger("esri.widgets.Search.support.layerSearchUtils");function Ahe(t,e){const{exactMatch:i=!1,location:r,maxResults:o,spatialReference:h,source:d,sourceIndex:a,suggestResult:_,view:T}=t,{layer:E,filter:k,zoomScale:L}=d,O=T?.scale,H=g8(d,T),re=e?.signal;return _8(E).then(()=>{const pe=E.popupTemplate;return pe?pe.getRequiredFields(E.fieldsIndex):null}).then(pe=>{const{objectIdField:ge,returnZ:Se}=E,Pe=T8(d);if(!tM(E,Pe))throw Lf().error("invalid-field: displayField is invalid."),new Ot("getResults():invalid-field","displayField is invalid.");const Re=pe?.length?pe:[Pe],ze=d.outFields||Re,Je=y8(ze);if(ze.includes(ge)||Je||ze.push(ge),E.floorInfo?.floorField&&ze.push(E.floorInfo.floorField),!(Je||_1(E,ze)))throw Lf().error("invalid-field: outField is invalid."),new Ot("getResults():invalid-field","outField is invalid.");const Xe=E.createQuery(),{orderByFields:yt}=d;if(yt&&(Xe.orderByFields=yt),h){Xe.outSpatialReference=h;const ke=1/xc(h);ke&&(Xe.maxAllowableOffset=ke)}const mt=E.geometryType==="mesh"||E.geometryType==="multipatch",je=E.capabilities?.data?.supportsZ&&!mt;if(Xe.returnZ=je&&Se!==!1,Xe.returnGeometry=!0,Xe.multipatchOption=mt?"xyFootprint":null,ze&&(Xe.outFields=ze),r)Xe.geometry=r;else if(_.key)Xe.objectIds=[_.key];else{const ke=d.searchFields||[Pe];if(!_1(E,ke))throw Lf().error("invalid-field: search field is invalid."),new Ot("getResults():invalid-field","search field is invalid.");if(S8(E)&&(Xe.num=o),H&&(Xe.geometry=H),!_.text?.trim())return[];const Ce=_.text,{prefix:Ee="",suffix:st=""}=d,_t=C8(`${Ee}${Ce}${st}`);w8(E)&&b8(E,ke)&&!i&&Ce&&(Xe.fullText=x8({text:Ce,searchFields:ke}));const ht=E8({searchTerm:_t,layer:E,searchFields:ke,filter:k,exactMatch:i,query:Xe,type:"search"});if(Xe.where=ht,!v8(Xe))return[]}return E.queryFeatures(Xe,{signal:re}).then(ke=>qhe(ke,T,d,a,Pe,O,L))})}function Dhe(t,e){const{source:i,spatialReference:r,view:o,suggestTerm:h,maxSuggestions:d,sourceIndex:a,exactMatch:_}=t,{layer:T,filter:E}=i,k=e?.signal,L=g8(i,o);return _8(T).then(()=>{if(!S8(T))return[];const O=T8(i),H=i.searchFields||[O],re=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(khe,(je,ke)=>(re.push(ke),je)):re.push(O);const pe=y8(re);re.includes(T.objectIdField)||pe||re.push(T.objectIdField);const ge=tM(T,O),Se=pe||_1(T,re),Pe=_1(T,H);if(!ge)throw Lf().error("invalid-field: displayField is invalid."),new Ot("getSuggestions():invalid-field","displayField is invalid.");if(!Se)throw Lf().error("invalid-field: outField is invalid."),new Ot("getSuggestions():invalid-field","outField is invalid.");if(!Pe)throw Lf().error("invalid-field: search field is invalid."),new Ot("getSuggestions():invalid-field","search field is invalid.");const Re=T.createQuery(),{orderByFields:ze}=i;if(ze&&(Re.orderByFields=ze),Re.outSpatialReference=r,Re.returnGeometry=!1,Re.num=d,Re.outFields=re,L&&(Re.geometry=L),!h.trim())return[];const{prefix:Je="",suffix:Xe=""}=i,yt=C8(`${Je}${h}${Xe}`);w8(T)&&b8(T,H)&&!_&&h&&(Re.fullText=x8({text:h,searchFields:H}));const mt=E8({searchTerm:yt,layer:T,searchFields:H,filter:E,exactMatch:_,query:Re,type:"suggest"});return Re.where=mt,v8(Re)?T.queryFeatures(Re,{signal:k}).then(je=>Uhe(je,i,a,O)):[]})}function g8(t,e){const{filter:i,withinViewEnabled:r}=t,o=e?.extent;return i?.geometry??(r&&o?o:void 0)}function y8(t){return t&&t.includes("*")}async function _8(t){t&&await t.load()}function v8(t){return!(!t.fullText&&!t.where)}function b8(t,e){const i=t?.indexes;return!i||!e?.length?!1:i.filter(r=>r.indexType==="FullText").some(r=>{const o=r.fields?.split(",").map(h=>h.trim().toLowerCase())||[];return e.every(h=>o.includes(h.toLowerCase()))})}function x8({text:t,searchFields:e}){return t.trim().split(" ").filter(i=>!!i.trim()).map(i=>new Phe({onFields:e,searchTerm:i,searchType:"prefix"}))}function w8(t){return t?.capabilities?.query?.supportsFullTextSearch??!1}function S8(t){return t?.capabilities?.query?.supportsPagination??!1}function zhe(t){return t?.fieldsIndex?.fields?.find(e=>e.type==="string")?.name??""}function T8(t){return t.displayField||t.layer.displayField||zhe(t.layer)}function _1(t,e){return!(!t||!e?.length)&&e.every(i=>tM(t,i))}function tM(t,e){return!!t.getField(e)}function Ohe(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function Rhe({codedValues:t},e,i){return Hx(t??[],r=>{const o=r.name,h=i?o:o.toLowerCase();return(i?e:e.toLowerCase())===h?r.code.toString():null})??null}function C8(t){return t.replaceAll("'","''")}function ay(t,e){const i=e?.where;return i?`(${t}) AND (${i})`:t}function Lhe({currentTerm:t,field:e,filter:i,exactMatch:r,url:o,type:h}){const d=e?.type,a=e?.name;if(d==="string"||d==="date"||d==="global-id"){const _=Mhe.test(o??""),T=_&&Ohe(t)?"N":"";return ay(r&&h==="search"?`${a} = ${T}'${t}'`:_?`${a} LIKE ${T}${`'${t}%'`}`:`${`LOWER(${a})`} LIKE ${T}${`'${t.toLowerCase()}%'`}`,i)}if(d==="oid"||d==="small-integer"||d==="integer"||d==="single"||d==="double"){const _=Number(t);return isNaN(_)?null:ay(`${a} = ${_}`,i)}return ay(`${a} = ${t}`,i)}function Fhe(t,e){return t?` OR (${e})`:`(${e})`}function E8({searchTerm:t,layer:e,searchFields:i,filter:r,exactMatch:o,query:h,type:d}){const{definitionExpression:a,url:_}=e;let T="";return!h.fullText&&t&&i&&i.forEach(E=>{const k=e.getField(E),L=e.getFieldDomain?.(E,{excludeImpliedDomains:Ve("esri-widget-legacy-field-domain-calculation")}),O=(L&&L.type==="coded-value"?Rhe(L,t,o):null)||t||null;if(O!==null){const H=Lhe({currentTerm:O,field:k,filter:r,exactMatch:o,url:_,type:d});H&&(T+=Fhe(T,H))}}),a&&T?`(${a}) AND (${T})`:a||T}function Nhe(t,e){let i=null;const{codedValues:r}=t;return r&&r.length&&r.some(o=>o.code===e&&(i=o.name,!0)),i}function Bhe(t,e){return t[e]??t[Object.keys(t).find(i=>i.toLowerCase()===e.toLowerCase())]}function I8(t,e,i){const r=t.sourceLayer,{attributes:o}=t,h=r.getFieldDomain?.(i,{feature:t,excludeImpliedDomains:Ve("esri-widget-legacy-field-domain-calculation")});if(e)return aP(e,o);if(i&&o){const d=r.getField(i),a=Bhe(o,i);return a==null?"":h&&h.type==="coded-value"?Nhe(h,a)??"":d?.type==="date"?Gu(new Date(a)):typeof a=="number"?a.toString():typeof a!="string"?"":a.trim()}return""}function jhe(t,e,i,r){const o=t.sourceLayer,{attributes:h}=t,{objectIdField:d}=o,a=d?h[d]:null;return{text:I8(t,e.suggestionTemplate,r),key:a,sourceIndex:i}}function Uhe(t,e,i,r){return t.features.map(o=>jhe(o,e,i,r))}function Vhe(t){return t!=null&&t.minScale!=null&&t.maxScale!=null}function Ghe(t,e,i,r,o,h,d){const a=t.clone();a.layer=t.layer;const _=t.sourceLayer,T=_?.objectIdField,E=T?t.attributes[T]:null,k=I8(t,i.searchTemplate,o);h!=null&&Vhe(_)&&(_.minScale&&_.minScale<h?h=_.minScale:_.maxScale&&_.maxScale>h&&(h=_.maxScale));const L=a.geometry?QP(a.geometry,e??void 0,h??void 0):void 0,O=typeof d=="number"&&L?NI(dt(L),e??void 0,d):L,H=t.clone();return H.layer=t.layer,O!=null&&(H.geometry=Rn.fromExtent(O)),{extent:O,target:H,feature:a,key:E,name:k,sourceIndex:r}}function qhe(t,e,i,r,o,h,d){return t.features.map(a=>Ghe(a,e,i,r,o,h,d))}var BI;let fa=BI=class extends eM{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,i)=>Ahe({source:this,...e},i),this.getSuggestions=(e,i)=>Dhe({source:this,...e},i)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new BI({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?dt(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?dt(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(t=>t.type==="string")?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;if(!t.loaded)return"";const i=e||[this._getDisplayField()],r=The(t);return`: ${i.map(o=>{const h=t.getField(o);return(r?t.getFieldAlias(o):h?.alias)||o}).join(", ")}`}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};P([R({json:{read:{source:"field.name"},write:{target:"field.name"}}})],fa.prototype,"displayField",void 0),P([R({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],fa.prototype,"exactMatch",void 0),P([R({value:null})],fa.prototype,"layer",null),P([R()],fa.prototype,"name",null),P([R({type:[String],json:{write:!0}})],fa.prototype,"orderByFields",void 0),P([R()],fa.prototype,"searchFields",void 0),P([R()],fa.prototype,"searchTemplate",void 0),P([R()],fa.prototype,"suggestionTemplate",void 0),fa=BI=P([Ge("esri.widgets.Search.LayerSearchSource")],fa);const uf=fa;function iM(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function Hw(t){return typeof t=="string"?Ho(t):dt(t)}function rM(t,e,i){const r={};for(const o in t){if(o==="declaredClass")continue;const h=t[o];if(h!=null&&typeof h!="function")if(Array.isArray(h))r[o]=h.map(d=>rM(d));else if(typeof h=="object")if(h.toJSON){const d=h.toJSON(i?.[o]);r[o]=e?d:JSON.stringify(d)}else r[o]=e?h:JSON.stringify(h);else r[o]=h}return r}function Hhe(t,e){return t?e&&vP(t)?e:_P(t)??Ni?.findCredential(t)?.token:null}async function t_e(t,e,i){const r=Hhe(t,e);return r||(!Ni&&Ai.request.useIdentity&&await Kn(()=>import("./IdentityManager-BV7fJ-wC.js"),__vite__mapDeps([4,1,2,5,6,3])),(await Ni.getCredential(t,i))?.token)}function Zhe(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function Whe(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let gu=class extends Lt{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};P([R({type:String,json:{write:!0}})],gu.prototype,"address",void 0),P([R({type:Object,json:{write:!0}})],gu.prototype,"attributes",void 0),P([R({type:_i,json:{write:!0}})],gu.prototype,"extent",void 0),P([R({type:oi,json:{write:!0}})],gu.prototype,"location",void 0),P([R({type:Number,json:{write:!0}})],gu.prototype,"score",void 0),gu=P([Ge("esri.rest.support.AddressCandidate")],gu);const $8=gu,nM={type:String,json:{read:{source:"token"},write:{target:"token"}}};let An=class extends Lt{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};P([R({type:Object,json:{write:!0}})],An.prototype,"address",void 0),P([R(nM)],An.prototype,"apiKey",void 0),P([R({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],An.prototype,"categories",void 0),P([R({type:String,json:{write:!0}})],An.prototype,"countryCode",void 0),P([R({type:Boolean,json:{write:!0}})],An.prototype,"forStorage",void 0),P([R({type:oi,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],An.prototype,"location",void 0),P([R({type:["rooftop","street"],json:{write:!0}})],An.prototype,"locationType",void 0),P([R({type:String,json:{write:!0}})],An.prototype,"magicKey",void 0),P([R({type:Number,json:{write:!0}})],An.prototype,"maxLocations",void 0),P([R({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],An.prototype,"outFields",void 0),P([R({type:Rt,json:{read:{source:"outSR"},write:{target:"outSR"}}})],An.prototype,"outSpatialReference",void 0),P([R({type:_i,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=i}}}})],An.prototype,"searchExtent",void 0),An=P([Ge("esri.rest.support.AddressToLocationsParameters")],An),An.from=Ds(An);const P8=An;async function Yhe(t,e,i){e=P8.from(e);const r=Hw(t),{address:o,...h}=e.toJSON(),d={...o,...h,f:"json"},a=rM({...r.query,...d}),_=iM(a,i),T=`${r.path}/findAddressCandidates`;return wn(T,_).then(Xhe)}function Xhe({data:t}){if(!t)return[];const{candidates:e,spatialReference:i}=t;return e?e.map(r=>{if(!r)return;const{extent:o,location:h}=r,d=!o||Whe(o);return Zhe(h)&&d?(o&&(o.spatialReference=i),h&&(h.spatialReference=i),$8.fromJSON(r)):void 0}):[]}const Jhe=yo()({DistanceMarker:"distance-marker",Locality:"locality",POI:"poi",PointAddress:"point-address",Postal:"postal",StreetAddress:"street-address",StreetInt:"street-intersection",StreetName:"street-name",Subaddress:"sub-address"}),Khe=yo()({localCity:"local-city",postalCity:"postal-city"});var jI;let ls=jI=class extends Lt{constructor(t){super(t),this.apiKey=null,this.featureTypes=null,this.forStorage=null,this.language=null,this.location=null,this.locationType=null,this.outFields=null,this.outSpatialReference=null,this.preferredLabelValues=null,this.returnInputLocation=null}writeFeatureTypes(t,e){t?.length&&(e.featureTypes=t.map(i=>Jhe.toJSON(i)))}writeLocation(t,e){e.location=t?.clone().normalize().toJSON()}static from(t){return hF(jI,t)}};P([R(nM)],ls.prototype,"apiKey",void 0),P([R({type:[["distance-marker","locality","poi","point-address","postal","street-address","street-intersection","street-name","sub-address"]],json:{write:!0}})],ls.prototype,"featureTypes",void 0),P([Bi("featureTypes")],ls.prototype,"writeFeatureTypes",null),P([R({type:Boolean,json:{write:!0}})],ls.prototype,"forStorage",void 0),P([R({type:String,json:{name:"langCode",write:!0}})],ls.prototype,"language",void 0),P([R({type:oi,json:{write:!0}})],ls.prototype,"location",void 0),P([Bi("location")],ls.prototype,"writeLocation",null),P([R({type:["street","rooftop"],json:{write:!0}})],ls.prototype,"locationType",void 0),P([R({type:[String],json:{write:!0}})],ls.prototype,"outFields",void 0),P([R({type:Rt,json:{name:"outSR",write:!0}})],ls.prototype,"outSpatialReference",void 0),P([mi(Khe)],ls.prototype,"preferredLabelValues",void 0),P([R({type:Boolean,json:{write:!0}})],ls.prototype,"returnInputLocation",void 0),ls=jI=P([Ge("esri.rest.support.LocationToAddressParameters")],ls);const M8=ls;async function Qhe(t,e,i){const r=Hw(t),{path:o,query:h}=r,d=M8.from(e);if(!d.location)throw new Ot("location-to-address:location-required","The location parameter is required");const a={...i,query:{...h,...ede(d),f:"json"}},_=`${o}/reverseGeocode`,{data:T}=await wn(_,a),{address:E,location:k}=T;return $8.fromJSON({address:E?.Match_addr??"",attributes:E,location:k,score:100})}function ede(t){const e=t.toJSON(),{featureTypes:i,forStorage:r,langCode:o,location:h,locationType:d,outFields:a,outSR:_,preferredLabelValues:T,returnInputLocation:E,token:k}=e;return{featureTypes:i?.join(","),forStorage:r,langCode:o,location:JSON.stringify(h),locationType:d,outFields:a?.join(","),outSR:_?.wkid??void 0,preferredLabelValues:T,returnInputLocation:E,token:k}}let hf=class extends Lt{constructor(e){super(e),this.isCollection=null,this.magicKey=null,this.text=null}};P([R({type:Boolean,json:{write:!0}})],hf.prototype,"isCollection",void 0),P([R({type:String,json:{write:!0}})],hf.prototype,"magicKey",void 0),P([R({type:String,json:{write:!0}})],hf.prototype,"text",void 0),hf=P([Ge("esri.rest.support.SuggestionCandidate")],hf);const tde=hf;let io=class extends Lt{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};P([R(nM)],io.prototype,"apiKey",void 0),P([R({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],io.prototype,"categories",void 0),P([R({type:String,json:{write:!0}})],io.prototype,"countryCode",void 0),P([R({type:oi,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],io.prototype,"location",void 0),P([R({type:Number,json:{write:!0}})],io.prototype,"maxSuggestions",void 0),P([R({type:Rt,json:{read:{source:"outSR"},write:{target:"outSR"}}})],io.prototype,"outSpatialReference",void 0),P([R({type:_i,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(i)}}}})],io.prototype,"searchExtent",void 0),P([R({type:String,json:{write:!0}})],io.prototype,"text",void 0),io=P([Ge("esri.rest.support.SuggestLocationsParameters")],io),io.from=Ds(io);const k8=io;async function ide(t,e,i){const r=Hw(t),o={...(e=k8.from(e)).toJSON(),f:"json"},h=rM({...r.query,...o}),d=iM(h,i),a=`${r.path}/suggest`;return wn(a,d).then(rde)}function rde(t){const{data:e}=t;if(!e)return[];const{suggestions:i}=e;return i?i.map(r=>new tde(r)):[]}const nde="Single Line Input",sde=3e5;function ode(t,e){return t.location?hde(t,e):dde(t,e)}function A8(t,e){if(e.localSearchDisabled)return null;const i=t?.scale;return typeof i=="number"&&i<=sde?t?.extent?.center:null}async function ade(t,e){const{source:i,spatialReference:r,view:o,suggestTerm:h,maxSuggestions:d,sourceIndex:a}=t,_=new k8,{apiKey:T,url:E}=i,k=D8(i,o),L=e?.signal;if(!E)return null;T&&(_.apiKey=T),i.categories&&(_.categories=i.categories),r&&(_.outSpatialReference=r);const O=A8(o,i);if(O&&(_.location=O),!h.trim())return null;const{prefix:H="",suffix:re=""}=i,pe=`${H}${h}${re}`;return _.text=pe,k&&(_.searchExtent=k),_.maxSuggestions=d,i.countryCode&&(_.countryCode=i.countryCode),ide(E,_,{signal:L}).then(ge=>fde(ge,a))}function lde(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function cde(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Oz(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const ude="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function hde(t,e){const{location:i,source:r,sourceIndex:o,spatialReference:h,view:d}=t,{apiKey:a,defaultZoomScale:_,language:T,url:E,zoomScale:k}=r;if(E==null)return[];const L=d?.scale,O=e?.signal,H=new M8({language:T,location:i,apiKey:a,outSpatialReference:h});try{return z8([await Qhe(E,H,{signal:O})],{defaultZoomScale:_,scale:L,sourceIndex:o,view:d,zoomScale:k})}catch{return[]}}function D8(t,e){const{filter:i,withinViewEnabled:r}=t,o=e?.scale,h=e?.extent,d=i?.geometry;return(d?QP(d,e??void 0,o):void 0)||(r&&h?h:void 0)}async function dde(t,e){const{source:i,suggestResult:r,spatialReference:o,view:h,maxResults:d,sourceIndex:a}=t,_=i?.zoomScale,T=i?.defaultZoomScale;if(!r.text?.trim())return null;const k=!r.key&&i.prefix?i.prefix:"",L=!r.key&&i.suffix?i.suffix:"",O=`${k}${r.text}${L}`,H=new P8,{apiKey:re,url:pe}=i,ge=h?.scale,Se=D8(i,h),Pe=e?.signal;if(re&&(H.apiKey=re),!pe)return null;i.categories&&(H.categories=i.categories),i.locationType&&(H.locationType=i.locationType),o&&(H.outSpatialReference=o);const Re=A8(h,i);Re&&(H.location=Re),H.maxLocations=d,Se&&(H.searchExtent=Se),i.countryCode&&(H.countryCode=i.countryCode);const{key:ze}=r,Je=`${ze}`;return ze&&(H.magicKey=Je),H.address={},H.address[i.singleLineFieldName||nde]=O,i.outFields&&(H.outFields=i.outFields),Yhe(pe,H,{signal:Pe}).then(Xe=>z8(Xe,{key:Je,scale:ge,sourceIndex:a,view:h,zoomScale:_,defaultZoomScale:T}))}function pde(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function fde(t,e){return t.map(i=>pde(i,e))}function mde(t,e){const{key:i,scale:r,sourceIndex:o,view:h,zoomScale:d,defaultZoomScale:a}=e,{attributes:_,extent:T,location:E,address:k}=t,L=new qn({geometry:E,attributes:_}),O=T||E,H=O?QP(O,h??void 0,r??void 0):void 0,re=H?typeof d=="number"?NI(H,h??void 0,d):typeof a=="number"&&O?.type==="point"?NI(H,h??void 0,a):H:null,pe=E?`${E.x},${E.y}`:"",ge=k||pe,Se=L.clone();return re!=null&&(Se.geometry=Rn.fromExtent(re)),{extent:re,feature:L,target:Se,key:i,name:ge,sourceIndex:o}}function z8(t,e){return t.filter(Boolean).map(i=>mde(i,e))}var UI;let Dn=UI=class extends eM{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.language=null,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,i)=>ode({source:this,...e},i),this.getSuggestions=(e,i)=>ade({source:this,...e},i)}clone(){return new UI({apiKey:this.apiKey,autoNavigate:this.autoNavigate,categories:this.categories?dt(this.categories):null,countryCode:this.countryCode,filter:this.filter,language:this.language,locationType:this.locationType,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?dt(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?.clone()??null,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,suffix:this.suffix,suggestionsEnabled:this.suggestionsEnabled,url:this.url,withinViewEnabled:this.withinViewEnabled,zoomScale:this.zoomScale})}};P([R()],Dn.prototype,"apiKey",void 0),P([R()],Dn.prototype,"categories",void 0),P([R()],Dn.prototype,"countryCode",void 0),P([R({json:{write:!0}})],Dn.prototype,"defaultZoomScale",void 0),P([R()],Dn.prototype,"localSearchDisabled",void 0),P([R()],Dn.prototype,"language",void 0),P([R()],Dn.prototype,"locationType",void 0),P([R({json:{write:!0}})],Dn.prototype,"name",void 0),P([R({json:{write:!0}})],Dn.prototype,"placeholder",void 0),P([R()],Dn.prototype,"searchTemplate",void 0),P([R({json:{write:!0}})],Dn.prototype,"singleLineFieldName",void 0),P([R({json:{read:{source:"suggest"},write:{target:"suggest"}}})],Dn.prototype,"suggestionsEnabled",void 0),P([R({json:{write:!0}})],Dn.prototype,"url",void 0),P([R({json:{write:!0}})],Dn.prototype,"zoomScale",void 0),Dn=UI=P([Ge("esri.widgets.Search.LocatorSearchSource")],Dn);const O8=Dn;function o_e(t){return{geometryType:qP(t[0]),geometries:t.map(e=>e.toJSON())}}function gde(t,e,i){const r=Uce(e);return t.map(o=>{const h=r.fromJSON(o);return h.spatialReference=i,h})}let wu=class extends Lt{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(o=>o.toJSON()),i=this.geometries[0],r={};return r.outSR=oz(this.outSpatialReference),r.inSR=oz(i.spatialReference),r.geometries=JSON.stringify({geometryType:qP(i),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(r.transformForward=this.transformForward),r}};P([R()],wu.prototype,"geometries",void 0),P([R({type:Rt,json:{read:{source:"outSR"}}})],wu.prototype,"outSpatialReference",void 0),P([R()],wu.prototype,"transformation",void 0),P([R()],wu.prototype,"transformForward",void 0),wu=P([Ge("esri.rest.support.ProjectParameters")],wu);const yde=Ds(wu);async function _de(t,e,i){e=yde(e);const r=Hw(t),o={...r.query,f:"json",...e.toJSON()},h=e.outSpatialReference,d=qP(e.geometries[0]),a=iM(o,i);return wn(r.path+"/project",a).then(({data:{geometries:_}})=>gde(_,d,h))}const R8=()=>ui.getLogger("esri.widgets.support.geolocationUtils"),vde={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function bde(){const t=!!Ve("esri-geolocation");return t||R8().warn("geolocation-unsupported","Geolocation unsupported."),t}function xde(){const t=window.isSecureContext;return t||R8().warnOnce("insecure-context","Geolocation requires a secure origin."),t}function Rz(){return bde()&&xde()}function wde(t){return t??=vde,new Promise((i,r)=>{setTimeout(()=>r(new Ot("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(i,r,t??void 0)})}function Sde(t,e){const{position:i,view:r}=t,o=Tde(i),h=o?.coords;if(!h)throw new Ot("geometry-service:no-coords","Geolocation has no coordinates");return Ede(Cde(h),r,e)}function Tde(t){const e=t&&t.coords||{},i={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed,toJSON:()=>({})};return t&&{coords:i,timestamp:t.timestamp,toJSON:()=>({})}}function Cde({longitude:t,latitude:e,altitude:i}){return new oi({longitude:t,latitude:e,z:i||void 0,spatialReference:{wkid:4326}})}function Ede(t,e,i){if(!e)return Promise.resolve(t);const r=e.spatialReference;return r.isWGS84?Promise.resolve(t):r.isWebMercator?Promise.resolve(Vb(t)):Ide(i).then(o=>{if(!o)throw new Ot("geometry-service:missing-url","Geometry service URL is missing");const h=new wu({geometries:[t],outSpatialReference:r});return _de(o,h,i).then(d=>d[0])})}function Ide(t){if(Ai.geometryServiceUrl)return Promise.resolve(Ai.geometryServiceUrl);const e=tt.getDefault();return e.load(t).catch(()=>{}).then(()=>e.helperServices?.geometry?.url)}function $de(t,e,i){return t.goTo(e,i)}const Pde=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),this.goToOverride=null,this.view=null}callGoTo(r){const{view:o}=this;return t4(o),this.goToOverride?this.goToOverride(o,r):$de(o,r.target,r.options)}};return P([R()],i.prototype,"goToOverride",void 0),P([R()],i.prototype,"view",void 0),i=P([Ge("esri.widgets.support.GoTo")],i),i};function Gn(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const Lz="highlight",sx=nr.ofType({key:t=>t.layer?"layer":"locator",base:eM,typeMap:{layer:uf,locator:O8}}),Fz=Rt.WGS84,Mde="esri/images/search/search-symbol-32.png",kde=/<[\s\S]*?>/g,Yp=-1;var Yf;let ri=(Yf=class extends Pde(CF){constructor(e){super(e),this._defaultPopupTemplate=new O0({content:"{Match_addr}"}),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultSources=new sx,this.defaultSymbols={point:new hs({url:bP(Mde),size:24,width:24,height:24}),polyline:new Wn({color:[130,130,130,1],width:2}),polygon:new ll({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=tt.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new sx,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){this.addHandles([_l(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),xD),_l(()=>this.messages,()=>{this._defaultPopupTemplate.title=this.messages?.searchResult??"",this._update()},xD)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:Yp}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:i,includeDefaultSources:r}=this,o=typeof r=="function"?r.call(null,{sources:e,defaultSources:i}):r?i.concat(e):e,h=this._get("allSources")||new sx;return h.removeAll(),h.addMany(o.filter(Boolean)),h}get defaultPopupTemplate(){return this._defaultPopupTemplate}set defaultPopupTemplate(e){this._overrideIfSome("defaultPopupTemplate",e)}get locationEnabled(){return this._get("locationEnabled")||Rz()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const i=Rz();if(e&&!i){const r=new Ot("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});ui.getLogger(this).error(r)}this._override("locationEnabled",!!e&&i)}get placeholder(){const{allSources:e,activeSourceIndex:i,allPlaceholder:r}=this;return i===Yp?r??"":e.at(i)?.placeholder??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:i}=this;e&&i&&e.graphics.remove(i),this._set("resultGraphic",null)}search(e,i){this.emit("search-start"),this.clearGraphics();const r=this._createSuggestionForSearch(e),o=(async()=>{try{await this.when();const h=await this._getResultsFromSources(r,i);if(i?.signal?.aborted)return null;const d={activeSourceIndex:this.activeSourceIndex,searchTerm:r.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(d,h,r);const a=this._getFirstResult(d.results),_=r.location&&a?a.name:r.text,T=_?.replaceAll(kde,"");return this._set("searchTerm",T),(r.key&&typeof r.sourceIndex=="number"||r.location)&&this._set("selectedSuggestion",r),this._set("results",d.results),this._set("resultCount",d.results.reduce((E,k)=>E+(k.results?.length??0),0)),this.emit("search-complete",d),await this._selectFirstResult(a),d}finally{this._clearSearching()}})();return this._searching=o,o}async searchNearby(e){if(!this.locationEnabled){const r=new Ot("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw ui.getLogger(this).error(r),r}const i=(async()=>{try{const r=await wde(),o=await Sde({position:r,view:this.view},e);return await this.search(o,e)}finally{this._clearSearching()}})();return this._searching=i,i}async select(e){if(this.clearGraphics(),!e){const je=new Ot("select:missing-parameter","Cannot select without a searchResult.",{value:e});throw ui.getLogger(this).error(je),je}const{view:i}=this,r=Gn(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),o=r!=null?this.allSources.at(r):null;if(!o){const je=new Ot("select:missing-source","Cannot select without a source.",{source:o});throw ui.getLogger(this).error(je),je}const h=o instanceof uf?this._getLayerSourcePopupTemplate(o):o.popupTemplate,d=o.resultSymbol||this._getDefaultSymbol(e),a=Gn(o,"resultGraphicEnabled")?o.resultGraphicEnabled:this.resultGraphicEnabled,_=Gn(o,"autoNavigate")?o.autoNavigate:this.autoNavigate,T=Gn(o,"popupEnabled")?o.popupEnabled:this.popupEnabled,E=T?h||this.popupTemplate||this.defaultPopupTemplate:null,{feature:k}=e;if(!k){const je=new Ot("select:missing-feature","Cannot select without a feature.",{feature:k});throw ui.getLogger(this).error(je),je}const{attributes:L,geometry:O,layer:H,sourceLayer:re}=k,pe=O?Mz(O):null,ge={layerViewQuery:this._getLayerView(k),elevationQuery:i&&pe!=null?phe(pe,i):Promise.resolve(pe)},Se=await yy(ge),Pe=Se.layerViewQuery.value,Re=Se.elevationQuery.value;d instanceof Ri&&(d.text=e.name);const ze=i&&_?e.target||e.extent:null;await(ze!=null?this._goToSearchResult(ze):Promise.resolve());const Xe=Pe?k:new qn({geometry:O,symbol:d,attributes:L,layer:H,sourceLayer:re,popupTemplate:E}),yt=kz(i),mt=yt&&T&&Xe.getEffectivePopupTemplate(yt.defaultPopupTemplateEnabled);return mt&&await i?.openPopup({features:[Xe],location:Re}),Pe&&yhe(Pe)&&!mt&&this._highlightFeature({graphic:Xe,layerView:Pe}),!Pe&&a&&i&&i.graphics.push(Xe),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",Xe),this.emit("select-result",{result:e,source:o,sourceIndex:r}),e}async suggest(e,i,r){const o=e||this.searchTerm;this.emit("suggest-start",{searchTerm:o}),await this._suggestTimer(i,r);const h=await this._suggestImmediate(o,r);return this._set("suggestions",h?.results),this._set("suggestionCount",h?.results.reduce((d,a)=>d+(a.results?.length??0),0)??null),this.emit("suggest-complete",h),h}async when(e,i){await ree(()=>!this.updating)}async _update(){const{portal:e,view:i}=this;if(this.includeDefaultSources){const r=this._updatingPromise=yy([e?.load(),i?.when()]);if(this.destroyed||(await r,r!==this._updatingPromise))return}this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const e=this.portal?.helperServices?.geocode;return e?e.map(i=>{if(i.placefinding===!1)return;const r=Oz(i.url)&&eF(i.url)?{url:ude}:null,o=O8.fromJSON({...i,...r}),h=o.url;if(Oz(h)||cde(h)||lde(h)){const d=o.outFields??["Addr_type","Match_addr","StAddr","City"],a=(o.placeholder||this.messages?.placeholder)??"",_=typeof o.defaultZoomScale=="number"?o.defaultZoomScale:2500;o.singleLineFieldName="SingleLine",o.outFields=d,o.placeholder=a,o.defaultZoomScale=_}return o.singleLineFieldName?o:void 0}).filter(yb):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e?.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,i){const r=this.view?.map;return e.map(o=>{const h=r.findLayerById(o.id);if(!h)return;const d=this._getLayerJSON(o),a=uf.fromJSON(d);return a.placeholder=i,this._getLayer(h,d).then(_=>{a.layer=_}),a}).filter(yb).toArray()}_getTableSources(e,i){const r=this.view?.map;return e.map(o=>{if(!o.id)return;const h=r.findTableById(o.id);if(!h)return;const d=this._getLayerJSON(o),a=uf.fromJSON(d);return a.placeholder=i,this._getLayer(h,d).then(_=>{a.layer=_}),a}).filter(yb).toArray()}_convertApplicationProperties(){const e=this.view?.map,i=e?.applicationProperties?.viewing?.search;if(!i)return[];const{enabled:r,hintText:o,layers:h,tables:d}=i;return r?[...this._getLayerSources(h,o),...this._getTableSources(d,o)]:[]}async _getSubLayer(e,i){if(await e.load(),!e.allSublayers)throw new Error;const r=e.allSublayers.find(h=>h.id===i.subLayer);if(!r)throw new Error;const o=await r.createFeatureLayer?.();if(!o)throw new Error;return this._createdFeatureLayers.push(o),o}async _getBuildingSubLayer(e,i){await e.load();const r=e.allSublayers.find(o=>o.id===i.subLayer);if(r?.type!=="building-component")throw new Error;if(await r.load(),r.associatedLayer==null)throw new Error;return await r.associatedLayer.load(),r}async _getLayer(e,i){if(e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature")return e;if(e.type==="map-image")try{return await this._getSubLayer(e,i)}catch{const o=new Ot("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return ui.getLogger(this).error(o),null}return e.type==="building-scene"?this._getBuildingSubLayer(e,i):null}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:i}=this;this._destroyFeatureLayers(),e.removeAll(),i&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){const e=kz(this.view),{resultGraphic:i}=this;if(!e||!i)return;const r="selectedFeature"in e,o=r?e.selectedFeature:null;r&&o&&o===i&&ghe(this.view?.popup,this.view?.popupElement)}_suggestTimer(e,i){const r=e??this.suggestionDelay;return n4(r,null,i?.signal)}_createLocationForSearch(e){return e instanceof qn&&e.geometry?Mz(e.geometry):e instanceof oi?e:Array.isArray(e)&&e.length===2?new oi({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&Gn(e,"key")&&Gn(e,"text")&&Gn(e,"sourceIndex"))return e;const i=this._createLocationForSearch(e),r=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:o,selectedResult:h}=this,d=!e&&o&&h,a=d&&o.key===h.key&&o.sourceIndex===h.sourceIndex,_=d&&o.location;return a||_?o:{location:i,text:i?"":r,sourceIndex:null,key:null}}_getFirstResult(e){return Hx(e,({results:i})=>i?.[0])??null}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,i){await this.when();const r=await this._getSuggestionsFromSources(e,i);if(i?.signal?.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(o,r),o}_formatSourceResponse(e,i,r){const o=i?.value||[],h=i?.error,d=this.allSources.at(r);if(h){const a={sourceIndex:r,source:d,error:h};e.errors.push(a),ui.getLogger(this).error(h),e.numErrors++}else{const a={sourceIndex:r,source:d,results:o};e.results.push(a),e.numResults+=o.length}}_formatResponse(e,i,r){if(i)if(e.activeSourceIndex===Yp){const o=r&&Gn(r,"sourceIndex")&&r.sourceIndex!==-1?r.sourceIndex:void 0;i.forEach((h,d)=>{const a=o!==void 0?o:d;this._formatSourceResponse(e,h,a)})}else this._formatSourceResponse(e,i[0],e.activeSourceIndex)}async _getResultsFromSources(e,i){const{allSources:r}=this,o=!e.location&&Gn(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,h=[];if(!r.length){const d=new Ot("search:no-sources-defined","At least one source is required.",{allSources:r});throw ui.getLogger(this).error(d),d}return o===Yp?r.forEach((d,a)=>{h.push(this._getResultsFromSource(e,a,i))}):h.push(this._getResultsFromSource(e,o,i)),yy(h)}async _getSuggestionsFromSources(e,i){const{allSources:r,activeSourceIndex:o}=this,h=[];if(!r.length){const d=new Ot("suggest:no-sources-defined","At least one source is required.",{allSources:r});throw ui.getLogger(this).error(d),d}return o===Yp?r.forEach((d,a)=>{h.push(this._getSuggestionsFromSource(e,a,i))}):h.push(this._getSuggestionsFromSource(e,o,i)),yy(h)}async _getResultsFromSource(e,i,r){const o=i!=null?this.allSources.at(i):null;if(!o)return null;const{location:h=null}=e,d=this.view?.spatialReference??Fz,a=Gn(o,"maxResults")?o.maxResults:this.maxResults,_=!!(o instanceof uf&&Gn(o,"exactMatch"))&&o.exactMatch,{view:T}=this;return o.getResults?.({exactMatch:_,location:h,maxResults:a,sourceIndex:i,spatialReference:d,suggestResult:e,view:T},r)}async _getSuggestionsFromSource(e,i,r){const o=this.allSources.at(i);if(!o)return null;e??="";const h=Gn(o,"suggestionsEnabled")?o.suggestionsEnabled:this.suggestionsEnabled,d=e?.length,a=Gn(o,"minSuggestCharacters")?o.minSuggestCharacters:this.minSuggestCharacters;if(h&&e.trim()&&d>=a){const _=this.view?.spatialReference||Fz,T=Gn(o,"maxSuggestions")?o.maxSuggestions:this.maxSuggestions,{view:E}=this,k=!!(o instanceof uf&&Gn(o,"exactMatch"))&&o.exactMatch;return o.getSuggestions?.({view:E,sourceIndex:i,suggestTerm:e,spatialReference:_,maxSuggestions:T,exactMatch:k},r)}return null}_getLayerSourcePopupTemplate(e){const{layer:i}=e;if(i)return Gn(e,"popupTemplate")?e.popupTemplate:i.popupTemplate}_getSourceIndexOfResult(e){return Hx(this.results??[],({results:i,sourceIndex:r})=>i?.includes(e)?r:null)??null}async _goToSearchResult(e){this._abortGoTo();const i=new AbortController;this._gotoController=i;const r={target:{target:e},options:{signal:i.signal}};e||(r.options.animate=!1),await this.callGoTo(r),this._gotoController=null}_getDefaultSymbol(e){const{defaultSymbols:i}=this,r=e.feature?.geometry;if(r==null)return null;switch(r.type){case"point":case"multipoint":return i.point;case"polyline":return i.polyline;case"extent":case"polygon":return i.polygon;default:return null}}_removeHighlight(){this.removeHandles(Lz)}async _getLayerView(e){const{view:i}=this;if(!e||!i)return null;const{layer:r,sourceLayer:o}=e,h=r??o;return h&&h.type!=="building-component"&&h.type!=="subtype-sublayer"?(await i.when(),i.whenLayerView(h)):null}_highlightFeature(e){const{graphic:i,layerView:r}=e,{attributes:o,layer:h,sourceLayer:d}=i,a=h??d,{objectIdField:_}=a,T=(_&&o?.[_])??null,E=r.highlight(T??i);this.addHandles(E,Lz)}_setResultFloor(e){const{view:i}=this,r=e.feature?.attributes,o=e.feature?.sourceLayer;if(o&&"floorInfo"in o&&o?.floorInfo?.floorField&&r){const h=r[o.floorInfo.floorField];i?.emit("select-result-floor",h)}}},Yf.ALL_INDEX=Yp,Yf);P([R()],ri.prototype,"_searching",void 0),P([R()],ri.prototype,"_updatingPromise",void 0),P([R({readOnly:!0,value:null})],ri.prototype,"activeSource",null),P([R()],ri.prototype,"activeSourceIndex",null),P([R()],ri.prototype,"allPlaceholder",null),P([R({readOnly:!0})],ri.prototype,"allSources",null),P([R()],ri.prototype,"autoNavigate",void 0),P([R()],ri.prototype,"autoSelect",void 0),P([R({type:O0})],ri.prototype,"defaultPopupTemplate",null),P([R({readOnly:!0})],ri.prototype,"defaultSources",void 0),P([R()],ri.prototype,"defaultSymbols",void 0),P([R()],ri.prototype,"includeDefaultSources",void 0),P([R()],ri.prototype,"locationEnabled",null),P([R()],ri.prototype,"maxInputLength",void 0),P([R()],ri.prototype,"maxResults",void 0),P([R()],ri.prototype,"maxSuggestions",void 0),P([R()],ri.prototype,"messages",void 0),P([R()],ri.prototype,"minSuggestCharacters",void 0),P([R({readOnly:!0})],ri.prototype,"placeholder",null),P([R()],ri.prototype,"popupEnabled",void 0),P([R({type:O0})],ri.prototype,"popupTemplate",void 0),P([R({type:tt})],ri.prototype,"portal",void 0),P([R()],ri.prototype,"resultCount",void 0),P([R()],ri.prototype,"resultGraphicEnabled",void 0),P([R({readOnly:!0})],ri.prototype,"resultGraphic",void 0),P([R({readOnly:!0})],ri.prototype,"results",void 0),P([R({readOnly:!0})],ri.prototype,"selectedSuggestion",void 0),P([R()],ri.prototype,"searchAllEnabled",void 0),P([R({readOnly:!0})],ri.prototype,"selectedResult",void 0),P([R()],ri.prototype,"searchTerm",null),P([R({type:sx})],ri.prototype,"sources",void 0),P([R({readOnly:!0})],ri.prototype,"state",null),P([R()],ri.prototype,"suggestionDelay",void 0),P([R()],ri.prototype,"suggestionCount",void 0),P([R({readOnly:!0})],ri.prototype,"suggestions",void 0),P([R()],ri.prototype,"suggestionsEnabled",void 0),P([R({readOnly:!0})],ri.prototype,"updating",null),P([R()],ri.prototype,"view",void 0),P([R()],ri.prototype,"clear",null),ri=P([Ge("esri.widgets.Search.SearchViewModel")],ri);const Ade=ri,Xp=(t,e)=>{const r=bm().manager;r.onLoaded(()=>r.onLifecycle(()=>_4(t,e,o.emit)));const o=d$();return o};class Dde extends f${constructor(e,i){super(e),this.Y=new Map,this.A=void 0,this.#t=WL();const r=this;r.#i=i,r.Z(),r.setProvisionalExports(zde(e,new WeakRef(r),e.M.length-1,r.instance,r.Y),!1),BO(e,o=>{if(o){const h=_l(()=>e[o],d=>{if(d===r.instance)return;const a=r.instance;r.exports=d,r.instance=d,r.Y.forEach((_,T)=>e.requestUpdate(_,a[T])),r.#e&&a.destroy(),r.#e=!1},{sync:!0});r.onDestroy(h.remove)}},r.exports)}#e;#t;#i;get exports(){return YL(this.#t),super.exports}set exports(e){super.exports=e,this.#t.notify()}Z(){const e=this;e.instance="prototype"in e.#i&&"declaredClass"in e.#i.prototype?new e.#i:e.#i(),e.#e=!0}hostConnected(){this.exports=this.instance}hostDestroy(){this.#e&&this.instance.destroy?.()}}const zde=(t,e,i,r,o)=>new Proxy(r,{get:(h,d)=>{const a=h[d];if(typeof d=="symbol"||o.has(d))return a;const _=t.M[i];return _.A=d,h$(t,T=>{if(_.A=void 0,T!==void 0){const E=T.key;o.set(d,E);const k=t.constructor.getPropertyOptions(E),L=d!==E&&E.toLowerCase().includes("disable");Ode(e,k,d,E,L),k.i===void 0&&Rde(k,i,d,L)}},a)}}),Ode=(t,e,i,r,o,h)=>h=_l(()=>{const d=t.deref();return d===void 0||d.component.manager.destroyed?h=h.remove():d.exports[i]},(d,a)=>{if(!h)return;t.deref().component?.requestUpdate(r,o?!a:a),e.c=!1},{sync:!0}),Rde=(t,e,i,r)=>{t.d.get=function(){const o=this.M[e]?.exports[i];return r?!o:o},t.d.set=function(o){const h=this.M[e];h.A!==i&&(h.exports[i]=r?!o:o)}};/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */function Nz(t){t?.abort()}/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const Lde={"top-left":"top-left","top-right":"top-right","bottom-left":"bottom-left","bottom-right":"bottom-right","bottom-leading":"bottom-start","bottom-trailing":"bottom-end","top-leading":"top-start","top-trailing":"top-end"},Fde=["manual"];function ib(t){t.el.childElem&&(t.el.childElem.ownedBy=t.el),t.position&&Fde.includes(t.position)?t.el.removeAttribute("slot"):t.position&&(t.el.slot=Lde[t.position]);const e=Nde(t);if(!e){const i=Vde(t);if(!i){L8(t);return}return jz(i,t,!0),i}return Bde(e,t.el.parent)||(t.el.parent=e,e.localName==="arcgis-expand"?jde(e,t):e.localName==="arcgis-placement"?Ude(e,t):jz(e,t,!1)),e}function Nde({el:t}){for(let e=t.parentElement;e;e=e?.parentElement??null){if(Bz.has(e.localName))return e;if("ownedBy"in e&&e.ownedBy instanceof HTMLElement&&Bz.has(e.ownedBy.localName))return e.ownedBy}}const Bz=new Set(["arcgis-map","arcgis-scene","arcgis-link-chart","arcgis-expand","arcgis-placement"]);function Bde(t,e){if(t!==e)return!1;const i=t.localName;return i==="arcgis-expand"||i==="arcgis-placement"}function Zw(t,e,i="arcgisReady"){const r=t;if(r.view)e(r.view);else{let o=function(h){h.target===t&&(Zw(t,e,i),t.removeEventListener(i,o))};t.addEventListener(i,o)}}const jde=(t,e)=>Zw(t,i=>{const r=sM(e);e.el.shadowRoot?t.content=e.el:e.el.childElem&&t.content!=null&&r.append(e.el.childElem),e.el.view=i}),Ude=(t,e)=>Zw(t,i=>{const r=sM(e);e.el.childElem&&r.append(e.el.childElem),e.el.view=i}),jz=(t,e,i)=>Zw(t,r=>{i&&L8(e),e.el.view=r,e.referenceElement=t},"arcgisViewReadyChange");function L8(t){t.el.childElem&&sM(t).append(t.el.childElem)}function sM(t){return t.el.shadowRoot??t.el}function Vde(t,e){const i=t.referenceElement;if(typeof i!="string")return i??void 0;const r=i.includes("#")||i.includes(".")||i.includes("["),o=t.el.getRootNode();return(r?void 0:o.querySelector(`#${i}`))??o.querySelector(i)??void 0}let Gde=class extends f${#e;constructor(e){super(e),this.setProvisionalExports(void 0)}hostConnected(){this.component.manager.loadedCalled&&ib(this.component)}hostLoad(){this.component.manager.destroyed}hostLoaded(){const{el:e}=this.component,i=e.shadowRoot?.firstElementChild??e.firstElementChild??void 0;e.childElem??=i,this.#e=GC(()=>this.component.view!=null,()=>{this.component.arcgisReady.emit()},{once:!0,initial:!0,sync:!0}),e.isConnected&&ib(this.component)}hostDisconnected(){typeof this.component.el.childElem=="object"&&this.component.view?.ui?.remove(this.component.el.childElem),this.#e?.remove()}hostUpdate(e){e.has("position")&&this.component.el.childElem!=null&&typeof this.component.position=="string"&&ib(this.component),e.has("referenceElement")&&ib(this.component)}};/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const qde=(t,e)=>i=>Zde(i,t);class Hde extends Dde{#e=void 0;constructor(e,i){super(e,i),new Gde(this.component)}hostLoad(){this.#e=_l(()=>this.component.el.view,e=>{this.instance.view=e,this.instance.map=e?.map},{sync:!0,initial:!0})}hostDestroy(){this.#e?.remove(),super.hostDestroy()}}const Zde=QO(Hde);/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const Wde=oR(wQ);/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const Jp="arcgis-search",Kp={base:Jp,autocomplete:`${Jp}__autocomplete`,dropdown:`${Jp}__dropdown`,container:`${Jp}__container`,form:`${Jp}__form`,submitButton:`${Jp}__submit-button`},Yde=Ui`.esri-widget__heading{color:var(--calcite-color-text-2);margin:0 0 .5rem;font-weight:var(--calcite-font-weight-semibold)}h1.esri-widget__heading{font-size:var(--calcite-font-size-xl)}h2.esri-widget__heading{font-size:var(--calcite-font-size-md)}h3.esri-widget__heading,h4.esri-widget__heading,h5.esri-widget__heading,h6.esri-widget__heading{font-size:var(--calcite-font-size)}.esri-widget{--esri-widget-padding-x: 15px;--esri-widget-padding-y: var(--calcite-spacing-md);--esri-widget-padding: var(--esri-widget-padding-y) var(--esri-widget-padding-x);box-sizing:border-box;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget *,.esri-widget :before,.esri-widget :after{box-sizing:inherit}.esri-widget.esri-widget--disabled>*{opacity:.4;pointer-events:none}.esri-widget.esri-widget--compact{--esri-widget-padding-y: 0;--esri-widget-padding-x: 0}.esri-widget__anchor{color:var(--calcite-color-text-2)}.esri-widget__anchor:hover{color:var(--calcite-color-text-3)}.esri-widget__anchor:hover,.esri-widget__anchor:focus{text-decoration:underline}.esri-widget__anchor--disabled{opacity:.4;pointer-events:none}.esri-widget__header{background-color:var(--calcite-color-foreground-1);flex:1 0 100%;justify-content:space-between;align-items:center;width:100%;min-height:48px;padding:12px 0 12px 15px;display:flex}.esri-widget__header .esri-widget__heading{width:calc(100% - 48px);text-align:initial;color:var(--calcite-color-text-1);align-items:center;margin:0;padding:0;display:flex}.esri-widget__header-button{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);border:none;flex:0 0 48px;justify-content:center;align-self:stretch;align-items:center;width:48px;padding:0;display:flex}.esri-widget__footer{background-color:var(--calcite-color-foreground-1);justify-content:center;align-items:center;width:100%;min-height:48px;display:flex}.esri-widget__footer-pagination{color:var(--calcite-color-text-2);justify-content:space-between;align-items:center;display:flex}.esri-widget__footer-pagination-previous-button,.esri-widget__footer-pagination-next-button{cursor:pointer;background-color:var(--calcite-color-foreground-1);border:0;margin:0 7px;padding:12px 15px;transition:background-color .125s ease-in-out}.esri-widget__footer-pagination-previous-button:hover,.esri-widget__footer-pagination-previous-button:focus,.esri-widget__footer-pagination-next-button:hover,.esri-widget__footer-pagination-next-button:focus{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1)}.esri-menu{visibility:hidden;z-index:1;background-clip:padding;background-color:var(--calcite-color-foreground-1);background-clip:padding-box;width:100%;max-height:0;margin:2px 0 0;padding:0;font-size:var(--calcite-font-size);line-height:var(--calcite-spacing-xl);position:absolute;top:100%;left:0;overflow:hidden;box-shadow:0 1px 2px #0000004d}.esri-menu .esri-menu__header{color:var(--calcite-color-text-inverse);background-color:var(--calcite-color-inverse);padding:6px 12px}.esri-menu__list{margin:0;padding:0;list-style:none}.esri-menu__list-item{cursor:pointer;border-top:1px solid #adadad4d;border-left:3px solid #0000;padding:.8em 1em}.esri-menu__list-item [class^=esri-icon-],.esri-menu__list-item [class*=" esri-icon-"]{padding-right:2.8px}.esri-menu__list-item:first-child{border-top:none}.esri-menu__list-item--focus,.esri-menu__list-item:hover,.esri-menu__list-item:focus{background-color:var(--calcite-color-foreground-1)}.esri-menu__list-item:active{background-color:var(--calcite-color-foreground-current)}.esri-menu__list-item--active,.esri-menu__list-item--active:hover,.esri-menu__list-item--active:focus{background-color:var(--calcite-color-foreground-1);border-left-color:var(--calcite-color-brand)}.esri-widget__table{border-collapse:collapse;color:var(--calcite-color-text-1);border:none;width:100%;line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget__table tr:nth-child(odd){background-color:var(--calcite-color-transparent)}.esri-widget__table tr:nth-child(2n){background-color:var(--calcite-color-transparent-press)}.esri-widget__table tr a{color:var(--calcite-color-text-2)}.esri-widget__table tr a:hover,.esri-widget__table tr a:focus{color:var(--calcite-color-text-1)}.esri-widget__table tr td,.esri-widget__table tr th{vertical-align:top;word-break:break-word;padding:.5em .7em;font-size:var(--calcite-font-size-sm);font-weight:var(--calcite-font-weight-regular)}.esri-widget__table tr th{text-align:left;border-right:3px solid #0000000d;width:50%}.esri-widget__table tr td{width:50%}.esri-input{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1);border:1px solid #959595;font-size:var(--calcite-font-size)}.esri-input::-ms-clear{display:none}.esri-input::placeholder{opacity:1;color:var(--calcite-color-text-2)}.esri-input:placeholder-shown{text-overflow:ellipsis}.esri-input[type=text],.esri-input[type=password],.esri-input[type=number]{height:32px;padding:0 .5em}calcite-combobox.esri-input{border:none}.esri-widget__content--empty{text-align:center;color:var(--calcite-color-border-input);flex-flow:column wrap;align-items:center;padding:18px 22px;display:flex}.esri-widget__content--empty h1.esri-widget__heading,.esri-widget__content--empty h2.esri-widget__heading,.esri-widget__content--empty h3.esri-widget__heading,.esri-widget__content--empty h4.esri-widget__heading,.esri-widget__content--empty h5.esri-widget__heading{font-weight:var(--calcite-font-weight-regular)}.esri-widget__content-illustration--empty{width:128px;padding:1rem 0}.esri-widget__content-icon--empty{width:32px;padding:.5rem 0}.esri-select{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background:var(--calcite-color-foreground-1) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='-8 -8 32 32' width='32' height='32'%3E%3Cpath d='M8 11.207l-4-4V5.793l4 4 4-4v1.414z' fill='%23adadad' fillrule='nonzero'/%3E%3C/svg%3E") 100% no-repeat;border:1px solid #959595;border-radius:0;width:100%;height:32px;margin:0;padding:0 .5em;font-family:inherit;font-size:.85em;display:block}.esri-select[disabled]{cursor:auto}.esri-select::-ms-expand{display:none}.esri-disabled a,.esri-disabled [role=menu],.esri-disabled [role=checkbox],.esri-disabled [class^=esri-icon-],.esri-disabled [class*=" esri-icon-"]{color:var(--calcite-color-text-3)}.keynav-mode .esri-widget:focus,.keynav-mode .esri-widget :focus{z-index:1;outline-offset:2px;outline:2px solid #adadad}.esri-widget__loader-animation{border:.15em solid #adadad4d;border-top-color:var(--calcite-color-border-input);border-radius:100%;width:1em;height:1em;font-size:var(--calcite-font-size-md);animation:1.25s linear infinite esri-rotate;display:block;transform:translateZ(0)}:dir(rtl) .esri-widget__table th{text-align:right;border-left:3px solid #0000000d;border-right:none}:dir(rtl) .esri-select{background-position:0}:dir(rtl) .esri-menu__list-item{border-left:none;border-right:3px solid #0000}:dir(rtl) .esri-menu__list-item [class^=esri-icon-],:dir(rtl) .esri-menu__list-item [class*=" esri-icon-"]{padding-left:2px;padding-right:0}:dir(rtl) .esri-menu__list-item--active{border-right-color:var(--calcite-color-brand)}.esri-icon-font-fallback-text{clip:rect(0 0 0 0);width:1px;height:1px;position:absolute;overflow:hidden}.esri-rotating{animation:1.25s linear infinite esri-rotate;transform:translateZ(0)}.esri-clearfix:before,.esri-clearfix:after{content:" ";display:table}.esri-clearfix:after{clear:both}.esri-interactive{cursor:pointer}.esri-invisible{visibility:hidden!important}.esri-offscreen{position:absolute;top:-999em;left:-999em}.esri-match-height{flex-direction:column;flex:auto;display:flex;overflow:hidden}.esri-hidden{display:none!important}:host{width:240px}.arcgis-search{--arcgis-internal-search-width: 240px;display:flex;flex-flow:row nowrap;align-items:center;justify-content:center;width:100%}.arcgis-search__dropdown{--calcite-color-border-1: var(--calcite-color-border-input);--calcite-dropdown-width: var(--arcgis-internal-search-width);width:31px}.arcgis-search__autocomplete{flex:1}.arcgis-search__container{display:flex;position:relative;flex:1 0 100%;flex-flow:row nowrap;align-items:stretch}.arcgis-search__form{display:flex;flex:1 0;flex-flow:row nowrap;align-items:stretch;margin:0;padding:0}.arcgis-search__submit-button{position:absolute;margin:-1px;border-width:0;padding:0;width:1px;height:1px;overflow:hidden;white-space:nowrap;clip:rect(0,0,0,0)}`,Xde=qde(Ade),B1=class B1 extends ji{constructor(){super(...arguments),this.viewModel=Xde(this),this._currentLocationValue="search-use-current-location",this._autocompleteEl=void 0,this._searchResultRendererEl=void 0,this._suggestController=void 0,this._searchController=void 0,this._lastSearchTerm="",this.messages=Wde({blocking:!0}),this._locateFailed=!1,this._showNoResults=!1,this.view=this.viewModel.view,this.goToOverride=this.viewModel.goToOverride,this.icon="search",this.activeMenu="none",this.activeSourceIndex=this.viewModel.activeSourceIndex,this.allPlaceholder=this.viewModel.allPlaceholder,this.allSources=this.viewModel.allSources,this.autoNavigateDisabled=this.viewModel.autoNavigate,this.autoSelectDisabled=this.viewModel.autoSelect,this.defaultSources=this.viewModel.defaultSources,this.disabled=!1,this.includeDefaultSourcesDisabled=this.viewModel.includeDefaultSources,this.locationDisabled=this.viewModel.locationEnabled,this.maxResults=this.viewModel.maxResults,this.maxSuggestions=this.viewModel.maxSuggestions,this.minSuggestCharacters=this.viewModel.minSuggestCharacters,this.popupDisabled=this.viewModel.popupEnabled,this.popupTemplate=this.viewModel.popupTemplate,this.portal=this.viewModel.portal,this.resultGraphic=this.viewModel.resultGraphic,this.resultGraphicDisabled=this.viewModel.resultGraphicEnabled,this.results=this.viewModel.results,this.searchAllDisabled=this.viewModel.searchAllEnabled,this.searchTerm=this.viewModel.searchTerm,this.selectedResult=this.viewModel.selectedResult,this.sources=this.viewModel.sources,this.suggestions=this.viewModel.suggestions,this.suggestionsDisabled=this.viewModel.suggestionsEnabled,this.autoDestroyDisabled=!1,this.state=this.viewModel.state,this.arcgisPropertyChange=hW()("state"),this.arcgisReady=vt(),this.arcgisSearchClear=Xp(()=>this.viewModel,"search-clear"),this.arcgisSearchComplete=Xp(()=>this.viewModel,"search-complete"),this.arcgisSearchStart=Xp(()=>this.viewModel,"search-start"),this.arcgisSelectResult=Xp(()=>this.viewModel,"select-result"),this.arcgisSuggestComplete=Xp(()=>this.viewModel,"suggest-complete"),this.arcgisSuggestStart=Xp(()=>this.viewModel,"suggest-start")}get _isDisabled(){const{state:e}=this.viewModel;return e==="disabled"||e==="loading"||this.disabled}get _showCurrentLocation(){return!this.locationDisabled&&!this.searchTerm?.trim()}get _effectiveActiveMenu(){return this._isDisabled?"none":this.activeMenu}get activeSource(){return this.viewModel?.activeSource}clear(){this._locateFailed=!1,this.viewModel.clear()}async destroy(){await this.manager.destroy(),await this._searchResultRendererEl?.destroy(),this._cancelQueries()}async search(e){this._cancelQueries();const i=new AbortController,{signal:r}=i;this._searchController=i;try{const o=await this.viewModel.search(e,{signal:r});return this._searchController!==i?void 0:(o?.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=void 0,o)}catch{if(this._searchController!==i)return;this._searchController=void 0;return}}async suggest(e){this._cancelSuggest();const i=new AbortController,{signal:r}=i;this._suggestController=i;try{const o=await this.viewModel.suggest(e,null,{signal:r});return this._suggestController!==i?void 0:(this._suggestController=void 0,o?.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),o)}catch{return this._suggestController!==i||(this._suggestController=void 0),null}}async setFocus(){await this._autocompleteEl?.setFocus()}loaded(){this.manager.onLifecycle(()=>[_l(()=>[this._searchResultRendererEl,this.viewModel?.defaultPopupTemplate],()=>{const e=this.viewModel?.defaultPopupTemplate,{_searchResultRendererEl:i}=this;if(e&&i){const r=document.createElement("div");r.appendChild(i),e.content=r}},{initial:!0}),_l(()=>this.messages,e=>this.viewModel.messages=e,{initial:!0})])}_addSearchResultRenderer(){this._searchResultRendererEl=jZ(Ne`<arcgis-search-result-renderer auto-destroy-disabled .messages=${this.messages} .viewModel=${this.viewModel}></arcgis-search-result-renderer>`)}_handleInputKeydown(e){e.key==="Tab"&&this._cancelSuggest()}_handleAutocompleteCreate(e){this._autocompleteEl=e}_handleCalciteAutocompleteTextInput(e){const i=e.target.inputValue;i!==this.viewModel.searchTerm&&(this.viewModel.searchTerm=i,i||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){this.activeMenu==="suggestion"&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(e){const i=e.target.value;if(i===this._currentLocationValue){this._useCurrentLocation();return}const r=JSON.parse(i),o=this.viewModel.suggestions?.find(({sourceIndex:h})=>h===r.sourceIndex)?.results?.find(({key:h})=>`${h}`==`${r.key}`);o&&this.search(o)}async _useCurrentLocation(){this._cancelQueries();const e=new AbortController,{signal:i}=e;this._searchController=e;try{await this.viewModel.searchNearby({signal:i})}catch(r){Dd(r)||(this._locateFailed=!0,this.activeMenu="suggestion")}finally{this._searchController=void 0}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){this.activeMenu==="source"&&(this.activeMenu="none")}_handleSourceSelect(e){const i=e.target.selectedItems[0].getAttribute("data-source-index");i&&(this.viewModel.activeSourceIndex=Number.parseInt(i,10))}_cancelSuggest(){this.activeMenu="none",this._locateFailed=!1,this._showNoResults=!1,this._suggestController=Nz(this._suggestController)}_cancelQueries(){this._cancelSuggest(),this._searchController=Nz(this._searchController)}_scrollToTopSuggestion(){this._autocompleteEl?.scrollContentTo({top:0})}_formSubmit(e){e.preventDefault(),this.activeMenu="none",this._lastSearchTerm=this.searchTerm,this.searchTerm&&this.search()}_getSourceName(e){const{messages:i}=this,{allSources:r}=this.viewModel,o=r.at(e);return(e===-1?i.all:o?.name||i.untitledSource)||""}render(){return this._addSearchResultRenderer(),Ne`<div class=${Fe(eR(Kp.base,JL.widget))}><div class=${Fe(Kp.container)}>${this._renderSourcesMenu()}${this._renderForm()}</div></div>`}_renderSourcesMenu(){const{messages:e,_isDisabled:i,_effectiveActiveMenu:r}=this,{allSources:o,searchAllEnabled:h}=this.viewModel;return o.length>1?Ne`<calcite-dropdown class=${Fe(Kp.dropdown)} .disabled=${i} .open=${r==="source"} overlay-positioning=fixed @calciteDropdownClose=${this._handleSourceClose} @calciteDropdownOpen=${this._handleSourceOpen} @calciteDropdownSelect=${this._handleSourceSelect}><calcite-button appearance=outline-fill icon-start=caret-down kind=neutral .label=${e.searchIn} slot=trigger></calcite-button><calcite-dropdown-group .groupTitle=${e.searchIn}>${h?this._renderSource(-1):null}${o.map((d,a)=>this._renderSource(a)).toArray()}</calcite-dropdown-group></calcite-dropdown>`:null}_renderUseCurrentLocation(){const{_currentLocationValue:e}=this;return Ne`<calcite-autocomplete-item .heading=${this.messages.useCurrentLocation??""} icon-start=gps-on .value=${e}></calcite-autocomplete-item>`}_renderAutocomplete(){const{_effectiveActiveMenu:e,messages:i,_isDisabled:r}=this,{maxInputLength:o,placeholder:h,searchTerm:d,state:a}=this.viewModel,_=this.label??i.searchButtonTitle??"";return Ne`<calcite-autocomplete .autocomplete=${"off"} class=${Fe(Kp.autocomplete)} .disabled=${r} .icon=${this.icon||!1} .inputValue=${d} .label=${_} .loading=${a==="searching"} .maxLength=${o} .name=${this.el.id} @keydown=${this._handleInputKeydown} .open=${e==="suggestion"} overlay-positioning=fixed .placeholder=${h} title=${(d?"":h)??Ou} @calciteAutocompleteChange=${this._handleCalciteAutocompleteChange} @calciteAutocompleteClose=${this._handleAutocompleteClose} @calciteAutocompleteOpen=${this._handleAutocompleteOpen} @calciteAutocompleteTextChange=${this._handleCalciteAutocompleteTextInput} @calciteAutocompleteTextInput=${this._handleCalciteAutocompleteTextInput} ${hi(this._handleAutocompleteCreate)}>${this._renderSuggestions()}${this._renderNotices()}</calcite-autocomplete>`}_renderForm(){return Ne`<form class=${Fe(Kp.form)} @submit=${this._formSubmit} role=search>${this._renderAutocomplete()}<button class=${Fe(Kp.submitButton)} type=submit>${this.label??this.messages.searchButtonTitle??""}</button></form>`}_renderSuggestGroup(e){return e.results?.map(i=>this._renderSuggestion(i))}_renderSuggestions(){const{suggestions:e}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():e?.map(i=>this._renderSuggestResults(i))}_renderSuggestResults(e){const{allSources:i,activeSourceIndex:r}=this.viewModel,{sourceIndex:o}=e,h=e.results?.length,d=i.length>1&&r===-1,a=this._getSourceName(o);return h&&d?Ne`<calcite-autocomplete-item-group .heading=${a}>${this._renderSuggestGroup(e)}</calcite-autocomplete-item-group>`:this._renderSuggestGroup(e)}_renderSuggestion({key:e,sourceIndex:i,text:r}){const o={key:e,sourceIndex:i};return Ne`<calcite-autocomplete-item .heading=${r??this.messages.untitledResult??""} .value=${JSON.stringify(o)}></calcite-autocomplete-item>`}_renderSource(e){const i=this._getSourceName(e);return Ne`<calcite-dropdown-item data-source-index=${`${e}`} .selected=${e===this.viewModel.activeSourceIndex}>${i}</calcite-dropdown-item>`}_renderNoResultsWarning(e){const{messages:i}=this,r=e?aP(i.noResultsFoundForValue??"",{value:`"${e}"`}):i.noResultsFound;return Ne`<calcite-notice icon=exclamation-mark-triangle kind=warning open slot=content-bottom><div slot=title>${i.noResults}</div><div slot=message>${r}</div></calcite-notice>`}_renderLocateError(){return Ne`<calcite-notice icon=exclamation-mark-circle kind=danger open slot=content-bottom><div slot=message>${this.messages.locateError}</div></calcite-notice>`}_renderNotices(){return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(this._lastSearchTerm??this.viewModel.searchTerm):null}};B1.properties={_locateFailed:16,_showNoResults:16,_isDisabled:16,_showCurrentLocation:16,_effectiveActiveMenu:16,view:0,referenceElement:1,position:3,goToOverride:0,icon:1,activeMenu:1,activeSource:32,activeSourceIndex:9,allPlaceholder:1,allSources:0,autoNavigateDisabled:5,autoSelectDisabled:5,defaultSources:0,disabled:5,includeDefaultSourcesDisabled:5,locationDisabled:5,maxResults:9,maxSuggestions:9,minSuggestCharacters:9,popupDisabled:5,popupTemplate:0,portal:0,resultGraphic:0,resultGraphicDisabled:5,results:0,searchAllDisabled:5,searchTerm:1,selectedResult:0,sources:0,suggestions:0,suggestionsDisabled:5,autoDestroyDisabled:5,messageOverrides:0,label:1,state:3},B1.styles=Yde;let VI=B1;XL("arcgis-search",VI);const Jde={class:"location-search-container"},Kde=Md({__name:"LocationSearch",setup(t){const e=Go("mitt");return j1(()=>{const i=document.getElementById("search-component");i?.addEventListener("arcgisSelectResult",r=>{const o=r.detail.result.feature.geometry.latitude,h=r.detail.result.feature.geometry.longitude;e.emit("location-selected",{coordinates:[h,o],text:r.detail.result.feature.text})}),i?.addEventListener("arcgisSelectCancel",()=>{e.emit("location-cleared")})}),(i,r)=>{const o=Lr("arcgis-search");return vi(),Hi("div",Jde,[Vi(o,{id:"search-component"})])}}}),Qde=kd(Kde,[["__scopeId","data-v-41b9752b"]]),epe={name:"Map",components:{ComparisonMap:FH,LocationSearch:Qde},data(){return{arrasBrandingColors:Go("arrasBranding").colors}},watch:{},async beforeRouteEnter(t,e,i){if(console.log("beforeRouteEnter"),document.getElementById("loading").style.display="flex",!await Ef().setCurrentTheme(t.query.theme)){i(!1);return}i(!0)},async beforeRouteLeave(t,e,i){console.log("beforeRouteLeave"),await Ef().setCurrentTheme(),i()},mounted(){},computed:{invertedIconPath(){return this.currentThemeConfig?.icon?this.currentThemeConfig?.icon?.replace(/_[^/]*\.png$/i,"_white.png"):null},arrasBrandingColor(){const t=this.currentThemeConfig.style.colors.icon;return this.arrasBrandingColors[t]},currentThemeConfig(){return Ef().getMainConfigForCurrentTheme()}},methods:{}};function tpe(t,e,i,r,o,h){const d=Lr("v-img"),a=Lr("v-card-title"),_=Lr("v-card"),T=Lr("LocationSearch"),E=Lr("ComparisonMap"),k=Lr("v-container"),L=Lr("v-main");return vi(),Iu(L,{class:"d-flex align-center justify-center",style:{"padding-top":"0px"}},{default:va(()=>[Vi(k,{style:{"padding-top":"0px",height:"100%"}},{default:va(()=>[Vi(_,{style:hl({"background-color":h.arrasBrandingColor}),class:"theme-title mt-2",elevation:"2",rounded:"lg"},{default:va(()=>[h.currentThemeConfig?(vi(),Iu(a,{key:0,class:"text-center pa-0 ma-0 theme-title__text",style:hl({"background-color":h.arrasBrandingColor})},{default:va(()=>[Vi(d,{inline:"",src:h.invertedIconPath,width:"36",height:"36",class:"mr-2 title-theme-icon"},null,8,["src"]),Vo(" "+Ki(h.currentThemeConfig.title),1)]),_:1},8,["style"])):cn("",!0)]),_:1},8,["style"]),Vi(T),Vi(E,{_center:[-80.17,34.652],_zoom:8.57,_type:"sideBySide"})]),_:1})]),_:1})}const ipe=kd(epe,[["render",tpe]]),c_e=Object.freeze(Object.defineProperty({__proto__:null,default:ipe},Symbol.toStringTag,{value:"Module"}));export{am as $,Ge as A,Lt as B,yo as C,afe as D,BN as E,Oge as F,Hge as G,wn as H,Ho as I,$0 as J,Ihe as K,Mpe as L,tt as M,Bi as N,nr as O,Fr as P,J0e as Q,$he as R,Rt as S,Kfe as T,ui as U,xb as V,K0e as W,w0 as X,Dd as Y,Ai as Z,P as _,Ni as a,yb as a$,W0e as a0,Rfe as a1,Nie as a2,Fu as a3,zi as a4,lfe as a5,eb as a6,QK as a7,ZL as a8,Zt as a9,ps as aA,Zse as aB,i1 as aC,Ome as aD,vl as aE,Ew as aF,Vfe as aG,wse as aH,Woe as aI,jb as aJ,oi as aK,Az as aL,Gye as aM,Pd as aN,Efe as aO,Cfe as aP,Gu as aQ,Pfe as aR,$fe as aS,Ife as aT,qse as aU,Hse as aV,mi as aW,Vw as aX,KN as aY,ZP as aZ,vme as a_,MQ as aa,u4 as ab,s4 as ac,eQ as ad,so as ae,Wn as af,ll as ag,Ri as ah,$a as ai,i_ as aj,zB as ak,RB as al,OB as am,DB as an,t4 as ao,Lye as ap,Iz as aq,d0e as ar,zae as as,Gse as at,UF as au,Zme as av,Wme as aw,Gme as ax,J$ as ay,cee as az,LB as b,gP as b$,h0e as b0,p_ as b1,m_ as b2,uye as b3,c4 as b4,BC as b5,Tpe as b6,EL as b7,u_ as b8,Oo as b9,Uu as bA,Td as bB,AB as bC,Sye as bD,kye as bE,V$ as bF,bge as bG,xge as bH,Eme as bI,Ta as bJ,wge as bK,o_ as bL,hT as bM,GN as bN,FP as bO,zm as bP,ZK as bQ,Ege as bR,or as bS,kpe as bT,XK as bU,Ime as bV,lme as bW,Xfe as bX,ame as bY,Vie as bZ,xd as b_,fge as ba,AL as bb,Nge as bc,ON as bd,RN as be,Xoe as bf,Bw as bg,jw as bh,foe as bi,_l as bj,GC as bk,un as bl,_4 as bm,see as bn,_w as bo,DN as bp,qme as bq,Sd as br,qP as bs,m1 as bt,Wse as bu,Jme as bv,AN as bw,Xme as bx,Vse as by,Tge as bz,Ve as c,Iw as c$,Oye as c0,_i as c1,_F as c2,gge as c3,ji as c4,vt as c5,A$ as c6,wpe as c7,$C as c8,Fe as c9,qge as cA,eme as cB,Qfe as cC,wu as cD,_de as cE,Ame as cF,Vb as cG,rl as cH,Rn as cI,nme as cJ,sme as cK,xfe as cL,sfe as cM,hw as cN,X0e as cO,Y0e as cP,E0 as cQ,Yme as cR,h_ as cS,Dr as cT,yge as cU,Nr as cV,hs as cW,a_ as cX,mF as cY,Yfe as cZ,Mw as c_,Ne as ca,Ui as cb,ar as cc,kme as cd,Pme as ce,c_ as cf,Hn as cg,Mme as ch,ms as ci,no as cj,Lme as ck,OF as cl,Kme as cm,ioe as cn,o5 as co,qn as cp,Vce as cq,O0 as cr,oN as cs,Vme as ct,Ume as cu,Bme as cv,k0 as cw,M0 as cx,Dm as cy,Qme as cz,H0e as d,ofe as d$,aF as d0,wa as d1,rre as d2,fP as d3,yP as d4,nre as d5,Ffe as d6,gE as d7,_me as d8,Iie as d9,vf as dA,Rr as dB,cm as dC,zt as dD,Wle as dE,Cge as dF,Ale as dG,eye as dH,Lge as dI,Hoe as dJ,Zoe as dK,WP as dL,Sge as dM,kue as dN,Zge as dO,qoe as dP,Pye as dQ,Ape as dR,o4 as dS,Er as dT,bP as dU,YB as dV,s0e as dW,n0e as dX,Nme as dY,dI as dZ,Cm as d_,e4 as da,C0 as db,l_ as dc,Uge as dd,Vge as de,N0 as df,$pe as dg,Z0e as dh,Ds as di,The as dj,kfe as dk,Mfe as dl,t1 as dm,age as dn,Hw as dp,iM as dq,rM as dr,hF as ds,oz as dt,a0e as du,m0e as dv,Bfe as dw,I0e as dx,t0 as dy,uc as dz,H6 as e,Qye as e$,rfe as e0,lae as e1,iae as e2,VN as e3,ome as e4,Jfe as e5,Q6 as e6,Gfe as e7,BB as e8,JK as e9,xD as eA,UQ as eB,Vu as eC,al as eD,Du as eE,zu as eF,rd as eG,oo as eH,fue as eI,Ts as eJ,nl as eK,Ss as eL,A0e as eM,q0e as eN,Z as eO,o_e as eP,gde as eQ,Spe as eR,wb as eS,ace as eT,Tue as eU,wue as eV,Hle as eW,Ble as eX,Fge as eY,Qoe as eZ,e0e as e_,n4 as ea,Eue as eb,Iue as ec,$ue as ed,Sue as ee,xue as ef,MF as eg,Lw as eh,MB as ei,Of as ej,Wie as ek,Zu as el,xc as em,Afe as en,wie as eo,Wce as ep,DL as eq,j6 as er,W6 as es,km as et,Fpe as eu,hme as ev,Wne as ew,Qne as ex,ise as ey,lm as ez,PQ as f,hi as f$,Fae as f0,pz as f1,Lae as f2,B0e as f3,vhe as f4,jme as f5,E0e as f6,co as f7,Cue as f8,Yce as f9,hm as fA,ife as fB,Rme as fC,YP as fD,o0e as fE,r0e as fF,Rye as fG,G$ as fH,tme as fI,Tme as fJ,CF as fK,_ge as fL,vge as fM,Yn as fN,qo as fO,fo as fP,zs as fQ,iX as fR,mo as fS,Cr as fT,gR as fU,bx as fV,Br as fW,ZR as fX,ai as fY,ut as fZ,qA as f_,jne as fa,Cme as fb,N0e as fc,F0e as fd,LN as fe,nye as ff,rye as fg,hye as fh,fz as fi,Qpe as fj,kw as fk,wfe as fl,Ofe as fm,Hfe as fn,zpe as fo,Ope as fp,Dpe as fq,jie as fr,$L as fs,Kpe as ft,B$ as fu,Rpe as fv,j$ as fw,Lpe as fx,NB as fy,FB as fz,dt as g,Zae as g$,go as g0,y$ as g1,yJ as g2,Y0 as g3,_pe as g4,xpe as g5,pX as g6,Yge as g7,Xge as g8,Ufe as g9,_fe as gA,bfe as gB,yfe as gC,aye as gD,sye as gE,Pa as gF,R0 as gG,Fw as gH,eae as gI,jge as gJ,Qge as gK,B0 as gL,rue as gM,Kce as gN,ooe as gO,zw as gP,Ab as gQ,coe as gR,KP as gS,cue as gT,k0e as gU,C5 as gV,$me as gW,wP as gX,Npe as gY,Pue as gZ,nfe as g_,Kie as ga,Zfe as gb,O6 as gc,sr as gd,Cye as ge,p0e as gf,IP as gg,ree as gh,Upe as gi,Bge as gj,aN as gk,hge as gl,doe as gm,uge as gn,poe as go,Epe as gp,cye as gq,iye as gr,cse as gs,D0e as gt,Hme as gu,R0e as gv,z0e as gw,NL as gx,h4 as gy,vfe as gz,are as h,Aue as h$,Ige as h0,Ub as h1,Uw as h2,Eye as h3,d_ as h4,fm as h5,Phe as h6,Coe as h7,Fme as h8,pm as h9,ale as hA,ple as hB,mge as hC,Vae as hD,Age as hE,Nfe as hF,Cw as hG,$ae as hH,EB as hI,$ce as hJ,Aye as hK,Cae as hL,Aae as hM,ZN as hN,tye as hO,yD as hP,yw as hQ,cre as hR,Jpe as hS,u0e as hT,pge as hU,Gge as hV,Sme as hW,SP as hX,dge as hY,Kye as hZ,Jye as h_,uQ as ha,tfe as hb,uue as hc,ime as hd,uB as he,Ole as hf,$s as hg,PL as hh,zfe as hi,V6 as hj,zN as hk,i5 as hl,Z6 as hm,RF as hn,one as ho,SE as hp,WK as hq,Y$ as hr,Rge as hs,tre as ht,QL as hu,n5 as hv,Lle as hw,Hb as hx,qye as hy,Rle as hz,Ln as i,yye as i$,Ice as i0,i0e as i1,t0e as i2,Fue as i3,_u as i4,UB as i5,V0e as i6,vpe as i7,ffe as i8,gw as i9,L0e as iA,$0e as iB,P0e as iC,M0e as iD,nM as iE,xN as iF,woe as iG,$P as iH,gfe as iI,vD as iJ,qw as iK,kle as iL,NP as iM,dye as iN,BP as iO,uce as iP,mye as iQ,dB as iR,pce as iS,pB as iT,xye as iU,pye as iV,gye as iW,Uo as iX,wye as iY,dce as iZ,Ple as i_,_c as ia,Tfe as ib,H$ as ic,bpe as id,aP as ie,Bne as ig,hP as ih,Lfe as ii,z6 as ij,qfe as ik,gme as il,Gae as im,goe as io,j0e as ip,Q5 as iq,Iye as ir,Tye as is,yce as it,Dye as iu,$ye as iv,XE as iw,zme as ix,O0e as iy,nQ as iz,yy as j,_ye as j0,bye as j1,DT as j2,Jge as j3,lne as j4,sF as j5,of as j6,fr as j7,$N as j8,Nb as j9,Dme as jA,lye as jB,No as jC,uD as jD,ere as jE,t_e as jF,Wge as jG,PC as jH,hE as jI,mE as jJ,bn as jK,vn as jL,oye as jM,g0e as jN,v0e as jO,f0e as jP,VQ as jQ,Vpe as jR,c_e as jS,Roe as ja,Bpe as jb,KK as jc,ML as jd,Ipe as je,l0e as jf,c0e as jg,Cpe as jh,lce as ji,Hae as jj,gle as jk,Hye as jl,Zye as jm,yle as jn,mfe as jo,iB as jp,Cce as jq,Mye as jr,kce as js,zye as jt,ule as ju,Wfe as jv,ble as jw,nle as jx,Wae as jy,ele as jz,CQ as k,cd as l,Bye as m,zoe as n,jpe as o,Pw as p,jfe as q,Aoe as r,Ot as s,fw as t,As as u,S0 as v,G0e as w,e_ as x,Pne as y,R as z};
