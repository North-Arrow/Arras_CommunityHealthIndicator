import{eD as m,eE as c,eF as p,eG as $,O as f,eH as C,eI as h,bS as d,aN as u,eJ as k,dx as M,s as y,af as x,ae as D,cW as v,ag as F,ah as E,eK as T,eL as I,eM as U,d_ as W,eN as S}from"./MapPage-COzn-Qm3.js";import{S as z,u as P,c as j}from"./defaults-CMdCvmla.js";import{e as N,i as V}from"./defaultsJSON-GKolV7NZ.js";m.fromSimpleMarkerSymbol(z);c.fromSimpleLineSymbol(P);p.fromSimpleFillSymbol(j);new $({symbolLayers:new f([new C({material:{color:N},edges:new h({size:u(1),color:new d(V)})})])});const G=new c({symbolLayers:new f([new k({material:{color:new d([0,0,0])},size:u(1)})])}),H=new p({symbolLayers:new f([new C({outline:{color:new d([0,0,0]),size:u(1)}})])}),w="#useCIMFallbackSymbology()",t={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function J(e,l=t){if(!e)return{symbol:null};const{retainId:r=t.retainId,ignoreDrivers:n=t.ignoreDrivers,hasLabelingContext:s=t.hasLabelingContext,retainCIM:i=t.retainCIM,cimFallbackEnabled:a=t.cimFallbackEnabled}=l;let o=null;if(M(e))o=e.clone();else if(e.type==="web-style")o=e.clone();else if(e.type==="cim"){const b=e.data?.symbol?.type;switch(b){case"CIMPointSymbol":o=i?e.clone():m.fromCIMSymbol(e);break;case"CIMLineSymbol":a&&(o=G.clone(),l?.logWarning?.(w,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":a&&(o=H.clone(),l?.logWarning?.(w,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!o)return{error:new y("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${b||"unknown"}' is unsupported in 3D`,{symbol:e})}}else if(e instanceof x)o=c.fromSimpleLineSymbol(e);else if(e instanceof D)o=m.fromSimpleMarkerSymbol(e);else if(e instanceof v)o=m.fromPictureMarkerSymbol(e);else if(e instanceof F)o=l.geometryType&&l.geometryType==="mesh"?$.fromSimpleFillSymbol(e):p.fromSimpleFillSymbol(e);else{if(!(e instanceof E))return{error:new y("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};o=s?T.fromTextSymbol(e):m.fromTextSymbol(e)}return r&&o&&o.type!=="cim"&&(o.id=e.id),!n||o.type==="cim"||o instanceof I||o.symbolLayers.forEach(b=>b.ignoreDrivers=!0),{symbol:o}}function A(e,l,r,n){const s=L(e,{},{context:n,isLabelSymbol:!1});s!=null&&W(r,s,l)}function B(e,l,r,n){const s=L(e,{},{context:n,isLabelSymbol:!0});s!=null&&(l[r]=s)}function g(e){return M(e)||e instanceof I}function K(e){return e?.type==="polygon-3d"||e?.type==="line-3d"}function L(e,l,r){if(e==null)return null;const{context:n,isLabelSymbol:s}=r,i=n?.origin,a=n?.messages;if(i==="web-scene"&&!g(e)){const o=J(e,{retainCIM:!0,hasLabelingContext:s});return o.symbol!=null?o.symbol.write(l,n):(a?.push(new y("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:n,error:o.error})),null)}return S(n?.layer)&&K(e)?(a?.push(new y("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported on layers of type '${n?.layer?.declaredClass}'.`,{symbol:e,context:n})),null):(i==="web-map"||i==="portal-item"&&!S(n?.layer))&&g(e)?(a?.push(new y("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:n})),null):e.write(l,n)}function Q(e,l){return U(e,null,l)}export{A as i,B as p,Q as u};
