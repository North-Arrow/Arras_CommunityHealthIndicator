import{d as p,r as d,i as h,a as y}from"./index-DnxlrHRJ.js";function C(l){const n=l.split(`
`);let o=n.findIndex(e=>!e.includes("-")&&e.includes("geoid")&&!e.includes(" "));o===-1&&(o=n.findIndex(e=>!e.includes("-")&&e.includes("geoid"))),(!n[o]||!n[o].split)&&console.error("No short name row found",l);const a=n[o].toLowerCase().split(",").map(e=>e.trim()),u=1-o,g=n[u].split(",").map(e=>e.trim()),c=n.slice(2).map(e=>{const f=e.split(",").map((t,i)=>i!==a.indexOf("geoid")?t.trim():t.trim().toLowerCase()).map(t=>{if(!(!t||t.length===0))return!isNaN(Number(t))&&t.includes(".")?Number(t).toFixed(2):t});return a.reduce((t,i,r)=>(t[i]=f[r]||void 0,t),{})});return c.forEach(e=>{e.geoid&&(e.geoid.includes("005700")||e.geoid.includes("002300"))&&(e.geoid=e.geoid.split("G").join("").split("g").join("").split("005700").join("0570").split("002300").join("0230"))}),{headerLabels:g,headerShortNames:a,data:c}}const x=p("themeLevel",()=>{const l=d(null),n=d(null),o=h("categoryConfigs"),a=h("mainConfig"),u=d(null);async function g(t){if(!t)return n.value=null,l.value=null,u.value=null,!0;n.value=t,l.value=o[t],u.value=a?.categories?.find(r=>r.query_str===t);const i=f();if(i)await Promise.all(i.map(async r=>{r.google_sheets_data=C((await y.get(r.google_sheets_url)).data)}));else return!1;return!0}function c(){return l.value}function e(){return u.value}function f(){const t=n.value;if(t){const r=o[t]?.indicators||[],m=u.value.style;return r.map(s=>(s.style?.["icon-colors"]&&(s.style.colors||(s.style.colors={}),s.style.colors={...s.style.colors,...s.style["icon-colors"]},delete s.style["icon-colors"]),m&&(s.style=m),s))}return null}return{setCurrentTheme:g,getMainConfigForCurrentTheme:e,getCurrentThemeConfig:c,getAllCurrentThemeIndicators:f,currentThemeConfig:l,currentThemeShortName:n}});export{x as u};
