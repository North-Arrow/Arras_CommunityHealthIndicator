import{P as l,$ as n}from"./utils-BatAH9R8.js";import{r as c}from"./RasterJobHandlerMixin-DZJDgMCi.js";import{l as u,c as g,E as m,u as v}from"./portalItemUtils-DcS22hm7.js";import"./MapPage-BqDFg4OT.js";import"./index-DtWsY0yY.js";import"./themeLevelStore-Cj2dUhSE.js";import"./originUtils-CPX8CCAY.js";import"./multiOriginJSONSupportUtils-C0wm8_Yw.js";import"./PortalItem-C_bCcVXk.js";import"./jsonContext-vrWDRHHE.js";import"./saveUtils-Dnz_0YdH.js";import"./ClassBreaksRenderer-BwoYG8sq.js";import"./diffUtils-CsAGoa4E.js";import"./RendererLegendOptions-CMB5PehI.js";import"./styleUtils-B2um9-t6.js";import"./colorRamps-3Cjk-Xk6.js";import"./OperationalLayer-Dcg_8qzj.js";import"./jsonUtils-B-GBaVrT.js";import"./defaults-BmCvOKqW.js";import"./defaultsJSON-GKolV7NZ.js";import"./RasterSymbolizer-qpotq1wE.js";import"./PixelBlock-BhjL7QJ2.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./colorUtils-dFcE5yBI.js";import"./vec42-BW4fzvI1.js";import"./vec4f64-CvoGn1-Y.js";import"./workers-C3ogzdP2.js";import"./Queue-CedPAkqY.js";import"./Field-DLbvU-yB.js";import"./fieldType-B4cTFbuJ.js";import"./normalizeUtils-PvkyIfUE.js";import"./Cyclical-D1390gTl.js";import"./normalizeUtilsCommon--SI05v58.js";import"./utils-DwloHt2C.js";import"./asyncUtils-BoG2C-0J.js";import"./mat4f32-Djp3mnm5.js";import"./mat4-BO2gVlab.js";import"./utils-CNckjA7H.js";import"./LRUCache-Bk6V7uqy.js";import"./ClassBreaksDefinition-D7FyGnVL.js";import"./dataUtils-DkMcaKqV.js";import"./projectionUtils-DwTqgaht.js";const o="Image Service",f="imagery-layer-save",d="imagery-layer-save-as",T="imagery-tile-layer-save",I="imagery-tile-layer-save-as",p="WCS",w="wcs-layer-save",x="wcs-layer-save-as";function s(r){if(r.type==="imagery"||r.type==="wcs")return{isValid:!0};const{raster:e}=r,t=c(e)[0];return{isValid:t?.datasetFormat==="RasterTileServer"&&(t.tileType==="Raster"||t.tileType==="Map"),errorMessage:"imagery tile layer should be created from a tiled image service."}}function y(r){const e=r.layerJSON;return Promise.resolve(e&&Object.keys(e).length?e:null)}async function A(r,e){const{parsedUrl:t,title:i,fullExtent:a}=r;e.url=t.path,e.title||=i;try{e.extent=await u(a)}catch{e.extent=void 0}g(e,m.METADATA),v(e,m.TILED_IMAGERY,r.type==="imagery-tile")}async function nr(r,e){const t=r.type==="imagery"?f:r.type==="imagery-tile"?T:w,i=r.type==="wcs"?p:o;return l({layer:r,itemType:i,validateLayer:s,createItemData:y,errorNamePrefix:t},e)}async function cr(r,e,t){const i=r.type==="imagery"?d:r.type==="imagery-tile"?I:x,a=r.type==="wcs"?p:o;return n({layer:r,itemType:a,validateLayer:s,createItemData:y,errorNamePrefix:i,newItem:e,setItemProperties:A},t)}export{nr as save,cr as saveAs};
