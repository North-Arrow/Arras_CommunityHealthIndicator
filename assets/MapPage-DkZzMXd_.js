const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/request-mLwG6ZRo.js","assets/index-By_q5Om-.js","assets/index-DydP-41E.css","assets/themeLevelStore-BsK05iL2.js","assets/IdentityManager-DOYXejDW.js","assets/uuid-COSr2EB2.js","assets/sanitizerUtils-DvKU1K2H.js","assets/QueueProcessor-DSvrC_YI.js","assets/Queue-DUa4Qfgn.js","assets/ReactiveMap-B4h_tBK7.js","assets/signal-BZJowhN9.js","assets/WhereClauseCache-BghMSzDu.js","assets/LRUCache-DnHPoPwZ.js","assets/WhereClause-Dn5GczYx.js","assets/TimeOnly-VDn8IOM2.js","assets/enum-D2C2uM-s.js","assets/UnknownTimeZone-B3UI1f63.js","assets/arcadeUtils-3DzgGix_.js","assets/aiServices-DkaQr_nw.js","assets/Field-BjvbZoYe.js","assets/fieldType-DE6-4uFs.js","assets/number-mOJmzXgc.js","assets/featureConversionUtils-Dl1CdbCv.js","assets/OptimizedFeature-WP_zutLe.js","assets/memoryEstimations-ChwxhUsA.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/FieldsIndex-DZDx_VC6.js","assets/timeZoneUtils-BUXWfqgw.js","assets/streamLayerUtils-DFlbJ4P1.js","assets/unitConversion-DWf81oef.js","assets/isImageryGraphicOrigin-Ccuhb4eK.js","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/rasterFieldUtils-dXDAaFiU.js","assets/batchExec-Bed1a-vU.js","assets/PortalItem-CLnwZtHX.js","assets/Basemap-BNWMJfWA.js","assets/loadAll-U-zmf6cU.js","assets/asyncUtils-3yuXbjd8.js","assets/isBasemap-Cp_8tW2x.js","assets/writeUtils-DKPlyP23.js","assets/ElevationLayer-DP8T5POJ.js","assets/MultiOriginJSONSupport-C6bxtdvv.js","assets/HeightModelInfo-Bw0o92qH.js","assets/ArcGISCachedService-BWVpP3XT.js","assets/TileInfo-DFQufNvB.js","assets/TileInfoTilemapCache-BRDt0X9U.js","assets/TilemapCache-VUf8SWsv.js","assets/ArcGISService-VWmrBcuy.js","assets/OperationalLayer-BXYCm5gU.js","assets/PortalLayer-DNTG1-06.js","assets/portalItemUtils-CguI2v5J.js","assets/projectionUtils-BWBV91Ee.js","assets/workers-B4sTRFuO.js","assets/webStyleSymbolUtils-CxulSo9Z.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/jsonUtils-MGmnFGCM.js","assets/defaults-ZW38jbfm.js","assets/defaultsJSON-GKolV7NZ.js","assets/styleUtils-BePBBimH.js","assets/portalLayers-lrj1Xg2g.js","assets/associatedFeatureServiceUtils-_pWEVmWt.js","assets/fetchService-BRdakED8.js","assets/loadUtils-DUY9cEE3.js","assets/lazyLayerLoader-C9LA4POt.js","assets/arcgisLayers-TaRysD5u.js"])))=>i.map(i=>d[i]);
var A9=Object.getPrototypeOf;var D9=Reflect.get;var Bk=t=>{throw TypeError(t)};var hS=(t,e,i)=>e.has(t)||Bk("Cannot "+i);var Ai=(t,e,i)=>(hS(t,e,"read from private field"),i?i.call(t):e.get(t)),na=(t,e,i)=>e.has(t)?Bk("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),sa=(t,e,i,r)=>(hS(t,e,"write to private field"),r?r.call(t,i):e.set(t,i),i),Hg=(t,e,i)=>(hS(t,e,"access private method"),i);var jk=(t,e,i)=>D9(A9(t),i,e);import{b as kd,s as q1,c as xn,f as mr,k as qi,o as di,h as Ct,v as Ir,g as $i,t as Qi,j as ms,F as z9,l as O9,n as W0,w as As,m as Ad,x as R9,y as L9,z as F9,d as N9,r as Yn,i as qo,e as al,A as us,q as qI,B as Qh,p as jz,C as Uz,D as pl,E as a0,G as l0,H as B9,_ as Qn}from"./index-By_q5Om-.js";import{f as j9,u as If}from"./themeLevelStore-BsK05iL2.js";function Vz(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ab={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.1/LICENSE.txt
 */var U9=ab.exports,Uk;function V9(){return Uk||(Uk=1,(function(t,e){(function(i,r){t.exports=r()})(U9,(function(){var i={},r={};function o(d,a,v){if(r[d]=v,d==="index"){var T="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",E={};return r.shared(E),r.index(i,E),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([T],{type:"text/javascript"}))),i}}o("shared",["exports"],(function(d){function a(c,s,l,p){return new(l||(l=Promise))((function(m,x){function w(A){try{I(p.next(A))}catch(D){x(D)}}function C(A){try{I(p.throw(A))}catch(D){x(D)}}function I(A){var D;A.done?m(A.value):(D=A.value,D instanceof l?D:new l((function(N){N(D)}))).then(w,C)}I((p=p.apply(c,s||[])).next())}))}function v(c,s){this.x=c,this.y=s}function T(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var E,k;typeof SuppressedError=="function"&&SuppressedError,v.prototype={clone(){return new v(this.x,this.y)},add(c){return this.clone()._add(c)},sub(c){return this.clone()._sub(c)},multByPoint(c){return this.clone()._multByPoint(c)},divByPoint(c){return this.clone()._divByPoint(c)},mult(c){return this.clone()._mult(c)},div(c){return this.clone()._div(c)},rotate(c){return this.clone()._rotate(c)},rotateAround(c,s){return this.clone()._rotateAround(c,s)},matMult(c){return this.clone()._matMult(c)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(c){return this.x===c.x&&this.y===c.y},dist(c){return Math.sqrt(this.distSqr(c))},distSqr(c){const s=c.x-this.x,l=c.y-this.y;return s*s+l*l},angle(){return Math.atan2(this.y,this.x)},angleTo(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith(c){return this.angleWithSep(c.x,c.y)},angleWithSep(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult(c){const s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add(c){return this.x+=c.x,this.y+=c.y,this},_sub(c){return this.x-=c.x,this.y-=c.y,this},_mult(c){return this.x*=c,this.y*=c,this},_div(c){return this.x/=c,this.y/=c,this},_multByPoint(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint(c){return this.x/=c.x,this.y/=c.y,this},_unit(){return this._div(this.mag()),this},_perp(){const c=this.y;return this.y=this.x,this.x=-c,this},_rotate(c){const s=Math.cos(c),l=Math.sin(c),p=l*this.x+s*this.y;return this.x=s*this.x-l*this.y,this.y=p,this},_rotateAround(c,s){const l=Math.cos(c),p=Math.sin(c),m=s.y+p*(this.x-s.x)+l*(this.y-s.y);return this.x=s.x+l*(this.x-s.x)-p*(this.y-s.y),this.y=m,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:v},v.convert=function(c){if(c instanceof v)return c;if(Array.isArray(c))return new v(+c[0],+c[1]);if(c.x!==void 0&&c.y!==void 0)return new v(+c.x,+c.y);throw new Error("Expected [x, y] or {x, y} point format")};var L=(function(){if(k)return E;function c(s,l,p,m){this.cx=3*s,this.bx=3*(p-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=l,this.p2x=p,this.p2y=m}return k=1,E=c,c.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,l){if(l===void 0&&(l=1e-6),s<0)return 0;if(s>1)return 1;for(var p=s,m=0;m<8;m++){var x=this.sampleCurveX(p)-s;if(Math.abs(x)<l)return p;var w=this.sampleCurveDerivativeX(p);if(Math.abs(w)<1e-6)break;p-=x/w}var C=0,I=1;for(p=s,m=0;m<20&&(x=this.sampleCurveX(p),!(Math.abs(x-s)<l));m++)s>x?C=p:I=p,p=.5*(I-C)+C;return p},solve:function(s,l){return this.sampleCurveY(this.solveCurveX(s,l))}},E})(),O=T(L);let H,ie;function pe(){return H==null&&(H=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),H}function be(){if(ie==null&&(ie=!1,pe())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let p=0;p<25;p++){const m=4*p;s.fillStyle=`rgb(${m},${m+1},${m+2})`,s.fillRect(p%5,Math.floor(p/5),1,1)}const l=s.getImageData(0,0,5,5).data;for(let p=0;p<100;p++)if(p%4!=3&&l[p]!==p){ie=!0;break}}}return ie||!1}var Ce=1e-6,Pe=typeof Float32Array<"u"?Float32Array:Array;function Ie(){var c=new Pe(9);return Pe!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function ke(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Ke(){var c=new Pe(3);return Pe!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function qe(c){var s=c[0],l=c[1],p=c[2];return Math.sqrt(s*s+l*l+p*p)}function dt(c,s,l){var p=new Pe(3);return p[0]=c,p[1]=s,p[2]=l,p}function ft(c,s,l){return c[0]=s[0]+l[0],c[1]=s[1]+l[1],c[2]=s[2]+l[2],c}function et(c,s,l){return c[0]=s[0]*l,c[1]=s[1]*l,c[2]=s[2]*l,c}function We(c,s,l){var p=s[0],m=s[1],x=s[2],w=l[0],C=l[1],I=l[2];return c[0]=m*I-x*C,c[1]=x*w-p*I,c[2]=p*C-m*w,c}var Be,ge=qe;function De(c,s,l){var p=s[0],m=s[1],x=s[2],w=s[3];return c[0]=l[0]*p+l[4]*m+l[8]*x+l[12]*w,c[1]=l[1]*p+l[5]*m+l[9]*x+l[13]*w,c[2]=l[2]*p+l[6]*m+l[10]*x+l[14]*w,c[3]=l[3]*p+l[7]*m+l[11]*x+l[15]*w,c}function Je(){var c=new Pe(4);return Pe!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function Qe(c,s,l,p){var m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",x=Math.PI/360;s*=x,p*=x,l*=x;var w=Math.sin(s),C=Math.cos(s),I=Math.sin(l),A=Math.cos(l),D=Math.sin(p),N=Math.cos(p);switch(m){case"xyz":c[0]=w*A*N+C*I*D,c[1]=C*I*N-w*A*D,c[2]=C*A*D+w*I*N,c[3]=C*A*N-w*I*D;break;case"xzy":c[0]=w*A*N-C*I*D,c[1]=C*I*N-w*A*D,c[2]=C*A*D+w*I*N,c[3]=C*A*N+w*I*D;break;case"yxz":c[0]=w*A*N+C*I*D,c[1]=C*I*N-w*A*D,c[2]=C*A*D-w*I*N,c[3]=C*A*N+w*I*D;break;case"yzx":c[0]=w*A*N+C*I*D,c[1]=C*I*N+w*A*D,c[2]=C*A*D-w*I*N,c[3]=C*A*N-w*I*D;break;case"zxy":c[0]=w*A*N-C*I*D,c[1]=C*I*N+w*A*D,c[2]=C*A*D+w*I*N,c[3]=C*A*N-w*I*D;break;case"zyx":c[0]=w*A*N-C*I*D,c[1]=C*I*N+w*A*D,c[2]=C*A*D-w*I*N,c[3]=C*A*N+w*I*D;break;default:throw new Error("Unknown angle order "+m)}return c}function yt(){var c=new Pe(2);return Pe!=Float32Array&&(c[0]=0,c[1]=0),c}function Et(c,s){var l=new Pe(2);return l[0]=c,l[1]=s,l}Ke(),Be=new Pe(4),Pe!=Float32Array&&(Be[0]=0,Be[1]=0,Be[2]=0,Be[3]=0),Ke(),dt(1,0,0),dt(0,1,0),Je(),Je(),Ie(),yt();const Ye=8192;function bt(c,s,l){return s*(Ye/(c.tileSize*Math.pow(2,l-c.tileID.overscaledZ)))}function Dt(c,s){return(c%s+s)%s}function Si(c,s,l){return c*(1-l)+s*l}function Vr(c){if(c<=0)return 0;if(c>=1)return 1;const s=c*c,l=s*c;return 4*(c<.5?l:3*(c-s)+l-.75)}function nn(c,s,l,p){const m=new O(c,s,l,p);return x=>m.solve(x)}const es=nn(.25,.1,.25,1);function sn(c,s,l){return Math.min(l,Math.max(s,c))}function bo(c,s,l){const p=l-s,m=((c-s)%p+p)%p+s;return m===s?l:m}function dn(c,...s){for(const l of s)for(const p in l)c[p]=l[p];return c}let Ls=1;function Tc(c,s,l){const p={};for(const m in c)p[m]=s.call(this,c[m],m,c);return p}function Cc(c,s,l){const p={};for(const m in c)s.call(this,c[m],m,c)&&(p[m]=c[m]);return p}function ts(c){return Array.isArray(c)?c.map(ts):typeof c=="object"&&c?Tc(c,ts):c}const er={};function cr(c){er[c]||(typeof console<"u"&&console.warn(c),er[c]=!0)}function Fs(c,s,l){return(l.y-c.y)*(s.x-c.x)>(s.y-c.y)*(l.x-c.x)}function xo(c){return typeof WorkerGlobalScope<"u"&&c!==void 0&&c instanceof WorkerGlobalScope}let Cl=null;function wo(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const So="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ec(c,s,l,p,m){return a(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(c,{timestamp:0});try{const w=x?.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const C=w.startsWith("BGR"),I=new Uint8ClampedArray(p*m*4);if(yield x.copyTo(I,(function(A,D,N,U,G){const q=4*Math.max(-D,0),X=(Math.max(0,N)-N)*U*4+q,Q=4*U,ne=Math.max(0,D),ye=Math.max(0,N);return{rect:{x:ne,y:ye,width:Math.min(A.width,D+U)-ne,height:Math.min(A.height,N+G)-ye},layout:[{offset:X,stride:Q}]}})(c,s,l,p,m)),C)for(let A=0;A<I.length;A+=4){const D=I[A];I[A]=I[A+2],I[A+2]=D}return I}finally{x.close()}}))}let ka,Aa;function Da(c,s,l,p){return c.addEventListener(s,l,p),{unsubscribe:()=>{c.removeEventListener(s,l,p)}}}function El(c){return c*Math.PI/180}function za(c){return c/Math.PI*180}const Oa={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Ra={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ic="AbortError";function _e(){return new Error(Ic)}const Y={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function J(c){return Y.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))]}const K="global-dispatcher";class le extends Error{constructor(s,l,p,m){super(`AJAXError: ${l} (${s}): ${p}`),this.status=s,this.statusText=l,this.url=p,this.body=m}}const fe=()=>xo(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,xe=function(c,s){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){const p=J(c.url);if(p)return p(c,s);if(xo(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,targetMapId:K},s)}if(!(/^file:/.test(l=c.url)||/^file:/.test(fe())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(p,m){return a(this,void 0,void 0,(function*(){const x=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:fe(),signal:m.signal});let w,C;p.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");try{w=yield fetch(x)}catch(A){throw new le(0,A.message,p.url,new Blob)}if(!w.ok){const A=yield w.blob();throw new le(w.status,w.statusText,p.url,A)}C=p.type==="arrayBuffer"||p.type==="image"?w.arrayBuffer():p.type==="json"?w.json():w.text();const I=yield C;if(m.signal.aborted)throw _e();return{data:I,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}}))})(c,s);if(xo(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,mustQueue:!0,targetMapId:K},s)}var l;return(function(p,m){return new Promise(((x,w)=>{var C;const I=new XMLHttpRequest;I.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(I.responseType="arraybuffer");for(const A in p.headers)I.setRequestHeader(A,p.headers[A]);p.type==="json"&&(I.responseType="text",!((C=p.headers)===null||C===void 0)&&C.Accept||I.setRequestHeader("Accept","application/json")),I.withCredentials=p.credentials==="include",I.onerror=()=>{w(new Error(I.statusText))},I.onload=()=>{if(!m.signal.aborted)if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){let A=I.response;if(p.type==="json")try{A=JSON.parse(I.response)}catch(D){return void w(D)}x({data:A,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const A=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});w(new le(I.status,I.statusText,p.url,A))}},m.signal.addEventListener("abort",(()=>{I.abort(),w(_e())})),I.send(p.body)}))})(c,s)};function Ae(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const s=new URL(c),l=window.location;return s.protocol===l.protocol&&s.host===l.host}function Se(c,s,l){l[c]&&l[c].indexOf(s)!==-1||(l[c]=l[c]||[],l[c].push(s))}function Ne(c,s,l){if(l&&l[c]){const p=l[c].indexOf(s);p!==-1&&l[c].splice(p,1)}}class Xe{constructor(s,l={}){dn(this,l),this.type=s}}class Ge extends Xe{constructor(s,l={}){super("error",dn({error:s},l))}}class St{on(s,l){return this._listeners=this._listeners||{},Se(s,l,this._listeners),{unsubscribe:()=>{this.off(s,l)}}}off(s,l){return Ne(s,l,this._listeners),Ne(s,l,this._oneTimeListeners),this}once(s,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},Se(s,l,this._oneTimeListeners),this):new Promise((p=>this.once(s,p)))}fire(s,l){typeof s=="string"&&(s=new Xe(s,l||{}));const p=s.type;if(this.listens(p)){s.target=this;const m=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const C of m)C.call(this,s);const x=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const C of x)Ne(p,C,this._oneTimeListeners),C.call(this,s);const w=this._eventedParent;w&&(dn(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(s))}else s instanceof Ge&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,l){return this._eventedParent=s,this._eventedParentData=l,this}}var Te={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ot=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Jt(c,s){const l={};for(const p in c)p!=="ref"&&(l[p]=c[p]);return Ot.forEach((p=>{p in s&&(l[p]=s[p])})),l}function $t(c,s){if(Array.isArray(c)){if(!Array.isArray(s)||c.length!==s.length)return!1;for(let l=0;l<c.length;l++)if(!$t(c[l],s[l]))return!1;return!0}if(typeof c=="object"&&c!==null&&s!==null){if(typeof s!="object"||Object.keys(c).length!==Object.keys(s).length)return!1;for(const l in c)if(!$t(c[l],s[l]))return!1;return!0}return c===s}function jt(c,s){c.push(s)}function Oi(c,s,l){jt(l,{command:"addSource",args:[c,s[c]]})}function Mr(c,s,l){jt(s,{command:"removeSource",args:[c]}),l[c]=!0}function kr(c,s,l,p){Mr(c,l,p),Oi(c,s,l)}function ur(c,s,l){let p;for(p in c[l])if(Object.prototype.hasOwnProperty.call(c[l],p)&&p!=="data"&&!$t(c[l][p],s[l][p]))return!1;for(p in s[l])if(Object.prototype.hasOwnProperty.call(s[l],p)&&p!=="data"&&!$t(c[l][p],s[l][p]))return!1;return!0}function ti(c,s,l,p,m,x){c=c||{},s=s||{};for(const w in c)Object.prototype.hasOwnProperty.call(c,w)&&($t(c[w],s[w])||l.push({command:x,args:[p,w,s[w],m]}));for(const w in s)Object.prototype.hasOwnProperty.call(s,w)&&!Object.prototype.hasOwnProperty.call(c,w)&&($t(c[w],s[w])||l.push({command:x,args:[p,w,s[w],m]}))}function li(c){return c.id}function yr(c,s){return c[s.id]=s,c}class it{constructor(s,l,p,m){this.message=(s?`${s}: `:"")+p,m&&(this.identifier=m),l!=null&&l.__line__&&(this.line=l.__line__)}}function pn(c,...s){for(const l of s)for(const p in l)c[p]=l[p];return c}class Wi extends Error{constructor(s,l){super(l),this.message=l,this.key=s}}class La{constructor(s,l=[]){this.parent=s,this.bindings={};for(const[p,m]of l)this.bindings[p]=m}concat(s){return new La(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const $c={kind:"null"},pt={kind:"number"},Kt={kind:"string"},Wt={kind:"boolean"},on={kind:"color"},Il={kind:"projectionDefinition"},Fa={kind:"object"},qt={kind:"value"},Rd={kind:"collator"},Na={kind:"formatted"},Ld={kind:"padding"},To={kind:"colorArray"},Pc={kind:"numberArray"},tr={kind:"resolvedImage"},Fd={kind:"variableAnchorOffsetCollection"};function Fn(c,s){return{kind:"array",itemType:c,N:s}}function Pi(c){if(c.kind==="array"){const s=Pi(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const bv=[$c,pt,Kt,Wt,on,Il,Na,Fa,Fn(qt),Ld,Pc,To,tr,Fd];function Yu(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!Yu(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const l of bv)if(!Yu(l,s))return null}}return`Expected ${Pi(c)} but found ${Pi(s)} instead.`}function Rm(c,s){return s.some((l=>l.kind===c.kind))}function Ba(c,s){return s.some((l=>l==="null"?c===null:l==="array"?Array.isArray(c):l==="object"?c&&!Array.isArray(c)&&typeof c=="object":l===typeof c))}function ja(c,s){return c.kind==="array"&&s.kind==="array"?c.itemType.kind===s.itemType.kind&&typeof c.N=="number":c.kind===s.kind}const Lm=.96422,xv=.82521,wv=4/29,Mc=6/29,Sv=3*Mc*Mc,Jw=Mc*Mc*Mc,Kw=Math.PI/180,Qw=180/Math.PI;function Fm(c){return(c%=360)<0&&(c+=360),c}function kc([c,s,l,p]){let m,x;const w=Bm((.2225045*(c=Nm(c))+.7168786*(s=Nm(s))+.0606169*(l=Nm(l)))/1);c===s&&s===l?m=x=w:(m=Bm((.4360747*c+.3850649*s+.1430804*l)/Lm),x=Bm((.0139322*c+.0971045*s+.7141733*l)/xv));const C=116*w-16;return[C<0?0:C,500*(m-w),200*(w-x),p]}function Nm(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Bm(c){return c>Jw?Math.pow(c,1/3):c/Sv+wv}function Ac([c,s,l,p]){let m=(c+16)/116,x=isNaN(s)?m:m+s/500,w=isNaN(l)?m:m-l/200;return m=1*Um(m),x=Lm*Um(x),w=xv*Um(w),[jm(3.1338561*x-1.6168667*m-.4906146*w),jm(-.9787684*x+1.9161415*m+.033454*w),jm(.0719453*x-.2289914*m+1.4052427*w),p]}function jm(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function Um(c){return c>Mc?c*c*c:Sv*(c-wv)}const e2=Object.hasOwn||function(c,s){return Object.prototype.hasOwnProperty.call(c,s)};function Dc(c,s){return e2(c,s)?c[s]:void 0}function Xu(c){return parseInt(c.padEnd(2,c),16)/255}function Ns(c,s){return Qt(s?c/100:c,0,1)}function Qt(c,s,l){return Math.min(Math.max(s,c),l)}function $l(c){return!c.some(Number.isNaN)}const Ua={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Wo(c,s,l){return c+l*(s-c)}function Pl(c,s,l){return c.map(((p,m)=>Wo(p,s[m],l)))}class ei{constructor(s,l,p,m=1,x=!0){this.r=s,this.g=l,this.b=p,this.a=m,x||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[s,l,p,m]))}static parse(s){if(s instanceof ei)return s;if(typeof s!="string")return;const l=(function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=Dc(Ua,p);if(m){const[w,C,I]=m;return[w/255,C/255,I/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const w=p.length<6?1:2;let C=1;return[Xu(p.slice(C,C+=w)),Xu(p.slice(C,C+=w)),Xu(p.slice(C,C+=w)),Xu(p.slice(C,C+w)||"ff")]}if(p.startsWith("rgb")){const w=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[C,I,A,D,N,U,G,q,X,Q,ne,ye]=w,ue=[D||" ",G||" ",Q].join("");if(ue==="  "||ue==="  /"||ue===",,"||ue===",,,"){const de=[A,U,X].join(""),Me=de==="%%%"?100:de===""?255:0;if(Me){const Re=[Qt(+I/Me,0,1),Qt(+N/Me,0,1),Qt(+q/Me,0,1),ne?Ns(+ne,ye):1];if($l(Re))return Re}}return}}const x=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,C,I,A,D,N,U,G,q]=x,X=[I||" ",D||" ",U].join("");if(X==="  "||X==="  /"||X===",,"||X===",,,"){const Q=[+C,Qt(+A,0,100),Qt(+N,0,100),G?Ns(+G,q):1];if($l(Q))return(function([ne,ye,ue,de]){function Me(Re){const Ze=(Re+ne/30)%12,ct=ye*Math.min(ue,1-ue);return ue-ct*Math.max(-1,Math.min(Ze-3,9-Ze,1))}return ne=Fm(ne),ye/=100,ue/=100,[Me(0),Me(8),Me(4),de]})(Q)}}})(s);return l?new ei(...l,!1):void 0}get rgb(){const{r:s,g:l,b:p,a:m}=this,x=m||1/0;return this.overwriteGetter("rgb",[s/x,l/x,p/x,m])}get hcl(){return this.overwriteGetter("hcl",(function(s){const[l,p,m,x]=kc(s),w=Math.sqrt(p*p+m*m);return[Math.round(1e4*w)?Fm(Math.atan2(m,p)*Qw):NaN,w,l,x]})(this.rgb))}get lab(){return this.overwriteGetter("lab",kc(this.rgb))}overwriteGetter(s,l){return Object.defineProperty(this,s,{value:l}),l}toString(){const[s,l,p,m]=this.rgb;return`rgba(${[s,l,p].map((x=>Math.round(255*x))).join(",")},${m})`}static interpolate(s,l,p,m="rgb"){switch(m){case"rgb":{const[x,w,C,I]=Pl(s.rgb,l.rgb,p);return new ei(x,w,C,I,!1)}case"hcl":{const[x,w,C,I]=s.hcl,[A,D,N,U]=l.hcl;let G,q;if(isNaN(x)||isNaN(A))isNaN(x)?isNaN(A)?G=NaN:(G=A,C!==1&&C!==0||(q=D)):(G=x,N!==1&&N!==0||(q=w));else{let ue=A-x;A>x&&ue>180?ue-=360:A<x&&x-A>180&&(ue+=360),G=x+p*ue}const[X,Q,ne,ye]=(function([ue,de,Me,Re]){return ue=isNaN(ue)?0:ue*Kw,Ac([Me,Math.cos(ue)*de,Math.sin(ue)*de,Re])})([G,q??Wo(w,D,p),Wo(C,N,p),Wo(I,U,p)]);return new ei(X,Q,ne,ye,!1)}case"lab":{const[x,w,C,I]=Ac(Pl(s.lab,l.lab,p));return new ei(x,w,C,I,!1)}}}}ei.black=new ei(0,0,0,1),ei.white=new ei(1,1,1,1),ei.transparent=new ei(0,0,0,0),ei.red=new ei(1,0,0,1);class Ml{constructor(s,l,p){this.sensitivity=s?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,l){return this.collator.compare(s,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Nd=["bottom","center","top"];class Bd{constructor(s,l,p,m,x,w){this.text=s,this.image=l,this.scale=p,this.fontStack=m,this.textColor=x,this.verticalAlign=w}}class Sn{constructor(s){this.sections=s}static fromString(s){return new Sn([new Bd(s,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((s=>s.text.length!==0||s.image&&s.image.name.length!==0))}static factory(s){return s instanceof Sn?s:Sn.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map((s=>s.text)).join("")}}class Gr{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof Gr)return s;if(typeof s=="number")return new Gr([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const l of s)if(typeof l!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new Gr(s)}}toString(){return JSON.stringify(this.values)}static interpolate(s,l,p){return new Gr(Pl(s.values,l.values,p))}}class Tn{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof Tn)return s;if(typeof s=="number")return new Tn([s]);if(Array.isArray(s)){for(const l of s)if(typeof l!="number")return;return new Tn(s)}}toString(){return JSON.stringify(this.values)}static interpolate(s,l,p){return new Tn(Pl(s.values,l.values,p))}}class vr{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof vr)return s;if(typeof s=="string"){const p=ei.parse(s);return p?new vr([p]):void 0}if(!Array.isArray(s))return;const l=[];for(const p of s){if(typeof p!="string")return;const m=ei.parse(p);if(!m)return;l.push(m)}return new vr(l)}toString(){return JSON.stringify(this.values)}static interpolate(s,l,p,m="rgb"){const x=[];if(s.values.length!=l.values.length)throw new Error(`colorArray: Arrays have mismatched length (${s.values.length} vs. ${l.values.length}), cannot interpolate.`);for(let w=0;w<s.values.length;w++)x.push(ei.interpolate(s.values[w],l.values[w],p,m));return new vr(x)}}class Mi extends Error{constructor(s){super(s),this.name="RuntimeError"}toJSON(){return this.message}}const Tv=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Cn{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof Cn)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let l=0;l<s.length;l+=2){const p=s[l],m=s[l+1];if(typeof p!="string"||!Tv.has(p)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new Cn(s)}}toString(){return JSON.stringify(this.values)}static interpolate(s,l,p){const m=s.values,x=l.values;if(m.length!==x.length)throw new Mi(`Cannot interpolate values of different length. from: ${s.toString()}, to: ${l.toString()}`);const w=[];for(let C=0;C<m.length;C+=2){if(m[C]!==x[C])throw new Mi(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${m[C]}, to[${C}]: ${x[C]}`);w.push(m[C]);const[I,A]=m[C+1],[D,N]=x[C+1];w.push([Wo(I,D,p),Wo(A,N,p)])}return new Cn(w)}}class is{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new is({name:s,available:!1}):null}}class fn{constructor(s,l,p){this.from=s,this.to=l,this.transition=p}static interpolate(s,l,p){return new fn(s,l,p)}static parse(s){return s instanceof fn?s:Array.isArray(s)&&s.length===3&&typeof s[0]=="string"&&typeof s[1]=="string"&&typeof s[2]=="number"?new fn(s[0],s[1],s[2]):typeof s=="object"&&typeof s.from=="string"&&typeof s.to=="string"&&typeof s.transition=="number"?new fn(s.from,s.to,s.transition):typeof s=="string"?new fn(s,s,1):void 0}}function Ni(c,s,l,p){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof l=="number"&&l>=0&&l<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[c,s,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[c,s,l,p]:[c,s,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function kl(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof fn||c instanceof ei||c instanceof Ml||c instanceof Sn||c instanceof Gr||c instanceof Tn||c instanceof vr||c instanceof Cn||c instanceof is)return!0;if(Array.isArray(c)){for(const s of c)if(!kl(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!kl(c[s]))return!1;return!0}return!1}function kt(c){if(c===null)return $c;if(typeof c=="string")return Kt;if(typeof c=="boolean")return Wt;if(typeof c=="number")return pt;if(c instanceof ei)return on;if(c instanceof fn)return Il;if(c instanceof Ml)return Rd;if(c instanceof Sn)return Na;if(c instanceof Gr)return Ld;if(c instanceof Tn)return Pc;if(c instanceof vr)return To;if(c instanceof Cn)return Fd;if(c instanceof is)return tr;if(Array.isArray(c)){const s=c.length;let l;for(const p of c){const m=kt(p);if(l){if(l===m)continue;l=qt;break}l=m}return Fn(l||qt,s)}return Fa}function Bt(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof ei||c instanceof fn||c instanceof Sn||c instanceof Gr||c instanceof Tn||c instanceof vr||c instanceof Cn||c instanceof is?c.toString():JSON.stringify(c)}class Yo{constructor(s,l){this.type=s,this.value=l}static parse(s,l){if(s.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!kl(s[1]))return l.error("invalid value");const p=s[1];let m=kt(p);const x=l.expectedType;return m.kind!=="array"||m.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(m=x),new Yo(m,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ci={string:Kt,number:pt,boolean:Wt,object:Fa};class rs{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");let p,m=1;const x=s[0];if(x==="array"){let C,I;if(s.length>2){const A=s[1];if(typeof A!="string"||!(A in ci)||A==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);C=ci[A],m++}else C=qt;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return l.error('The length argument to "array" must be a positive integer literal',2);I=s[2],m++}p=Fn(C,I)}else{if(!ci[x])throw new Error(`Types doesn't contain name = ${x}`);p=ci[x]}const w=[];for(;m<s.length;m++){const C=l.parse(s[m],m,qt);if(!C)return null;w.push(C)}return new rs(p,w)}evaluate(s){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(s);if(!Yu(this.type,kt(p)))return p;if(l===this.args.length-1)throw new Mi(`Expected value to be of type ${Pi(this.type)}, but found ${Pi(kt(p))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every((s=>s.outputDefined()))}}const Co={"to-boolean":Wt,"to-color":on,"to-number":pt,"to-string":Kt};class Eo{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const p=s[0];if(!Co[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&s.length!==2)return l.error("Expected one argument.");const m=Co[p],x=[];for(let w=1;w<s.length;w++){const C=l.parse(s[w],w,qt);if(!C)return null;x.push(C)}return new Eo(m,x)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let l,p;for(const m of this.args){if(l=m.evaluate(s),p=null,l instanceof ei)return l;if(typeof l=="string"){const x=s.parseColor(l);if(x)return x}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rgba value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Ni(l[0],l[1],l[2],l[3]),!p))return new ei(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Mi(p||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const p of this.args){l=p.evaluate(s);const m=Gr.parse(l);if(m)return m}throw new Mi(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"numberArray":{let l;for(const p of this.args){l=p.evaluate(s);const m=Tn.parse(l);if(m)return m}throw new Mi(`Could not parse numberArray from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"colorArray":{let l;for(const p of this.args){l=p.evaluate(s);const m=vr.parse(l);if(m)return m}throw new Mi(`Could not parse colorArray from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const p of this.args){l=p.evaluate(s);const m=Cn.parse(l);if(m)return m}throw new Mi(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const p of this.args){if(l=p.evaluate(s),l===null)return 0;const m=Number(l);if(!isNaN(m))return m}throw new Mi(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return Sn.fromString(Bt(this.args[0].evaluate(s)));case"resolvedImage":return is.fromString(Bt(this.args[0].evaluate(s)));case"projectionDefinition":return this.args[0].evaluate(s);default:return Bt(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every((s=>s.outputDefined()))}}const jd=["Unknown","Point","LineString","Polygon"];class Vm{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?jd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let l=this._parseColorCache.get(s);return l||(l=ei.parse(s),this._parseColorCache.set(s,l)),l}}class zc{constructor(s,l,p=[],m,x=new La,w=[]){this.registry=s,this.path=p,this.key=p.map((C=>`[${C}]`)).join(""),this.scope=x,this.errors=w,this.expectedType=m,this._isConstant=l}parse(s,l,p,m,x={}){return l?this.concat(l,p,m)._parse(s,x):this._parse(s,x)}_parse(s,l){function p(m,x,w){return w==="assert"?new rs(x,[m]):w==="coerce"?new Eo(x,[m]):m}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=s[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[m];if(x){let w=x.parse(s,this);if(!w)return null;if(this.expectedType){const C=this.expectedType,I=w.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||I.kind!=="value"){if(C.kind==="projectionDefinition"&&["string","array"].includes(I.kind)||["color","formatted","resolvedImage"].includes(C.kind)&&["value","string"].includes(I.kind)||["padding","numberArray"].includes(C.kind)&&["value","number","array"].includes(I.kind)||C.kind==="colorArray"&&["value","string","array"].includes(I.kind)||C.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(I.kind))w=p(w,C,l.typeAnnotation||"coerce");else if(this.checkSubtype(C,I))return null}else w=p(w,C,l.typeAnnotation||"assert")}if(!(w instanceof Yo)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const C=new Vm;try{w=new Yo(w.type,w.evaluate(C))}catch(I){return this.error(I.message),null}}return w}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,l,p){const m=typeof s=="number"?this.path.concat(s):this.path,x=p?this.scope.concat(p):this.scope;return new zc(this.registry,this._isConstant,m,l||null,x,this.errors)}error(s,...l){const p=`${this.key}${l.map((m=>`[${m}]`)).join("")}`;this.errors.push(new Wi(p,s))}checkSubtype(s,l){const p=Yu(s,l);return p&&this.error(p),p}}class Ju{constructor(s,l){this.type=l.type,this.bindings=[].concat(s),this.result=l}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const l of this.bindings)s(l[1]);s(this.result)}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const p=[];for(let x=1;x<s.length-1;x+=2){const w=s[x];if(typeof w!="string")return l.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return l.error("Variable names must contain only alphanumeric characters or '_'.",x);const C=l.parse(s[x+1],x+1);if(!C)return null;p.push([w,C])}const m=l.parse(s[s.length-1],s.length-1,l.expectedType,p);return m?new Ju(p,m):null}outputDefined(){return this.result.outputDefined()}}class Ud{constructor(s,l){this.type=l.type,this.name=s,this.boundExpression=l}static parse(s,l){if(s.length!==2||typeof s[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const p=s[1];return l.scope.has(p)?new Ud(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class Vd{constructor(s,l,p){this.type=s,this.index=l,this.input=p}static parse(s,l){if(s.length!==3)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,pt),m=l.parse(s[2],2,Fn(l.expectedType||qt));return p&&m?new Vd(m.type.itemType,p,m):null}evaluate(s){const l=this.index.evaluate(s),p=this.input.evaluate(s);if(l<0)throw new Mi(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new Mi(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new Mi(`Array index must be an integer, but found ${l} instead.`);return p[l]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class Gd{constructor(s,l){this.type=Wt,this.needle=s,this.haystack=l}static parse(s,l){if(s.length!==3)return l.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,qt),m=l.parse(s[2],2,qt);return p&&m?Rm(p.type,[Wt,Kt,pt,$c,qt])?new Gd(p,m):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(p.type)} instead`):null}evaluate(s){const l=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!p)return!1;if(!Ba(l,["boolean","string","number","null"]))throw new Mi(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(kt(l))} instead.`);if(!Ba(p,["string","array"]))throw new Mi(`Expected second argument to be of type array or string, but found ${Pi(kt(p))} instead.`);return p.indexOf(l)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Bs{constructor(s,l,p){this.type=pt,this.needle=s,this.haystack=l,this.fromIndex=p}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,qt),m=l.parse(s[2],2,qt);if(!p||!m)return null;if(!Rm(p.type,[Wt,Kt,pt,$c,qt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(p.type)} instead`);if(s.length===4){const x=l.parse(s[3],3,pt);return x?new Bs(p,m,x):null}return new Bs(p,m)}evaluate(s){const l=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!Ba(l,["boolean","string","number","null"]))throw new Mi(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(kt(l))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(s)),Ba(p,["string"])){const x=p.indexOf(l,m);return x===-1?-1:[...p.slice(0,x)].length}if(Ba(p,["array"]))return p.indexOf(l,m);throw new Mi(`Expected second argument to be of type array or string, but found ${Pi(kt(p))} instead.`)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class qr{constructor(s,l,p,m,x,w){this.inputType=s,this.type=l,this.input=p,this.cases=m,this.outputs=x,this.otherwise=w}static parse(s,l){if(s.length<5)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return l.error("Expected an even number of arguments.");let p,m;l.expectedType&&l.expectedType.kind!=="value"&&(m=l.expectedType);const x={},w=[];for(let A=2;A<s.length-1;A+=2){let D=s[A];const N=s[A+1];Array.isArray(D)||(D=[D]);const U=l.concat(A);if(D.length===0)return U.error("Expected at least one branch label.");for(const q of D){if(typeof q!="number"&&typeof q!="string")return U.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return U.error("Numeric branch labels must be integer values.");if(p){if(U.checkSubtype(p,kt(q)))return null}else p=kt(q);if(x[String(q)]!==void 0)return U.error("Branch labels must be unique.");x[String(q)]=w.length}const G=l.parse(N,A,m);if(!G)return null;m=m||G.type,w.push(G)}const C=l.parse(s[1],1,qt);if(!C)return null;const I=l.parse(s[s.length-1],s.length-1,m);return I?C.type.kind!=="value"&&l.concat(1).checkSubtype(p,C.type)?null:new qr(p,m,C,x,w,I):null}evaluate(s){const l=this.input.evaluate(s);return(kt(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every((s=>s.outputDefined()))&&this.otherwise.outputDefined()}}class Oc{constructor(s,l,p){this.type=s,this.branches=l,this.otherwise=p}static parse(s,l){if(s.length<4)return l.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const m=[];for(let w=1;w<s.length-1;w+=2){const C=l.parse(s[w],w,Wt);if(!C)return null;const I=l.parse(s[w+1],w+1,p);if(!I)return null;m.push([C,I]),p=p||I.type}const x=l.parse(s[s.length-1],s.length-1,p);if(!x)return null;if(!p)throw new Error("Can't infer output type");return new Oc(p,m,x)}evaluate(s){for(const[l,p]of this.branches)if(l.evaluate(s))return p.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[l,p]of this.branches)s(l),s(p);s(this.otherwise)}outputDefined(){return this.branches.every((([s,l])=>l.outputDefined()))&&this.otherwise.outputDefined()}}class Ku{constructor(s,l,p,m){this.type=s,this.input=l,this.beginIndex=p,this.endIndex=m}static parse(s,l){if(s.length<=2||s.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=l.parse(s[1],1,qt),m=l.parse(s[2],2,pt);if(!p||!m)return null;if(!Rm(p.type,[Fn(qt),Kt,qt]))return l.error(`Expected first argument to be of type array or string, but found ${Pi(p.type)} instead`);if(s.length===4){const x=l.parse(s[3],3,pt);return x?new Ku(p.type,p,m,x):null}return new Ku(p.type,p,m)}evaluate(s){const l=this.input.evaluate(s),p=this.beginIndex.evaluate(s);let m;if(this.endIndex&&(m=this.endIndex.evaluate(s)),Ba(l,["string"]))return[...l].slice(p,m).join("");if(Ba(l,["array"]))return l.slice(p,m);throw new Mi(`Expected first argument to be of type array or string, but found ${Pi(kt(l))} instead.`)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function Al(c,s){const l=c.length-1;let p,m,x=0,w=l,C=0;for(;x<=w;)if(C=Math.floor((x+w)/2),p=c[C],m=c[C+1],p<=s){if(C===l||s<m)return C;x=C+1}else{if(!(p>s))throw new Mi("Input is not a number.");w=C-1}return 0}class ir{constructor(s,l,p){this.type=s,this.input=l,this.labels=[],this.outputs=[];for(const[m,x]of p)this.labels.push(m),this.outputs.push(x)}static parse(s,l){if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(s[1],1,pt);if(!p)return null;const m=[];let x=null;l.expectedType&&l.expectedType.kind!=="value"&&(x=l.expectedType);for(let w=1;w<s.length;w+=2){const C=w===1?-1/0:s[w],I=s[w+1],A=w,D=w+1;if(typeof C!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(m.length&&m[m.length-1][0]>=C)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const N=l.parse(I,D,x);if(!N)return null;x=x||N.type,m.push([C,N])}return new ir(x,p,m)}evaluate(s){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(s);const m=this.input.evaluate(s);if(m<=l[0])return p[0].evaluate(s);const x=l.length;return m>=l[x-1]?p[x-1].evaluate(s):p[Al(l,m)].evaluate(s)}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every((s=>s.outputDefined()))}}function Cv(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Qu,Gm,t2=(function(){if(Gm)return Qu;function c(s,l,p,m){this.cx=3*s,this.bx=3*(p-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(m-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=l,this.p2x=p,this.p2y=m}return Gm=1,Qu=c,c.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,l){if(l===void 0&&(l=1e-6),s<0)return 0;if(s>1)return 1;for(var p=s,m=0;m<8;m++){var x=this.sampleCurveX(p)-s;if(Math.abs(x)<l)return p;var w=this.sampleCurveDerivativeX(p);if(Math.abs(w)<1e-6)break;p-=x/w}var C=0,I=1;for(p=s,m=0;m<20&&(x=this.sampleCurveX(p),!(Math.abs(x-s)<l));m++)s>x?C=p:I=p,p=.5*(I-C)+C;return p},solve:function(s,l){return this.sampleCurveY(this.solveCurveX(s,l))}},Qu})(),Rc=Cv(t2);class an{constructor(s,l,p,m,x){this.type=s,this.operator=l,this.interpolation=p,this.input=m,this.labels=[],this.outputs=[];for(const[w,C]of x)this.labels.push(w),this.outputs.push(C)}static interpolationFactor(s,l,p,m){let x=0;if(s.name==="exponential")x=eh(l,s.base,p,m);else if(s.name==="linear")x=eh(l,1,p,m);else if(s.name==="cubic-bezier"){const w=s.controlPoints;x=new Rc(w[0],w[1],w[2],w[3]).solve(eh(l,1,p,m))}return x}static parse(s,l){let[p,m,x,...w]=s;if(!Array.isArray(m)||m.length===0)return l.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const A=m[1];if(typeof A!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:A}}else{if(m[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const A=m.slice(1);if(A.length!==4||A.some((D=>typeof D!="number"||D<0||D>1)))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:A}}}if(s.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(x=l.parse(x,2,pt),!x)return null;const C=[];let I=null;p!=="interpolate-hcl"&&p!=="interpolate-lab"||l.expectedType==To?l.expectedType&&l.expectedType.kind!=="value"&&(I=l.expectedType):I=on;for(let A=0;A<w.length;A+=2){const D=w[A],N=w[A+1],U=A+3,G=A+4;if(typeof D!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(C.length&&C[C.length-1][0]>=D)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const q=l.parse(N,G,I);if(!q)return null;I=I||q.type,C.push([D,q])}return ja(I,pt)||ja(I,Il)||ja(I,on)||ja(I,Ld)||ja(I,Pc)||ja(I,To)||ja(I,Fd)||ja(I,Fn(pt))?new an(I,p,m,x,C):l.error(`Type ${Pi(I)} is not interpolatable.`)}evaluate(s){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(s);const m=this.input.evaluate(s);if(m<=l[0])return p[0].evaluate(s);const x=l.length;if(m>=l[x-1])return p[x-1].evaluate(s);const w=Al(l,m),C=an.interpolationFactor(this.interpolation,m,l[w],l[w+1]),I=p[w].evaluate(s),A=p[w+1].evaluate(s);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Wo(I,A,C);case"color":return ei.interpolate(I,A,C);case"padding":return Gr.interpolate(I,A,C);case"colorArray":return vr.interpolate(I,A,C);case"numberArray":return Tn.interpolate(I,A,C);case"variableAnchorOffsetCollection":return Cn.interpolate(I,A,C);case"array":return Pl(I,A,C);case"projectionDefinition":return fn.interpolate(I,A,C)}case"interpolate-hcl":switch(this.type.kind){case"color":return ei.interpolate(I,A,C,"hcl");case"colorArray":return vr.interpolate(I,A,C,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return ei.interpolate(I,A,C,"lab");case"colorArray":return vr.interpolate(I,A,C,"lab")}}}eachChild(s){s(this.input);for(const l of this.outputs)s(l)}outputDefined(){return this.outputs.every((s=>s.outputDefined()))}}function eh(c,s,l,p){const m=p-l,x=c-l;return m===0?0:s===1?x/m:(Math.pow(s,x)-1)/(Math.pow(s,m)-1)}const Io={color:ei.interpolate,number:Wo,padding:Gr.interpolate,numberArray:Tn.interpolate,colorArray:vr.interpolate,variableAnchorOffsetCollection:Cn.interpolate,array:Pl};class th{constructor(s,l){this.type=s,this.args=l}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");let p=null;const m=l.expectedType;m&&m.kind!=="value"&&(p=m);const x=[];for(const C of s.slice(1)){const I=l.parse(C,1+x.length,p,void 0,{typeAnnotation:"omit"});if(!I)return null;p=p||I.type,x.push(I)}if(!p)throw new Error("No output type");const w=m&&x.some((C=>Yu(m,C.type)));return new th(w?qt:p,x)}evaluate(s){let l,p=null,m=0;for(const x of this.args)if(m++,p=x.evaluate(s),p&&p instanceof is&&!p.available&&(l||(l=p.name),p=null,m===this.args.length&&(p=l)),p!==null)break;return p}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every((s=>s.outputDefined()))}}function ih(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function rh(c,s,l,p){return p.compare(s,l)===0}function mn(c,s,l){const p=c!=="=="&&c!=="!=";return class Gz{constructor(x,w,C){this.type=Wt,this.lhs=x,this.rhs=w,this.collator=C,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const C=x[0];let I=w.parse(x[1],1,qt);if(!I)return null;if(!ih(C,I.type))return w.concat(1).error(`"${C}" comparisons are not supported for type '${Pi(I.type)}'.`);let A=w.parse(x[2],2,qt);if(!A)return null;if(!ih(C,A.type))return w.concat(2).error(`"${C}" comparisons are not supported for type '${Pi(A.type)}'.`);if(I.type.kind!==A.type.kind&&I.type.kind!=="value"&&A.type.kind!=="value")return w.error(`Cannot compare types '${Pi(I.type)}' and '${Pi(A.type)}'.`);p&&(I.type.kind==="value"&&A.type.kind!=="value"?I=new rs(A.type,[I]):I.type.kind!=="value"&&A.type.kind==="value"&&(A=new rs(I.type,[A])));let D=null;if(x.length===4){if(I.type.kind!=="string"&&A.type.kind!=="string"&&I.type.kind!=="value"&&A.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(D=w.parse(x[3],3,Rd),!D)return null}return new Gz(I,A,D)}evaluate(x){const w=this.lhs.evaluate(x),C=this.rhs.evaluate(x);if(p&&this.hasUntypedArgument){const I=kt(w),A=kt(C);if(I.kind!==A.kind||I.kind!=="string"&&I.kind!=="number")throw new Mi(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${I.kind}, ${A.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const I=kt(w),A=kt(C);if(I.kind!=="string"||A.kind!=="string")return s(x,w,C)}return this.collator?l(x,w,C,this.collator.evaluate(x)):s(x,w,C)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const Ev=mn("==",(function(c,s,l){return s===l}),rh),qd=mn("!=",(function(c,s,l){return s!==l}),(function(c,s,l,p){return!rh(0,s,l,p)})),i2=mn("<",(function(c,s,l){return s<l}),(function(c,s,l,p){return p.compare(s,l)<0})),qm=mn(">",(function(c,s,l){return s>l}),(function(c,s,l,p){return p.compare(s,l)>0})),r2=mn("<=",(function(c,s,l){return s<=l}),(function(c,s,l,p){return p.compare(s,l)<=0})),n2=mn(">=",(function(c,s,l){return s>=l}),(function(c,s,l,p){return p.compare(s,l)>=0}));class Hd{constructor(s,l,p){this.type=Rd,this.locale=p,this.caseSensitive=s,this.diacriticSensitive=l}static parse(s,l){if(s.length!==2)return l.error("Expected one argument.");const p=s[1];if(typeof p!="object"||Array.isArray(p))return l.error("Collator options argument must be an object.");const m=l.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Wt);if(!m)return null;const x=l.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Wt);if(!x)return null;let w=null;return p.locale&&(w=l.parse(p.locale,1,Kt),!w)?null:new Hd(m,x,w)}evaluate(s){return new Ml(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}class Hm{constructor(s,l,p,m,x){this.type=Kt,this.number=s,this.locale=l,this.currency=p,this.minFractionDigits=m,this.maxFractionDigits=x}static parse(s,l){if(s.length!==3)return l.error("Expected two arguments.");const p=l.parse(s[1],1,pt);if(!p)return null;const m=s[2];if(typeof m!="object"||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");let x=null;if(m.locale&&(x=l.parse(m.locale,1,Kt),!x))return null;let w=null;if(m.currency&&(w=l.parse(m.currency,1,Kt),!w))return null;let C=null;if(m["min-fraction-digits"]&&(C=l.parse(m["min-fraction-digits"],1,pt),!C))return null;let I=null;return m["max-fraction-digits"]&&(I=l.parse(m["max-fraction-digits"],1,pt),!I)?null:new Hm(p,x,w,C,I)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class Dl{constructor(s){this.type=Na,this.sections=s}static parse(s,l){if(s.length<2)return l.error("Expected at least one argument.");const p=s[1];if(!Array.isArray(p)&&typeof p=="object")return l.error("First argument must be an image or text section.");const m=[];let x=!1;for(let w=1;w<=s.length-1;++w){const C=s[w];if(x&&typeof C=="object"&&!Array.isArray(C)){x=!1;let I=null;if(C["font-scale"]&&(I=l.parse(C["font-scale"],1,pt),!I))return null;let A=null;if(C["text-font"]&&(A=l.parse(C["text-font"],1,Fn(Kt)),!A))return null;let D=null;if(C["text-color"]&&(D=l.parse(C["text-color"],1,on),!D))return null;let N=null;if(C["vertical-align"]){if(typeof C["vertical-align"]=="string"&&!Nd.includes(C["vertical-align"]))return l.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${C["vertical-align"]}' instead.`);if(N=l.parse(C["vertical-align"],1,Kt),!N)return null}const U=m[m.length-1];U.scale=I,U.font=A,U.textColor=D,U.verticalAlign=N}else{const I=l.parse(s[w],1,qt);if(!I)return null;const A=I.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,m.push({content:I,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Dl(m)}evaluate(s){return new Sn(this.sections.map((l=>{const p=l.content.evaluate(s);return kt(p)===tr?new Bd("",p,null,null,null,l.verticalAlign?l.verticalAlign.evaluate(s):null):new Bd(Bt(p),null,l.scale?l.scale.evaluate(s):null,l.font?l.font.evaluate(s).join(","):null,l.textColor?l.textColor.evaluate(s):null,l.verticalAlign?l.verticalAlign.evaluate(s):null)})))}eachChild(s){for(const l of this.sections)s(l.content),l.scale&&s(l.scale),l.font&&s(l.font),l.textColor&&s(l.textColor),l.verticalAlign&&s(l.verticalAlign)}outputDefined(){return!1}}class Zm{constructor(s){this.type=tr,this.input=s}static parse(s,l){if(s.length!==2)return l.error("Expected two arguments.");const p=l.parse(s[1],1,Kt);return p?new Zm(p):l.error("No image name provided.")}evaluate(s){const l=this.input.evaluate(s),p=is.fromString(l);return p&&s.availableImages&&(p.available=s.availableImages.indexOf(l)>-1),p}eachChild(s){s(this.input)}outputDefined(){return!1}}class Zd{constructor(s){this.type=pt,this.input=s}static parse(s,l){if(s.length!==2)return l.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=l.parse(s[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${Pi(p.type)} instead.`):new Zd(p):null}evaluate(s){const l=this.input.evaluate(s);if(typeof l=="string")return[...l].length;if(Array.isArray(l))return l.length;throw new Mi(`Expected value to be of type string or array, but found ${Pi(kt(l))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const js=8192;function s2(c,s){const l=(180+c[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(l*m*js),Math.round(p*m*js)]}function Wd(c,s){const l=Math.pow(2,s.z);return[(m=(c[0]/js+s.x)/l,360*m-180),(p=(c[1]/js+s.y)/l,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,m}function nh(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function sh(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function o2(c,s,l){const p=c[0]-s[0],m=c[1]-s[1],x=c[0]-l[0],w=c[1]-l[1];return p*w-x*m==0&&p*x<=0&&m*w<=0}function Yd(c,s,l,p){return(m=[p[0]-l[0],p[1]-l[1]])[0]*(x=[s[0]-c[0],s[1]-c[1]])[1]-m[1]*x[0]!=0&&!(!$v(c,s,l,p)||!$v(l,p,c,s));var m,x}function a2(c,s,l){for(const p of l)for(let m=0;m<p.length-1;++m)if(Yd(c,s,p[m],p[m+1]))return!0;return!1}function zl(c,s,l=!1){let p=!1;for(const C of s)for(let I=0;I<C.length-1;I++){if(o2(c,C[I],C[I+1]))return l;(x=C[I])[1]>(m=c)[1]!=(w=C[I+1])[1]>m[1]&&m[0]<(w[0]-x[0])*(m[1]-x[1])/(w[1]-x[1])+x[0]&&(p=!p)}var m,x,w;return p}function Iv(c,s){for(const l of s)if(zl(c,l))return!0;return!1}function Wm(c,s){for(const l of c)if(!zl(l,s))return!1;for(let l=0;l<c.length-1;++l)if(a2(c[l],c[l+1],s))return!1;return!0}function l2(c,s){for(const l of s)if(Wm(c,l))return!0;return!1}function $v(c,s,l,p){const m=p[0]-l[0],x=p[1]-l[1],w=(c[0]-l[0])*x-m*(c[1]-l[1]),C=(s[0]-l[0])*x-m*(s[1]-l[1]);return w>0&&C<0||w<0&&C>0}function Ym(c,s,l){const p=[];for(let m=0;m<c.length;m++){const x=[];for(let w=0;w<c[m].length;w++){const C=s2(c[m][w],l);nh(s,C),x.push(C)}p.push(x)}return p}function Pv(c,s,l){const p=[];for(let m=0;m<c.length;m++){const x=Ym(c[m],s,l);p.push(x)}return p}function Xd(c,s,l,p){if(c[0]<l[0]||c[0]>l[2]){const m=.5*p;let x=c[0]-l[0]>m?-p:l[0]-c[0]>m?p:0;x===0&&(x=c[0]-l[2]>m?-p:l[2]-c[0]>m?p:0),c[0]+=x}nh(s,c)}function Mv(c,s,l,p){const m=Math.pow(2,p.z)*js,x=[p.x*js,p.y*js],w=[];for(const C of c)for(const I of C){const A=[I.x+x[0],I.y+x[1]];Xd(A,s,l,m),w.push(A)}return w}function kv(c,s,l,p){const m=Math.pow(2,p.z)*js,x=[p.x*js,p.y*js],w=[];for(const I of c){const A=[];for(const D of I){const N=[D.x+x[0],D.y+x[1]];nh(s,N),A.push(N)}w.push(A)}if(s[2]-s[0]<=m/2){(C=s)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const I of w)for(const A of I)Xd(A,s,l,m)}var C;return w}class Ol{constructor(s,l){this.type=Wt,this.geojson=s,this.geometries=l}static parse(s,l){if(s.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(kl(s[1])){const p=s[1];if(p.type==="FeatureCollection"){const m=[];for(const x of p.features){const{type:w,coordinates:C}=x.geometry;w==="Polygon"&&m.push(C),w==="MultiPolygon"&&m.push(...C)}if(m.length)return new Ol(p,{type:"MultiPolygon",coordinates:m})}else if(p.type==="Feature"){const m=p.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Ol(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Ol(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return(function(l,p){const m=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(p.type==="Polygon"){const C=Ym(p.coordinates,x,w),I=Mv(l.geometry(),m,x,w);if(!sh(m,x))return!1;for(const A of I)if(!zl(A,C))return!1}if(p.type==="MultiPolygon"){const C=Pv(p.coordinates,x,w),I=Mv(l.geometry(),m,x,w);if(!sh(m,x))return!1;for(const A of I)if(!Iv(A,C))return!1}return!0})(s,this.geometries);if(s.geometryType()==="LineString")return(function(l,p){const m=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(p.type==="Polygon"){const C=Ym(p.coordinates,x,w),I=kv(l.geometry(),m,x,w);if(!sh(m,x))return!1;for(const A of I)if(!Wm(A,C))return!1}if(p.type==="MultiPolygon"){const C=Pv(p.coordinates,x,w),I=kv(l.geometry(),m,x,w);if(!sh(m,x))return!1;for(const A of I)if(!l2(A,C))return!1}return!0})(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Xm=class{constructor(c=[],s=(l,p)=>l<p?-1:l>p?1:0){if(this.data=c,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:s,compare:l}=this,p=s[c];for(;c>0;){const m=c-1>>1,x=s[m];if(l(p,x)>=0)break;s[c]=x,c=m}s[c]=p}_down(c){const{data:s,compare:l}=this,p=this.length>>1,m=s[c];for(;c<p;){let x=1+(c<<1);const w=x+1;if(w<this.length&&l(s[w],s[x])<0&&(x=w),l(s[x],m)>=0)break;s[c]=s[x],c=x}s[c]=m}};function Jm(c,s,l=0,p=c.length-1,m=c2){for(;p>l;){if(p-l>600){const I=p-l+1,A=s-l+1,D=Math.log(I),N=.5*Math.exp(2*D/3),U=.5*Math.sqrt(D*N*(I-N)/I)*(A-I/2<0?-1:1);Jm(c,s,Math.max(l,Math.floor(s-A*N/I+U)),Math.min(p,Math.floor(s+(I-A)*N/I+U)),m)}const x=c[s];let w=l,C=p;for(oh(c,l,s),m(c[p],x)>0&&oh(c,l,p);w<C;){for(oh(c,w,C),w++,C--;m(c[w],x)<0;)w++;for(;m(c[C],x)>0;)C--}m(c[l],x)===0?oh(c,l,C):(C++,oh(c,C,p)),C<=s&&(l=C+1),s<=C&&(p=C-1)}}function oh(c,s,l){const p=c[s];c[s]=c[l],c[l]=p}function c2(c,s){return c<s?-1:c>s?1:0}function ah(c,s){if(c.length<=1)return[c];const l=[];let p,m;for(const x of c){const w=u2(x);w!==0&&(x.area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(p&&l.push(p),p=[x]):p.push(x))}if(p&&l.push(p),s>1)for(let x=0;x<l.length;x++)l[x].length<=s||(Jm(l[x],s,1,l[x].length-1,Av),l[x]=l[x].slice(0,s));return l}function Av(c,s){return s.area-c.area}function u2(c){let s=0;for(let l,p,m=0,x=c.length,w=x-1;m<x;w=m++)l=c[m],p=c[w],s+=(p.x-l.x)*(l.y+p.y);return s}const Dv=1/298.257223563,zv=Dv*(2-Dv),Km=Math.PI/180;class Qm{constructor(s){const l=6378.137*Km*1e3,p=Math.cos(s*Km),m=1/(1-zv*(1-p*p)),x=Math.sqrt(m);this.kx=l*x*p,this.ky=l*x*m*(1-zv)}distance(s,l){const p=this.wrap(s[0]-l[0])*this.kx,m=(s[1]-l[1])*this.ky;return Math.sqrt(p*p+m*m)}pointOnLine(s,l){let p,m,x,w,C=1/0;for(let I=0;I<s.length-1;I++){let A=s[I][0],D=s[I][1],N=this.wrap(s[I+1][0]-A)*this.kx,U=(s[I+1][1]-D)*this.ky,G=0;N===0&&U===0||(G=(this.wrap(l[0]-A)*this.kx*N+(l[1]-D)*this.ky*U)/(N*N+U*U),G>1?(A=s[I+1][0],D=s[I+1][1]):G>0&&(A+=N/this.kx*G,D+=U/this.ky*G)),N=this.wrap(l[0]-A)*this.kx,U=(l[1]-D)*this.ky;const q=N*N+U*U;q<C&&(C=q,p=A,m=D,x=I,w=G)}return{point:[p,m],index:x,t:Math.max(0,Math.min(1,w))}}wrap(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s}}function Ov(c,s){return s[0]-c[0]}function Jd(c){return c[1]-c[0]+1}function Xo(c,s){return c[1]>=c[0]&&c[1]<s}function pi(c,s){if(c[0]>c[1])return[null,null];const l=Jd(c);if(s){if(l===2)return[c,null];const m=Math.floor(l/2);return[[c[0],c[0]+m],[c[0]+m,c[1]]]}if(l===1)return[c,null];const p=Math.floor(l/2)-1;return[[c[0],c[0]+p],[c[0]+p+1,c[1]]]}function eg(c,s){if(!Xo(s,c.length))return[1/0,1/0,-1/0,-1/0];const l=[1/0,1/0,-1/0,-1/0];for(let p=s[0];p<=s[1];++p)nh(l,c[p]);return l}function tg(c){const s=[1/0,1/0,-1/0,-1/0];for(const l of c)for(const p of l)nh(s,p);return s}function Rv(c){return c[0]!==-1/0&&c[1]!==-1/0&&c[2]!==1/0&&c[3]!==1/0}function ig(c,s,l){if(!Rv(c)||!Rv(s))return NaN;let p=0,m=0;return c[2]<s[0]&&(p=s[0]-c[2]),c[0]>s[2]&&(p=c[0]-s[2]),c[1]>s[3]&&(m=c[1]-s[3]),c[3]<s[1]&&(m=s[1]-c[3]),l.distance([0,0],[p,m])}function Rl(c,s,l){const p=l.pointOnLine(s,c);return l.distance(c,p.point)}function rg(c,s,l,p,m){const x=Math.min(Rl(c,[l,p],m),Rl(s,[l,p],m)),w=Math.min(Rl(l,[c,s],m),Rl(p,[c,s],m));return Math.min(x,w)}function h2(c,s,l,p,m){if(!Xo(s,c.length)||!Xo(p,l.length))return 1/0;let x=1/0;for(let w=s[0];w<s[1];++w){const C=c[w],I=c[w+1];for(let A=p[0];A<p[1];++A){const D=l[A],N=l[A+1];if(Yd(C,I,D,N))return 0;x=Math.min(x,rg(C,I,D,N,m))}}return x}function d2(c,s,l,p,m){if(!Xo(s,c.length)||!Xo(p,l.length))return NaN;let x=1/0;for(let w=s[0];w<=s[1];++w)for(let C=p[0];C<=p[1];++C)if(x=Math.min(x,m.distance(c[w],l[C])),x===0)return x;return x}function p2(c,s,l){if(zl(c,s,!0))return 0;let p=1/0;for(const m of s){const x=m[0],w=m[m.length-1];if(x!==w&&(p=Math.min(p,Rl(c,[w,x],l)),p===0))return p;const C=l.pointOnLine(m,c);if(p=Math.min(p,l.distance(c,C.point)),p===0)return p}return p}function f2(c,s,l,p){if(!Xo(s,c.length))return NaN;for(let x=s[0];x<=s[1];++x)if(zl(c[x],l,!0))return 0;let m=1/0;for(let x=s[0];x<s[1];++x){const w=c[x],C=c[x+1];for(const I of l)for(let A=0,D=I.length,N=D-1;A<D;N=A++){const U=I[N],G=I[A];if(Yd(w,C,U,G))return 0;m=Math.min(m,rg(w,C,U,G,p))}}return m}function Lv(c,s){for(const l of c)for(const p of l)if(zl(p,s,!0))return!0;return!1}function m2(c,s,l,p=1/0){const m=tg(c),x=tg(s);if(p!==1/0&&ig(m,x,l)>=p)return p;if(sh(m,x)){if(Lv(c,s))return 0}else if(Lv(s,c))return 0;let w=1/0;for(const C of c)for(let I=0,A=C.length,D=A-1;I<A;D=I++){const N=C[D],U=C[I];for(const G of s)for(let q=0,X=G.length,Q=X-1;q<X;Q=q++){const ne=G[Q],ye=G[q];if(Yd(N,U,ne,ye))return 0;w=Math.min(w,rg(N,U,ne,ye,l))}}return w}function Fv(c,s,l,p,m,x){if(!x)return;const w=ig(eg(p,x),m,l);w<s&&c.push([w,x,[0,0]])}function Kd(c,s,l,p,m,x,w){if(!x||!w)return;const C=ig(eg(p,x),eg(m,w),l);C<s&&c.push([C,x,w])}function Qd(c,s,l,p,m=1/0){let x=Math.min(p.distance(c[0],l[0][0]),m);if(x===0)return x;const w=new Xm([[0,[0,c.length-1],[0,0]]],Ov),C=tg(l);for(;w.length>0;){const I=w.pop();if(I[0]>=x)continue;const A=I[1],D=s?50:100;if(Jd(A)<=D){if(!Xo(A,c.length))return NaN;if(s){const N=f2(c,A,l,p);if(isNaN(N)||N===0)return N;x=Math.min(x,N)}else for(let N=A[0];N<=A[1];++N){const U=p2(c[N],l,p);if(x=Math.min(x,U),x===0)return 0}}else{const N=pi(A,s);Fv(w,x,p,c,C,N[0]),Fv(w,x,p,c,C,N[1])}}return x}function ep(c,s,l,p,m,x=1/0){let w=Math.min(x,m.distance(c[0],l[0]));if(w===0)return w;const C=new Xm([[0,[0,c.length-1],[0,l.length-1]]],Ov);for(;C.length>0;){const I=C.pop();if(I[0]>=w)continue;const A=I[1],D=I[2],N=s?50:100,U=p?50:100;if(Jd(A)<=N&&Jd(D)<=U){if(!Xo(A,c.length)&&Xo(D,l.length))return NaN;let G;if(s&&p)G=h2(c,A,l,D,m),w=Math.min(w,G);else if(s&&!p){const q=c.slice(A[0],A[1]+1);for(let X=D[0];X<=D[1];++X)if(G=Rl(l[X],q,m),w=Math.min(w,G),w===0)return w}else if(!s&&p){const q=l.slice(D[0],D[1]+1);for(let X=A[0];X<=A[1];++X)if(G=Rl(c[X],q,m),w=Math.min(w,G),w===0)return w}else G=d2(c,A,l,D,m),w=Math.min(w,G)}else{const G=pi(A,s),q=pi(D,p);Kd(C,w,m,c,l,G[0],q[0]),Kd(C,w,m,c,l,G[0],q[1]),Kd(C,w,m,c,l,G[1],q[0]),Kd(C,w,m,c,l,G[1],q[1])}}return w}function ng(c){return c.type==="MultiPolygon"?c.coordinates.map((s=>({type:"Polygon",coordinates:s}))):c.type==="MultiLineString"?c.coordinates.map((s=>({type:"LineString",coordinates:s}))):c.type==="MultiPoint"?c.coordinates.map((s=>({type:"Point",coordinates:s}))):[c]}class Ll{constructor(s,l){this.type=pt,this.geojson=s,this.geometries=l}static parse(s,l){if(s.length!==2)return l.error(`'distance' expression requires exactly one argument, but found ${s.length-1} instead.`);if(kl(s[1])){const p=s[1];if(p.type==="FeatureCollection")return new Ll(p,p.features.map((m=>ng(m.geometry))).flat());if(p.type==="Feature")return new Ll(p,ng(p.geometry));if("type"in p&&"coordinates"in p)return new Ll(p,ng(p))}return l.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return(function(l,p){const m=l.geometry(),x=m.flat().map((I=>Wd([I.x,I.y],l.canonical)));if(m.length===0)return NaN;const w=new Qm(x[0][1]);let C=1/0;for(const I of p){switch(I.type){case"Point":C=Math.min(C,ep(x,!1,[I.coordinates],!1,w,C));break;case"LineString":C=Math.min(C,ep(x,!1,I.coordinates,!0,w,C));break;case"Polygon":C=Math.min(C,Qd(x,!1,I.coordinates,w,C))}if(C===0)return C}return C})(s,this.geometries);if(s.geometryType()==="LineString")return(function(l,p){const m=l.geometry(),x=m.flat().map((I=>Wd([I.x,I.y],l.canonical)));if(m.length===0)return NaN;const w=new Qm(x[0][1]);let C=1/0;for(const I of p){switch(I.type){case"Point":C=Math.min(C,ep(x,!0,[I.coordinates],!1,w,C));break;case"LineString":C=Math.min(C,ep(x,!0,I.coordinates,!0,w,C));break;case"Polygon":C=Math.min(C,Qd(x,!0,I.coordinates,w,C))}if(C===0)return C}return C})(s,this.geometries);if(s.geometryType()==="Polygon")return(function(l,p){const m=l.geometry();if(m.length===0||m[0].length===0)return NaN;const x=ah(m,0).map((I=>I.map((A=>A.map((D=>Wd([D.x,D.y],l.canonical))))))),w=new Qm(x[0][0][0][1]);let C=1/0;for(const I of p)for(const A of x){switch(I.type){case"Point":C=Math.min(C,Qd([I.coordinates],!1,A,w,C));break;case"LineString":C=Math.min(C,Qd(I.coordinates,!0,A,w,C));break;case"Polygon":C=Math.min(C,m2(A,I.coordinates,w,C))}if(C===0)return C}return C})(s,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class lh{constructor(s){this.type=qt,this.key=s}static parse(s,l){if(s.length!==2)return l.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=s[1];return p==null?l.error("Global state property must be defined."):typeof p!="string"?l.error(`Global state property must be string, but found ${typeof s[1]} instead.`):new lh(p)}evaluate(s){var l;const p=(l=s.globals)===null||l===void 0?void 0:l.globalState;return p&&Object.keys(p).length!==0?Dc(p,this.key):null}eachChild(){}outputDefined(){return!1}}const Lc={"==":Ev,"!=":qd,">":qm,"<":i2,">=":n2,"<=":r2,array:rs,at:Vd,boolean:rs,case:Oc,coalesce:th,collator:Hd,format:Dl,image:Zm,in:Gd,"index-of":Bs,interpolate:an,"interpolate-hcl":an,"interpolate-lab":an,length:Zd,let:Ju,literal:Yo,match:qr,number:rs,"number-format":Hm,object:rs,slice:Ku,step:ir,string:rs,"to-boolean":Eo,"to-color":Eo,"to-number":Eo,"to-string":Eo,var:Ud,within:Ol,distance:Ll,"global-state":lh};class vs{constructor(s,l,p,m){this.name=s,this.type=l,this._evaluate=p,this.args=m}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,l){const p=s[0],m=vs.definitions[p];if(!m)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(m)?m[0]:m.type,w=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,C=w.filter((([A])=>!Array.isArray(A)||A.length===s.length-1));let I=null;for(const[A,D]of C){I=new zc(l.registry,tp,l.path,null,l.scope);const N=[];let U=!1;for(let G=1;G<s.length;G++){const q=s[G],X=Array.isArray(A)?A[G-1]:A.type,Q=I.parse(q,1+N.length,X);if(!Q){U=!0;break}N.push(Q)}if(!U)if(Array.isArray(A)&&A.length!==N.length)I.error(`Expected ${A.length} arguments, but found ${N.length} instead.`);else{for(let G=0;G<N.length;G++){const q=Array.isArray(A)?A[G]:A.type,X=N[G];I.concat(G+1).checkSubtype(q,X.type)}if(I.errors.length===0)return new vs(p,x,D,N)}}if(C.length===1)l.errors.push(...I.errors);else{const A=(C.length?C:w).map((([N])=>{return U=N,Array.isArray(U)?`(${U.map(Pi).join(", ")})`:`(${Pi(U.type)}...)`;var U})).join(" | "),D=[];for(let N=1;N<s.length;N++){const U=l.parse(s[N],1+D.length);if(!U)return null;D.push(Pi(U.type))}l.error(`Expected arguments of type ${A}, but found (${D.join(", ")}) instead.`)}return null}static register(s,l){vs.definitions=l;for(const p in l)s[p]=vs}}function Nv(c,[s,l,p,m]){s=s.evaluate(c),l=l.evaluate(c),p=p.evaluate(c);const x=m?m.evaluate(c):1,w=Ni(s,l,p,x);if(w)throw new Mi(w);return new ei(s/255,l/255,p/255,x,!1)}function Bv(c,s){return c in s}function sg(c,s){const l=s[c];return l===void 0?null:l}function Fl(c){return{type:c}}function tp(c){if(c instanceof Ud)return tp(c.boundExpression);if(c instanceof vs&&c.name==="error"||c instanceof Hd||c instanceof Ol||c instanceof Ll||c instanceof lh)return!1;const s=c instanceof Eo||c instanceof rs;let l=!0;return c.eachChild((p=>{l=s?l&&tp(p):l&&p instanceof Yo})),!!l&&ip(c)&&rp(c,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function ip(c){if(c instanceof vs&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Ol||c instanceof Ll)return!1;let s=!0;return c.eachChild((l=>{s&&!ip(l)&&(s=!1)})),s}function ch(c){if(c instanceof vs&&c.name==="feature-state")return!1;let s=!0;return c.eachChild((l=>{s&&!ch(l)&&(s=!1)})),s}function rp(c,s){if(c instanceof vs&&s.indexOf(c.name)>=0)return!1;let l=!0;return c.eachChild((p=>{l&&!rp(p,s)&&(l=!1)})),l}function jv(c){return{result:"success",value:c}}function Fc(c){return{result:"error",value:c}}function Va(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function Uv(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function og(c){return!!c.expression&&c.expression.interpolated}function ii(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function uh(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)&&kt(c)===Fa}function g2(c){return c}function Vv(c,s){const l=c.stops&&typeof c.stops[0][0]=="object",p=l||!(l||c.property!==void 0),m=c.type||(og(s)?"exponential":"interval"),x=(function(D){switch(D.type){case"color":return ei.parse;case"padding":return Gr.parse;case"numberArray":return Tn.parse;case"colorArray":return vr.parse;default:return null}})(s);if(x&&((c=pn({},c)).stops&&(c.stops=c.stops.map((D=>[D[0],x(D[1])]))),c.default=x(c.default?c.default:s.default)),c.colorSpace&&(w=c.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var w;const C=(function(D){switch(D){case"exponential":return qv;case"interval":return y2;case"categorical":return Gv;case"identity":return v2;default:throw new Error(`Unknown function type "${D}"`)}})(m);let I,A;if(m==="categorical"){I=Object.create(null);for(const D of c.stops)I[D[0]]=D[1];A=typeof c.stops[0][0]}if(l){const D={},N=[];for(let q=0;q<c.stops.length;q++){const X=c.stops[q],Q=X[0].zoom;D[Q]===void 0&&(D[Q]={zoom:Q,type:c.type,property:c.property,default:c.default,stops:[]},N.push(Q)),D[Q].stops.push([X[0].value,X[1]])}const U=[];for(const q of N)U.push([D[q].zoom,Vv(D[q],s)]);const G={name:"linear"};return{kind:"composite",interpolationType:G,interpolationFactor:an.interpolationFactor.bind(void 0,G),zoomStops:U.map((q=>q[0])),evaluate:({zoom:q},X)=>qv({stops:U,base:c.base},s,q).evaluate(q,X)}}if(p){const D=m==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:an.interpolationFactor.bind(void 0,D),zoomStops:c.stops.map((N=>N[0])),evaluate:({zoom:N})=>C(c,s,N,I,A)}}return{kind:"source",evaluate(D,N){const U=N&&N.properties?N.properties[c.property]:void 0;return U===void 0?Ga(c.default,s.default):C(c,s,U,I,A)}}}function Ga(c,s,l){return c!==void 0?c:s!==void 0?s:l!==void 0?l:void 0}function Gv(c,s,l,p,m){return Ga(typeof l===m?p[l]:void 0,c.default,s.default)}function y2(c,s,l){if(ii(l)!=="number")return Ga(c.default,s.default);const p=c.stops.length;if(p===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[p-1][0])return c.stops[p-1][1];const m=Al(c.stops.map((x=>x[0])),l);return c.stops[m][1]}function qv(c,s,l){const p=c.base!==void 0?c.base:1;if(ii(l)!=="number")return Ga(c.default,s.default);const m=c.stops.length;if(m===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[m-1][0])return c.stops[m-1][1];const x=Al(c.stops.map((D=>D[0])),l),w=(function(D,N,U,G){const q=G-U,X=D-U;return q===0?0:N===1?X/q:(Math.pow(N,X)-1)/(Math.pow(N,q)-1)})(l,p,c.stops[x][0],c.stops[x+1][0]),C=c.stops[x][1],I=c.stops[x+1][1],A=Io[s.type]||g2;return typeof C.evaluate=="function"?{evaluate(...D){const N=C.evaluate.apply(void 0,D),U=I.evaluate.apply(void 0,D);if(N!==void 0&&U!==void 0)return A(N,U,w,c.colorSpace)}}:A(C,I,w,c.colorSpace)}function v2(c,s,l){switch(s.type){case"color":l=ei.parse(l);break;case"formatted":l=Sn.fromString(l.toString());break;case"resolvedImage":l=is.fromString(l.toString());break;case"padding":l=Gr.parse(l);break;case"colorArray":l=vr.parse(l);break;case"numberArray":l=Tn.parse(l);break;default:ii(l)===s.type||s.type==="enum"&&s.values[l]||(l=void 0)}return Ga(l,c.default,s.default)}vs.register(Lc,{error:[{kind:"error"},[Kt],(c,[s])=>{throw new Mi(s.evaluate(c))}],typeof:[Kt,[qt],(c,[s])=>Pi(kt(s.evaluate(c)))],"to-rgba":[Fn(pt,4),[on],(c,[s])=>{const[l,p,m,x]=s.evaluate(c).rgb;return[255*l,255*p,255*m,x]}],rgb:[on,[pt,pt,pt],Nv],rgba:[on,[pt,pt,pt,pt],Nv],has:{type:Wt,overloads:[[[Kt],(c,[s])=>Bv(s.evaluate(c),c.properties())],[[Kt,Fa],(c,[s,l])=>Bv(s.evaluate(c),l.evaluate(c))]]},get:{type:qt,overloads:[[[Kt],(c,[s])=>sg(s.evaluate(c),c.properties())],[[Kt,Fa],(c,[s,l])=>sg(s.evaluate(c),l.evaluate(c))]]},"feature-state":[qt,[Kt],(c,[s])=>sg(s.evaluate(c),c.featureState||{})],properties:[Fa,[],c=>c.properties()],"geometry-type":[Kt,[],c=>c.geometryType()],id:[qt,[],c=>c.id()],zoom:[pt,[],c=>c.globals.zoom],"heatmap-density":[pt,[],c=>c.globals.heatmapDensity||0],elevation:[pt,[],c=>c.globals.elevation||0],"line-progress":[pt,[],c=>c.globals.lineProgress||0],accumulated:[qt,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[pt,Fl(pt),(c,s)=>{let l=0;for(const p of s)l+=p.evaluate(c);return l}],"*":[pt,Fl(pt),(c,s)=>{let l=1;for(const p of s)l*=p.evaluate(c);return l}],"-":{type:pt,overloads:[[[pt,pt],(c,[s,l])=>s.evaluate(c)-l.evaluate(c)],[[pt],(c,[s])=>-s.evaluate(c)]]},"/":[pt,[pt,pt],(c,[s,l])=>s.evaluate(c)/l.evaluate(c)],"%":[pt,[pt,pt],(c,[s,l])=>s.evaluate(c)%l.evaluate(c)],ln2:[pt,[],()=>Math.LN2],pi:[pt,[],()=>Math.PI],e:[pt,[],()=>Math.E],"^":[pt,[pt,pt],(c,[s,l])=>Math.pow(s.evaluate(c),l.evaluate(c))],sqrt:[pt,[pt],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[pt,[pt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[pt,[pt],(c,[s])=>Math.log(s.evaluate(c))],log2:[pt,[pt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[pt,[pt],(c,[s])=>Math.sin(s.evaluate(c))],cos:[pt,[pt],(c,[s])=>Math.cos(s.evaluate(c))],tan:[pt,[pt],(c,[s])=>Math.tan(s.evaluate(c))],asin:[pt,[pt],(c,[s])=>Math.asin(s.evaluate(c))],acos:[pt,[pt],(c,[s])=>Math.acos(s.evaluate(c))],atan:[pt,[pt],(c,[s])=>Math.atan(s.evaluate(c))],min:[pt,Fl(pt),(c,s)=>Math.min(...s.map((l=>l.evaluate(c))))],max:[pt,Fl(pt),(c,s)=>Math.max(...s.map((l=>l.evaluate(c))))],abs:[pt,[pt],(c,[s])=>Math.abs(s.evaluate(c))],round:[pt,[pt],(c,[s])=>{const l=s.evaluate(c);return l<0?-Math.round(-l):Math.round(l)}],floor:[pt,[pt],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[pt,[pt],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[Wt,[Kt,qt],(c,[s,l])=>c.properties()[s.value]===l.value],"filter-id-==":[Wt,[qt],(c,[s])=>c.id()===s.value],"filter-type-==":[Wt,[Kt],(c,[s])=>c.geometryType()===s.value],"filter-<":[Wt,[Kt,qt],(c,[s,l])=>{const p=c.properties()[s.value],m=l.value;return typeof p==typeof m&&p<m}],"filter-id-<":[Wt,[qt],(c,[s])=>{const l=c.id(),p=s.value;return typeof l==typeof p&&l<p}],"filter->":[Wt,[Kt,qt],(c,[s,l])=>{const p=c.properties()[s.value],m=l.value;return typeof p==typeof m&&p>m}],"filter-id->":[Wt,[qt],(c,[s])=>{const l=c.id(),p=s.value;return typeof l==typeof p&&l>p}],"filter-<=":[Wt,[Kt,qt],(c,[s,l])=>{const p=c.properties()[s.value],m=l.value;return typeof p==typeof m&&p<=m}],"filter-id-<=":[Wt,[qt],(c,[s])=>{const l=c.id(),p=s.value;return typeof l==typeof p&&l<=p}],"filter->=":[Wt,[Kt,qt],(c,[s,l])=>{const p=c.properties()[s.value],m=l.value;return typeof p==typeof m&&p>=m}],"filter-id->=":[Wt,[qt],(c,[s])=>{const l=c.id(),p=s.value;return typeof l==typeof p&&l>=p}],"filter-has":[Wt,[qt],(c,[s])=>s.value in c.properties()],"filter-has-id":[Wt,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Wt,[Fn(Kt)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[Wt,[Fn(qt)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[Wt,[Kt,Fn(qt)],(c,[s,l])=>l.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[Wt,[Kt,Fn(qt)],(c,[s,l])=>(function(p,m,x,w){for(;x<=w;){const C=x+w>>1;if(m[C]===p)return!0;m[C]>p?w=C-1:x=C+1}return!1})(c.properties()[s.value],l.value,0,l.value.length-1)],all:{type:Wt,overloads:[[[Wt,Wt],(c,[s,l])=>s.evaluate(c)&&l.evaluate(c)],[Fl(Wt),(c,s)=>{for(const l of s)if(!l.evaluate(c))return!1;return!0}]]},any:{type:Wt,overloads:[[[Wt,Wt],(c,[s,l])=>s.evaluate(c)||l.evaluate(c)],[Fl(Wt),(c,s)=>{for(const l of s)if(l.evaluate(c))return!0;return!1}]]},"!":[Wt,[Wt],(c,[s])=>!s.evaluate(c)],"is-supported-script":[Wt,[Kt],(c,[s])=>{const l=c.globals&&c.globals.isSupportedScript;return!l||l(s.evaluate(c))}],upcase:[Kt,[Kt],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[Kt,[Kt],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[Kt,Fl(qt),(c,s)=>s.map((l=>Bt(l.evaluate(c)))).join("")],"resolved-locale":[Kt,[Rd],(c,[s])=>s.evaluate(c).resolvedLocale()]});class ag{constructor(s,l){this.expression=s,this._warningHistory={},this._evaluator=new Vm,this._defaultValue=l?(function(p){if(p.type==="color"&&uh(p.default))return new ei(0,0,0,0);switch(p.type){case"color":return ei.parse(p.default)||null;case"padding":return Gr.parse(p.default)||null;case"numberArray":return Tn.parse(p.default)||null;case"colorArray":return vr.parse(p.default)||null;case"variableAnchorOffsetCollection":return Cn.parse(p.default)||null;case"projectionDefinition":return fn.parse(p.default)||null;default:return p.default===void 0?null:p.default}})(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(s,l,p,m,x,w){return this._evaluator.globals=s,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=m,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(s,l,p,m,x,w){this._evaluator.globals=s,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=m,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Mi(`Expected value to be one of ${Object.keys(this._enumValues).map((I=>JSON.stringify(I))).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function np(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Lc}function hh(c,s){const l=new zc(Lc,tp,[],s?(function(m){const x={color:on,string:Kt,number:pt,enum:Kt,boolean:Wt,formatted:Na,padding:Ld,numberArray:Pc,colorArray:To,projectionDefinition:Il,resolvedImage:tr,variableAnchorOffsetCollection:Fd};return m.type==="array"?Fn(x[m.value]||qt,m.length):x[m.type]})(s):void 0),p=l.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?jv(new ag(p,s)):Fc(l.errors)}class dh{constructor(s,l){this.kind=s,this._styleExpression=l,this.isStateDependent=s!=="constant"&&!ch(l.expression),this.globalStateRefs=mh(l.expression)}evaluateWithoutErrorHandling(s,l,p,m,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,l,p,m,x,w)}evaluate(s,l,p,m,x,w){return this._styleExpression.evaluate(s,l,p,m,x,w)}}class lg{constructor(s,l,p,m){this.kind=s,this.zoomStops=p,this._styleExpression=l,this.isStateDependent=s!=="camera"&&!ch(l.expression),this.globalStateRefs=mh(l.expression),this.interpolationType=m}evaluateWithoutErrorHandling(s,l,p,m,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,l,p,m,x,w)}evaluate(s,l,p,m,x,w){return this._styleExpression.evaluate(s,l,p,m,x,w)}interpolationFactor(s,l,p){return this.interpolationType?an.interpolationFactor(this.interpolationType,s,l,p):0}}function Hv(c,s){const l=hh(c,s);if(l.result==="error")return l;const p=l.value.expression,m=ip(p);if(!m&&!Va(s))return Fc([new Wi("","data expressions not supported")]);const x=rp(p,["zoom"]);if(!x&&!Uv(s))return Fc([new Wi("","zoom expressions not supported")]);const w=fh(p);return w||x?w instanceof Wi?Fc([w]):w instanceof an&&!og(s)?Fc([new Wi("",'"interpolate" expressions cannot be used with this property')]):jv(w?new lg(m?"camera":"composite",l.value,w.labels,w instanceof an?w.interpolation:void 0):new dh(m?"constant":"source",l.value)):Fc([new Wi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ph{constructor(s,l){this._parameters=s,this._specification=l,pn(this,Vv(this._parameters,this._specification))}static deserialize(s){return new ph(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function fh(c){let s=null;if(c instanceof Ju)s=fh(c.result);else if(c instanceof th){for(const l of c.args)if(s=fh(l),s)break}else(c instanceof ir||c instanceof an)&&c.input instanceof vs&&c.input.name==="zoom"&&(s=c);return s instanceof Wi||c.eachChild((l=>{const p=fh(l);p instanceof Wi?s=p:!s&&p?s=new Wi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&p&&s!==p&&(s=new Wi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),s}function mh(c,s=new Set){return c instanceof lh&&s.add(c.key),c.eachChild((l=>{mh(l,s)})),s}function sp(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!sp(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const cg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Nl(c){if(c==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};sp(c)||(c=Bl(c));const s=hh(c,cg);if(s.result==="error")throw new Error(s.value.map((l=>`${l.key}: ${l.message}`)).join(", "));return{filter:(l,p,m)=>s.value.evaluate(l,p,{},m),needGeometry:op(c),getGlobalStateRefs:()=>mh(s.value.expression)}}function ug(c,s){return c<s?-1:c>s?1:0}function op(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let s=1;s<c.length;s++)if(op(c[s]))return!0;return!1}function Bl(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?hg(c[1],c[2],"=="):s==="!="?ap(hg(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?hg(c[1],c[2],s):s==="any"?(l=c.slice(1),["any"].concat(l.map(Bl))):s==="all"?["all"].concat(c.slice(1).map(Bl)):s==="none"?["all"].concat(c.slice(1).map(Bl).map(ap)):s==="in"?Zv(c[1],c.slice(2)):s==="!in"?ap(Zv(c[1],c.slice(2))):s==="has"?Wv(c[1]):s!=="!has"||ap(Wv(c[1]));var l}function hg(c,s,l){switch(c){case"$type":return[`filter-type-${l}`,s];case"$id":return[`filter-id-${l}`,s];default:return[`filter-${l}`,c,s]}}function Zv(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some((l=>typeof l!=typeof s[0]))?["filter-in-large",c,["literal",s.sort(ug)]]:["filter-in-small",c,["literal",s]]}}function Wv(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function ap(c){return["!",c]}function dg(c){const s=typeof c;if(s==="number"||s==="boolean"||s==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let m="[";for(const x of c)m+=`${dg(x)},`;return`${m}]`}const l=Object.keys(c).sort();let p="{";for(let m=0;m<l.length;m++)p+=`${JSON.stringify(l[m])}:${dg(c[l[m]])},`;return`${p}}`}function _2(c){let s="";for(const l of Ot)s+=`/${dg(c[l])}`;return s}function pg(c){const s=c.value;return s?[new it(c.key,s,"constants have been deprecated as of v8")]:[]}function Yi(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function $o(c){if(Array.isArray(c))return c.map($o);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const l in c)s[l]=$o(c[l]);return s}return Yi(c)}function _s(c){const s=c.key,l=c.value,p=c.valueSpec||{},m=c.objectElementValidators||{},x=c.style,w=c.styleSpec,C=c.validateSpec;let I=[];const A=ii(l);if(A!=="object")return[new it(s,l,`object expected, ${A} found`)];for(const D in l){const N=D.split(".")[0],U=Dc(p,N)||p["*"];let G;if(Dc(m,N))G=m[N];else if(Dc(p,N))G=C;else if(m["*"])G=m["*"];else{if(!p["*"]){I.push(new it(s,l[D],`unknown property "${D}"`));continue}G=C}I=I.concat(G({key:(s&&`${s}.`)+D,value:l[D],valueSpec:U,style:x,styleSpec:w,object:l,objectKey:D,validateSpec:C},l))}for(const D in p)m[D]||p[D].required&&p[D].default===void 0&&l[D]===void 0&&I.push(new it(s,l,`missing required property "${D}"`));return I}function lp(c){const s=c.value,l=c.valueSpec,p=c.style,m=c.styleSpec,x=c.key,w=c.arrayElementValidator||c.validateSpec;if(ii(s)!=="array")return[new it(x,s,`array expected, ${ii(s)} found`)];if(l.length&&s.length!==l.length)return[new it(x,s,`array length ${l.length} expected, length ${s.length} found`)];if(l["min-length"]&&s.length<l["min-length"])return[new it(x,s,`array length at least ${l["min-length"]} expected, length ${s.length} found`)];let C={type:l.value,values:l.values};m.$version<7&&(C.function=l.function),ii(l.value)==="object"&&(C=l.value);let I=[];for(let A=0;A<s.length;A++)I=I.concat(w({array:s,arrayIndex:A,value:s[A],valueSpec:C,validateSpec:c.validateSpec,style:p,styleSpec:m,key:`${x}[${A}]`}));return I}function gh(c){const s=c.key,l=c.value,p=c.valueSpec;let m=ii(l);return m==="number"&&l!=l&&(m="NaN"),m!=="number"?[new it(s,l,`number expected, ${m} found`)]:"minimum"in p&&l<p.minimum?[new it(s,l,`${l} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&l>p.maximum?[new it(s,l,`${l} is greater than the maximum value ${p.maximum}`)]:[]}function Yv(c){const s=c.valueSpec,l=Yi(c.value.type);let p,m,x,w={};const C=l!=="categorical"&&c.value.property===void 0,I=!C,A=ii(c.value.stops)==="array"&&ii(c.value.stops[0])==="array"&&ii(c.value.stops[0][0])==="object",D=_s({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(G){if(l==="identity")return[new it(G.key,G.value,'identity function may not have a "stops" property')];let q=[];const X=G.value;return q=q.concat(lp({key:G.key,value:X,valueSpec:G.valueSpec,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:N})),ii(X)==="array"&&X.length===0&&q.push(new it(G.key,X,"array must have at least one stop")),q},default:function(G){return G.validateSpec({key:G.key,value:G.value,valueSpec:s,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec})}}});return l==="identity"&&C&&D.push(new it(c.key,c.value,'missing required property "property"')),l==="identity"||c.value.stops||D.push(new it(c.key,c.value,'missing required property "stops"')),l==="exponential"&&c.valueSpec.expression&&!og(c.valueSpec)&&D.push(new it(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(I&&!Va(c.valueSpec)?D.push(new it(c.key,c.value,"property functions not supported")):C&&!Uv(c.valueSpec)&&D.push(new it(c.key,c.value,"zoom functions not supported"))),l!=="categorical"&&!A||c.value.property!==void 0||D.push(new it(c.key,c.value,'"property" property is required')),D;function N(G){let q=[];const X=G.value,Q=G.key;if(ii(X)!=="array")return[new it(Q,X,`array expected, ${ii(X)} found`)];if(X.length!==2)return[new it(Q,X,`array length 2 expected, length ${X.length} found`)];if(A){if(ii(X[0])!=="object")return[new it(Q,X,`object expected, ${ii(X[0])} found`)];if(X[0].zoom===void 0)return[new it(Q,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new it(Q,X,"object stop key must have value")];if(x&&x>Yi(X[0].zoom))return[new it(Q,X[0].zoom,"stop zoom values must appear in ascending order")];Yi(X[0].zoom)!==x&&(x=Yi(X[0].zoom),m=void 0,w={}),q=q.concat(_s({key:`${Q}[0]`,value:X[0],valueSpec:{zoom:{}},validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:gh,value:U}}))}else q=q.concat(U({key:`${Q}[0]`,value:X[0],validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec},X));return np($o(X[1]))?q.concat([new it(`${Q}[1]`,X[1],"expressions are not allowed in function stops.")]):q.concat(G.validateSpec({key:`${Q}[1]`,value:X[1],valueSpec:s,validateSpec:G.validateSpec,style:G.style,styleSpec:G.styleSpec}))}function U(G,q){const X=ii(G.value),Q=Yi(G.value),ne=G.value!==null?G.value:q;if(p){if(X!==p)return[new it(G.key,ne,`${X} stop domain type must match previous stop domain type ${p}`)]}else p=X;if(X!=="number"&&X!=="string"&&X!=="boolean")return[new it(G.key,ne,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&l!=="categorical"){let ye=`number expected, ${X} found`;return Va(s)&&l===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new it(G.key,ne,ye)]}return l!=="categorical"||X!=="number"||isFinite(Q)&&Math.floor(Q)===Q?l!=="categorical"&&X==="number"&&m!==void 0&&Q<m?[new it(G.key,ne,"stop domain values must appear in ascending order")]:(m=Q,l==="categorical"&&Q in w?[new it(G.key,ne,"stop domain values must be unique")]:(w[Q]=!0,[])):[new it(G.key,ne,`integer expected, found ${Q}`)]}}function jl(c){const s=(c.expressionContext==="property"?Hv:hh)($o(c.value),c.valueSpec);if(s.result==="error")return s.value.map((p=>new it(`${c.key}${p.key}`,c.value,p.message)));const l=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!l.outputDefined())return[new it(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!ch(l))return[new it(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!ch(l))return[new it(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!rp(l,["zoom","feature-state"]))return[new it(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!ip(l))return[new it(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cp(c){const s=c.key,l=c.value,p=ii(l);return p!=="string"?[new it(s,l,`color expected, ${p} found`)]:ei.parse(String(l))?[]:[new it(s,l,`color expected, "${l}" found`)]}function Jo(c){const s=c.key,l=c.value,p=c.valueSpec,m=[];return Array.isArray(p.values)?p.values.indexOf(Yi(l))===-1&&m.push(new it(s,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(Yi(l))===-1&&m.push(new it(s,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),m}function fg(c){return sp($o(c.value))?jl(pn({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xv(c)}function Xv(c){const s=c.value,l=c.key;if(ii(s)!=="array")return[new it(l,s,`array expected, ${ii(s)} found`)];const p=c.styleSpec;let m,x=[];if(s.length<1)return[new it(l,s,"filter array must have at least 1 element")];switch(x=x.concat(Jo({key:`${l}[0]`,value:s[0],valueSpec:p.filter_operator,style:c.style,styleSpec:c.styleSpec})),Yi(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&Yi(s[1])==="$type"&&x.push(new it(l,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&x.push(new it(l,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(m=ii(s[1]),m!=="string"&&x.push(new it(`${l}[1]`,s[1],`string expected, ${m} found`)));for(let w=2;w<s.length;w++)m=ii(s[w]),Yi(s[1])==="$type"?x=x.concat(Jo({key:`${l}[${w}]`,value:s[w],valueSpec:p.geometry_type,style:c.style,styleSpec:c.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&x.push(new it(`${l}[${w}]`,s[w],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let w=1;w<s.length;w++)x=x.concat(Xv({key:`${l}[${w}]`,value:s[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":m=ii(s[1]),s.length!==2?x.push(new it(l,s,`filter array for "${s[0]}" operator must have 2 elements`)):m!=="string"&&x.push(new it(`${l}[1]`,s[1],`string expected, ${m} found`))}return x}function Jv(c,s){const l=c.key,p=c.validateSpec,m=c.style,x=c.styleSpec,w=c.value,C=c.objectKey,I=x[`${s}_${c.layerType}`];if(!I)return[];const A=C.match(/^(.*)-transition$/);if(s==="paint"&&A&&I[A[1]]&&I[A[1]].transition)return p({key:l,value:w,valueSpec:x.transition,style:m,styleSpec:x});const D=c.valueSpec||I[C];if(!D)return[new it(l,w,`unknown property "${C}"`)];let N;if(ii(w)==="string"&&Va(D)&&!D.tokens&&(N=/^{([^}]+)}$/.exec(w)))return[new it(l,w,`"${C}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const U=[];return c.layerType==="symbol"&&(C==="text-field"&&m&&!m.glyphs&&U.push(new it(l,w,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&uh($o(w))&&Yi(w.type)==="identity"&&U.push(new it(l,w,'"text-font" does not support identity functions'))),U.concat(p({key:c.key,value:w,valueSpec:D,style:m,styleSpec:x,expressionContext:"property",propertyType:s,propertyKey:C}))}function Kv(c){return Jv(c,"paint")}function Qv(c){return Jv(c,"layout")}function e_(c){let s=[];const l=c.value,p=c.key,m=c.style,x=c.styleSpec;if(ii(l)!=="object")return[new it(p,l,`object expected, ${ii(l)} found`)];l.type||l.ref||s.push(new it(p,l,'either "type" or "ref" is required'));let w=Yi(l.type);const C=Yi(l.ref);if(l.id){const I=Yi(l.id);for(let A=0;A<c.arrayIndex;A++){const D=m.layers[A];Yi(D.id)===I&&s.push(new it(p,l.id,`duplicate layer id "${l.id}", previously used at line ${D.id.__line__}`))}}if("ref"in l){let I;["type","source","source-layer","filter","layout"].forEach((A=>{A in l&&s.push(new it(p,l[A],`"${A}" is prohibited for ref layers`))})),m.layers.forEach((A=>{Yi(A.id)===C&&(I=A)})),I?I.ref?s.push(new it(p,l.ref,"ref cannot reference another ref layer")):w=Yi(I.type):s.push(new it(p,l.ref,`ref layer "${C}" not found`))}else if(w!=="background")if(l.source){const I=m.sources&&m.sources[l.source],A=I&&Yi(I.type);I?A==="vector"&&w==="raster"?s.push(new it(p,l.source,`layer "${l.id}" requires a raster source`)):A!=="raster-dem"&&w==="hillshade"||A!=="raster-dem"&&w==="color-relief"?s.push(new it(p,l.source,`layer "${l.id}" requires a raster-dem source`)):A==="raster"&&w!=="raster"?s.push(new it(p,l.source,`layer "${l.id}" requires a vector source`)):A!=="vector"||l["source-layer"]?A==="raster-dem"&&w!=="hillshade"&&w!=="color-relief"?s.push(new it(p,l.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):w!=="line"||!l.paint||!l.paint["line-gradient"]||A==="geojson"&&I.lineMetrics||s.push(new it(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new it(p,l,`layer "${l.id}" must specify a "source-layer"`)):s.push(new it(p,l.source,`source "${l.source}" not found`))}else s.push(new it(p,l,'missing required property "source"'));return s=s.concat(_s({key:p,value:l,valueSpec:x.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${p}.type`,value:l.type,valueSpec:x.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:l,objectKey:"type"}),filter:fg,layout:I=>_s({layer:l,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":A=>Qv(pn({layerType:w},A))}}),paint:I=>_s({layer:l,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":A=>Kv(pn({layerType:w},A))}})}})),s}function Us(c){const s=c.value,l=c.key,p=ii(s);return p!=="string"?[new it(l,s,`string expected, ${p} found`)]:[]}const Nc={promoteId:function({key:c,value:s}){if(ii(s)==="string")return Us({key:c,value:s});{const l=[];for(const p in s)l.push(...Us({key:`${c}.${p}`,value:s[p]}));return l}}};function Nn(c){const s=c.value,l=c.key,p=c.styleSpec,m=c.style,x=c.validateSpec;if(!s.type)return[new it(l,s,'"type" is required')];const w=Yi(s.type);let C;switch(w){case"vector":case"raster":return C=_s({key:l,value:s,valueSpec:p[`source_${w.replace("-","_")}`],style:c.style,styleSpec:p,objectElementValidators:Nc,validateSpec:x}),C;case"raster-dem":return C=(function(I){var A;const D=(A=I.sourceName)!==null&&A!==void 0?A:"",N=I.value,U=I.styleSpec,G=U.source_raster_dem,q=I.style;let X=[];const Q=ii(N);if(N===void 0)return X;if(Q!=="object")return X.push(new it("source_raster_dem",N,`object expected, ${Q} found`)),X;const ne=Yi(N.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],ue=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const de in N)!ne&&ye.includes(de)?X.push(new it(de,N[de],`In "${D}": "${de}" is only valid when "encoding" is set to "custom". ${ue} encoding found`)):G[de]?X=X.concat(I.validateSpec({key:de,value:N[de],valueSpec:G[de],validateSpec:I.validateSpec,style:q,styleSpec:U})):X.push(new it(de,N[de],`unknown property "${de}"`));return X})({sourceName:l,value:s,style:c.style,styleSpec:p,validateSpec:x}),C;case"geojson":if(C=_s({key:l,value:s,valueSpec:p.source_geojson,style:m,styleSpec:p,validateSpec:x,objectElementValidators:Nc}),s.cluster)for(const I in s.clusterProperties){const[A,D]=s.clusterProperties[I],N=typeof A=="string"?[A,["accumulated"],["get",I]]:A;C.push(...jl({key:`${l}.${I}.map`,value:D,expressionContext:"cluster-map"})),C.push(...jl({key:`${l}.${I}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return C;case"video":return _s({key:l,value:s,valueSpec:p.source_video,style:m,validateSpec:x,styleSpec:p});case"image":return _s({key:l,value:s,valueSpec:p.source_image,style:m,validateSpec:x,styleSpec:p});case"canvas":return[new it(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Jo({key:`${l}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Bc(c){const s=c.value,l=c.styleSpec,p=l.light,m=c.style;let x=[];const w=ii(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new it("light",s,`object expected, ${w} found`)]),x;for(const C in s){const I=C.match(/^(.*)-transition$/);x=x.concat(I&&p[I[1]]&&p[I[1]].transition?c.validateSpec({key:C,value:s[C],valueSpec:l.transition,validateSpec:c.validateSpec,style:m,styleSpec:l}):p[C]?c.validateSpec({key:C,value:s[C],valueSpec:p[C],validateSpec:c.validateSpec,style:m,styleSpec:l}):[new it(C,s[C],`unknown property "${C}"`)])}return x}function mg(c){const s=c.value,l=c.styleSpec,p=l.sky,m=c.style,x=ii(s);if(s===void 0)return[];if(x!=="object")return[new it("sky",s,`object expected, ${x} found`)];let w=[];for(const C in s)w=w.concat(p[C]?c.validateSpec({key:C,value:s[C],valueSpec:p[C],style:m,styleSpec:l}):[new it(C,s[C],`unknown property "${C}"`)]);return w}function t_(c){const s=c.value,l=c.styleSpec,p=l.terrain,m=c.style;let x=[];const w=ii(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new it("terrain",s,`object expected, ${w} found`)]),x;for(const C in s)x=x.concat(p[C]?c.validateSpec({key:C,value:s[C],valueSpec:p[C],validateSpec:c.validateSpec,style:m,styleSpec:l}):[new it(C,s[C],`unknown property "${C}"`)]);return x}function i_(c){let s=[];const l=c.value,p=c.key;if(Array.isArray(l)){const m=[],x=[];for(const w in l)l[w].id&&m.includes(l[w].id)&&s.push(new it(p,l,`all the sprites' ids must be unique, but ${l[w].id} is duplicated`)),m.push(l[w].id),l[w].url&&x.includes(l[w].url)&&s.push(new it(p,l,`all the sprites' URLs must be unique, but ${l[w].url} is duplicated`)),x.push(l[w].url),s=s.concat(_s({key:`${p}[${w}]`,value:l[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return s}return Us({key:p,value:l})}function jc(c){return s=c.value,s&&s.constructor===Object?[]:[new it(c.key,c.value,`object expected, ${ii(c.value)} found`)];var s}const gg={"*":()=>[],array:lp,boolean:function(c){const s=c.value,l=c.key,p=ii(s);return p!=="boolean"?[new it(l,s,`boolean expected, ${p} found`)]:[]},number:gh,color:cp,constants:pg,enum:Jo,filter:fg,function:Yv,layer:e_,object:_s,source:Nn,light:Bc,sky:mg,terrain:t_,projection:function(c){const s=c.value,l=c.styleSpec,p=l.projection,m=c.style,x=ii(s);if(s===void 0)return[];if(x!=="object")return[new it("projection",s,`object expected, ${x} found`)];let w=[];for(const C in s)w=w.concat(p[C]?c.validateSpec({key:C,value:s[C],valueSpec:p[C],style:m,styleSpec:l}):[new it(C,s[C],`unknown property "${C}"`)]);return w},projectionDefinition:function(c){const s=c.key;let l=c.value;l=l instanceof String?l.valueOf():l;const p=ii(l);return p!=="array"||(function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"})(l)||(function(m){return!!["interpolate","step","literal"].includes(m[0])})(l)?["array","string"].includes(p)?[]:[new it(s,l,`projection expected, invalid type "${p}" found`)]:[new it(s,l,`projection expected, invalid array ${JSON.stringify(l)} found`)]},string:Us,formatted:function(c){return Us(c).length===0?[]:jl(c)},resolvedImage:function(c){return Us(c).length===0?[]:jl(c)},padding:function(c){const s=c.key,l=c.value;if(ii(l)==="array"){if(l.length<1||l.length>4)return[new it(s,l,`padding requires 1 to 4 values; ${l.length} values found`)];const p={type:"number"};let m=[];for(let x=0;x<l.length;x++)m=m.concat(c.validateSpec({key:`${s}[${x}]`,value:l[x],validateSpec:c.validateSpec,valueSpec:p}));return m}return gh({key:s,value:l,valueSpec:{}})},numberArray:function(c){const s=c.key,l=c.value;if(ii(l)==="array"){const p={type:"number"};if(l.length<1)return[new it(s,l,"array length at least 1 expected, length 0 found")];let m=[];for(let x=0;x<l.length;x++)m=m.concat(c.validateSpec({key:`${s}[${x}]`,value:l[x],validateSpec:c.validateSpec,valueSpec:p}));return m}return gh({key:s,value:l,valueSpec:{}})},colorArray:function(c){const s=c.key,l=c.value;if(ii(l)==="array"){if(l.length<1)return[new it(s,l,"array length at least 1 expected, length 0 found")];let p=[];for(let m=0;m<l.length;m++)p=p.concat(cp({key:`${s}[${m}]`,value:l[m]}));return p}return cp({key:s,value:l})},variableAnchorOffsetCollection:function(c){const s=c.key,l=c.value,p=ii(l),m=c.styleSpec;if(p!=="array"||l.length<1||l.length%2!=0)return[new it(s,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let w=0;w<l.length;w+=2)x=x.concat(Jo({key:`${s}[${w}]`,value:l[w],valueSpec:m.layout_symbol["text-anchor"]})),x=x.concat(lp({key:`${s}[${w+1}]`,value:l[w+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:m}));return x},sprite:i_,state:jc};function Uc(c){const s=c.value,l=c.valueSpec,p=c.styleSpec;return c.validateSpec=Uc,l.expression&&uh(Yi(s))?Yv(c):l.expression&&np($o(s))?jl(c):l.type&&gg[l.type]?gg[l.type](c):_s(pn({},c,{valueSpec:l.type?p[l.type]:l}))}function r_(c){const s=c.value,l=c.key,p=Us(c);return p.length||(s.indexOf("{fontstack}")===-1&&p.push(new it(l,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&p.push(new it(l,s,'"glyphs" url must include a "{range}" token'))),p}function Bn(c,s=Te){let l=[];return l=l.concat(Uc({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,validateSpec:Uc,objectElementValidators:{glyphs:r_,"*":()=>[]}})),c.constants&&(l=l.concat(pg({key:"constants",value:c.constants}))),Vc(l)}function Vs(c){return function(s){return c({...s,validateSpec:Uc})}}function Vc(c){return[].concat(c).sort(((s,l)=>s.line-l.line))}function Gs(c){return function(...s){return Vc(c.apply(this,s))}}Bn.source=Gs(Vs(Nn)),Bn.sprite=Gs(Vs(i_)),Bn.glyphs=Gs(Vs(r_)),Bn.light=Gs(Vs(Bc)),Bn.sky=Gs(Vs(mg)),Bn.terrain=Gs(Vs(t_)),Bn.state=Gs(Vs(jc)),Bn.layer=Gs(Vs(e_)),Bn.filter=Gs(Vs(fg)),Bn.paintProperty=Gs(Vs(Kv)),Bn.layoutProperty=Gs(Vs(Qv));const Gc=Bn,b2=Gc.light,yh=Gc.sky,x2=Gc.paintProperty,w2=Gc.layoutProperty;function vh(c,s){let l=!1;if(s&&s.length)for(const p of s)c.fire(new Ge(new Error(p.message))),l=!0;return l}class _h{constructor(s,l,p){const m=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const w=new Int32Array(this.arrayBuffer);s=w[0],this.d=(l=w[1])+2*(p=w[2]);for(let I=0;I<this.d*this.d;I++){const A=w[3+I],D=w[3+I+1];m.push(A===D?null:w.subarray(A,D))}const C=w[3+m.length+1];this.keys=w.subarray(w[3+m.length],C),this.bboxes=w.subarray(C),this.insert=this._insertReadonly}else{this.d=l+2*p;for(let w=0;w<this.d*this.d;w++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=s,this.padding=p,this.scale=l/s,this.uid=0;const x=p/l*s;this.min=-x,this.max=s+x}insert(s,l,p,m,x){this._forEachCell(l,p,m,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(m),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,l,p,m,x,w){this.cells[x].push(w)}query(s,l,p,m,x){const w=this.min,C=this.max;if(s<=w&&l<=w&&C<=p&&C<=m&&!x)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(s,l,p,m,this._queryCell,I,{},x),I}}_queryCell(s,l,p,m,x,w,C,I){const A=this.cells[x];if(A!==null){const D=this.keys,N=this.bboxes;for(let U=0;U<A.length;U++){const G=A[U];if(C[G]===void 0){const q=4*G;(I?I(N[q+0],N[q+1],N[q+2],N[q+3]):s<=N[q+2]&&l<=N[q+3]&&p>=N[q+0]&&m>=N[q+1])?(C[G]=!0,w.push(D[G])):C[G]=!1}}}}_forEachCell(s,l,p,m,x,w,C,I){const A=this._convertToCellCoord(s),D=this._convertToCellCoord(l),N=this._convertToCellCoord(p),U=this._convertToCellCoord(m);for(let G=A;G<=N;G++)for(let q=D;q<=U;q++){const X=this.d*q+G;if((!I||I(this._convertFromCellCoord(G),this._convertFromCellCoord(q),this._convertFromCellCoord(G+1),this._convertFromCellCoord(q+1)))&&x.call(this,s,l,p,m,X,w,C,I))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,l=3+this.cells.length+1+1;let p=0;for(let w=0;w<this.cells.length;w++)p+=this.cells[w].length;const m=new Int32Array(l+p+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let x=l;for(let w=0;w<s.length;w++){const C=s[w];m[3+w]=x,m.set(C,x),x+=C.length}return m[3+s.length]=x,m.set(this.keys,x),x+=this.keys.length,m[3+s.length+1]=x,m.set(this.bboxes,x),x+=this.bboxes.length,m.buffer}static serialize(s,l){const p=s.toArrayBuffer();return l&&l.push(p),{buffer:p}}static deserialize(s){return new _h(s.buffer)}}const qs={};function mt(c,s,l={}){if(qs[c])throw new Error(`${c} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:c,writeable:!1}),qs[c]={klass:s,omit:l.omit||[],shallow:l.shallow||[]}}mt("Object",Object),mt("Set",Set),mt("TransferableGridIndex",_h),mt("Color",ei),mt("Error",Error),mt("AJAXError",le),mt("ResolvedImage",is),mt("StylePropertyFunction",ph),mt("StyleExpression",ag,{omit:["_evaluator"]}),mt("ZoomDependentExpression",lg),mt("ZoomConstantExpression",dh),mt("CompoundExpression",vs,{omit:["_evaluate"]});for(const c in Lc)Lc[c]._classRegistryKey||mt(`Expression_${c}`,Lc[c]);function yg(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function up(c){return c.$name||c.constructor._classRegistryKey}function vg(c){return!(function(s){if(s===null||typeof s!="object")return!1;const l=up(s);return!(!l||l==="Object")})(c)&&(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||c instanceof Error||yg(c)||wo(c)||ArrayBuffer.isView(c)||c instanceof ImageData)}function qc(c,s){if(vg(c))return(yg(c)||wo(c))&&s&&s.push(c),ArrayBuffer.isView(c)&&s&&s.push(c.buffer),c instanceof ImageData&&s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const x=[];for(const w of c)x.push(qc(w,s));return x}if(typeof c!="object")throw new Error("can't serialize object of type "+typeof c);const l=up(c);if(!l)throw new Error(`can't serialize object of unregistered class ${c.constructor.name}`);if(!qs[l])throw new Error(`${l} is not registered.`);const{klass:p}=qs[l],m=p.serialize?p.serialize(c,s):{};if(p.serialize){if(s&&m===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in c){if(!c.hasOwnProperty(x)||qs[l].omit.indexOf(x)>=0)continue;const w=c[x];m[x]=qs[l].shallow.indexOf(x)>=0?w:qc(w,s)}c instanceof Error&&(m.message=c.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(m.$name=l),m}function Ul(c){if(vg(c))return c;if(Array.isArray(c))return c.map(Ul);if(typeof c!="object")throw new Error("can't deserialize object of type "+typeof c);const s=up(c)||"Object";if(!qs[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:l}=qs[s];if(!l)throw new Error(`can't deserialize unregistered class ${s}`);if(l.deserialize)return l.deserialize(c);const p=Object.create(l.prototype);for(const m of Object.keys(c)){if(m==="$name")continue;const x=c[m];p[m]=qs[s].shallow.indexOf(m)>=0?x:Ul(x)}return p}class hp{constructor(){this.first=!0}update(s,l){const p=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=l),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=p,!0))}}const ni={"Latin-1 Supplement":c=>c>=128&&c<=255,"Hangul Jamo":c=>c>=4352&&c<=4607,Khmer:c=>c>=6016&&c<=6143,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Kanbun:c=>c>=12688&&c<=12703,"CJK Strokes":c=>c>=12736&&c<=12783,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Hangul Syllables":c=>c>=44032&&c<=55215,"Private Use Area":c=>c>=57344&&c<=63743,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function dp(c){for(const s of c)if(bg(s.charCodeAt(0)))return!0;return!1}function S2(c){for(const s of c)if(!n_(s.charCodeAt(0)))return!1;return!0}function pp(c){const s=c.map((l=>{try{return new RegExp(`\\p{sc=${l}}`,"u").source}catch{return null}})).filter((l=>l));return new RegExp(s.join("|"),"u")}const T2=pp(["Arab","Dupl","Mong","Ougr","Syrc"]);function n_(c){return!T2.test(String.fromCodePoint(c))}const _g=pp(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function bg(c){return!(c!==746&&c!==747&&(c<4352||!(ni["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||ni["CJK Compatibility"](c)||ni["CJK Strokes"](c)||!(!ni["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||ni["Enclosed CJK Letters and Months"](c)||ni["Ideographic Description Characters"](c)||ni.Kanbun(c)||ni.Katakana(c)&&c!==12540||!(!ni["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!ni["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||ni["Vertical Forms"](c)||ni["Yijing Hexagram Symbols"](c)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(c))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(c))||_g.test(String.fromCodePoint(c)))))}function s_(c){return!(bg(c)||(function(s){return!!(ni["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||ni["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||ni["Letterlike Symbols"](s)||ni["Number Forms"](s)||ni["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||ni["Control Pictures"](s)&&s!==9251||ni["Optical Character Recognition"](s)||ni["Enclosed Alphanumerics"](s)||ni["Geometric Shapes"](s)||ni["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||ni["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||ni["CJK Symbols and Punctuation"](s)||ni.Katakana(s)||ni["Private Use Area"](s)||ni["CJK Compatibility Forms"](s)||ni["Small Form Variants"](s)||ni["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)})(c))}const o_=pp(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function xg(c){return o_.test(String.fromCodePoint(c))}function a_(c,s){return!(!s&&xg(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||ni.Khmer(c))}function l_(c){for(const s of c)if(xg(s.charCodeAt(0)))return!0;return!1}const Hs=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(c){this.pluginStatus=c.pluginStatus,this.pluginURL=c.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(c){if(Hs.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=c.applyArabicShaping,this.processBidirectionalText=c.processBidirectionalText,this.processStyledBidirectionalText=c.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(c,s){return a(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(c.pluginStatus!=="loading")return this.setState(c),c;const l=c.pluginURL,p=new Promise((x=>{this.loadScriptResolve=x}));s(l);const m=new Promise((x=>setTimeout((()=>x()),this.TIMEOUT)));if(yield Promise.race([p,m]),this.isParsed()){const x={pluginStatus:"loaded",pluginURL:l};return this.setState(x),x}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${l}`)}))}};class ki{constructor(s,l){this.zoom=s,l?(this.now=l.now||0,this.fadeDuration=l.fadeDuration||0,this.zoomHistory=l.zoomHistory||new hp,this.transition=l.transition||{},this.globalState=l.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new hp,this.transition={},this.globalState={})}isSupportedScript(s){return(function(l,p){for(const m of l)if(!a_(m.charCodeAt(0),p))return!1;return!0})(s,Hs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,l=s-Math.floor(s),p=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*l}}}class Hc{constructor(s,l){this.property=s,this.value=l,this.expression=(function(p,m){if(uh(p))return new ph(p,m);if(np(p)){const x=Hv(p,m);if(x.result==="error")throw new Error(x.value.map((w=>`${w.key}: ${w.message}`)).join(", "));return x.value}{let x=p;return m.type==="color"&&typeof p=="string"?x=ei.parse(p):m.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?m.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?m.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?x=Cn.parse(p):m.type==="projectionDefinition"&&typeof p=="string"&&(x=fn.parse(p)):x=vr.parse(p):x=Tn.parse(p):x=Gr.parse(p),{globalStateRefs:new Set,kind:"constant",evaluate:()=>x}}})(l===void 0?s.specification.default:l,s.specification),this._evaluate=this.expression.evaluate}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(s,l,p){return this.property.possiblyEvaluate(this,s,l,p)}setGlobalState(s){this.expression.evaluate=(l,p,m,x,w,C)=>(l.globalState=s,this._evaluate.call(this.expression,l,p,m,x,w,C))}}class wg{constructor(s){this.property=s,this.value=new Hc(s,void 0)}transitioned(s,l){return new Sg(this.property,this.value,l,dn({},s.transition,this.transition),s.now)}untransitioned(){return new Sg(this.property,this.value,null,{},0)}}class c_{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return ts(this._values[s].value.value)}setValue(s,l){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new wg(this._values[s].property)),this._values[s].value=new Hc(this._values[s].property,l===null?void 0:ts(l))}getTransition(s){return ts(this._values[s].transition)}setTransition(s,l){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new wg(this._values[s].property)),this._values[s].transition=ts(l)||void 0}serialize(){const s={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(s[l]=p);const m=this.getTransition(l);m!==void 0&&(s[`${l}-transition`]=m)}return s}transitioned(s,l){const p=new Tg(this._properties);for(const m of Object.keys(this._values))p._values[m]=this._values[m].transitioned(s,l._values[m]);return p}untransitioned(){const s=new Tg(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].untransitioned();return s}}class Sg{constructor(s,l,p,m,x){this.property=s,this.value=l,this.begin=x+m.delay||0,this.end=this.begin+m.duration||0,s.specification.transition&&(m.delay||m.duration)&&(this.prior=p)}possiblyEvaluate(s,l,p){const m=s.now||0,x=this.value.possiblyEvaluate(s,l,p),w=this.prior;if(w){if(m>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(m<this.begin)return w.possiblyEvaluate(s,l,p);{const C=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(s,l,p),x,Vr(C))}}return x}}class Tg{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,l,p){const m=new fp(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].possiblyEvaluate(s,l,p);return m}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class u_{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues),this._globalState={}}hasValue(s){return this._values[s].value!==void 0}getValue(s){return ts(this._values[s].value)}setValue(s,l){this._values[s]=new Hc(this._values[s].property,l===null?void 0:ts(l)),this._values[s].setGlobalState(this._globalState)}serialize(){const s={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(s[l]=p)}return s}possiblyEvaluate(s,l,p){const m=new fp(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].possiblyEvaluate(s,l,p);return m}setGlobalState(s){this._globalState=s;for(const l of Object.values(this._values))l.setGlobalState(s)}}class Po{constructor(s,l,p){this.property=s,this.value=l,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,l,p,m){return this.property.evaluate(this.value,this.parameters,s,l,p,m)}}class fp{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Tt{constructor(s){this.specification=s}possiblyEvaluate(s,l){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(l)}interpolate(s,l,p){const m=Io[this.specification.type];return m?m(s,l,p):s}}class Mt{constructor(s,l){this.specification=s,this.overrides=l}possiblyEvaluate(s,l,p,m){return new Po(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(l,null,{},p,m)}:s.expression,l)}interpolate(s,l,p){if(s.value.kind!=="constant"||l.value.kind!=="constant")return s;if(s.value.value===void 0||l.value.value===void 0)return new Po(this,{kind:"constant",value:void 0},s.parameters);const m=Io[this.specification.type];if(m){const x=m(s.value.value,l.value.value,p);return new Po(this,{kind:"constant",value:x},s.parameters)}return s}evaluate(s,l,p,m,x,w){return s.kind==="constant"?s.value:s.evaluate(l,p,m,x,w)}}class mp extends Mt{possiblyEvaluate(s,l,p,m){if(s.value===void 0)return new Po(this,{kind:"constant",value:void 0},l);if(s.expression.kind==="constant"){const x=s.expression.evaluate(l,null,{},p,m),w=s.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,C=this._calculate(w,w,w,l);return new Po(this,{kind:"constant",value:C},l)}if(s.expression.kind==="camera"){const x=this._calculate(s.expression.evaluate({zoom:l.zoom-1}),s.expression.evaluate({zoom:l.zoom}),s.expression.evaluate({zoom:l.zoom+1}),l);return new Po(this,{kind:"constant",value:x},l)}return new Po(this,s.expression,l)}evaluate(s,l,p,m,x,w){if(s.kind==="source"){const C=s.evaluate(l,p,m,x,w);return this._calculate(C,C,C,l)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(l.zoom)-1},p,m),s.evaluate({zoom:Math.floor(l.zoom)},p,m),s.evaluate({zoom:Math.floor(l.zoom)+1},p,m),l):s.value}_calculate(s,l,p,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:p,to:l}}interpolate(s){return s}}class qa{constructor(s){this.specification=s}possiblyEvaluate(s,l,p,m){if(s.value!==void 0){if(s.expression.kind==="constant"){const x=s.expression.evaluate(l,null,{},p,m);return this._calculate(x,x,x,l)}return this._calculate(s.expression.evaluate(new ki(Math.floor(l.zoom-1),l)),s.expression.evaluate(new ki(Math.floor(l.zoom),l)),s.expression.evaluate(new ki(Math.floor(l.zoom+1),l)),l)}}_calculate(s,l,p,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:s,to:l}:{from:p,to:l}}interpolate(s){return s}}class gp{constructor(s){this.specification=s}possiblyEvaluate(s,l,p,m){return!!s.expression.evaluate(l,null,{},p,m)}interpolate(){return!1}}class En{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in s){const p=s[l];p.specification.overridable&&this.overridableProperties.push(l);const m=this.defaultPropertyValues[l]=new Hc(p,void 0),x=this.defaultTransitionablePropertyValues[l]=new wg(p);this.defaultTransitioningPropertyValues[l]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}}}mt("DataDrivenProperty",Mt),mt("DataConstantProperty",Tt),mt("CrossFadedDataDrivenProperty",mp),mt("CrossFadedProperty",qa),mt("ColorRampProperty",gp);const h_="-transition";class bs extends St{constructor(s,l){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,this._globalState={},s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter,this._featureFilter=Nl(s.filter)),l.layout&&(this._unevaluatedLayout=new u_(l.layout)),l.paint)){this._transitionablePaint=new c_(l.paint);for(const p in s.paint)this.setPaintProperty(p,s.paint[p],{validate:!1});for(const p in s.layout)this.setLayoutProperty(p,s.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fp(l.paint)}}setFilter(s){this.filter=s,this._featureFilter=Nl(s)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}getLayoutAffectingGlobalStateRefs(){const s=new Set;if(this._unevaluatedLayout)for(const l in this._unevaluatedLayout._values){const p=this._unevaluatedLayout._values[l];for(const m of p.getGlobalStateRefs())s.add(m)}for(const l of this._featureFilter.getGlobalStateRefs())s.add(l);return s}getPaintAffectingGlobalStateRefs(){var s;const l=new globalThis.Map;if(this._transitionablePaint)for(const p in this._transitionablePaint._values){const m=this._transitionablePaint._values[p].value;for(const x of m.getGlobalStateRefs()){const w=(s=l.get(x))!==null&&s!==void 0?s:[];w.push({name:p,value:m.value}),l.set(x,w)}}return l}setLayoutProperty(s,l,p={}){l!=null&&this._validate(w2,`layers.${this.id}.layout.${s}`,s,l,p)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,l):this.visibility=l)}getPaintProperty(s){return s.endsWith(h_)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,l,p={}){if(l!=null&&this._validate(x2,`layers.${this.id}.paint.${s}`,s,l,p))return!1;if(s.endsWith(h_))return this._transitionablePaint.setTransition(s.slice(0,-11),l||void 0),!1;{const m=this._transitionablePaint._values[s],x=m.property.specification["property-type"]==="cross-faded-data-driven",w=m.value.isDataDriven(),C=m.value;this._transitionablePaint.setValue(s,l),this._handleSpecialPaintPropertyUpdate(s);const I=this._transitionablePaint._values[s].value;return I.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(s,C,I)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,l,p){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,l){s.globalState=this._globalState,s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,l)}setGlobalState(s){this._globalState=s,this._unevaluatedLayout&&this._unevaluatedLayout.setGlobalState(s)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),Cc(s,((l,p)=>!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length)))}_validate(s,l,p,m,x={}){return(!x||x.validate!==!1)&&vh(this,s.call(Gc,{key:l,layerType:this.type,objectKey:p,value:m,styleSpec:Te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const l=this.paint.get(s);if(l instanceof Po&&Va(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const C2={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class bh{constructor(s,l){this._structArray=s,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ti{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,l){return s._trim(),l&&(s.isTransferred=!0,l.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const l=Object.create(this.prototype);return l.arrayBuffer=s.arrayBuffer,l.length=s.length,l.capacity=s.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function rr(c,s=1){let l=0,p=0;return{members:c.map((m=>{const x=C2[m.type].BYTES_PER_ELEMENT,w=l=yp(l,Math.max(s,x)),C=m.components||1;return p=Math.max(p,x),l+=x*C,{name:m.name,type:m.type,components:C,offset:w}})),size:yp(l,Math.max(p,s)),alignment:s}}function yp(c,s){return Math.ceil(c/s)*s}class Zc extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const m=2*s;return this.int16[m+0]=l,this.int16[m+1]=p,s}}Zc.prototype.bytesPerElement=4,mt("StructArrayLayout2i4",Zc);class Wc extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=3*s;return this.int16[x+0]=l,this.int16[x+1]=p,this.int16[x+2]=m,s}}Wc.prototype.bytesPerElement=6,mt("StructArrayLayout3i6",Wc);class Cg extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m){const x=this.length;return this.resize(x+1),this.emplace(x,s,l,p,m)}emplace(s,l,p,m,x){const w=4*s;return this.int16[w+0]=l,this.int16[w+1]=p,this.int16[w+2]=m,this.int16[w+3]=x,s}}Cg.prototype.bytesPerElement=8,mt("StructArrayLayout4i8",Cg);class Yc extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,p,m,x,w)}emplace(s,l,p,m,x,w,C){const I=6*s;return this.int16[I+0]=l,this.int16[I+1]=p,this.int16[I+2]=m,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=C,s}}Yc.prototype.bytesPerElement=12,mt("StructArrayLayout2i4i12",Yc);class Vl extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,p,m,x,w)}emplace(s,l,p,m,x,w,C){const I=4*s,A=8*s;return this.int16[I+0]=l,this.int16[I+1]=p,this.uint8[A+4]=m,this.uint8[A+5]=x,this.uint8[A+6]=w,this.uint8[A+7]=C,s}}Vl.prototype.bytesPerElement=8,mt("StructArrayLayout2i4ub8",Vl);class xh extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const m=2*s;return this.float32[m+0]=l,this.float32[m+1]=p,s}}xh.prototype.bytesPerElement=8,mt("StructArrayLayout2f8",xh);class vp extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A,D){const N=this.length;return this.resize(N+1),this.emplace(N,s,l,p,m,x,w,C,I,A,D)}emplace(s,l,p,m,x,w,C,I,A,D,N){const U=10*s;return this.uint16[U+0]=l,this.uint16[U+1]=p,this.uint16[U+2]=m,this.uint16[U+3]=x,this.uint16[U+4]=w,this.uint16[U+5]=C,this.uint16[U+6]=I,this.uint16[U+7]=A,this.uint16[U+8]=D,this.uint16[U+9]=N,s}}vp.prototype.bytesPerElement=20,mt("StructArrayLayout10ui20",vp);class Gl extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A,D,N,U){const G=this.length;return this.resize(G+1),this.emplace(G,s,l,p,m,x,w,C,I,A,D,N,U)}emplace(s,l,p,m,x,w,C,I,A,D,N,U,G){const q=12*s;return this.int16[q+0]=l,this.int16[q+1]=p,this.int16[q+2]=m,this.int16[q+3]=x,this.uint16[q+4]=w,this.uint16[q+5]=C,this.uint16[q+6]=I,this.uint16[q+7]=A,this.int16[q+8]=D,this.int16[q+9]=N,this.int16[q+10]=U,this.int16[q+11]=G,s}}Gl.prototype.bytesPerElement=24,mt("StructArrayLayout4i4ui4i24",Gl);class Eg extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=3*s;return this.float32[x+0]=l,this.float32[x+1]=p,this.float32[x+2]=m,s}}Eg.prototype.bytesPerElement=12,mt("StructArrayLayout3f12",Eg);class Ig extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint32[1*s+0]=l,s}}Ig.prototype.bytesPerElement=4,mt("StructArrayLayout1ul4",Ig);class _p extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A){const D=this.length;return this.resize(D+1),this.emplace(D,s,l,p,m,x,w,C,I,A)}emplace(s,l,p,m,x,w,C,I,A,D){const N=10*s,U=5*s;return this.int16[N+0]=l,this.int16[N+1]=p,this.int16[N+2]=m,this.int16[N+3]=x,this.int16[N+4]=w,this.int16[N+5]=C,this.uint32[U+3]=I,this.uint16[N+8]=A,this.uint16[N+9]=D,s}}_p.prototype.bytesPerElement=20,mt("StructArrayLayout6i1ul2ui20",_p);class $g extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,p,m,x,w)}emplace(s,l,p,m,x,w,C){const I=6*s;return this.int16[I+0]=l,this.int16[I+1]=p,this.int16[I+2]=m,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=C,s}}$g.prototype.bytesPerElement=12,mt("StructArrayLayout2i2i2i12",$g);class _ extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x){const w=this.length;return this.resize(w+1),this.emplace(w,s,l,p,m,x)}emplace(s,l,p,m,x,w){const C=4*s,I=8*s;return this.float32[C+0]=l,this.float32[C+1]=p,this.float32[C+2]=m,this.int16[I+6]=x,this.int16[I+7]=w,s}}_.prototype.bytesPerElement=16,mt("StructArrayLayout2f1f2i16",_);class n extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,s,l,p,m,x,w)}emplace(s,l,p,m,x,w,C){const I=16*s,A=4*s,D=8*s;return this.uint8[I+0]=l,this.uint8[I+1]=p,this.float32[A+1]=m,this.float32[A+2]=x,this.int16[D+6]=w,this.int16[D+7]=C,s}}n.prototype.bytesPerElement=16,mt("StructArrayLayout2ub2f2i16",n);class u extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=3*s;return this.uint16[x+0]=l,this.uint16[x+1]=p,this.uint16[x+2]=m,s}}u.prototype.bytesPerElement=6,mt("StructArrayLayout3ui6",u);class f extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne){const ye=this.length;return this.resize(ye+1),this.emplace(ye,s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne)}emplace(s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye){const ue=24*s,de=12*s,Me=48*s;return this.int16[ue+0]=l,this.int16[ue+1]=p,this.uint16[ue+2]=m,this.uint16[ue+3]=x,this.uint32[de+2]=w,this.uint32[de+3]=C,this.uint32[de+4]=I,this.uint16[ue+10]=A,this.uint16[ue+11]=D,this.uint16[ue+12]=N,this.float32[de+7]=U,this.float32[de+8]=G,this.uint8[Me+36]=q,this.uint8[Me+37]=X,this.uint8[Me+38]=Q,this.uint32[de+10]=ne,this.int16[ue+22]=ye,s}}f.prototype.bytesPerElement=48,mt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",f);class g extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye,ue,de,Me,Re,Ze,ct,rt,at,It,ot){const lt=this.length;return this.resize(lt+1),this.emplace(lt,s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye,ue,de,Me,Re,Ze,ct,rt,at,It,ot)}emplace(s,l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye,ue,de,Me,Re,Ze,ct,rt,at,It,ot,lt){const je=32*s,At=16*s;return this.int16[je+0]=l,this.int16[je+1]=p,this.int16[je+2]=m,this.int16[je+3]=x,this.int16[je+4]=w,this.int16[je+5]=C,this.int16[je+6]=I,this.int16[je+7]=A,this.uint16[je+8]=D,this.uint16[je+9]=N,this.uint16[je+10]=U,this.uint16[je+11]=G,this.uint16[je+12]=q,this.uint16[je+13]=X,this.uint16[je+14]=Q,this.uint16[je+15]=ne,this.uint16[je+16]=ye,this.uint16[je+17]=ue,this.uint16[je+18]=de,this.uint16[je+19]=Me,this.uint16[je+20]=Re,this.uint16[je+21]=Ze,this.uint16[je+22]=ct,this.uint32[At+12]=rt,this.float32[At+13]=at,this.float32[At+14]=It,this.uint16[je+30]=ot,this.uint16[je+31]=lt,s}}g.prototype.bytesPerElement=64,mt("StructArrayLayout8i15ui1ul2f2ui64",g);class b extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.float32[1*s+0]=l,s}}b.prototype.bytesPerElement=4,mt("StructArrayLayout1f4",b);class S extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=3*s;return this.uint16[6*s+0]=l,this.float32[x+1]=p,this.float32[x+2]=m,s}}S.prototype.bytesPerElement=12,mt("StructArrayLayout1ui2f12",S);class $ extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l,p){const m=this.length;return this.resize(m+1),this.emplace(m,s,l,p)}emplace(s,l,p,m){const x=4*s;return this.uint32[2*s+0]=l,this.uint16[x+2]=p,this.uint16[x+3]=m,s}}$.prototype.bytesPerElement=8,mt("StructArrayLayout1ul2ui8",$);class M extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,l){const p=this.length;return this.resize(p+1),this.emplace(p,s,l)}emplace(s,l,p){const m=2*s;return this.uint16[m+0]=l,this.uint16[m+1]=p,s}}M.prototype.bytesPerElement=4,mt("StructArrayLayout2ui4",M);class z extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const l=this.length;return this.resize(l+1),this.emplace(l,s)}emplace(s,l){return this.uint16[1*s+0]=l,s}}z.prototype.bytesPerElement=2,mt("StructArrayLayout1ui2",z);class F extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,l,p,m){const x=this.length;return this.resize(x+1),this.emplace(x,s,l,p,m)}emplace(s,l,p,m,x){const w=4*s;return this.float32[w+0]=l,this.float32[w+1]=p,this.float32[w+2]=m,this.float32[w+3]=x,s}}F.prototype.bytesPerElement=16,mt("StructArrayLayout4f16",F);class j extends bh{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new v(this.anchorPointX,this.anchorPointY)}}j.prototype.size=20;class B extends _p{get(s){return new j(this,s)}}mt("CollisionBoxArray",B);class V extends bh{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}V.prototype.size=48;class W extends f{get(s){return new V(this,s)}}mt("PlacedSymbolArray",W);class te extends bh{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}te.prototype.size=64;class ee extends g{get(s){return new te(this,s)}}mt("SymbolInstanceArray",ee);class re extends b{getoffsetX(s){return this.float32[1*s+0]}}mt("GlyphOffsetArray",re);class se extends Wc{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}mt("SymbolLineVertexArray",se);class ce extends bh{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ce.prototype.size=12;class oe extends S{get(s){return new ce(this,s)}}mt("TextAnchorOffsetArray",oe);class he extends bh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}he.prototype.size=8;class me extends ${get(s){return new he(this,s)}}mt("FeatureIndexArray",me);class ae extends Zc{}class we extends Zc{}class Oe extends Zc{}class Ee extends Yc{}class $e extends Vl{}class ze extends xh{}class tt extends vp{}class st extends Gl{}class He extends Eg{}class xt extends Ig{}class Ht extends $g{}class yi extends n{}class Ci extends u{}class wi extends M{}const Hi=rr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xi}=Hi;class Ut{constructor(s=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=s}prepareSegment(s,l,p,m){const x=this.segments[this.segments.length-1];return s>Ut.MAX_VERTEX_ARRAY_LENGTH&&cr(`Max vertices per segment is ${Ut.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ut.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!x||x.vertexLength+s>Ut.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==m?this.createNewSegment(l,p,m):x}createNewSegment(s,l,p){const m={vertexOffset:s.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(m.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(s,l,p){return this.prepareSegment(0,s,l,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const s of this.segments)for(const l in s.vaos)s.vaos[l].destroy()}static simpleSegment(s,l,p,m){return new Ut([{vertexOffset:s,primitiveOffset:l,vertexLength:p,primitiveLength:m,vaos:{},sortKey:0}])}}function Ei(c,s){return 256*(c=sn(Math.floor(c),0,255))+sn(Math.floor(s),0,255)}Ut.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mt("SegmentVector",Ut);const _r=rr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ar,Hr,In,Zs={exports:{}},Ha={exports:{}},Za={exports:{}},Xc=(function(){if(In)return Zs.exports;In=1;var c=(Ar||(Ar=1,Ha.exports=function(l,p){var m,x,w,C,I,A,D,N;for(x=l.length-(m=3&l.length),w=p,I=3432918353,A=461845907,N=0;N<x;)D=255&l.charCodeAt(N)|(255&l.charCodeAt(++N))<<8|(255&l.charCodeAt(++N))<<16|(255&l.charCodeAt(++N))<<24,++N,w=27492+(65535&(C=5*(65535&(w=(w^=D=(65535&(D=(D=(65535&D)*I+(((D>>>16)*I&65535)<<16)&4294967295)<<15|D>>>17))*A+(((D>>>16)*A&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(D=0,m){case 3:D^=(255&l.charCodeAt(N+2))<<16;case 2:D^=(255&l.charCodeAt(N+1))<<8;case 1:w^=D=(65535&(D=(D=(65535&(D^=255&l.charCodeAt(N)))*I+(((D>>>16)*I&65535)<<16)&4294967295)<<15|D>>>17))*A+(((D>>>16)*A&65535)<<16)&4294967295}return w^=l.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}),Ha.exports),s=(Hr||(Hr=1,Za.exports=function(l,p){for(var m,x=l.length,w=p^x,C=0;x>=4;)m=1540483477*(65535&(m=255&l.charCodeAt(C)|(255&l.charCodeAt(++C))<<8|(255&l.charCodeAt(++C))<<16|(255&l.charCodeAt(++C))<<24))+((1540483477*(m>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),x-=4,++C;switch(x){case 3:w^=(255&l.charCodeAt(C+2))<<16;case 2:w^=(255&l.charCodeAt(C+1))<<8;case 1:w=1540483477*(65535&(w^=255&l.charCodeAt(C)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}),Za.exports);return Zs.exports=c,Zs.exports.murmur3=c,Zs.exports.murmur2=s,Zs.exports})(),Jc=T(Xc);class ql{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,l,p,m){this.ids.push(Hl(s)),this.positions.push(l,p,m)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=Hl(s);let p=0,m=this.ids.length-1;for(;p<m;){const w=p+m>>1;this.ids[w]>=l?m=w:p=w+1}const x=[];for(;this.ids[p]===l;)x.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return x}static serialize(s,l){const p=new Float64Array(s.ids),m=new Uint32Array(s.positions);return jn(p,m,0,p.length-1),l&&l.push(p.buffer,m.buffer),{ids:p,positions:m}}static deserialize(s){const l=new ql;return l.ids=s.ids,l.positions=s.positions,l.indexed=!0,l}}function Hl(c){const s=+c;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:Jc(String(c))}function jn(c,s,l,p){for(;l<p;){const m=c[l+p>>1];let x=l-1,w=p+1;for(;;){do x++;while(c[x]<m);do w--;while(c[w]>m);if(x>=w)break;Ws(c,x,w),Ws(s,3*x,3*w),Ws(s,3*x+1,3*w+1),Ws(s,3*x+2,3*w+2)}w-l<p-w?(jn(c,s,l,w),l=w+1):(jn(c,s,w+1,p),p=w)}}function Ws(c,s,l){const p=c[s];c[s]=c[l],c[l]=p}mt("FeaturePositionMap",ql);class $n{constructor(s,l){this.gl=s.gl,this.location=l}}class Wa extends $n{constructor(s,l){super(s,l),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class br extends $n{constructor(s,l){super(s,l),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class Dr extends $n{constructor(s,l){super(s,l),this.current=ei.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const xs=new Float32Array(16);function xr(c){return[Ei(255*c.r,255*c.g),Ei(255*c.b,255*c.a)]}class wh{constructor(s,l,p){this.value=s,this.uniformNames=l.map((m=>`u_${m}`)),this.type=p}setUniform(s,l,p){s.set(p.constantOr(this.value))}getBinding(s,l,p){return this.type==="color"?new Dr(s,l):new Wa(s,l)}}class Kc{constructor(s,l){this.uniformNames=l.map((p=>`u_${p}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=s.tlbr}setUniform(s,l,p,m){const x=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&s.set(x)}getBinding(s,l,p){return p.substr(0,9)==="u_pattern"?new br(s,l):new Wa(s,l)}}class Ko{constructor(s,l,p,m){this.expression=s,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map((x=>({name:`a_${x}`,type:"Float32",components:p==="color"?2:1,offset:0}))),this.paintVertexArray=new m}populatePaintArray(s,l,p){const m=this.paintVertexArray.length,x=this.expression.evaluate(new ki(0,p),l,{},p.canonical,[],p.formattedSection);this.paintVertexArray.resize(s),this._setPaintValue(m,s,x)}updatePaintArray(s,l,p,m,x){const w=this.expression.evaluate(new ki(0,x),p,m);this._setPaintValue(s,l,w)}_setPaintValue(s,l,p){if(this.type==="color"){const m=xr(p);for(let x=s;x<l;x++)this.paintVertexArray.emplace(x,m[0],m[1])}else{for(let m=s;m<l;m++)this.paintVertexArray.emplace(m,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ys{constructor(s,l,p,m,x,w){this.expression=s,this.uniformNames=l.map((C=>`u_${C}_t`)),this.type=p,this.useIntegerZoom=m,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=l.map((C=>({name:`a_${C}`,type:"Float32",components:p==="color"?4:2,offset:0}))),this.paintVertexArray=new w}populatePaintArray(s,l,p){const m=this.expression.evaluate(new ki(this.zoom,p),l,{},p.canonical,[],p.formattedSection),x=this.expression.evaluate(new ki(this.zoom+1,p),l,{},p.canonical,[],p.formattedSection),w=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(w,s,m,x)}updatePaintArray(s,l,p,m,x){const w=this.expression.evaluate(new ki(this.zoom,x),p,m),C=this.expression.evaluate(new ki(this.zoom+1,x),p,m);this._setPaintValue(s,l,w,C)}_setPaintValue(s,l,p,m){if(this.type==="color"){const x=xr(p),w=xr(m);for(let C=s;C<l;C++)this.paintVertexArray.emplace(C,x[0],x[1],w[0],w[1])}else{for(let x=s;x<l;x++)this.paintVertexArray.emplace(x,p,m);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(m))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,l){const p=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=sn(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);s.set(m)}getBinding(s,l,p){return new Wa(s,l)}}class Ya{constructor(s,l,p,m,x,w){this.expression=s,this.type=l,this.useIntegerZoom=p,this.zoom=m,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(s,l,p){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(m,s,l.patterns&&l.patterns[this.layerId],p.imagePositions)}updatePaintArray(s,l,p,m,x){this._setPaintValues(s,l,p.patterns&&p.patterns[this.layerId],x.imagePositions)}_setPaintValues(s,l,p,m){if(!m||!p)return;const{min:x,mid:w,max:C}=p,I=m[x],A=m[w],D=m[C];if(I&&A&&D)for(let N=s;N<l;N++)this.zoomInPaintVertexArray.emplace(N,A.tl[0],A.tl[1],A.br[0],A.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],A.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(N,A.tl[0],A.tl[1],A.br[0],A.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],A.pixelRatio,D.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,_r.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,_r.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class d_{constructor(s,l,p){this.binders={},this._buffers=[];const m=[];for(const x in s.paint._values){if(!p(x))continue;const w=s.paint.get(x);if(!(w instanceof Po&&Va(w.property.specification)))continue;const C=p_(x,s.type),I=w.value,A=w.property.specification.type,D=w.property.useIntegerZoom,N=w.property.specification["property-type"],U=N==="cross-faded"||N==="cross-faded-data-driven";if(I.kind==="constant")this.binders[x]=U?new Kc(I.value,C):new wh(I.value,C,A),m.push(`/u_${x}`);else if(I.kind==="source"||U){const G=Pg(x,A,"source");this.binders[x]=U?new Ya(I,A,D,l,G,s.id):new Ko(I,C,A,G),m.push(`/a_${x}`)}else{const G=Pg(x,A,"composite");this.binders[x]=new Ys(I,C,A,D,l,G),m.push(`/z_${x}`)}}this.cacheKey=m.sort().join("")}getMaxValue(s){const l=this.binders[s];return l instanceof Ko||l instanceof Ys?l.maxValue:0}populatePaintArrays(s,l,p){for(const m in this.binders){const x=this.binders[m];(x instanceof Ko||x instanceof Ys||x instanceof Ya)&&x.populatePaintArray(s,l,p)}}setConstantPatternPositions(s,l){for(const p in this.binders){const m=this.binders[p];m instanceof Kc&&m.setConstantPatternPositions(s,l)}}updatePaintArrays(s,l,p,m,x){let w=!1;for(const C in s){const I=l.getPositions(C);for(const A of I){const D=p.feature(A.index);for(const N in this.binders){const U=this.binders[N];if((U instanceof Ko||U instanceof Ys||U instanceof Ya)&&U.expression.isStateDependent===!0){const G=m.paint.get(N);U.expression=G.value,U.updatePaintArray(A.start,A.end,D,s[C],x),w=!0}}}}return w}defines(){const s=[];for(const l in this.binders){const p=this.binders[l];(p instanceof wh||p instanceof Kc)&&s.push(...p.uniformNames.map((m=>`#define HAS_UNIFORM_${m}`)))}return s}getBinderAttributes(){const s=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof Ko||p instanceof Ys)for(let m=0;m<p.paintVertexAttributes.length;m++)s.push(p.paintVertexAttributes[m].name);else if(p instanceof Ya)for(let m=0;m<_r.members.length;m++)s.push(_r.members[m].name)}return s}getBinderUniforms(){const s=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof wh||p instanceof Kc||p instanceof Ys)for(const m of p.uniformNames)s.push(m)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,l){const p=[];for(const m in this.binders){const x=this.binders[m];if(x instanceof wh||x instanceof Kc||x instanceof Ys){for(const w of x.uniformNames)if(l[w]){const C=x.getBinding(s,l[w],w);p.push({name:w,property:m,binding:C})}}}return p}setUniforms(s,l,p,m){for(const{name:x,property:w,binding:C}of l)this.binders[w].setUniform(C,m,p.get(w),x)}updatePaintBuffers(s){this._buffers=[];for(const l in this.binders){const p=this.binders[l];if(s&&p instanceof Ya){const m=s.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(p instanceof Ko||p instanceof Ys)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(s){for(const l in this.binders){const p=this.binders[l];(p instanceof Ko||p instanceof Ys||p instanceof Ya)&&p.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const l=this.binders[s];(l instanceof Ko||l instanceof Ys||l instanceof Ya)&&l.destroy()}}}class ns{constructor(s,l,p=()=>!0){this.programConfigurations={};for(const m of s)this.programConfigurations[m.id]=new d_(m,l,p);this.needsUpload=!1,this._featureMap=new ql,this._bufferOffset=0}populatePaintArrays(s,l,p,m){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(s,l,m);l.id!==void 0&&this._featureMap.add(l.id,p,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,l,p,m){for(const x of p)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,l,x,m)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function p_(c,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}function Pg(c,s,l){const p={color:{source:xh,composite:F},number:{source:b,composite:xh}},m=(function(x){return{"line-pattern":{source:tt,composite:tt},"fill-pattern":{source:tt,composite:tt},"fill-extrusion-pattern":{source:tt,composite:tt}}[x]})(c);return m&&m[l]||p[s][l]}mt("ConstantBinder",wh),mt("CrossFadedConstantBinder",Kc),mt("SourceExpressionBinder",Ko),mt("CrossFadedCompositeBinder",Ya),mt("CompositeExpressionBinder",Ys),mt("ProgramConfiguration",d_,{omit:["_buffers"]}),mt("ProgramConfigurationSet",ns);const bp=Math.pow(2,14)-1,xp=-bp-1;function Xa(c){const s=Ye/c.extent,l=c.loadGeometry();for(let p=0;p<l.length;p++){const m=l[p];for(let x=0;x<m.length;x++){const w=m[x],C=Math.round(w.x*s),I=Math.round(w.y*s);w.x=sn(C,xp,bp),w.y=sn(I,xp,bp),(C<w.x||C>w.x+1||I<w.y||I>w.y+1)&&cr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function Qo(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?Xa(c):[]}}const oM=-32768;function F8(c,s,l,p,m){c.emplaceBack(oM+8*s+p,oM+8*l+m)}class E2{constructor(s){this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((l=>l.id)),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new we,this.indexArray=new Ci,this.segments=new Ut,this.programConfigurations=new ns(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id))}populate(s,l,p){const m=this.layers[0],x=[];let w=null,C=!1,I=m.type==="heatmap";if(m.type==="circle"){const D=m;w=D.layout.get("circle-sort-key"),C=!w.isConstant(),I=I||D.paint.get("circle-pitch-alignment")==="map"}const A=I?l.subdivisionGranularity.circle:1;for(const{feature:D,id:N,index:U,sourceLayerIndex:G}of s){const q=this.layers[0]._featureFilter.needGeometry,X=Qo(D,q);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom,{globalState:this.globalState}),X,p))continue;const Q=C?w.evaluate(X,{},p):void 0,ne={id:N,properties:D.properties,type:D.type,sourceLayerIndex:G,index:U,geometry:q?X.geometry:Xa(D),patterns:{},sortKey:Q};x.push(ne)}C&&x.sort(((D,N)=>D.sortKey-N.sortKey));for(const D of x){const{geometry:N,index:U,sourceLayerIndex:G}=D,q=s[U].feature;this.addFeature(D,N,U,p,A),l.featureIndex.insert(q,N,U,G,this.index)}}update(s,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,{imagePositions:p,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Xi),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,l,p,m,x=1){let w;switch(x){case 1:w=[0,7];break;case 3:w=[0,2,5,7];break;case 5:w=[0,1,3,4,6,7];break;case 7:w=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${x}; valid values are 1, 3, 5, 7.`)}const C=w.length;for(const I of l)for(const A of I){const D=A.x,N=A.y;if(D<0||D>=Ye||N<0||N>=Ye)continue;const U=this.segments.prepareSegment(C*C,this.layoutVertexArray,this.indexArray,s.sortKey),G=U.vertexLength;for(let q=0;q<C;q++)for(let X=0;X<C;X++)F8(this.layoutVertexArray,D,N,w[X],w[q]);for(let q=0;q<C-1;q++)for(let X=0;X<C-1;X++){const Q=G+q*C+X,ne=G+(q+1)*C+X;this.indexArray.emplaceBack(Q,ne+1,Q+1),this.indexArray.emplaceBack(Q,ne,ne+1)}U.vertexLength+=C*C,U.primitiveLength+=(C-1)*(C-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{imagePositions:{},canonical:m,globalState:this.globalState})}}function aM(c,s){for(let l=0;l<c.length;l++)if(wp(s,c[l]))return!0;for(let l=0;l<s.length;l++)if(wp(c,s[l]))return!0;return!!I2(c,s)}function N8(c,s,l){return!!wp(c,s)||!!$2(s,c,l)}function lM(c,s){if(c.length===1)return uM(s,c[0]);for(let l=0;l<s.length;l++){const p=s[l];for(let m=0;m<p.length;m++)if(wp(c,p[m]))return!0}for(let l=0;l<c.length;l++)if(uM(s,c[l]))return!0;for(let l=0;l<s.length;l++)if(I2(c,s[l]))return!0;return!1}function B8(c,s,l){if(c.length>1){if(I2(c,s))return!0;for(let p=0;p<s.length;p++)if($2(s[p],c,l))return!0}for(let p=0;p<c.length;p++)if($2(c[p],s,l))return!0;return!1}function I2(c,s){if(c.length===0||s.length===0)return!1;for(let l=0;l<c.length-1;l++){const p=c[l],m=c[l+1];for(let x=0;x<s.length-1;x++)if(j8(p,m,s[x],s[x+1]))return!0}return!1}function j8(c,s,l,p){return Fs(c,l,p)!==Fs(s,l,p)&&Fs(c,s,l)!==Fs(c,s,p)}function $2(c,s,l){const p=l*l;if(s.length===1)return c.distSqr(s[0])<p;for(let m=1;m<s.length;m++)if(cM(c,s[m-1],s[m])<p)return!0;return!1}function cM(c,s,l){const p=s.distSqr(l);if(p===0)return c.distSqr(s);const m=((c.x-s.x)*(l.x-s.x)+(c.y-s.y)*(l.y-s.y))/p;return c.distSqr(m<0?s:m>1?l:l.sub(s)._mult(m)._add(s))}function uM(c,s){let l,p,m,x=!1;for(let w=0;w<c.length;w++){l=c[w];for(let C=0,I=l.length-1;C<l.length;I=C++)p=l[C],m=l[I],p.y>s.y!=m.y>s.y&&s.x<(m.x-p.x)*(s.y-p.y)/(m.y-p.y)+p.x&&(x=!x)}return x}function wp(c,s){let l=!1;for(let p=0,m=c.length-1;p<c.length;m=p++){const x=c[p],w=c[m];x.y>s.y!=w.y>s.y&&s.x<(w.x-x.x)*(s.y-x.y)/(w.y-x.y)+x.x&&(l=!l)}return l}function U8(c,s,l){const p=l[0],m=l[2];if(c.x<p.x&&s.x<p.x||c.x>m.x&&s.x>m.x||c.y<p.y&&s.y<p.y||c.y>m.y&&s.y>m.y)return!1;const x=Fs(c,s,l[0]);return x!==Fs(c,s,l[1])||x!==Fs(c,s,l[2])||x!==Fs(c,s,l[3])}function Mg(c,s,l){const p=s.paint.get(c).value;return p.kind==="constant"?p.value:l.programConfigurations.get(s.id).getMaxValue(c)}function f_(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function m_(c,s,l,p,m){if(!s[0]&&!s[1])return c;const x=v.convert(s)._mult(m);l==="viewport"&&x._rotate(-p);const w=[];for(let C=0;C<c.length;C++)w.push(c[C].sub(x));return w}let hM,dM;mt("CircleBucket",E2,{omit:["layers"]});var V8={get paint(){return dM=dM||new En({"circle-radius":new Mt(Te.paint_circle["circle-radius"]),"circle-color":new Mt(Te.paint_circle["circle-color"]),"circle-blur":new Mt(Te.paint_circle["circle-blur"]),"circle-opacity":new Mt(Te.paint_circle["circle-opacity"]),"circle-translate":new Tt(Te.paint_circle["circle-translate"]),"circle-translate-anchor":new Tt(Te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tt(Te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tt(Te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Mt(Te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Mt(Te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Mt(Te.paint_circle["circle-stroke-opacity"])})},get layout(){return hM=hM||new En({"circle-sort-key":new Mt(Te.layout_circle["circle-sort-key"])})}};class G8 extends bs{constructor(s){super(s,V8)}createBucket(s){return new E2(s)}queryRadius(s){const l=s;return Mg("circle-radius",this,l)+Mg("circle-stroke-width",this,l)+f_(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:s,feature:l,featureState:p,geometry:m,transform:x,pixelsToTileUnits:w,unwrappedTileID:C,getElevation:I}){const A=m_(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-x.bearingInRadians,w),D=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),N=this.paint.get("circle-pitch-alignment")==="map",U=N?A:(function(q,X,Q,ne){return q.map((ye=>pM(ye,X,Q,ne)))})(A,x,C,I),G=N?D*w:D;for(const q of m)for(const X of q){const Q=N?X:pM(X,x,C,I);let ne=G;const ye=x.projectTileCoordinates(X.x,X.y,C,I).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ne*=ye/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ne*=x.cameraToCenterDistance/ye),N8(U,Q,ne))return!0}return!1}}function pM(c,s,l,p){const m=s.projectTileCoordinates(c.x,c.y,l,p).point;return new v((.5*m.x+.5)*s.width,(.5*-m.y+.5)*s.height)}class fM extends E2{}let mM;mt("HeatmapBucket",fM,{omit:["layers"]});var q8={get paint(){return mM=mM||new En({"heatmap-radius":new Mt(Te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Mt(Te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tt(Te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new gp(Te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tt(Te.paint_heatmap["heatmap-opacity"])})}};function P2(c,{width:s,height:l},p,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==s*l*p)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${s*l*p}`)}else m=new Uint8Array(s*l*p);return c.width=s,c.height=l,c.data=m,c}function gM(c,{width:s,height:l},p){if(s===c.width&&l===c.height)return;const m=P2({},{width:s,height:l},p);M2(c,m,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,s),height:Math.min(c.height,l)},p),c.width=s,c.height=l,c.data=m.data}function M2(c,s,l,p,m,x){if(m.width===0||m.height===0)return s;if(m.width>c.width||m.height>c.height||l.x>c.width-m.width||l.y>c.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||p.x>s.width-m.width||p.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const w=c.data,C=s.data;if(w===C)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<m.height;I++){const A=((l.y+I)*c.width+l.x)*x,D=((p.y+I)*s.width+p.x)*x;for(let N=0;N<m.width*x;N++)C[D+N]=w[A+N]}return s}class kg{constructor(s,l){P2(this,s,1,l)}resize(s){gM(this,s,1)}clone(){return new kg({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,p,m,x){M2(s,l,p,m,x,1)}}class ss{constructor(s,l){P2(this,s,4,l)}resize(s){gM(this,s,4)}replace(s,l){l?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new ss({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,l,p,m,x){M2(s,l,p,m,x,4)}setPixel(s,l,p){const m=4*(s*this.width+l);this.data[m+0]=Math.round(255*p.r/p.a),this.data[m+1]=Math.round(255*p.g/p.a),this.data[m+2]=Math.round(255*p.b/p.a),this.data[m+3]=Math.round(255*p.a)}}function yM(c){const s={},l=c.resolution||256,p=c.clips?c.clips.length:1,m=c.image||new ss({width:l,height:p});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const x=(w,C,I)=>{s[c.evaluationKey]=I;const A=c.expression.evaluate(s);m.setPixel(w/4/l,C/4,A)};if(c.clips)for(let w=0,C=0;w<p;++w,C+=4*l)for(let I=0,A=0;I<l;I++,A+=4){const D=I/(l-1),{start:N,end:U}=c.clips[w];x(C,A,N*(1-D)+U*D)}else for(let w=0,C=0;w<l;w++,C+=4)x(0,C,w/(l-1));return m}mt("AlphaImage",kg),mt("RGBAImage",ss);const k2="big-fb";class H8 extends bs{createBucket(s){return new fM(s)}constructor(s){super(s,q8),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=yM({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(k2)&&this.heatmapFbos.delete(k2)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let vM;var Z8={get paint(){return vM=vM||new En({"hillshade-illumination-direction":new Tt(Te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Tt(Te.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Tt(Te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tt(Te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tt(Te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tt(Te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tt(Te.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Tt(Te.paint_hillshade["hillshade-method"])})}};class W8 extends bs{constructor(s){super(s,Z8),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let s=this.paint.get("hillshade-illumination-direction").values,l=this.paint.get("hillshade-illumination-altitude").values,p=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values;const x=Math.max(s.length,l.length,p.length,m.length);s=s.concat(Array(x-s.length).fill(s.at(-1))),l=l.concat(Array(x-l.length).fill(l.at(-1))),p=p.concat(Array(x-p.length).fill(p.at(-1))),m=m.concat(Array(x-m.length).fill(m.at(-1)));const w=l.map(El);return{directionRadians:s.map(El),altitudeRadians:w,shadowColor:m,highlightColor:p}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let _M;var Y8={get paint(){return _M=_M||new En({"color-relief-opacity":new Tt(Te["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new gp(Te["paint_color-relief"]["color-relief-color"])})}};class A2{constructor(s,l,p,m){this.context=s,this.format=p,this.texture=s.gl.createTexture(),this.update(l,m)}update(s,l,p){const{width:m,height:x}=s,w=!(this.size&&this.size[0]===m&&this.size[1]===x||p),{context:C}=this,{gl:I}=C;if(this.useMipmap=!!(l&&l.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!l||l.premultiply!==!1)),w)this.size=[m,x],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||wo(s)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,s):I.texImage2D(I.TEXTURE_2D,0,this.format,m,x,0,this.format,I.UNSIGNED_BYTE,s.data);else{const{x:A,y:D}=p||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||wo(s)?I.texSubImage2D(I.TEXTURE_2D,0,A,D,I.RGBA,I.UNSIGNED_BYTE,s):I.texSubImage2D(I.TEXTURE_2D,0,A,D,m,x,I.RGBA,I.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D),C.pixelStoreUnpackFlipY.setDefault(),C.pixelStoreUnpack.setDefault(),C.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(s,l,p){const{context:m}=this,{gl:x}=m;x.bindTexture(x.TEXTURE_2D,this.texture),p!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=x.LINEAR),s!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,s),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,p||s),this.filter=s),l!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,l),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class bM{constructor(s,l,p,m=1,x=1,w=1,C=0){if(this.uid=s,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void cr(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;const I=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=x,this.blueFactor=w,this.baseShift=C;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let A=0;A<I;A++)this.data[this._idx(-1,A)]=this.data[this._idx(0,A)],this.data[this._idx(I,A)]=this.data[this._idx(I-1,A)],this.data[this._idx(A,-1)]=this.data[this._idx(A,0)],this.data[this._idx(A,I)]=this.data[this._idx(A,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let A=0;A<I;A++)for(let D=0;D<I;D++){const N=this.get(A,D);N>this.max&&(this.max=N),N<this.min&&(this.min=N)}}get(s,l){const p=new Uint8Array(this.data.buffer),m=4*this._idx(s,l);return this.unpack(p[m],p[m+1],p[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,l){if(s<-1||s>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(s+1)}unpack(s,l,p){return s*this.redFactor+l*this.greenFactor+p*this.blueFactor-this.baseShift}pack(s){return xM(s,this.getUnpackVector())}getPixels(){return new ss({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,l,p){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let m=l*this.dim,x=l*this.dim+this.dim,w=p*this.dim,C=p*this.dim+this.dim;switch(l){case-1:m=x-1;break;case 1:x=m+1}switch(p){case-1:w=C-1;break;case 1:C=w+1}const I=-l*this.dim,A=-p*this.dim;for(let D=w;D<C;D++)for(let N=m;N<x;N++)this.data[this._idx(N,D)]=s.data[this._idx(N+I,D+A)]}}function xM(c,s){const l=s[0],p=s[1],m=s[2],x=s[3],w=Math.min(l,p,m),C=Math.round((c+x)/w);return{r:Math.floor(C*w/l)%256,g:Math.floor(C*w/p)%256,b:Math.floor(C*w/m)%256}}mt("DEMData",bM);class X8 extends bs{constructor(s){super(s,Y8)}_createColorRamp(s){const l={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values["color-relief-color"].value.expression;if(p instanceof dh&&p._styleExpression.expression instanceof an){this.colorRampExpression=p;const w=p._styleExpression.expression;l.elevationStops=w.labels,l.colorStops=[];for(const C of l.elevationStops)l.colorStops.push(w.evaluate({globals:{elevation:C}}))}if(l.elevationStops.length<1&&(l.elevationStops=[0],l.colorStops=[ei.transparent]),l.elevationStops.length<2&&(l.elevationStops.push(l.elevationStops[0]+1),l.colorStops.push(l.colorStops[0])),l.elevationStops.length<=s)return l;const m={elevationStops:[],colorStops:[]},x=(l.elevationStops.length-1)/(s-1);for(let w=0;w<l.elevationStops.length-.5;w+=x)m.elevationStops.push(l.elevationStops[Math.round(w)]),m.colorStops.push(l.colorStops[Math.round(w)]);return cr(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(s,l,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const m=this._createColorRamp(l),x=new ss({width:m.colorStops.length,height:1}),w=new ss({width:m.colorStops.length,height:1});for(let C=0;C<m.elevationStops.length;C++){const I=xM(m.elevationStops[C],p);w.setPixel(0,C,new ei(I.r/255,I.g/255,I.b/255,1)),x.setPixel(0,C,m.colorStops[C])}return this.colorRampTextures={elevationTexture:new A2(s,w,s.gl.RGBA),colorTexture:new A2(s,x,s.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const J8=rr([{name:"a_pos",components:2,type:"Int16"}],4),{members:K8}=J8;function D2(c,s,l){const p=l.patternDependencies;let m=!1;for(const x of s){const w=x.paint.get(`${c}-pattern`);w.isConstant()||(m=!0);const C=w.constantOr(null);C&&(m=!0,p[C.to]=!0,p[C.from]=!0)}return m}function z2(c,s,l,p,m){const{zoom:x,globalState:w}=p,C=m.patternDependencies;for(const I of s){const A=I.paint.get(`${c}-pattern`).value;if(A.kind!=="constant"){let D=A.evaluate({zoom:x-1,globalState:w},l,{},m.availableImages),N=A.evaluate({zoom:x,globalState:w},l,{},m.availableImages),U=A.evaluate({zoom:x+1,globalState:w},l,{},m.availableImages);D=D&&D.name?D.name:D,N=N&&N.name?N.name:N,U=U&&U.name?U.name:U,C[D]=!0,C[N]=!0,C[U]=!0,l.patterns[I.id]={min:D,mid:N,max:U}}}return l}function wM(c,s,l,p,m){let x;if(m===(function(w,C,I,A){let D=0;for(let N=C,U=I-A;N<I;N+=A)D+=(w[U]-w[N])*(w[N+1]+w[U+1]),U=N;return D})(c,s,l,p)>0)for(let w=s;w<l;w+=p)x=EM(w/p|0,c[w],c[w+1],x);else for(let w=l-p;w>=s;w-=p)x=EM(w/p|0,c[w],c[w+1],x);return x&&Sp(x,x.next)&&(Og(x),x=x.next),x}function Sh(c,s){if(!c)return c;s||(s=c);let l,p=c;do if(l=!1,p.steiner||!Sp(p,p.next)&&hr(p.prev,p,p.next)!==0)p=p.next;else{if(Og(p),p=s=p.prev,p===p.next)break;l=!0}while(l||p!==s);return s}function Ag(c,s,l,p,m,x,w){if(!c)return;!w&&x&&(function(I,A,D,N){let U=I;do U.z===0&&(U.z=O2(U.x,U.y,A,D,N)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==I);U.prevZ.nextZ=null,U.prevZ=null,(function(G){let q,X=1;do{let Q,ne=G;G=null;let ye=null;for(q=0;ne;){q++;let ue=ne,de=0;for(let Re=0;Re<X&&(de++,ue=ue.nextZ,ue);Re++);let Me=X;for(;de>0||Me>0&&ue;)de!==0&&(Me===0||!ue||ne.z<=ue.z)?(Q=ne,ne=ne.nextZ,de--):(Q=ue,ue=ue.nextZ,Me--),ye?ye.nextZ=Q:G=Q,Q.prevZ=ye,ye=Q;ne=ue}ye.nextZ=null,X*=2}while(q>1)})(U)})(c,p,m,x);let C=c;for(;c.prev!==c.next;){const I=c.prev,A=c.next;if(x?ej(c,p,m,x):Q8(c))s.push(I.i,c.i,A.i),Og(c),c=A.next,C=A.next;else if((c=A)===C){w?w===1?Ag(c=tj(Sh(c),s),s,l,p,m,x,2):w===2&&ij(c,s,l,p,m,x):Ag(Sh(c),s,l,p,m,x,1);break}}}function Q8(c){const s=c.prev,l=c,p=c.next;if(hr(s,l,p)>=0)return!1;const m=s.x,x=l.x,w=p.x,C=s.y,I=l.y,A=p.y,D=Math.min(m,x,w),N=Math.min(C,I,A),U=Math.max(m,x,w),G=Math.max(C,I,A);let q=p.next;for(;q!==s;){if(q.x>=D&&q.x<=U&&q.y>=N&&q.y<=G&&Dg(m,C,x,I,w,A,q.x,q.y)&&hr(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function ej(c,s,l,p){const m=c.prev,x=c,w=c.next;if(hr(m,x,w)>=0)return!1;const C=m.x,I=x.x,A=w.x,D=m.y,N=x.y,U=w.y,G=Math.min(C,I,A),q=Math.min(D,N,U),X=Math.max(C,I,A),Q=Math.max(D,N,U),ne=O2(G,q,s,l,p),ye=O2(X,Q,s,l,p);let ue=c.prevZ,de=c.nextZ;for(;ue&&ue.z>=ne&&de&&de.z<=ye;){if(ue.x>=G&&ue.x<=X&&ue.y>=q&&ue.y<=Q&&ue!==m&&ue!==w&&Dg(C,D,I,N,A,U,ue.x,ue.y)&&hr(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,de.x>=G&&de.x<=X&&de.y>=q&&de.y<=Q&&de!==m&&de!==w&&Dg(C,D,I,N,A,U,de.x,de.y)&&hr(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;ue&&ue.z>=ne;){if(ue.x>=G&&ue.x<=X&&ue.y>=q&&ue.y<=Q&&ue!==m&&ue!==w&&Dg(C,D,I,N,A,U,ue.x,ue.y)&&hr(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;de&&de.z<=ye;){if(de.x>=G&&de.x<=X&&de.y>=q&&de.y<=Q&&de!==m&&de!==w&&Dg(C,D,I,N,A,U,de.x,de.y)&&hr(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function tj(c,s){let l=c;do{const p=l.prev,m=l.next.next;!Sp(p,m)&&TM(p,l,l.next,m)&&zg(p,m)&&zg(m,p)&&(s.push(p.i,l.i,m.i),Og(l),Og(l.next),l=c=m),l=l.next}while(l!==c);return Sh(l)}function ij(c,s,l,p,m,x){let w=c;do{let C=w.next.next;for(;C!==w.prev;){if(w.i!==C.i&&aj(w,C)){let I=CM(w,C);return w=Sh(w,w.next),I=Sh(I,I.next),Ag(w,s,l,p,m,x,0),void Ag(I,s,l,p,m,x,0)}C=C.next}w=w.next}while(w!==c)}function rj(c,s){let l=c.x-s.x;return l===0&&(l=c.y-s.y,l===0)&&(l=(c.next.y-c.y)/(c.next.x-c.x)-(s.next.y-s.y)/(s.next.x-s.x)),l}function nj(c,s){const l=(function(m,x){let w=x;const C=m.x,I=m.y;let A,D=-1/0;if(Sp(m,w))return w;do{if(Sp(m,w.next))return w.next;if(I<=w.y&&I>=w.next.y&&w.next.y!==w.y){const X=w.x+(I-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(X<=C&&X>D&&(D=X,A=w.x<w.next.x?w:w.next,X===C))return A}w=w.next}while(w!==x);if(!A)return null;const N=A,U=A.x,G=A.y;let q=1/0;w=A;do{if(C>=w.x&&w.x>=U&&C!==w.x&&SM(I<G?C:D,I,U,G,I<G?D:C,I,w.x,w.y)){const X=Math.abs(I-w.y)/(C-w.x);zg(w,m)&&(X<q||X===q&&(w.x>A.x||w.x===A.x&&sj(A,w)))&&(A=w,q=X)}w=w.next}while(w!==N);return A})(c,s);if(!l)return s;const p=CM(l,c);return Sh(p,p.next),Sh(l,l.next)}function sj(c,s){return hr(c.prev,c,s.prev)<0&&hr(s.next,c,c.next)<0}function O2(c,s,l,p,m){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-l)*m|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-p)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function oj(c){let s=c,l=c;do(s.x<l.x||s.x===l.x&&s.y<l.y)&&(l=s),s=s.next;while(s!==c);return l}function SM(c,s,l,p,m,x,w,C){return(m-w)*(s-C)>=(c-w)*(x-C)&&(c-w)*(p-C)>=(l-w)*(s-C)&&(l-w)*(x-C)>=(m-w)*(p-C)}function Dg(c,s,l,p,m,x,w,C){return!(c===w&&s===C)&&SM(c,s,l,p,m,x,w,C)}function aj(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!(function(l,p){let m=l;do{if(m.i!==l.i&&m.next.i!==l.i&&m.i!==p.i&&m.next.i!==p.i&&TM(m,m.next,l,p))return!0;m=m.next}while(m!==l);return!1})(c,s)&&(zg(c,s)&&zg(s,c)&&(function(l,p){let m=l,x=!1;const w=(l.x+p.x)/2,C=(l.y+p.y)/2;do m.y>C!=m.next.y>C&&m.next.y!==m.y&&w<(m.next.x-m.x)*(C-m.y)/(m.next.y-m.y)+m.x&&(x=!x),m=m.next;while(m!==l);return x})(c,s)&&(hr(c.prev,c,s.prev)||hr(c,s.prev,s))||Sp(c,s)&&hr(c.prev,c,c.next)>0&&hr(s.prev,s,s.next)>0)}function hr(c,s,l){return(s.y-c.y)*(l.x-s.x)-(s.x-c.x)*(l.y-s.y)}function Sp(c,s){return c.x===s.x&&c.y===s.y}function TM(c,s,l,p){const m=y_(hr(c,s,l)),x=y_(hr(c,s,p)),w=y_(hr(l,p,c)),C=y_(hr(l,p,s));return m!==x&&w!==C||!(m!==0||!g_(c,l,s))||!(x!==0||!g_(c,p,s))||!(w!==0||!g_(l,c,p))||!(C!==0||!g_(l,s,p))}function g_(c,s,l){return s.x<=Math.max(c.x,l.x)&&s.x>=Math.min(c.x,l.x)&&s.y<=Math.max(c.y,l.y)&&s.y>=Math.min(c.y,l.y)}function y_(c){return c>0?1:c<0?-1:0}function zg(c,s){return hr(c.prev,c,c.next)<0?hr(c,s,c.next)>=0&&hr(c,c.prev,s)>=0:hr(c,s,c.prev)<0||hr(c,c.next,s)<0}function CM(c,s){const l=R2(c.i,c.x,c.y),p=R2(s.i,s.x,s.y),m=c.next,x=s.prev;return c.next=s,s.prev=c,l.next=m,m.prev=l,p.next=l,l.prev=p,x.next=p,p.prev=x,p}function EM(c,s,l,p){const m=R2(c,s,l);return p?(m.next=p.next,m.prev=p,p.next.prev=m,p.next=m):(m.prev=m,m.next=m),m}function Og(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function R2(c,s,l){return{i:c,x:s,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Tp{constructor(s,l){if(l>s)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=s,this._minGranularity=l}getGranularityForZoomLevel(s){return Math.max(Math.floor(this._baseZoomGranularity/(1<<s)),this._minGranularity,1)}}class v_{constructor(s){this.fill=s.fill,this.line=s.line,this.tile=s.tile,this.stencil=s.stencil,this.circle=s.circle}}v_.noSubdivision=new v_({fill:new Tp(0,0),line:new Tp(0,0),tile:new Tp(0,0),stencil:new Tp(0,0),circle:1}),mt("SubdivisionGranularityExpression",Tp),mt("SubdivisionGranularitySetting",v_);const Cp=-32768,Rg=32767;class lj{constructor(s,l){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=s,this._granularityCellSize=Ye/s,this._canonical=l}_getKey(s,l){return(s+=32768)<<16|l+32768}_vertexToIndex(s,l){if(s<-32768||l<-32768||s>32767||l>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const p=0|Math.round(s),m=0|Math.round(l),x=this._getKey(p,m);if(this._vertexDictionary.has(x))return this._vertexDictionary.get(x);const w=this._vertexBuffer.length/2;return this._vertexDictionary.set(x,w),this._vertexBuffer.push(p,m),w}_subdivideTrianglesScanline(s){if(this._granularity<2)return(function(m,x){const w=[];for(let C=0;C<x.length;C+=3){const I=x[C],A=x[C+1],D=x[C+2],N=m[2*I],U=m[2*I+1];(m[2*A]-N)*(m[2*D+1]-U)-(m[2*A+1]-U)*(m[2*D]-N)>0?(w.push(I),w.push(D),w.push(A)):(w.push(I),w.push(A),w.push(D))}return w})(this._vertexBuffer,s);const l=[],p=s.length;for(let m=0;m<p;m+=3){const x=[s[m+0],s[m+1],s[m+2]],w=[this._vertexBuffer[2*s[m+0]+0],this._vertexBuffer[2*s[m+0]+1],this._vertexBuffer[2*s[m+1]+0],this._vertexBuffer[2*s[m+1]+1],this._vertexBuffer[2*s[m+2]+0],this._vertexBuffer[2*s[m+2]+1]];let C=1/0,I=1/0,A=-1/0,D=-1/0;for(let X=0;X<3;X++){const Q=w[2*X],ne=w[2*X+1];C=Math.min(C,Q),A=Math.max(A,Q),I=Math.min(I,ne),D=Math.max(D,ne)}if(C===A||I===D)continue;const N=Math.floor(C/this._granularityCellSize),U=Math.ceil(A/this._granularityCellSize),G=Math.floor(I/this._granularityCellSize),q=Math.ceil(D/this._granularityCellSize);if(N!==U||G!==q)for(let X=G;X<q;X++){const Q=this._scanlineGenerateVertexRingForCellRow(X,w,x);cj(this._vertexBuffer,Q,l)}else l.push(...x)}return l}_scanlineGenerateVertexRingForCellRow(s,l,p){const m=s*this._granularityCellSize,x=m+this._granularityCellSize,w=[];for(let C=0;C<3;C++){const I=l[2*C],A=l[2*C+1],D=l[2*(C+1)%6],N=l[(2*(C+1)+1)%6],U=l[2*(C+2)%6],G=l[(2*(C+2)+1)%6],q=D-I,X=N-A,Q=q===0,ne=X===0,ye=(m-A)/X,ue=(x-A)/X,de=Math.min(ye,ue),Me=Math.max(ye,ue);if(!ne&&(de>=1||Me<=0)||ne&&(A<m||A>x)){N>=m&&N<=x&&w.push(p[(C+1)%3]);continue}!ne&&de>0&&w.push(this._vertexToIndex(I+q*de,A+X*de));const Re=I+q*Math.max(de,0),Ze=I+q*Math.min(Me,1);Q||this._generateIntraEdgeVertices(w,I,A,D,N,Re,Ze),!ne&&Me<1&&w.push(this._vertexToIndex(I+q*Me,A+X*Me)),(ne||N>=m&&N<=x)&&w.push(p[(C+1)%3]),!ne&&(N<=m||N>=x)&&this._generateInterEdgeVertices(w,I,A,D,N,U,G,Ze,m,x)}return w}_generateIntraEdgeVertices(s,l,p,m,x,w,C){const I=m-l,A=x-p,D=A===0,N=D?Math.min(l,m):Math.min(w,C),U=D?Math.max(l,m):Math.max(w,C),G=Math.floor(N/this._granularityCellSize)+1,q=Math.ceil(U/this._granularityCellSize)-1;if(D?l<m:w<C)for(let X=G;X<=q;X++){const Q=X*this._granularityCellSize;s.push(this._vertexToIndex(Q,p+A*(Q-l)/I))}else for(let X=q;X>=G;X--){const Q=X*this._granularityCellSize;s.push(this._vertexToIndex(Q,p+A*(Q-l)/I))}}_generateInterEdgeVertices(s,l,p,m,x,w,C,I,A,D){const N=x-p,U=w-m,G=C-x,q=(A-x)/G,X=(D-x)/G,Q=Math.min(q,X),ne=Math.max(q,X),ye=m+U*Q;let ue=Math.floor(Math.min(ye,I)/this._granularityCellSize)+1,de=Math.ceil(Math.max(ye,I)/this._granularityCellSize)-1,Me=I<ye;const Re=G===0;if(Re&&(C===A||C===D))return;if(Re||Q>=1||ne<=0){const ct=p-C,rt=w+(l-w)*Math.min((A-C)/ct,(D-C)/ct);ue=Math.floor(Math.min(rt,I)/this._granularityCellSize)+1,de=Math.ceil(Math.max(rt,I)/this._granularityCellSize)-1,Me=I<rt}const Ze=N>0?D:A;if(Me)for(let ct=ue;ct<=de;ct++)s.push(this._vertexToIndex(ct*this._granularityCellSize,Ze));else for(let ct=de;ct>=ue;ct--)s.push(this._vertexToIndex(ct*this._granularityCellSize,Ze))}_generateOutline(s){const l=[];for(const p of s){const m=Th(p,this._granularity,!0),x=this._pointArrayToIndices(m),w=[];for(let C=1;C<x.length;C++)w.push(x[C-1]),w.push(x[C]);l.push(w)}return l}_handlePoles(s){let l=!1,p=!1;this._canonical&&(this._canonical.y===0&&(l=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(l||p)&&this._fillPoles(s,l,p)}_ensureNoPoleVertices(){const s=this._vertexBuffer;for(let l=0;l<s.length;l+=2){const p=s[l+1];p===Cp&&(s[l+1]=-32767),p===Rg&&(s[l+1]=32766)}}_generatePoleQuad(s,l,p,m,x,w){m>x!=(w===Cp)?(s.push(l),s.push(p),s.push(this._vertexToIndex(m,w)),s.push(p),s.push(this._vertexToIndex(x,w)),s.push(this._vertexToIndex(m,w))):(s.push(p),s.push(l),s.push(this._vertexToIndex(m,w)),s.push(this._vertexToIndex(x,w)),s.push(p),s.push(this._vertexToIndex(m,w)))}_fillPoles(s,l,p){const m=this._vertexBuffer,x=Ye,w=s.length;for(let C=2;C<w;C+=3){const I=s[C-2],A=s[C-1],D=s[C],N=m[2*I],U=m[2*I+1],G=m[2*A],q=m[2*A+1],X=m[2*D],Q=m[2*D+1];l&&(U===0&&q===0&&this._generatePoleQuad(s,I,A,N,G,Cp),q===0&&Q===0&&this._generatePoleQuad(s,A,D,G,X,Cp),Q===0&&U===0&&this._generatePoleQuad(s,D,I,X,N,Cp)),p&&(U===x&&q===x&&this._generatePoleQuad(s,I,A,N,G,Rg),q===x&&Q===x&&this._generatePoleQuad(s,A,D,G,X,Rg),Q===x&&U===x&&this._generatePoleQuad(s,D,I,X,N,Rg))}}_initializeVertices(s){for(let l=0;l<s.length;l+=2)this._vertexToIndex(s[l],s[l+1])}subdividePolygonInternal(s,l){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:p,holeIndices:m}=(function(C){const I=[],A=[];for(const D of C)if(D.length!==0){D!==C[0]&&I.push(A.length/2);for(let N=0;N<D.length;N++)A.push(D[N].x),A.push(D[N].y)}return{flattened:A,holeIndices:I}})(s);let x;this._initializeVertices(p);try{const C=(function(A,D,N=2){const U=D&&D.length,G=U?D[0]*N:A.length;let q=wM(A,0,G,N,!0);const X=[];if(!q||q.next===q.prev)return X;let Q,ne,ye;if(U&&(q=(function(ue,de,Me,Re){const Ze=[];for(let ct=0,rt=de.length;ct<rt;ct++){const at=wM(ue,de[ct]*Re,ct<rt-1?de[ct+1]*Re:ue.length,Re,!1);at===at.next&&(at.steiner=!0),Ze.push(oj(at))}Ze.sort(rj);for(let ct=0;ct<Ze.length;ct++)Me=nj(Ze[ct],Me);return Me})(A,D,q,N)),A.length>80*N){Q=A[0],ne=A[1];let ue=Q,de=ne;for(let Me=N;Me<G;Me+=N){const Re=A[Me],Ze=A[Me+1];Re<Q&&(Q=Re),Ze<ne&&(ne=Ze),Re>ue&&(ue=Re),Ze>de&&(de=Ze)}ye=Math.max(ue-Q,de-ne),ye=ye!==0?32767/ye:0}return Ag(q,X,N,Q,ne,ye,0),X})(p,m),I=this._convertIndices(p,C);x=this._subdivideTrianglesScanline(I)}catch(C){console.error(C)}let w=[];return l&&(w=this._generateOutline(s)),this._ensureNoPoleVertices(),this._handlePoles(x),{verticesFlattened:this._vertexBuffer,indicesTriangles:x,indicesLineList:w}}_convertIndices(s,l){const p=[];for(let m=0;m<l.length;m++)p.push(this._vertexToIndex(s[2*l[m]],s[2*l[m]+1]));return p}_pointArrayToIndices(s){const l=[];for(let p=0;p<s.length;p++){const m=s[p];l.push(this._vertexToIndex(m.x,m.y))}return l}}function IM(c,s,l,p=!0){return new lj(l,s).subdividePolygonInternal(c,p)}function Th(c,s,l=!1){if(!c||c.length<1)return[];if(c.length<2)return[];const p=c[0],m=c[c.length-1],x=l&&(p.x!==m.x||p.y!==m.y);if(s<2)return x?[...c,c[0]]:[...c];const w=Math.floor(Ye/s),C=[];C.push(new v(c[0].x,c[0].y));const I=c.length,A=x?I:I-1;for(let D=0;D<A;D++){const N=c[D],U=D<I-1?c[D+1]:c[0],G=N.x,q=N.y,X=U.x,Q=U.y,ne=G!==X,ye=q!==Q;if(!ne&&!ye)continue;const ue=X-G,de=Q-q,Me=Math.abs(ue),Re=Math.abs(de);let Ze=G,ct=q;for(;;){const at=ue>0?(Math.floor(Ze/w)+1)*w:(Math.ceil(Ze/w)-1)*w,It=de>0?(Math.floor(ct/w)+1)*w:(Math.ceil(ct/w)-1)*w,ot=Math.abs(Ze-at),lt=Math.abs(ct-It),je=Math.abs(Ze-X),At=Math.abs(ct-Q),zt=ne?ot/Me:Number.POSITIVE_INFINITY,Pt=ye?lt/Re:Number.POSITIVE_INFINITY;if((je<=ot||!ne)&&(At<=lt||!ye))break;if(zt<Pt&&ne||!ye){Ze=at,ct+=de*zt;const wt=new v(Ze,Math.round(ct));C[C.length-1].x===wt.x&&C[C.length-1].y===wt.y||C.push(wt)}else{Ze+=ue*Pt,ct=It;const wt=new v(Math.round(Ze),ct);C[C.length-1].x===wt.x&&C[C.length-1].y===wt.y||C.push(wt)}}const rt=new v(X,Q);C[C.length-1].x===rt.x&&C[C.length-1].y===rt.y||C.push(rt)}return C}function cj(c,s,l){if(s.length===0)throw new Error("Subdivision vertex ring is empty.");let p=0,m=c[2*s[0]];for(let I=1;I<s.length;I++){const A=c[2*s[I]];A<m&&(m=A,p=I)}const x=s.length;let w=p,C=(w+1)%x;for(;;){const I=w-1>=0?w-1:x-1,A=(C+1)%x,D=c[2*s[I]],N=c[2*s[A]],U=c[2*s[w]],G=c[2*s[w]+1],q=c[2*s[C]+1];let X=!1;if(D<N)X=!0;else if(D>N)X=!1;else{const Q=q-G,ne=-(c[2*s[C]]-U),ye=G<q?1:-1;((D-U)*Q+(c[2*s[I]+1]-G)*ne)*ye>((N-U)*Q+(c[2*s[A]+1]-G)*ne)*ye&&(X=!0)}if(X){const Q=s[I],ne=s[w],ye=s[C];Q!==ne&&Q!==ye&&ne!==ye&&l.push(ye,ne,Q),w--,w<0&&(w=x-1)}else{const Q=s[A],ne=s[w],ye=s[C];Q!==ne&&Q!==ye&&ne!==ye&&l.push(ye,ne,Q),C++,C>=x&&(C=0)}if(I===A)break}}function $M(c,s,l,p,m,x,w,C,I){const A=m.length/2,D=w&&C&&I;if(A<Ut.MAX_VERTEX_ARRAY_LENGTH){const N=s.prepareSegment(A,l,p),U=N.vertexLength;for(let X=0;X<x.length;X+=3)p.emplaceBack(U+x[X],U+x[X+1],U+x[X+2]);let G,q;N.vertexLength+=A,N.primitiveLength+=x.length/3,D&&(q=w.prepareSegment(A,l,C),G=q.vertexLength,q.vertexLength+=A);for(let X=0;X<m.length;X+=2)c(m[X],m[X+1]);if(D)for(let X=0;X<I.length;X++){const Q=I[X];for(let ne=1;ne<Q.length;ne+=2)C.emplaceBack(G+Q[ne-1],G+Q[ne]);q.primitiveLength+=Q.length/2}}else(function(N,U,G,q,X,Q){const ne=[];for(let Re=0;Re<q.length/2;Re++)ne.push(-1);const ye={count:0};let ue=0,de=N.getOrCreateLatestSegment(U,G),Me=de.vertexLength;for(let Re=2;Re<X.length;Re+=3){const Ze=X[Re-2],ct=X[Re-1],rt=X[Re];let at=ne[Ze]<ue,It=ne[ct]<ue,ot=ne[rt]<ue;de.vertexLength+((at?1:0)+(It?1:0)+(ot?1:0))>Ut.MAX_VERTEX_ARRAY_LENGTH&&(de=N.createNewSegment(U,G),ue=ye.count,at=!0,It=!0,ot=!0,Me=0);const lt=Lg(ne,q,Q,ye,Ze,at,de),je=Lg(ne,q,Q,ye,ct,It,de),At=Lg(ne,q,Q,ye,rt,ot,de);G.emplaceBack(Me+lt-ue,Me+je-ue,Me+At-ue),de.primitiveLength++}})(s,l,p,m,x,c),D&&(function(N,U,G,q,X,Q){const ne=[];for(let Re=0;Re<q.length/2;Re++)ne.push(-1);const ye={count:0};let ue=0,de=N.getOrCreateLatestSegment(U,G),Me=de.vertexLength;for(let Re=0;Re<X.length;Re++){const Ze=X[Re];for(let ct=1;ct<X[Re].length;ct+=2){const rt=Ze[ct-1],at=Ze[ct];let It=ne[rt]<ue,ot=ne[at]<ue;de.vertexLength+((It?1:0)+(ot?1:0))>Ut.MAX_VERTEX_ARRAY_LENGTH&&(de=N.createNewSegment(U,G),ue=ye.count,It=!0,ot=!0,Me=0);const lt=Lg(ne,q,Q,ye,rt,It,de),je=Lg(ne,q,Q,ye,at,ot,de);G.emplaceBack(Me+lt-ue,Me+je-ue),de.primitiveLength++}}})(w,l,C,m,I,c),s.forceNewSegmentOnNextPrepare(),w?.forceNewSegmentOnNextPrepare()}function Lg(c,s,l,p,m,x,w){if(x){const C=p.count;return l(s[2*m],s[2*m+1]),c[m]=p.count,p.count++,w.vertexLength++,C}return c[m]}class L2{constructor(s){this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((l=>l.id)),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Oe,this.indexArray=new Ci,this.indexArray2=new wi,this.programConfigurations=new ns(s.layers,s.zoom),this.segments=new Ut,this.segments2=new Ut,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id))}populate(s,l,p){this.hasPattern=D2("fill",this.layers,l);const m=this.layers[0].layout.get("fill-sort-key"),x=!m.isConstant(),w=[];for(const{feature:C,id:I,index:A,sourceLayerIndex:D}of s){const N=this.layers[0]._featureFilter.needGeometry,U=Qo(C,N);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom,{globalState:this.globalState}),U,p))continue;const G=x?m.evaluate(U,{},p,l.availableImages):void 0,q={id:I,properties:C.properties,type:C.type,sourceLayerIndex:D,index:A,geometry:N?U.geometry:Xa(C),patterns:{},sortKey:G};w.push(q)}x&&w.sort(((C,I)=>C.sortKey-I.sortKey));for(const C of w){const{geometry:I,index:A,sourceLayerIndex:D}=C;if(this.hasPattern){const N=z2("fill",this.layers,C,{zoom:this.zoom,globalState:this.globalState},l);this.patternFeatures.push(N)}else this.addFeature(C,I,A,p,{},l.subdivisionGranularity);l.featureIndex.insert(s[A].feature,I,A,D,this.index)}}update(s,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,{imagePositions:p,globalState:this.globalState})}addFeatures(s,l,p){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,p,s.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,K8),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,l,p,m,x,w){for(const C of ah(l,500)){const I=IM(C,m,w.fill.getGranularityForZoomLevel(m.z)),A=this.layoutVertexArray;$M(((D,N)=>{A.emplaceBack(D,N)}),this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles,this.segments2,this.indexArray2,I.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{imagePositions:x,canonical:m,globalState:this.globalState})}}let PM,MM;mt("FillBucket",L2,{omit:["layers","patternFeatures"]});var uj={get paint(){return MM=MM||new En({"fill-antialias":new Tt(Te.paint_fill["fill-antialias"]),"fill-opacity":new Mt(Te.paint_fill["fill-opacity"]),"fill-color":new Mt(Te.paint_fill["fill-color"]),"fill-outline-color":new Mt(Te.paint_fill["fill-outline-color"]),"fill-translate":new Tt(Te.paint_fill["fill-translate"]),"fill-translate-anchor":new Tt(Te.paint_fill["fill-translate-anchor"]),"fill-pattern":new mp(Te.paint_fill["fill-pattern"])})},get layout(){return PM=PM||new En({"fill-sort-key":new Mt(Te.layout_fill["fill-sort-key"])})}};class hj extends bs{constructor(s){super(s,uj)}recalculate(s,l){super.recalculate(s,l);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new L2(s)}queryRadius(){return f_(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:s,geometry:l,transform:p,pixelsToTileUnits:m}){return lM(m_(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-p.bearingInRadians,m),l)}isTileClipped(){return!0}}const dj=rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),pj=rr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:fj}=dj;class Ep{constructor(s,l,p,m,x){this.properties={},this.extent=p,this.type=0,this.id=void 0,this._pbf=s,this._geometry=-1,this._keys=m,this._values=x,s.readFields(mj,this,l)}loadGeometry(){const s=this._pbf;s.pos=this._geometry;const l=s.readVarint()+s.pos,p=[];let m,x=1,w=0,C=0,I=0;for(;s.pos<l;){if(w<=0){const A=s.readVarint();x=7&A,w=A>>3}if(w--,x===1||x===2)C+=s.readSVarint(),I+=s.readSVarint(),x===1&&(m&&p.push(m),m=[]),m&&m.push(new v(C,I));else{if(x!==7)throw new Error(`unknown command ${x}`);m&&m.push(m[0].clone())}}return m&&p.push(m),p}bbox(){const s=this._pbf;s.pos=this._geometry;const l=s.readVarint()+s.pos;let p=1,m=0,x=0,w=0,C=1/0,I=-1/0,A=1/0,D=-1/0;for(;s.pos<l;){if(m<=0){const N=s.readVarint();p=7&N,m=N>>3}if(m--,p===1||p===2)x+=s.readSVarint(),w+=s.readSVarint(),x<C&&(C=x),x>I&&(I=x),w<A&&(A=w),w>D&&(D=w);else if(p!==7)throw new Error(`unknown command ${p}`)}return[C,A,I,D]}toGeoJSON(s,l,p){const m=this.extent*Math.pow(2,p),x=this.extent*s,w=this.extent*l,C=this.loadGeometry();function I(U){return[360*(U.x+x)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(U.y+w)/m)*Math.PI))-90]}function A(U){return U.map(I)}let D;if(this.type===1){const U=[];for(const q of C)U.push(q[0]);const G=A(U);D=U.length===1?{type:"Point",coordinates:G[0]}:{type:"MultiPoint",coordinates:G}}else if(this.type===2){const U=C.map(A);D=U.length===1?{type:"LineString",coordinates:U[0]}:{type:"MultiLineString",coordinates:U}}else{if(this.type!==3)throw new Error("unknown feature type");{const U=(function(q){const X=q.length;if(X<=1)return[q];const Q=[];let ne,ye;for(let ue=0;ue<X;ue++){const de=gj(q[ue]);de!==0&&(ye===void 0&&(ye=de<0),ye===de<0?(ne&&Q.push(ne),ne=[q[ue]]):ne&&ne.push(q[ue]))}return ne&&Q.push(ne),Q})(C),G=[];for(const q of U)G.push(q.map(A));D=G.length===1?{type:"Polygon",coordinates:G[0]}:{type:"MultiPolygon",coordinates:G}}}const N={type:"Feature",geometry:D,properties:this.properties};return this.id!=null&&(N.id=this.id),N}}function mj(c,s,l){c===1?s.id=l.readVarint():c===2?(function(p,m){const x=p.readVarint()+p.pos;for(;p.pos<x;){const w=m._keys[p.readVarint()],C=m._values[p.readVarint()];m.properties[w]=C}})(l,s):c===3?s.type=l.readVarint():c===4&&(s._geometry=l.pos)}function gj(c){let s=0;for(let l,p,m=0,x=c.length,w=x-1;m<x;w=m++)l=c[m],p=c[w],s+=(p.x-l.x)*(l.y+p.y);return s}Ep.types=["Unknown","Point","LineString","Polygon"];class kM{constructor(s,l){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(yj,this,l),this.length=this._features.length}feature(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];const l=this._pbf.readVarint()+this._pbf.pos;return new Ep(this._pbf,l,this.extent,this._keys,this._values)}}function yj(c,s,l){c===15?s.version=l.readVarint():c===1?s.name=l.readString():c===5?s.extent=l.readVarint():c===2?s._features.push(l.pos):c===3?s._keys.push(l.readString()):c===4&&s._values.push((function(p){let m=null;const x=p.readVarint()+p.pos;for(;p.pos<x;){const w=p.readVarint()>>3;m=w===1?p.readString():w===2?p.readFloat():w===3?p.readDouble():w===4?p.readVarint64():w===5?p.readVarint():w===6?p.readSVarint():w===7?p.readBoolean():null}if(m==null)throw new Error("unknown feature value");return m})(l))}class AM{constructor(s,l){this.layers=s.readFields(vj,{},l)}}function vj(c,s,l){if(c===3){const p=new kM(l,l.readVarint()+l.pos);p.length&&(s[p.name]=p)}}const F2=Math.pow(2,13);function Fg(c,s,l,p,m,x,w,C){c.emplaceBack(s,l,2*Math.floor(p*F2)+w,m*F2*2,x*F2*2,Math.round(C))}class N2{constructor(s){this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((l=>l.id)),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Ee,this.centroidVertexArray=new ae,this.indexArray=new Ci,this.programConfigurations=new ns(s.layers,s.zoom),this.segments=new Ut,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id))}populate(s,l,p){this.features=[],this.hasPattern=D2("fill-extrusion",this.layers,l);for(const{feature:m,id:x,index:w,sourceLayerIndex:C}of s){const I=this.layers[0]._featureFilter.needGeometry,A=Qo(m,I);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom,{globalState:this.globalState}),A,p))continue;const D={id:x,sourceLayerIndex:C,index:w,geometry:I?A.geometry:Xa(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(z2("fill-extrusion",this.layers,D,{zoom:this.zoom,globalState:this.globalState},l)):this.addFeature(D,D.geometry,w,p,{},l.subdivisionGranularity),l.featureIndex.insert(m,D.geometry,w,C,this.index,!0)}}addFeatures(s,l,p){for(const m of this.features){const{geometry:x}=m;this.addFeature(m,x,m.index,l,p,s.subdivisionGranularity)}}update(s,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,{imagePositions:p,globalState:this.globalState})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,fj),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,pj.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,l,p,m,x,w){for(const C of ah(l,500)){const I={x:0,y:0,sampleCount:0},A=this.layoutVertexArray.length;this.processPolygon(I,m,s,C,w);const D=this.layoutVertexArray.length-A,N=Math.floor(I.x/I.sampleCount),U=Math.floor(I.y/I.sampleCount);for(let G=0;G<D;G++)this.centroidVertexArray.emplaceBack(N,U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{imagePositions:x,canonical:m,globalState:this.globalState})}processPolygon(s,l,p,m,x){if(m.length<1||DM(m[0]))return;for(const N of m)N.length!==0&&_j(s,N);const w={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},C=x.fill.getGranularityForZoomLevel(l.z),I=Ep.types[p.type]==="Polygon";for(const N of m){if(N.length===0||DM(N))continue;const U=Th(N,C,I);this._generateSideFaces(U,w)}if(!I)return;const A=IM(m,l,C,!1),D=this.layoutVertexArray;$M(((N,U)=>{Fg(D,N,U,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,A.verticesFlattened,A.indicesTriangles)}_generateSideFaces(s,l){let p=0;for(let m=1;m<s.length;m++){const x=s[m],w=s[m-1];if(bj(x,w))continue;l.segment.vertexLength+4>Ut.MAX_VERTEX_ARRAY_LENGTH&&(l.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const C=x.sub(w)._perp()._unit(),I=w.dist(x);p+I>32768&&(p=0),Fg(this.layoutVertexArray,x.x,x.y,C.x,C.y,0,0,p),Fg(this.layoutVertexArray,x.x,x.y,C.x,C.y,0,1,p),p+=I,Fg(this.layoutVertexArray,w.x,w.y,C.x,C.y,0,0,p),Fg(this.layoutVertexArray,w.x,w.y,C.x,C.y,0,1,p);const A=l.segment.vertexLength;this.indexArray.emplaceBack(A,A+2,A+1),this.indexArray.emplaceBack(A+1,A+2,A+3),l.segment.vertexLength+=4,l.segment.primitiveLength+=2}}}function _j(c,s){for(let l=0;l<s.length;l++){const p=s[l];l===s.length-1&&s[0].x===p.x&&s[0].y===p.y||(c.x+=p.x,c.y+=p.y,c.sampleCount++)}}function bj(c,s){return c.x===s.x&&(c.x<0||c.x>Ye)||c.y===s.y&&(c.y<0||c.y>Ye)}function DM(c){return c.every((s=>s.x<0))||c.every((s=>s.x>Ye))||c.every((s=>s.y<0))||c.every((s=>s.y>Ye))}let zM;mt("FillExtrusionBucket",N2,{omit:["layers","features"]});var xj={get paint(){return zM=zM||new En({"fill-extrusion-opacity":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Mt(Te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new mp(Te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Mt(Te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Mt(Te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tt(Te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class wj extends bs{constructor(s){super(s,xj)}createBucket(s){return new N2(s)}queryRadius(){return f_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:s,feature:l,featureState:p,geometry:m,transform:x,pixelsToTileUnits:w,pixelPosMatrix:C}){const I=m_(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-x.bearingInRadians,w),A=this.paint.get("fill-extrusion-height").evaluate(l,p),D=this.paint.get("fill-extrusion-base").evaluate(l,p),N=(function(G,q){const X=[];for(const Q of G){const ne=[Q.x,Q.y,0,1];De(ne,ne,q),X.push(new v(ne[0]/ne[3],ne[1]/ne[3]))}return X})(I,C),U=(function(G,q,X,Q){const ne=[],ye=[],ue=Q[8]*q,de=Q[9]*q,Me=Q[10]*q,Re=Q[11]*q,Ze=Q[8]*X,ct=Q[9]*X,rt=Q[10]*X,at=Q[11]*X;for(const It of G){const ot=[],lt=[];for(const je of It){const At=je.x,zt=je.y,Pt=Q[0]*At+Q[4]*zt+Q[12],wt=Q[1]*At+Q[5]*zt+Q[13],si=Q[2]*At+Q[6]*zt+Q[14],Ji=Q[3]*At+Q[7]*zt+Q[15],zr=si+Me,yn=Ji+Re,Js=Pt+Ze,os=wt+ct,ln=si+rt,Zi=Ji+at,Wr=new v((Pt+ue)/yn,(wt+de)/yn);Wr.z=zr/yn,ot.push(Wr);const cn=new v(Js/Zi,os/Zi);cn.z=ln/Zi,lt.push(cn)}ne.push(ot),ye.push(lt)}return[ne,ye]})(m,D,A,C);return(function(G,q,X){let Q=1/0;lM(X,q)&&(Q=OM(X,q[0]));for(let ne=0;ne<q.length;ne++){const ye=q[ne],ue=G[ne];for(let de=0;de<ye.length-1;de++){const Me=ye[de],Re=[Me,ye[de+1],ue[de+1],ue[de],Me];aM(X,Re)&&(Q=Math.min(Q,OM(X,Re)))}}return Q!==1/0&&Q})(U[0],U[1],N)}}function Ng(c,s){return c.x*s.x+c.y*s.y}function OM(c,s){if(c.length===1){let l=0;const p=s[l++];let m;for(;!m||p.equals(m);)if(m=s[l++],!m)return 1/0;for(;l<s.length;l++){const x=s[l],w=c[0],C=m.sub(p),I=x.sub(p),A=w.sub(p),D=Ng(C,C),N=Ng(C,I),U=Ng(I,I),G=Ng(A,C),q=Ng(A,I),X=D*U-N*N,Q=(U*G-N*q)/X,ne=(D*q-N*G)/X,ye=p.z*(1-Q-ne)+m.z*Q+x.z*ne;if(isFinite(ye))return ye}return 1/0}{let l=1/0;for(const p of s)l=Math.min(l,p.z);return l}}const Sj=rr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Tj}=Sj,Cj=rr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ej}=Cj,Ij=Math.cos(Math.PI/180*37.5),RM=Math.pow(2,14)/.5;class B2{constructor(s){this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((l=>l.id)),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((l=>{this.gradients[l.id]={}})),this.layoutVertexArray=new $e,this.layoutVertexArray2=new ze,this.indexArray=new Ci,this.programConfigurations=new ns(s.layers,s.zoom),this.segments=new Ut,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((l=>l.isStateDependent())).map((l=>l.id))}populate(s,l,p){this.hasPattern=D2("line",this.layers,l);const m=this.layers[0].layout.get("line-sort-key"),x=!m.isConstant(),w=[];for(const{feature:C,id:I,index:A,sourceLayerIndex:D}of s){const N=this.layers[0]._featureFilter.needGeometry,U=Qo(C,N);if(!this.layers[0]._featureFilter.filter(new ki(this.zoom,{globalState:this.globalState}),U,p))continue;const G=x?m.evaluate(U,{},p):void 0,q={id:I,properties:C.properties,type:C.type,sourceLayerIndex:D,index:A,geometry:N?U.geometry:Xa(C),patterns:{},sortKey:G};w.push(q)}x&&w.sort(((C,I)=>C.sortKey-I.sortKey));for(const C of w){const{geometry:I,index:A,sourceLayerIndex:D}=C;if(this.hasPattern){const N=z2("line",this.layers,C,{zoom:this.zoom,globalState:this.globalState},l);this.patternFeatures.push(N)}else this.addFeature(C,I,A,p,{},l.subdivisionGranularity);l.featureIndex.insert(s[A].feature,I,A,D,this.index)}}update(s,l,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,l,this.stateDependentLayers,{imagePositions:p,globalState:this.globalState})}addFeatures(s,l,p){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,p,s.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Ej)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Tj),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,l,p,m,x,w){const C=this.layers[0].layout,I=C.get("line-join").evaluate(s,{}),A=C.get("line-cap"),D=C.get("line-miter-limit"),N=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const U of l)this.addLine(U,s,I,A,D,N,m,w);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{imagePositions:x,canonical:m,globalState:this.globalState})}addLine(s,l,p,m,x,w,C,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,s=Th(s,C?I.line.getGranularityForZoomLevel(C.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<s.length-1;ue++)this.totalDistance+=s[ue].dist(s[ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const A=Ep.types[l.type]==="Polygon";let D=s.length;for(;D>=2&&s[D-1].equals(s[D-2]);)D--;let N=0;for(;N<D-1&&s[N].equals(s[N+1]);)N++;if(D<(A?3:2))return;p==="bevel"&&(x=1.05);const U=this.overscaling<=16?122880/(512*this.overscaling):0,G=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let q,X,Q,ne,ye;this.e1=this.e2=-1,A&&(q=s[D-2],ye=s[N].sub(q)._unit()._perp());for(let ue=N;ue<D;ue++){if(Q=ue===D-1?A?s[N+1]:void 0:s[ue+1],Q&&s[ue].equals(Q))continue;ye&&(ne=ye),q&&(X=q),q=s[ue],ye=Q?Q.sub(q)._unit()._perp():ne,ne=ne||ye;let de=ne.add(ye);de.x===0&&de.y===0||de._unit();const Me=ne.x*ye.x+ne.y*ye.y,Re=de.x*ye.x+de.y*ye.y,Ze=Re!==0?1/Re:1/0,ct=2*Math.sqrt(2-2*Re),rt=Re<Ij&&X&&Q,at=ne.x*ye.y-ne.y*ye.x>0;if(rt&&ue>N){const lt=q.dist(X);if(lt>2*U){const je=q.sub(q.sub(X)._mult(U/lt)._round());this.updateDistance(X,je),this.addCurrentVertex(je,ne,0,0,G),X=je}}const It=X&&Q;let ot=It?p:A?"butt":m;if(It&&ot==="round"&&(Ze<w?ot="miter":Ze<=2&&(ot="fakeround")),ot==="miter"&&Ze>x&&(ot="bevel"),ot==="bevel"&&(Ze>2&&(ot="flipbevel"),Ze<x&&(ot="miter")),X&&this.updateDistance(X,q),ot==="miter")de._mult(Ze),this.addCurrentVertex(q,de,0,0,G);else if(ot==="flipbevel"){if(Ze>100)de=ye.mult(-1);else{const lt=Ze*ne.add(ye).mag()/ne.sub(ye).mag();de._perp()._mult(lt*(at?-1:1))}this.addCurrentVertex(q,de,0,0,G),this.addCurrentVertex(q,de.mult(-1),0,0,G)}else if(ot==="bevel"||ot==="fakeround"){const lt=-Math.sqrt(Ze*Ze-1),je=at?lt:0,At=at?0:lt;if(X&&this.addCurrentVertex(q,ne,je,At,G),ot==="fakeround"){const zt=Math.round(180*ct/Math.PI/20);for(let Pt=1;Pt<zt;Pt++){let wt=Pt/zt;if(wt!==.5){const Ji=wt-.5;wt+=wt*Ji*(wt-1)*((1.0904+Me*(Me*(3.55645-1.43519*Me)-3.2452))*Ji*Ji+(.848013+Me*(.215638*Me-1.06021)))}const si=ye.sub(ne)._mult(wt)._add(ne)._unit()._mult(at?-1:1);this.addHalfVertex(q,si.x,si.y,!1,at,0,G)}}Q&&this.addCurrentVertex(q,ye,-je,-At,G)}else if(ot==="butt")this.addCurrentVertex(q,de,0,0,G);else if(ot==="square"){const lt=X?1:-1;this.addCurrentVertex(q,de,lt,lt,G)}else ot==="round"&&(X&&(this.addCurrentVertex(q,ne,0,0,G),this.addCurrentVertex(q,ne,1,1,G,!0)),Q&&(this.addCurrentVertex(q,ye,-1,-1,G,!0),this.addCurrentVertex(q,ye,0,0,G)));if(rt&&ue<D-1){const lt=q.dist(Q);if(lt>2*U){const je=q.add(Q.sub(q)._mult(U/lt)._round());this.updateDistance(q,je),this.addCurrentVertex(je,ye,0,0,G),q=je}}}}addCurrentVertex(s,l,p,m,x,w=!1){const C=l.y*m-l.x,I=-l.y-l.x*m;this.addHalfVertex(s,l.x+l.y*p,l.y-l.x*p,w,!1,p,x),this.addHalfVertex(s,C,I,w,!0,-m,x),this.distance>RM/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,l,p,m,x,w))}addHalfVertex({x:s,y:l},p,m,x,w,C,I){const A=.5*(this.lineClips?this.scaledDistance*(RM-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(x?1:0),(l<<1)+(w?1:0),Math.round(63*p)+128,Math.round(63*m)+128,1+(C===0?0:C<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),I.primitiveLength++),w?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,l){this.distance+=s.dist(l),this.updateScaledDistance()}}let LM,FM;mt("LineBucket",B2,{omit:["layers","patternFeatures"]});var NM={get paint(){return FM=FM||new En({"line-opacity":new Mt(Te.paint_line["line-opacity"]),"line-color":new Mt(Te.paint_line["line-color"]),"line-translate":new Tt(Te.paint_line["line-translate"]),"line-translate-anchor":new Tt(Te.paint_line["line-translate-anchor"]),"line-width":new Mt(Te.paint_line["line-width"]),"line-gap-width":new Mt(Te.paint_line["line-gap-width"]),"line-offset":new Mt(Te.paint_line["line-offset"]),"line-blur":new Mt(Te.paint_line["line-blur"]),"line-dasharray":new qa(Te.paint_line["line-dasharray"]),"line-pattern":new mp(Te.paint_line["line-pattern"]),"line-gradient":new gp(Te.paint_line["line-gradient"])})},get layout(){return LM=LM||new En({"line-cap":new Tt(Te.layout_line["line-cap"]),"line-join":new Mt(Te.layout_line["line-join"]),"line-miter-limit":new Tt(Te.layout_line["line-miter-limit"]),"line-round-limit":new Tt(Te.layout_line["line-round-limit"]),"line-sort-key":new Mt(Te.layout_line["line-sort-key"])})}};class $j extends Mt{possiblyEvaluate(s,l){return l=new ki(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(s,l)}evaluate(s,l,p,m){return l=dn({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(s,l,p,m)}}let __;class Pj extends bs{constructor(s){super(s,NM),this.gradientVersion=0,__||(__=new $j(NM.paint.properties["line-width"].specification),__.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const l=this.gradientExpression();this.stepInterpolant=!!(function(p){return p._styleExpression!==void 0})(l)&&l._styleExpression.expression instanceof ir,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,l){super.recalculate(s,l),this.paint._values["line-floorwidth"]=__.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new B2(s)}queryRadius(s){const l=s,p=BM(Mg("line-width",this,l),Mg("line-gap-width",this,l)),m=Mg("line-offset",this,l);return p/2+Math.abs(m)+f_(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:s,feature:l,featureState:p,geometry:m,transform:x,pixelsToTileUnits:w}){const C=m_(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-x.bearingInRadians,w),I=w/2*BM(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),A=this.paint.get("line-offset").evaluate(l,p);return A&&(m=(function(D,N){const U=[];for(let G=0;G<D.length;G++){const q=D[G],X=[];for(let Q=0;Q<q.length;Q++){const ne=q[Q-1],ye=q[Q],ue=q[Q+1],de=Q===0?new v(0,0):ye.sub(ne)._unit()._perp(),Me=Q===q.length-1?new v(0,0):ue.sub(ye)._unit()._perp(),Re=de._add(Me)._unit(),Ze=Re.x*Me.x+Re.y*Me.y;Ze!==0&&Re._mult(1/Ze),X.push(Re._mult(N)._add(ye))}U.push(X)}return U})(m,A*w)),(function(D,N,U){for(let G=0;G<N.length;G++){const q=N[G];if(D.length>=3){for(let X=0;X<q.length;X++)if(wp(D,q[X]))return!0}if(B8(D,q,U))return!0}return!1})(C,m,I)}isTileClipped(){return!0}}function BM(c,s){return s>0?s+2*c:c}const Mj=rr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),kj=rr([{name:"a_projected_pos",components:3,type:"Float32"}],4);rr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Aj=rr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);rr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const jM=rr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Dj=rr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zj(c,s,l){return c.sections.forEach((p=>{p.text=(function(m,x,w){const C=x.layout.get("text-transform").evaluate(w,{});return C==="uppercase"?m=m.toLocaleUpperCase():C==="lowercase"&&(m=m.toLocaleLowerCase()),Hs.applyArabicShaping&&(m=Hs.applyArabicShaping(m)),m})(p.text,s,l)})),c}rr([{name:"triangle",components:3,type:"Uint16"}]),rr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),rr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),rr([{type:"Float32",name:"offsetX"}]),rr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),rr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Bg={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Zr=24;const j2=4294967296,UM=1/j2,VM=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class U2{constructor(s=new Uint8Array(16)){this.buf=ArrayBuffer.isView(s)?s:new Uint8Array(s),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(s,l,p=this.length){for(;this.pos<p;){const m=this.readVarint(),x=m>>3,w=this.pos;this.type=7&m,s(x,l,this),this.pos===w&&this.skip(m)}return l}readMessage(s,l){return this.readFields(s,l,this.readVarint()+this.pos)}readFixed32(){const s=this.dataView.getUint32(this.pos,!0);return this.pos+=4,s}readSFixed32(){const s=this.dataView.getInt32(this.pos,!0);return this.pos+=4,s}readFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*j2;return this.pos+=8,s}readSFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*j2;return this.pos+=8,s}readFloat(){const s=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,s}readDouble(){const s=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,s}readVarint(s){const l=this.buf;let p,m;return m=l[this.pos++],p=127&m,m<128?p:(m=l[this.pos++],p|=(127&m)<<7,m<128?p:(m=l[this.pos++],p|=(127&m)<<14,m<128?p:(m=l[this.pos++],p|=(127&m)<<21,m<128?p:(m=l[this.pos],p|=(15&m)<<28,(function(x,w,C){const I=C.buf;let A,D;if(D=I[C.pos++],A=(112&D)>>4,D<128||(D=I[C.pos++],A|=(127&D)<<3,D<128)||(D=I[C.pos++],A|=(127&D)<<10,D<128)||(D=I[C.pos++],A|=(127&D)<<17,D<128)||(D=I[C.pos++],A|=(127&D)<<24,D<128)||(D=I[C.pos++],A|=(1&D)<<31,D<128))return Ip(x,A,w);throw new Error("Expected varint not more than 10 bytes")})(p,s,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const s=this.readVarint();return s%2==1?(s+1)/-2:s/2}readBoolean(){return!!this.readVarint()}readString(){const s=this.readVarint()+this.pos,l=this.pos;return this.pos=s,s-l>=12&&VM?VM.decode(this.buf.subarray(l,s)):(function(p,m,x){let w="",C=m;for(;C<x;){const I=p[C];let A,D,N,U=null,G=I>239?4:I>223?3:I>191?2:1;if(C+G>x)break;G===1?I<128&&(U=I):G===2?(A=p[C+1],(192&A)==128&&(U=(31&I)<<6|63&A,U<=127&&(U=null))):G===3?(A=p[C+1],D=p[C+2],(192&A)==128&&(192&D)==128&&(U=(15&I)<<12|(63&A)<<6|63&D,(U<=2047||U>=55296&&U<=57343)&&(U=null))):G===4&&(A=p[C+1],D=p[C+2],N=p[C+3],(192&A)==128&&(192&D)==128&&(192&N)==128&&(U=(15&I)<<18|(63&A)<<12|(63&D)<<6|63&N,(U<=65535||U>=1114112)&&(U=null))),U===null?(U=65533,G=1):U>65535&&(U-=65536,w+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),w+=String.fromCharCode(U),C+=G}return w})(this.buf,l,s)}readBytes(){const s=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,s);return this.pos=s,l}readPackedVarint(s=[],l){const p=this.readPackedEnd();for(;this.pos<p;)s.push(this.readVarint(l));return s}readPackedSVarint(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readSVarint());return s}readPackedBoolean(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readBoolean());return s}readPackedFloat(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readFloat());return s}readPackedDouble(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readDouble());return s}readPackedFixed32(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readFixed32());return s}readPackedSFixed32(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readSFixed32());return s}readPackedFixed64(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readFixed64());return s}readPackedSFixed64(s=[]){const l=this.readPackedEnd();for(;this.pos<l;)s.push(this.readSFixed64());return s}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(s){const l=7&s;if(l===0)for(;this.buf[this.pos++]>127;);else if(l===2)this.pos=this.readVarint()+this.pos;else if(l===5)this.pos+=4;else{if(l!==1)throw new Error(`Unimplemented type: ${l}`);this.pos+=8}}writeTag(s,l){this.writeVarint(s<<3|l)}realloc(s){let l=this.length||16;for(;l<this.pos+s;)l*=2;if(l!==this.length){const p=new Uint8Array(l);p.set(this.buf),this.buf=p,this.dataView=new DataView(p.buffer),this.length=l}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeSFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*UM),!0),this.pos+=8}writeSFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*UM),!0),this.pos+=8}writeVarint(s){(s=+s||0)>268435455||s<0?(function(l,p){let m,x;if(l>=0?(m=l%4294967296|0,x=l/4294967296|0):(m=~(-l%4294967296),x=~(-l/4294967296),4294967295^m?m=m+1|0:(m=0,x=x+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),(function(w,C,I){I.buf[I.pos++]=127&w|128,w>>>=7,I.buf[I.pos++]=127&w|128,w>>>=7,I.buf[I.pos++]=127&w|128,w>>>=7,I.buf[I.pos++]=127&w|128,I.buf[I.pos]=127&(w>>>=7)})(m,0,p),(function(w,C){const I=(7&w)<<4;C.buf[C.pos++]|=I|((w>>>=3)?128:0),w&&(C.buf[C.pos++]=127&w|((w>>>=7)?128:0),w&&(C.buf[C.pos++]=127&w|((w>>>=7)?128:0),w&&(C.buf[C.pos++]=127&w|((w>>>=7)?128:0),w&&(C.buf[C.pos++]=127&w|((w>>>=7)?128:0),w&&(C.buf[C.pos++]=127&w)))))})(x,p)})(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))}writeSVarint(s){this.writeVarint(s<0?2*-s-1:2*s)}writeBoolean(s){this.writeVarint(+s)}writeString(s){s=String(s),this.realloc(4*s.length),this.pos++;const l=this.pos;this.pos=(function(m,x,w){for(let C,I,A=0;A<x.length;A++){if(C=x.charCodeAt(A),C>55295&&C<57344){if(!I){C>56319||A+1===x.length?(m[w++]=239,m[w++]=191,m[w++]=189):I=C;continue}if(C<56320){m[w++]=239,m[w++]=191,m[w++]=189,I=C;continue}C=I-55296<<10|C-56320|65536,I=null}else I&&(m[w++]=239,m[w++]=191,m[w++]=189,I=null);C<128?m[w++]=C:(C<2048?m[w++]=C>>6|192:(C<65536?m[w++]=C>>12|224:(m[w++]=C>>18|240,m[w++]=C>>12&63|128),m[w++]=C>>6&63|128),m[w++]=63&C|128)}return w})(this.buf,s,this.pos);const p=this.pos-l;p>=128&&GM(l,p,this),this.pos=l-1,this.writeVarint(p),this.pos+=p}writeFloat(s){this.realloc(4),this.dataView.setFloat32(this.pos,s,!0),this.pos+=4}writeDouble(s){this.realloc(8),this.dataView.setFloat64(this.pos,s,!0),this.pos+=8}writeBytes(s){const l=s.length;this.writeVarint(l),this.realloc(l);for(let p=0;p<l;p++)this.buf[this.pos++]=s[p]}writeRawMessage(s,l){this.pos++;const p=this.pos;s(l,this);const m=this.pos-p;m>=128&&GM(p,m,this),this.pos=p-1,this.writeVarint(m),this.pos+=m}writeMessage(s,l,p){this.writeTag(s,2),this.writeRawMessage(l,p)}writePackedVarint(s,l){l.length&&this.writeMessage(s,Oj,l)}writePackedSVarint(s,l){l.length&&this.writeMessage(s,Rj,l)}writePackedBoolean(s,l){l.length&&this.writeMessage(s,Nj,l)}writePackedFloat(s,l){l.length&&this.writeMessage(s,Lj,l)}writePackedDouble(s,l){l.length&&this.writeMessage(s,Fj,l)}writePackedFixed32(s,l){l.length&&this.writeMessage(s,Bj,l)}writePackedSFixed32(s,l){l.length&&this.writeMessage(s,jj,l)}writePackedFixed64(s,l){l.length&&this.writeMessage(s,Uj,l)}writePackedSFixed64(s,l){l.length&&this.writeMessage(s,Vj,l)}writeBytesField(s,l){this.writeTag(s,2),this.writeBytes(l)}writeFixed32Field(s,l){this.writeTag(s,5),this.writeFixed32(l)}writeSFixed32Field(s,l){this.writeTag(s,5),this.writeSFixed32(l)}writeFixed64Field(s,l){this.writeTag(s,1),this.writeFixed64(l)}writeSFixed64Field(s,l){this.writeTag(s,1),this.writeSFixed64(l)}writeVarintField(s,l){this.writeTag(s,0),this.writeVarint(l)}writeSVarintField(s,l){this.writeTag(s,0),this.writeSVarint(l)}writeStringField(s,l){this.writeTag(s,2),this.writeString(l)}writeFloatField(s,l){this.writeTag(s,5),this.writeFloat(l)}writeDoubleField(s,l){this.writeTag(s,1),this.writeDouble(l)}writeBooleanField(s,l){this.writeVarintField(s,+l)}}function Ip(c,s,l){return l?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function GM(c,s,l){const p=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));l.realloc(p);for(let m=l.pos-1;m>=c;m--)l.buf[m+p]=l.buf[m]}function Oj(c,s){for(let l=0;l<c.length;l++)s.writeVarint(c[l])}function Rj(c,s){for(let l=0;l<c.length;l++)s.writeSVarint(c[l])}function Lj(c,s){for(let l=0;l<c.length;l++)s.writeFloat(c[l])}function Fj(c,s){for(let l=0;l<c.length;l++)s.writeDouble(c[l])}function Nj(c,s){for(let l=0;l<c.length;l++)s.writeBoolean(c[l])}function Bj(c,s){for(let l=0;l<c.length;l++)s.writeFixed32(c[l])}function jj(c,s){for(let l=0;l<c.length;l++)s.writeSFixed32(c[l])}function Uj(c,s){for(let l=0;l<c.length;l++)s.writeFixed64(c[l])}function Vj(c,s){for(let l=0;l<c.length;l++)s.writeSFixed64(c[l])}function Gj(c,s,l){c===1&&l.readMessage(qj,s)}function qj(c,s,l){if(c===3){const{id:p,bitmap:m,width:x,height:w,left:C,top:I,advance:A}=l.readMessage(Hj,{});s.push({id:p,bitmap:new kg({width:x+6,height:w+6},m),metrics:{width:x,height:w,left:C,top:I,advance:A}})}}function Hj(c,s,l){c===1?s.id=l.readVarint():c===2?s.bitmap=l.readBytes():c===3?s.width=l.readVarint():c===4?s.height=l.readVarint():c===5?s.left=l.readSVarint():c===6?s.top=l.readSVarint():c===7&&(s.advance=l.readVarint())}function qM(c){let s=0,l=0;for(const w of c)s+=w.w*w.h,l=Math.max(l,w.w);c.sort(((w,C)=>C.h-w.h));const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),l),h:1/0}];let m=0,x=0;for(const w of c)for(let C=p.length-1;C>=0;C--){const I=p[C];if(!(w.w>I.w||w.h>I.h)){if(w.x=I.x,w.y=I.y,x=Math.max(x,w.y+w.h),m=Math.max(m,w.x+w.w),w.w===I.w&&w.h===I.h){const A=p.pop();A&&C<p.length&&(p[C]=A)}else w.h===I.h?(I.x+=w.w,I.w-=w.w):w.w===I.w?(I.y+=w.h,I.h-=w.h):(p.push({x:I.x+w.w,y:I.y,w:I.w-w.w,h:w.h}),I.y+=w.h,I.h-=w.h);break}}return{w:m,h:x,fill:s/(m*x)||0}}class V2{constructor(s,{pixelRatio:l,version:p,stretchX:m,stretchY:x,content:w,textFitWidth:C,textFitHeight:I}){this.paddedRect=s,this.pixelRatio=l,this.stretchX=m,this.stretchY=x,this.content=w,this.version=p,this.textFitWidth=C,this.textFitHeight=I}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class HM{constructor(s,l){const p={},m={};this.haveRenderCallbacks=[];const x=[];this.addImages(s,p,x),this.addImages(l,m,x);const{w,h:C}=qM(x),I=new ss({width:w||1,height:C||1});for(const A in s){const D=s[A],N=p[A].paddedRect;ss.copy(D.data,I,{x:0,y:0},{x:N.x+1,y:N.y+1},D.data)}for(const A in l){const D=l[A],N=m[A].paddedRect,U=N.x+1,G=N.y+1,q=D.data.width,X=D.data.height;ss.copy(D.data,I,{x:0,y:0},{x:U,y:G},D.data),ss.copy(D.data,I,{x:0,y:X-1},{x:U,y:G-1},{width:q,height:1}),ss.copy(D.data,I,{x:0,y:0},{x:U,y:G+X},{width:q,height:1}),ss.copy(D.data,I,{x:q-1,y:0},{x:U-1,y:G},{width:1,height:X}),ss.copy(D.data,I,{x:0,y:0},{x:U+q,y:G},{width:1,height:X})}this.image=I,this.iconPositions=p,this.patternPositions=m}addImages(s,l,p){for(const m in s){const x=s[m],w={x:0,y:0,w:x.data.width+2,h:x.data.height+2};p.push(w),l[m]=new V2(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(s,l){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in s.updatedImages)this.patchUpdatedImage(this.iconPositions[p],s.getImage(p),l),this.patchUpdatedImage(this.patternPositions[p],s.getImage(p),l)}patchUpdatedImage(s,l,p){if(!s||!l||s.version===l.version)return;s.version=l.version;const[m,x]=s.tl;p.update(l.data,void 0,{x:m,y:x})}}var Qc;mt("ImagePosition",V2),mt("ImageAtlas",HM),d.ao=void 0,(Qc=d.ao||(d.ao={}))[Qc.none=0]="none",Qc[Qc.horizontal=1]="horizontal",Qc[Qc.vertical=2]="vertical",Qc[Qc.horizontalOnly=3]="horizontalOnly";class jg{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(s,l,p){const m=new jg;return m.scale=s||1,m.fontStack=l,m.verticalAlign=p||"bottom",m}static forImage(s,l){const p=new jg;return p.imageName=s,p.verticalAlign=l||"bottom",p}}class $p{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,l){const p=new $p;for(let m=0;m<s.sections.length;m++){const x=s.sections[m];x.image?p.addImageSection(x):p.addTextSection(x,l)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=(function(s){let l="";for(let p=0;p<s.length;p++){const m=s.charCodeAt(p+1)||null,x=s.charCodeAt(p-1)||null;l+=m&&s_(m)&&!Bg[s[p+1]]||x&&s_(x)&&!Bg[s[p-1]]||!Bg[s[p]]?s[p]:Bg[s[p]]}return l})(this.text)}trim(){let s=0;for(let p=0;p<this.text.length&&x_[this.text.charCodeAt(p)];p++)s++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=s&&x_[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(s,l),this.sectionIndex=this.sectionIndex.slice(s,l)}substring(s,l){const p=new $p;return p.text=this.text.substring(s,l),p.sectionIndex=this.sectionIndex.slice(s,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((s,l)=>Math.max(s,this.sections[l].scale)),0)}getMaxImageSize(s){let l=0,p=0;for(let m=0;m<this.length();m++){const x=this.getSection(m);if(x.imageName){const w=s[x.imageName];if(!w)continue;const C=w.displaySize;l=Math.max(l,C[0]),p=Math.max(p,C[1])}}return{maxImageWidth:l,maxImageHeight:p}}addTextSection(s,l){this.text+=s.text,this.sections.push(jg.forText(s.scale,s.fontStack||l,s.verticalAlign));const p=this.sections.length-1;for(let m=0;m<s.text.length;++m)this.sectionIndex.push(p)}addImageSection(s){const l=s.image?s.image.name:"";if(l.length===0)return void cr("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(jg.forImage(l,s.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):cr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function b_(c,s,l,p,m,x,w,C,I,A,D,N,U,G,q){const X=$p.fromFeature(c,m);let Q;N===d.ao.vertical&&X.verticalizePunctuation();const{processBidirectionalText:ne,processStyledBidirectionalText:ye}=Hs;if(ne&&X.sections.length===1){Q=[];const Me=ne(X.toString(),G2(X,A,x,s,p,G));for(const Re of Me){const Ze=new $p;Ze.text=Re,Ze.sections=X.sections;for(let ct=0;ct<Re.length;ct++)Ze.sectionIndex.push(0);Q.push(Ze)}}else if(ye){Q=[];const Me=ye(X.text,X.sectionIndex,G2(X,A,x,s,p,G));for(const Re of Me){const Ze=new $p;Ze.text=Re[0],Ze.sectionIndex=Re[1],Ze.sections=X.sections,Q.push(Ze)}}else Q=(function(Me,Re){const Ze=[],ct=Me.text;let rt=0;for(const at of Re)Ze.push(Me.substring(rt,at)),rt=at;return rt<ct.length&&Ze.push(Me.substring(rt,ct.length)),Ze})(X,G2(X,A,x,s,p,G));const ue=[],de={positionedLines:ue,text:X.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:N,iconsInText:!1,verticalizable:!1};return(function(Me,Re,Ze,ct,rt,at,It,ot,lt,je,At,zt){let Pt=0,wt=0,si=0,Ji=0;const zr=ot==="right"?1:ot==="left"?0:.5,yn=Zr/zt;let Js=0;for(const Zi of rt){Zi.trim();const Wr=Zi.getMaxScale(),cn={positionedGlyphs:[],lineOffset:0};Me.positionedLines[Js]=cn;const un=cn.positionedGlyphs;let Un=0;if(!Zi.length()){wt+=at,++Js;continue}const Ks=Xj(ct,Zi,yn);for(let as=0;as<Zi.length();as++){const Or=Zi.getSection(as),Xr=Zi.getSectionIndex(as),Jr=Zi.getCharCode(as),wr=Jj(lt,At,Jr);let Bi;if(Or.imageName){if(Me.iconsInText=!0,Or.scale=Or.scale*yn,Bi=Qj(Or,wr,Wr,Ks,ct),!Bi)continue;Un=Math.max(Un,Bi.imageOffset)}else if(Bi=Kj(Or,Jr,wr,Ks,Re,Ze),!Bi)continue;const{rect:ea,metrics:Ap,baselineOffset:ta}=Bi;un.push({glyph:Jr,imageName:Or.imageName,x:Pt,y:wt+ta+-17,vertical:wr,scale:Or.scale,fontStack:Or.fontStack,sectionIndex:Xr,metrics:Ap,rect:ea}),wr?(Me.verticalizable=!0,Pt+=(Or.imageName?Ap.advance:Zr)*Or.scale+je):Pt+=Ap.advance*Or.scale+je}un.length!==0&&(si=Math.max(Pt-je,si),e9(un,0,un.length-1,zr)),Pt=0,cn.lineOffset=Math.max(Un,(Wr-1)*Zr);const Yr=at*Wr+Un;wt+=Yr,Ji=Math.max(Yr,Ji),++Js}const{horizontalAlign:os,verticalAlign:ln}=q2(It);(function(Zi,Wr,cn,un,Un,Ks,Yr,as,Or){const Xr=(Wr-cn)*Un;let Jr=0;Jr=Ks!==Yr?-as*un- -17:-un*Or*Yr+.5*Yr;for(const wr of Zi)for(const Bi of wr.positionedGlyphs)Bi.x+=Xr,Bi.y+=Jr})(Me.positionedLines,zr,os,ln,si,Ji,at,wt,rt.length),Me.top+=-ln*wt,Me.bottom=Me.top+wt,Me.left+=-os*si,Me.right=Me.left+si})(de,s,l,p,Q,w,C,I,N,A,U,q),!(function(Me){for(const Re of Me)if(Re.positionedGlyphs.length!==0)return!1;return!0})(ue)&&de}const x_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Zj={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Wj={40:!0};function ZM(c,s,l,p,m,x){if(s.imageName){const w=p[s.imageName];return w?w.displaySize[0]*s.scale*Zr/x+m:0}{const w=l[s.fontStack],C=w&&w[c];return C?C.metrics.advance*s.scale+m:0}}function WM(c,s,l,p){const m=Math.pow(c-s,2);return p?c<s?m/2:2*m:m+Math.abs(l)*l}function Yj(c,s,l){let p=0;return c===10&&(p-=1e4),l&&(p+=150),c!==40&&c!==65288||(p+=50),s!==41&&s!==65289||(p+=50),p}function YM(c,s,l,p,m,x){let w=null,C=WM(s,l,m,x);for(const I of p){const A=WM(s-I.x,l,m,x)+I.badness;A<=C&&(w=I,C=A)}return{index:c,x:s,priorBreak:w,badness:C}}function XM(c){return c?XM(c.priorBreak).concat(c.index):[]}function G2(c,s,l,p,m,x){if(!c)return[];const w=[],C=(function(N,U,G,q,X,Q){let ne=0;for(let ye=0;ye<N.length();ye++){const ue=N.getSection(ye);ne+=ZM(N.getCharCode(ye),ue,q,X,U,Q)}return ne/Math.max(1,Math.ceil(ne/G))})(c,s,l,p,m,x),I=c.text.indexOf("")>=0;let A=0;for(let N=0;N<c.length();N++){const U=c.getSection(N),G=c.getCharCode(N);if(x_[G]||(A+=ZM(G,U,p,m,s,x)),N<c.length()-1){const q=!((D=G)<11904)&&(!!ni["CJK Compatibility Forms"](D)||!!ni["CJK Compatibility"](D)||!!ni["CJK Strokes"](D)||!!ni["CJK Symbols and Punctuation"](D)||!!ni["Enclosed CJK Letters and Months"](D)||!!ni["Halfwidth and Fullwidth Forms"](D)||!!ni["Ideographic Description Characters"](D)||!!ni["Vertical Forms"](D)||_g.test(String.fromCodePoint(D)));(Zj[G]||q||U.imageName||N!==c.length()-2&&Wj[c.getCharCode(N+1)])&&w.push(YM(N+1,A,C,w,Yj(G,c.getCharCode(N+1),q&&I),!1))}}var D;return XM(YM(c.length(),A,C,w,0,!0))}function q2(c){let s=.5,l=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:s,verticalAlign:l}}function Xj(c,s,l){const p=s.getMaxScale()*Zr,{maxImageWidth:m,maxImageHeight:x}=s.getMaxImageSize(c),w=Math.max(p,x*l);return{verticalLineContentWidth:Math.max(p,m*l),horizontalLineContentHeight:w}}function JM(c){switch(c){case"top":return 0;case"center":return .5;default:return 1}}function Jj(c,s,l){return!(c===d.ao.horizontal||!s&&!bg(l)||s&&(x_[l]||(p=l,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(p)))));var p}function Kj(c,s,l,p,m,x){const w=x[c.fontStack],C=(function(A,D,N,U){if(A&&A.rect)return A;const G=D[N.fontStack],q=G&&G[U];return q?{rect:null,metrics:q.metrics}:null})(w&&w[s],m,c,s);if(C===null)return null;let I;if(l)I=p.verticalLineContentWidth-c.scale*Zr;else{const A=JM(c.verticalAlign);I=(p.horizontalLineContentHeight-c.scale*Zr)*A}return{rect:C.rect,metrics:C.metrics,baselineOffset:I}}function Qj(c,s,l,p,m){const x=m[c.imageName];if(!x)return null;const w=x.paddedRect,C=x.displaySize,I={width:C[0],height:C[1],left:1,top:-3,advance:s?C[1]:C[0]};let A;if(s)A=p.verticalLineContentWidth-C[1]*c.scale;else{const D=JM(c.verticalAlign);A=(p.horizontalLineContentHeight-C[1]*c.scale)*D}return{rect:w,metrics:I,baselineOffset:A,imageOffset:(s?C[0]:C[1])*c.scale-Zr*l}}function e9(c,s,l,p){if(p===0)return;const m=c[l],x=(c[l].x+m.metrics.advance*m.scale)*p;for(let w=s;w<=l;w++)c[w].x-=x}function t9(c,s,l){const{horizontalAlign:p,verticalAlign:m}=q2(l),x=s[0]-c.displaySize[0]*p,w=s[1]-c.displaySize[1]*m;return{image:c,top:w,bottom:w+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function KM(c){var s,l;let p=c.left,m=c.top,x=c.right-p,w=c.bottom-m;const C=(s=c.image.textFitWidth)!==null&&s!==void 0?s:"stretchOrShrink",I=(l=c.image.textFitHeight)!==null&&l!==void 0?l:"stretchOrShrink",A=(c.image.content[2]-c.image.content[0])/(c.image.content[3]-c.image.content[1]);if(I==="proportional"){if(C==="stretchOnly"&&x/w<A||C==="proportional"){const D=Math.ceil(w*A);p*=D/x,x=D}}else if(C==="proportional"&&I==="stretchOnly"&&A!==0&&x/w>A){const D=Math.ceil(x/A);m*=D/w,w=D}return{x1:p,y1:m,x2:p+x,y2:m+w}}function QM(c,s,l,p,m,x){const w=c.image;let C;if(w.content){const Q=w.content,ne=w.pixelRatio||1;C=[Q[0]/ne,Q[1]/ne,w.displaySize[0]-Q[2]/ne,w.displaySize[1]-Q[3]/ne]}const I=s.left*x,A=s.right*x;let D,N,U,G;l==="width"||l==="both"?(G=m[0]+I-p[3],N=m[0]+A+p[1]):(G=m[0]+(I+A-w.displaySize[0])/2,N=G+w.displaySize[0]);const q=s.top*x,X=s.bottom*x;return l==="height"||l==="both"?(D=m[1]+q-p[0],U=m[1]+X+p[2]):(D=m[1]+(q+X-w.displaySize[1])/2,U=D+w.displaySize[1]),{image:w,top:D,right:N,bottom:U,left:G,collisionPadding:C}}const Zl=128,eu=32640;function ek(c,s){const{expression:l}=s;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new ki(c+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:m}=l;let x=0;for(;x<p.length&&p[x]<=c;)x++;x=Math.max(0,x-1);let w=x;for(;w<p.length&&p[w]<c+1;)w++;w=Math.min(p.length-1,w);const C=p[x],I=p[w];return l.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:I,interpolationType:m}:{kind:"camera",minZoom:C,maxZoom:I,minSize:l.evaluate(new ki(C)),maxSize:l.evaluate(new ki(I)),interpolationType:m}}}function H2(c,s,l){let p="never";const m=c.get(s);return m?p=m:c.get(l)&&(p="always"),p}const i9=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function w_(c,s,l,p,m,x,w,C,I,A,D,N,U){const G=C?Math.min(eu,Math.round(C[0])):0,q=C?Math.min(eu,Math.round(C[1])):0;c.emplaceBack(s,l,Math.round(32*p),Math.round(32*m),x,w,(G<<1)+(I?1:0),q,16*A,16*D,256*N,256*U)}function Z2(c,s,l){c.emplaceBack(s.x,s.y,l),c.emplaceBack(s.x,s.y,l),c.emplaceBack(s.x,s.y,l),c.emplaceBack(s.x,s.y,l)}function r9(c){for(const s of c.sections)if(l_(s.text))return!0;return!1}class W2{constructor(s){this.layoutVertexArray=new st,this.indexArray=new Ci,this.programConfigurations=s,this.segments=new Ut,this.dynamicLayoutVertexArray=new He,this.opacityVertexArray=new xt,this.hasVisibleVertices=!1,this.placedSymbolArray=new W}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,l,p,m){this.isEmpty()||(p&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Mj.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,kj.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,i9,!0),this.opacityVertexBuffer.itemSize=1),(p||m)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}mt("SymbolBuffers",W2);class Y2{constructor(s,l,p){this.layoutVertexArray=new s,this.layoutAttributes=l,this.indexArray=new p,this.segments=new Ut,this.collisionVertexArray=new yi}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,Aj.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}mt("CollisionBuffers",Y2);class Pp{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.globalState=s.globalState,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map((w=>w.id)),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ek(this.zoom,l["text-size"]),this.iconSizeData=ek(this.zoom,l["icon-size"]);const p=this.layers[0].layout,m=p.get("symbol-sort-key"),x=p.get("symbol-z-order");this.canOverlap=H2(p,"text-overlap","text-allow-overlap")!=="never"||H2(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map((w=>d.ao[w]))),this.stateDependentLayerIds=this.layers.filter((w=>w.isStateDependent())).map((w=>w.id)),this.sourceID=s.sourceID}createArrays(){this.text=new W2(new ns(this.layers,this.zoom,(s=>/^text/.test(s)))),this.icon=new W2(new ns(this.layers,this.zoom,(s=>/^icon/.test(s)))),this.glyphOffsetArray=new re,this.lineVertexArray=new se,this.symbolInstances=new ee,this.textAnchorOffsets=new oe}calculateGlyphDependencies(s,l,p,m,x){for(let w=0;w<s.length;w++)if(l[s.charCodeAt(w)]=!0,(p||m)&&x){const C=Bg[s.charAt(w)];C&&(l[C.charCodeAt(0)]=!0)}}populate(s,l,p){const m=this.layers[0],x=m.layout,w=x.get("text-font"),C=x.get("text-field"),I=x.get("icon-image"),A=(C.value.kind!=="constant"||C.value.value instanceof Sn&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),D=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,N=x.get("symbol-sort-key");if(this.features=[],!A&&!D)return;const U=l.iconDependencies,G=l.glyphDependencies,q=l.availableImages,X=new ki(this.zoom,{globalState:this.globalState});for(const{feature:Q,id:ne,index:ye,sourceLayerIndex:ue}of s){const de=m._featureFilter.needGeometry,Me=Qo(Q,de);if(!m._featureFilter.filter(X,Me,p))continue;let Re,Ze;if(de||(Me.geometry=Xa(Q)),A){const rt=m.getValueAndResolveTokens("text-field",Me,p,q),at=Sn.factory(rt),It=this.hasRTLText=this.hasRTLText||r9(at);(!It||Hs.getRTLTextPluginStatus()==="unavailable"||It&&Hs.isParsed())&&(Re=zj(at,m,Me))}if(D){const rt=m.getValueAndResolveTokens("icon-image",Me,p,q);Ze=rt instanceof is?rt:is.fromString(rt)}if(!Re&&!Ze)continue;const ct=this.sortFeaturesByKey?N.evaluate(Me,{},p):void 0;if(this.features.push({id:ne,text:Re,icon:Ze,index:ye,sourceLayerIndex:ue,geometry:Me.geometry,properties:Q.properties,type:Ep.types[Q.type],sortKey:ct}),Ze&&(U[Ze.name]=!0),Re){const rt=w.evaluate(Me,{},p).join(","),at=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(d.ao.vertical)>=0;for(const It of Re.sections)if(It.image)U[It.image.name]=!0;else{const ot=dp(Re.toString()),lt=It.fontStack||rt,je=G[lt]=G[lt]||{};this.calculateGlyphDependencies(It.text,je,at,this.allowVerticalPlacement,ot)}}}x.get("symbol-placement")==="line"&&(this.features=(function(Q){const ne={},ye={},ue=[];let de=0;function Me(rt){ue.push(Q[rt]),de++}function Re(rt,at,It){const ot=ye[rt];return delete ye[rt],ye[at]=ot,ue[ot].geometry[0].pop(),ue[ot].geometry[0]=ue[ot].geometry[0].concat(It[0]),ot}function Ze(rt,at,It){const ot=ne[at];return delete ne[at],ne[rt]=ot,ue[ot].geometry[0].shift(),ue[ot].geometry[0]=It[0].concat(ue[ot].geometry[0]),ot}function ct(rt,at,It){const ot=It?at[0][at[0].length-1]:at[0][0];return`${rt}:${ot.x}:${ot.y}`}for(let rt=0;rt<Q.length;rt++){const at=Q[rt],It=at.geometry,ot=at.text?at.text.toString():null;if(!ot){Me(rt);continue}const lt=ct(ot,It),je=ct(ot,It,!0);if(lt in ye&&je in ne&&ye[lt]!==ne[je]){const At=Ze(lt,je,It),zt=Re(lt,je,ue[At].geometry);delete ne[lt],delete ye[je],ye[ct(ot,ue[zt].geometry,!0)]=zt,ue[At].geometry=null}else lt in ye?Re(lt,je,It):je in ne?Ze(lt,je,It):(Me(rt),ne[lt]=de-1,ye[je]=de-1)}return ue.filter((rt=>rt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Q,ne)=>Q.sortKey-ne.sortKey))}update(s,l,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,l,this.layers,{imagePositions:p,globalState:this.globalState}),this.icon.programConfigurations.updatePaintArrays(s,l,this.layers,{imagePositions:p,globalState:this.globalState}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,l){const p=this.lineVertexArray.length;if(s.segment!==void 0){let m=s.dist(l[s.segment+1]),x=s.dist(l[s.segment]);const w={};for(let C=s.segment+1;C<l.length;C++)w[C]={x:l[C].x,y:l[C].y,tileUnitDistanceFromAnchor:m},C<l.length-1&&(m+=l[C+1].dist(l[C]));for(let C=s.segment||0;C>=0;C--)w[C]={x:l[C].x,y:l[C].y,tileUnitDistanceFromAnchor:x},C>0&&(x+=l[C-1].dist(l[C]));for(let C=0;C<l.length;C++){const I=w[C];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(s,l,p,m,x,w,C,I,A,D,N,U){const G=s.indexArray,q=s.layoutVertexArray,X=s.segments.prepareSegment(4*l.length,q,G,this.canOverlap?w.sortKey:void 0),Q=this.glyphOffsetArray.length,ne=X.vertexLength,ye=this.allowVerticalPlacement&&C===d.ao.vertical?Math.PI/2:0,ue=w.text&&w.text.sections;for(let de=0;de<l.length;de++){const{tl:Me,tr:Re,bl:Ze,br:ct,tex:rt,pixelOffsetTL:at,pixelOffsetBR:It,minFontScaleX:ot,minFontScaleY:lt,glyphOffset:je,isSDF:At,sectionIndex:zt}=l[de],Pt=X.vertexLength,wt=je[1];w_(q,I.x,I.y,Me.x,wt+Me.y,rt.x,rt.y,p,At,at.x,at.y,ot,lt),w_(q,I.x,I.y,Re.x,wt+Re.y,rt.x+rt.w,rt.y,p,At,It.x,at.y,ot,lt),w_(q,I.x,I.y,Ze.x,wt+Ze.y,rt.x,rt.y+rt.h,p,At,at.x,It.y,ot,lt),w_(q,I.x,I.y,ct.x,wt+ct.y,rt.x+rt.w,rt.y+rt.h,p,At,It.x,It.y,ot,lt),Z2(s.dynamicLayoutVertexArray,I,ye),G.emplaceBack(Pt,Pt+2,Pt+1),G.emplaceBack(Pt+1,Pt+2,Pt+3),X.vertexLength+=4,X.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(je[0]),de!==l.length-1&&zt===l[de+1].sectionIndex||s.programConfigurations.populatePaintArrays(q.length,w,w.index,{imagePositions:{},canonical:U,formattedSection:ue&&ue[zt],globalState:this.globalState})}s.placedSymbolArray.emplaceBack(I.x,I.y,Q,this.glyphOffsetArray.length-Q,ne,A,D,I.segment,p?p[0]:0,p?p[1]:0,m[0],m[1],C,0,!1,0,N)}_addCollisionDebugVertex(s,l,p,m,x,w){return l.emplaceBack(0,0),s.emplaceBack(p.x,p.y,m,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(s,l,p,m,x,w,C){const I=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),A=I.vertexLength,D=x.layoutVertexArray,N=x.collisionVertexArray,U=C.anchorX,G=C.anchorY;this._addCollisionDebugVertex(D,N,w,U,G,new v(s,l)),this._addCollisionDebugVertex(D,N,w,U,G,new v(p,l)),this._addCollisionDebugVertex(D,N,w,U,G,new v(p,m)),this._addCollisionDebugVertex(D,N,w,U,G,new v(s,m)),I.vertexLength+=4;const q=x.indexArray;q.emplaceBack(A,A+1),q.emplaceBack(A+1,A+2),q.emplaceBack(A+2,A+3),q.emplaceBack(A+3,A),I.primitiveLength+=4}addDebugCollisionBoxes(s,l,p,m){for(let x=s;x<l;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,m?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Y2(Ht,jM.members,wi),this.iconCollisionBox=new Y2(Ht,jM.members,wi);for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(s,l,p,m,x,w,C,I,A){const D={};for(let N=l;N<p;N++){const U=s.get(N);D.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.textFeatureIndex=U.featureIndex;break}for(let N=m;N<x;N++){const U=s.get(N);D.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalTextFeatureIndex=U.featureIndex;break}for(let N=w;N<C;N++){const U=s.get(N);D.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.iconFeatureIndex=U.featureIndex;break}for(let N=I;N<A;N++){const U=s.get(N);D.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},D.verticalIconFeatureIndex=U.featureIndex;break}return D}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,l){const p=s.placedSymbolArray.get(l),m=p.vertexStartIndex+4*p.numGlyphs;for(let x=p.vertexStartIndex;x<m;x+=4)s.indexArray.emplaceBack(x,x+2,x+1),s.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(s),p=Math.cos(s),m=[],x=[],w=[];for(let C=0;C<this.symbolInstances.length;++C){w.push(C);const I=this.symbolInstances.get(C);m.push(0|Math.round(l*I.anchorX+p*I.anchorY)),x.push(I.featureIndex)}return w.sort(((C,I)=>m[C]-m[I]||x[I]-x[C])),w}addToSortKeyRanges(s,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(((m,x,w)=>{m>=0&&w.indexOf(m)===x&&this.addIndicesForPlacedSymbol(this.text,m)})),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let tk,ik;mt("SymbolBucket",Pp,{omit:["layers","collisionBoxArray","features","compareText"]}),Pp.MAX_GLYPHS=65535,Pp.addDynamicAttributes=Z2;var X2={get paint(){return ik=ik||new En({"icon-opacity":new Mt(Te.paint_symbol["icon-opacity"]),"icon-color":new Mt(Te.paint_symbol["icon-color"]),"icon-halo-color":new Mt(Te.paint_symbol["icon-halo-color"]),"icon-halo-width":new Mt(Te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Mt(Te.paint_symbol["icon-halo-blur"]),"icon-translate":new Tt(Te.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tt(Te.paint_symbol["icon-translate-anchor"]),"text-opacity":new Mt(Te.paint_symbol["text-opacity"]),"text-color":new Mt(Te.paint_symbol["text-color"],{runtimeType:on,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Mt(Te.paint_symbol["text-halo-color"]),"text-halo-width":new Mt(Te.paint_symbol["text-halo-width"]),"text-halo-blur":new Mt(Te.paint_symbol["text-halo-blur"]),"text-translate":new Tt(Te.paint_symbol["text-translate"]),"text-translate-anchor":new Tt(Te.paint_symbol["text-translate-anchor"])})},get layout(){return tk=tk||new En({"symbol-placement":new Tt(Te.layout_symbol["symbol-placement"]),"symbol-spacing":new Tt(Te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tt(Te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Mt(Te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tt(Te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tt(Te.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tt(Te.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tt(Te.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tt(Te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tt(Te.layout_symbol["icon-rotation-alignment"]),"icon-size":new Mt(Te.layout_symbol["icon-size"]),"icon-text-fit":new Tt(Te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tt(Te.layout_symbol["icon-text-fit-padding"]),"icon-image":new Mt(Te.layout_symbol["icon-image"]),"icon-rotate":new Mt(Te.layout_symbol["icon-rotate"]),"icon-padding":new Mt(Te.layout_symbol["icon-padding"]),"icon-keep-upright":new Tt(Te.layout_symbol["icon-keep-upright"]),"icon-offset":new Mt(Te.layout_symbol["icon-offset"]),"icon-anchor":new Mt(Te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tt(Te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tt(Te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tt(Te.layout_symbol["text-rotation-alignment"]),"text-field":new Mt(Te.layout_symbol["text-field"]),"text-font":new Mt(Te.layout_symbol["text-font"]),"text-size":new Mt(Te.layout_symbol["text-size"]),"text-max-width":new Mt(Te.layout_symbol["text-max-width"]),"text-line-height":new Tt(Te.layout_symbol["text-line-height"]),"text-letter-spacing":new Mt(Te.layout_symbol["text-letter-spacing"]),"text-justify":new Mt(Te.layout_symbol["text-justify"]),"text-radial-offset":new Mt(Te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tt(Te.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Mt(Te.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Mt(Te.layout_symbol["text-anchor"]),"text-max-angle":new Tt(Te.layout_symbol["text-max-angle"]),"text-writing-mode":new Tt(Te.layout_symbol["text-writing-mode"]),"text-rotate":new Mt(Te.layout_symbol["text-rotate"]),"text-padding":new Tt(Te.layout_symbol["text-padding"]),"text-keep-upright":new Tt(Te.layout_symbol["text-keep-upright"]),"text-transform":new Mt(Te.layout_symbol["text-transform"]),"text-offset":new Mt(Te.layout_symbol["text-offset"]),"text-allow-overlap":new Tt(Te.layout_symbol["text-allow-overlap"]),"text-overlap":new Tt(Te.layout_symbol["text-overlap"]),"text-ignore-placement":new Tt(Te.layout_symbol["text-ignore-placement"]),"text-optional":new Tt(Te.layout_symbol["text-optional"])})}};class rk{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:$c,this.defaultValue=s}evaluate(s){if(s.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(s.formattedSection))return l.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mt("FormatSectionOverride",rk,{omit:["defaultValue"]});class S_ extends bs{constructor(s){super(s,X2)}recalculate(s,l){if(super.recalculate(s,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const m=[];for(const x of p)m.indexOf(x)<0&&m.push(x);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,l,p,m){const x=this.layout.get(s).evaluate(l,{},p,m),w=this._unevaluatedLayout._values[s];return w.isDataDriven()||np(w.value)||!x?x:(function(C,I){return I.replace(/{([^{}]+)}/g,((A,D)=>C&&D in C?String(C[D]):""))})(l.properties,x)}createBucket(s){return new Pp(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of X2.paint.overridableProperties){if(!S_.hasPaintOverride(this.layout,s))continue;const l=this.paint.get(s),p=new rk(l),m=new ag(p,l.property.specification);let x=null;x=l.value.kind==="constant"||l.value.kind==="source"?new dh("source",m):new lg("composite",m,l.value.zoomStops),this.paint._values[s]=new Po(l.property,x,l.parameters)}}_handleOverridablePaintPropertyUpdate(s,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&S_.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,l){const p=s.get("text-field"),m=X2.paint.properties[l];let x=!1;const w=C=>{for(const I of C)if(m.overrides&&m.overrides.hasOverride(I))return void(x=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Sn)w(p.value.value.sections);else if(p.value.kind==="source"||p.value.kind==="composite"){const C=A=>{x||(A instanceof Yo&&kt(A.value)===Na?w(A.value.sections):A instanceof Dl?w(A.sections):A.eachChild(C))},I=p.value;I._styleExpression&&C(I._styleExpression.expression)}return x}}let nk;var n9={get paint(){return nk=nk||new En({"background-color":new Tt(Te.paint_background["background-color"]),"background-pattern":new qa(Te.paint_background["background-pattern"]),"background-opacity":new Tt(Te.paint_background["background-opacity"])})}};class s9 extends bs{constructor(s){super(s,n9)}}let sk;var o9={get paint(){return sk=sk||new En({"raster-opacity":new Tt(Te.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tt(Te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tt(Te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tt(Te.paint_raster["raster-brightness-max"]),"raster-saturation":new Tt(Te.paint_raster["raster-saturation"]),"raster-contrast":new Tt(Te.paint_raster["raster-contrast"]),"raster-resampling":new Tt(Te.paint_raster["raster-resampling"]),"raster-fade-duration":new Tt(Te.paint_raster["raster-fade-duration"])})}};class a9 extends bs{constructor(s){super(s,o9)}}class l9 extends bs{constructor(s){super(s,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class c9{constructor(s){this._methodToThrottle=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const u9={once:!0},J2=63710088e-1;class tu{constructor(s,l){if(isNaN(s)||isNaN(l))throw new Error(`Invalid LngLat object: (${s}, ${l})`);if(this.lng=+s,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new tu(bo(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const l=Math.PI/180,p=this.lat*l,m=s.lat*l,x=Math.sin(p)*Math.sin(m)+Math.cos(p)*Math.cos(m)*Math.cos((s.lng-this.lng)*l);return J2*Math.acos(Math.min(x,1))}static convert(s){if(s instanceof tu)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new tu(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new tu(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const ok=2*Math.PI*J2;function ak(c){return ok*Math.cos(c*Math.PI/180)}function lk(c){return(180+c)/360}function ck(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function uk(c,s){return c/ak(s)}function K2(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function hk(c,s){return c*ak(K2(s))}class Ug{constructor(s,l,p=0){this.x=+s,this.y=+l,this.z=+p}static fromLngLat(s,l=0){const p=tu.convert(s);return new Ug(lk(p.lng),ck(p.lat),uk(l,p.lat))}toLngLat(){return new tu(360*this.x-180,K2(this.y))}toAltitude(){return hk(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ok*(s=K2(this.y),1/Math.cos(s*Math.PI/180));var s}}function dk(c,s,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[c*p-2*Math.PI*6378137/2,s*p-2*Math.PI*6378137/2]}class Q2{constructor(s,l,p){if(!(function(m,x,w){return!(m<0||m>25||w<0||w>=Math.pow(2,m)||x<0||x>=Math.pow(2,m))})(s,l,p))throw new Error(`x=${l}, y=${p}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=l,this.y=p,this.key=Mp(0,s,s,l,p)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,l,p){const m=(w=this.y,C=this.z,I=dk(256*(x=this.x),256*(w=Math.pow(2,C)-w-1),C),A=dk(256*(x+1),256*(w+1),C),I[0]+","+I[1]+","+A[0]+","+A[1]);var x,w,C,I,A;const D=(function(N,U,G){let q,X="";for(let Q=N;Q>0;Q--)q=1<<Q-1,X+=(U&q?1:0)+(G&q?2:0);return X})(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,m)}isChildOf(s){const l=this.z-s.z;return l>0&&s.x===this.x>>l&&s.y===this.y>>l}getTilePoint(s){const l=Math.pow(2,this.z);return new v((s.x*l-this.x)*Ye,(s.y*l-this.y)*Ye)}toString(){return`${this.z}/${this.x}/${this.y}`}}class pk{constructor(s,l){this.wrap=s,this.canonical=l,this.key=Mp(s,l.z,l.z,l.x,l.y)}}class Xs{constructor(s,l,p,m,x){if(this.terrainRttPosMatrix32f=null,s<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${p}`);this.overscaledZ=s,this.wrap=l,this.canonical=new Q2(p,+m,+x),this.key=Mp(l,s,p,m,x)}clone(){return new Xs(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-s;return s>this.canonical.z?new Xs(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xs(s,this.wrap,s,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(s,l){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-s;return s>this.canonical.z?Mp(this.wrap*+l,s,this.canonical.z,this.canonical.x,this.canonical.y):Mp(this.wrap*+l,s,s,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const l=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>l&&s.canonical.y===this.canonical.y>>l}children(s){if(this.overscaledZ>=s)return[new Xs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,m=2*this.canonical.y;return[new Xs(l,this.wrap,l,p,m),new Xs(l,this.wrap,l,p+1,m),new Xs(l,this.wrap,l,p,m+1),new Xs(l,this.wrap,l,p+1,m+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Xs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Xs(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new pk(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new Ug(s.x-this.wrap,s.y))}}function Mp(c,s,l,p,m){(c*=2)<0&&(c=-1*c-1);const x=1<<l;return(x*x*c+x*m+p).toString(36)+l.toString(36)+s.toString(36)}function Vg(c,s){return s?c.properties[s]:c.id}mt("CanonicalTileID",Q2),mt("OverscaledTileID",Xs,{omit:["terrainRttPosMatrix32f"]});class Ch{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(s){return this.minX=Math.min(this.minX,s.x),this.minY=Math.min(this.minY,s.y),this.maxX=Math.max(this.maxX,s.x),this.maxY=Math.max(this.maxY,s.y),this}expandBy(s){return this.minX-=s,this.minY-=s,this.maxX+=s,this.maxY+=s,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(s){return this.expandBy(-s)}map(s){const l=new Ch;return l.extend(s(new v(this.minX,this.minY))),l.extend(s(new v(this.maxX,this.minY))),l.extend(s(new v(this.minX,this.maxY))),l.extend(s(new v(this.maxX,this.maxY))),l}static fromPoints(s){const l=new Ch;for(const p of s)l.extend(p);return l}contains(s){return s.x>=this.minX&&s.x<=this.maxX&&s.y>=this.minY&&s.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(s){return!this.empty()&&!s.empty()&&s.minX>=this.minX&&s.maxX<=this.maxX&&s.minY>=this.minY&&s.maxY<=this.maxY}intersects(s){return!this.empty()&&!s.empty()&&s.minX<=this.maxX&&s.maxX>=this.minX&&s.minY<=this.maxY&&s.maxY>=this.minY}}class fk{constructor(s){this._stringToNumber={},this._numberToString=[];for(let l=0;l<s.length;l++){const p=s[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class mk{constructor(s,l,p,m,x){this.type="Feature",this._vectorTileFeature=s,s._z=l,s._x=p,s._y=m,this.properties=s.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(s[l]=this[l]);return s}}class gk{constructor(s,l){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new _h(Ye,16,0),this.grid3D=new _h(Ye,16,0),this.featureIndexArray=new me,this.promoteId=l}insert(s,l,p,m,x,w){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,m,x);const I=w?this.grid3D:this.grid;for(let A=0;A<l.length;A++){const D=l[A],N=[1/0,1/0,-1/0,-1/0];for(let U=0;U<D.length;U++){const G=D[U];N[0]=Math.min(N[0],G.x),N[1]=Math.min(N[1],G.y),N[2]=Math.max(N[2],G.x),N[3]=Math.max(N[3],G.y)}N[0]<Ye&&N[1]<Ye&&N[2]>=0&&N[3]>=0&&I.insert(C,N[0],N[1],N[2],N[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new AM(new U2(this.rawTileData)).layers,this.sourceLayerCoder=new fk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,l,p,m){this.loadVTLayers();const x=s.params,w=Ye/s.tileSize/s.scale,C=Nl(x.filter),I=s.queryGeometry,A=s.queryPadding*w,D=Ch.fromPoints(I),N=this.grid.query(D.minX-A,D.minY-A,D.maxX+A,D.maxY+A),U=Ch.fromPoints(s.cameraQueryGeometry).expandBy(A),G=this.grid3D.query(U.minX,U.minY,U.maxX,U.maxY,((Q,ne,ye,ue)=>(function(de,Me,Re,Ze,ct){for(const at of de)if(Me<=at.x&&Re<=at.y&&Ze>=at.x&&ct>=at.y)return!0;const rt=[new v(Me,Re),new v(Me,ct),new v(Ze,ct),new v(Ze,Re)];if(de.length>2){for(const at of rt)if(wp(de,at))return!0}for(let at=0;at<de.length-1;at++)if(U8(de[at],de[at+1],rt))return!0;return!1})(s.cameraQueryGeometry,Q-A,ne-A,ye+A,ue+A)));for(const Q of G)N.push(Q);N.sort(h9);const q={};let X;for(let Q=0;Q<N.length;Q++){const ne=N[Q];if(ne===X)continue;X=ne;const ye=this.featureIndexArray.get(ne);let ue=null;this.loadMatchingFeature(q,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,C,x.layers,x.availableImages,l,p,m,((de,Me,Re)=>(ue||(ue=Xa(de)),Me.queryIntersectsFeature({queryGeometry:I,feature:de,featureState:Re,geometry:ue,zoom:this.z,transform:s.transform,pixelsToTileUnits:w,pixelPosMatrix:s.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:s.getElevation}))))}return q}loadMatchingFeature(s,l,p,m,x,w,C,I,A,D,N){const U=this.bucketLayerIDs[l];if(w&&!U.some((Q=>w.has(Q))))return;const G=this.sourceLayerCoder.decode(p),q=this.vtLayers[G].feature(m);if(x.needGeometry){const Q=Qo(q,!0);if(!x.filter(new ki(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!x.filter(new ki(this.tileID.overscaledZ),q))return;const X=this.getId(q,G);for(let Q=0;Q<U.length;Q++){const ne=U[Q];if(w&&!w.has(ne))continue;const ye=I[ne];if(!ye)continue;let ue={};X&&D&&(ue=D.getState(ye.sourceLayer||"_geojsonTileLayer",X));const de=dn({},A[ne]);de.paint=yk(de.paint,ye.paint,q,ue,C),de.layout=yk(de.layout,ye.layout,q,ue,C);const Me=!N||N(q,ye,ue);if(!Me)continue;const Re=new mk(q,this.z,this.x,this.y,X);Re.layer=de;let Ze=s[ne];Ze===void 0&&(Ze=s[ne]=[]),Ze.push({featureIndex:m,feature:Re,intersectionZ:Me})}}lookupSymbolFeatures(s,l,p,m,x,w,C,I){const A={};this.loadVTLayers();const D=Nl(x);for(const N of s)this.loadMatchingFeature(A,p,m,N,D,w,C,I,l);return A}hasLayer(s){for(const l of this.bucketLayerIDs)for(const p of l)if(s===p)return!0;return!1}getId(s,l){var p;let m=s.id;return this.promoteId&&(m=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((p=s.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(m=Number(s.properties.cluster_id))),m}}function yk(c,s,l,p,m){return Tc(c,((x,w)=>{const C=s instanceof fp?s.get(w):null;return C&&C.evaluate?C.evaluate(l,p,m):C}))}function h9(c,s){return s-c}function vk(c,s,l,p,m){const x=[];for(let w=0;w<c.length;w++){const C=c[w];let I;for(let A=0;A<C.length-1;A++){let D=C[A],N=C[A+1];D.x<s&&N.x<s||(D.x<s?D=new v(s,D.y+(s-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x<s&&(N=new v(s,D.y+(s-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y<l&&N.y<l||(D.y<l?D=new v(D.x+(l-D.y)/(N.y-D.y)*(N.x-D.x),l)._round():N.y<l&&(N=new v(D.x+(l-D.y)/(N.y-D.y)*(N.x-D.x),l)._round()),D.x>=p&&N.x>=p||(D.x>=p?D=new v(p,D.y+(p-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x>=p&&(N=new v(p,D.y+(p-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y>=m&&N.y>=m||(D.y>=m?D=new v(D.x+(m-D.y)/(N.y-D.y)*(N.x-D.x),m)._round():N.y>=m&&(N=new v(D.x+(m-D.y)/(N.y-D.y)*(N.x-D.x),m)._round()),I&&D.equals(I[I.length-1])||(I=[D],x.push(I)),I.push(N)))))}}return x}mt("FeatureIndex",gk,{omit:["rawTileData","sourceLayerCoder"]});class iu extends v{constructor(s,l,p,m){super(s,l),this.angle=p,m!==void 0&&(this.segment=m)}clone(){return new iu(this.x,this.y,this.angle,this.segment)}}function _k(c,s,l,p,m){if(s.segment===void 0||l===0)return!0;let x=s,w=s.segment+1,C=0;for(;C>-l/2;){if(w--,w<0)return!1;C-=c[w].dist(x),x=c[w]}C+=c[w].dist(c[w+1]),w++;const I=[];let A=0;for(;C<l/2;){const D=c[w],N=c[w+1];if(!N)return!1;let U=c[w-1].angleTo(D)-D.angleTo(N);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:C,angleDelta:U}),A+=U;C-I[0].distance>p;)A-=I.shift().angleDelta;if(A>m)return!1;w++,C+=D.dist(N)}return!0}function bk(c){let s=0;for(let l=0;l<c.length-1;l++)s+=c[l].dist(c[l+1]);return s}function xk(c,s,l){return c?.6*s*l:0}function wk(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function d9(c,s,l,p,m,x){const w=xk(l,m,x),C=wk(l,p)*x;let I=0;const A=bk(c)/2;for(let D=0;D<c.length-1;D++){const N=c[D],U=c[D+1],G=N.dist(U);if(I+G>A){const q=(A-I)/G,X=Io.number(N.x,U.x,q),Q=Io.number(N.y,U.y,q),ne=new iu(X,Q,U.angleTo(N),D);return ne._round(),!w||_k(c,ne,C,w,s)?ne:void 0}I+=G}}function p9(c,s,l,p,m,x,w,C,I){const A=xk(p,x,w),D=wk(p,m),N=D*w,U=c[0].x===0||c[0].x===I||c[0].y===0||c[0].y===I;return s-N<s/4&&(s=N+s/4),Sk(c,U?s/2*C%s:(D/2+2*x)*w*C%s,s,A,l,N,U,!1,I)}function Sk(c,s,l,p,m,x,w,C,I){const A=x/2,D=bk(c);let N=0,U=s-l,G=[];for(let q=0;q<c.length-1;q++){const X=c[q],Q=c[q+1],ne=X.dist(Q),ye=Q.angleTo(X);for(;U+l<N+ne;){U+=l;const ue=(U-N)/ne,de=Io.number(X.x,Q.x,ue),Me=Io.number(X.y,Q.y,ue);if(de>=0&&de<I&&Me>=0&&Me<I&&U-A>=0&&U+A<=D){const Re=new iu(de,Me,ye,q);Re._round(),p&&!_k(c,Re,x,p,m)||G.push(Re)}}N+=ne}return C||G.length||w||(G=Sk(c,N/2,l,p,m,x,w,!0,I)),G}function Tk(c,s,l,p){const m=[],x=c.image,w=x.pixelRatio,C=x.paddedRect.w-2,I=x.paddedRect.h-2;let A={x1:c.left,y1:c.top,x2:c.right,y2:c.bottom};const D=x.stretchX||[[0,C]],N=x.stretchY||[[0,I]],U=(je,At)=>je+At[1]-At[0],G=D.reduce(U,0),q=N.reduce(U,0),X=C-G,Q=I-q;let ne=0,ye=G,ue=0,de=q,Me=0,Re=X,Ze=0,ct=Q;if(x.content&&p){const je=x.content,At=je[2]-je[0],zt=je[3]-je[1];(x.textFitWidth||x.textFitHeight)&&(A=KM(c)),ne=T_(D,0,je[0]),ue=T_(N,0,je[1]),ye=T_(D,je[0],je[2]),de=T_(N,je[1],je[3]),Me=je[0]-ne,Ze=je[1]-ue,Re=At-ye,ct=zt-de}const rt=A.x1,at=A.y1,It=A.x2-rt,ot=A.y2-at,lt=(je,At,zt,Pt)=>{const wt=C_(je.stretch-ne,ye,It,rt),si=E_(je.fixed-Me,Re,je.stretch,G),Ji=C_(At.stretch-ue,de,ot,at),zr=E_(At.fixed-Ze,ct,At.stretch,q),yn=C_(zt.stretch-ne,ye,It,rt),Js=E_(zt.fixed-Me,Re,zt.stretch,G),os=C_(Pt.stretch-ue,de,ot,at),ln=E_(Pt.fixed-Ze,ct,Pt.stretch,q),Zi=new v(wt,Ji),Wr=new v(yn,Ji),cn=new v(yn,os),un=new v(wt,os),Un=new v(si/w,zr/w),Ks=new v(Js/w,ln/w),Yr=s*Math.PI/180;if(Yr){const Xr=Math.sin(Yr),Jr=Math.cos(Yr),wr=[Jr,-Xr,Xr,Jr];Zi._matMult(wr),Wr._matMult(wr),un._matMult(wr),cn._matMult(wr)}const as=je.stretch+je.fixed,Or=At.stretch+At.fixed;return{tl:Zi,tr:Wr,bl:un,br:cn,tex:{x:x.paddedRect.x+1+as,y:x.paddedRect.y+1+Or,w:zt.stretch+zt.fixed-as,h:Pt.stretch+Pt.fixed-Or},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Un,pixelOffsetBR:Ks,minFontScaleX:Re/w/It,minFontScaleY:ct/w/ot,isSDF:l}};if(p&&(x.stretchX||x.stretchY)){const je=Ck(D,X,G),At=Ck(N,Q,q);for(let zt=0;zt<je.length-1;zt++){const Pt=je[zt],wt=je[zt+1];for(let si=0;si<At.length-1;si++)m.push(lt(Pt,At[si],wt,At[si+1]))}}else m.push(lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:I+1}));return m}function T_(c,s,l){let p=0;for(const m of c)p+=Math.max(s,Math.min(l,m[1]))-Math.max(s,Math.min(l,m[0]));return p}function Ck(c,s,l){const p=[{fixed:-1,stretch:0}];for(const[m,x]of c){const w=p[p.length-1];p.push({fixed:m-w.stretch,stretch:w.stretch}),p.push({fixed:m-w.stretch,stretch:w.stretch+(x-m)})}return p.push({fixed:s+1,stretch:l}),p}function C_(c,s,l,p){return c/s*l+p}function E_(c,s,l,p){return c-s*l/p}mt("Anchor",iu);class I_{constructor(s,l,p,m,x,w,C,I,A,D){var N;if(this.boxStartIndex=s.length,A){let U=w.top,G=w.bottom;const q=w.collisionPadding;q&&(U-=q[1],G+=q[3]);let X=G-U;X>0&&(X=Math.max(10,X),this.circleDiameter=X)}else{const U=!((N=w.image)===null||N===void 0)&&N.content&&(w.image.textFitWidth||w.image.textFitHeight)?KM(w):{x1:w.left,y1:w.top,x2:w.right,y2:w.bottom};U.y1=U.y1*C-I[0],U.y2=U.y2*C+I[2],U.x1=U.x1*C-I[3],U.x2=U.x2*C+I[1];const G=w.collisionPadding;if(G&&(U.x1-=G[0]*C,U.y1-=G[1]*C,U.x2+=G[2]*C,U.y2+=G[3]*C),D){const q=new v(U.x1,U.y1),X=new v(U.x2,U.y1),Q=new v(U.x1,U.y2),ne=new v(U.x2,U.y2),ye=D*Math.PI/180;q._rotate(ye),X._rotate(ye),Q._rotate(ye),ne._rotate(ye),U.x1=Math.min(q.x,X.x,Q.x,ne.x),U.x2=Math.max(q.x,X.x,Q.x,ne.x),U.y1=Math.min(q.y,X.y,Q.y,ne.y),U.y2=Math.max(q.y,X.y,Q.y,ne.y)}s.emplaceBack(l.x,l.y,U.x1,U.y1,U.x2,U.y2,p,m,x)}this.boxEndIndex=s.length}}class f9{constructor(s=[],l=(p,m)=>p<m?-1:p>m?1:0){if(this.data=s,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:l,compare:p}=this,m=l[s];for(;s>0;){const x=s-1>>1,w=l[x];if(p(m,w)>=0)break;l[s]=w,s=x}l[s]=m}_down(s){const{data:l,compare:p}=this,m=this.length>>1,x=l[s];for(;s<m;){let w=1+(s<<1);const C=w+1;if(C<this.length&&p(l[C],l[w])<0&&(w=C),p(l[w],x)>=0)break;l[s]=l[w],s=w}l[s]=x}}function m9(c,s=1,l=!1){const p=Ch.fromPoints(c[0]),m=Math.min(p.width(),p.height());let x=m/2;const w=new f9([],g9),{minX:C,minY:I,maxX:A,maxY:D}=p;if(m===0)return new v(C,I);for(let G=C;G<A;G+=m)for(let q=I;q<D;q+=m)w.push(new kp(G+x,q+x,x,c));let N=(function(G){let q=0,X=0,Q=0;const ne=G[0];for(let ye=0,ue=ne.length,de=ue-1;ye<ue;de=ye++){const Me=ne[ye],Re=ne[de],Ze=Me.x*Re.y-Re.x*Me.y;X+=(Me.x+Re.x)*Ze,Q+=(Me.y+Re.y)*Ze,q+=3*Ze}return new kp(X/q,Q/q,0,G)})(c),U=w.length;for(;w.length;){const G=w.pop();(G.d>N.d||!N.d)&&(N=G,l&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,U)),G.max-N.d<=s||(x=G.h/2,w.push(new kp(G.p.x-x,G.p.y-x,x,c)),w.push(new kp(G.p.x+x,G.p.y-x,x,c)),w.push(new kp(G.p.x-x,G.p.y+x,x,c)),w.push(new kp(G.p.x+x,G.p.y+x,x,c)),U+=4)}return l&&(console.log(`num probes: ${U}`),console.log(`best distance: ${N.d}`)),N.p}function g9(c,s){return s.max-c.max}function kp(c,s,l,p){this.p=new v(c,s),this.h=l,this.d=(function(m,x){let w=!1,C=1/0;for(let I=0;I<x.length;I++){const A=x[I];for(let D=0,N=A.length,U=N-1;D<N;U=D++){const G=A[D],q=A[U];G.y>m.y!=q.y>m.y&&m.x<(q.x-G.x)*(m.y-G.y)/(q.y-G.y)+G.x&&(w=!w),C=Math.min(C,cM(m,G,q))}}return(w?1:-1)*Math.sqrt(C)})(this.p,p),this.max=this.d+this.h*Math.SQRT2}var gn;d.aE=void 0,(gn=d.aE||(d.aE={}))[gn.center=1]="center",gn[gn.left=2]="left",gn[gn.right=3]="right",gn[gn.top=4]="top",gn[gn.bottom=5]="bottom",gn[gn["top-left"]=6]="top-left",gn[gn["top-right"]=7]="top-right",gn[gn["bottom-left"]=8]="bottom-left",gn[gn["bottom-right"]=9]="bottom-right";const eS=Number.POSITIVE_INFINITY;function Ek(c,s){return s[1]!==eS?(function(l,p,m){let x=0,w=0;switch(p=Math.abs(p),m=Math.abs(m),l){case"top-right":case"top-left":case"top":w=m-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-m}switch(l){case"top-right":case"bottom-right":case"right":x=-p;break;case"top-left":case"bottom-left":case"left":x=p}return[x,w]})(c,s[0],s[1]):(function(l,p){let m=0,x=0;p<0&&(p=0);const w=p/Math.SQRT2;switch(l){case"top-right":case"top-left":x=w-7;break;case"bottom-right":case"bottom-left":x=7-w;break;case"bottom":x=7-p;break;case"top":x=p-7}switch(l){case"top-right":case"bottom-right":m=-w;break;case"top-left":case"bottom-left":m=w;break;case"left":m=p;break;case"right":m=-p}return[m,x]})(c,s[0])}function Ik(c,s,l){var p;const m=c.layout,x=(p=m.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(s,{},l);if(x){const C=x.values,I=[];for(let A=0;A<C.length;A+=2){const D=I[A]=C[A],N=C[A+1].map((U=>U*Zr));D.startsWith("top")?N[1]-=7:D.startsWith("bottom")&&(N[1]+=7),I[A+1]=N}return new Cn(I)}const w=m.get("text-variable-anchor");if(w){let C;C=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(s,{},l)*Zr,eS]:m.get("text-offset").evaluate(s,{},l).map((A=>A*Zr));const I=[];for(const A of w)I.push(A,Ek(A,C));return new Cn(I)}return null}function tS(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function y9(c,s,l,p,m,x,w,C,I,A,D,N){let U=x.textMaxSize.evaluate(s,{});U===void 0&&(U=w);const G=c.layers[0].layout,q=G.get("icon-offset").evaluate(s,{},D),X=Pk(l.horizontal),Q=w/24,ne=c.tilePixelRatio*Q,ye=c.tilePixelRatio*U/24,ue=c.tilePixelRatio*C,de=c.tilePixelRatio*G.get("symbol-spacing"),Me=G.get("text-padding")*c.tilePixelRatio,Re=(function(zt,Pt,wt,si=1){const Ji=zt.get("icon-padding").evaluate(Pt,{},wt),zr=Ji&&Ji.values;return[zr[0]*si,zr[1]*si,zr[2]*si,zr[3]*si]})(G,s,D,c.tilePixelRatio),Ze=G.get("text-max-angle")/180*Math.PI,ct=G.get("text-rotation-alignment")!=="viewport"&&G.get("symbol-placement")!=="point",rt=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",at=G.get("symbol-placement"),It=de/2,ot=G.get("icon-text-fit");let lt;p&&ot!=="none"&&(c.allowVerticalPlacement&&l.vertical&&(lt=QM(p,l.vertical,ot,G.get("icon-text-fit-padding"),q,Q)),X&&(p=QM(p,X,ot,G.get("icon-text-fit-padding"),q,Q)));const je=D?N.line.getGranularityForZoomLevel(D.z):1,At=(zt,Pt)=>{Pt.x<0||Pt.x>=Ye||Pt.y<0||Pt.y>=Ye||(function(wt,si,Ji,zr,yn,Js,os,ln,Zi,Wr,cn,un,Un,Ks,Yr,as,Or,Xr,Jr,wr,Bi,ea,Ap,ta,b9){const Dp=wt.addToLineVertexArray(si,Ji);let Eh,zp,Op,Rp,Dk=0,zk=0,Ok=0,Rk=0,cS=-1,uS=-1;const Wl={};let Lk=Jc("");if(wt.allowVerticalPlacement&&zr.vertical){const Pn=ln.layout.get("text-rotate").evaluate(Bi,{},ta)+90;Op=new I_(Zi,si,Wr,cn,un,zr.vertical,Un,Ks,Yr,Pn),os&&(Rp=new I_(Zi,si,Wr,cn,un,os,Or,Xr,Yr,Pn))}if(yn){const Pn=ln.layout.get("icon-rotate").evaluate(Bi,{}),Qs=ln.layout.get("icon-text-fit")!=="none",Ih=Tk(yn,Pn,Ap,Qs),ra=os?Tk(os,Pn,Ap,Qs):void 0;zp=new I_(Zi,si,Wr,cn,un,yn,Or,Xr,!1,Pn),Dk=4*Ih.length;const $h=wt.iconSizeData;let Ja=null;$h.kind==="source"?(Ja=[Zl*ln.layout.get("icon-size").evaluate(Bi,{})],Ja[0]>eu&&cr(`${wt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):$h.kind==="composite"&&(Ja=[Zl*ea.compositeIconSizes[0].evaluate(Bi,{},ta),Zl*ea.compositeIconSizes[1].evaluate(Bi,{},ta)],(Ja[0]>eu||Ja[1]>eu)&&cr(`${wt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),wt.addSymbols(wt.icon,Ih,Ja,wr,Jr,Bi,d.ao.none,si,Dp.lineStartIndex,Dp.lineLength,-1,ta),cS=wt.icon.placedSymbolArray.length-1,ra&&(zk=4*ra.length,wt.addSymbols(wt.icon,ra,Ja,wr,Jr,Bi,d.ao.vertical,si,Dp.lineStartIndex,Dp.lineLength,-1,ta),uS=wt.icon.placedSymbolArray.length-1)}const Fk=Object.keys(zr.horizontal);for(const Pn of Fk){const Qs=zr.horizontal[Pn];if(!Eh){Lk=Jc(Qs.text);const ra=ln.layout.get("text-rotate").evaluate(Bi,{},ta);Eh=new I_(Zi,si,Wr,cn,un,Qs,Un,Ks,Yr,ra)}const Ih=Qs.positionedLines.length===1;if(Ok+=$k(wt,si,Qs,Js,ln,Yr,Bi,as,Dp,zr.vertical?d.ao.horizontal:d.ao.horizontalOnly,Ih?Fk:[Pn],Wl,cS,ea,ta),Ih)break}zr.vertical&&(Rk+=$k(wt,si,zr.vertical,Js,ln,Yr,Bi,as,Dp,d.ao.vertical,["vertical"],Wl,uS,ea,ta));const x9=Eh?Eh.boxStartIndex:wt.collisionBoxArray.length,w9=Eh?Eh.boxEndIndex:wt.collisionBoxArray.length,S9=Op?Op.boxStartIndex:wt.collisionBoxArray.length,T9=Op?Op.boxEndIndex:wt.collisionBoxArray.length,C9=zp?zp.boxStartIndex:wt.collisionBoxArray.length,E9=zp?zp.boxEndIndex:wt.collisionBoxArray.length,I9=Rp?Rp.boxStartIndex:wt.collisionBoxArray.length,$9=Rp?Rp.boxEndIndex:wt.collisionBoxArray.length;let ia=-1;const P_=(Pn,Qs)=>Pn&&Pn.circleDiameter?Math.max(Pn.circleDiameter,Qs):Qs;ia=P_(Eh,ia),ia=P_(Op,ia),ia=P_(zp,ia),ia=P_(Rp,ia);const Nk=ia>-1?1:0;Nk&&(ia*=b9/Zr),wt.glyphOffsetArray.length>=Pp.MAX_GLYPHS&&cr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Bi.sortKey!==void 0&&wt.addToSortKeyRanges(wt.symbolInstances.length,Bi.sortKey);const P9=Ik(ln,Bi,ta),[M9,k9]=(function(Pn,Qs){const Ih=Pn.length,ra=Qs?.values;if(ra?.length>0)for(let $h=0;$h<ra.length;$h+=2){const Ja=ra[$h+1];Pn.emplaceBack(d.aE[ra[$h]],Ja[0],Ja[1])}return[Ih,Pn.length]})(wt.textAnchorOffsets,P9);wt.symbolInstances.emplaceBack(si.x,si.y,Wl.right>=0?Wl.right:-1,Wl.center>=0?Wl.center:-1,Wl.left>=0?Wl.left:-1,Wl.vertical||-1,cS,uS,Lk,x9,w9,S9,T9,C9,E9,I9,$9,Wr,Ok,Rk,Dk,zk,Nk,0,Un,ia,M9,k9)})(c,Pt,zt,l,p,m,lt,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,ne,[Me,Me,Me,Me],ct,I,ue,Re,rt,q,s,x,A,D,w)};if(at==="line")for(const zt of vk(s.geometry,0,0,Ye,Ye)){const Pt=Th(zt,je),wt=p9(Pt,de,Ze,l.vertical||X,p,24,ye,c.overscaling,Ye);for(const si of wt)X&&v9(c,X.text,It,si)||At(Pt,si)}else if(at==="line-center"){for(const zt of s.geometry)if(zt.length>1){const Pt=Th(zt,je),wt=d9(Pt,Ze,l.vertical||X,p,24,ye);wt&&At(Pt,wt)}}else if(s.type==="Polygon")for(const zt of ah(s.geometry,0)){const Pt=m9(zt,16);At(Th(zt[0],je,!0),new iu(Pt.x,Pt.y,0))}else if(s.type==="LineString")for(const zt of s.geometry){const Pt=Th(zt,je);At(Pt,new iu(Pt[0].x,Pt[0].y,0))}else if(s.type==="Point")for(const zt of s.geometry)for(const Pt of zt)At([Pt],new iu(Pt.x,Pt.y,0))}function $k(c,s,l,p,m,x,w,C,I,A,D,N,U,G,q){const X=(function(ye,ue,de,Me,Re,Ze,ct,rt){const at=Me.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,It=[];for(const ot of ue.positionedLines)for(const lt of ot.positionedGlyphs){if(!lt.rect)continue;const je=lt.rect||{};let At=4,zt=!0,Pt=1,wt=0;const si=(Re||rt)&&lt.vertical,Ji=lt.metrics.advance*lt.scale/2;if(rt&&ue.verticalizable&&(wt=ot.lineOffset/2-(lt.imageName?-(Zr-lt.metrics.width*lt.scale)/2:(lt.scale-1)*Zr)),lt.imageName){const Xr=ct[lt.imageName];zt=Xr.sdf,Pt=Xr.pixelRatio,At=1/Pt}const zr=Re?[lt.x+Ji,lt.y]:[0,0];let yn=Re?[0,0]:[lt.x+Ji+de[0],lt.y+de[1]-wt],Js=[0,0];si&&(Js=yn,yn=[0,0]);const os=lt.metrics.isDoubleResolution?2:1,ln=(lt.metrics.left-At)*lt.scale-Ji+yn[0],Zi=(-lt.metrics.top-At)*lt.scale+yn[1],Wr=ln+je.w/os*lt.scale/Pt,cn=Zi+je.h/os*lt.scale/Pt,un=new v(ln,Zi),Un=new v(Wr,Zi),Ks=new v(ln,cn),Yr=new v(Wr,cn);if(si){const Xr=new v(-Ji,Ji- -17),Jr=-Math.PI/2,wr=12-Ji,Bi=new v(22-wr,-(lt.imageName?wr:0)),ea=new v(...Js);un._rotateAround(Jr,Xr)._add(Bi)._add(ea),Un._rotateAround(Jr,Xr)._add(Bi)._add(ea),Ks._rotateAround(Jr,Xr)._add(Bi)._add(ea),Yr._rotateAround(Jr,Xr)._add(Bi)._add(ea)}if(at){const Xr=Math.sin(at),Jr=Math.cos(at),wr=[Jr,-Xr,Xr,Jr];un._matMult(wr),Un._matMult(wr),Ks._matMult(wr),Yr._matMult(wr)}const as=new v(0,0),Or=new v(0,0);It.push({tl:un,tr:Un,bl:Ks,br:Yr,tex:je,writingMode:ue.writingMode,glyphOffset:zr,sectionIndex:lt.sectionIndex,isSDF:zt,pixelOffsetTL:as,pixelOffsetBR:Or,minFontScaleX:0,minFontScaleY:0})}return It})(0,l,C,m,x,w,p,c.allowVerticalPlacement),Q=c.textSizeData;let ne=null;Q.kind==="source"?(ne=[Zl*m.layout.get("text-size").evaluate(w,{})],ne[0]>eu&&cr(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Q.kind==="composite"&&(ne=[Zl*G.compositeTextSizes[0].evaluate(w,{},q),Zl*G.compositeTextSizes[1].evaluate(w,{},q)],(ne[0]>eu||ne[1]>eu)&&cr(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,X,ne,C,x,w,A,s,I.lineStartIndex,I.lineLength,U,q);for(const ye of D)N[ye]=c.text.placedSymbolArray.length-1;return 4*X.length}function Pk(c){for(const s in c)return c[s];return null}function v9(c,s,l,p){const m=c.compareText;if(s in m){const x=m[s];for(let w=x.length-1;w>=0;w--)if(p.dist(x[w])<l)return!0}else m[s]=[];return m[s].push(p),!1}const Mk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class iS{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,p]=new Uint8Array(s,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=p>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const x=Mk[15&p];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(s,2,1),[C]=new Uint32Array(s,4,1);return new iS(C,w,x,s)}constructor(s,l=64,p=Float64Array,m){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=p,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const x=Mk.indexOf(this.ArrayType),w=2*s*this.ArrayType.BYTES_PER_ELEMENT,C=s*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-C%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${p}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+I,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+w+C+I),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+I,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=s)}add(s,l){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=s,this.coords[this._pos++]=l,p}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return rS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,l,p,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:C}=this,I=[0,x.length-1,0],A=[];for(;I.length;){const D=I.pop()||0,N=I.pop()||0,U=I.pop()||0;if(N-U<=C){for(let Q=U;Q<=N;Q++){const ne=w[2*Q],ye=w[2*Q+1];ne>=s&&ne<=p&&ye>=l&&ye<=m&&A.push(x[Q])}continue}const G=U+N>>1,q=w[2*G],X=w[2*G+1];q>=s&&q<=p&&X>=l&&X<=m&&A.push(x[G]),(D===0?s<=q:l<=X)&&(I.push(U),I.push(G-1),I.push(1-D)),(D===0?p>=q:m>=X)&&(I.push(G+1),I.push(N),I.push(1-D))}return A}within(s,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:x,nodeSize:w}=this,C=[0,m.length-1,0],I=[],A=p*p;for(;C.length;){const D=C.pop()||0,N=C.pop()||0,U=C.pop()||0;if(N-U<=w){for(let Q=U;Q<=N;Q++)Ak(x[2*Q],x[2*Q+1],s,l)<=A&&I.push(m[Q]);continue}const G=U+N>>1,q=x[2*G],X=x[2*G+1];Ak(q,X,s,l)<=A&&I.push(m[G]),(D===0?s-p<=q:l-p<=X)&&(C.push(U),C.push(G-1),C.push(1-D)),(D===0?s+p>=q:l+p>=X)&&(C.push(G+1),C.push(N),C.push(1-D))}return I}}function rS(c,s,l,p,m,x){if(m-p<=l)return;const w=p+m>>1;kk(c,s,w,p,m,x),rS(c,s,l,p,w-1,1-x),rS(c,s,l,w+1,m,1-x)}function kk(c,s,l,p,m,x){for(;m>p;){if(m-p>600){const A=m-p+1,D=l-p+1,N=Math.log(A),U=.5*Math.exp(2*N/3),G=.5*Math.sqrt(N*U*(A-U)/A)*(D-A/2<0?-1:1);kk(c,s,l,Math.max(p,Math.floor(l-D*U/A+G)),Math.min(m,Math.floor(l+(A-D)*U/A+G)),x)}const w=s[2*l+x];let C=p,I=m;for(Gg(c,s,p,l),s[2*m+x]>w&&Gg(c,s,p,m);C<I;){for(Gg(c,s,C,I),C++,I--;s[2*C+x]<w;)C++;for(;s[2*I+x]>w;)I--}s[2*p+x]===w?Gg(c,s,p,I):(I++,Gg(c,s,I,m)),I<=l&&(p=I+1),l<=I&&(m=I-1)}}function Gg(c,s,l,p){nS(c,l,p),nS(s,2*l,2*p),nS(s,2*l+1,2*p+1)}function nS(c,s,l){const p=c[s];c[s]=c[l],c[l]=p}function Ak(c,s,l,p){const m=c-l,x=s-p;return m*m+x*x}var sS;d.cx=void 0,(sS=d.cx||(d.cx={})).create="create",sS.load="load",sS.fullLoad="fullLoad";let $_=null,qg=[];const oS=1e3/60,aS="loadTime",lS="fullLoadTime",_9={mark(c){performance.mark(c)},frame(c){const s=c;$_!=null&&qg.push(s-$_),$_=s},clearMetrics(){$_=null,qg=[],performance.clearMeasures(aS),performance.clearMeasures(lS);for(const c in d.cx)performance.clearMarks(d.cx[c])},getPerformanceMetrics(){performance.measure(aS,d.cx.create,d.cx.load),performance.measure(lS,d.cx.create,d.cx.fullLoad);const c=performance.getEntriesByName(aS)[0].duration,s=performance.getEntriesByName(lS)[0].duration,l=qg.length,p=1/(qg.reduce(((x,w)=>x+w),0)/l/1e3),m=qg.filter((x=>x>oS)).reduce(((x,w)=>x+(w-oS)/oS),0);return{loadTime:c,fullLoadTime:s,fps:p,percentDroppedFrames:m/(l+m)*100,totalFrames:l}}};d.$=Ye,d.A=Pe,d.B=function([c,s,l]){return s+=90,s*=Math.PI/180,l*=Math.PI/180,{x:c*Math.cos(s)*Math.sin(l),y:c*Math.sin(s)*Math.sin(l),z:c*Math.cos(l)}},d.C=Io,d.D=Tt,d.E=St,d.F=ki,d.G=yh,d.H=function(c){if(Cl==null){const s=c.navigator?c.navigator.userAgent:null;Cl=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Cl},d.I=V2,d.J=class{constructor(c,s){this.target=c,this.mapId=s,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new c9((()=>this.process())),this.subscription=Da(this.target,"message",(l=>this.receive(l)),!1),this.globalScope=xo(self)?c:window}registerMessageHandler(c,s){this.messageHandlers[c]=s}sendAsync(c,s){return new Promise(((l,p)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10),x=s?Da(s.signal,"abort",(()=>{x?.unsubscribe(),delete this.resolveRejects[m];const I={id:m,type:"<cancel>",origin:location.origin,targetMapId:c.targetMapId,sourceMapId:this.mapId};this.target.postMessage(I)}),u9):null;this.resolveRejects[m]={resolve:I=>{x?.unsubscribe(),l(I)},reject:I=>{x?.unsubscribe(),p(I)}};const w=[],C=Object.assign(Object.assign({},c),{id:m,sourceMapId:this.mapId,origin:location.origin,data:qc(c.data,w)});this.target.postMessage(C,{transfer:w})}))}receive(c){const s=c.data,l=s.id;if(!(s.origin!=="file://"&&location.origin!=="file://"&&s.origin!=="resource://android"&&location.origin!=="resource://android"&&s.origin!==location.origin||s.targetMapId&&this.mapId!==s.targetMapId)){if(s.type==="<cancel>"){delete this.tasks[l];const p=this.abortControllers[l];return delete this.abortControllers[l],void(p&&p.abort())}if(xo(self)||s.mustQueue)return this.tasks[l]=s,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,s)}}process(){if(this.taskQueue.length===0)return;const c=this.taskQueue.shift(),s=this.tasks[c];delete this.tasks[c],this.taskQueue.length>0&&this.invoker.trigger(),s&&this.processTask(c,s)}processTask(c,s){return a(this,void 0,void 0,(function*(){if(s.type==="<response>"){const m=this.resolveRejects[c];return delete this.resolveRejects[c],m?void(s.error?m.reject(Ul(s.error)):m.resolve(Ul(s.data))):void 0}if(!this.messageHandlers[s.type])return void this.completeTask(c,new Error(`Could not find a registered handler for ${s.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const l=Ul(s.data),p=new AbortController;this.abortControllers[c]=p;try{const m=yield this.messageHandlers[s.type](s.sourceMapId,l,p);this.completeTask(c,null,m)}catch(m){this.completeTask(c,m)}}))}completeTask(c,s,l){const p=[];delete this.abortControllers[c];const m={id:c,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:s?qc(s):null,data:qc(l,p)};this.target.postMessage(m,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},d.K=K,d.L=function(){var c=new Pe(16);return Pe!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},d.M=function(c,s,l){var p,m,x,w,C,I,A,D,N,U,G,q,X=l[0],Q=l[1],ne=l[2];return s===c?(c[12]=s[0]*X+s[4]*Q+s[8]*ne+s[12],c[13]=s[1]*X+s[5]*Q+s[9]*ne+s[13],c[14]=s[2]*X+s[6]*Q+s[10]*ne+s[14],c[15]=s[3]*X+s[7]*Q+s[11]*ne+s[15]):(m=s[1],x=s[2],w=s[3],C=s[4],I=s[5],A=s[6],D=s[7],N=s[8],U=s[9],G=s[10],q=s[11],c[0]=p=s[0],c[1]=m,c[2]=x,c[3]=w,c[4]=C,c[5]=I,c[6]=A,c[7]=D,c[8]=N,c[9]=U,c[10]=G,c[11]=q,c[12]=p*X+C*Q+N*ne+s[12],c[13]=m*X+I*Q+U*ne+s[13],c[14]=x*X+A*Q+G*ne+s[14],c[15]=w*X+D*Q+q*ne+s[15]),c},d.N=function(c,s,l){var p=l[0],m=l[1],x=l[2];return c[0]=s[0]*p,c[1]=s[1]*p,c[2]=s[2]*p,c[3]=s[3]*p,c[4]=s[4]*m,c[5]=s[5]*m,c[6]=s[6]*m,c[7]=s[7]*m,c[8]=s[8]*x,c[9]=s[9]*x,c[10]=s[10]*x,c[11]=s[11]*x,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},d.O=function(c,s,l){var p=s[0],m=s[1],x=s[2],w=s[3],C=s[4],I=s[5],A=s[6],D=s[7],N=s[8],U=s[9],G=s[10],q=s[11],X=s[12],Q=s[13],ne=s[14],ye=s[15],ue=l[0],de=l[1],Me=l[2],Re=l[3];return c[0]=ue*p+de*C+Me*N+Re*X,c[1]=ue*m+de*I+Me*U+Re*Q,c[2]=ue*x+de*A+Me*G+Re*ne,c[3]=ue*w+de*D+Me*q+Re*ye,c[4]=(ue=l[4])*p+(de=l[5])*C+(Me=l[6])*N+(Re=l[7])*X,c[5]=ue*m+de*I+Me*U+Re*Q,c[6]=ue*x+de*A+Me*G+Re*ne,c[7]=ue*w+de*D+Me*q+Re*ye,c[8]=(ue=l[8])*p+(de=l[9])*C+(Me=l[10])*N+(Re=l[11])*X,c[9]=ue*m+de*I+Me*U+Re*Q,c[10]=ue*x+de*A+Me*G+Re*ne,c[11]=ue*w+de*D+Me*q+Re*ye,c[12]=(ue=l[12])*p+(de=l[13])*C+(Me=l[14])*N+(Re=l[15])*X,c[13]=ue*m+de*I+Me*U+Re*Q,c[14]=ue*x+de*A+Me*G+Re*ne,c[15]=ue*w+de*D+Me*q+Re*ye,c},d.P=v,d.Q=function(c,s){const l={};for(let p=0;p<s.length;p++){const m=s[p];m in c&&(l[m]=c[m])}return l},d.R=ss,d.S=tu,d.T=A2,d.U=ck,d.V=lk,d.W=pe,d.X=be,d.Y=Ec,d.Z=Xs,d._=a,d.a=Y,d.a$=ge,d.a0=function(c,s){var l,p,m,x,w;if(!c)return s??{};if(!s)return c;let C=Object.assign({},c);if(s.removeAll&&(C={removeAll:!0}),s.remove){const I=new Set(s.remove);C.add&&(C.add=C.add.filter((D=>!I.has(D.id)))),C.update&&(C.update=C.update.filter((D=>!I.has(D.id))));const A=new Set(((l=c.add)!==null&&l!==void 0?l:[]).map((D=>D.id)));s.remove=s.remove.filter((D=>!A.has(D)))}if(s.remove){const I=new Set(C.remove?C.remove.concat(s.remove):s.remove);C.remove=Array.from(I.values())}if(s.add){const I=C.add?C.add.concat(s.add):s.add,A=new Map(I.map((D=>[D.id,D])));C.add=Array.from(A.values())}if(s.update){const I=new Map((p=C.update)===null||p===void 0?void 0:p.map((A=>[A.id,A])));for(const A of s.update){const D=(m=I.get(A.id))!==null&&m!==void 0?m:{id:A.id};A.newGeometry&&(D.newGeometry=A.newGeometry),A.addOrUpdateProperties&&(D.addOrUpdateProperties=((x=D.addOrUpdateProperties)!==null&&x!==void 0?x:[]).concat(A.addOrUpdateProperties)),A.removeProperties&&(D.removeProperties=((w=D.removeProperties)!==null&&w!==void 0?w:[]).concat(A.removeProperties)),A.removeAllProperties&&(D.removeAllProperties=!0),I.set(A.id,D)}C.update=Array.from(I.values())}return C.remove&&C.add&&(C.remove=C.remove.filter((I=>C.add.findIndex((A=>A.id===I))===-1))),C},d.a1=Ug,d.a2=Ch,d.a3=25,d.a4=Q2,d.a5=c=>{const s=window.document.createElement("video");return s.muted=!0,new Promise((l=>{s.onloadstart=()=>{l(s)};for(const p of c){const m=window.document.createElement("source");Ae(p)||(s.crossOrigin="Anonymous"),m.src=p,s.appendChild(m)}}))},d.a6=it,d.a7=function(){return Ls++},d.a8=B,d.a9=Pp,d.aA=function(c){let s=1/0,l=1/0,p=-1/0,m=-1/0;for(const x of c)s=Math.min(s,x.x),l=Math.min(l,x.y),p=Math.max(p,x.x),m=Math.max(m,x.y);return[s,l,p,m]},d.aB=Zr,d.aC=bt,d.aD=function(c,s,l,p,m=!1){if(!l[0]&&!l[1])return[0,0];const x=m?p==="map"?-c.bearingInRadians:0:p==="viewport"?c.bearingInRadians:0;if(x){const w=Math.sin(x),C=Math.cos(x);l=[l[0]*C-l[1]*w,l[0]*w+l[1]*C]}return[m?l[0]:bt(s,l[0],c.zoom),m?l[1]:bt(s,l[1],c.zoom)]},d.aF=H2,d.aG=tS,d.aH=q2,d.aI=iS,d.aJ=rr,d.aK=v_,d.aL=ae,d.aM=Ut,d.aN=Ci,d.aO=bo,d.aP=za,d.aQ=hk,d.aR=et,d.aS=ft,d.aT=function(c){var s=new Pe(3);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s},d.aU=function(c,s,l){return c[0]=s[0]-l[0],c[1]=s[1]-l[1],c[2]=s[2]-l[2],c},d.aV=function(c,s){var l=s[0],p=s[1],m=s[2],x=l*l+p*p+m*m;return x>0&&(x=1/Math.sqrt(x)),c[0]=s[0]*x,c[1]=s[1]*x,c[2]=s[2]*x,c},d.aW=We,d.aX=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]},d.aY=function(c,s,l){return c[0]=s[0]*l[0],c[1]=s[1]*l[1],c[2]=s[2]*l[2],c[3]=s[3]*l[3],c},d.aZ=qe,d.a_=function(c,s,l){const p=s[0]*l[0]+s[1]*l[1]+s[2]*l[2];return p===0?null:(-(c[0]*l[0]+c[1]*l[1]+c[2]*l[2])-l[3])/p},d.aa=Nl,d.ab=Qo,d.ac=mk,d.ad=function(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((l,p,m,x)=>{const w=m||x;return s[p]=!w||w.toLowerCase(),""})),s["max-age"]){const l=parseInt(s["max-age"],10);isNaN(l)?delete s["max-age"]:s["max-age"]=l}return s},d.ae=El,d.af=function(c){return Math.pow(2,c)},d.ag=ke,d.ah=sn,d.ai=85.051129,d.aj=uk,d.ak=function(c){return Math.log(c)/Math.LN2},d.al=function(c){var s=c[0],l=c[1];return s*s+l*l},d.am=function(c,s){const l=[];for(const p in c)p in s||l.push(p);return l},d.an=function(c,s){let l=0,p=0;if(c.kind==="constant")p=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:m,minZoom:x,maxZoom:w}=c,C=m?sn(an.interpolationFactor(m,s,x,w),0,1):0;c.kind==="camera"?p=Io.number(c.minSize,c.maxSize,C):l=C}return{uSizeT:l,uSize:p}},d.ap=function(c,{uSize:s,uSizeT:l},{lowerSize:p,upperSize:m}){return c.kind==="source"?p/Zl:c.kind==="composite"?Io.number(p/Zl,m/Zl,l):s},d.aq=function(c,s){var l=s[0],p=s[1],m=s[2],x=s[3],w=s[4],C=s[5],I=s[6],A=s[7],D=s[8],N=s[9],U=s[10],G=s[11],q=s[12],X=s[13],Q=s[14],ne=s[15],ye=l*C-p*w,ue=l*I-m*w,de=l*A-x*w,Me=p*I-m*C,Re=p*A-x*C,Ze=m*A-x*I,ct=D*X-N*q,rt=D*Q-U*q,at=D*ne-G*q,It=N*Q-U*X,ot=N*ne-G*X,lt=U*ne-G*Q,je=ye*lt-ue*ot+de*It+Me*at-Re*rt+Ze*ct;return je?(c[0]=(C*lt-I*ot+A*It)*(je=1/je),c[1]=(m*ot-p*lt-x*It)*je,c[2]=(X*Ze-Q*Re+ne*Me)*je,c[3]=(U*Re-N*Ze-G*Me)*je,c[4]=(I*at-w*lt-A*rt)*je,c[5]=(l*lt-m*at+x*rt)*je,c[6]=(Q*de-q*Ze-ne*ue)*je,c[7]=(D*Ze-U*de+G*ue)*je,c[8]=(w*ot-C*at+A*ct)*je,c[9]=(p*at-l*ot-x*ct)*je,c[10]=(q*Re-X*de+ne*ye)*je,c[11]=(N*de-D*Re-G*ye)*je,c[12]=(C*rt-w*It-I*ct)*je,c[13]=(l*It-p*rt+m*ct)*je,c[14]=(X*ue-q*Me-Q*ye)*je,c[15]=(D*Me-N*ue+U*ye)*je,c):null},d.ar=yt,d.as=function(c){var s=c[0],l=c[1];return Math.sqrt(s*s+l*l)},d.at=function(c){return c[0]=0,c[1]=0,c},d.au=function(c,s,l){return c[0]=s[0]*l,c[1]=s[1]*l,c},d.av=Z2,d.aw=De,d.ax=function(c,s,l,p){const m=s.y-c.y,x=s.x-c.x,w=p.y-l.y,C=p.x-l.x,I=w*x-C*m;if(I===0)return null;const A=(C*(c.y-l.y)-w*(c.x-l.x))/I;return new v(c.x+A*x,c.y+A*m)},d.ay=vk,d.az=aM,d.b=wo,d.b$=class extends _{},d.b0=function(c,s,l){return c[0]=s[0]*l,c[1]=s[1]*l,c[2]=s[2]*l,c[3]=s[3]*l,c},d.b1=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]},d.b2=pk,d.b3=Mp,d.b4=function(c,s,l,p,m){var x=1/Math.tan(s/2);if(c[0]=x/l,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=x,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,m!=null&&m!==1/0){var w=1/(p-m);c[10]=(m+p)*w,c[14]=2*m*p*w}else c[10]=-1,c[14]=-2*p;return c},d.b5=function(c){var s=new Pe(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},d.b6=function(c,s,l){var p=Math.sin(l),m=Math.cos(l),x=s[0],w=s[1],C=s[2],I=s[3],A=s[4],D=s[5],N=s[6],U=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=x*m+A*p,c[1]=w*m+D*p,c[2]=C*m+N*p,c[3]=I*m+U*p,c[4]=A*m-x*p,c[5]=D*m-w*p,c[6]=N*m-C*p,c[7]=U*m-I*p,c},d.b7=function(c,s,l){var p=Math.sin(l),m=Math.cos(l),x=s[4],w=s[5],C=s[6],I=s[7],A=s[8],D=s[9],N=s[10],U=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=x*m+A*p,c[5]=w*m+D*p,c[6]=C*m+N*p,c[7]=I*m+U*p,c[8]=A*m-x*p,c[9]=D*m-w*p,c[10]=N*m-C*p,c[11]=U*m-I*p,c},d.b8=function(){const c=new Float32Array(16);return ke(c),c},d.b9=function(){const c=new Float64Array(16);return ke(c),c},d.bA=function(c,s){const l=Dt(c,360),p=Dt(s,360),m=p-l,x=p>l?m-360:m+360;return Math.abs(m)<Math.abs(x)?m:x},d.bB=function(c){return c[0]=0,c[1]=0,c[2]=0,c},d.bC=function(c,s,l,p){const m=Math.sqrt(c*c+s*s),x=Math.sqrt(l*l+p*p);c/=m,s/=m,l/=x,p/=x;const w=Math.acos(c*l+s*p);return-s*l+c*p>0?w:-w},d.bD=function(c,s){const l=Dt(c,2*Math.PI),p=Dt(s,2*Math.PI);return Math.min(Math.abs(l-p),Math.abs(l-p+2*Math.PI),Math.abs(l-p-2*Math.PI))},d.bE=function(){const c={},s=Te.$version;for(const l in Te.$root){const p=Te.$root[l];if(p.required){let m=null;m=l==="version"?s:p.type==="array"?[]:{},m!=null&&(c[l]=m)}}return c},d.bF=hp,d.bG=fe,d.bH=function c(s,l){if(Array.isArray(s)){if(!Array.isArray(l)||s.length!==l.length)return!1;for(let p=0;p<s.length;p++)if(!c(s[p],l[p]))return!1;return!0}if(typeof s=="object"&&s!==null&&l!==null){if(typeof l!="object"||Object.keys(s).length!==Object.keys(l).length)return!1;for(const p in s)if(!c(s[p],l[p]))return!1;return!0}return s===l},d.bI=function(c){c=c.slice();const s=Object.create(null);for(let l=0;l<c.length;l++)s[c[l].id]=c[l];for(let l=0;l<c.length;l++)"ref"in c[l]&&(c[l]=Jt(c[l],s[c[l].ref]));return c},d.bJ=function(c){if(c.type==="custom")return new l9(c);switch(c.type){case"background":return new s9(c);case"circle":return new G8(c);case"color-relief":return new X8(c);case"fill":return new hj(c);case"fill-extrusion":return new wj(c);case"heatmap":return new H8(c);case"hillshade":return new W8(c);case"line":return new Pj(c);case"raster":return new a9(c);case"symbol":return new S_(c)}},d.bK=ts,d.bL=function(c,s){if(!c)return[{command:"setStyle",args:[s]}];let l=[];try{if(!$t(c.version,s.version))return[{command:"setStyle",args:[s]}];$t(c.center,s.center)||l.push({command:"setCenter",args:[s.center]}),$t(c.state,s.state)||l.push({command:"setGlobalState",args:[s.state]}),$t(c.centerAltitude,s.centerAltitude)||l.push({command:"setCenterAltitude",args:[s.centerAltitude]}),$t(c.zoom,s.zoom)||l.push({command:"setZoom",args:[s.zoom]}),$t(c.bearing,s.bearing)||l.push({command:"setBearing",args:[s.bearing]}),$t(c.pitch,s.pitch)||l.push({command:"setPitch",args:[s.pitch]}),$t(c.roll,s.roll)||l.push({command:"setRoll",args:[s.roll]}),$t(c.sprite,s.sprite)||l.push({command:"setSprite",args:[s.sprite]}),$t(c.glyphs,s.glyphs)||l.push({command:"setGlyphs",args:[s.glyphs]}),$t(c.transition,s.transition)||l.push({command:"setTransition",args:[s.transition]}),$t(c.light,s.light)||l.push({command:"setLight",args:[s.light]}),$t(c.terrain,s.terrain)||l.push({command:"setTerrain",args:[s.terrain]}),$t(c.sky,s.sky)||l.push({command:"setSky",args:[s.sky]}),$t(c.projection,s.projection)||l.push({command:"setProjection",args:[s.projection]});const p={},m=[];(function(w,C,I,A){let D;for(D in C=C||{},w=w||{})Object.prototype.hasOwnProperty.call(w,D)&&(Object.prototype.hasOwnProperty.call(C,D)||Mr(D,I,A));for(D in C)Object.prototype.hasOwnProperty.call(C,D)&&(Object.prototype.hasOwnProperty.call(w,D)?$t(w[D],C[D])||(w[D].type==="geojson"&&C[D].type==="geojson"&&ur(w,C,D)?jt(I,{command:"setGeoJSONSourceData",args:[D,C[D].data]}):kr(D,C,I,A)):Oi(D,C,I))})(c.sources,s.sources,m,p);const x=[];c.layers&&c.layers.forEach((w=>{"source"in w&&p[w.source]?l.push({command:"removeLayer",args:[w.id]}):x.push(w)})),l=l.concat(m),(function(w,C,I){C=C||[];const A=(w=w||[]).map(li),D=C.map(li),N=w.reduce(yr,{}),U=C.reduce(yr,{}),G=A.slice(),q=Object.create(null);let X,Q,ne,ye,ue;for(let de=0,Me=0;de<A.length;de++)X=A[de],Object.prototype.hasOwnProperty.call(U,X)?Me++:(jt(I,{command:"removeLayer",args:[X]}),G.splice(G.indexOf(X,Me),1));for(let de=0,Me=0;de<D.length;de++)X=D[D.length-1-de],G[G.length-1-de]!==X&&(Object.prototype.hasOwnProperty.call(N,X)?(jt(I,{command:"removeLayer",args:[X]}),G.splice(G.lastIndexOf(X,G.length-Me),1)):Me++,ye=G[G.length-de],jt(I,{command:"addLayer",args:[U[X],ye]}),G.splice(G.length-de,0,X),q[X]=!0);for(let de=0;de<D.length;de++)if(X=D[de],Q=N[X],ne=U[X],!q[X]&&!$t(Q,ne))if($t(Q.source,ne.source)&&$t(Q["source-layer"],ne["source-layer"])&&$t(Q.type,ne.type)){for(ue in ti(Q.layout,ne.layout,I,X,null,"setLayoutProperty"),ti(Q.paint,ne.paint,I,X,null,"setPaintProperty"),$t(Q.filter,ne.filter)||jt(I,{command:"setFilter",args:[X,ne.filter]}),$t(Q.minzoom,ne.minzoom)&&$t(Q.maxzoom,ne.maxzoom)||jt(I,{command:"setLayerZoomRange",args:[X,ne.minzoom,ne.maxzoom]}),Q)Object.prototype.hasOwnProperty.call(Q,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?ti(Q[ue],ne[ue],I,X,ue.slice(6),"setPaintProperty"):$t(Q[ue],ne[ue])||jt(I,{command:"setLayerProperty",args:[X,ue,ne[ue]]}));for(ue in ne)Object.prototype.hasOwnProperty.call(ne,ue)&&!Object.prototype.hasOwnProperty.call(Q,ue)&&ue!=="layout"&&ue!=="paint"&&ue!=="filter"&&ue!=="metadata"&&ue!=="minzoom"&&ue!=="maxzoom"&&(ue.indexOf("paint.")===0?ti(Q[ue],ne[ue],I,X,ue.slice(6),"setPaintProperty"):$t(Q[ue],ne[ue])||jt(I,{command:"setLayerProperty",args:[X,ue,ne[ue]]}))}else jt(I,{command:"removeLayer",args:[X]}),ye=G[G.lastIndexOf(X)+1],jt(I,{command:"addLayer",args:[ne,ye]})})(x,s.layers,l)}catch(p){console.warn("Unable to compute style diff:",p),l=[{command:"setStyle",args:[s]}]}return l},d.bM=function(c){const s=[],l=c.id;return l===void 0&&s.push({message:`layers.${l}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${l}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),s},d.bN=Tc,d.bO=Cc,d.bP=class extends $n{constructor(c,s){super(c,s),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},d.bQ=Dr,d.bR=class extends $n{constructor(c,s){super(c,s),this.current=xs}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let s=1;s<16;s++)if(c[s]!==this.current[s]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},d.bS=br,d.bT=class extends $n{constructor(c,s){super(c,s),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},d.bU=class extends $n{constructor(c,s){super(c,s),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},d.bV=Ie,d.bW=function(c,s){var l=Math.sin(s),p=Math.cos(s);return c[0]=p,c[1]=l,c[2]=0,c[3]=-l,c[4]=p,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},d.bX=function(c,s,l){var p=s[0],m=s[1],x=s[2];return c[0]=p*l[0]+m*l[3]+x*l[6],c[1]=p*l[1]+m*l[4]+x*l[7],c[2]=p*l[2]+m*l[5]+x*l[8],c},d.bY=function(c,s,l,p,m,x,w){var C=1/(s-l),I=1/(p-m),A=1/(x-w);return c[0]=-2*C,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*I,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*A,c[11]=0,c[12]=(s+l)*C,c[13]=(m+p)*I,c[14]=(w+x)*A,c[15]=1,c},d.bZ=class extends $n{constructor(c,s){super(c,s),this.current=new Array}set(c){if(c!=this.current){this.current=c;const s=new Float32Array(4*c.length);for(let l=0;l<c.length;l++)s[4*l]=c[l].r,s[4*l+1]=c[l].g,s[4*l+2]=c[l].b,s[4*l+3]=c[l].a;this.gl.uniform4fv(this.location,s)}}},d.b_=class extends $n{constructor(c,s){super(c,s),this.current=new Array}set(c){if(c!=this.current){this.current=c;const s=new Float32Array(c);this.gl.uniform1fv(this.location,s)}}},d.ba=function(){return new Float64Array(16)},d.bb=function(c,s,l){const p=new Float64Array(4);return Qe(p,c,s-90,l),p},d.bc=function(c,s,l,p){var m,x,w,C,I,A=s[0],D=s[1],N=s[2],U=s[3],G=l[0],q=l[1],X=l[2],Q=l[3];return(x=A*G+D*q+N*X+U*Q)<0&&(x=-x,G=-G,q=-q,X=-X,Q=-Q),1-x>Ce?(m=Math.acos(x),w=Math.sin(m),C=Math.sin((1-p)*m)/w,I=Math.sin(p*m)/w):(C=1-p,I=p),c[0]=C*A+I*G,c[1]=C*D+I*q,c[2]=C*N+I*X,c[3]=C*U+I*Q,c},d.bd=function(c){const s=new Float64Array(9);var l,p,m,x,w,C,I,A,D,N,U,G,q,X,Q,ne,ye,ue;N=(m=(p=c)[0])*(I=m+m),U=(x=p[1])*I,q=(w=p[2])*I,X=w*(A=x+x),ne=(C=p[3])*I,ye=C*A,ue=C*(D=w+w),(l=s)[0]=1-(G=x*A)-(Q=w*D),l[3]=U-ue,l[6]=q+ye,l[1]=U+ue,l[4]=1-N-Q,l[7]=X-ne,l[2]=q-ye,l[5]=X+ne,l[8]=1-N-G;const de=za(-Math.asin(sn(s[2],-1,1)));let Me,Re;return Math.hypot(s[5],s[8])<.001?(Me=0,Re=-za(Math.atan2(s[3],s[4]))):(Me=za(s[5]===0&&s[8]===0?0:Math.atan2(s[5],s[8])),Re=za(s[1]===0&&s[0]===0?0:Math.atan2(s[1],s[0]))),{roll:Me,pitch:de+90,bearing:Re}},d.be=function(c,s){return c.roll==s.roll&&c.pitch==s.pitch&&c.bearing==s.bearing},d.bf=ei,d.bg=Wa,d.bh=Cp,d.bi=Rg,d.bj=Tp,d.bk=Si,d.bl=Vr,d.bm=fn,d.bn=function(c,s,l,p,m){return Si(p,m,sn((c-s)/(l-s),0,1))},d.bo=Dt,d.bp=function(){return new Float64Array(3)},d.bq=function(c,s,l,p){return c[0]=s[0]+l[0]*p,c[1]=s[1]+l[1]*p,c[2]=s[2]+l[2]*p,c},d.br=Qe,d.bs=function(c,s,l){var p=l[0],m=l[1],x=l[2],w=l[3],C=s[0],I=s[1],A=s[2],D=m*A-x*I,N=x*C-p*A,U=p*I-m*C;return c[0]=C+w*(D+=D)+m*(U+=U)-x*(N+=N),c[1]=I+w*N+x*D-p*U,c[2]=A+w*U+p*N-m*D,c},d.bt=function(c,s,l){const p=(m=[c[0],c[1],c[2],s[0],s[1],s[2],l[0],l[1],l[2]])[0]*((D=m[8])*(w=m[4])-(C=m[5])*(A=m[7]))+m[1]*(-D*(x=m[3])+C*(I=m[6]))+m[2]*(A*x-w*I);var m,x,w,C,I,A,D;if(p===0)return null;const N=We([],[s[0],s[1],s[2]],[l[0],l[1],l[2]]),U=We([],[l[0],l[1],l[2]],[c[0],c[1],c[2]]),G=We([],[c[0],c[1],c[2]],[s[0],s[1],s[2]]),q=et([],N,-c[3]);return ft(q,q,et([],U,-s[3])),ft(q,q,et([],G,-l[3])),et(q,q,1/p),q},d.bu=J2,d.bv=function(){return new Float64Array(4)},d.bw=function(c,s,l,p){var m=[],x=[];return m[0]=s[0]-l[0],m[1]=s[1]-l[1],m[2]=s[2]-l[2],x[0]=m[0]*Math.cos(p)-m[1]*Math.sin(p),x[1]=m[0]*Math.sin(p)+m[1]*Math.cos(p),x[2]=m[2],c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.bx=function(c,s,l,p){var m=[],x=[];return m[0]=s[0]-l[0],m[1]=s[1]-l[1],m[2]=s[2]-l[2],x[0]=m[0],x[1]=m[1]*Math.cos(p)-m[2]*Math.sin(p),x[2]=m[1]*Math.sin(p)+m[2]*Math.cos(p),c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.by=function(c,s,l,p){var m=[],x=[];return m[0]=s[0]-l[0],m[1]=s[1]-l[1],m[2]=s[2]-l[2],x[0]=m[2]*Math.sin(p)+m[0]*Math.cos(p),x[1]=m[1],x[2]=m[2]*Math.cos(p)-m[0]*Math.sin(p),c[0]=x[0]+l[0],c[1]=x[1]+l[1],c[2]=x[2]+l[2],c},d.bz=function(c,s,l){var p=Math.sin(l),m=Math.cos(l),x=s[0],w=s[1],C=s[2],I=s[3],A=s[8],D=s[9],N=s[10],U=s[11];return s!==c&&(c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=x*m-A*p,c[1]=w*m-D*p,c[2]=C*m-N*p,c[3]=I*m-U*p,c[8]=x*p+A*m,c[9]=w*p+D*m,c[10]=C*p+N*m,c[11]=I*p+U*m,c},d.c=_e,d.c0=Dj,d.c1=class extends u{},d.c2=k2,d.c3=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},d.c4=yM,d.c5=function(c,s,l){var p=s[0],m=s[1],x=s[2],w=l[3]*p+l[7]*m+l[11]*x+l[15];return c[0]=(l[0]*p+l[4]*m+l[8]*x+l[12])/(w=w||1),c[1]=(l[1]*p+l[5]*m+l[9]*x+l[13])/w,c[2]=(l[2]*p+l[6]*m+l[10]*x+l[14])/w,c},d.c6=class extends Cg{},d.c7=class extends z{},d.c8=function(c,s){return c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]&&c[3]===s[3]&&c[4]===s[4]&&c[5]===s[5]&&c[6]===s[6]&&c[7]===s[7]&&c[8]===s[8]&&c[9]===s[9]&&c[10]===s[10]&&c[11]===s[11]&&c[12]===s[12]&&c[13]===s[13]&&c[14]===s[14]&&c[15]===s[15]},d.c9=function(c,s){var l=c[0],p=c[1],m=c[2],x=c[3],w=c[4],C=c[5],I=c[6],A=c[7],D=c[8],N=c[9],U=c[10],G=c[11],q=c[12],X=c[13],Q=c[14],ne=c[15],ye=s[0],ue=s[1],de=s[2],Me=s[3],Re=s[4],Ze=s[5],ct=s[6],rt=s[7],at=s[8],It=s[9],ot=s[10],lt=s[11],je=s[12],At=s[13],zt=s[14],Pt=s[15];return Math.abs(l-ye)<=Ce*Math.max(1,Math.abs(l),Math.abs(ye))&&Math.abs(p-ue)<=Ce*Math.max(1,Math.abs(p),Math.abs(ue))&&Math.abs(m-de)<=Ce*Math.max(1,Math.abs(m),Math.abs(de))&&Math.abs(x-Me)<=Ce*Math.max(1,Math.abs(x),Math.abs(Me))&&Math.abs(w-Re)<=Ce*Math.max(1,Math.abs(w),Math.abs(Re))&&Math.abs(C-Ze)<=Ce*Math.max(1,Math.abs(C),Math.abs(Ze))&&Math.abs(I-ct)<=Ce*Math.max(1,Math.abs(I),Math.abs(ct))&&Math.abs(A-rt)<=Ce*Math.max(1,Math.abs(A),Math.abs(rt))&&Math.abs(D-at)<=Ce*Math.max(1,Math.abs(D),Math.abs(at))&&Math.abs(N-It)<=Ce*Math.max(1,Math.abs(N),Math.abs(It))&&Math.abs(U-ot)<=Ce*Math.max(1,Math.abs(U),Math.abs(ot))&&Math.abs(G-lt)<=Ce*Math.max(1,Math.abs(G),Math.abs(lt))&&Math.abs(q-je)<=Ce*Math.max(1,Math.abs(q),Math.abs(je))&&Math.abs(X-At)<=Ce*Math.max(1,Math.abs(X),Math.abs(At))&&Math.abs(Q-zt)<=Ce*Math.max(1,Math.abs(Q),Math.abs(zt))&&Math.abs(ne-Pt)<=Ce*Math.max(1,Math.abs(ne),Math.abs(Pt))},d.cA=function(c,s){Y.REGISTERED_PROTOCOLS[c]=s},d.cB=function(c){delete Y.REGISTERED_PROTOCOLS[c]},d.cC=function(c,s){const l={};for(let m=0;m<c.length;m++){const x=s&&s[c[m].id]||_2(c[m]);s&&(s[c[m].id]=x);let w=l[x];w||(w=l[x]=[]),w.push(c[m])}const p=[];for(const m in l)p.push(l[m]);return p},d.cD=mt,d.cE=fk,d.cF=gk,d.cG=HM,d.cH=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=Ye/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const s=c.bucket.layers[0],l=s.layout,p=s._unevaluatedLayout._values,m={layoutIconSize:p["icon-size"].possiblyEvaluate(new ki(c.bucket.zoom+1),c.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new ki(c.bucket.zoom+1),c.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new ki(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:A,maxZoom:D}=c.bucket.textSizeData;m.compositeTextSizes=[p["text-size"].possiblyEvaluate(new ki(A),c.canonical),p["text-size"].possiblyEvaluate(new ki(D),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:A,maxZoom:D}=c.bucket.iconSizeData;m.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new ki(A),c.canonical),p["icon-size"].possiblyEvaluate(new ki(D),c.canonical)]}const x=l.get("text-line-height")*Zr,w=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",C=l.get("text-keep-upright"),I=l.get("text-size");for(const A of c.bucket.features){const D=l.get("text-font").evaluate(A,{},c.canonical).join(","),N=I.evaluate(A,{},c.canonical),U=m.layoutTextSize.evaluate(A,{},c.canonical),G=m.layoutIconSize.evaluate(A,{},c.canonical),q={horizontal:{},vertical:void 0},X=A.text;let Q,ne=[0,0];if(X){const de=X.toString(),Me=l.get("text-letter-spacing").evaluate(A,{},c.canonical)*Zr,Re=S2(de)?Me:0,Ze=l.get("text-anchor").evaluate(A,{},c.canonical),ct=Ik(s,A,c.canonical);if(!ct){const ot=l.get("text-radial-offset").evaluate(A,{},c.canonical);ne=ot?Ek(Ze,[ot*Zr,eS]):l.get("text-offset").evaluate(A,{},c.canonical).map((lt=>lt*Zr))}let rt=w?"center":l.get("text-justify").evaluate(A,{},c.canonical);const at=l.get("symbol-placement")==="point"?l.get("text-max-width").evaluate(A,{},c.canonical)*Zr:1/0,It=()=>{c.bucket.allowVerticalPlacement&&dp(de)&&(q.vertical=b_(X,c.glyphMap,c.glyphPositions,c.imagePositions,D,at,x,Ze,"left",Re,ne,d.ao.vertical,!0,U,N))};if(!w&&ct){const ot=new Set;if(rt==="auto")for(let je=0;je<ct.values.length;je+=2)ot.add(tS(ct.values[je]));else ot.add(rt);let lt=!1;for(const je of ot)if(!q.horizontal[je])if(lt)q.horizontal[je]=q.horizontal[0];else{const At=b_(X,c.glyphMap,c.glyphPositions,c.imagePositions,D,at,x,"center",je,Re,ne,d.ao.horizontal,!1,U,N);At&&(q.horizontal[je]=At,lt=At.positionedLines.length===1)}It()}else{rt==="auto"&&(rt=tS(Ze));const ot=b_(X,c.glyphMap,c.glyphPositions,c.imagePositions,D,at,x,Ze,rt,Re,ne,d.ao.horizontal,!1,U,N);ot&&(q.horizontal[rt]=ot),It(),dp(de)&&w&&C&&(q.vertical=b_(X,c.glyphMap,c.glyphPositions,c.imagePositions,D,at,x,Ze,rt,Re,ne,d.ao.vertical,!1,U,N))}}let ye=!1;if(A.icon&&A.icon.name){const de=c.imageMap[A.icon.name];de&&(Q=t9(c.imagePositions[A.icon.name],l.get("icon-offset").evaluate(A,{},c.canonical),l.get("icon-anchor").evaluate(A,{},c.canonical)),ye=!!de.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=ye:c.bucket.sdfIcons!==ye&&cr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(de.pixelRatio!==c.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const ue=Pk(q.horizontal)||q.vertical;c.bucket.iconsInText=!!ue&&ue.iconsInText,(ue||Q)&&y9(c.bucket,A,q,Q,c.imageMap,m,U,G,ne,ye,c.canonical,c.subdivisionGranularity)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},d.cI=B2,d.cJ=L2,d.cK=N2,d.cL=AM,d.cM=U2,d.cN=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},d.cO=function(c,s,l,p,m){return a(this,void 0,void 0,(function*(){if(be())try{return yield Ec(c,s,l,p,m)}catch{}return(function(x,w,C,I,A){const D=x.width,N=x.height;ka&&Aa||(ka=new OffscreenCanvas(D,N),Aa=ka.getContext("2d",{willReadFrequently:!0})),ka.width=D,ka.height=N,Aa.drawImage(x,0,0,D,N);const U=Aa.getImageData(w,C,I,A);return Aa.clearRect(0,0,D,N),U.data})(c,s,l,p,m)}))},d.cP=bM,d.cQ=T,d.cR=kM,d.cS=Ep,d.cT=hh,d.cU=function(c,s){const l=new Map;if(c!=null)if(c.type==="Feature")l.set(Vg(c,s),c);else for(const p of c.features)l.set(Vg(p,s),p);return l},d.cV=function(c,s){if(c==null)return!0;if(c.type==="Feature")return Vg(c,s)!=null;if(c.type==="FeatureCollection"){const l=new Set;for(const p of c.features){const m=Vg(p,s);if(m==null||l.has(m))return!1;l.add(m)}return!0}return!1},d.cW=function(c,s,l){var p,m,x,w;if(s.removeAll&&c.clear(),s.remove)for(const C of s.remove)c.delete(C);if(s.add)for(const C of s.add){const I=Vg(C,l);I!=null&&c.set(I,C)}if(s.update)for(const C of s.update){let I=c.get(C.id);if(I==null)continue;const A=!C.removeAllProperties&&(((p=C.removeProperties)===null||p===void 0?void 0:p.length)>0||((m=C.addOrUpdateProperties)===null||m===void 0?void 0:m.length)>0);if((C.newGeometry||C.removeAllProperties||A)&&(I=Object.assign({},I),c.set(C.id,I),A&&(I.properties=Object.assign({},I.properties))),C.newGeometry&&(I.geometry=C.newGeometry),C.removeAllProperties)I.properties={};else if(((x=C.removeProperties)===null||x===void 0?void 0:x.length)>0)for(const D of C.removeProperties)Object.prototype.hasOwnProperty.call(I.properties,D)&&delete I.properties[D];if(((w=C.addOrUpdateProperties)===null||w===void 0?void 0:w.length)>0)for(const{key:D,value:N}of C.addOrUpdateProperties)I.properties[D]=N}},d.cX=Hs,d.ca=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},d.cb=c=>c.type==="symbol",d.cc=c=>c.type==="circle",d.cd=c=>c.type==="heatmap",d.ce=c=>c.type==="line",d.cf=c=>c.type==="fill",d.cg=c=>c.type==="fill-extrusion",d.ch=c=>c.type==="hillshade",d.ci=c=>c.type==="color-relief",d.cj=c=>c.type==="raster",d.ck=c=>c.type==="background",d.cl=c=>c.type==="custom",d.cm=nn,d.cn=function(c,s,l){const p=Et(s.x-l.x,s.y-l.y),m=Et(c.x-l.x,c.y-l.y);var x,w;return za(Math.atan2(p[0]*m[1]-p[1]*m[0],(x=p)[0]*(w=m)[0]+x[1]*w[1]))},d.co=es,d.cp=function(c,s){return Ra[s]&&(c instanceof MouseEvent||c instanceof WheelEvent)},d.cq=function(c,s){return Oa[s]&&"touches"in c},d.cr=function(c){return Oa[c]||Ra[c]},d.cs=function(c,s,l){var p=s[0],m=s[1];return c[0]=l[0]*p+l[4]*m+l[12],c[1]=l[1]*p+l[5]*m+l[13],c},d.ct=function(c,s){const{x:l,y:p}=Ug.fromLngLat(s);return!(c<0||c>25||p<0||p>=1||l<0||l>=1)},d.cu=function(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},d.cv=class extends Wc{},d.cw=_9,d.cy=function(c){return c.message===Ic},d.cz=le,d.d=Ae,d.e=dn,d.f=c=>a(void 0,void 0,void 0,(function*(){if(c.byteLength===0)return createImageBitmap(new ImageData(1,1));const s=new Blob([new Uint8Array(c)],{type:"image/png"});try{return createImageBitmap(s)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),d.g=J,d.h=c=>new Promise(((s,l)=>{const p=new Image;p.onload=()=>{s(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame((()=>{p.src=So}))},p.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(c)],{type:"image/png"});p.src=c.byteLength?URL.createObjectURL(m):So})),d.i=xo,d.j=(c,s)=>xe(dn(c,{type:"json"}),s),d.k=Ge,d.l=Xe,d.m=xe,d.n=(c,s)=>xe(dn(c,{type:"arrayBuffer"}),s),d.o=function(c){return new U2(c).readFields(Gj,[])},d.p=qM,d.q=kg,d.r=En,d.s=Da,d.t=c_,d.u=ni,d.v=Te,d.w=cr,d.x=b2,d.y=vh,d.z=Gc})),o("worker",["./shared"],(function(d){class a{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,J){for(const le of Y){this._layerConfigs[le.id]=le;const fe=this._layers[le.id]=d.bJ(le);fe._featureFilter=d.aa(fe.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of J)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const K=d.cC(Object.values(this._layerConfigs),this.keyCache);for(const le of K){const fe=le.map((Ge=>this._layers[Ge.id])),xe=fe[0];if(xe.visibility==="none")continue;const Ae=xe.source||"";let Se=this.familiesBySource[Ae];Se||(Se=this.familiesBySource[Ae]={});const Ne=xe.sourceLayer||"_geojsonTileLayer";let Xe=Se[Ne];Xe||(Xe=Se[Ne]=[]),Xe.push(fe)}}}class v{constructor(Y){const J={},K=[];for(const Ae in Y){const Se=Y[Ae],Ne=J[Ae]={};for(const Xe in Se){const Ge=Se[+Xe];if(!Ge||Ge.bitmap.width===0||Ge.bitmap.height===0)continue;const St={x:0,y:0,w:Ge.bitmap.width+2,h:Ge.bitmap.height+2};K.push(St),Ne[Xe]={rect:St,metrics:Ge.metrics}}}const{w:le,h:fe}=d.p(K),xe=new d.q({width:le||1,height:fe||1});for(const Ae in Y){const Se=Y[Ae];for(const Ne in Se){const Xe=Se[+Ne];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const Ge=J[Ae][Ne].rect;d.q.copy(Xe.bitmap,xe,{x:0,y:0},{x:Ge.x+1,y:Ge.y+1},Xe.bitmap)}}this.image=xe,this.positions=J}}d.cD("GlyphAtlas",v);class T{constructor(Y){this.tileID=new d.Z(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.uid=Y.uid,this.zoom=Y.zoom,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.collectResourceTiming,this.returnDependencies=!!Y.returnDependencies,this.promoteId=Y.promoteId,this.inFlightDependencies=[],this.globalState=Y.globalState}parse(Y,J,K,le,fe){return d._(this,void 0,void 0,(function*(){this.status="parsing",this.data=Y,this.collisionBoxArray=new d.a8;const xe=new d.cE(Object.keys(Y.layers).sort()),Ae=new d.cF(this.tileID,this.promoteId);Ae.bucketLayerIDs=[];const Se={},Ne={featureIndex:Ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K,subdivisionGranularity:fe},Xe=J.familiesBySource[this.source];for(const ti in Xe){const li=Y.layers[ti];if(!li)continue;li.version===1&&d.w(`Vector tile source "${this.source}" layer "${ti}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const yr=xe.encode(ti),it=[];for(let pn=0;pn<li.length;pn++){const Wi=li.feature(pn),La=Ae.getId(Wi,ti);it.push({feature:Wi,id:La,index:pn,sourceLayerIndex:yr})}for(const pn of Xe[ti]){const Wi=pn[0];Wi.source!==this.source&&d.w(`layer.source = ${Wi.source} does not equal this.source = ${this.source}`),Wi.minzoom&&this.zoom<Math.floor(Wi.minzoom)||Wi.maxzoom&&this.zoom>=Wi.maxzoom||Wi.visibility!=="none"&&(E(pn,this.zoom,K,this.globalState),(Se[Wi.id]=Wi.createBucket({index:Ae.bucketLayerIDs.length,layers:pn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yr,sourceID:this.source,globalState:this.globalState})).populate(it,Ne,this.tileID.canonical),Ae.bucketLayerIDs.push(pn.map((La=>La.id))))}}const Ge=d.bN(Ne.glyphDependencies,(ti=>Object.keys(ti).map(Number)));this.inFlightDependencies.forEach((ti=>ti?.abort())),this.inFlightDependencies=[];let St=Promise.resolve({});if(Object.keys(Ge).length){const ti=new AbortController;this.inFlightDependencies.push(ti),St=le.sendAsync({type:"GG",data:{stacks:Ge,source:this.source,tileID:this.tileID,type:"glyphs"}},ti)}const Te=Object.keys(Ne.iconDependencies);let Ot=Promise.resolve({});if(Te.length){const ti=new AbortController;this.inFlightDependencies.push(ti),Ot=le.sendAsync({type:"GI",data:{icons:Te,source:this.source,tileID:this.tileID,type:"icons"}},ti)}const Jt=Object.keys(Ne.patternDependencies);let $t=Promise.resolve({});if(Jt.length){const ti=new AbortController;this.inFlightDependencies.push(ti),$t=le.sendAsync({type:"GI",data:{icons:Jt,source:this.source,tileID:this.tileID,type:"patterns"}},ti)}const[jt,Oi,Mr]=yield Promise.all([St,Ot,$t]),kr=new v(jt),ur=new d.cG(Oi,Mr);for(const ti in Se){const li=Se[ti];li instanceof d.a9?(E(li.layers,this.zoom,K,this.globalState),d.cH({bucket:li,glyphMap:jt,glyphPositions:kr.positions,imageMap:Oi,imagePositions:ur.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ne.subdivisionGranularity})):li.hasPattern&&(li instanceof d.cI||li instanceof d.cJ||li instanceof d.cK)&&(E(li.layers,this.zoom,K,this.globalState),li.addFeatures(Ne,this.tileID.canonical,ur.patternPositions))}return this.status="done",{buckets:Object.values(Se).filter((ti=>!ti.isEmpty())),featureIndex:Ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:kr.image,imageAtlas:ur,glyphMap:this.returnDependencies?jt:null,iconMap:this.returnDependencies?Oi:null,glyphPositions:this.returnDependencies?kr.positions:null}}))}}function E(_e,Y,J,K){const le=new d.F(Y);for(const fe of _e)fe.setGlobalState(K),fe.recalculate(le,J)}class k{constructor(Y,J,K){this.actor=Y,this.layerIndex=J,this.availableImages=K,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Y,J){return d._(this,void 0,void 0,(function*(){const K=yield d.n(Y.request,J);try{return{vectorTile:new d.cL(new d.cM(K.data)),rawData:K.data,cacheControl:K.cacheControl,expires:K.expires}}catch(le){const fe=new Uint8Array(K.data);let xe=`Unable to parse the tile at ${Y.request.url}, `;throw xe+=fe[0]===31&&fe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${le.message}`,new Error(xe)}}))}loadTile(Y){return d._(this,void 0,void 0,(function*(){const J=Y.uid,K=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new d.cN(Y.request),le=new T(Y);this.loading[J]=le;const fe=new AbortController;le.abort=fe;try{const xe=yield this.loadVectorTile(Y,fe);if(delete this.loading[J],!xe)return null;const Ae=xe.rawData,Se={};xe.expires&&(Se.expires=xe.expires),xe.cacheControl&&(Se.cacheControl=xe.cacheControl);const Ne={};if(K){const Ge=K.finish();Ge&&(Ne.resourceTiming=JSON.parse(JSON.stringify(Ge)))}le.vectorTile=xe.vectorTile;const Xe=le.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity);this.loaded[J]=le,this.fetching[J]={rawTileData:Ae,cacheControl:Se,resourceTiming:Ne};try{const Ge=yield Xe;return d.e({rawTileData:Ae.slice(0)},Ge,Se,Ne)}finally{delete this.fetching[J]}}catch(xe){throw delete this.loading[J],le.status="done",this.loaded[J]=le,xe}}))}reloadTile(Y){return d._(this,void 0,void 0,(function*(){const J=Y.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const K=this.loaded[J];if(K.showCollisionBoxes=Y.showCollisionBoxes,K.globalState=Y.globalState,K.status==="parsing"){const le=yield K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity);let fe;if(this.fetching[J]){const{rawTileData:xe,cacheControl:Ae,resourceTiming:Se}=this.fetching[J];delete this.fetching[J],fe=d.e({rawTileData:xe.slice(0)},le,Ae,Se)}else fe=le;return fe}if(K.status==="done"&&K.vectorTile)return K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor,Y.subdivisionGranularity)}))}abortTile(Y){return d._(this,void 0,void 0,(function*(){const J=this.loading,K=Y.uid;J&&J[K]&&J[K].abort&&(J[K].abort.abort(),delete J[K])}))}removeTile(Y){return d._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[Y.uid]&&delete this.loaded[Y.uid]}))}}class L{constructor(){this.loaded={}}loadTile(Y){return d._(this,void 0,void 0,(function*(){const{uid:J,encoding:K,rawImageData:le,redFactor:fe,greenFactor:xe,blueFactor:Ae,baseShift:Se}=Y,Ne=le.width+2,Xe=le.height+2,Ge=d.b(le)?new d.R({width:Ne,height:Xe},yield d.cO(le,-1,-1,Ne,Xe)):le,St=new d.cP(J,Ge,K,fe,xe,Ae,Se);return this.loaded=this.loaded||{},this.loaded[J]=St,St}))}removeTile(Y){const J=this.loaded,K=Y.uid;J&&J[K]&&delete J[K]}}var O,H,ie=(function(){if(H)return O;function _e(J,K){if(J.length!==0){Y(J[0],K);for(var le=1;le<J.length;le++)Y(J[le],!K)}}function Y(J,K){for(var le=0,fe=0,xe=0,Ae=J.length,Se=Ae-1;xe<Ae;Se=xe++){var Ne=(J[xe][0]-J[Se][0])*(J[Se][1]+J[xe][1]),Xe=le+Ne;fe+=Math.abs(le)>=Math.abs(Ne)?le-Xe+Ne:Ne-Xe+le,le=Xe}le+fe>=0!=!!K&&J.reverse()}return H=1,O=function J(K,le){var fe,xe=K&&K.type;if(xe==="FeatureCollection")for(fe=0;fe<K.features.length;fe++)J(K.features[fe],le);else if(xe==="GeometryCollection")for(fe=0;fe<K.geometries.length;fe++)J(K.geometries[fe],le);else if(xe==="Feature")J(K.geometry,le);else if(xe==="Polygon")_e(K.coordinates,le);else if(xe==="MultiPolygon")for(fe=0;fe<K.coordinates.length;fe++)_e(K.coordinates[fe],le);return K}})(),pe=d.cQ(ie);class be extends d.cS{constructor(Y,J){super(new d.cM,0,J,[],[]),this.feature=Y,this.type=Y.type,this.properties=Y.tags?Y.tags:{},"id"in Y&&(typeof Y.id=="string"?this.id=parseInt(Y.id,10):typeof Y.id!="number"||isNaN(Y.id)||(this.id=Y.id))}loadGeometry(){const Y=[],J=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const K of J){const le=[];for(const fe of K)le.push(new d.P(fe[0],fe[1]));Y.push(le)}return Y}}class Ce extends d.cR{constructor(Y,J){super(new d.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=J?J.version:1,this.extent=J?J.extent:4096,this.length=Y.length,this.features=Y}feature(Y){return new be(this.features[Y],this.extent)}}function Pe(_e,Y){Y.writeVarintField(15,_e.version||1),Y.writeStringField(1,_e.name||""),Y.writeVarintField(5,_e.extent||4096);const J={keys:[],values:[],keycache:{},valuecache:{}};for(let fe=0;fe<_e.length;fe++)J.feature=_e.feature(fe),Y.writeMessage(2,Ie,J);const K=J.keys;for(const fe of K)Y.writeStringField(3,fe);const le=J.values;for(const fe of le)Y.writeMessage(4,ft,fe)}function Ie(_e,Y){if(!_e.feature)return;const J=_e.feature;J.id!==void 0&&Y.writeVarintField(1,J.id),Y.writeMessage(2,ke,_e),Y.writeVarintField(3,J.type),Y.writeMessage(4,dt,J)}function ke(_e,Y){for(const J in _e.feature?.properties){let K=_e.feature.properties[J],le=_e.keycache[J];if(K===null)continue;le===void 0&&(_e.keys.push(J),le=_e.keys.length-1,_e.keycache[J]=le),Y.writeVarint(le),typeof K!="string"&&typeof K!="boolean"&&typeof K!="number"&&(K=JSON.stringify(K));const fe=typeof K+":"+K;let xe=_e.valuecache[fe];xe===void 0&&(_e.values.push(K),xe=_e.values.length-1,_e.valuecache[fe]=xe),Y.writeVarint(xe)}}function Ke(_e,Y){return(Y<<3)+(7&_e)}function qe(_e){return _e<<1^_e>>31}function dt(_e,Y){const J=_e.loadGeometry(),K=_e.type;let le=0,fe=0;for(const xe of J){let Ae=1;K===1&&(Ae=xe.length),Y.writeVarint(Ke(1,Ae));const Se=K===3?xe.length-1:xe.length;for(let Ne=0;Ne<Se;Ne++){Ne===1&&K!==1&&Y.writeVarint(Ke(2,Se-1));const Xe=xe[Ne].x-le,Ge=xe[Ne].y-fe;Y.writeVarint(qe(Xe)),Y.writeVarint(qe(Ge)),le+=Xe,fe+=Ge}_e.type===3&&Y.writeVarint(Ke(7,1))}}function ft(_e,Y){const J=typeof _e;J==="string"?Y.writeStringField(1,_e):J==="boolean"?Y.writeBooleanField(7,_e):J==="number"&&(_e%1!=0?Y.writeDoubleField(3,_e):_e<0?Y.writeSVarintField(6,_e):Y.writeVarintField(5,_e))}const et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:_e=>_e},We=Math.fround||(Be=new Float32Array(1),_e=>(Be[0]=+_e,Be[0]));var Be;class ge{constructor(Y){this.options=Object.assign(Object.create(et),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:J,minZoom:K,maxZoom:le}=this.options;J&&console.time("total time");const fe=`prepare ${Y.length} points`;J&&console.time(fe),this.points=Y;const xe=[];for(let Se=0;Se<Y.length;Se++){const Ne=Y[Se];if(!Ne.geometry)continue;const[Xe,Ge]=Ne.geometry.coordinates,St=We(Qe(Xe)),Te=We(yt(Ge));xe.push(St,Te,1/0,Se,-1,1),this.options.reduce&&xe.push(0)}let Ae=this.trees[le+1]=this._createTree(xe);J&&console.timeEnd(fe);for(let Se=le;Se>=K;Se--){const Ne=+Date.now();Ae=this.trees[Se]=this._createTree(this._cluster(Ae,Se)),J&&console.log("z%d: %d clusters in %dms",Se,Ae.numItems,+Date.now()-Ne)}return J&&console.timeEnd("total time"),this}getClusters(Y,J){let K=((Y[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,Y[1]));let fe=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)K=-180,fe=180;else if(K>fe){const Ge=this.getClusters([K,le,180,xe],J),St=this.getClusters([-180,le,fe,xe],J);return Ge.concat(St)}const Ae=this.trees[this._limitZoom(J)],Se=Ae.range(Qe(K),yt(xe),Qe(fe),yt(le)),Ne=Ae.data,Xe=[];for(const Ge of Se){const St=this.stride*Ge;Xe.push(Ne[St+5]>1?De(Ne,St,this.clusterProps):this.points[Ne[St+3]])}return Xe}getChildren(Y){const J=this._getOriginId(Y),K=this._getOriginZoom(Y),le="No cluster with the specified id.",fe=this.trees[K];if(!fe)throw new Error(le);const xe=fe.data;if(J*this.stride>=xe.length)throw new Error(le);const Ae=this.options.radius/(this.options.extent*Math.pow(2,K-1)),Se=fe.within(xe[J*this.stride],xe[J*this.stride+1],Ae),Ne=[];for(const Xe of Se){const Ge=Xe*this.stride;xe[Ge+4]===Y&&Ne.push(xe[Ge+5]>1?De(xe,Ge,this.clusterProps):this.points[xe[Ge+3]])}if(Ne.length===0)throw new Error(le);return Ne}getLeaves(Y,J,K){const le=[];return this._appendLeaves(le,Y,J=J||10,K=K||0,0),le}getTile(Y,J,K){const le=this.trees[this._limitZoom(Y)],fe=Math.pow(2,Y),{extent:xe,radius:Ae}=this.options,Se=Ae/xe,Ne=(K-Se)/fe,Xe=(K+1+Se)/fe,Ge={features:[]};return this._addTileFeatures(le.range((J-Se)/fe,Ne,(J+1+Se)/fe,Xe),le.data,J,K,fe,Ge),J===0&&this._addTileFeatures(le.range(1-Se/fe,Ne,1,Xe),le.data,fe,K,fe,Ge),J===fe-1&&this._addTileFeatures(le.range(0,Ne,Se/fe,Xe),le.data,-1,K,fe,Ge),Ge.features.length?Ge:null}getClusterExpansionZoom(Y){let J=this._getOriginZoom(Y)-1;for(;J<=this.options.maxZoom;){const K=this.getChildren(Y);if(J++,K.length!==1)break;Y=K[0].properties.cluster_id}return J}_appendLeaves(Y,J,K,le,fe){const xe=this.getChildren(J);for(const Ae of xe){const Se=Ae.properties;if(Se&&Se.cluster?fe+Se.point_count<=le?fe+=Se.point_count:fe=this._appendLeaves(Y,Se.cluster_id,K,le,fe):fe<le?fe++:Y.push(Ae),Y.length===K)break}return fe}_createTree(Y){const J=new d.aI(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<Y.length;K+=this.stride)J.add(Y[K],Y[K+1]);return J.finish(),J.data=Y,J}_addTileFeatures(Y,J,K,le,fe,xe){for(const Ae of Y){const Se=Ae*this.stride,Ne=J[Se+5]>1;let Xe,Ge,St;if(Ne)Xe=Je(J,Se,this.clusterProps),Ge=J[Se],St=J[Se+1];else{const Jt=this.points[J[Se+3]];Xe=Jt.properties;const[$t,jt]=Jt.geometry.coordinates;Ge=Qe($t),St=yt(jt)}const Te={type:1,geometry:[[Math.round(this.options.extent*(Ge*fe-K)),Math.round(this.options.extent*(St*fe-le))]],tags:Xe};let Ot;Ot=Ne||this.options.generateId?J[Se+3]:this.points[J[Se+3]].id,Ot!==void 0&&(Te.id=Ot),xe.features.push(Te)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,J){const{radius:K,extent:le,reduce:fe,minPoints:xe}=this.options,Ae=K/(le*Math.pow(2,J)),Se=Y.data,Ne=[],Xe=this.stride;for(let Ge=0;Ge<Se.length;Ge+=Xe){if(Se[Ge+2]<=J)continue;Se[Ge+2]=J;const St=Se[Ge],Te=Se[Ge+1],Ot=Y.within(Se[Ge],Se[Ge+1],Ae),Jt=Se[Ge+5];let $t=Jt;for(const jt of Ot){const Oi=jt*Xe;Se[Oi+2]>J&&($t+=Se[Oi+5])}if($t>Jt&&$t>=xe){let jt,Oi=St*Jt,Mr=Te*Jt,kr=-1;const ur=(Ge/Xe<<5)+(J+1)+this.points.length;for(const ti of Ot){const li=ti*Xe;if(Se[li+2]<=J)continue;Se[li+2]=J;const yr=Se[li+5];Oi+=Se[li]*yr,Mr+=Se[li+1]*yr,Se[li+4]=ur,fe&&(jt||(jt=this._map(Se,Ge,!0),kr=this.clusterProps.length,this.clusterProps.push(jt)),fe(jt,this._map(Se,li)))}Se[Ge+4]=ur,Ne.push(Oi/$t,Mr/$t,1/0,ur,-1,$t),fe&&Ne.push(kr)}else{for(let jt=0;jt<Xe;jt++)Ne.push(Se[Ge+jt]);if($t>1)for(const jt of Ot){const Oi=jt*Xe;if(!(Se[Oi+2]<=J)){Se[Oi+2]=J;for(let Mr=0;Mr<Xe;Mr++)Ne.push(Se[Oi+Mr])}}}}return Ne}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,J,K){if(Y[J+5]>1){const xe=this.clusterProps[Y[J+6]];return K?Object.assign({},xe):xe}const le=this.points[Y[J+3]].properties,fe=this.options.map(le);return K&&fe===le?Object.assign({},fe):fe}}function De(_e,Y,J){return{type:"Feature",id:_e[Y+3],properties:Je(_e,Y,J),geometry:{type:"Point",coordinates:[(K=_e[Y],360*(K-.5)),Et(_e[Y+1])]}};var K}function Je(_e,Y,J){const K=_e[Y+5],le=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,fe=_e[Y+6],xe=fe===-1?{}:Object.assign({},J[fe]);return Object.assign(xe,{cluster:!0,cluster_id:_e[Y+3],point_count:K,point_count_abbreviated:le})}function Qe(_e){return _e/360+.5}function yt(_e){const Y=Math.sin(_e*Math.PI/180),J=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return J<0?0:J>1?1:J}function Et(_e){const Y=(180-360*_e)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Ye(_e,Y,J,K){let le=K;const fe=Y+(J-Y>>1);let xe,Ae=J-Y;const Se=_e[Y],Ne=_e[Y+1],Xe=_e[J],Ge=_e[J+1];for(let St=Y+3;St<J;St+=3){const Te=bt(_e[St],_e[St+1],Se,Ne,Xe,Ge);if(Te>le)xe=St,le=Te;else if(Te===le){const Ot=Math.abs(St-fe);Ot<Ae&&(xe=St,Ae=Ot)}}le>K&&(xe-Y>3&&Ye(_e,Y,xe,K),_e[xe+2]=le,J-xe>3&&Ye(_e,xe,J,K))}function bt(_e,Y,J,K,le,fe){let xe=le-J,Ae=fe-K;if(xe!==0||Ae!==0){const Se=((_e-J)*xe+(Y-K)*Ae)/(xe*xe+Ae*Ae);Se>1?(J=le,K=fe):Se>0&&(J+=xe*Se,K+=Ae*Se)}return xe=_e-J,Ae=Y-K,xe*xe+Ae*Ae}function Dt(_e,Y,J,K){const le={id:_e??null,type:Y,geometry:J,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Y==="Point"||Y==="MultiPoint"||Y==="LineString")Si(le,J);else if(Y==="Polygon")Si(le,J[0]);else if(Y==="MultiLineString")for(const fe of J)Si(le,fe);else if(Y==="MultiPolygon")for(const fe of J)Si(le,fe[0]);return le}function Si(_e,Y){for(let J=0;J<Y.length;J+=3)_e.minX=Math.min(_e.minX,Y[J]),_e.minY=Math.min(_e.minY,Y[J+1]),_e.maxX=Math.max(_e.maxX,Y[J]),_e.maxY=Math.max(_e.maxY,Y[J+1])}function Vr(_e,Y,J,K){if(!Y.geometry)return;const le=Y.geometry.coordinates;if(le&&le.length===0)return;const fe=Y.geometry.type,xe=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2);let Ae=[],Se=Y.id;if(J.promoteId?Se=Y.properties[J.promoteId]:J.generateId&&(Se=K||0),fe==="Point")nn(le,Ae);else if(fe==="MultiPoint")for(const Ne of le)nn(Ne,Ae);else if(fe==="LineString")es(le,Ae,xe,!1);else if(fe==="MultiLineString"){if(J.lineMetrics){for(const Ne of le)Ae=[],es(Ne,Ae,xe,!1),_e.push(Dt(Se,"LineString",Ae,Y.properties));return}sn(le,Ae,xe,!1)}else if(fe==="Polygon")sn(le,Ae,xe,!0);else{if(fe!=="MultiPolygon"){if(fe==="GeometryCollection"){for(const Ne of Y.geometry.geometries)Vr(_e,{id:Se,geometry:Ne,properties:Y.properties},J,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ne of le){const Xe=[];sn(Ne,Xe,xe,!0),Ae.push(Xe)}}_e.push(Dt(Se,fe,Ae,Y.properties))}function nn(_e,Y){Y.push(bo(_e[0]),dn(_e[1]),0)}function es(_e,Y,J,K){let le,fe,xe=0;for(let Se=0;Se<_e.length;Se++){const Ne=bo(_e[Se][0]),Xe=dn(_e[Se][1]);Y.push(Ne,Xe,0),Se>0&&(xe+=K?(le*Xe-Ne*fe)/2:Math.sqrt(Math.pow(Ne-le,2)+Math.pow(Xe-fe,2))),le=Ne,fe=Xe}const Ae=Y.length-3;Y[2]=1,Ye(Y,0,Ae,J),Y[Ae+2]=1,Y.size=Math.abs(xe),Y.start=0,Y.end=Y.size}function sn(_e,Y,J,K){for(let le=0;le<_e.length;le++){const fe=[];es(_e[le],fe,J,K),Y.push(fe)}}function bo(_e){return _e/360+.5}function dn(_e){const Y=Math.sin(_e*Math.PI/180),J=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return J<0?0:J>1?1:J}function Ls(_e,Y,J,K,le,fe,xe,Ae){if(K/=Y,fe>=(J/=Y)&&xe<K)return _e;if(xe<J||fe>=K)return null;const Se=[];for(const Ne of _e){const Xe=Ne.geometry;let Ge=Ne.type;const St=le===0?Ne.minX:Ne.minY,Te=le===0?Ne.maxX:Ne.maxY;if(St>=J&&Te<K){Se.push(Ne);continue}if(Te<J||St>=K)continue;let Ot=[];if(Ge==="Point"||Ge==="MultiPoint")Tc(Xe,Ot,J,K,le);else if(Ge==="LineString")Cc(Xe,Ot,J,K,le,!1,Ae.lineMetrics);else if(Ge==="MultiLineString")er(Xe,Ot,J,K,le,!1);else if(Ge==="Polygon")er(Xe,Ot,J,K,le,!0);else if(Ge==="MultiPolygon")for(const Jt of Xe){const $t=[];er(Jt,$t,J,K,le,!0),$t.length&&Ot.push($t)}if(Ot.length){if(Ae.lineMetrics&&Ge==="LineString"){for(const Jt of Ot)Se.push(Dt(Ne.id,Ge,Jt,Ne.tags));continue}Ge!=="LineString"&&Ge!=="MultiLineString"||(Ot.length===1?(Ge="LineString",Ot=Ot[0]):Ge="MultiLineString"),Ge!=="Point"&&Ge!=="MultiPoint"||(Ge=Ot.length===3?"Point":"MultiPoint"),Se.push(Dt(Ne.id,Ge,Ot,Ne.tags))}}return Se.length?Se:null}function Tc(_e,Y,J,K,le){for(let fe=0;fe<_e.length;fe+=3){const xe=_e[fe+le];xe>=J&&xe<=K&&cr(Y,_e[fe],_e[fe+1],_e[fe+2])}}function Cc(_e,Y,J,K,le,fe,xe){let Ae=ts(_e);const Se=le===0?Fs:xo;let Ne,Xe,Ge=_e.start;for(let $t=0;$t<_e.length-3;$t+=3){const jt=_e[$t],Oi=_e[$t+1],Mr=_e[$t+2],kr=_e[$t+3],ur=_e[$t+4],ti=le===0?jt:Oi,li=le===0?kr:ur;let yr=!1;xe&&(Ne=Math.sqrt(Math.pow(jt-kr,2)+Math.pow(Oi-ur,2))),ti<J?li>J&&(Xe=Se(Ae,jt,Oi,kr,ur,J),xe&&(Ae.start=Ge+Ne*Xe)):ti>K?li<K&&(Xe=Se(Ae,jt,Oi,kr,ur,K),xe&&(Ae.start=Ge+Ne*Xe)):cr(Ae,jt,Oi,Mr),li<J&&ti>=J&&(Xe=Se(Ae,jt,Oi,kr,ur,J),yr=!0),li>K&&ti<=K&&(Xe=Se(Ae,jt,Oi,kr,ur,K),yr=!0),!fe&&yr&&(xe&&(Ae.end=Ge+Ne*Xe),Y.push(Ae),Ae=ts(_e)),xe&&(Ge+=Ne)}let St=_e.length-3;const Te=_e[St],Ot=_e[St+1],Jt=le===0?Te:Ot;Jt>=J&&Jt<=K&&cr(Ae,Te,Ot,_e[St+2]),St=Ae.length-3,fe&&St>=3&&(Ae[St]!==Ae[0]||Ae[St+1]!==Ae[1])&&cr(Ae,Ae[0],Ae[1],Ae[2]),Ae.length&&Y.push(Ae)}function ts(_e){const Y=[];return Y.size=_e.size,Y.start=_e.start,Y.end=_e.end,Y}function er(_e,Y,J,K,le,fe){for(const xe of _e)Cc(xe,Y,J,K,le,fe,!1)}function cr(_e,Y,J,K){_e.push(Y,J,K)}function Fs(_e,Y,J,K,le,fe){const xe=(fe-Y)/(K-Y);return cr(_e,fe,J+(le-J)*xe,1),xe}function xo(_e,Y,J,K,le,fe){const xe=(fe-J)/(le-J);return cr(_e,Y+(K-Y)*xe,fe,1),xe}function Cl(_e,Y){const J=[];for(let K=0;K<_e.length;K++){const le=_e[K],fe=le.type;let xe;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")xe=wo(le.geometry,Y);else if(fe==="MultiLineString"||fe==="Polygon"){xe=[];for(const Ae of le.geometry)xe.push(wo(Ae,Y))}else if(fe==="MultiPolygon"){xe=[];for(const Ae of le.geometry){const Se=[];for(const Ne of Ae)Se.push(wo(Ne,Y));xe.push(Se)}}J.push(Dt(le.id,fe,xe,le.tags))}return J}function wo(_e,Y){const J=[];J.size=_e.size,_e.start!==void 0&&(J.start=_e.start,J.end=_e.end);for(let K=0;K<_e.length;K+=3)J.push(_e[K]+Y,_e[K+1],_e[K+2]);return J}function So(_e,Y){if(_e.transformed)return _e;const J=1<<_e.z,K=_e.x,le=_e.y;for(const fe of _e.features){const xe=fe.geometry,Ae=fe.type;if(fe.geometry=[],Ae===1)for(let Se=0;Se<xe.length;Se+=2)fe.geometry.push(Ec(xe[Se],xe[Se+1],Y,J,K,le));else for(let Se=0;Se<xe.length;Se++){const Ne=[];for(let Xe=0;Xe<xe[Se].length;Xe+=2)Ne.push(Ec(xe[Se][Xe],xe[Se][Xe+1],Y,J,K,le));fe.geometry.push(Ne)}}return _e.transformed=!0,_e}function Ec(_e,Y,J,K,le,fe){return[Math.round(J*(_e*K-le)),Math.round(J*(Y*K-fe))]}function ka(_e,Y,J,K,le){const fe=Y===le.maxZoom?0:le.tolerance/((1<<Y)*le.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:_e.length,source:null,x:J,y:K,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ae of _e)Aa(xe,Ae,fe,le);return xe}function Aa(_e,Y,J,K){const le=Y.geometry,fe=Y.type,xe=[];if(_e.minX=Math.min(_e.minX,Y.minX),_e.minY=Math.min(_e.minY,Y.minY),_e.maxX=Math.max(_e.maxX,Y.maxX),_e.maxY=Math.max(_e.maxY,Y.maxY),fe==="Point"||fe==="MultiPoint")for(let Ae=0;Ae<le.length;Ae+=3)xe.push(le[Ae],le[Ae+1]),_e.numPoints++,_e.numSimplified++;else if(fe==="LineString")Da(xe,le,_e,J,!1,!1);else if(fe==="MultiLineString"||fe==="Polygon")for(let Ae=0;Ae<le.length;Ae++)Da(xe,le[Ae],_e,J,fe==="Polygon",Ae===0);else if(fe==="MultiPolygon")for(let Ae=0;Ae<le.length;Ae++){const Se=le[Ae];for(let Ne=0;Ne<Se.length;Ne++)Da(xe,Se[Ne],_e,J,!0,Ne===0)}if(xe.length){let Ae=Y.tags||null;if(fe==="LineString"&&K.lineMetrics){Ae={};for(const Ne in Y.tags)Ae[Ne]=Y.tags[Ne];Ae.mapbox_clip_start=le.start/le.size,Ae.mapbox_clip_end=le.end/le.size}const Se={geometry:xe,type:fe==="Polygon"||fe==="MultiPolygon"?3:fe==="LineString"||fe==="MultiLineString"?2:1,tags:Ae};Y.id!==null&&(Se.id=Y.id),_e.features.push(Se)}}function Da(_e,Y,J,K,le,fe){const xe=K*K;if(K>0&&Y.size<(le?xe:K))return void(J.numPoints+=Y.length/3);const Ae=[];for(let Se=0;Se<Y.length;Se+=3)(K===0||Y[Se+2]>xe)&&(J.numSimplified++,Ae.push(Y[Se],Y[Se+1])),J.numPoints++;le&&(function(Se,Ne){let Xe=0;for(let Ge=0,St=Se.length,Te=St-2;Ge<St;Te=Ge,Ge+=2)Xe+=(Se[Ge]-Se[Te])*(Se[Ge+1]+Se[Te+1]);if(Xe>0===Ne)for(let Ge=0,St=Se.length;Ge<St/2;Ge+=2){const Te=Se[Ge],Ot=Se[Ge+1];Se[Ge]=Se[St-2-Ge],Se[Ge+1]=Se[St-1-Ge],Se[St-2-Ge]=Te,Se[St-1-Ge]=Ot}})(Ae,fe),_e.push(Ae)}const El={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class za{constructor(Y,J){const K=(J=this.options=(function(fe,xe){for(const Ae in xe)fe[Ae]=xe[Ae];return fe})(Object.create(El),J)).debug;if(K&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");let le=(function(fe,xe){const Ae=[];if(fe.type==="FeatureCollection")for(let Se=0;Se<fe.features.length;Se++)Vr(Ae,fe.features[Se],xe,Se);else Vr(Ae,fe.type==="Feature"?fe:{geometry:fe},xe);return Ae})(Y,J);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),le=(function(fe,xe){const Ae=xe.buffer/xe.extent;let Se=fe;const Ne=Ls(fe,1,-1-Ae,Ae,0,-1,2,xe),Xe=Ls(fe,1,1-Ae,2+Ae,0,-1,2,xe);return(Ne||Xe)&&(Se=Ls(fe,1,-Ae,1+Ae,0,-1,2,xe)||[],Ne&&(Se=Cl(Ne,1).concat(Se)),Xe&&(Se=Se.concat(Cl(Xe,-1)))),Se})(le,J),le.length&&this.splitTile(le,0,0,0),K&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Y,J,K,le,fe,xe,Ae){const Se=[Y,J,K,le],Ne=this.options,Xe=Ne.debug;for(;Se.length;){le=Se.pop(),K=Se.pop(),J=Se.pop(),Y=Se.pop();const Ge=1<<J,St=Oa(J,K,le);let Te=this.tiles[St];if(!Te&&(Xe>1&&console.time("creation"),Te=this.tiles[St]=ka(Y,J,K,le,Ne),this.tileCoords.push({z:J,x:K,y:le}),Xe)){Xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,K,le,Te.numFeatures,Te.numPoints,Te.numSimplified),console.timeEnd("creation"));const yr=`z${J}`;this.stats[yr]=(this.stats[yr]||0)+1,this.total++}if(Te.source=Y,fe==null){if(J===Ne.indexMaxZoom||Te.numPoints<=Ne.indexMaxPoints)continue}else{if(J===Ne.maxZoom||J===fe)continue;if(fe!=null){const yr=fe-J;if(K!==xe>>yr||le!==Ae>>yr)continue}}if(Te.source=null,Y.length===0)continue;Xe>1&&console.time("clipping");const Ot=.5*Ne.buffer/Ne.extent,Jt=.5-Ot,$t=.5+Ot,jt=1+Ot;let Oi=null,Mr=null,kr=null,ur=null,ti=Ls(Y,Ge,K-Ot,K+$t,0,Te.minX,Te.maxX,Ne),li=Ls(Y,Ge,K+Jt,K+jt,0,Te.minX,Te.maxX,Ne);Y=null,ti&&(Oi=Ls(ti,Ge,le-Ot,le+$t,1,Te.minY,Te.maxY,Ne),Mr=Ls(ti,Ge,le+Jt,le+jt,1,Te.minY,Te.maxY,Ne),ti=null),li&&(kr=Ls(li,Ge,le-Ot,le+$t,1,Te.minY,Te.maxY,Ne),ur=Ls(li,Ge,le+Jt,le+jt,1,Te.minY,Te.maxY,Ne),li=null),Xe>1&&console.timeEnd("clipping"),Se.push(Oi||[],J+1,2*K,2*le),Se.push(Mr||[],J+1,2*K,2*le+1),Se.push(kr||[],J+1,2*K+1,2*le),Se.push(ur||[],J+1,2*K+1,2*le+1)}}getTile(Y,J,K){Y=+Y,J=+J,K=+K;const le=this.options,{extent:fe,debug:xe}=le;if(Y<0||Y>24)return null;const Ae=1<<Y,Se=Oa(Y,J=J+Ae&Ae-1,K);if(this.tiles[Se])return So(this.tiles[Se],fe);xe>1&&console.log("drilling down to z%d-%d-%d",Y,J,K);let Ne,Xe=Y,Ge=J,St=K;for(;!Ne&&Xe>0;)Xe--,Ge>>=1,St>>=1,Ne=this.tiles[Oa(Xe,Ge,St)];return Ne&&Ne.source?(xe>1&&(console.log("found parent tile z%d-%d-%d",Xe,Ge,St),console.time("drilling down")),this.splitTile(Ne.source,Xe,Ge,St,Y,J,K),xe>1&&console.timeEnd("drilling down"),this.tiles[Se]?So(this.tiles[Se],fe):null):null}}function Oa(_e,Y,J){return 32*((1<<_e)*J+Y)+_e}class Ra extends k{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Y,J){return d._(this,void 0,void 0,(function*(){const K=Y.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const le=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!le)return null;const fe=new Ce(le.features,{version:2,extent:d.$});let xe=(function(Ae){const Se=new d.cM;return(function(Ne,Xe){for(const Ge in Ne.layers)Xe.writeMessage(3,Pe,Ne.layers[Ge])})(Ae,Se),Se.finish()})(fe);return xe.byteOffset===0&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),{vectorTile:fe,rawData:xe.buffer}}))}loadData(Y){return d._(this,void 0,void 0,(function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const K=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new d.cN(Y.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(Y,this._pendingRequest);const le=yield this._pendingData;this._geoJSONIndex=Y.cluster?new ge((function({superclusterOptions:xe,clusterProperties:Ae}){if(!Ae||!xe)return xe;const Se={},Ne={},Xe={accumulated:null,zoom:0},Ge={properties:null},St=Object.keys(Ae);for(const Te of St){const[Ot,Jt]=Ae[Te],$t=d.cT(Jt),jt=d.cT(typeof Ot=="string"?[Ot,["accumulated"],["get",Te]]:Ot);Se[Te]=$t.value,Ne[Te]=jt.value}return xe.map=Te=>{Ge.properties=Te;const Ot={};for(const Jt of St)Ot[Jt]=Se[Jt].evaluate(Xe,Ge);return Ot},xe.reduce=(Te,Ot)=>{Ge.properties=Ot;for(const Jt of St)Xe.accumulated=Te[Jt],Te[Jt]=Ne[Jt].evaluate(Xe,Ge)},xe})(Y)).load(le.features):(function(xe,Ae){return new za(xe,Ae)})(le,Y.geojsonVtOptions),this.loaded={};const fe={data:le};if(K){const xe=K.finish();xe&&(fe.resourceTiming={},fe.resourceTiming[Y.source]=JSON.parse(JSON.stringify(xe)))}return fe}catch(le){if(delete this._pendingRequest,d.cy(le))return{abandoned:!0};throw le}}))}getData(){return d._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(Y){const J=this.loaded;return J&&J[Y.uid]?super.reloadTile(Y):this.loadTile(Y)}loadAndProcessGeoJSON(Y,J){return d._(this,void 0,void 0,(function*(){let K=yield this.loadGeoJSON(Y,J);if(delete this._pendingRequest,typeof K!="object")throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`);if(pe(K,!0),Y.filter){const le=d.cT(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map((xe=>`${xe.key}: ${xe.message}`)).join(", "));K={type:"FeatureCollection",features:K.features.filter((xe=>le.value.evaluate({zoom:0},xe)))}}return K}))}loadGeoJSON(Y,J){return d._(this,void 0,void 0,(function*(){const{promoteId:K}=Y;if(Y.request){const le=yield d.j(Y.request,J);return this._dataUpdateable=d.cV(le.data,K)?d.cU(le.data,K):void 0,le.data}if(typeof Y.data=="string")try{const le=JSON.parse(Y.data);return this._dataUpdateable=d.cV(le,K)?d.cU(le,K):void 0,le}catch{throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`)}if(!Y.dataDiff)throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Y.source}`);return d.cW(this._dataUpdateable,Y.dataDiff,K),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(Y){return d._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(Y){return this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId)}getClusterChildren(Y){return this._geoJSONIndex.getChildren(Y.clusterId)}getClusterLeaves(Y){return this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset)}}class Ic{constructor(Y){this.self=Y,this.actor=new d.J(Y),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(J,K)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=K},this.self.addProtocol=d.cA,this.self.removeProtocol=d.cB,this.self.registerRTLTextPlugin=J=>{d.cX.setMethods(J)},this.actor.registerMessageHandler("LDT",((J,K)=>this._getDEMWorkerSource(J,K.source).loadTile(K))),this.actor.registerMessageHandler("RDT",((J,K)=>d._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(J,K.source).removeTile(K)})))),this.actor.registerMessageHandler("GCEZ",((J,K)=>d._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,K.type,K.source).getClusterExpansionZoom(K)})))),this.actor.registerMessageHandler("GCC",((J,K)=>d._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,K.type,K.source).getClusterChildren(K)})))),this.actor.registerMessageHandler("GCL",((J,K)=>d._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,K.type,K.source).getClusterLeaves(K)})))),this.actor.registerMessageHandler("LD",((J,K)=>this._getWorkerSource(J,K.type,K.source).loadData(K))),this.actor.registerMessageHandler("GD",((J,K)=>this._getWorkerSource(J,K.type,K.source).getData())),this.actor.registerMessageHandler("LT",((J,K)=>this._getWorkerSource(J,K.type,K.source).loadTile(K))),this.actor.registerMessageHandler("RT",((J,K)=>this._getWorkerSource(J,K.type,K.source).reloadTile(K))),this.actor.registerMessageHandler("AT",((J,K)=>this._getWorkerSource(J,K.type,K.source).abortTile(K))),this.actor.registerMessageHandler("RMT",((J,K)=>this._getWorkerSource(J,K.type,K.source).removeTile(K))),this.actor.registerMessageHandler("RS",((J,K)=>d._(this,void 0,void 0,(function*(){if(!this.workerSources[J]||!this.workerSources[J][K.type]||!this.workerSources[J][K.type][K.source])return;const le=this.workerSources[J][K.type][K.source];delete this.workerSources[J][K.type][K.source],le.removeSource!==void 0&&le.removeSource(K)})))),this.actor.registerMessageHandler("RM",(J=>d._(this,void 0,void 0,(function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J]})))),this.actor.registerMessageHandler("SR",((J,K)=>d._(this,void 0,void 0,(function*(){this.referrer=K})))),this.actor.registerMessageHandler("SRPS",((J,K)=>this._syncRTLPluginState(J,K))),this.actor.registerMessageHandler("IS",((J,K)=>d._(this,void 0,void 0,(function*(){this.self.importScripts(K)})))),this.actor.registerMessageHandler("SI",((J,K)=>this._setImages(J,K))),this.actor.registerMessageHandler("UL",((J,K)=>d._(this,void 0,void 0,(function*(){this._getLayerIndex(J).update(K.layers,K.removedIds)})))),this.actor.registerMessageHandler("SL",((J,K)=>d._(this,void 0,void 0,(function*(){this._getLayerIndex(J).replace(K)}))))}_setImages(Y,J){return d._(this,void 0,void 0,(function*(){this.availableImages[Y]=J;for(const K in this.workerSources[Y]){const le=this.workerSources[Y][K];for(const fe in le)le[fe].availableImages=J}}))}_syncRTLPluginState(Y,J){return d._(this,void 0,void 0,(function*(){return yield d.cX.syncState(J,this.self.importScripts)}))}_getAvailableImages(Y){let J=this.availableImages[Y];return J||(J=[]),J}_getLayerIndex(Y){let J=this.layerIndexes[Y];return J||(J=this.layerIndexes[Y]=new a),J}_getWorkerSource(Y,J,K){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][J]||(this.workerSources[Y][J]={}),!this.workerSources[Y][J][K]){const le={sendAsync:(fe,xe)=>(fe.targetMapId=Y,this.actor.sendAsync(fe,xe))};switch(J){case"vector":this.workerSources[Y][J][K]=new k(le,this._getLayerIndex(Y),this._getAvailableImages(Y));break;case"geojson":this.workerSources[Y][J][K]=new Ra(le,this._getLayerIndex(Y),this._getAvailableImages(Y));break;default:this.workerSources[Y][J][K]=new this.externalWorkerSourceTypes[J](le,this._getLayerIndex(Y),this._getAvailableImages(Y))}}return this.workerSources[Y][J][K]}_getDEMWorkerSource(Y,J){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][J]||(this.demWorkerSources[Y][J]=new L),this.demWorkerSources[Y][J]}}return d.i(self)&&(self.worker=new Ic(self)),Ic})),o("index",["exports","./shared"],(function(d,a){var v="5.7.1";function T(){var _=new a.A(4);return a.A!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_}let E,k;const L={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(_,n,u){const f=requestAnimationFrame((b=>{g(),n(b)})),{unsubscribe:g}=a.s(_.signal,"abort",(()=>{g(),cancelAnimationFrame(f),u(a.c())}),!1)},frameAsync(_){return new Promise(((n,u)=>{this.frame(_,n,u)}))},getImageData(_,n=0){return this.getImageCanvasContext(_).getImageData(-n,-n,_.width+2*n,_.height+2*n)},getImageCanvasContext(_){const n=window.document.createElement("canvas"),u=n.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return n.width=_.width,n.height=_.height,u.drawImage(_,0,0,_.width,_.height),u},resolveURL:_=>(E||(E=document.createElement("a")),E.href=_,E.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(k==null&&(k=matchMedia("(prefers-reduced-motion: reduce)")),k.matches)}};class O{static testProp(n){if(!O.docStyle)return n[0];for(let u=0;u<n.length;u++)if(n[u]in O.docStyle)return n[u];return n[0]}static create(n,u,f){const g=window.document.createElement(n);return u!==void 0&&(g.className=u),f&&f.appendChild(g),g}static createNS(n,u){return window.document.createElementNS(n,u)}static disableDrag(){O.docStyle&&O.selectProp&&(O.userSelect=O.docStyle[O.selectProp],O.docStyle[O.selectProp]="none")}static enableDrag(){O.docStyle&&O.selectProp&&(O.docStyle[O.selectProp]=O.userSelect)}static setTransform(n,u){n.style[O.transformProp]=u}static addEventListener(n,u,f,g={}){n.addEventListener(u,f,"passive"in g?g:g.capture)}static removeEventListener(n,u,f,g={}){n.removeEventListener(u,f,"passive"in g?g:g.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",O.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",O.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",O.suppressClickInternal,!0)}),0)}static getScale(n){const u=n.getBoundingClientRect();return{x:u.width/n.offsetWidth||1,y:u.height/n.offsetHeight||1,boundingClientRect:u}}static getPoint(n,u,f){const g=u.boundingClientRect;return new a.P((f.clientX-g.left)/u.x-n.clientLeft,(f.clientY-g.top)/u.y-n.clientTop)}static mousePos(n,u){const f=O.getScale(n);return O.getPoint(n,f,u)}static touchPos(n,u){const f=[],g=O.getScale(n);for(let b=0;b<u.length;b++)f.push(O.getPoint(n,g,u[b]));return f}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}static sanitize(n){const u=new DOMParser().parseFromString(n,"text/html").body||document.createElement("body"),f=u.querySelectorAll("script");for(const g of f)g.remove();return O.clean(u),u.innerHTML}static isPossiblyDangerous(n,u){const f=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(n)||!f.includes("javascript:")&&!f.includes("data:"))||!!n.startsWith("on")||void 0}static clean(n){const u=n.children;for(const f of u)O.removeAttributes(f),O.clean(f)}static removeAttributes(n){for(const{name:u,value:f}of n.attributes)O.isPossiblyDangerous(u,f)&&n.removeAttribute(u)}}O.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,O.selectProp=O.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),O.transformProp=O.testProp(["transform","WebkitTransform"]);const H={supported:!1,testSupport:function(_){!be&&pe&&(Ce?Pe(_):ie=_)}};let ie,pe,be=!1,Ce=!1;function Pe(_){const n=_.createTexture();_.bindTexture(_.TEXTURE_2D,n);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,pe),_.isContextLost())return;H.supported=!0}catch{}_.deleteTexture(n),be=!0}var Ie;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=()=>{ie&&Pe(ie),ie=null,Ce=!0},pe.onerror=()=>{be=!0,ie=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(_){let n,u,f,g;_.resetRequestQueue=()=>{n=[],u=0,f=0,g={}},_.addThrottleControl=M=>{const z=f++;return g[z]=M,z},_.removeThrottleControl=M=>{delete g[M],S()},_.getImage=(M,z,F=!0)=>new Promise(((j,B)=>{H.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),a.e(M,{type:"image"}),n.push({abortController:z,requestParameters:M,supportImageRefresh:F,state:"queued",onError:V=>{B(V)},onSuccess:V=>{j(V)}}),S()}));const b=M=>a._(this,void 0,void 0,(function*(){M.state="running";const{requestParameters:z,supportImageRefresh:F,onError:j,onSuccess:B,abortController:V}=M,W=F===!1&&!a.i(self)&&!a.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce(((re,se)=>re&&se==="accept"),!0));u++;const te=W?$(z,V):a.m(z,V);try{const re=yield te;delete M.abortController,M.state="completed",re.data instanceof HTMLImageElement||a.b(re.data)?B(re):re.data&&B({data:yield(ee=re.data,typeof createImageBitmap=="function"?a.f(ee):a.h(ee)),cacheControl:re.cacheControl,expires:re.expires})}catch(re){delete M.abortController,j(re)}finally{u--,S()}var ee})),S=()=>{const M=(()=>{for(const z of Object.keys(g))if(g[z]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=u;z<M&&n.length>0;z++){const F=n.shift();F.abortController.signal.aborted?z--:b(F)}},$=(M,z)=>new Promise(((F,j)=>{const B=new Image,V=M.url,W=M.credentials;W&&W==="include"?B.crossOrigin="use-credentials":(W&&W==="same-origin"||!a.d(V))&&(B.crossOrigin="anonymous"),z.signal.addEventListener("abort",(()=>{B.src="",j(a.c())})),B.fetchPriority="high",B.onload=()=>{B.onerror=B.onload=null,F({data:B})},B.onerror=()=>{B.onerror=B.onload=null,z.signal.aborted||j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},B.src=V}))})(Ie||(Ie={})),Ie.resetRequestQueue();class ke{constructor(n){this._transformRequestFn=n??null}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function Ke(_){const n=[];if(typeof _=="string")n.push({id:"default",url:_});else if(_&&_.length>0){const u=[];for(const{id:f,url:g}of _){const b=`${f}${g}`;u.indexOf(b)===-1&&(u.push(b),n.push({id:f,url:g}))}}return n}function qe(_,n,u){try{const f=new URL(_);return f.pathname+=`${n}${u}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${_}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function dt(_){const{userImage:n}=_;return!!(n&&n.render&&n.render())&&(_.data.replace(new Uint8Array(n.data.buffer)),!0)}class ft extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:u,promiseResolve:f}of this.requestors)f(this._getImagesForIds(u));this.requestors=[]}}getImage(n){const u=this.images[n];if(u&&!u.data&&u.spriteData){const f=u.spriteData;u.data=new a.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(n,u){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,u)&&(this.images[n]=u)}_validate(n,u){let f=!0;const g=u.data||u.spriteData;return this._validateStretch(u.stretchX,g&&g.width)||(this.fire(new a.k(new Error(`Image "${n}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,g&&g.height)||(this.fire(new a.k(new Error(`Image "${n}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new a.k(new Error(`Image "${n}" has invalid "content" value`))),f=!1),f}_validateStretch(n,u){if(!n)return!0;let f=0;for(const g of n){if(g[0]<f||g[1]<g[0]||u<g[1])return!1;f=g[1]}return!0}_validateContent(n,u){if(!n)return!0;if(n.length!==4)return!1;const f=u.spriteData,g=f&&f.width||u.data.width,b=f&&f.height||u.data.height;return!(n[0]<0||g<n[0]||n[1]<0||b<n[1]||n[2]<0||g<n[2]||n[3]<0||b<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,u,f=!0){const g=this.getImage(n);if(f&&(g.data.width!==u.data.width||g.data.height!==u.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=g.version+1,this.images[n]=u,this.updatedImages[n]=!0}removeImage(n){const u=this.images[n];delete this.images[n],delete this.patterns[n],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise(((u,f)=>{let g=!0;if(!this.isLoaded())for(const b of n)this.images[b]||(g=!1);this.isLoaded()||g?u(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:u})}))}_getImagesForIds(n){const u={};for(const f of n){let g=this.getImage(f);g||(this.fire(new a.l("styleimagemissing",{id:f})),g=this.getImage(f)),g?u[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:a.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:n,height:u}=this.atlasImage;return{width:n,height:u}}getPattern(n){const u=this.patterns[n],f=this.getImage(n);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},b=new a.I(g,f);this.patterns[n]={bin:g,position:b}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const u=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.T(n,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const b in this.patterns)n.push(this.patterns[b].bin);const{w:u,h:f}=a.p(n),g=this.atlasImage;g.resize({width:u||1,height:f||1});for(const b in this.patterns){const{bin:S}=this.patterns[b],$=S.x+1,M=S.y+1,z=this.getImage(b).data,F=z.width,j=z.height;a.R.copy(z,g,{x:0,y:0},{x:$,y:M},{width:F,height:j}),a.R.copy(z,g,{x:0,y:j-1},{x:$,y:M-1},{width:F,height:1}),a.R.copy(z,g,{x:0,y:0},{x:$,y:M+j},{width:F,height:1}),a.R.copy(z,g,{x:F-1,y:0},{x:$-1,y:M},{width:1,height:j}),a.R.copy(z,g,{x:0,y:0},{x:$+F,y:M},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const u of n){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.getImage(u);f||a.w(`Image with ID: "${u}" was not found`),dt(f)&&this.updateImage(u,f)}}}const et=1e20;function We(_,n,u,f,g,b,S,$,M){for(let z=n;z<n+f;z++)Be(_,u*b+z,b,g,S,$,M);for(let z=u;z<u+g;z++)Be(_,z*b+n,1,f,S,$,M)}function Be(_,n,u,f,g,b,S){b[0]=0,S[0]=-et,S[1]=et,g[0]=_[n];for(let $=1,M=0,z=0;$<f;$++){g[$]=_[n+$*u];const F=$*$;do{const j=b[M];z=(g[$]-g[j]+F-j*j)/($-j)/2}while(z<=S[M]&&--M>-1);M++,b[M]=$,S[M]=z,S[M+1]=et}for(let $=0,M=0;$<f;$++){for(;S[M+1]<$;)M++;const z=b[M],F=$-z;_[n+$*u]=g[z]+F*F}}class ge{constructor(n,u,f){this.requestManager=n,this.localIdeographFontFamily=u,this.entries={},this.lang=f}setURL(n){this.url=n}getGlyphs(n){return a._(this,void 0,void 0,(function*(){const u=[];for(const b in n)for(const S of n[b])u.push(this._getAndCacheGlyphsPromise(b,S));const f=yield Promise.all(u),g={};for(const{stack:b,id:S,glyph:$}of f)g[b]||(g[b]={}),g[b][S]=$&&{id:$.id,bitmap:$.bitmap.clone(),metrics:$.metrics};return g}))}_getAndCacheGlyphsPromise(n,u){return a._(this,void 0,void 0,(function*(){let f=this.entries[n];f||(f=this.entries[n]={glyphs:{},requests:{},ranges:{}});let g=f.glyphs[u];if(g!==void 0)return{stack:n,id:u,glyph:g};if(g=this._tinySDF(f,n,u),g)return f.glyphs[u]=g,{stack:n,id:u,glyph:g};const b=Math.floor(u/256);if(256*b>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[b])return{stack:n,id:u,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[b]){const $=ge.loadGlyphRange(n,b,this.url,this.requestManager);f.requests[b]=$}const S=yield f.requests[b];for(const $ in S)this._doesCharSupportLocalGlyph(+$)||(f.glyphs[+$]=S[+$]);return f.ranges[b]=!0,{stack:n,id:u,glyph:S[u]||null}}))}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))||a.u["CJK Unified Ideographs"](n)||a.u["Hangul Syllables"](n)||a.u.Hiragana(n)||a.u.Katakana(n)||a.u["CJK Symbols and Punctuation"](n)||a.u["Halfwidth and Fullwidth Forms"](n))}_tinySDF(n,u,f){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let b=n.tinySDF;if(!b){let $="400";/bold/i.test(u)?$="900":/medium/i.test(u)?$="500":/light/i.test(u)&&($="200"),b=n.tinySDF=new ge.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:g,fontWeight:$})}const S=b.draw(String.fromCharCode(f));return{id:f,bitmap:new a.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}ge.loadGlyphRange=function(_,n,u,f){return a._(this,void 0,void 0,(function*(){const g=256*n,b=g+255,S=f.transformRequest(u.replace("{fontstack}",_).replace("{range}",`${g}-${b}`),"Glyphs"),$=yield a.n(S,new AbortController);if(!$||!$.data)throw new Error(`Could not load glyph range. range: ${n}, ${g}-${b}`);const M={};for(const z of a.o($.data))M[z.id]=z;return M}))},ge.TinySDF=class{constructor({fontSize:_=24,buffer:n=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:b="normal",fontStyle:S="normal",lang:$=null}={}){this.buffer=n,this.cutoff=f,this.radius=u,this.lang=$;const M=this.size=_+4*n,z=this._createCanvas(M),F=this.ctx=z.getContext("2d",{willReadFrequently:!0});F.font=`${S} ${b} ${_}px ${g}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(_){const n=document.createElement("canvas");return n.width=n.height=_,n}draw(_){const{width:n,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:b}=this.ctx.measureText(_),S=Math.ceil(u),$=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-g))),M=Math.min(this.size-this.buffer,S+Math.ceil(f)),z=$+2*this.buffer,F=M+2*this.buffer,j=Math.max(z*F,0),B=new Uint8ClampedArray(j),V={data:B,width:z,height:F,glyphWidth:$,glyphHeight:M,glyphTop:S,glyphLeft:0,glyphAdvance:n};if($===0||M===0)return V;const{ctx:W,buffer:te,gridInner:ee,gridOuter:re}=this;this.lang&&(W.lang=this.lang),W.clearRect(te,te,$,M),W.fillText(_,te,te+S);const se=W.getImageData(te,te,$,M);re.fill(et,0,j),ee.fill(0,0,j);for(let ce=0;ce<M;ce++)for(let oe=0;oe<$;oe++){const he=se.data[4*(ce*$+oe)+3]/255;if(he===0)continue;const me=(ce+te)*z+oe+te;if(he===1)re[me]=0,ee[me]=et;else{const ae=.5-he;re[me]=ae>0?ae*ae:0,ee[me]=ae<0?ae*ae:0}}We(re,0,0,z,F,z,this.f,this.v,this.z),We(ee,te,te,$,M,z,this.f,this.v,this.z);for(let ce=0;ce<j;ce++){const oe=Math.sqrt(re[ce])-Math.sqrt(ee[ce]);B[ce]=Math.round(255-255*(oe/this.radius+this.cutoff))}return V}};class De{constructor(){this.specification=a.v.light.position}possiblyEvaluate(n,u){return a.B(n.expression.evaluate(u))}interpolate(n,u,f){return{x:a.C.number(n.x,u.x,f),y:a.C.number(n.y,u.y,f),z:a.C.number(n.z,u.z,f)}}}let Je;class Qe extends a.E{constructor(n){super(),Je=Je||new a.r({anchor:new a.D(a.v.light.anchor),position:new De,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.t(Je),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u={}){if(!this._validate(a.x,n,u))for(const f in n){const g=n[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,f){return(!f||f.validate!==!1)&&a.y(this,n.call(a.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}const yt=new a.r({"sky-color":new a.D(a.v.sky["sky-color"]),"horizon-color":new a.D(a.v.sky["horizon-color"]),"fog-color":new a.D(a.v.sky["fog-color"]),"fog-ground-blend":new a.D(a.v.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.v.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.v.sky["atmosphere-blend"])});class Et extends a.E{constructor(n){super(),this._transitionable=new a.t(yt),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0))}setSky(n,u={}){if(!this._validate(a.G,n,u)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in n){const g=n[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,f={}){return f?.validate!==!1&&a.y(this,n.call(a.z,a.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class Ye{constructor(n,u){this.width=n,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,u){const f=n.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(n,u)),this.dashEntry[f]}getDashRanges(n,u,f){const g=[];let b=n.length%2==1?-n[n.length-1]*f:0,S=n[0]*f,$=!0;g.push({left:b,right:S,isDash:$,zeroLength:n[0]===0});let M=n[0];for(let z=1;z<n.length;z++){$=!$;const F=n[z];b=M*f,M+=F,S=M*f,g.push({left:b,right:S,isDash:$,zeroLength:F===0})}return g}addRoundDash(n,u,f){const g=u/2;for(let b=-f;b<=f;b++){const S=this.width*(this.nextRow+f+b);let $=0,M=n[$];for(let z=0;z<this.width;z++){z/M.right>1&&(M=n[++$]);const F=Math.abs(z-M.left),j=Math.abs(z-M.right),B=Math.min(F,j);let V;const W=b/f*(g+1);if(M.isDash){const te=g-Math.abs(W);V=Math.sqrt(B*B+te*te)}else V=g-Math.sqrt(B*B+W*W);this.data[S+z]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(n){for(let $=n.length-1;$>=0;--$){const M=n[$],z=n[$+1];M.zeroLength?n.splice($,1):z&&z.isDash===M.isDash&&(z.left=M.left,n.splice($,1))}const u=n[0],f=n[n.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const g=this.width*this.nextRow;let b=0,S=n[b];for(let $=0;$<this.width;$++){$/S.right>1&&(S=n[++b]);const M=Math.abs($-S.left),z=Math.abs($-S.right),F=Math.min(M,z);this.data[g+$]=Math.max(0,Math.min(255,(S.isDash?F:-F)+128))}}addDash(n,u){const f=u?7:0,g=2*f+1;if(this.nextRow+g>this.height)return a.w("LineAtlas out of space"),null;let b=0;for(let $=0;$<n.length;$++)b+=n[$];if(b!==0){const $=this.width/b,M=this.getDashRanges(n,this.width,$);u?this.addRoundDash(M,$,f):this.addRegularDash(M)}const S={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:b};return this.nextRow+=g,this.dirty=!0,S}bind(n){const u=n.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const bt="maplibre_preloaded_worker_pool";class Dt{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Dt.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach((u=>{u.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[bt]}numActive(){return Object.keys(this.active).length}}const Si=Math.floor(L.hardwareConcurrency/2);let Vr,nn;function es(){return Vr||(Vr=new Dt),Vr}Dt.workerCount=a.H(globalThis)?Math.max(Math.min(Si,3),1):1;class sn{constructor(n,u){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=u;const f=this.workerPool.acquire(u);for(let g=0;g<f.length;g++){const b=new a.J(f[g],u);b.name=`Worker ${g}`,this.actors.push(b)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,u){const f=[];for(const g of this.actors)f.push(g.sendAsync({type:n,data:u}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach((u=>{u.remove()})),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,u){for(const f of this.actors)f.registerMessageHandler(n,u)}}function bo(){return nn||(nn=new sn(es(),a.K),nn.registerMessageHandler("GR",((_,n,u)=>a.m(n,u)))),nn}function dn(_,n){const u=a.L();return a.M(u,u,[1,1,0]),a.N(u,u,[.5*_.width,.5*_.height,1]),_.calculatePosMatrix?a.O(u,u,_.calculatePosMatrix(n.toUnwrapped())):u}function Ls(_,n,u,f,g,b,S){var $;const M=(function(B,V,W){if(B)for(const te of B){const ee=V[te];if(ee&&ee.source===W&&ee.type==="fill-extrusion")return!0}else for(const te in V){const ee=V[te];if(ee.source===W&&ee.type==="fill-extrusion")return!0}return!1})(($=g?.layers)!==null&&$!==void 0?$:null,n,_.id),z=b.maxPitchScaleFactor(),F=_.tilesIn(f,z,M);F.sort(Tc);const j=[];for(const B of F)j.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(n,u,_._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,g,b,z,dn(_.transform,B.tileID),S?(V,W)=>S(B.tileID,V,W):void 0)});return(function(B,V){for(const W in B)for(const te of B[W])Cc(te,V);return B})((function(B){const V={},W={};for(const te of B){const ee=te.queryResults,re=te.wrappedTileID,se=W[re]=W[re]||{};for(const ce in ee){const oe=ee[ce],he=se[ce]=se[ce]||{},me=V[ce]=V[ce]||[];for(const ae of oe)he[ae.featureIndex]||(he[ae.featureIndex]=!0,me.push(ae))}}return V})(j),_)}function Tc(_,n){const u=_.tileID,f=n.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}function Cc(_,n){const u=_.feature,f=n.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=f}function ts(_,n,u){return a._(this,void 0,void 0,(function*(){let f=_;if(_.url?f=(yield a.j(n.transformRequest(_.url,"Source"),u)).data:yield L.frameAsync(u),!f)return null;const g=a.Q(a.e(f,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(g.vectorLayerIds=f.vector_layers.map((b=>b.id))),g}))}class er{constructor(n,u){n&&(u?this.setSouthWest(n).setNorthEast(u):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof a.S?new a.S(n.lng,n.lat):a.S.convert(n),this}setSouthWest(n){return this._sw=n instanceof a.S?new a.S(n.lng,n.lat):a.S.convert(n),this}extend(n){const u=this._sw,f=this._ne;let g,b;if(n instanceof a.S)g=n,b=n;else{if(!(n instanceof er))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(er.convert(n)):this.extend(a.S.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(a.S.convert(n)):this;if(g=n._sw,b=n._ne,!g||!b)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(b.lng,f.lng),f.lat=Math.max(b.lat,f.lat)):(this._sw=new a.S(g.lng,g.lat),this._ne=new a.S(b.lng,b.lat)),this}getCenter(){return new a.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.S(this.getWest(),this.getNorth())}getSouthEast(){return new a.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:u,lat:f}=a.S.convert(n);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(n){return n instanceof er?n:n&&new er(n)}static fromLngLat(n,u=0){const f=360*u/40075017,g=f/Math.cos(Math.PI/180*n.lat);return new er(new a.S(n.lng-g,n.lat-f),new a.S(n.lng+g,n.lat+f))}adjustAntiMeridian(){const n=new a.S(this._sw.lng,this._sw.lat),u=new a.S(this._ne.lng,this._ne.lat);return new er(n,n.lng>u.lng?new a.S(u.lng+360,u.lat):u)}}class cr{constructor(n,u,f){this.bounds=er.convert(this.validateBounds(n)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const u=Math.pow(2,n.z),f=Math.floor(a.V(this.bounds.getWest())*u),g=Math.floor(a.U(this.bounds.getNorth())*u),b=Math.ceil(a.V(this.bounds.getEast())*u),S=Math.ceil(a.U(this.bounds.getSouth())*u);return n.x>=f&&n.x<b&&n.y>=g&&n.y<S}}class Fs extends a.E{constructor(n,u,f,g){if(super(),this.id=n,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.Q(u,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield ts(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(a.e(this,n),n.bounds&&(this.tileBounds=new cr(n.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new a.k(n))}}))}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty((()=>{this._options.tiles=n})),this}setUrl(n){return this.setSourceProperty((()=>{this.url=n,this._options.url=n})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(n){return a._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(u,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};f.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise(((b,S)=>{n.reloadPromise={resolve:b,reject:S}}))}else n.actor=this.dispatcher.getActor(),g="LT";n.abortController=new AbortController;try{const b=yield n.actor.sendAsync({type:g,data:f},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,b)}catch(b){if(delete n.abortController,n.aborted)return;if(b&&b.status!==404)throw b;this._afterTileLoadWorkerResponse(n,null)}}))}_afterTileLoadWorkerResponse(n,u){if(u&&u.resourceTiming&&(n.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&n.setExpiryData(u),n.loadVectorData(u,this.map.painter),n.reloadPromise){const f=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(f.resolve).catch(f.reject)}}abortTile(n){return a._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))}))}unloadTile(n){return a._(this,void 0,void 0,(function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class xo extends a.E{constructor(n,u,f,g){super(),this.id=n,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},u),a.e(this,a.Q(u,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,(function*(n=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield ts(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(a.e(this,u),u.bounds&&(this.tileBounds=new cr(u.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(u){this._tileJSONRequest=null,this.fire(new a.k(u))}}))}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load(!0)}setTiles(n){return this.setSourceProperty((()=>{this._options.tiles=n})),this}setUrl(n){return this.setSourceProperty((()=>{this.url=n,this._options.url=n})),this}serialize(){return a.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return a._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const f=yield Ie.getImage(this.map._requestManager.transformRequest(u,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&n.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const g=this.map.painter.context,b=g.gl,S=f.data;n.texture=this.map.painter.getTileTexture(S.width),n.texture?n.texture.update(S,{useMipmap:!0}):(n.texture=new a.T(g,S,b.RGBA,{useMipmap:!0}),n.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(f){if(delete n.abortController,n.aborted)n.state="unloaded";else if(f)throw n.state="errored",f}}))}abortTile(n){return a._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)}))}unloadTile(n){return a._(this,void 0,void 0,(function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)}))}hasTransition(){return!1}}class Cl extends xo{constructor(n,u,f,g){super(n,u,f,g),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(n){return a._(this,void 0,void 0,(function*(){const u=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(u,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const g=yield Ie.getImage(f,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(g&&g.data){const b=g.data;this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&n.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const S=a.b(b)&&a.W()?b:yield this.readImageNow(b),$={type:this.type,uid:n.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const M=yield n.actor.sendAsync({type:"LDT",data:$});n.dem=M,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(g){if(delete n.abortController,n.aborted)n.state="unloaded";else if(g)throw n.state="errored",g}}))}readImageNow(n){return a._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&a.X()){const u=n.width+2,f=n.height+2;try{return new a.R({width:u,height:f},yield a.Y(n,-1,-1,u,f))}catch{}}return L.getImageData(n,1)}))}_getNeighboringTiles(n){const u=n.canonical,f=Math.pow(2,u.z),g=(u.x-1+f)%f,b=u.x===0?n.wrap-1:n.wrap,S=(u.x+1+f)%f,$=u.x+1===f?n.wrap+1:n.wrap,M={};return M[new a.Z(n.overscaledZ,b,u.z,g,u.y).key]={backfilled:!1},M[new a.Z(n.overscaledZ,$,u.z,S,u.y).key]={backfilled:!1},u.y>0&&(M[new a.Z(n.overscaledZ,b,u.z,g,u.y-1).key]={backfilled:!1},M[new a.Z(n.overscaledZ,n.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},M[new a.Z(n.overscaledZ,$,u.z,S,u.y-1).key]={backfilled:!1}),u.y+1<f&&(M[new a.Z(n.overscaledZ,b,u.z,g,u.y+1).key]={backfilled:!1},M[new a.Z(n.overscaledZ,n.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},M[new a.Z(n.overscaledZ,$,u.z,S,u.y+1).key]={backfilled:!1}),M}unloadTile(n){return a._(this,void 0,void 0,(function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))}))}}class wo extends a.E{constructor(n,u,f,g){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=f.getActor(),this.setEventedParent(g),this._data=u.data,this._options=a.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:a.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(n){return n*(a.$/this.tileSize)}_getClusterMaxZoom(n){const u=n?Math.round(n):this.maxzoom-1;return Number.isInteger(n)||n===void 0||a.w(`Integer expected for option 'clusterMaxZoom': provided value "${n}" rounded to "${u}"`),u}load(){return a._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._pendingWorkerUpdate={data:n},this._updateWorkerData(),this}updateData(n){return this._pendingWorkerUpdate.diff=a.a0(this._pendingWorkerUpdate.diff,n),this._updateWorkerData(),this}getData(){return a._(this,void 0,void 0,(function*(){const n=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})}))}getCoordinatesFromGeometry(n){return n.type==="GeometryCollection"?n.geometries.map((u=>u.coordinates)).flat(1/0):n.coordinates.flat(1/0)}getBounds(){return a._(this,void 0,void 0,(function*(){const n=new er,u=yield this.getData();let f;switch(u.type){case"FeatureCollection":f=u.features.map((g=>this.getCoordinatesFromGeometry(g.geometry))).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(u.geometry);break;default:f=this.getCoordinatesFromGeometry(u)}if(f.length==0)return n;for(let g=0;g<f.length-1;g+=2)n.extend([f[g],f[g+1]]);return n}))}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(n.clusterRadius)),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(n.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,u,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:u,offset:f}})}_updateWorkerData(){return a._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:n,diff:u}=this._pendingWorkerUpdate;if(!n&&!u)return void a.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const f=a.e({type:this.type},this.workerOptions);n?(typeof n=="string"?(f.request=this.map._requestManager.transformRequest(L.resolveURL(n),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(n),this._pendingWorkerUpdate.data=void 0):u&&(f.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new a.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||g.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));this._data=g.data;let b=null;g.resourceTiming&&g.resourceTiming[this.id]&&(b=g.resourceTiming[this.id].slice(0));const S={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&a.e(S,{resourceTiming:b}),this.fire(new a.l("data",Object.assign(Object.assign({},S),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},S),{sourceDataType:"content"})))}catch(g){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(g))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(n){return a._(this,void 0,void 0,(function*(){const u=n.actor?"RT":"LT";n.actor=this.actor;const f={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};n.abortController=new AbortController;const g=yield this.actor.sendAsync({type:u,data:f},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(g,this.map.painter,u==="RT")}))}abortTile(n){return a._(this,void 0,void 0,(function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0}))}unloadTile(n){return a._(this,void 0,void 0,(function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class So extends a.E{constructor(n,u,f,g){super(),this.flippedWindingOrder=!1,this.id=n,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=u}load(n){return a._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield Ie.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,n&&(this.coordinates=n),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new a.k(u))}}))}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const u=n.map(a.a1.fromLngLat);var f;return this.tileID=(function(g){const b=a.a2.fromPoints(g),S=b.width(),$=b.height(),M=Math.max(S,$),z=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),F=Math.pow(2,z);return new a.a4(z,Math.floor((b.minX+b.maxX)/2*F),Math.floor((b.minY+b.maxY)/2*F))})(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map((g=>this.tileID.getTilePoint(g)._round())),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,u=n.gl;this.texture||(this.texture=new a.T(n,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const b=this.tiles[g];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,f=!0)}f&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return a._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(n){const{minX:u,minY:f,maxX:g,maxY:b}=a.a2.fromPoints(n),S={};for(let $=0;$<=a.a3;$++){const M=Math.pow(2,$),z=Math.floor(u*M),F=Math.floor(f*M),j=Math.floor(g*M),B=Math.floor(b*M);S[$]={minTileX:z,minTileY:F,maxTileX:j,maxTileY:B}}return S}}class Ec extends So{constructor(n,u,f,g){super(n,u,f,g),this.roundZoom=!0,this.type="video",this.options=u}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const u of n.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield a.a5(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new a.k(u))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const u=this.video.seekable;n<u.start(0)||n>u.end(0)?this.fire(new a.k(new a.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,u=n.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(n,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const b=this.tiles[g];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,f=!0)}f&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ka extends So{constructor(n,u,f,g){super(n,u,f,g),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some((b=>!Array.isArray(b)||b.length!==2||b.some((S=>typeof S!="number"))))||this.fire(new a.k(new a.a6(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.a6(`sources.${n}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.k(new a.a6(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.a6(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.a6(`sources.${n}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return a._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,f=u.gl;this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(u,this.canvas,f.RGBA,{premultiply:!0});let g=!1;for(const b in this.tiles){const S=this.tiles[b];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,g=!0)}g&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Aa={},Da=_=>{switch(_){case"geojson":return wo;case"image":return So;case"raster":return xo;case"raster-dem":return Cl;case"vector":return Fs;case"video":return Ec;case"canvas":return ka}return Aa[_]},El="RTLPluginLoaded";class za extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=bo()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch((u=>{throw this.status="error",u}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return a._(this,arguments,void 0,(function*(u,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=L.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return a._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(El))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Oa=null;function Ra(){return Oa||(Oa=new za),Oa}class Ic{constructor(n,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=a.a7(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const u=n+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=(function(g,b){const S={};if(!b)return S;for(const $ of g){const M=$.layerIds.map((z=>b.getLayer(z))).filter(Boolean);if(M.length!==0){$.layers=M,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map((z=>M.filter((F=>F.id===z))[0])));for(const z of M)S[z.id]=$}}return S})(n.buckets,u?.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const b=this.buckets[g];if(b instanceof a.a9){if(this.hasSymbolBuckets=!0,!f)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const b=this.buckets[g];if(b instanceof a.a9&&b.hasRTLText){this.hasRTLText=!0,Ra().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const b=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(b))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new a.a8}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(n)}const u=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new a.T(n,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(n,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,u,f,g,b,S,$,M,z,F,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:b,scale:S,tileSize:this.tileSize,pixelPosMatrix:F,transform:M,params:$,queryPadding:this.queryPadding*z,getElevation:j},n,u,f):{}}querySourceFeatures(n,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),b=u&&u.sourceLayer?u.sourceLayer:"",S=g._geojsonTileLayer||g[b];if(!S)return;const $=a.aa(u&&u.filter),{z:M,x:z,y:F}=this.tileID.canonical,j={z:M,x:z,y:F};for(let B=0;B<S.length;B++){const V=S.feature(B);if($.needGeometry){const ee=a.ab(V,!0);if(!$.filter(new a.F(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!$.filter(new a.F(this.tileID.overscaledZ),V))continue;const W=f.getId(V,b),te=new a.ac(V,M,z,F,W);te.tile=j,n.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const f=a.ad(n.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const b=this.expirationTime-u;b?this.expirationTime=f+Math.max(b,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!u.style.hasLayer(g))continue;const b=this.buckets[g],S=b.layers[0].sourceLayer||"_geojsonTileLayer",$=f[S],M=n[S];if(!$||!M||Object.keys(M).length===0)continue;b.update(M,$,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=u&&u.style&&u.style.getLayer(g);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<L.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=L.now()+n}setDependencies(n,u){const f={};for(const g of u)f[g]=!0;this.dependencies[n]=f}hasDependency(n,u){for(const f of n){const g=this.dependencies[f];if(g){for(const b of u)if(g[b])return!0}}return!1}}class _e{constructor(n,u){this.max=n,this.onRemove=u,this.reset()}reset(){for(const n in this.data)for(const u of this.data[n])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(n,u,f){const g=n.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const b={value:u,timeout:void 0};if(f!==void 0&&(b.timeout=setTimeout((()=>{this.remove(n,b)}),f)),this.data[g].push(b),this.order.push(g),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const u=this.data[n].shift();return u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),u.value}getByKey(n){const u=this.data[n];return u?u[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,u){if(!this.has(n))return this;const f=n.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),b=this.data[f][g];return this.data[f].splice(g,1),b.timeout&&clearTimeout(b.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(b.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(n){const u=[];for(const f in this.data)for(const g of this.data[f])n(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class Y{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,u,f){const g=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][g]=this.stateChanges[n][g]||{},a.e(this.stateChanges[n][g],f),this.deletedStates[n]===null){this.deletedStates[n]={};for(const b in this.state[n])b!==g&&(this.deletedStates[n][b]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][g]===null){this.deletedStates[n][g]={};for(const b in this.state[n][g])f[b]||(this.deletedStates[n][g][b]=null)}else for(const b in f)this.deletedStates[n]&&this.deletedStates[n][g]&&this.deletedStates[n][g][b]===null&&delete this.deletedStates[n][g][b]}removeFeatureState(n,u,f){if(this.deletedStates[n]===null)return;const g=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},f&&u!==void 0)this.deletedStates[n][g]!==null&&(this.deletedStates[n][g]=this.deletedStates[n][g]||{},this.deletedStates[n][g][f]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][g])for(f in this.deletedStates[n][g]={},this.stateChanges[n][g])this.deletedStates[n][g][f]=null;else this.deletedStates[n][g]=null;else this.deletedStates[n]=null}getState(n,u){const f=String(u),g=a.e({},(this.state[n]||{})[f],(this.stateChanges[n]||{})[f]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const b=this.deletedStates[n][u];if(b===null)return{};for(const S in b)delete g[S]}return g}initializeTileState(n,u){n.setFeatureState(this.state,u)}coalesceChanges(n,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const b={};for(const S in this.stateChanges[g])this.state[g][S]||(this.state[g][S]={}),a.e(this.state[g][S],this.stateChanges[g][S]),b[S]=this.state[g][S];f[g]=b}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const b={};if(this.deletedStates[g]===null)for(const S in this.state[g])b[S]={},this.state[g][S]={};else for(const S in this.deletedStates[g]){if(this.deletedStates[g][S]===null)this.state[g][S]={};else for(const $ of Object.keys(this.deletedStates[g][S]))delete this.state[g][S][$];b[S]=this.state[g][S]}f[g]=f[g]||{},a.e(f[g],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in n)n[g].setFeatureState(f,u)}}const J=89.25;function K(_,n){const u=a.ah(n.lat,-a.ai,a.ai);return new a.P(a.V(n.lng)*_,a.U(u)*_)}function le(_,n){return new a.a1(n.x/_,n.y/_).toLngLat()}function fe(_){return _.cameraToCenterDistance*Math.min(.85*Math.tan(a.ae(90-_.pitch)),Math.tan(a.ae(J-_.pitch)))}function xe(_,n){const u=_.canonical,f=n/a.af(u.z),g=u.x+Math.pow(2,u.z)*_.wrap,b=a.ag(new Float64Array(16));return a.M(b,b,[g*f,u.y*f,0]),a.N(b,b,[f/a.$,f/a.$,1]),b}function Ae(_,n,u,f,g){const b=a.a1.fromLngLat(_,n),S=g*a.aj(1,_.lat),$=S*Math.cos(a.ae(u)),M=Math.sqrt(S*S-$*$),z=M*Math.sin(a.ae(-f)),F=M*Math.cos(a.ae(-f));return new a.a1(b.x+z,b.y+F,b.z+$)}function Se(_,n,u){const f=n.intersectsFrustum(_);if(!u||f===0)return f;const g=n.intersectsPlane(u);return g===0?0:f===2&&g===2?2:1}function Ne(_,n,u){let f=0;const g=(u-n)/10;for(let b=0;b<10;b++)f+=g*Math.pow(Math.cos(n+(b+.5)/10*(u-n)),_);return f}function Xe(_,n){return function(u,f,g,b,S){const $=2*((_-1)/a.ak(Math.cos(a.ae(J-S))/Math.cos(a.ae(J)))-1),M=Math.acos(g/b),z=2*Ne($-1,0,a.ae(S/2)),F=Math.min(a.ae(J),M+a.ae(S/2)),j=Ne($-1,Math.min(F,M-a.ae(S/2)),F),B=Math.atan(f/g),V=Math.hypot(f,g);let W=u;return W+=a.ak(b/V/Math.max(.5,Math.cos(a.ae(S/2)))),W+=$*a.ak(Math.cos(B))/2,W-=a.ak(Math.max(1,j/z/n))/2,W}}const Ge=Xe(9.314,3);function St(_,n){const u=(n.roundZoom?Math.round:Math.floor)(_.zoom+a.ak(_.tileSize/n.tileSize));return Math.max(0,u)}function Te(_,n){const u=_.getCameraFrustum(),f=_.getClippingPlane(),g=_.screenPointToMercatorCoordinate(_.getCameraPoint()),b=a.a1.fromLngLat(_.center,_.elevation);g.z=b.z+Math.cos(_.pitchInRadians)*_.cameraToCenterDistance/_.worldSize;const S=_.getCoveringTilesDetailsProvider(),$=S.allowVariableZoom(_,n),M=St(_,n),z=n.minzoom||0,F=n.maxzoom!==void 0?n.maxzoom:_.maxZoom,j=Math.min(Math.max(0,M),F),B=Math.pow(2,j),V=[B*g.x,B*g.y,0],W=[B*b.x,B*b.y,0],te=Math.hypot(b.x-g.x,b.y-g.y),ee=Math.abs(b.z-g.z),re=Math.hypot(te,ee),se=he=>({zoom:0,x:0,y:0,wrap:he,fullyVisible:!1}),ce=[],oe=[];if(_.renderWorldCopies&&S.allowWorldCopies())for(let he=1;he<=3;he++)ce.push(se(-he)),ce.push(se(he));for(ce.push(se(0));ce.length>0;){const he=ce.pop(),me=he.x,ae=he.y;let we=he.fullyVisible;const Oe={x:me,y:ae,z:he.zoom},Ee=S.getTileBoundingVolume(Oe,he.wrap,_.elevation,n);if(!we){const st=Se(u,Ee,f);if(st===0)continue;we=st===2}const $e=S.distanceToTile2d(g.x,g.y,Oe,Ee);let ze=M;$&&(ze=(n.calculateTileZoom||Ge)(_.zoom+a.ak(_.tileSize/n.tileSize),$e,ee,re,_.fov)),ze=(n.roundZoom?Math.round:Math.floor)(ze),ze=Math.max(0,ze);const tt=Math.min(ze,F);if(he.wrap=S.getWrap(b,Oe,he.wrap),he.zoom>=tt){if(he.zoom<z)continue;const st=j-he.zoom,He=V[0]-.5-(me<<st),xt=V[1]-.5-(ae<<st),Ht=n.reparseOverscaled?Math.max(he.zoom,ze):he.zoom;oe.push({tileID:new a.Z(he.zoom===F?Ht:he.zoom,he.wrap,he.zoom,me,ae),distanceSq:a.al([W[0]-.5-me,W[1]-.5-ae]),tileDistanceToCamera:Math.sqrt(He*He+xt*xt)})}else for(let st=0;st<4;st++)ce.push({zoom:he.zoom+1,x:(me<<1)+st%2,y:(ae<<1)+(st>>1),wrap:he.wrap,fullyVisible:we})}return oe.sort(((he,me)=>he.distanceSq-me.distanceSq)).map((he=>he.tileID))}const Ot=a.a2.fromPoints([new a.P(0,0),new a.P(a.$,a.$)]);class Jt extends a.E{constructor(n,u,f){super(),this.id=n,this.dispatcher=f,this.on("data",(g=>this._dataHandler(g))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((g,b,S,$)=>{const M=new(Da(b.type))(g,b,S,$);if(M.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${M.id}`);return M})(n,u,f,this),this._tiles={},this._cache=new _e(0,(g=>this._unloadTile(g))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Y,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const u=this._tiles[n];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,u,f){return a._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,u,f)}catch(g){n.state="errored",g.status!==404?this._source.fire(new a.k(g,{tile:n})):this.update(this.transform,this.terrain)}}))}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new a.l("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(n),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((n=>n.tileID)).sort($t).map((n=>n.key))}getRenderableIds(n){const u=[];for(const f in this._tiles)this._isIdRenderable(f,n)&&u.push(this._tiles[f]);return n?u.sort(((f,g)=>{const b=f.tileID,S=g.tileID,$=new a.P(b.canonical.x,b.canonical.y)._rotate(-this.transform.bearingInRadians),M=new a.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return b.overscaledZ-S.overscaledZ||M.y-$.y||M.x-$.x})).map((f=>f.tileID.key)):u.map((f=>f.tileID)).sort($t).map((f=>f.key))}hasRenderableParent(n){const u=this.findLoadedParent(n,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(n,u){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(u||!this._tiles[n].holdingForFade())}reload(n){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)n?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(n,u){return a._(this,void 0,void 0,(function*(){const f=this._tiles[n];f&&(f.state!=="loading"&&(f.state=u),yield this._loadTile(f,n,u))}))}_tileLoaded(n,u,f){n.timeAdded=L.now(),f==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const b=u[g];if(n.neighboringTiles&&n.neighboringTiles[b]){const S=this.getTileByID(b);f(n,S),f(S,n)}}function f(g,b){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let S=b.tileID.canonical.x-g.tileID.canonical.x;const $=b.tileID.canonical.y-g.tileID.canonical.y,M=Math.pow(2,g.tileID.canonical.z),z=b.tileID.key;S===0&&$===0||Math.abs($)>1||(Math.abs(S)>1&&(Math.abs(S+M)===1?S+=M:Math.abs(S-M)===1&&(S-=M)),b.dem&&g.dem&&(g.dem.backfillBorder(b.dem,S,$),g.neighboringTiles&&g.neighboringTiles[z]&&(g.neighboringTiles[z].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,u,f,g){for(const b in this._tiles){let S=this._tiles[b];if(g[b]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>f)continue;let $=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const z=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[z.key],S&&S.hasData()&&($=z)}let M=$;for(;M.overscaledZ>u;)if(M=M.scaledTo(M.overscaledZ-1),n[M.key]||n[M.canonical.key]){g[$.key]=$;break}}}findLoadedParent(n,u){if(n.key in this._loadedParentTiles){const f=this._loadedParentTiles[n.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=n.overscaledZ-1;f>=u;f--){const g=n.scaledTo(f),b=this._getLoadedTile(g);if(b)return b}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const u=this._tiles[n.key];return u&&u.hasData()?u:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const u=Math.ceil(n.width/this._source.tileSize)+1,f=Math.ceil(n.height/this._source.tileSize)+1,g=Math.floor(u*f*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(b)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,u){const f={};for(const g in this._tiles){const b=this._tiles[g];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+u),f[b.tileID.key]=b}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}_updateCoveredAndRetainedTiles(n,u,f,g,b,S){const $={},M={},z=Object.keys(n),F=L.now();for(const j of z){const B=n[j],V=this._tiles[j];if(!V||V.fadeEndTime!==0&&V.fadeEndTime<=F)continue;const W=this.findLoadedParent(B,u),te=this.findLoadedSibling(B),ee=W||te||null;ee&&(this._addTile(ee.tileID),$[ee.tileID.key]=ee.tileID),M[j]=B}this._retainLoadedChildren(M,g,f,n);for(const j in $)n[j]||(this._coveredTiles[j]=!0,n[j]=$[j]);if(S){const j={},B={};for(const V of b)this._tiles[V.key].hasData()?j[V.key]=V:B[V.key]=V;for(const V in B){const W=B[V].children(this._source.maxzoom);this._tiles[W[0].key]&&this._tiles[W[1].key]&&this._tiles[W[2].key]&&this._tiles[W[3].key]&&(j[W[0].key]=n[W[0].key]=W[0],j[W[1].key]=n[W[1].key]=W[1],j[W[2].key]=n[W[2].key]=W[2],j[W[3].key]=n[W[3].key]=W[3],delete B[V])}for(const V in B){const W=B[V],te=this.findLoadedParent(W,this._source.minzoom),ee=this.findLoadedSibling(W),re=te||ee||null;if(re){j[re.tileID.key]=n[re.tileID.key]=re.tileID;for(const se in j)j[se].isChildOf(re.tileID)&&delete j[se]}}for(const V in this._tiles)j[V]||(this._coveredTiles[V]=!0)}}update(n,u){if(!this._sourceLoaded||this._paused)return;let f;this.transform=n,this.terrain=u,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=n.getVisibleUnwrappedCoordinates(this._source.tileID).map((F=>new a.Z(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y))):(f=Te(n,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter((F=>this._source.hasTile(F))))):f=[];const g=St(n,this._source),b=Math.max(g-Jt.maxOverzooming,this._source.minzoom),S=Math.max(g+Jt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const j of f)if(j.canonical.z>this._source.minzoom){const B=j.scaledTo(j.canonical.z-1);F[B.key]=B;const V=j.scaledTo(Math.max(this._source.minzoom,Math.min(j.canonical.z,5)));F[V.key]=V}f=f.concat(Object.values(F))}const $=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,$&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(f,g);jt(this._source.type)&&this._updateCoveredAndRetainedTiles(M,b,S,g,f,u);for(const F in M)this._tiles[F].clearFadeHold();const z=a.am(this._tiles,M);for(const F of z){const j=this._tiles[F];j.hasSymbolBuckets&&!j.holdingForFade()?j.setHoldDuration(this.map._fadeDuration):j.hasSymbolBuckets&&!j.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,u){var f;const g={},b={},S=Math.max(u-Jt.maxOverzooming,this._source.minzoom),$=Math.max(u+Jt.maxUnderzooming,this._source.minzoom),M={};for(const z of n){const F=this._addTile(z);g[z.key]=z,F.hasData()||u<this._source.maxzoom&&(M[z.key]=z)}this._retainLoadedChildren(M,u,$,g);for(const z of n){let F=this._tiles[z.key];if(F.hasData())continue;if(u+1>this._source.maxzoom){const B=z.children(this._source.maxzoom)[0],V=this.getTile(B);if(V&&V.hasData()){g[B.key]=B;continue}}else{const B=z.children(this._source.maxzoom);if(g[B[0].key]&&g[B[1].key]&&g[B[2].key]&&g[B[3].key])continue}let j=F.wasRequested();for(let B=z.overscaledZ-1;B>=S;--B){const V=z.scaledTo(B);if(b[V.key])break;if(b[V.key]=!0,F=this.getTile(V),!F&&j&&(F=this._addTile(V)),F){const W=F.hasData();if((W||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||j)&&(g[V.key]=V),j=F.wasRequested(),W)break}}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const u=[];let f,g=this._tiles[n].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const b=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(b),f)break;g=b}for(const b of u)this._loadedParentTiles[b]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const u=this._tiles[n].tileID,f=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=f}}_addTile(n){let u=this._tiles[n.key];if(u)return u;u=this._cache.getAndRemove(n),u&&(this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,u)));const f=u;return u||(u=new Ic(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(u,n.key,u.state)),u.uses++,this._tiles[n.key]=u,f||this._source.fire(new a.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const f=u.getExpiryTimeout();f&&(this._timers[n]=setTimeout((()=>{this._reloadTile(n,"expired"),delete this._timers[n]}),f))}refreshTiles(n){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&n.some((f=>f.equals(this._tiles[u].tileID.canonical)))&&this._reloadTile(u,"expired")}_removeTile(n){const u=this._tiles[n];u&&(u.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(n){const u=n.sourceDataType;n.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&u==="content"&&(this.reload(n.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,u,f){const g=[],b=this.transform;if(!b)return g;const S=b.getCoveringTilesDetailsProvider().allowWorldCopies(),$=f?b.getCameraQueryGeometry(n):n,M=V=>b.screenPointToMercatorCoordinate(V,this.terrain),z=this.transformBbox(n,M,!S),F=this.transformBbox($,M,!S),j=this.getIds(),B=a.a2.fromPoints(F);for(let V=0;V<j.length;V++){const W=this._tiles[j[V]];if(W.holdingForFade())continue;const te=S?[W.tileID]:[W.tileID.unwrapTo(-1),W.tileID.unwrapTo(0)],ee=Math.pow(2,b.zoom-W.tileID.overscaledZ),re=u*W.queryPadding*a.$/W.tileSize/ee;for(const se of te){const ce=B.map((oe=>se.getTilePoint(new a.a1(oe.x,oe.y))));if(ce.expandBy(re),ce.intersects(Ot)){const oe=z.map((me=>se.getTilePoint(me))),he=F.map((me=>se.getTilePoint(me)));g.push({tile:W,tileID:S?se:se.unwrapTo(0),queryGeometry:oe,cameraQueryGeometry:he,scale:ee})}}}return g}transformBbox(n,u,f){let g=n.map(u);if(f){const b=a.a2.fromPoints(n);b.shrinkBy(.001*Math.min(b.width(),b.height()));const S=b.map(u);a.a2.fromPoints(g).covers(S)||(g=g.map(($=>$.x>.5?new a.a1($.x-1,$.y,$.z):$)))}return g}getVisibleCoordinates(n){const u=this.getRenderableIds(n).map((f=>this._tiles[f].tileID));return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(jt(this._source.type)){const n=L.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=n)return!0}return!1}setFeatureState(n,u,f){this._state.updateState(n=n||"_geojsonTileLayer",u,f)}removeFeatureState(n,u,f){this._state.removeFeatureState(n=n||"_geojsonTileLayer",u,f)}getFeatureState(n,u){return this._state.getState(n=n||"_geojsonTileLayer",u)}setDependencies(n,u,f){const g=this._tiles[n];g&&g.setDependencies(u,f)}reloadTilesForDependencies(n,u){for(const f in this._tiles)this._tiles[f].hasDependency(n,u)&&this._reloadTile(f,"reloading");this._cache.filter((f=>!f.hasDependency(n,u)))}}function $t(_,n){const u=Math.abs(2*_.wrap)-+(_.wrap<0),f=Math.abs(2*n.wrap)-+(n.wrap<0);return _.overscaledZ-n.overscaledZ||f-u||n.canonical.y-_.canonical.y||n.canonical.x-_.canonical.x}function jt(_){return _==="raster"||_==="image"||_==="video"}Jt.maxOverzooming=10,Jt.maxUnderzooming=3;class Oi{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=a.ah(n,0,1);let u=1,f=this._distances[u];const g=n*this.paddedLength+this.padding;for(;f<g&&u<this._distances.length;)f=this._distances[++u];const b=u-1,S=this._distances[b],$=f-S,M=$>0?(g-S)/$:0;return this.points[b].mult(1-M).add(this.points[u].mult(M))}}function Mr(_,n){let u=!0;return _==="always"||_!=="never"&&n!=="never"||(u=!1),u}class kr{constructor(n,u,f){const g=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(n/f),this.yCellCount=Math.ceil(u/f);for(let S=0;S<this.xCellCount*this.yCellCount;S++)g.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,f,g,b){this._forEachCell(u,f,g,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(b)}insertCircle(n,u,f,g){this._forEachCell(u-g,f-g,u+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(f),this.circles.push(g)}_insertBoxCell(n,u,f,g,b,S){this.boxCells[b].push(S)}_insertCircleCell(n,u,f,g,b,S){this.circleCells[b].push(S)}_query(n,u,f,g,b,S,$){if(f<0||n>this.width||g<0||u>this.height)return[];const M=[];if(n<=0&&u<=0&&this.width<=f&&this.height<=g){if(b)return[{key:null,x1:n,y1:u,x2:f,y2:g}];for(let z=0;z<this.boxKeys.length;z++)M.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const F=this.circles[3*z],j=this.circles[3*z+1],B=this.circles[3*z+2];M.push({key:this.circleKeys[z],x1:F-B,y1:j-B,x2:F+B,y2:j+B})}}else this._forEachCell(n,u,f,g,this._queryCell,M,{hitTest:b,overlapMode:S,seenUids:{box:{},circle:{}}},$);return M}query(n,u,f,g){return this._query(n,u,f,g,!1,null)}hitTest(n,u,f,g,b,S){return this._query(n,u,f,g,!0,b,S).length>0}hitTestCircle(n,u,f,g,b){const S=n-f,$=n+f,M=u-f,z=u+f;if($<0||S>this.width||z<0||M>this.height)return!1;const F=[];return this._forEachCell(S,M,$,z,this._queryCellCircle,F,{hitTest:!0,overlapMode:g,circle:{x:n,y:u,radius:f},seenUids:{box:{},circle:{}}},b),F.length>0}_queryCell(n,u,f,g,b,S,$,M){const{seenUids:z,hitTest:F,overlapMode:j}=$,B=this.boxCells[b];if(B!==null){const W=this.bboxes;for(const te of B)if(!z.box[te]){z.box[te]=!0;const ee=4*te,re=this.boxKeys[te];if(n<=W[ee+2]&&u<=W[ee+3]&&f>=W[ee+0]&&g>=W[ee+1]&&(!M||M(re))&&(!F||!Mr(j,re.overlapMode))&&(S.push({key:re,x1:W[ee],y1:W[ee+1],x2:W[ee+2],y2:W[ee+3]}),F))return!0}}const V=this.circleCells[b];if(V!==null){const W=this.circles;for(const te of V)if(!z.circle[te]){z.circle[te]=!0;const ee=3*te,re=this.circleKeys[te];if(this._circleAndRectCollide(W[ee],W[ee+1],W[ee+2],n,u,f,g)&&(!M||M(re))&&(!F||!Mr(j,re.overlapMode))){const se=W[ee],ce=W[ee+1],oe=W[ee+2];if(S.push({key:re,x1:se-oe,y1:ce-oe,x2:se+oe,y2:ce+oe}),F)return!0}}}return!1}_queryCellCircle(n,u,f,g,b,S,$,M){const{circle:z,seenUids:F,overlapMode:j}=$,B=this.boxCells[b];if(B!==null){const W=this.bboxes;for(const te of B)if(!F.box[te]){F.box[te]=!0;const ee=4*te,re=this.boxKeys[te];if(this._circleAndRectCollide(z.x,z.y,z.radius,W[ee+0],W[ee+1],W[ee+2],W[ee+3])&&(!M||M(re))&&!Mr(j,re.overlapMode))return S.push(!0),!0}}const V=this.circleCells[b];if(V!==null){const W=this.circles;for(const te of V)if(!F.circle[te]){F.circle[te]=!0;const ee=3*te,re=this.circleKeys[te];if(this._circlesCollide(W[ee],W[ee+1],W[ee+2],z.x,z.y,z.radius)&&(!M||M(re))&&!Mr(j,re.overlapMode))return S.push(!0),!0}}}_forEachCell(n,u,f,g,b,S,$,M){const z=this._convertToXCellCoord(n),F=this._convertToYCellCoord(u),j=this._convertToXCellCoord(f),B=this._convertToYCellCoord(g);for(let V=z;V<=j;V++)for(let W=F;W<=B;W++)if(b.call(this,n,u,f,g,this.xCellCount*W+V,S,$,M))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,f,g,b,S){const $=g-n,M=b-u,z=f+S;return z*z>$*$+M*M}_circleAndRectCollide(n,u,f,g,b,S,$){const M=(S-g)/2,z=Math.abs(n-(g+M));if(z>M+f)return!1;const F=($-b)/2,j=Math.abs(u-(b+F));if(j>F+f)return!1;if(z<=M||j<=F)return!0;const B=z-M,V=j-F;return B*B+V*V<=f*f}}function ur(_,n,u){const f=a.L();if(!_){const{vecSouth:j,vecEast:B}=li(n),V=T();V[0]=B[0],V[1]=B[1],V[2]=j[0],V[3]=j[1],g=V,(F=(S=(b=V)[0])*(z=b[3])-(M=b[2])*($=b[1]))&&(g[0]=z*(F=1/F),g[1]=-$*F,g[2]=-M*F,g[3]=S*F),f[0]=V[0],f[1]=V[1],f[4]=V[2],f[5]=V[3]}var g,b,S,$,M,z,F;return a.N(f,f,[1/u,1/u,1]),f}function ti(_,n,u,f){if(_){const g=a.L();if(!n){const{vecSouth:b,vecEast:S}=li(u);g[0]=S[0],g[1]=S[1],g[4]=b[0],g[5]=b[1]}return a.N(g,g,[f,f,1]),g}return u.pixelsToClipSpaceMatrix}function li(_){const n=Math.cos(_.rollInRadians),u=Math.sin(_.rollInRadians),f=Math.cos(_.pitchInRadians),g=Math.cos(_.bearingInRadians),b=Math.sin(_.bearingInRadians),S=a.ar();S[0]=-g*f*u-b*n,S[1]=-b*f*u+g*n;const $=a.as(S);$<1e-9?a.at(S):a.au(S,S,1/$);const M=a.ar();M[0]=g*f*n-b*u,M[1]=b*f*n+g*u;const z=a.as(M);return z<1e-9?a.at(M):a.au(M,M,1/z),{vecEast:M,vecSouth:S}}function yr(_,n,u,f){let g;f?(g=[_,n,f(_,n),1],a.aw(g,g,u)):(g=[_,n,0,1],Pc(g,g,u));const b=g[3];return{point:new a.P(g[0]/b,g[1]/b),signedDistanceFromCamera:b,isOccluded:!1}}function it(_,n){return .5+_/n*.5}function pn(_,n){return _.x>=-n[0]&&_.x<=n[0]&&_.y>=-n[1]&&_.y<=n[1]}function Wi(_,n,u,f,g,b,S,$,M,z,F,j,B){const V=u?_.textSizeData:_.iconSizeData,W=a.an(V,n.transform.zoom),te=[256/n.width*2+1,256/n.height*2+1],ee=u?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;ee.clear();const re=_.lineVertexArray,se=u?_.text.placedSymbolArray:_.icon.placedSymbolArray,ce=n.transform.width/n.transform.height;let oe=!1;for(let he=0;he<se.length;he++){const me=se.get(he);if(me.hidden||me.writingMode===a.ao.vertical&&!oe){To(me.numGlyphs,ee);continue}oe=!1;const ae=new a.P(me.anchorX,me.anchorY),we={getElevation:B,pitchedLabelPlaneMatrix:f,lineVertexArray:re,pitchWithMap:b,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:ae,unwrappedTileID:M,width:z,height:F,translation:j},Oe=Fa(me.anchorX,me.anchorY,we);if(!pn(Oe.point,te)){To(me.numGlyphs,ee);continue}const Ee=it(n.transform.cameraToCenterDistance,Oe.signedDistanceFromCamera),$e=a.ap(V,W,me),ze=b?$e*n.transform.getPitchedTextCorrection(me.anchorX,me.anchorY,M)/Ee:$e*Ee,tt=pt({projectionContext:we,pitchedLabelPlaneMatrixInverse:g,symbol:me,fontSize:ze,flip:!1,keepUpright:S,glyphOffsetArray:_.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:ce,rotateToLine:$});oe=tt.useVertical,(tt.notEnoughRoom||oe||tt.needsFlipping&&pt({projectionContext:we,pitchedLabelPlaneMatrixInverse:g,symbol:me,fontSize:ze,flip:!0,keepUpright:S,glyphOffsetArray:_.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:ce,rotateToLine:$}).notEnoughRoom)&&To(me.numGlyphs,ee)}u?_.text.dynamicLayoutVertexBuffer.updateData(ee):_.icon.dynamicLayoutVertexBuffer.updateData(ee)}function La(_,n,u,f,g,b,S,$){const M=b.glyphStartIndex+b.numGlyphs,z=b.lineStartIndex,F=b.lineStartIndex+b.lineLength,j=n.getoffsetX(b.glyphStartIndex),B=n.getoffsetX(M-1),V=Na(_*j,u,f,g,b.segment,z,F,$,S);if(!V)return null;const W=Na(_*B,u,f,g,b.segment,z,F,$,S);return W?$.projectionCache.anyProjectionOccluded?null:{first:V,last:W}:null}function $c(_,n,u,f){return _===a.ao.horizontal&&Math.abs(u.y-n.y)>Math.abs(u.x-n.x)*f?{useVertical:!0}:(_===a.ao.vertical?n.y<u.y:n.x>u.x)?{needsFlipping:!0}:null}function pt(_){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:u,symbol:f,fontSize:g,flip:b,keepUpright:S,glyphOffsetArray:$,dynamicLayoutVertexArray:M,aspectRatio:z,rotateToLine:F}=_,j=g/24,B=f.lineOffsetX*j,V=f.lineOffsetY*j;let W;if(f.numGlyphs>1){const te=f.glyphStartIndex+f.numGlyphs,ee=f.lineStartIndex,re=f.lineStartIndex+f.lineLength,se=La(j,$,B,V,b,f,F,n);if(!se)return{notEnoughRoom:!0};const ce=Il(se.first.point.x,se.first.point.y,n,u),oe=Il(se.last.point.x,se.last.point.y,n,u);if(S&&!b){const he=$c(f.writingMode,ce,oe,z);if(he)return he}W=[se.first];for(let he=f.glyphStartIndex+1;he<te-1;he++){const me=Na(j*$.getoffsetX(he),B,V,b,f.segment,ee,re,n,F);if(!me)return{notEnoughRoom:!0};W.push(me)}W.push(se.last)}else{if(S&&!b){const ee=on(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,re=f.lineStartIndex+f.segment+1,se=new a.P(n.lineVertexArray.getx(re),n.lineVertexArray.gety(re)),ce=on(se.x,se.y,n),oe=ce.signedDistanceFromCamera>0?ce.point:Kt(n.tileAnchorPoint,se,ee,1,n),he=Il(ee.x,ee.y,n,u),me=Il(oe.x,oe.y,n,u),ae=$c(f.writingMode,he,me,z);if(ae)return ae}const te=Na(j*$.getoffsetX(f.glyphStartIndex),B,V,b,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,n,F);if(!te||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};W=[te]}for(const te of W)a.av(M,te.point,te.angle);return{}}function Kt(_,n,u,f,g){const b=_.add(_.sub(n)._unit()),S=on(b.x,b.y,g).point,$=u.sub(S);return u.add($._mult(f/$.mag()))}function Wt(_,n,u){const f=n.projectionCache;if(f.projections[_])return f.projections[_];const g=new a.P(n.lineVertexArray.getx(_),n.lineVertexArray.gety(_)),b=on(g.x,g.y,n);if(b.signedDistanceFromCamera>0)return f.projections[_]=b.point,f.anyProjectionOccluded=f.anyProjectionOccluded||b.isOccluded,b.point;const S=_-u.direction;return Kt(u.distanceFromAnchor===0?n.tileAnchorPoint:new a.P(n.lineVertexArray.getx(S),n.lineVertexArray.gety(S)),g,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,n)}function on(_,n,u){const f=_+u.translation[0],g=n+u.translation[1];let b;return u.pitchWithMap?(b=yr(f,g,u.pitchedLabelPlaneMatrix,u.getElevation),b.isOccluded=!1):(b=u.transform.projectTileCoordinates(f,g,u.unwrappedTileID,u.getElevation),b.point.x=(.5*b.point.x+.5)*u.width,b.point.y=(.5*-b.point.y+.5)*u.height),b}function Il(_,n,u,f){if(u.pitchWithMap){const g=[_,n,0,1];return a.aw(g,g,f),u.transform.projectTileCoordinates(g[0]/g[3],g[1]/g[3],u.unwrappedTileID,u.getElevation).point}return{x:_/u.width*2-1,y:1-n/u.height*2}}function Fa(_,n,u){return u.transform.projectTileCoordinates(_,n,u.unwrappedTileID,u.getElevation)}function qt(_,n,u){return _._unit()._perp()._mult(n*u)}function Rd(_,n,u,f,g,b,S,$,M){if($.projectionCache.offsets[_])return $.projectionCache.offsets[_];const z=u.add(n);if(_+M.direction<f||_+M.direction>=g)return $.projectionCache.offsets[_]=z,z;const F=Wt(_+M.direction,$,M),j=qt(F.sub(u),S,M.direction),B=u.add(j),V=F.add(j);return $.projectionCache.offsets[_]=a.ax(b,z,B,V)||z,$.projectionCache.offsets[_]}function Na(_,n,u,f,g,b,S,$,M){const z=f?_-n:_+n;let F=z>0?1:-1,j=0;f&&(F*=-1,j=Math.PI),F<0&&(j+=Math.PI);let B,V=F>0?b+g:b+g+1;$.projectionCache.cachedAnchorPoint?B=$.projectionCache.cachedAnchorPoint:(B=on($.tileAnchorPoint.x,$.tileAnchorPoint.y,$).point,$.projectionCache.cachedAnchorPoint=B);let W,te,ee=B,re=B,se=0,ce=0;const oe=Math.abs(z),he=[];let me;for(;se+ce<=oe;){if(V+=F,V<b||V>=S)return null;se+=ce,re=ee,te=W;const Oe={absOffsetX:oe,direction:F,distanceFromAnchor:se,previousVertex:re};if(ee=Wt(V,$,Oe),u===0)he.push(re),me=ee.sub(re);else{let Ee;const $e=ee.sub(re);Ee=$e.mag()===0?qt(Wt(V+F,$,Oe).sub(ee),u,F):qt($e,u,F),te||(te=re.add(Ee)),W=Rd(V,Ee,ee,b,S,te,u,$,Oe),he.push(te),me=W.sub(te)}ce=me.mag()}const ae=me._mult((oe-se)/ce)._add(te||re),we=j+Math.atan2(ee.y-re.y,ee.x-re.x);return he.push(ae),{point:ae,angle:M?we:0,path:he}}const Ld=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function To(_,n){for(let u=0;u<_;u++){const f=n.length;n.resize(f+4),n.float32.set(Ld,3*f)}}function Pc(_,n,u){const f=n[0],g=n[1];return _[0]=u[0]*f+u[4]*g+u[12],_[1]=u[1]*f+u[5]*g+u[13],_[3]=u[3]*f+u[7]*g+u[15],_}const tr=100;class Fd{constructor(n,u=new kr(n.width+200,n.height+200,25),f=new kr(n.width+200,n.height+200,25)){this.transform=n,this.grid=u,this.ignoredGrid=f,this.pitchFactor=Math.cos(n.pitch*Math.PI/180)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+tr,this.screenBottomBoundary=n.height+tr,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,u,f,g,b,S,$,M,z,F,j,B){const V=this.projectAndGetPerspectiveRatio(n.anchorPointX+M[0],n.anchorPointY+M[1],b,F,B),W=f*V.perspectiveRatio;let te;if(S||$)te=this._projectCollisionBox(n,W,g,b,S,$,M,V,F,j,B);else{const me=V.x+(j?j.x*W:0),ae=V.y+(j?j.y*W:0);te={allPointsOccluded:!1,box:[me+n.x1*W,ae+n.y1*W,me+n.x2*W,ae+n.y2*W]}}const[ee,re,se,ce]=te.box,oe=S?te.allPointsOccluded:V.isOccluded;let he=oe;return he||(he=V.perspectiveRatio<this.perspectiveRatioCutoff),he||(he=!this.isInsideGrid(ee,re,se,ce)),he||u!=="always"&&this.grid.hitTest(ee,re,se,ce,u,z)?{box:[ee,re,se,ce],placeable:!1,offscreen:!1,occluded:oe}:{box:[ee,re,se,ce],placeable:!0,offscreen:this.isOffscreen(ee,re,se,ce),occluded:oe}}placeCollisionCircles(n,u,f,g,b,S,$,M,z,F,j,B,V,W){const te=[],ee=new a.P(u.anchorX,u.anchorY),re=this.getPerspectiveRatio(ee.x,ee.y,S,W),se=(z?b*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,S)/re:b*re)/a.aB,ce={getElevation:W,pitchedLabelPlaneMatrix:$,lineVertexArray:f,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ee,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:V},oe=La(se,g,u.lineOffsetX*se,u.lineOffsetY*se,!1,u,!1,ce);let he=!1,me=!1,ae=!0;if(oe){const we=.5*j*re+B,Oe=new a.P(-100,-100),Ee=new a.P(this.screenRightBoundary,this.screenBottomBoundary),$e=new Oi,ze=oe.first,tt=oe.last;let st=[];for(let Ht=ze.path.length-1;Ht>=1;Ht--)st.push(ze.path[Ht]);for(let Ht=1;Ht<tt.path.length;Ht++)st.push(tt.path[Ht]);const He=2.5*we;if(z){const Ht=this.projectPathToScreenSpace(st,ce);st=Ht.some((yi=>yi.signedDistanceFromCamera<=0))?[]:Ht.map((yi=>yi.point))}let xt=[];if(st.length>0){const Ht=st[0].clone(),yi=st[0].clone();for(let Ci=1;Ci<st.length;Ci++)Ht.x=Math.min(Ht.x,st[Ci].x),Ht.y=Math.min(Ht.y,st[Ci].y),yi.x=Math.max(yi.x,st[Ci].x),yi.y=Math.max(yi.y,st[Ci].y);xt=Ht.x>=Oe.x&&yi.x<=Ee.x&&Ht.y>=Oe.y&&yi.y<=Ee.y?[st]:yi.x<Oe.x||Ht.x>Ee.x||yi.y<Oe.y||Ht.y>Ee.y?[]:a.ay([st],Oe.x,Oe.y,Ee.x,Ee.y)}for(const Ht of xt){$e.reset(Ht,.25*we);let yi=0;yi=$e.length<=.5*we?1:Math.ceil($e.paddedLength/He)+1;for(let Ci=0;Ci<yi;Ci++){const wi=Ci/Math.max(yi-1,1),Hi=$e.lerp(wi),Xi=Hi.x+tr,Ut=Hi.y+tr;te.push(Xi,Ut,we,0);const Ei=Xi-we,_r=Ut-we,Ar=Xi+we,Hr=Ut+we;if(ae=ae&&this.isOffscreen(Ei,_r,Ar,Hr),me=me||this.isInsideGrid(Ei,_r,Ar,Hr),n!=="always"&&this.grid.hitTestCircle(Xi,Ut,we,n,F)&&(he=!0,!M))return{circles:[],offscreen:!1,collisionDetected:he}}}}return{circles:!M&&he||!me||re<this.perspectiveRatioCutoff?[]:te,offscreen:ae,collisionDetected:he}}projectPathToScreenSpace(n,u){const f=(function(g,b){const S=a.L();return a.aq(S,b.pitchedLabelPlaneMatrix),g.map(($=>{const M=yr($.x,$.y,S,b.getElevation),z=b.transform.projectTileCoordinates(M.point.x,M.point.y,b.unwrappedTileID,b.getElevation);return z.point.x=(.5*z.point.x+.5)*b.width,z.point.y=(.5*-z.point.y+.5)*b.height,z}))})(n,u);return(function(g){let b=0,S=0,$=0,M=0;for(let z=0;z<g.length;z++)g[z].isOccluded?($=z+1,M=0):(M++,M>S&&(S=M,b=$));return g.slice(b,b+S)})(f)}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],f=new a.a2;for(const j of n){const B=new a.P(j.x+tr,j.y+tr);f.extend(B),u.push(B)}const{minX:g,minY:b,maxX:S,maxY:$}=f,M=this.grid.query(g,b,S,$).concat(this.ignoredGrid.query(g,b,S,$)),z={},F={};for(const j of M){const B=j.key;if(z[B.bucketInstanceId]===void 0&&(z[B.bucketInstanceId]={}),z[B.bucketInstanceId][B.featureIndex])continue;const V=[new a.P(j.x1,j.y1),new a.P(j.x2,j.y1),new a.P(j.x2,j.y2),new a.P(j.x1,j.y2)];a.az(u,V)&&(z[B.bucketInstanceId][B.featureIndex]=!0,F[B.bucketInstanceId]===void 0&&(F[B.bucketInstanceId]=[]),F[B.bucketInstanceId].push(B.featureIndex))}return F}insertCollisionBox(n,u,f,g,b,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:b,collisionGroupID:S,overlapMode:u},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,f,g,b,S){const $=f?this.ignoredGrid:this.grid,M={bucketInstanceId:g,featureIndex:b,collisionGroupID:S,overlapMode:u};for(let z=0;z<n.length;z+=4)$.insertCircle(M,n[z],n[z+1],n[z+2])}projectAndGetPerspectiveRatio(n,u,f,g,b){if(b){let S;g?(S=[n,u,g(n,u),1],a.aw(S,S,b)):(S=[n,u,0,1],Pc(S,S,b));const $=S[3];return{x:(S[0]/$+1)/2*this.transform.width+tr,y:(-S[1]/$+1)/2*this.transform.height+tr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/$*.5,isOccluded:!1,signedDistanceFromCamera:$}}{const S=this.transform.projectTileCoordinates(n,u,f,g);return{x:(S.point.x+1)/2*this.transform.width+tr,y:(1-S.point.y)/2*this.transform.height+tr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(n,u,f,g){const b=this.transform.projectTileCoordinates(n,u,f,g);return .5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5}isOffscreen(n,u,f,g){return f<tr||n>=this.screenRightBoundary||g<tr||u>this.screenBottomBoundary}isInsideGrid(n,u,f,g){return f>=0&&n<this.gridRightBoundary&&g>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=a.ag([]);return a.M(n,n,[-100,-100,0]),n}_projectCollisionBox(n,u,f,g,b,S,$,M,z,F,j){let B=1,V=0,W=0,te=1;const ee=n.anchorPointX+$[0],re=n.anchorPointY+$[1];if(S&&!b){const st=this.projectAndGetPerspectiveRatio(ee+1,re,g,z,j),He=st.x-M.x,xt=Math.atan((st.y-M.y)/He)+(He<0?Math.PI:0),Ht=Math.sin(xt),yi=Math.cos(xt);B=yi,V=Ht,W=-Ht,te=yi}else if(!S&&b){const st=li(this.transform);B=st.vecEast[0],V=st.vecEast[1],W=st.vecSouth[0],te=st.vecSouth[1]}let se=M.x,ce=M.y,oe=u;b&&(se=ee,ce=re,oe=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),oe*=this.transform.getPitchedTextCorrection(ee,re,g),F||(oe*=a.ah(.5+M.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),F&&(se+=B*F.x*oe+W*F.y*oe,ce+=V*F.x*oe+te*F.y*oe);const he=n.x1*oe,me=n.x2*oe,ae=(he+me)/2,we=n.y1*oe,Oe=n.y2*oe,Ee=(we+Oe)/2,$e=[{offsetX:he,offsetY:we},{offsetX:ae,offsetY:we},{offsetX:me,offsetY:we},{offsetX:me,offsetY:Ee},{offsetX:me,offsetY:Oe},{offsetX:ae,offsetY:Oe},{offsetX:he,offsetY:Oe},{offsetX:he,offsetY:Ee}];let ze=[];for(const{offsetX:st,offsetY:He}of $e)ze.push(new a.P(se+B*st+W*He,ce+V*st+te*He));let tt=!1;if(b){const st=ze.map((He=>this.projectAndGetPerspectiveRatio(He.x,He.y,g,z,j)));tt=st.some((He=>!He.isOccluded)),ze=st.map((He=>new a.P(He.x,He.y)))}else tt=!0;return{box:a.aA(ze),allPointsOccluded:!tt}}}class Fn{constructor(n,u,f,g){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Pi{constructor(n,u,f,g,b){this.text=new Fn(n?n.text:null,u,f,b),this.icon=new Fn(n?n.icon:null,u,g,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class bv{constructor(n,u,f){this.text=n,this.icon=u,this.skipFade=f}}class Yu{constructor(n,u,f,g,b){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=b}}class Rm{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[n]}}function Ba(_,n,u,f,g){const{horizontalAlign:b,verticalAlign:S}=a.aH(_);return new a.P(-(b-.5)*n+f[0]*g,-(S-.5)*u+f[1]*g)}class ja{constructor(n,u,f,g,b){this.transform=n.clone(),this.terrain=u,this.collisionIndex=new Fd(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Rm(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const u=this.terrain;return u?(f,g)=>u.getElevation(n,f,g):null}getBucketParts(n,u,f,g){const b=f.getBucket(u),S=f.latestFeatureIndex;if(!b||!S||u.id!==b.layerIds[0])return;const $=f.collisionBoxArray,M=b.layers[0].layout,z=b.layers[0].paint,F=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),j=f.tileSize/a.$,B=f.tileID.toUnwrapped(),V=M.get("text-rotation-alignment")==="map",W=a.aC(f,1,this.transform.zoom),te=a.aD(this.collisionIndex.transform,f,z.get("text-translate"),z.get("text-translate-anchor")),ee=a.aD(this.collisionIndex.transform,f,z.get("icon-translate"),z.get("icon-translate-anchor")),re=ur(V,this.transform,W);this.retainedQueryData[b.bucketInstanceId]=new Yu(b.bucketInstanceId,S,b.sourceLayerIndex,b.index,f.tileID);const se={bucket:b,layout:M,translationText:te,translationIcon:ee,unwrappedTileID:B,pitchedLabelPlaneMatrix:re,scale:F,textPixelRatio:j,holdingForFade:f.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:a.an(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(g)for(const ce of b.sortKeyRanges){const{sortKey:oe,symbolInstanceStart:he,symbolInstanceEnd:me}=ce;n.push({sortKey:oe,symbolInstanceStart:he,symbolInstanceEnd:me,parameters:se})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:se})}attemptAnchorPlacement(n,u,f,g,b,S,$,M,z,F,j,B,V,W,te,ee,re,se,ce,oe){const he=a.aE[n.textAnchor],me=[n.textOffset0,n.textOffset1],ae=Ba(he,f,g,me,b),we=this.collisionIndex.placeCollisionBox(u,B,M,z,F,$,S,ee,j.predicate,ce,ae,oe);if((!se||this.collisionIndex.placeCollisionBox(se,B,M,z,F,$,S,re,j.predicate,ce,ae,oe).placeable)&&we.placeable){let Oe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(Oe=this.prevPlacement.variableOffsets[V.crossTileID].anchor),V.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[V.crossTileID]={textOffset:me,width:f,height:g,anchor:he,textBoxScale:b,prevAnchor:Oe},this.markUsedJustification(W,he,V,te),W.allowVerticalPlacement&&(this.markUsedOrientation(W,te,V),this.placedOrientations[V.crossTileID]=te),{shift:ae,placedGlyphBoxes:we}}}placeLayerBucketPart(n,u,f){const{bucket:g,layout:b,translationText:S,translationIcon:$,unwrappedTileID:M,pitchedLabelPlaneMatrix:z,textPixelRatio:F,holdingForFade:j,collisionBoxArray:B,partiallyEvaluatedTextSize:V,collisionGroup:W}=n.parameters,te=b.get("text-optional"),ee=b.get("icon-optional"),re=a.aF(b,"text-overlap","text-allow-overlap"),se=re==="always",ce=a.aF(b,"icon-overlap","icon-allow-overlap"),oe=ce==="always",he=b.get("text-rotation-alignment")==="map",me=b.get("text-pitch-alignment")==="map",ae=b.get("icon-text-fit")!=="none",we=b.get("symbol-z-order")==="viewport-y",Oe=se&&(oe||!g.hasIconData()||ee),Ee=oe&&(se||!g.hasTextData()||te);!g.collisionArrays&&B&&g.deserializeCollisionBoxes(B);const $e=this.retainedQueryData[g.bucketInstanceId].tileID,ze=this._getTerrainElevationFunc($e),tt=this.transform.getFastPathSimpleProjectionMatrix($e),st=(He,xt,Ht)=>{var yi,Ci;if(u[He.crossTileID])return;if(j)return void(this.placements[He.crossTileID]=new bv(!1,!1,!1));let wi=!1,Hi=!1,Xi=!0,Ut=null,Ei={box:null,placeable:!1,offscreen:null,occluded:!1},_r={placeable:!1},Ar=null,Hr=null,In=null,Zs=0,Ha=0,Za=0;xt.textFeatureIndex?Zs=xt.textFeatureIndex:He.useRuntimeCollisionCircles&&(Zs=He.featureIndex),xt.verticalTextFeatureIndex&&(Ha=xt.verticalTextFeatureIndex);const Xc=xt.textBox;if(Xc){const jn=br=>{let Dr=a.ao.horizontal;if(g.allowVerticalPlacement&&!br&&this.prevPlacement){const xs=this.prevPlacement.placedOrientations[He.crossTileID];xs&&(this.placedOrientations[He.crossTileID]=xs,Dr=xs,this.markUsedOrientation(g,Dr,He))}return Dr},Ws=(br,Dr)=>{if(g.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&xt.verticalTextBox){for(const xs of g.writingModes)if(xs===a.ao.vertical?(Ei=Dr(),_r=Ei):Ei=br(),Ei&&Ei.placeable)break}else Ei=br()},$n=He.textAnchorOffsetStartIndex,Wa=He.textAnchorOffsetEndIndex;if(Wa===$n){const br=(Dr,xs)=>{const xr=this.collisionIndex.placeCollisionBox(Dr,re,F,$e,M,me,he,S,W.predicate,ze,void 0,tt);return xr&&xr.placeable&&(this.markUsedOrientation(g,xs,He),this.placedOrientations[He.crossTileID]=xs),xr};Ws((()=>br(Xc,a.ao.horizontal)),(()=>{const Dr=xt.verticalTextBox;return g.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Dr?br(Dr,a.ao.vertical):{box:null,offscreen:null}})),jn(Ei&&Ei.placeable)}else{let br=a.aE[(Ci=(yi=this.prevPlacement)===null||yi===void 0?void 0:yi.variableOffsets[He.crossTileID])===null||Ci===void 0?void 0:Ci.anchor];const Dr=(xr,wh,Kc)=>{const Ko=xr.x2-xr.x1,Ys=xr.y2-xr.y1,Ya=He.textBoxScale,d_=ae&&ce==="never"?wh:null;let ns=null,p_=re==="never"?1:2,Pg="never";br&&p_++;for(let bp=0;bp<p_;bp++){for(let xp=$n;xp<Wa;xp++){const Xa=g.textAnchorOffsets.get(xp);if(br&&Xa.textAnchor!==br)continue;const Qo=this.attemptAnchorPlacement(Xa,xr,Ko,Ys,Ya,he,me,F,$e,M,W,Pg,He,g,Kc,S,$,d_,ze);if(Qo&&(ns=Qo.placedGlyphBoxes,ns&&ns.placeable))return wi=!0,Ut=Qo.shift,ns}br?br=null:Pg=re}return f&&!ns&&(ns={box:this.collisionIndex.placeCollisionBox(Xc,"always",F,$e,M,me,he,S,W.predicate,ze,void 0,tt).box,offscreen:!1,placeable:!1,occluded:!1}),ns};Ws((()=>Dr(Xc,xt.iconBox,a.ao.horizontal)),(()=>{const xr=xt.verticalTextBox;return g.allowVerticalPlacement&&(!Ei||!Ei.placeable)&&He.numVerticalGlyphVertices>0&&xr?Dr(xr,xt.verticalIconBox,a.ao.vertical):{box:null,occluded:!0,offscreen:null}})),Ei&&(wi=Ei.placeable,Xi=Ei.offscreen);const xs=jn(Ei&&Ei.placeable);if(!wi&&this.prevPlacement){const xr=this.prevPlacement.variableOffsets[He.crossTileID];xr&&(this.variableOffsets[He.crossTileID]=xr,this.markUsedJustification(g,xr.anchor,He,xs))}}}if(Ar=Ei,wi=Ar&&Ar.placeable,Xi=Ar&&Ar.offscreen,He.useRuntimeCollisionCircles){const jn=g.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex),Ws=a.ap(g.textSizeData,V,jn),$n=b.get("text-padding");Hr=this.collisionIndex.placeCollisionCircles(re,jn,g.lineVertexArray,g.glyphOffsetArray,Ws,M,z,f,me,W.predicate,He.collisionCircleDiameter,$n,S,ze),Hr.circles.length&&Hr.collisionDetected&&!f&&a.w("Collisions detected, but collision boxes are not shown"),wi=se||Hr.circles.length>0&&!Hr.collisionDetected,Xi=Xi&&Hr.offscreen}if(xt.iconFeatureIndex&&(Za=xt.iconFeatureIndex),xt.iconBox){const jn=Ws=>this.collisionIndex.placeCollisionBox(Ws,ce,F,$e,M,me,he,$,W.predicate,ze,ae&&Ut?Ut:void 0,tt);_r&&_r.placeable&&xt.verticalIconBox?(In=jn(xt.verticalIconBox),Hi=In.placeable):(In=jn(xt.iconBox),Hi=In.placeable),Xi=Xi&&In.offscreen}const Jc=te||He.numHorizontalGlyphVertices===0&&He.numVerticalGlyphVertices===0,ql=ee||He.numIconVertices===0;Jc||ql?ql?Jc||(Hi=Hi&&wi):wi=Hi&&wi:Hi=wi=Hi&&wi;const Hl=Hi&&In.placeable;if(wi&&Ar.placeable&&this.collisionIndex.insertCollisionBox(Ar.box,re,b.get("text-ignore-placement"),g.bucketInstanceId,_r&&_r.placeable&&Ha?Ha:Zs,W.ID),Hl&&this.collisionIndex.insertCollisionBox(In.box,ce,b.get("icon-ignore-placement"),g.bucketInstanceId,Za,W.ID),Hr&&wi&&this.collisionIndex.insertCollisionCircles(Hr.circles,re,b.get("text-ignore-placement"),g.bucketInstanceId,Zs,W.ID),f&&this.storeCollisionData(g.bucketInstanceId,Ht,xt,Ar,In,Hr),He.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[He.crossTileID]=new bv((wi||Oe)&&!Ar?.occluded,(Hi||Ee)&&!In?.occluded,Xi||g.justReloaded),u[He.crossTileID]=!0};if(we){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const He=g.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let xt=He.length-1;xt>=0;--xt){const Ht=He[xt];st(g.symbolInstances.get(Ht),g.collisionArrays[Ht],Ht)}}else for(let He=n.symbolInstanceStart;He<n.symbolInstanceEnd;He++)st(g.symbolInstances.get(He),g.collisionArrays[He],He);g.justReloaded=!1}storeCollisionData(n,u,f,g,b,S){if(f.textBox||f.iconBox){let $,M;this.collisionBoxArrays.has(n)?$=this.collisionBoxArrays.get(n):($=new Map,this.collisionBoxArrays.set(n,$)),$.has(u)?M=$.get(u):(M={text:null,icon:null},$.set(u,M)),f.textBox&&(M.text=g.box),f.iconBox&&(M.icon=b.box)}if(S){let $=this.collisionCircleArrays[n];$===void 0&&($=this.collisionCircleArrays[n]=[]);for(let M=0;M<S.circles.length;M+=4)$.push(S.circles[M+0]-tr),$.push(S.circles[M+1]-tr),$.push(S.circles[M+2]),$.push(S.collisionDetected?1:0)}}markUsedJustification(n,u,f,g){let b;b=g===a.ao.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[a.aG(u)];const S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const $ of S)$>=0&&(n.text.placedSymbolArray.get($).crossTileID=b>=0&&$!==b?0:f.crossTileID)}markUsedOrientation(n,u,f){const g=u===a.ao.horizontal||u===a.ao.horizontalOnly?u:0,b=u===a.ao.vertical?u:0,S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const $ of S)n.text.placedSymbolArray.get($).placedOrientation=g;f.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const g=u?u.symbolFadeChange(n):1,b=u?u.opacities:{},S=u?u.variableOffsets:{},$=u?u.placedOrientations:{};for(const M in this.placements){const z=this.placements[M],F=b[M];F?(this.opacities[M]=new Pi(F,g,z.text,z.icon),f=f||z.text!==F.text.placed||z.icon!==F.icon.placed):(this.opacities[M]=new Pi(null,g,z.text,z.icon,z.skipFade),f=f||z.text||z.icon)}for(const M in b){const z=b[M];if(!this.opacities[M]){const F=new Pi(z,g,!1,!1);F.isHidden()||(this.opacities[M]=F,f=f||z.text.placed||z.icon.placed)}}for(const M in S)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=S[M]);for(const M in $)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=$[M]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u){const f={};for(const g of u){const b=g.getBucket(n);b&&g.latestFeatureIndex&&n.id===b.layerIds[0]&&this.updateBucketOpacities(b,g.tileID,f,g.collisionBoxArray)}}updateBucketOpacities(n,u,f,g){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const b=n.layers[0],S=b.layout,$=new Pi(null,0,!1,!1,!0),M=S.get("text-allow-overlap"),z=S.get("icon-allow-overlap"),F=b._unevaluatedLayout.hasValue("text-variable-anchor")||b._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=S.get("text-rotation-alignment")==="map",B=S.get("text-pitch-alignment")==="map",V=S.get("icon-text-fit")!=="none",W=new Pi(null,0,M&&(z||!n.hasIconData()||S.get("icon-optional")),z&&(M||!n.hasTextData()||S.get("text-optional")),!0);!n.collisionArrays&&g&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(g);const te=(re,se,ce)=>{for(let oe=0;oe<se/4;oe++)re.opacityVertexArray.emplaceBack(ce);re.hasVisibleVertices=re.hasVisibleVertices||ce!==kc},ee=this.collisionBoxArrays.get(n.bucketInstanceId);for(let re=0;re<n.symbolInstances.length;re++){const se=n.symbolInstances.get(re),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:oe,crossTileID:he}=se;let me=this.opacities[he];f[he]?me=$:me||(me=W,this.opacities[he]=me),f[he]=!0;const ae=se.numIconVertices>0,we=this.placedOrientations[se.crossTileID],Oe=we===a.ao.vertical,Ee=we===a.ao.horizontal||we===a.ao.horizontalOnly;if(ce>0||oe>0){const ze=Fm(me.text);te(n.text,ce,Oe?kc:ze),te(n.text,oe,Ee?kc:ze);const tt=me.text.isHidden();[se.rightJustifiedTextSymbolIndex,se.centerJustifiedTextSymbolIndex,se.leftJustifiedTextSymbolIndex].forEach((xt=>{xt>=0&&(n.text.placedSymbolArray.get(xt).hidden=tt||Oe?1:0)})),se.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(se.verticalPlacedTextSymbolIndex).hidden=tt||Ee?1:0);const st=this.variableOffsets[se.crossTileID];st&&this.markUsedJustification(n,st.anchor,se,we);const He=this.placedOrientations[se.crossTileID];He&&(this.markUsedJustification(n,"left",se,He),this.markUsedOrientation(n,He,se))}if(ae){const ze=Fm(me.icon),tt=!(V&&se.verticalPlacedIconSymbolIndex&&Oe);se.placedIconSymbolIndex>=0&&(te(n.icon,se.numIconVertices,tt?ze:kc),n.icon.placedSymbolArray.get(se.placedIconSymbolIndex).hidden=me.icon.isHidden()),se.verticalPlacedIconSymbolIndex>=0&&(te(n.icon,se.numVerticalIconVertices,tt?kc:ze),n.icon.placedSymbolArray.get(se.verticalPlacedIconSymbolIndex).hidden=me.icon.isHidden())}const $e=ee&&ee.has(re)?ee.get(re):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const ze=n.collisionArrays[re];if(ze){let tt=new a.P(0,0);if(ze.textBox||ze.verticalTextBox){let st=!0;if(F){const He=this.variableOffsets[he];He?(tt=Ba(He.anchor,He.width,He.height,He.textOffset,He.textBoxScale),j&&tt._rotate(B?-this.transform.bearingInRadians:this.transform.bearingInRadians)):st=!1}if(ze.textBox||ze.verticalTextBox){let He;ze.textBox&&(He=Oe),ze.verticalTextBox&&(He=Ee),Lm(n.textCollisionBox.collisionVertexArray,me.text.placed,!st||He,$e.text,tt.x,tt.y)}}if(ze.iconBox||ze.verticalIconBox){const st=!!(!Ee&&ze.verticalIconBox);let He;ze.iconBox&&(He=st),ze.verticalIconBox&&(He=!st),Lm(n.iconCollisionBox.collisionVertexArray,me.icon.placed,He,$e.icon,V?tt.x:0,V?tt.y:0)}}}}if(n.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);n.bucketInstanceId in this.collisionCircleArrays&&(n.collisionCircleArray=this.collisionCircleArrays[n.bucketInstanceId],delete this.collisionCircleArrays[n.bucketInstanceId])}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>n}setStale(){this.stale=!0}}function Lm(_,n,u,f,g,b){f&&f.length!==0||(f=[0,0,0,0]);const S=f[0]-tr,$=f[1]-tr,M=f[2]-tr,z=f[3]-tr;_.emplaceBack(n?1:0,u?1:0,g||0,b||0,S,$),_.emplaceBack(n?1:0,u?1:0,g||0,b||0,M,$),_.emplaceBack(n?1:0,u?1:0,g||0,b||0,M,z),_.emplaceBack(n?1:0,u?1:0,g||0,b||0,S,z)}const xv=Math.pow(2,25),wv=Math.pow(2,24),Mc=Math.pow(2,17),Sv=Math.pow(2,16),Jw=Math.pow(2,9),Kw=Math.pow(2,8),Qw=Math.pow(2,1);function Fm(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const n=_.placed?1:0,u=Math.floor(127*_.opacity);return u*xv+n*wv+u*Mc+n*Sv+u*Jw+n*Kw+u*Qw+n}const kc=0;class Nm{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,u,f,g,b){const S=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(S,g,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((($,M)=>$.sortKey-M.sortKey)));this._currentPartIndex<S.length;)if(u.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,b())return!0;return!1}}class Bm{constructor(n,u,f,g,b,S,$,M){this.placement=new ja(n,u,S,$,M),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(n,u,f){const g=L.now(),b=()=>!this._forceFullPlacement&&L.now()-g>2;for(;this._currentPlacementIndex>=0;){const S=u[n[this._currentPlacementIndex]],$=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=$)&&(!S.maxzoom||S.maxzoom>$)){if(this._inProgressLayer||(this._inProgressLayer=new Nm(S)),this._inProgressLayer.continuePlacement(f[S.source],this.placement,this._showCollisionBoxes,S,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Ac=512/a.$/2;class jm{constructor(n,u,f){this.tileID=n,this.bucketInstanceId=f,this._symbolsByKey={};const g=new Map;for(let b=0;b<u.length;b++){const S=u.get(b),$=S.key,M=g.get($);M?M.push(S):g.set($,[S])}for(const[b,S]of g){const $={positions:S.map((M=>({x:Math.floor(M.anchorX*Ac),y:Math.floor(M.anchorY*Ac)}))),crossTileIDs:S.map((M=>M.crossTileID))};if($.positions.length>128){const M=new a.aI($.positions.length,16,Uint16Array);for(const{x:z,y:F}of $.positions)M.add(z,F);M.finish(),delete $.positions,$.index=M}this._symbolsByKey[b]=$}}getScaledCoordinates(n,u){const{x:f,y:g,z:b}=this.tileID.canonical,{x:S,y:$,z:M}=u.canonical,z=Ac/Math.pow(2,M-b),F=($*a.$+n.anchorY)*z,j=g*a.$*Ac;return{x:Math.floor((S*a.$+n.anchorX)*z-f*a.$*Ac),y:Math.floor(F-j)}}findMatches(n,u,f){const g=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let b=0;b<n.length;b++){const S=n.get(b);if(S.crossTileID)continue;const $=this._symbolsByKey[S.key];if(!$)continue;const M=this.getScaledCoordinates(S,u);if($.index){const z=$.index.range(M.x-g,M.y-g,M.x+g,M.y+g).sort();for(const F of z){const j=$.crossTileIDs[F];if(!f[j]){f[j]=!0,S.crossTileID=j;break}}}else if($.positions)for(let z=0;z<$.positions.length;z++){const F=$.positions[z],j=$.crossTileIDs[z];if(Math.abs(F.x-M.x)<=g&&Math.abs(F.y-M.y)<=g&&!f[j]){f[j]=!0,S.crossTileID=j;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:n})=>n))}}class Um{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class e2{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const f in this.indexes){const g=this.indexes[f],b={};for(const S in g){const $=g[S];$.tileID=$.tileID.unwrapTo($.tileID.wrap+u),b[$.tileID.key]=$}this.indexes[f]=b}this.lng=n}addBucket(n,u,f){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const g=this.usedCrossTileIDs[n.overscaledZ];for(const b in this.indexes){const S=this.indexes[b];if(Number(b)>n.overscaledZ)for(const $ in S){const M=S[$];M.tileID.isChildOf(n)&&M.findMatches(u.symbolInstances,n,g)}else{const $=S[n.scaledTo(Number(b)).key];$&&$.findMatches(u.symbolInstances,n,g)}}for(let b=0;b<u.symbolInstances.length;b++){const S=u.symbolInstances.get(b);S.crossTileID||(S.crossTileID=f.generate(),g[S.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new jm(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const f of u.getCrossTileIDsLists())for(const g of f)delete this.usedCrossTileIDs[n][g]}removeStaleBuckets(n){let u=!1;for(const f in this.indexes){const g=this.indexes[f];for(const b in g)n[g[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[b]),delete g[b],u=!0)}return u}}class Dc{constructor(){this.layerIndexes={},this.crossTileIDs=new Um,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,f){let g=this.layerIndexes[n.id];g===void 0&&(g=this.layerIndexes[n.id]=new e2);let b=!1;const S={};g.handleWrapJump(f);for(const $ of u){const M=$.getBucket(n);M&&n.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket($.tileID,M,this.crossTileIDs)&&(b=!0),S[M.bucketInstanceId]=!0)}return g.removeStaleBuckets(S)&&(b=!0),b}pruneUnusedLayers(n){const u={};n.forEach((f=>{u[f]=!0}));for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}var Xu="void main() {fragColor=vec4(1.0);}";const Ns={prelude:Qt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Qt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Qt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Qt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Qt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Qt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Qt(Xu,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Qt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Qt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Qt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Qt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Qt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Qt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Qt(Xu,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Qt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Qt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Qt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Qt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Qt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Qt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Qt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Qt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Qt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Qt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Qt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Qt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Qt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Qt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Qt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Qt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Qt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Qt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Qt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Qt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Qt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Qt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Qt(_,n){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=n.match(/in ([\w]+) ([\w]+)/g),g=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=b?b.concat(g):g,$={};return{fragmentSource:_=_.replace(u,((M,z,F,j,B)=>($[B]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
in ${F} ${j} ${B};
#else
uniform ${F} ${j} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${F} ${j} ${B} = u_${B};
#endif
`))),vertexSource:n=n.replace(u,((M,z,F,j,B)=>{const V=j==="float"?"vec2":"vec4",W=B.match(/color/)?"color":V;return $[B]?z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${F} ${V} a_${B};
out ${F} ${j} ${B};
#else
uniform ${F} ${j} u_${B};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${F} ${j} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${W}(a_${B}, u_${B}_t);
#else
    ${F} ${j} ${B} = u_${B};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${F} ${V} a_${B};
#else
uniform ${F} ${j} u_${B};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${F} ${j} ${B} = a_${B};
#else
    ${F} ${j} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${F} ${j} ${B} = unpack_mix_${W}(a_${B}, u_${B}_t);
#else
    ${F} ${j} ${B} = u_${B};
#endif
`})),staticAttributes:f,staticUniforms:S}}class $l{constructor(n,u,f){this.vertexBuffer=n,this.indexBuffer=u,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ua=a.aJ([{name:"a_pos",type:"Int16",components:2}]);const Wo="#define PROJECTION_MERCATOR",Pl="mercator";class ei{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Pl}get shaderDefine(){return Wo}get shaderPreludeCode(){return Ns.projectionMercator}get vertexShaderPreludeCode(){return Ns.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(n){}getMeshFromTileID(n,u,f,g,b){if(this._cachedMesh)return this._cachedMesh;const S=new a.aL;S.emplaceBack(0,0),S.emplaceBack(a.$,0),S.emplaceBack(0,a.$),S.emplaceBack(a.$,a.$);const $=n.createVertexBuffer(S,Ua.members),M=a.aM.simpleSegment(0,0,4,2),z=new a.aN;z.emplaceBack(1,0,2),z.emplaceBack(1,2,3);const F=n.createIndexBuffer(z);return this._cachedMesh=new $l($,F,M),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(n){}}class Ml{constructor(n=0,u=0,f=0,g=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=f,this.right=g}interpolate(n,u,f){return u.top!=null&&n.top!=null&&(this.top=a.C.number(n.top,u.top,f)),u.bottom!=null&&n.bottom!=null&&(this.bottom=a.C.number(n.bottom,u.bottom,f)),u.left!=null&&n.left!=null&&(this.left=a.C.number(n.left,u.left,f)),u.right!=null&&n.right!=null&&(this.right=a.C.number(n.right,u.right,f)),this}getCenter(n,u){const f=a.ah((this.left+n-this.right)/2,0,n),g=a.ah((this.top+u-this.bottom)/2,0,u);return new a.P(f,g)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Ml(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Nd(_,n){if(!_.renderWorldCopies||_.lngRange)return;const u=n.lng-_.center.lng;n.lng+=u>180?-360:u<-180?360:0}function Bd(_){return Math.max(0,Math.floor(_))}class Sn{constructor(n,u,f,g,b,S){this._callbacks=n,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=u||0,this._maxZoom=f||22,this._minPitch=g??0,this._maxPitch=b??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Bd(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ml,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(n,u,f){this._latRange=n.latRange,this._lngRange=n.lngRange,this._width=n.width,this._height=n.height,this._center=n.center,this._elevation=n.elevation,this._minElevationForCurrentTile=n.minElevationForCurrentTile,this._zoom=n.zoom,this._tileZoom=Bd(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=n.bearingInRadians,this._fovInRadians=n.fovInRadians,this._pitchInRadians=n.pitchInRadians,this._rollInRadians=n.rollInRadians,this._unmodified=n.unmodified,this._edgeInsets=new Ml(n.padding.top,n.padding.bottom,n.padding.left,n.padding.right),this._minZoom=n.minZoom,this._maxZoom=n.maxZoom,this._minPitch=n.minPitch,this._maxPitch=n.maxPitch,this._renderWorldCopies=n.renderWorldCopies,this._cameraToCenterDistance=n.cameraToCenterDistance,this._nearZ=n.nearZ,this._farZ=n.farZ,this._autoCalculateNearFarZ=!f&&n.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(n){this._minElevationForCurrentTile=n}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(n){this._minZoom!==n&&(this._minZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(n){this._minPitch!==n&&(this._minPitch=n,this.setPitch(Math.max(this.pitch,n)))}get maxPitch(){return this._maxPitch}setMaxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.setPitch(Math.min(this.pitch,n)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(n){const u=a.aO(n,-180,180)*Math.PI/180;var f,g,b,S,$,M,z,F,j;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=T(),f=this._rotationMatrix,b=-this._bearingInRadians,S=(g=this._rotationMatrix)[0],$=g[1],M=g[2],z=g[3],F=Math.sin(b),j=Math.cos(b),f[0]=S*j+M*F,f[1]=$*j+z*F,f[2]=S*-F+M*j,f[3]=$*-F+z*j)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(n){const u=a.ah(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(n){const u=n/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aP(this._fovInRadians)}setFov(n){n=a.ah(n,.1,150),this.fov!==n&&(this._unmodified=!1,this._fovInRadians=a.ae(n),this._calcMatrices())}get zoom(){return this._zoom}setZoom(n){const u=this.getConstrained(this._center,n).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=a.af(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(n,u){this._autoCalculateNearFarZ=!1,this._nearZ=n,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,f){this._unmodified=!1,this._edgeInsets.interpolate(n,u,f),this._constrain(),this._calcMatrices()}resize(n,u,f=!0){this._width=n,this._height=u,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new er([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(n){n?(this._lngRange=[n.getWest(),n.getEast()],this._latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-a.ai,a.ai])}getConstrained(n,u){return this._callbacks.getConstrained(n,u)}getCameraQueryGeometry(n,u){if(u.length===1)return[u[0],n];{const{minX:f,minY:g,maxX:b,maxY:S}=a.a2.fromPoints(u).extend(n);return[new a.P(f,g),new a.P(b,g),new a.P(b,S),new a.P(f,S),new a.P(f,g)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:u,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(f),this._unmodified=n,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let n=a.ag(new Float64Array(16));a.N(n,n,[this._width/2,-this._height/2,1]),a.M(n,n,[1,-1,0]),this._clipSpaceToPixelsMatrix=n,n=a.ag(new Float64Array(16)),a.N(n,n,[1,-1,1]),a.M(n,n,[-1,-1,0]),a.N(n,n,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=n,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(n,u,f,g){const b=f!==void 0?f:this.bearing,S=g=g!==void 0?g:this.pitch,$=a.a1.fromLngLat(n,u),M=-Math.cos(a.ae(S)),z=Math.sin(a.ae(S)),F=z*Math.sin(a.ae(b)),j=-z*Math.cos(a.ae(b));let B=this.elevation;const V=u-B;let W;M*V>=0||Math.abs(M)<.1?(W=1e4,B=u+W*M):W=-V/M;let te,ee,re=a.aQ(1,$.y),se=0;do{if(se+=1,se>10)break;ee=W/re,te=new a.a1($.x+F*ee,$.y+j*ee),re=1/te.meterInMercatorCoordinateUnits()}while(Math.abs(W-ee*re)>1e-12);return{center:te.toLngLat(),elevation:B,zoom:a.ak(this.height/2/Math.tan(this.fovInRadians/2)/ee/this.tileSize)}}recalculateZoomAndCenter(n){if(this.elevation-n==0)return;const u=a.aj(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/u,g=a.a1.fromLngLat(this.center,this.elevation),b=Ae(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=n;const S=this.calculateCenterFromCameraLngLatAlt(b.toLngLat(),a.aQ(b.z,g.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const n=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(n*Math.sin(this.rollInRadians),n*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const n=a.aj(1,this.center.lat)*this.worldSize;return Ae(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/n).toLngLat()}getMercatorTileCoordinates(n){if(!n)return[0,0,1,1];const u=n.canonical.z>=0?1<<n.canonical.z:Math.pow(2,n.canonical.z);return[n.canonical.x/u,n.canonical.y/u,1/u/a.$,1/u/a.$]}}class Gr{constructor(n,u){this.min=n,this.max=u,this.center=a.aR([],a.aS([],this.min,this.max),.5)}quadrant(n){const u=[n%2==0,n<2],f=a.aT(this.min),g=a.aT(this.max);for(let b=0;b<u.length;b++)f[b]=u[b]?this.min[b]:this.center[b],g[b]=u[b]?this.center[b]:this.max[b];return g[2]=this.max[2],new Gr(f,g)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersectsFrustum(n){let u=!0;for(let f=0;f<n.planes.length;f++){const g=this.intersectsPlane(n.planes[f]);if(g===0)return 0;g===1&&(u=!1)}return u?2:n.aabb.min[0]>this.max[0]||n.aabb.min[1]>this.max[1]||n.aabb.min[2]>this.max[2]||n.aabb.max[0]<this.min[0]||n.aabb.max[1]<this.min[1]||n.aabb.max[2]<this.min[2]?0:1}intersectsPlane(n){let u=n[3],f=n[3];for(let g=0;g<3;g++)n[g]>0?(u+=n[g]*this.min[g],f+=n[g]*this.max[g]):(f+=n[g]*this.min[g],u+=n[g]*this.max[g]);return u>=0?2:f<0?0:1}}class Tn{distanceToTile2d(n,u,f,g){const b=g.distanceX([n,u]),S=g.distanceY([n,u]);return Math.hypot(b,S)}getWrap(n,u,f){return f}getTileBoundingVolume(n,u,f,g){var b,S;let $=0,M=0;if(g?.terrain){const F=new a.Z(n.z,u,n.z,n.x,n.y),j=g.terrain.getMinMaxElevation(F);$=(b=j.minElevation)!==null&&b!==void 0?b:Math.min(0,f),M=(S=j.maxElevation)!==null&&S!==void 0?S:Math.max(0,f)}const z=1<<n.z;return new Gr([u+n.x/z,n.y/z,$],[u+(n.x+1)/z,(n.y+1)/z,M])}allowVariableZoom(n,u){const f=n.fov*(Math.abs(Math.cos(n.rollInRadians))*n.height+Math.abs(Math.sin(n.rollInRadians))*n.width)/n.height,g=a.ah(78.5-f/2,0,60);return!!u.terrain||n.pitch>g}allowWorldCopies(){return!0}prepareNextFrame(){}}class vr{constructor(n,u,f){this.points=n,this.planes=u,this.aabb=f}static fromInvProjectionMatrix(n,u=1,f=0,g,b){const S=b?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],$=Math.pow(2,f),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((B=>(function(V,W,te,ee){const re=a.aw([],V,W),se=1/re[3]/te*ee;return a.aY(re,re,[se,se,1/re[3],se])})(B,n,u,$)));g&&(function(B,V,W,te){const ee=te?4:0,re=te?0:4;let se=0;const ce=[],oe=[];for(let ae=0;ae<4;ae++){const we=a.aU([],B[ae+re],B[ae+ee]),Oe=a.aZ(we);a.aR(we,we,1/Oe),ce.push(Oe),oe.push(we)}for(let ae=0;ae<4;ae++){const we=a.a_(B[ae+ee],oe[ae],W);se=we!==null&&we>=0?Math.max(se,we):Math.max(se,ce[ae])}const he=(function(ae,we){const Oe=a.aU([],ae[we[0]],ae[we[1]]),Ee=a.aU([],ae[we[2]],ae[we[1]]),$e=[0,0,0,0];return a.aV($e,a.aW([],Oe,Ee)),$e[3]=-a.aX($e,ae[we[0]]),$e})(B,V),me=(function(ae,we){const Oe=a.a$(ae),Ee=a.b0([],ae,1/Oe),$e=a.aU([],we,a.aR([],Ee,a.aX(we,Ee))),ze=a.a$($e);if(ze>0){const tt=Math.sqrt(1-Ee[3]*Ee[3]),st=a.aR([],Ee,-Ee[3]),He=a.aS([],st,a.aR([],$e,tt/ze));return a.b1(we,He)}return null})(W,he);if(me!==null){const ae=me/a.aX(oe[0],he);se=Math.min(se,ae)}for(let ae=0;ae<4;ae++){const we=Math.min(se,ce[ae]);B[ae+re]=[B[ae+ee][0]+oe[ae][0]*we,B[ae+ee][1]+oe[ae][1]*we,B[ae+ee][2]+oe[ae][2]*we,1]}})(M,S[0],g,b);const z=S.map((B=>{const V=a.aU([],M[B[0]],M[B[1]]),W=a.aU([],M[B[2]],M[B[1]]),te=a.aV([],a.aW([],V,W)),ee=-a.aX(te,M[B[1]]);return te.concat(ee)})),F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],j=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const B of M)for(let V=0;V<3;V++)F[V]=Math.min(F[V],B[V]),j[V]=Math.max(j[V],B[V]);return new vr(M,z,new Gr(F,j))}}class Mi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,f){return this._helper.interpolatePadding(n,u,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,f=!0){this._helper.resize(n,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n,u){}constructor(n,u,f,g,b){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,$)=>this.getConstrained(S,$)},n,u,f,g,b),this._coveringTilesDetailsProvider=new Tn}clone(){const n=new Mi;return n.apply(this),n}apply(n,u,f){this._helper.apply(n,u,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(n){const u=[new a.b2(0,n)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new a.P(0,0)),g=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),b=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),$=Math.floor(Math.min(f.x,g.x,b.x,S.x)),M=Math.floor(Math.max(f.x,g.x,b.x,S.x)),z=1;for(let F=$-z;F<=M+z;F++)F!==0&&u.push(new a.b2(F,n))}return u}getCameraFrustum(){return vr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){const u=this.screenPointToLocation(this.centerPoint,n),f=n?n.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(n,u){const f=a.aj(this.elevation,this.center.lat),g=this.screenPointToMercatorCoordinateAtZ(u,f),b=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),S=a.a1.fromLngLat(n),$=new a.a1(S.x-(g.x-b.x),S.y-(g.y-b.y));this.setCenter($?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(n,u){return u?this.coordinatePoint(a.a1.fromLngLat(n),u.getElevationForLngLatZoom(n,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.a1.fromLngLat(n))}screenPointToLocation(n,u){var f;return(f=this.screenPointToMercatorCoordinate(n,u))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(n,u){if(u){const f=u.pointCoordinate(n);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(n)}screenPointToMercatorCoordinateAtZ(n,u){const f=u||0,g=[n.x,n.y,0,1],b=[n.x,n.y,1,1];a.aw(g,g,this._pixelMatrixInverse),a.aw(b,b,this._pixelMatrixInverse);const S=g[3],$=b[3],M=g[1]/S,z=b[1]/$,F=g[2]/S,j=b[2]/$,B=F===j?0:(f-F)/(j-F);return new a.a1(a.C.number(g[0]/S,b[0]/$,B)/this.worldSize,a.C.number(M,z,B)/this.worldSize,f)}coordinatePoint(n,u=0,f=this._pixelMatrix){const g=[n.x*this.worldSize,n.y*this.worldSize,u,1];return a.aw(g,g,f),new a.P(g[0]/g[3],g[1]/g[3])}getBounds(){const n=Math.max(0,this._helper._height/2-fe(this));return new er().extend(this.screenPointToLocation(new a.P(0,n))).extend(this.screenPointToLocation(new a.P(this._helper._width,n))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(n,u){return u?u.pointCoordinate(n)!=null:n.y>this.height/2-fe(this)}calculatePosMatrix(n,u=!1,f){var g;const b=(g=n.key)!==null&&g!==void 0?g:a.b3(n.wrap,n.canonical.z,n.canonical.z,n.canonical.x,n.canonical.y),S=u?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(b)){const z=S.get(b);return f?z.f32:z.f64}const $=xe(n,this.worldSize);a.O($,u?this._alignedProjMatrix:this._viewProjMatrix,$);const M={f64:$,f32:new Float32Array($)};return S.set(b,M),f?M.f32:M.f64}calculateFogMatrix(n){const u=n.key,f=this._fogMatrixCacheF32;if(f.has(u))return f.get(u);const g=xe(n,this.worldSize);return a.O(g,this._fogMatrix,g),f.set(u,new Float32Array(g)),f.get(u)}getConstrained(n,u){u=a.ah(+u,this.minZoom,this.maxZoom);const f={center:new a.S(n.lng,n.lat),zoom:u};let g=this._helper._lngRange;if(!this._helper._renderWorldCopies&&g===null){const ce=179.9999999999;g=[-ce,ce]}const b=this.tileSize*a.af(f.zoom);let S=0,$=b,M=0,z=b,F=0,j=0;const{x:B,y:V}=this.size;if(this._helper._latRange){const ce=this._helper._latRange;S=a.U(ce[1])*b,$=a.U(ce[0])*b,$-S<V&&(F=V/($-S))}g&&(M=a.aO(a.V(g[0])*b,0,b),z=a.aO(a.V(g[1])*b,0,b),z<M&&(z+=b),z-M<B&&(j=B/(z-M)));const{x:W,y:te}=K(b,n);let ee,re;const se=Math.max(j||0,F||0);if(se){const ce=new a.P(j?(z+M)/2:W,F?($+S)/2:te);return f.center=le(b,ce).wrap(),f.zoom+=a.ak(se),f}if(this._helper._latRange){const ce=V/2;te-ce<S&&(re=S+ce),te+ce>$&&(re=$-ce)}if(g){const ce=(M+z)/2;let oe=W;this._helper._renderWorldCopies&&(oe=a.aO(W,ce-b/2,ce+b/2));const he=B/2;oe-he<M&&(ee=M+he),oe+he>z&&(ee=z-he)}if(ee!==void 0||re!==void 0){const ce=new a.P(ee??W,re??te);f.center=le(b,ce).wrap()}return f}calculateCenterFromCameraLngLatAlt(n,u,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,f,g)}_calculateNearFarZIfNeeded(n,u,f){if(!this._helper.autoCalculateNearFarZ)return;const g=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),b=n-g*this._helper._pixelPerMeter/Math.cos(u),S=g<0?b:n,$=Math.PI/2+this.pitchInRadians,M=a.ae(this.fov)*(Math.abs(Math.cos(a.ae(this.roll)))*this.height+Math.abs(Math.sin(a.ae(this.roll)))*this.width)/this.height*(.5+f.y/this.height),z=Math.sin(M)*S/Math.sin(a.ah(Math.PI-$-M,.01,Math.PI-.01)),F=fe(this),j=Math.atan(F/this._helper.cameraToCenterDistance),B=a.ae(.75),V=j>B?2*j*(.5+f.y/(2*F)):B,W=Math.sin(V)*S/Math.sin(a.ah(Math.PI-$-V,.01,Math.PI-.01)),te=Math.min(z,W);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*te+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const n=this.centerOffset,u=K(this.worldSize,this.center),f=u.x,g=u.y;this._helper._pixelPerMeter=a.aj(1,this.center.lat)*this.worldSize;const b=a.ae(Math.min(this.pitch,J)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(b));let $;this._calculateNearFarZIfNeeded(S,b,n),$=new Float64Array(16),a.b4($,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.aq(this._invProjMatrix,$),$[8]=2*-n.x/this._helper._width,$[9]=2*n.y/this._helper._height,this._projectionMatrix=a.b5($),a.N($,$,[1,-1,1]),a.M($,$,[0,0,-this._helper.cameraToCenterDistance]),a.b6($,$,-this.rollInRadians),a.b7($,$,this.pitchInRadians),a.b6($,$,-this.bearingInRadians),a.M($,$,[-f,-g,0]),this._mercatorMatrix=a.N([],$,[this.worldSize,this.worldSize,this.worldSize]),a.N($,$,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,$),a.M($,$,[0,0,-this.elevation]),this._viewProjMatrix=$,this._invViewProjMatrix=a.aq([],$);const M=[0,0,-1,1];a.aw(M,M,this._invViewProjMatrix),this._cameraPosition=[M[0]/M[3],M[1]/M[3],M[2]/M[3]],this._fogMatrix=new Float64Array(16),a.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-n.x/this.width,this._fogMatrix[9]=2*n.y/this.height,a.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.M(this._fogMatrix,this._fogMatrix,[-f,-g,0]),a.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,$);const z=this._helper._width%2/2,F=this._helper._height%2/2,j=Math.cos(this.bearingInRadians),B=Math.sin(-this.bearingInRadians),V=f-Math.round(f)+j*z+B*F,W=g-Math.round(g)+j*F+B*z,te=new Float64Array($);if(a.M(te,te,[V>.5?V-1:V,W>.5?W-1:W,0]),this._alignedProjMatrix=te,$=a.aq(new Float64Array(16),this._pixelMatrix),!$)throw new Error("failed to invert matrix");this._pixelMatrixInverse=$,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const n=this.screenPointToMercatorCoordinate(new a.P(0,0)),u=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.aw(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const n=a.aj(1,this.center.lat)*this.worldSize;return Ae(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/n).toLngLat()}lngLatToCameraDepth(n,u){const f=a.a1.fromLngLat(n),g=[f.x*this.worldSize,f.y*this.worldSize,u,1];return a.aw(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(n){const{overscaledTileID:u,aligned:f,applyTerrainMatrix:g}=n,b=this._helper.getMercatorTileCoordinates(u),S=u?this.calculatePosMatrix(u,f,!0):null;let $;return $=u&&u.terrainRttPosMatrix32f&&g?u.terrainRttPosMatrix32f:S||a.b8(),{mainMatrix:$,tileMercatorCoords:b,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:$}}isLocationOccluded(n){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(n,u,f){return 1}transformLightDirection(n){return a.aT(n)}getRayDirectionFromPixel(n){throw new Error("Not implemented.")}projectTileCoordinates(n,u,f,g){const b=this.calculatePosMatrix(f);let S;g?(S=[n,u,g(n,u),1],a.aw(S,S,b)):(S=[n,u,0,1],Pc(S,S,b));const $=S[3];return{point:new a.P(S[0]/$,S[1]/$),signedDistanceFromCamera:$,isOccluded:!1}}populateCache(n){for(const u of n)this.calculatePosMatrix(u)}getMatrixForModel(n,u){const f=a.a1.fromLngLat(n,u),g=f.meterInMercatorCoordinateUnits(),b=a.b9();return a.M(b,b,[f.x,f.y,f.z]),a.b6(b,b,Math.PI),a.b7(b,b,Math.PI/2),a.N(b,b,[-g,g,g]),b}getProjectionDataForCustomLayer(n=!0){const u=new a.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:n}),g=xe(u,this.worldSize);a.O(g,this._viewProjMatrix,g),f.tileMercatorCoords=[0,0,1,1];const b=[a.$,a.$,this.worldSize/this._helper.pixelsPerMeter],S=a.ba();return a.N(S,g,b),f.fallbackMatrix=S,f.mainMatrix=S,f}getFastPathSimpleProjectionMatrix(n){return this.calculatePosMatrix(n)}}function Tv(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Cn(_){if(_.useSlerp)if(_.k<1){const n=a.bb(_.startEulerAngles.roll,_.startEulerAngles.pitch,_.startEulerAngles.bearing),u=a.bb(_.endEulerAngles.roll,_.endEulerAngles.pitch,_.endEulerAngles.bearing),f=new Float64Array(4);a.bc(f,n,u,_.k);const g=a.bd(f);_.tr.setRoll(g.roll),_.tr.setPitch(g.pitch),_.tr.setBearing(g.bearing)}else _.tr.setRoll(_.endEulerAngles.roll),_.tr.setPitch(_.endEulerAngles.pitch),_.tr.setBearing(_.endEulerAngles.bearing);else _.tr.setRoll(a.C.number(_.startEulerAngles.roll,_.endEulerAngles.roll,_.k)),_.tr.setPitch(a.C.number(_.startEulerAngles.pitch,_.endEulerAngles.pitch,_.k)),_.tr.setBearing(a.C.number(_.startEulerAngles.bearing,_.endEulerAngles.bearing,_.k))}function is(_,n,u,f,g){const b=g.padding,S=K(g.worldSize,u.getNorthWest()),$=K(g.worldSize,u.getNorthEast()),M=K(g.worldSize,u.getSouthEast()),z=K(g.worldSize,u.getSouthWest()),F=a.ae(-f),j=S.rotate(F),B=$.rotate(F),V=M.rotate(F),W=z.rotate(F),te=new a.P(Math.max(j.x,B.x,W.x,V.x),Math.max(j.y,B.y,W.y,V.y)),ee=new a.P(Math.min(j.x,B.x,W.x,V.x),Math.min(j.y,B.y,W.y,V.y)),re=te.sub(ee),se=(g.width-(b.left+b.right+n.left+n.right))/re.x,ce=(g.height-(b.top+b.bottom+n.top+n.bottom))/re.y;if(ce<0||se<0)return void Tv();const oe=Math.min(a.ak(g.scale*Math.min(se,ce)),_.maxZoom),he=a.P.convert(_.offset),me=new a.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(a.ae(f)),ae=he.add(me).mult(g.scale/a.af(oe));return{center:le(g.worldSize,S.add(M).div(2).sub(ae)),zoom:oe,bearing:f}}class fn{get useGlobeControls(){return!1}handlePanInertia(n,u){const f=n.mag(),g=Math.abs(fe(u));return{easingOffset:n.mult(Math.min(.75*g/f,1)),easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(n,u){n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta),n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta)}handleMapControlsPan(n,u,f){n.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(f,n.around)}cameraForBoxAndBearing(n,u,f,g,b){return is(n,u,f,g,b)}handleJumpToCenterZoom(n,u){n.zoom!==(u.zoom!==void 0?+u.zoom:n.zoom)&&n.setZoom(+u.zoom),u.center!==void 0&&n.setCenter(a.S.convert(u.center))}handleEaseTo(n,u){const f=n.zoom,g=n.padding,b={roll:n.roll,pitch:n.pitch,bearing:n.bearing},S={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},$=u.zoom!==void 0,M=!n.isPaddingEqual(u.padding);let z=!1;const F=$?+u.zoom:n.zoom;let j=n.centerPoint.add(u.offsetAsPoint);const B=n.screenPointToLocation(j),{center:V,zoom:W}=n.getConstrained(a.S.convert(u.center||B),F??f);Nd(n,V);const te=K(n.worldSize,B),ee=K(n.worldSize,V).sub(te),re=a.af(W-f);return z=W!==f,{easeFunc:se=>{if(z&&n.setZoom(a.C.number(f,W,se)),a.be(b,S)||Cn({startEulerAngles:b,endEulerAngles:S,tr:n,k:se,useSlerp:b.roll!=S.roll}),M&&(n.interpolatePadding(g,u.padding,se),j=n.centerPoint.add(u.offsetAsPoint)),u.around)n.setLocationAtPoint(u.around,u.aroundPoint);else{const ce=a.af(n.zoom-f),oe=W>f?Math.min(2,re):Math.max(.5,re),he=Math.pow(oe,1-se),me=le(n.worldSize,te.add(ee.mult(se*he)).mult(ce));n.setLocationAtPoint(n.renderWorldCopies?me.wrap():me,j)}},isZooming:z,elevationCenter:V}}handleFlyTo(n,u){const f=u.zoom!==void 0,g=n.zoom,b=n.getConstrained(a.S.convert(u.center||u.locationAtOffset),f?+u.zoom:g),S=b.center,$=b.zoom;Nd(n,S);const M=K(n.worldSize,u.locationAtOffset),z=K(n.worldSize,S).sub(M),F=z.mag(),j=a.af($-g);let B;if(u.minZoom!==void 0){const V=Math.min(+u.minZoom,g,$),W=n.getConstrained(S,V).zoom;B=a.af(W-g)}return{easeFunc:(V,W,te,ee)=>{n.setZoom(V===1?$:g+a.ak(W));const re=V===1?S:le(n.worldSize,M.add(z.mult(te)).mult(W));n.setLocationAtPoint(n.renderWorldCopies?re.wrap():re,ee)},scaleOfZoom:j,targetCenter:S,scaleOfMinZoom:B,pixelPathLength:F}}}class Ni{constructor(n,u,f){this.blendFunction=n,this.blendColor=u,this.mask=f}}Ni.Replace=[1,0],Ni.disabled=new Ni(Ni.Replace,a.bf.transparent,[!1,!1,!1,!1]),Ni.unblended=new Ni(Ni.Replace,a.bf.transparent,[!0,!0,!0,!0]),Ni.alphaBlended=new Ni([1,771],a.bf.transparent,[!0,!0,!0,!0]);const kl=2305;class kt{constructor(n,u,f){this.enable=n,this.mode=u,this.frontFace=f}}kt.disabled=new kt(!1,1029,kl),kt.backCCW=new kt(!0,1029,kl),kt.frontCCW=new kt(!0,1028,kl);class Bt{constructor(n,u,f){this.func=n,this.mask=u,this.range=f}}Bt.ReadOnly=!1,Bt.ReadWrite=!0,Bt.disabled=new Bt(519,Bt.ReadOnly,[0,1]);const Yo=7680;class ci{constructor(n,u,f,g,b,S){this.test=n,this.ref=u,this.mask=f,this.fail=g,this.depthFail=b,this.pass=S}}ci.disabled=new ci({func:519,mask:0},0,0,Yo,Yo,Yo);const rs=new WeakMap;function Co(_){var n;if(rs.has(_))return rs.get(_);{const u=(n=_.getParameter(_.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return rs.set(_,u),u}}class Eo{get awaitingQuery(){return!!this._readbackQueue}constructor(n){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=n;const u=n.context,f=u.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const g=new a.aL;g.emplaceBack(-1,-1),g.emplaceBack(2,-1),g.emplaceBack(-1,2);const b=new a.aN;b.emplaceBack(0,1,2),this._fullscreenTriangle=new $l(u.createVertexBuffer(g,Ua.members),u.createIndexBuffer(b),a.aM.simpleSegment(0,0,g.length,b.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(f.TEXTURE1);const S=f.createTexture();f.bindTexture(f.TEXTURE_2D,S),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),Co(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const n=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),n.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(n,u){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(n,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const n=this._cachedRenderContext.context,u=n.gl;n.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),n.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(n,u){const f=this._cachedRenderContext.context,g=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:a.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,g.TRIANGLES,Bt.disabled,ci.disabled,Ni.unblended,kt.disabled,((b,S)=>({u_input:b,u_output_expected:S}))(n,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Co(g)){g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.readBuffer(g.COLOR_ATTACHMENT0),g.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),g.bindBuffer(g.PIXEL_PACK_BUFFER,null);const b=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0);g.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:b}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const n=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Co(n)){const u=n.clientWaitSync(this._readbackQueue.sync,0,0);if(u===n.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===n.TIMEOUT_EXPIRED)return;n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),n.bindBuffer(n.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),n.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Eo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(n){let u=0;return u+=n[0]/256,u+=n[1]/65536,u+=n[2]/16777216,n[3]<127&&(u=-u),u/128}}const jd=a.$/128;function Vm(_,n){const u=_.granularity!==void 0?Math.max(_.granularity,1):1,f=u+(_.generateBorders?2:0),g=u+(_.extendToNorthPole||_.generateBorders?1:0)+(_.extendToSouthPole||_.generateBorders?1:0),b=f+1,S=g+1,$=_.generateBorders?-1:0,M=_.generateBorders||_.extendToNorthPole?-1:0,z=u+(_.generateBorders?1:0),F=u+(_.generateBorders||_.extendToSouthPole?1:0),j=b*S,B=f*g*6,V=b*S>65536;if(V&&n==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const W=V||n==="32bit",te=new Int16Array(2*j);let ee=0;for(let ce=M;ce<=F;ce++)for(let oe=$;oe<=z;oe++){let he=oe/u*a.$;oe===-1&&(he=-jd),oe===u+1&&(he=a.$+jd);let me=ce/u*a.$;ce===-1&&(me=_.extendToNorthPole?a.bh:-jd),ce===u+1&&(me=_.extendToSouthPole?a.bi:a.$+jd),te[ee++]=he,te[ee++]=me}const re=W?new Uint32Array(B):new Uint16Array(B);let se=0;for(let ce=0;ce<g;ce++)for(let oe=0;oe<f;oe++){const he=oe+1+ce*b,me=oe+(ce+1)*b,ae=oe+1+(ce+1)*b;re[se++]=oe+ce*b,re[se++]=me,re[se++]=he,re[se++]=he,re[se++]=me,re[se++]=ae}return{vertices:te.buffer.slice(0),indices:re.buffer.slice(0),uses32bitIndices:W}}const zc=new a.aK({fill:new a.bj(128,2),line:new a.bj(512,0),tile:new a.bj(128,32),stencil:new a.bj(128,1),circle:3});class Ju{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ns.projectionGlobe}get vertexShaderPreludeCode(){return Ns.projectionMercator.vertexSource}get subdivisionGranularity(){return zc}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(n){this._errorMeasurement||(this._errorMeasurement=new Eo(n));const u=a.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,g=this._errorMeasurement.updateErrorLoop(u,f),b=L.now();g!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=g,this._errorMeasurementLastChangeTime=b);const S=Math.min(Math.max((b-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bl(S))}_getMeshKey(n){return`${n.granularity.toString(36)}_${n.generateBorders?"b":""}${n.extendToNorthPole?"n":""}${n.extendToSouthPole?"s":""}`}getMeshFromTileID(n,u,f,g,b){const S=(b==="stencil"?zc.stencil:zc.tile).getGranularityForZoomLevel(u.z);return this._getMesh(n,{granularity:S,generateBorders:f,extendToNorthPole:u.y===0&&g,extendToSouthPole:u.y===(1<<u.z)-1&&g})}_getMesh(n,u){const f=this._getMeshKey(u);if(f in this._tileMeshCache)return this._tileMeshCache[f];const g=(function(b,S){const $=Vm(S,"16bit"),M=a.aL.deserialize({arrayBuffer:$.vertices,length:$.vertices.byteLength/2/2}),z=a.aN.deserialize({arrayBuffer:$.indices,length:$.indices.byteLength/2/3});return new $l(b.createVertexBuffer(M,Ua.members),b.createIndexBuffer(z),a.aM.simpleSegment(0,0,M.length,z.length))})(n,u);return this._tileMeshCache[f]=g,g}recalculate(n){}hasTransition(){const n=L.now();let u=!1;return u=u||(n-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(n){this._errorQueryLatitudeDegrees=n}}const Ud=new a.r({type:new a.D(a.v.projection.type)});class Vd extends a.E{constructor(n){super(),this._transitionable=new a.t(Ud),this.setProjection(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0)),this._mercatorProjection=new ei,this._verticalPerspectiveProjection=new Ju}get transitionState(){const n=this.properties.get("type");if(typeof n=="string"&&n==="mercator")return 0;if(typeof n=="string"&&n==="vertical-perspective")return 1;if(n instanceof a.bm){if(n.from==="vertical-perspective"&&n.to==="mercator")return 1-n.transition;if(n.from==="mercator"&&n.to==="vertical-perspective")return n.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(n){this._mercatorProjection.updateGPUdependent(n),this._verticalPerspectiveProjection.updateGPUdependent(n)}getMeshFromTileID(n,u,f,g,b){return this.currentProjection.getMeshFromTileID(n,u,f,g,b)}setProjection(n){this._transitionable.setValue("type",n?.type||"mercator")}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}setErrorQueryLatitudeDegrees(n){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(n),this._mercatorProjection.setErrorQueryLatitudeDegrees(n)}}function Gd(_){const n=Oc(_.worldSize,_.center.lat);return 2*Math.PI*n}function Bs(_,n,u,f,g){const b=1/(1<<g),S=n/a.$*b+f*b,$=a.bo((_/a.$*b+u*b)*Math.PI*2+Math.PI,2*Math.PI),M=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,z=Math.cos(M),F=new Float64Array(3);return F[0]=Math.sin($)*z,F[1]=Math.sin(M),F[2]=Math.cos($)*z,F}function qr(_){return(function(n,u){const f=Math.cos(u),g=new Float64Array(3);return g[0]=Math.sin(n)*f,g[1]=Math.sin(u),g[2]=Math.cos(n)*f,g})(_.lng*Math.PI/180,_.lat*Math.PI/180)}function Oc(_,n){return _/(2*Math.PI)/Math.cos(n*Math.PI/180)}function Ku(_){const n=Math.asin(_[1])/Math.PI*180,u=Math.sqrt(_[0]*_[0]+_[2]*_[2]);if(u>1e-6){const f=_[0]/u,g=Math.acos(_[2]/u),b=(f>0?g:-g)/Math.PI*180;return new a.S(a.aO(b,-180,180),n)}return new a.S(0,n)}function Al(_){return Math.cos(_*Math.PI/180)}function ir(_,n){const u=Al(_),f=Al(n);return a.ak(f/u)}function Cv(_,n){const u=_.rotate(n.bearingInRadians),f=n.zoom+ir(n.center.lat,0),g=a.bk(1/Al(n.center.lat),1/Al(Math.min(Math.abs(n.center.lat),60)),a.bn(f,7,3,0,1)),b=360/Gd({worldSize:n.worldSize,center:{lat:n.center.lat}});return new a.S(n.center.lng-u.x*b*g,a.ah(n.center.lat+u.y*b,-a.ai,a.ai))}function Qu(_){const n=.5*_,u=Math.sin(n),f=Math.cos(n);return Math.log(u+f)-Math.log(f-u)}function Gm(_,n,u,f){const g=_.lat+u*f;if(Math.abs(u)>1){const b=(Math.sign(_.lat+u)!==Math.sign(_.lat)?-Math.abs(_.lat):Math.abs(_.lat))*Math.PI/180,S=Math.abs(_.lat+u)*Math.PI/180,$=Qu(b+f*(S-b)),M=Qu(b),z=Qu(S);return new a.S(_.lng+n*(($-M)/(z-M)),g)}return new a.S(_.lng+n*f,g)}class t2{constructor(n){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=n}swapBuffers(){if(!this._hadAnyChanges)return;const n=this._cachePrevious;this._cachePrevious=this._cache,this._cache=n,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(n,u,f,g){const b=`${n.z}_${n.x}_${n.y}_${g?.terrain?"t":""}`,S=this._cache.get(b);if(S)return S;const $=this._cachePrevious.get(b);if($)return this._cache.set(b,$),$;const M=this._boundingVolumeFactory(n,u,f,g);return this._cache.set(b,M),this._hadAnyChanges=!0,M}}class Rc{constructor(n,u,f,g){this.min=f,this.max=g,this.points=n,this.planes=u}static fromAabb(n,u){const f=[];for(let g=0;g<8;g++)f.push([1&~g?n[0]:u[0],(g>>1&1)==1?u[1]:n[1],(g>>2&1)==1?u[2]:n[2]]);return new Rc(f,[[-1,0,0,u[0]],[1,0,0,-n[0]],[0,-1,0,u[1]],[0,1,0,-n[1]],[0,0,-1,u[2]],[0,0,1,-n[2]]],n,u)}static fromCenterSizeAngles(n,u,f){const g=a.br([],f[0],f[1],f[2]),b=a.bs([],[u[0],0,0],g),S=a.bs([],[0,u[1],0],g),$=a.bs([],[0,0,u[2]],g),M=[...n],z=[...n];for(let j=0;j<8;j++)for(let B=0;B<3;B++){const V=n[B]+b[B]*(1&~j?-1:1)+S[B]*((j>>1&1)==1?1:-1)+$[B]*((j>>2&1)==1?1:-1);M[B]=Math.min(M[B],V),z[B]=Math.max(z[B],V)}const F=[];for(let j=0;j<8;j++){const B=[...n];a.aS(B,B,a.aR([],b,1&~j?-1:1)),a.aS(B,B,a.aR([],S,(j>>1&1)==1?1:-1)),a.aS(B,B,a.aR([],$,(j>>2&1)==1?1:-1)),F.push(B)}return new Rc(F,[[...b,-a.aX(b,F[0])],[...S,-a.aX(S,F[0])],[...$,-a.aX($,F[0])],[-b[0],-b[1],-b[2],-a.aX(b,F[7])],[-S[0],-S[1],-S[2],-a.aX(S,F[7])],[-$[0],-$[1],-$[2],-a.aX($,F[7])]],M,z)}intersectsFrustum(n){let u=!0;const f=this.points.length,g=this.planes.length,b=n.planes.length,S=n.points.length;for(let $=0;$<b;$++){const M=n.planes[$];let z=0;for(let F=0;F<f;F++){const j=this.points[F];M[0]*j[0]+M[1]*j[1]+M[2]*j[2]+M[3]>=0&&z++}if(z===0)return 0;z<f&&(u=!1)}if(u)return 2;for(let $=0;$<g;$++){const M=this.planes[$];let z=0;for(let F=0;F<S;F++){const j=n.points[F];M[0]*j[0]+M[1]*j[1]+M[2]*j[2]+M[3]>=0&&z++}if(z===0)return 0}return 1}intersectsPlane(n){const u=this.points.length;let f=0;for(let g=0;g<u;g++){const b=this.points[g];n[0]*b[0]+n[1]*b[1]+n[2]*b[2]+n[3]>=0&&f++}return f===u?2:f===0?0:1}}function an(_,n,u){const f=_-n;return f<0?-f:Math.max(0,f-u)}function eh(_,n,u,f,g){const b=_-u;let S;return S=b<0?Math.min(-b,1+b-g):b>1?Math.min(Math.max(b-g,0),1-b):0,Math.max(S,an(n,f,g))}class Io{constructor(){this._boundingVolumeCache=new t2(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(n,u,f,g){const b=1<<f.z,S=1/b,$=f.x/b,M=f.y/b;let z=2;return z=Math.min(z,eh(n,u,$,M,S)),z=Math.min(z,eh(n,u,$+.5,-M-S,S)),z=Math.min(z,eh(n,u,$+.5,2-M-S,S)),z}getWrap(n,u,f){const g=1<<u.z,b=1/g,S=u.x/g,$=an(n.x,S,b),M=an(n.x,S-1,b),z=an(n.x,S+1,b),F=Math.min($,M,z);return F===z?1:F===M?-1:0}allowVariableZoom(n,u){return St(n,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(n,u,f,g){return this._boundingVolumeCache.getTileBoundingVolume(n,u,f,g)}_computeTileBoundingVolume(n,u,f,g){var b,S;let $=0,M=0;if(g?.terrain){const z=new a.Z(n.z,u,n.z,n.x,n.y),F=g.terrain.getMinMaxElevation(z);$=(b=F.minElevation)!==null&&b!==void 0?b:Math.min(0,f),M=(S=F.maxElevation)!==null&&S!==void 0?S:Math.max(0,f)}if($/=a.bu,M/=a.bu,$+=1,M+=1,n.z<=0)return Rc.fromAabb([-M,-M,-M],[M,M,M]);if(n.z===1)return Rc.fromAabb([n.x===0?-M:0,n.y===0?0:-M,-M],[n.x===0?0:M,n.y===0?M:0,M]);{const z=[Bs(0,0,n.x,n.y,n.z),Bs(a.$,0,n.x,n.y,n.z),Bs(a.$,a.$,n.x,n.y,n.z),Bs(0,a.$,n.x,n.y,n.z)],F=[];for(const $e of z)F.push(a.aR([],$e,M));if(M!==$)for(const $e of z)F.push(a.aR([],$e,$));n.y===0&&F.push([0,1,0]),n.y===(1<<n.z)-1&&F.push([0,-1,0]);const j=[1,1,1],B=[-1,-1,-1];for(const $e of F)for(let ze=0;ze<3;ze++)j[ze]=Math.min(j[ze],$e[ze]),B[ze]=Math.max(B[ze],$e[ze]);const V=Bs(a.$/2,a.$/2,n.x,n.y,n.z),W=a.aW([],[0,1,0],V);a.aV(W,W);const te=a.aW([],V,W);a.aV(te,te);const ee=a.aW([],z[2],z[1]);a.aV(ee,ee);const re=a.aW([],z[0],z[3]);a.aV(re,re),F.push(a.aR([],V,M)),n.y>=(1<<n.z)/2&&F.push(a.aR([],Bs(a.$/2,0,n.x,n.y,n.z),M)),n.y<(1<<n.z)/2&&F.push(a.aR([],Bs(a.$/2,a.$,n.x,n.y,n.z),M));const se=th(V,F),ce=th(te,F),oe=[-V[0],-V[1],-V[2],se.max],he=[V[0],V[1],V[2],-se.min],me=[-te[0],-te[1],-te[2],ce.max],ae=[te[0],te[1],te[2],-ce.min],we=[...ee,0],Oe=[...re,0],Ee=[];return n.y===0?Ee.push(a.bt(Oe,we,oe),a.bt(Oe,we,he)):Ee.push(a.bt(me,we,oe),a.bt(me,we,he),a.bt(me,Oe,oe),a.bt(me,Oe,he)),n.y===(1<<n.z)-1?Ee.push(a.bt(Oe,we,oe),a.bt(Oe,we,he)):Ee.push(a.bt(ae,we,oe),a.bt(ae,we,he),a.bt(ae,Oe,oe),a.bt(ae,Oe,he)),new Rc(Ee,[oe,he,me,ae,we,Oe],j,B)}}}function th(_,n){let u=1/0,f=-1/0;for(const g of n){const b=a.aX(_,g);u=Math.min(u,b),f=Math.max(f,b)}return{min:u,max:f}}class ih{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,f){return this._helper.interpolatePadding(n,u,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u){this._helper.resize(n,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(n){}constructor(){this._cachedClippingPlane=a.bv(),this._projectionMatrix=a.b9(),this._globeViewProjMatrix32f=a.b8(),this._globeViewProjMatrixNoCorrection=a.b9(),this._globeViewProjMatrixNoCorrectionInverted=a.b9(),this._globeProjMatrixInverted=a.b9(),this._cameraPosition=a.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,u)=>this.getConstrained(n,u)}),this._coveringTilesDetailsProvider=new Io}clone(){const n=new ih;return n.apply(this),n}apply(n,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(n)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const n=a.bp();return n[0]=this._cameraPosition[0],n[1]=this._cameraPosition[1],n[2]=this._cameraPosition[2],n}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(n){const{overscaledTileID:u,applyGlobeMatrix:f}=n,g=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:g,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(n){const u=this.pitchInRadians,f=this.cameraToCenterDistance/n,g=Math.sin(u)*f,b=Math.cos(u)*f+1,S=1/Math.sqrt(g*g+b*b)*1;let $=-g,M=b;const z=Math.sqrt($*$+M*M);$/=z,M/=z;const F=[0,$,M];a.bw(F,F,[0,0,0],-this.bearingInRadians),a.bx(F,F,[0,0,0],-1*this.center.lat*Math.PI/180),a.by(F,F,[0,0,0],this.center.lng*Math.PI/180);const j=1/a.aZ(F);return a.aR(F,F,j),[...F,-S*j]}isLocationOccluded(n){return!this.isSurfacePointVisible(qr(n))}transformLightDirection(n){const u=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,g=Math.cos(f),b=[Math.sin(u)*g,Math.sin(f),Math.cos(u)*g],S=[b[2],0,-b[0]],$=[0,0,0];a.aW($,S,b),a.aV(S,S),a.aV($,$);const M=[0,0,0];return a.aV(M,[S[0]*n[0]+$[0]*n[1]+b[0]*n[2],S[1]*n[0]+$[1]*n[1]+b[1]*n[2],S[2]*n[0]+$[2]*n[1]+b[2]*n[2]]),M}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(n,u,f){const g=(function($,M,z){const F=1/(1<<z.z);return new a.a1($/a.$*F+z.x*F,M/a.$*F+z.y*F)})(n,u,f.canonical),b=(S=g.y,[a.bo(g.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(b[1])}projectTileCoordinates(n,u,f,g){const b=f.canonical,S=Bs(n,u,b.x,b.y,b.z),$=1+(g?g(n,u):0)/a.bu,M=[S[0]*$,S[1]*$,S[2]*$,1];a.aw(M,M,this._globeViewProjMatrixNoCorrection);const z=this._cachedClippingPlane,F=z[0]*S[0]+z[1]*S[1]+z[2]*S[2]+z[3]<0;return{point:new a.P(M[0]/M[3],M[1]/M[3]),signedDistanceFromCamera:M[3],isOccluded:F}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const n=Oc(this.worldSize,this.center.lat),u=a.ba(),f=a.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*n),a.b4(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const g=this.centerOffset;u[8]=2*-g.x/this._helper._width,u[9]=2*g.y/this._helper._height,this._projectionMatrix=a.b5(u),this._globeProjMatrixInverted=a.ba(),a.aq(this._globeProjMatrixInverted,u),a.M(u,u,[0,0,-this.cameraToCenterDistance]),a.b6(u,u,this.rollInRadians),a.b7(u,u,-this.pitchInRadians),a.b6(u,u,this.bearingInRadians),a.M(u,u,[0,0,-n]);const b=a.bp();b[0]=n,b[1]=n,b[2]=n,a.b7(f,u,this.center.lat*Math.PI/180),a.bz(f,f,-this.center.lng*Math.PI/180),a.N(f,f,b),this._globeViewProjMatrixNoCorrection=f,a.b7(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bz(u,u,-this.center.lng*Math.PI/180),a.N(u,u,b),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=a.ba(),a.aq(this._globeViewProjMatrixNoCorrectionInverted,f);const S=a.bp();this._cameraPosition=a.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/n,a.bw(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),a.bx(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),a.bw(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),a.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bx(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),a.by(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(n);const $=a.b5(this._globeViewProjMatrixNoCorrectionInverted);a.N($,$,[1,1,-1]),this._cachedFrustum=vr.fromInvProjectionMatrix($,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(n){a.w("calculateFogMatrix is not supported on globe projection.");const u=a.ba();return a.ag(u),u}getVisibleUnwrappedCoordinates(n){return[new a.b2(0,n)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(n){n&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=qr(n);a.aR(f,f,1+u/a.bu);const g=a.bv();return a.aw(g,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(n){}getBounds(){const n=.5*this.width,u=.5*this.height,f=[new a.P(0,0),new a.P(n,0),new a.P(this.width,0),new a.P(this.width,u),new a.P(this.width,this.height),new a.P(n,this.height),new a.P(0,this.height),new a.P(0,u)],g=[];for(const j of f)g.push(this.unprojectScreenPoint(j));let b=0,S=0,$=0,M=0;const z=this.center;for(const j of g){const B=a.bA(z.lng,j.lng),V=a.bA(z.lat,j.lat);B<S&&(S=B),B>b&&(b=B),V<M&&(M=V),V>$&&($=V)}const F=[z.lng+S,z.lat+M,z.lng+b,z.lat+$];return this.isSurfacePointOnScreen([0,1,0])&&(F[3]=90,F[0]=-180,F[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(F[1]=-90,F[0]=-180,F[2]=180),new er(F)}getConstrained(n,u){const f=a.ah(n.lat,-a.ai,a.ai),g=a.ah(+u,this.minZoom+ir(0,f),this.maxZoom);return{center:new a.S(n.lng,f),zoom:g}}calculateCenterFromCameraLngLatAlt(n,u,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,f,g)}setLocationAtPoint(n,u){const f=qr(this.unprojectScreenPoint(u)),g=qr(n),b=a.bp();a.bB(b);const S=a.bp();a.by(S,f,b,-this.center.lng*Math.PI/180),a.bx(S,S,b,this.center.lat*Math.PI/180);const $=g[0]*g[0]+g[2]*g[2],M=S[0]*S[0];if($<M)return;const z=Math.sqrt($-M),F=-z,j=a.bC(g[0],g[2],S[0],z),B=a.bC(g[0],g[2],S[0],F),V=a.bp();a.by(V,g,b,-j);const W=a.bC(V[1],V[2],S[1],S[2]),te=a.bp();a.by(te,g,b,-B);const ee=a.bC(te[1],te[2],S[1],S[2]),re=.5*Math.PI,se=W>=-re&&W<=re,ce=ee>=-re&&ee<=re;let oe,he;if(se&&ce){const Oe=this.center.lng*Math.PI/180,Ee=this.center.lat*Math.PI/180;a.bD(j,Oe)+a.bD(W,Ee)<a.bD(B,Oe)+a.bD(ee,Ee)?(oe=j,he=W):(oe=B,he=ee)}else if(se)oe=j,he=W;else{if(!ce)return;oe=B,he=ee}const me=oe/Math.PI*180,ae=he/Math.PI*180,we=this.center.lat;this.setCenter(new a.S(me,a.ah(ae,-90,90))),this.setZoom(this.zoom+ir(we,this.center.lat))}locationToScreenPoint(n,u){const f=qr(n);if(u){const g=u.getElevationForLngLatZoom(n,this._helper._tileZoom);a.aR(f,f,1+g/a.bu)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(n){const u=a.bv();return a.aw(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new a.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(n,u){if(u){const f=u.pointCoordinate(n);if(f)return f}return a.a1.fromLngLat(this.unprojectScreenPoint(n))}screenPointToLocation(n,u){var f;return(f=this.screenPointToMercatorCoordinate(n,u))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(n,u){const f=this._cameraPosition,g=this.getRayDirectionFromPixel(n);return!!this.rayPlanetIntersection(f,g)}getRayDirectionFromPixel(n){const u=a.bv();u[0]=n.x/this.width*2-1,u[1]=-1*(n.y/this.height*2-1),u[2]=1,u[3]=1,a.aw(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const f=a.bp();f[0]=u[0]-this._cameraPosition[0],f[1]=u[1]-this._cameraPosition[1],f[2]=u[2]-this._cameraPosition[2];const g=a.bp();return a.aV(g,f),g}isSurfacePointVisible(n){const u=this._cachedClippingPlane;return u[0]*n[0]+u[1]*n[1]+u[2]*n[2]+u[3]>=0}isSurfacePointOnScreen(n){if(!this.isSurfacePointVisible(n))return!1;const u=a.bv();return a.aw(u,[...n,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(n,u){const f=a.aX(n,u),g=a.bp(),b=a.bp();a.aR(b,u,f),a.aU(g,n,b);const S=1-a.aX(g,g);if(S<0)return null;const $=a.aX(n,n)-1,M=-f+(f<0?1:-1)*Math.sqrt(S),z=$/M,F=M;return{tMin:Math.min(z,F),tMax:Math.max(z,F)}}unprojectScreenPoint(n){const u=this._cameraPosition,f=this.getRayDirectionFromPixel(n),g=this.rayPlanetIntersection(u,f);if(g){const F=a.bp();a.aS(F,u,[f[0]*g.tMin,f[1]*g.tMin,f[2]*g.tMin]);const j=a.bp();return a.aV(j,F),Ku(j)}const b=this._cachedClippingPlane,S=b[0]*f[0]+b[1]*f[1]+b[2]*f[2],$=-a.b1(b,u)/S,M=a.bp();if($>0)a.aS(M,u,[f[0]*$,f[1]*$,f[2]*$]);else{const F=a.bp();a.aS(F,u,[2*f[0],2*f[1],2*f[2]]);const j=a.b1(this._cachedClippingPlane,F);a.aU(M,F,[this._cachedClippingPlane[0]*j,this._cachedClippingPlane[1]*j,this._cachedClippingPlane[2]*j])}const z=(function(F){const j=a.bp();return j[0]=F[0]*-F[3],j[1]=F[1]*-F[3],j[2]=F[2]*-F[3],{center:j,radius:Math.sqrt(1-F[3]*F[3])}})(b);return Ku((function(F,j,B){const V=a.bp();a.aU(V,B,F);const W=a.bp();return a.bq(W,F,V,j/a.a$(V)),W})(z.center,z.radius,M))}getMatrixForModel(n,u){const f=a.S.convert(n),g=1/a.bu,b=a.b9();return a.bz(b,b,f.lng/180*Math.PI),a.b7(b,b,-f.lat/180*Math.PI),a.M(b,b,[0,0,1+u/a.bu]),a.b7(b,b,.5*Math.PI),a.N(b,b,[g,g,g]),b}getProjectionDataForCustomLayer(n=!0){const u=this.getProjectionData({overscaledTileID:new a.Z(0,0,0,0,0),applyGlobeMatrix:n});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(n){}}class rh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(n){this._helper.setMinZoom(n)}setMaxZoom(n){this._helper.setMaxZoom(n)}setMinPitch(n){this._helper.setMinPitch(n)}setMaxPitch(n){this._helper.setMaxPitch(n)}setRenderWorldCopies(n){this._helper.setRenderWorldCopies(n)}setBearing(n){this._helper.setBearing(n)}setPitch(n){this._helper.setPitch(n)}setRoll(n){this._helper.setRoll(n)}setFov(n){this._helper.setFov(n)}setZoom(n){this._helper.setZoom(n)}setCenter(n){this._helper.setCenter(n)}setElevation(n){this._helper.setElevation(n)}setMinElevationForCurrentTile(n){this._helper.setMinElevationForCurrentTile(n)}setPadding(n){this._helper.setPadding(n)}interpolatePadding(n,u,f){return this._helper.interpolatePadding(n,u,f)}isPaddingEqual(n){return this._helper.isPaddingEqual(n)}resize(n,u,f=!0){this._helper.resize(n,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(n){this._helper.setMaxBounds(n)}overrideNearFarZ(n,u){this._helper.overrideNearFarZ(n,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(n){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),n)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(n,u){this._globeness=n,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Sn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(n,u)=>this.getConstrained(n,u)}),this._globeness=1,this._mercatorTransform=new Mi,this._verticalPerspectiveTransform=new ih}clone(){const n=new rh;return n._globeness=this._globeness,n._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,n.apply(this),n}apply(n){this._helper.apply(n),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(n){const u=this._mercatorTransform.getProjectionData(n),f=this._verticalPerspectiveTransform.getProjectionData(n);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:u.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:n.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(n){return this.currentTransform.isLocationOccluded(n)}transformLightDirection(n){return this.currentTransform.transformLightDirection(n)}getPixelScale(){return a.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(n,u,f){const g=this._mercatorTransform.getPitchedTextCorrection(n,u,f),b=this._verticalPerspectiveTransform.getPitchedTextCorrection(n,u,f);return a.bk(g,b,this._globeness)}projectTileCoordinates(n,u,f,g){return this.currentTransform.projectTileCoordinates(n,u,f,g)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(n){return this.currentTransform.calculateFogMatrix(n)}getVisibleUnwrappedCoordinates(n){return this.currentTransform.getVisibleUnwrappedCoordinates(n)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(n){this._mercatorTransform.recalculateZoomAndCenter(n),this._verticalPerspectiveTransform.recalculateZoomAndCenter(n)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(n,u){return this.currentTransform.lngLatToCameraDepth(n,u)}populateCache(n){this._mercatorTransform.populateCache(n),this._verticalPerspectiveTransform.populateCache(n)}getBounds(){return this.currentTransform.getBounds()}getConstrained(n,u){return this.currentTransform.getConstrained(n,u)}calculateCenterFromCameraLngLatAlt(n,u,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(n,u,f,g)}setLocationAtPoint(n,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(n,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(n,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(n,u){return this.currentTransform.locationToScreenPoint(n,u)}screenPointToMercatorCoordinate(n,u){return this.currentTransform.screenPointToMercatorCoordinate(n,u)}screenPointToLocation(n,u){return this.currentTransform.screenPointToLocation(n,u)}isPointOnMapSurface(n,u){return this.currentTransform.isPointOnMapSurface(n,u)}getRayDirectionFromPixel(n){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(n)}getMatrixForModel(n,u){return this.currentTransform.getMatrixForModel(n,u)}getProjectionDataForCustomLayer(n=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(n);if(!this.isGlobeRendering)return u;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(n);return f.fallbackMatrix=u.mainMatrix,f}getFastPathSimpleProjectionMatrix(n){return this.currentTransform.getFastPathSimpleProjectionMatrix(n)}}class mn{get useGlobeControls(){return!0}handlePanInertia(n,u){const f=Cv(n,u);return Math.abs(f.lng-u.center.lng)>180&&(f.lng=u.center.lng+179.5*Math.sign(f.lng-u.center.lng)),{easingCenter:f,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(n,u){const f=n.around,g=u.screenPointToLocation(f);n.bearingDelta&&u.setBearing(u.bearing+n.bearingDelta),n.pitchDelta&&u.setPitch(u.pitch+n.pitchDelta),n.rollDelta&&u.setRoll(u.roll+n.rollDelta);const b=u.zoom;n.zoomDelta&&u.setZoom(u.zoom+n.zoomDelta);const S=u.zoom-b;if(S===0)return;const $=a.bA(u.center.lng,g.lng),M=$/(Math.abs($/180)+1),z=a.bA(u.center.lat,g.lat),F=u.getRayDirectionFromPixel(f),j=u.cameraPosition,B=-1*a.aX(j,F),V=a.bp();a.aS(V,j,[F[0]*B,F[1]*B,F[2]*B]);const W=a.aZ(V)-1,te=Math.exp(.5*-Math.max(W-.3,0)),ee=Oc(u.worldSize,u.center.lat)/Math.min(u.width,u.height),re=a.bn(ee,.9,.5,1,.25),se=(1-a.af(-S))*Math.min(te,re),ce=u.center.lat,oe=u.zoom,he=new a.S(u.center.lng+M*se,a.ah(u.center.lat+z*se,-a.ai,a.ai));u.setLocationAtPoint(g,f);const me=u.center,ae=a.bn(Math.abs($),45,85,0,1),we=a.bn(ee,.75,.35,0,1),Oe=Math.pow(Math.max(ae,we),.25),Ee=a.bA(me.lng,he.lng),$e=a.bA(me.lat,he.lat);u.setCenter(new a.S(me.lng+Ee*Oe,me.lat+$e*Oe).wrap()),u.setZoom(oe+ir(ce,u.center.lat))}handleMapControlsPan(n,u,f){if(!n.panDelta)return;const g=u.center.lat,b=u.zoom;u.setCenter(Cv(n.panDelta,u).wrap()),u.setZoom(b+ir(g,u.center.lat))}cameraForBoxAndBearing(n,u,f,g,b){const S=is(n,u,f,g,b),$=u.left/b.width*2-1,M=(b.width-u.right)/b.width*2-1,z=u.top/b.height*-2+1,F=(b.height-u.bottom)/b.height*-2+1,j=a.bA(f.getWest(),f.getEast())<0,B=j?f.getEast():f.getWest(),V=j?f.getWest():f.getEast(),W=Math.max(f.getNorth(),f.getSouth()),te=Math.min(f.getNorth(),f.getSouth()),ee=B+.5*a.bA(B,V),re=W+.5*a.bA(W,te),se=b.clone();se.setCenter(S.center),se.setBearing(S.bearing),se.setPitch(0),se.setRoll(0),se.setZoom(S.zoom);const ce=se.modelViewProjectionMatrix,oe=[qr(f.getNorthWest()),qr(f.getNorthEast()),qr(f.getSouthWest()),qr(f.getSouthEast()),qr(new a.S(V,re)),qr(new a.S(B,re)),qr(new a.S(ee,W)),qr(new a.S(ee,te))],he=qr(S.center);let me=Number.POSITIVE_INFINITY;for(const ae of oe)$<0&&(me=mn.getLesserNonNegativeNonNull(me,mn.solveVectorScale(ae,he,ce,"x",$))),M>0&&(me=mn.getLesserNonNegativeNonNull(me,mn.solveVectorScale(ae,he,ce,"x",M))),z>0&&(me=mn.getLesserNonNegativeNonNull(me,mn.solveVectorScale(ae,he,ce,"y",z))),F<0&&(me=mn.getLesserNonNegativeNonNull(me,mn.solveVectorScale(ae,he,ce,"y",F)));if(Number.isFinite(me)&&me!==0)return S.zoom=se.zoom+a.ak(me),S;Tv()}handleJumpToCenterZoom(n,u){const f=n.center.lat,g=n.getConstrained(u.center?a.S.convert(u.center):n.center,n.zoom).center;n.setCenter(g.wrap());const b=u.zoom!==void 0?+u.zoom:n.zoom+ir(f,g.lat);n.zoom!==b&&n.setZoom(b)}handleEaseTo(n,u){const f=n.zoom,g=n.center,b=n.padding,S={roll:n.roll,pitch:n.pitch,bearing:n.bearing},$={roll:u.roll===void 0?n.roll:u.roll,pitch:u.pitch===void 0?n.pitch:u.pitch,bearing:u.bearing===void 0?n.bearing:u.bearing},M=u.zoom!==void 0,z=!n.isPaddingEqual(u.padding);let F=!1;const j=u.center?a.S.convert(u.center):g,B=n.getConstrained(j,f).center;Nd(n,B);const V=n.clone();V.setCenter(B),V.setZoom(M?+u.zoom:f+ir(g.lat,j.lat)),V.setBearing(u.bearing);const W=new a.P(a.ah(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),a.ah(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));V.setLocationAtPoint(B,W);const te=(u.offset&&u.offsetAsPoint.mag())>0?V.center:B,ee=M?+u.zoom:f+ir(g.lat,te.lat),re=f+ir(g.lat,0),se=ee+ir(te.lat,0),ce=a.bA(g.lng,te.lng),oe=a.bA(g.lat,te.lat),he=a.af(se-re);return F=ee!==f,{easeFunc:me=>{if(a.be(S,$)||Cn({startEulerAngles:S,endEulerAngles:$,tr:n,k:me,useSlerp:S.roll!=$.roll}),z&&n.interpolatePadding(b,u.padding,me),u.around)a.w("Easing around a point is not supported under globe projection."),n.setLocationAtPoint(u.around,u.aroundPoint);else{const ae=se>re?Math.min(2,he):Math.max(.5,he),we=Math.pow(ae,1-me),Oe=Gm(g,ce,oe,me*we);n.setCenter(Oe.wrap())}if(F){const ae=a.C.number(re,se,me)+ir(0,n.center.lat);n.setZoom(ae)}},isZooming:F,elevationCenter:te}}handleFlyTo(n,u){const f=u.zoom!==void 0,g=n.center,b=n.zoom,S=n.padding,$=!n.isPaddingEqual(u.padding),M=n.getConstrained(a.S.convert(u.center||u.locationAtOffset),b).center,z=f?+u.zoom:n.zoom+ir(n.center.lat,M.lat),F=n.clone();F.setCenter(M),F.setZoom(z),F.setBearing(u.bearing);const j=new a.P(a.ah(n.centerPoint.x+u.offsetAsPoint.x,0,n.width),a.ah(n.centerPoint.y+u.offsetAsPoint.y,0,n.height));F.setLocationAtPoint(M,j);const B=F.center;Nd(n,B);const V=(function(oe,he,me){const ae=qr(he),we=qr(me),Oe=a.aX(ae,we),Ee=Math.acos(Oe),$e=Gd(oe);return Ee/(2*Math.PI)*$e})(n,g,B),W=b+ir(g.lat,0),te=z+ir(B.lat,0),ee=a.af(te-W);let re;if(typeof u.minZoom=="number"){const oe=+u.minZoom+ir(B.lat,0),he=Math.min(oe,W,te)+ir(0,B.lat),me=n.getConstrained(B,he).zoom+ir(B.lat,0);re=a.af(me-W)}const se=a.bA(g.lng,B.lng),ce=a.bA(g.lat,B.lat);return{easeFunc:(oe,he,me,ae)=>{const we=Gm(g,se,ce,me);$&&n.interpolatePadding(S,u.padding,oe);const Oe=oe===1?B:we;n.setCenter(Oe.wrap());const Ee=W+a.ak(he);n.setZoom(oe===1?z:Ee+ir(0,Oe.lat))},scaleOfZoom:ee,targetCenter:B,scaleOfMinZoom:re,pixelPathLength:V}}static solveVectorScale(n,u,f,g,b){const S=g==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],$=[f[3],f[7],f[11],f[15]],M=n[0]*S[0]+n[1]*S[1]+n[2]*S[2],z=n[0]*$[0]+n[1]*$[1]+n[2]*$[2],F=u[0]*S[0]+u[1]*S[1]+u[2]*S[2],j=u[0]*$[0]+u[1]*$[1]+u[2]*$[2];return F+b*z===M+b*j||$[3]*(M-F)+S[3]*(j-z)+M*j==F*z?null:(F+S[3]-b*j-b*$[3])/(F-M-b*j+b*z)}static getLesserNonNegativeNonNull(n,u){return u!==null&&u>=0&&u<n?u:n}}class Ev{constructor(n){this._globe=n,this._mercatorCameraHelper=new fn,this._verticalPerspectiveCameraHelper=new mn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(n,u){return this.currentHelper.handlePanInertia(n,u)}handleMapControlsRollPitchBearingZoom(n,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(n,u)}handleMapControlsPan(n,u,f){this.currentHelper.handleMapControlsPan(n,u,f)}cameraForBoxAndBearing(n,u,f,g,b){return this.currentHelper.cameraForBoxAndBearing(n,u,f,g,b)}handleJumpToCenterZoom(n,u){this.currentHelper.handleJumpToCenterZoom(n,u)}handleEaseTo(n,u){return this.currentHelper.handleEaseTo(n,u)}handleFlyTo(n,u){return this.currentHelper.handleFlyTo(n,u)}}const qd=(_,n)=>a.y(_,n&&n.filter((u=>u.identifier!=="source.canvas"))),i2=a.bE();class qm extends a.E{constructor(n,u={}){var f,g;super(),this._rtlPluginLoaded=()=>{for(const S in this.sourceCaches){const $=this.sourceCaches[S].getSource().type;$!=="vector"&&$!=="geojson"||this.sourceCaches[S].reload()}},this.map=n,this.dispatcher=new sn(es(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",((S,$)=>this.getGlyphs(S,$))),this.dispatcher.registerMessageHandler("GI",((S,$)=>this.getImages(S,$))),this.imageManager=new ft,this.imageManager.setEventedParent(this);const b=((f=n._container)===null||f===void 0?void 0:f.lang)||typeof document<"u"&&((g=document.documentElement)===null||g===void 0?void 0:g.lang)||void 0;this.glyphManager=new ge(n._requestManager,u.localIdeographFontFamily,b),this.lineAtlas=new Ye(256,512),this.crossTileSymbolIndex=new Dc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",a.bG()),Ra().on(El,this._rtlPluginLoaded),this.on("data",(S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const $=this.sourceCaches[S.sourceId];if(!$)return;const M=$.getSource();if(M&&M.vectorLayerIds)for(const z in this._layers){const F=this._layers[z];F.source===M.id&&this._validateLayer(F)}}))}setGlobalStateProperty(n,u){var f,g,b;this._checkLoaded();const S=u===null?(b=(g=(f=this.stylesheet.state)===null||f===void 0?void 0:f[n])===null||g===void 0?void 0:g.default)!==null&&b!==void 0?b:null:u;if(a.bH(S,this._globalState[n]))return this;this._globalState[n]=S,this._applyGlobalStateChanges([n])}getGlobalState(){return this._globalState}setGlobalState(n){this._checkLoaded();const u=[];for(const f in n)!a.bH(this._globalState[f],n[f].default)&&(u.push(f),this._globalState[f]=n[f].default);this._applyGlobalStateChanges(u)}_applyGlobalStateChanges(n){if(n.length===0)return;const u=new Set;for(const f in this._layers){const g=this._layers[f],b=g.getLayoutAffectingGlobalStateRefs(),S=g.getPaintAffectingGlobalStateRefs();for(const $ of n)if(b.has($)&&u.add(g.source),S.has($))for(const{name:M,value:z}of S.get($))this._updatePaintProperty(g,M,z)}for(const f in this.sourceCaches)u.has(f)&&(this._reloadSource(f),this._changed=!0)}loadURL(n,u={},f){this.fire(new a.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const g=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const b=this._loadStyleRequest;a.j(g,this._loadStyleRequest).then((S=>{this._loadStyleRequest=null,this._load(S.data,u,f)})).catch((S=>{this._loadStyleRequest=null,S&&!b.signal.aborted&&this.fire(new a.k(S))}))}loadJSON(n,u={},f){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,L.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(n,u,f)})).catch((()=>{}))}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load(i2,{validate:!1})}_load(n,u,f){var g,b;let S=u.transformStyle?u.transformStyle(f,n):n;if(!u.validate||!qd(this,a.z(S))){S=Object.assign({},S),this._loaded=!0,this.stylesheet=S;for(const $ in S.sources)this.addSource($,S.sources[$],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new Qe(this.stylesheet.light),this._setProjectionInternal(((g=this.stylesheet.projection)===null||g===void 0?void 0:g.type)||"mercator"),this.sky=new Et(this.stylesheet.sky),this.map.setTerrain((b=this.stylesheet.terrain)!==null&&b!==void 0?b:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){var n;const u=a.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",u),this._order=u.map((f=>f.id)),this._layers={},this.setGlobalState((n=this.stylesheet.state)!==null&&n!==void 0?n:null),this._serializedLayers=null;for(const f of u){const g=a.bJ(f);g.setEventedParent(this,{layer:{id:f.id}}),g.setGlobalState(this._globalState),this._layers[f.id]=g}}_loadSprite(n,u=!1,f=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(b,S,$,M){return a._(this,void 0,void 0,(function*(){const z=Ke(b),F=$>1?"@2x":"",j={},B={};for(const{id:V,url:W}of z){const te=S.transformRequest(qe(W,F,".json"),"SpriteJSON");j[V]=a.j(te,M);const ee=S.transformRequest(qe(W,F,".png"),"SpriteImage");B[V]=Ie.getImage(ee,M)}return yield Promise.all([...Object.values(j),...Object.values(B)]),(function(V,W){return a._(this,void 0,void 0,(function*(){const te={};for(const ee in V){te[ee]={};const re=L.getImageCanvasContext((yield W[ee]).data),se=(yield V[ee]).data;for(const ce in se){const{width:oe,height:he,x:me,y:ae,sdf:we,pixelRatio:Oe,stretchX:Ee,stretchY:$e,content:ze,textFitWidth:tt,textFitHeight:st}=se[ce];te[ee][ce]={data:null,pixelRatio:Oe,sdf:we,stretchX:Ee,stretchY:$e,content:ze,textFitWidth:tt,textFitHeight:st,spriteData:{width:oe,height:he,x:me,y:ae,context:re}}}}return te}))})(j,B)}))})(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((b=>{if(this._spriteRequest=null,b)for(const S in b){this._spritesImagesIds[S]=[];const $=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter((M=>!(M in b))):[];for(const M of $)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in b[S]){const z=S==="default"?M:`${S}:${M}`;this._spritesImagesIds[S].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,b[S][M],!1):this.imageManager.addImage(z,b[S][M]),u&&(this._changedImages[z]=!0)}}})).catch((b=>{this._spriteRequest=null,g=b,this.fire(new a.k(g))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),f&&f(g)}))}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(n){const u=this.sourceCaches[n.source];if(!u)return;const f=n.sourceLayer;if(!f)return;const g=u.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(f)===-1)&&this.fire(new a.k(new Error(`Source layer "${f}" does not exist on source "${g.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,u=!1){const f=this._serializedAllLayers();if(!n||n.length===0)return Object.values(u?a.bK(f):f);const g=[];for(const b of n)if(f[b]){const S=u?a.bK(f[b]):f[b];g.push(S)}return g}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const u=Object.keys(this._layers);for(const f of u){const g=this._layers[f];g.type!=="custom"&&(n[f]=g.serialize())}return n}hasTransitions(){var n,u,f;if(!((n=this.light)===null||n===void 0)&&n.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const g in this.sourceCaches)if(this.sourceCaches[g].hasTransition())return!0;for(const g in this._layers)if(this._layers[g].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const u=this._changed;if(u){const g=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(g.length||b.length)&&this._updateWorkerLayers(g,b);for(const S in this._updatedSources){const $=this._updatedSources[S];if($==="reload")this._reloadSource(S);else{if($!=="clear")throw new Error(`Invalid action ${$}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const f={};for(const g in this.sourceCaches){const b=this.sourceCaches[g];f[g]=b.used,b.used=!1}for(const g of this._order){const b=this._layers[g];b.recalculate(n,this._availableImages),!b.isHidden(n.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(const g in f){const b=this.sourceCaches[g];!!f[g]!=!!b.used&&b.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(n),this.sky.recalculate(n),this.projection.recalculate(n),this.z=n.zoom,u&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,u={}){var f;this._checkLoaded();const g=this.serialize();if(n=u.transformStyle?u.transformStyle(g,n):n,((f=u.validate)===null||f===void 0||f)&&qd(this,a.z(n)))return!1;(n=a.bK(n)).layers=a.bI(n.layers);const b=a.bL(g,n),S=this._getOperationsToPerform(b);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const $ of S.operations)$();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const u=[],f=[];for(const g of n)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push((()=>this.addLayer.apply(this,g.args)));break;case"removeLayer":u.push((()=>this.removeLayer.apply(this,g.args)));break;case"setPaintProperty":u.push((()=>this.setPaintProperty.apply(this,g.args)));break;case"setLayoutProperty":u.push((()=>this.setLayoutProperty.apply(this,g.args)));break;case"setFilter":u.push((()=>this.setFilter.apply(this,g.args)));break;case"addSource":u.push((()=>this.addSource.apply(this,g.args)));break;case"removeSource":u.push((()=>this.removeSource.apply(this,g.args)));break;case"setLayerZoomRange":u.push((()=>this.setLayerZoomRange.apply(this,g.args)));break;case"setLight":u.push((()=>this.setLight.apply(this,g.args)));break;case"setGeoJSONSourceData":u.push((()=>this.setGeoJSONSourceData.apply(this,g.args)));break;case"setGlyphs":u.push((()=>this.setGlyphs.apply(this,g.args)));break;case"setSprite":u.push((()=>this.setSprite.apply(this,g.args)));break;case"setTerrain":u.push((()=>this.map.setTerrain.apply(this,g.args)));break;case"setSky":u.push((()=>this.setSky.apply(this,g.args)));break;case"setProjection":this.setProjection.apply(this,g.args);break;case"setGlobalState":u.push((()=>this.setGlobalState.apply(this,g.args)));break;case"setTransition":u.push((()=>{}));break;default:f.push(g.command)}return{operations:u,unimplemented:f}}addImage(n,u){if(this.getImage(n))return this.fire(new a.k(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,u),this._afterImageUpdated(n)}updateImage(n,u){this.imageManager.updateImage(n,u)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new a.k(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,u,f={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.z.source,`sources.${n}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const g=this.sourceCaches[n]=new Jt(n,u,this.dispatcher);g.style=this,g.setEventedParent(this,(()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:n}))),g.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===n)return this.fire(new a.k(new Error(`Source "${n}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],u.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,u){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const f=this.sourceCaches[n].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,u,f={}){this._checkLoaded();const g=n.id;if(this.getLayer(g))return void this.fire(new a.k(new Error(`Layer "${g}" already exists on this map.`)));let b;if(n.type==="custom"){if(qd(this,a.bM(n)))return;b=a.bJ(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(g,n.source),n=a.bK(n),n=a.e(n,{source:g})),this._validate(a.z.layer,`layers.${g}`,n,{arrayIndex:-1},f))return;b=a.bJ(n),this._validateLayer(b),b.setEventedParent(this,{layer:{id:g}})}const S=u?this._order.indexOf(u):this._order.length;if(u&&S===-1)this.fire(new a.k(new Error(`Cannot add layer "${g}" before non-existing layer "${u}".`)));else{if(this._order.splice(S,0,g),this._layerOrderChanged=!0,this._layers[g]=b,this._removedLayers[g]&&b.source&&b.type!=="custom"){const $=this._removedLayers[g];delete this._removedLayers[g],$.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(n,u){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new a.k(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===u)return;const f=this._order.indexOf(n);this._order.splice(f,1);const g=u?this._order.indexOf(u):this._order.length;u&&g===-1?this.fire(new a.k(new Error(`Cannot move layer "${n}" before non-existing layer "${u}".`))):(this._order.splice(g,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const u=this._layers[n];if(!u)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${n}".`)));u.setEventedParent(null);const f=this._order.indexOf(n);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=u,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],u.onRemove&&u.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,u,f){this._checkLoaded();const g=this.getLayer(n);g?g.minzoom===u&&g.maxzoom===f||(u!=null&&(g.minzoom=u),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,u,f={}){this._checkLoaded();const g=this.getLayer(n);if(g){if(!a.bH(g.filter,u))return u==null?(g.setFilter(void 0),void this._updateLayer(g)):void(this._validate(a.z.filter,`layers.${g.id}.filter`,u,null,f)||(g.setFilter(a.bK(u)),this._updateLayer(g)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return a.bK(this.getLayer(n).filter)}setLayoutProperty(n,u,f,g={}){this._checkLoaded();const b=this.getLayer(n);b?a.bH(b.getLayoutProperty(u),f)||(b.setLayoutProperty(u,f,g),this._updateLayer(b)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,u){const f=this.getLayer(n);if(f)return f.getLayoutProperty(u);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,u,f,g={}){this._checkLoaded();const b=this.getLayer(n);b?a.bH(b.getPaintProperty(u),f)||this._updatePaintProperty(b,u,f,g):this.fire(new a.k(new Error(`Cannot style non-existing layer "${n}".`)))}_updatePaintProperty(n,u,f,g={}){n.setPaintProperty(u,f,g)&&this._updateLayer(n),this._changed=!0,this._updatedPaintProps[n.id]=!0,this._serializedLayers=null}getPaintProperty(n,u){return this.getLayer(n).getPaintProperty(u)}setFeatureState(n,u){this._checkLoaded();const f=n.source,g=n.sourceLayer,b=this.sourceCaches[f];if(b===void 0)return void this.fire(new a.k(new Error(`The source '${f}' does not exist in the map's style.`)));const S=b.getSource().type;S==="geojson"&&g?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||g?(n.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),b.setFeatureState(g,n.id,u)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,u){this._checkLoaded();const f=n.source,g=this.sourceCaches[f];if(g===void 0)return void this.fire(new a.k(new Error(`The source '${f}' does not exist in the map's style.`)));const b=g.getSource().type,S=b==="vector"?n.sourceLayer:void 0;b!=="vector"||S?u&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(S,n.id,u):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const u=n.source,f=n.sourceLayer,g=this.sourceCaches[u];if(g!==void 0)return g.getSource().type!=="vector"||f?(n.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),g.getFeatureState(f,n.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=a.bN(this.sourceCaches,(b=>b.serialize())),u=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,g=this.stylesheet;return a.bO({version:g.version,name:g.name,metadata:g.metadata,light:g.light,sky:g.sky,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,projection:g.projection,sources:n,layers:u,terrain:f},(b=>b!==void 0))}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const u=S=>this._layers[S].type==="fill-extrusion",f={},g=[];for(let S=this._order.length-1;S>=0;S--){const $=this._order[S];if(u($)){f[$]=S;for(const M of n){const z=M[$];if(z)for(const F of z)g.push(F)}}}g.sort(((S,$)=>$.intersectionZ-S.intersectionZ));const b=[];for(let S=this._order.length-1;S>=0;S--){const $=this._order[S];if(u($))for(let M=g.length-1;M>=0;M--){const z=g[M].feature;if(f[z.layer.id]<S)break;b.push(z),g.pop()}else for(const M of n){const z=M[$];if(z)for(const F of z)b.push(F.feature)}}return b}queryRenderedFeatures(n,u,f){u&&u.filter&&this._validate(a.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const g={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const z of u.layers){const F=this._layers[z];if(!F)return this.fire(new a.k(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];g[F.source]=!0}}const b=[];u.availableImages=this._availableImages;const S=this._serializedAllLayers(),$=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,M=Object.assign(Object.assign({},u),{layers:$});for(const z in this.sourceCaches)u.layers&&!g[z]||b.push(Ls(this.sourceCaches[z],this._layers,S,n,M,f,this.map.terrain?(F,j,B)=>this.map.terrain.getElevation(F,j,B):void 0));return this.placement&&b.push((function(z,F,j,B,V,W,te){const ee={},re=W.queryRenderedSymbols(B),se=[];for(const ce of Object.keys(re).map(Number))se.push(te[ce]);se.sort(Tc);for(const ce of se){const oe=ce.featureIndex.lookupSymbolFeatures(re[ce.bucketInstanceId],F,ce.bucketIndex,ce.sourceLayerIndex,V.filter,V.layers,V.availableImages,z);for(const he in oe){const me=ee[he]=ee[he]||[],ae=oe[he];ae.sort(((we,Oe)=>{const Ee=ce.featureSortOrder;if(Ee){const $e=Ee.indexOf(we.featureIndex);return Ee.indexOf(Oe.featureIndex)-$e}return Oe.featureIndex-we.featureIndex}));for(const we of ae)me.push(we)}}return(function(ce,oe,he){for(const me in ce)for(const ae of ce[me])Cc(ae,he[oe[me].source]);return ce})(ee,z,j)})(this._layers,S,this.sourceCaches,n,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(n,u){u&&u.filter&&this._validate(a.z.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[n];return f?(function(g,b){const S=g.getRenderableIds().map((z=>g.getTileByID(z))),$=[],M={};for(let z=0;z<S.length;z++){const F=S[z],j=F.tileID.canonical.key;M[j]||(M[j]=!0,F.querySourceFeatures($,b))}return $})(f,u):[]}getLight(){return this.light.getLight()}setLight(n,u={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const S in n)if(!a.bH(n[S],f[S])){g=!0;break}if(!g)return;const b={now:L.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,u),this.light.updateTransitions(b)}getProjection(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.projection}setProjection(n){if(this._checkLoaded(),this.projection){if(this.projection.name===n.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=n,this._setProjectionInternal(n.type)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,u={}){this._checkLoaded();const f=this.getSky();let g=!1;if(!n&&!f)return;if(n&&!f)g=!0;else if(!n&&f)g=!0;else for(const S in n)if(!a.bH(n[S],f[S])){g=!0;break}if(!g)return;const b={now:L.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,u),this.sky.updateTransitions(b)}_setProjectionInternal(n){const u=(function(f){if(Array.isArray(f)){const g=new Vd({type:f});return{projection:g,transform:new rh,cameraHelper:new Ev(g)}}switch(f){case"mercator":return{projection:new ei,transform:new Mi,cameraHelper:new fn};case"globe":{const g=new Vd({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:g,transform:new rh,cameraHelper:new Ev(g)}}case"vertical-perspective":return{projection:new Ju,transform:new ih,cameraHelper:new mn};default:return a.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new ei,transform:new Mi,cameraHelper:new fn}}})(n);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(n,u,f,g,b={}){return(!b||b.validate!==!1)&&qd(this,n.call(a.z,a.e({key:u,style:this.serialize(),value:f,styleSpec:a.v},g)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ra().off(El,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const u in this.sourceCaches)this.sourceCaches[u].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,u,f,g,b=!1){let S=!1,$=!1;const M={};for(const z of this._order){const F=this._layers[z];if(F.type!=="symbol")continue;if(!M[F.source]){const B=this.sourceCaches[F.source];M[F.source]=B.getRenderableIds(!0).map((V=>B.getTileByID(V))).sort(((V,W)=>W.tileID.overscaledZ-V.tileID.overscaledZ||(V.tileID.isLessThan(W.tileID)?-1:1)))}const j=this.crossTileSymbolIndex.addLayer(F,M[F.source],n.center.lng);S=S||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(L.now(),n.zoom))&&(this.pauseablePlacement=new Bm(n,this.map.terrain,this._order,b,u,f,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(L.now()),$=!0),S&&this.pauseablePlacement.placement.setStale()),$||S)for(const z of this._order){const F=this._layers[z];F.type==="symbol"&&this.placement.updateLayerOpacities(F,M[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(L.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,u){return a._(this,void 0,void 0,(function*(){const f=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,u.icons),f}))}getGlyphs(n,u){return a._(this,void 0,void 0,(function*(){const f=yield this.glyphManager.getGlyphs(u.stacks),g=this.sourceCaches[u.source];return g&&g.setDependencies(u.tileID.key,u.type,[""]),f}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,u={}){this._checkLoaded(),n&&this._validate(a.z.glyphs,"glyphs",n,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,u,f={},g){this._checkLoaded();const b=[{id:n,url:u}],S=[...Ke(this.stylesheet.sprite),...b];this._validate(a.z.sprite,"sprite",S,null,f)||(this.stylesheet.sprite=S,this._loadSprite(b,!0,g))}removeSprite(n){this._checkLoaded();const u=Ke(this.stylesheet.sprite);if(u.find((f=>f.id===n))){if(this._spritesImagesIds[n])for(const f of this._spritesImagesIds[n])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex((f=>f.id===n)),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return Ke(this.stylesheet.sprite)}setSprite(n,u={},f){this._checkLoaded(),n&&this._validate(a.z.sprite,"sprite",n,null,u)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,f):(this._unloadSprite(),f&&f(null)))}}var r2=a.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class n2{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,u,f,g,b,S,$,M,z){this.context=n;let F=this.boundPaintVertexBuffers.length!==g.length;for(let j=0;!F&&j<g.length;j++)this.boundPaintVertexBuffers[j]!==g[j]&&(F=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||F||this.boundIndexBuffer!==b||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==$||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==z?this.freshBind(u,f,g,b,S,$,M,z):(n.bindVertexArray.set(this.vao),$&&$.bind(),b&&b.dynamicDraw&&b.bind(),M&&M.bind(),z&&z.bind())}freshBind(n,u,f,g,b,S,$,M){const z=n.numAttributes,F=this.context,j=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=$,this.boundDynamicVertexBuffer3=M,u.enableAttributes(j,n);for(const B of f)B.enableAttributes(j,n);S&&S.enableAttributes(j,n),$&&$.enableAttributes(j,n),M&&M.enableAttributes(j,n),u.bind(),u.setVertexAttribPointers(j,n,b);for(const B of f)B.bind(),B.setVertexAttribPointers(j,n,b);S&&(S.bind(),S.setVertexAttribPointers(j,n,b)),g&&g.bind(),$&&($.bind(),$.setVertexAttribPointers(j,n,b)),M&&(M.bind(),M.setVertexAttribPointers(j,n,b)),F.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Hd=(_,n,u,f,g)=>({u_texture:0,u_ele_delta:_,u_fog_matrix:n,u_fog_color:u?u.properties.get("fog-color"):a.bf.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?0:u?u.calculateFogBlendOpacity(f):0,u_horizon_color:u?u.properties.get("horizon-color"):a.bf.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:g?1:0}),Hm={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Dl(_){const n=[];for(let u=0;u<_.length;u++){if(_[u]===null)continue;const f=_[u].split(" ");n.push(f.pop())}return n}class Zm{constructor(n,u,f,g,b,S,$,M,z=[]){const F=n.gl;this.program=F.createProgram();const j=Dl(u.staticAttributes),B=f?f.getBinderAttributes():[],V=j.concat(B),W=Ns.prelude.staticUniforms?Dl(Ns.prelude.staticUniforms):[],te=$.staticUniforms?Dl($.staticUniforms):[],ee=u.staticUniforms?Dl(u.staticUniforms):[],re=f?f.getBinderUniforms():[],se=W.concat(te).concat(ee).concat(re),ce=[];for(const Ee of se)ce.indexOf(Ee)<0&&ce.push(Ee);const oe=f?f.defines():[];Co(F)&&oe.unshift("#version 300 es"),b&&oe.push("#define OVERDRAW_INSPECTOR;"),S&&oe.push("#define TERRAIN3D;"),M&&oe.push(M),z&&oe.push(...z);let he=oe.concat(Ns.prelude.fragmentSource,$.fragmentSource,u.fragmentSource).join(`
`),me=oe.concat(Ns.prelude.vertexSource,$.vertexSource,u.vertexSource).join(`
`);Co(F)||(he=(function(Ee){return Ee.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(he),me=(function(Ee){return Ee.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(me));const ae=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(ae,he),F.compileShader(ae),!F.getShaderParameter(ae,F.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${F.getShaderInfoLog(ae)}`);F.attachShader(this.program,ae);const we=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(we,me),F.compileShader(we),!F.getShaderParameter(we,F.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${F.getShaderInfoLog(we)}`);F.attachShader(this.program,we),this.attributes={};const Oe={};this.numAttributes=V.length;for(let Ee=0;Ee<this.numAttributes;Ee++)V[Ee]&&(F.bindAttribLocation(this.program,Ee,V[Ee]),this.attributes[V[Ee]]=Ee);if(F.linkProgram(this.program),!F.getProgramParameter(this.program,F.LINK_STATUS))throw new Error(`Program failed to link: ${F.getProgramInfoLog(this.program)}`);F.deleteShader(we),F.deleteShader(ae);for(let Ee=0;Ee<ce.length;Ee++){const $e=ce[Ee];if($e&&!Oe[$e]){const ze=F.getUniformLocation(this.program,$e);ze&&(Oe[$e]=ze)}}this.fixedUniforms=g(n,Oe),this.terrainUniforms=((Ee,$e)=>({u_depth:new a.bP(Ee,$e.u_depth),u_terrain:new a.bP(Ee,$e.u_terrain),u_terrain_dim:new a.bg(Ee,$e.u_terrain_dim),u_terrain_matrix:new a.bR(Ee,$e.u_terrain_matrix),u_terrain_unpack:new a.bS(Ee,$e.u_terrain_unpack),u_terrain_exaggeration:new a.bg(Ee,$e.u_terrain_exaggeration)}))(n,Oe),this.projectionUniforms=((Ee,$e)=>({u_projection_matrix:new a.bR(Ee,$e.u_projection_matrix),u_projection_tile_mercator_coords:new a.bS(Ee,$e.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bS(Ee,$e.u_projection_clipping_plane),u_projection_transition:new a.bg(Ee,$e.u_projection_transition),u_projection_fallback_matrix:new a.bR(Ee,$e.u_projection_fallback_matrix)}))(n,Oe),this.binderUniforms=f?f.getUniforms(n,Oe):[]}draw(n,u,f,g,b,S,$,M,z,F,j,B,V,W,te,ee,re,se,ce){const oe=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(f),n.setStencilMode(g),n.setColorMode(b),n.setCullFace(S),M){n.activeTexture.set(oe.TEXTURE2),oe.bindTexture(oe.TEXTURE_2D,M.depthTexture),n.activeTexture.set(oe.TEXTURE3),oe.bindTexture(oe.TEXTURE_2D,M.texture);for(const me in this.terrainUniforms)this.terrainUniforms[me].set(M[me])}if(z)for(const me in z)this.projectionUniforms[Hm[me]].set(z[me]);if($)for(const me in this.fixedUniforms)this.fixedUniforms[me].set($[me]);ee&&ee.setUniforms(n,this.binderUniforms,W,{zoom:te});let he=0;switch(u){case oe.LINES:he=2;break;case oe.TRIANGLES:he=3;break;case oe.LINE_STRIP:he=1}for(const me of V.get()){const ae=me.vaos||(me.vaos={});(ae[F]||(ae[F]=new n2)).bind(n,this,j,ee?ee.getPaintVertexBuffers():[],B,me.vertexOffset,re,se,ce),oe.drawElements(u,me.primitiveLength*he,oe.UNSIGNED_SHORT,me.primitiveOffset*he*2)}}}function Zd(_,n,u){const f=1/a.aC(u,1,n.transform.tileZoom),g=Math.pow(2,u.tileID.overscaledZ),b=u.tileSize*Math.pow(2,n.transform.tileZoom)/g,S=b*(u.tileID.canonical.x+u.tileID.wrap*g),$=b*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[S>>16,$>>16],u_pixel_coord_lower:[65535&S,65535&$]}}const js=(_,n,u,f)=>{const g=_.style.light,b=g.properties.get("position"),S=[b.x,b.y,b.z],$=a.bV();g.properties.get("anchor")==="viewport"&&a.bW($,_.transform.bearingInRadians),a.bX(S,S,$);const M=_.transform.transformLightDirection(S),z=g.properties.get("color");return{u_lightpos:S,u_lightpos_globe:M,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[z.r,z.g,z.b],u_vertical_gradient:+n,u_opacity:u,u_fill_translate:f}},s2=(_,n,u,f,g,b,S)=>a.e(js(_,n,u,f),Zd(b,_,S),{u_height_factor:-Math.pow(2,g.overscaledZ)/S.tileSize/8}),Wd=(_,n,u,f)=>a.e(Zd(n,_,u),{u_fill_translate:f}),nh=(_,n)=>({u_world:_,u_fill_translate:n}),sh=(_,n,u,f,g)=>a.e(Wd(_,n,u,g),{u_world:f}),o2=(_,n,u,f,g)=>{const b=_.transform;let S,$,M=0;if(u.paint.get("circle-pitch-alignment")==="map"){const z=a.aC(n,1,b.zoom);S=!0,$=[z,z],M=z/(a.$*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*g}else S=!1,$=b.pixelsToGLUnits;return{u_camera_to_center_distance:b.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:$,u_globe_extrude_scale:M,u_translate:f}},Yd=_=>({u_pixel_extrude_scale:[1/_.width,1/_.height]}),a2=_=>({u_viewport_size:[_.width,_.height]}),zl=(_,n=1)=>({u_color:_,u_overlay:0,u_overlay_scale:n}),Iv=(_,n,u,f)=>{const g=a.aC(_,1,n)/(a.$*Math.pow(2,_.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:a.aC(_,1,n),u_intensity:u,u_globe_extrude_scale:g}},Wm=(_,n,u,f)=>{const g=a.L();a.bY(g,0,_.width,_.height,0,0,1);const b=_.context.gl;return{u_matrix:g,u_world:[b.drawingBufferWidth,b.drawingBufferHeight],u_image:u,u_color_ramp:f,u_opacity:n.paint.get("heatmap-opacity")}},l2=(_,n,u)=>{const f=u.paint.get("hillshade-accent-color");let g;switch(u.paint.get("hillshade-method")){case"basic":g=4;break;case"combined":g=1;break;case"igor":g=2;break;case"multidirectional":g=3;break;default:g=0}const b=u.getIlluminationProperties();for(let S=0;S<b.directionRadians.length;S++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(b.directionRadians[S]+=_.transform.bearingInRadians);return{u_image:0,u_latrange:Ym(0,n.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:b.altitudeRadians,u_azimuths:b.directionRadians,u_accent:f,u_method:g,u_highlights:b.highlightColor,u_shadows:b.shadowColor}},$v=(_,n)=>{const u=n.stride,f=a.L();return a.bY(f,0,a.$,-a.$,0,0,1),a.M(f,f,[0,-a.$,0]),{u_matrix:f,u_image:1,u_dimension:[u,u],u_zoom:_.overscaledZ,u_unpack:n.getUnpackVector()}};function Ym(_,n){const u=Math.pow(2,n.canonical.z),f=n.canonical.y;return[new a.a1(0,f/u).toLngLat().lat,new a.a1(0,(f+1)/u).toLngLat().lat]}const Pv=(_,n,u=0)=>({u_image:0,u_unpack:n.getUnpackVector(),u_dimension:[n.stride,n.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:_.paint.get("color-relief-opacity")}),Xd=(_,n,u,f)=>{const g=_.transform;return{u_translation:Jm(_,n,u),u_ratio:f/a.aC(n,1,g.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Mv=(_,n,u,f,g)=>a.e(Xd(_,n,u,f),{u_image:0,u_image_height:g}),kv=(_,n,u,f,g)=>{const b=_.transform,S=Xm(n,b);return{u_translation:Jm(_,n,u),u_texsize:n.imageAtlasTexture.size,u_ratio:f/a.aC(n,1,b.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[S,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},Ol=(_,n,u,f,g,b)=>{const S=_.lineAtlas,$=Xm(n,_.transform),M=u.layout.get("line-cap")==="round",z=S.getDash(g.from,M),F=S.getDash(g.to,M),j=z.width*b.fromScale,B=F.width*b.toScale;return a.e(Xd(_,n,u,f),{u_patternscale_a:[$/j,-z.height/2],u_patternscale_b:[$/B,-F.height/2],u_sdfgamma:S.width/(256*Math.min(j,B)*_.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:F.y,u_mix:b.t})};function Xm(_,n){return 1/a.aC(_,1,n.tileZoom)}function Jm(_,n,u){return a.aD(_.transform,n,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const oh=(_,n,u,f,g)=>{return{u_tl_parent:_,u_scale_parent:n,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(S=f.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(b=f.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:c2(f.paint.get("raster-hue-rotate")),u_coords_top:[g[0].x,g[0].y,g[1].x,g[1].y],u_coords_bottom:[g[3].x,g[3].y,g[2].x,g[2].y]};var b,S};function c2(_){_*=Math.PI/180;const n=Math.sin(_),u=Math.cos(_);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const ah=(_,n,u,f,g,b,S,$,M,z,F,j,B)=>{const V=S.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:V.cameraToCenterDistance,u_pitch:V.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:V.width/V.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:$,u_coord_matrix:M,u_is_text:+F,u_pitch_with_map:+f,u_is_along_line:g,u_is_variable_anchor:b,u_texsize:j,u_texture:0,u_translation:z,u_pitched_scale:B}},Av=(_,n,u,f,g,b,S,$,M,z,F,j,B,V)=>{const W=S.transform;return a.e(ah(_,n,u,f,g,b,S,$,M,z,F,j,V),{u_gamma_scale:f?Math.cos(W.pitch*Math.PI/180)*W.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},u2=(_,n,u,f,g,b,S,$,M,z,F,j,B)=>a.e(Av(_,n,u,f,g,b,S,$,M,z,!0,F,0,B),{u_texsize_icon:j,u_texture_icon:1}),Dv=(_,n)=>({u_opacity:_,u_color:n}),zv=(_,n,u,f,g)=>a.e((function(b,S,$,M){const z=$.imageManager.getPattern(b.from.toString()),F=$.imageManager.getPattern(b.to.toString()),{width:j,height:B}=$.imageManager.getPixelSize(),V=Math.pow(2,M.tileID.overscaledZ),W=M.tileSize*Math.pow(2,$.transform.tileZoom)/V,te=W*(M.tileID.canonical.x+M.tileID.wrap*V),ee=W*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:z.tl,u_pattern_br_a:z.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[j,B],u_mix:S.t,u_pattern_size_a:z.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/a.aC(M,1,$.transform.tileZoom),u_pixel_coord_upper:[te>>16,ee>>16],u_pixel_coord_lower:[65535&te,65535&ee]}})(u,g,n,f),{u_opacity:_}),Km=(_,n)=>{},Qm={fillExtrusion:(_,n)=>({u_lightpos:new a.bT(_,n.u_lightpos),u_lightpos_globe:new a.bT(_,n.u_lightpos_globe),u_lightintensity:new a.bg(_,n.u_lightintensity),u_lightcolor:new a.bT(_,n.u_lightcolor),u_vertical_gradient:new a.bg(_,n.u_vertical_gradient),u_opacity:new a.bg(_,n.u_opacity),u_fill_translate:new a.bU(_,n.u_fill_translate)}),fillExtrusionPattern:(_,n)=>({u_lightpos:new a.bT(_,n.u_lightpos),u_lightpos_globe:new a.bT(_,n.u_lightpos_globe),u_lightintensity:new a.bg(_,n.u_lightintensity),u_lightcolor:new a.bT(_,n.u_lightcolor),u_vertical_gradient:new a.bg(_,n.u_vertical_gradient),u_height_factor:new a.bg(_,n.u_height_factor),u_opacity:new a.bg(_,n.u_opacity),u_fill_translate:new a.bU(_,n.u_fill_translate),u_image:new a.bP(_,n.u_image),u_texsize:new a.bU(_,n.u_texsize),u_pixel_coord_upper:new a.bU(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(_,n.u_pixel_coord_lower),u_scale:new a.bT(_,n.u_scale),u_fade:new a.bg(_,n.u_fade)}),fill:(_,n)=>({u_fill_translate:new a.bU(_,n.u_fill_translate)}),fillPattern:(_,n)=>({u_image:new a.bP(_,n.u_image),u_texsize:new a.bU(_,n.u_texsize),u_pixel_coord_upper:new a.bU(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(_,n.u_pixel_coord_lower),u_scale:new a.bT(_,n.u_scale),u_fade:new a.bg(_,n.u_fade),u_fill_translate:new a.bU(_,n.u_fill_translate)}),fillOutline:(_,n)=>({u_world:new a.bU(_,n.u_world),u_fill_translate:new a.bU(_,n.u_fill_translate)}),fillOutlinePattern:(_,n)=>({u_world:new a.bU(_,n.u_world),u_image:new a.bP(_,n.u_image),u_texsize:new a.bU(_,n.u_texsize),u_pixel_coord_upper:new a.bU(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(_,n.u_pixel_coord_lower),u_scale:new a.bT(_,n.u_scale),u_fade:new a.bg(_,n.u_fade),u_fill_translate:new a.bU(_,n.u_fill_translate)}),circle:(_,n)=>({u_camera_to_center_distance:new a.bg(_,n.u_camera_to_center_distance),u_scale_with_map:new a.bP(_,n.u_scale_with_map),u_pitch_with_map:new a.bP(_,n.u_pitch_with_map),u_extrude_scale:new a.bU(_,n.u_extrude_scale),u_device_pixel_ratio:new a.bg(_,n.u_device_pixel_ratio),u_globe_extrude_scale:new a.bg(_,n.u_globe_extrude_scale),u_translate:new a.bU(_,n.u_translate)}),collisionBox:(_,n)=>({u_pixel_extrude_scale:new a.bU(_,n.u_pixel_extrude_scale)}),collisionCircle:(_,n)=>({u_viewport_size:new a.bU(_,n.u_viewport_size)}),debug:(_,n)=>({u_color:new a.bQ(_,n.u_color),u_overlay:new a.bP(_,n.u_overlay),u_overlay_scale:new a.bg(_,n.u_overlay_scale)}),depth:Km,clippingMask:Km,heatmap:(_,n)=>({u_extrude_scale:new a.bg(_,n.u_extrude_scale),u_intensity:new a.bg(_,n.u_intensity),u_globe_extrude_scale:new a.bg(_,n.u_globe_extrude_scale)}),heatmapTexture:(_,n)=>({u_matrix:new a.bR(_,n.u_matrix),u_world:new a.bU(_,n.u_world),u_image:new a.bP(_,n.u_image),u_color_ramp:new a.bP(_,n.u_color_ramp),u_opacity:new a.bg(_,n.u_opacity)}),hillshade:(_,n)=>({u_image:new a.bP(_,n.u_image),u_latrange:new a.bU(_,n.u_latrange),u_exaggeration:new a.bg(_,n.u_exaggeration),u_altitudes:new a.b_(_,n.u_altitudes),u_azimuths:new a.b_(_,n.u_azimuths),u_accent:new a.bQ(_,n.u_accent),u_method:new a.bP(_,n.u_method),u_shadows:new a.bZ(_,n.u_shadows),u_highlights:new a.bZ(_,n.u_highlights)}),hillshadePrepare:(_,n)=>({u_matrix:new a.bR(_,n.u_matrix),u_image:new a.bP(_,n.u_image),u_dimension:new a.bU(_,n.u_dimension),u_zoom:new a.bg(_,n.u_zoom),u_unpack:new a.bS(_,n.u_unpack)}),colorRelief:(_,n)=>({u_image:new a.bP(_,n.u_image),u_unpack:new a.bS(_,n.u_unpack),u_dimension:new a.bU(_,n.u_dimension),u_elevation_stops:new a.bP(_,n.u_elevation_stops),u_color_stops:new a.bP(_,n.u_color_stops),u_color_ramp_size:new a.bP(_,n.u_color_ramp_size),u_opacity:new a.bg(_,n.u_opacity)}),line:(_,n)=>({u_translation:new a.bU(_,n.u_translation),u_ratio:new a.bg(_,n.u_ratio),u_device_pixel_ratio:new a.bg(_,n.u_device_pixel_ratio),u_units_to_pixels:new a.bU(_,n.u_units_to_pixels)}),lineGradient:(_,n)=>({u_translation:new a.bU(_,n.u_translation),u_ratio:new a.bg(_,n.u_ratio),u_device_pixel_ratio:new a.bg(_,n.u_device_pixel_ratio),u_units_to_pixels:new a.bU(_,n.u_units_to_pixels),u_image:new a.bP(_,n.u_image),u_image_height:new a.bg(_,n.u_image_height)}),linePattern:(_,n)=>({u_translation:new a.bU(_,n.u_translation),u_texsize:new a.bU(_,n.u_texsize),u_ratio:new a.bg(_,n.u_ratio),u_device_pixel_ratio:new a.bg(_,n.u_device_pixel_ratio),u_image:new a.bP(_,n.u_image),u_units_to_pixels:new a.bU(_,n.u_units_to_pixels),u_scale:new a.bT(_,n.u_scale),u_fade:new a.bg(_,n.u_fade)}),lineSDF:(_,n)=>({u_translation:new a.bU(_,n.u_translation),u_ratio:new a.bg(_,n.u_ratio),u_device_pixel_ratio:new a.bg(_,n.u_device_pixel_ratio),u_units_to_pixels:new a.bU(_,n.u_units_to_pixels),u_patternscale_a:new a.bU(_,n.u_patternscale_a),u_patternscale_b:new a.bU(_,n.u_patternscale_b),u_sdfgamma:new a.bg(_,n.u_sdfgamma),u_image:new a.bP(_,n.u_image),u_tex_y_a:new a.bg(_,n.u_tex_y_a),u_tex_y_b:new a.bg(_,n.u_tex_y_b),u_mix:new a.bg(_,n.u_mix)}),raster:(_,n)=>({u_tl_parent:new a.bU(_,n.u_tl_parent),u_scale_parent:new a.bg(_,n.u_scale_parent),u_buffer_scale:new a.bg(_,n.u_buffer_scale),u_fade_t:new a.bg(_,n.u_fade_t),u_opacity:new a.bg(_,n.u_opacity),u_image0:new a.bP(_,n.u_image0),u_image1:new a.bP(_,n.u_image1),u_brightness_low:new a.bg(_,n.u_brightness_low),u_brightness_high:new a.bg(_,n.u_brightness_high),u_saturation_factor:new a.bg(_,n.u_saturation_factor),u_contrast_factor:new a.bg(_,n.u_contrast_factor),u_spin_weights:new a.bT(_,n.u_spin_weights),u_coords_top:new a.bS(_,n.u_coords_top),u_coords_bottom:new a.bS(_,n.u_coords_bottom)}),symbolIcon:(_,n)=>({u_is_size_zoom_constant:new a.bP(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(_,n.u_is_size_feature_constant),u_size_t:new a.bg(_,n.u_size_t),u_size:new a.bg(_,n.u_size),u_camera_to_center_distance:new a.bg(_,n.u_camera_to_center_distance),u_pitch:new a.bg(_,n.u_pitch),u_rotate_symbol:new a.bP(_,n.u_rotate_symbol),u_aspect_ratio:new a.bg(_,n.u_aspect_ratio),u_fade_change:new a.bg(_,n.u_fade_change),u_label_plane_matrix:new a.bR(_,n.u_label_plane_matrix),u_coord_matrix:new a.bR(_,n.u_coord_matrix),u_is_text:new a.bP(_,n.u_is_text),u_pitch_with_map:new a.bP(_,n.u_pitch_with_map),u_is_along_line:new a.bP(_,n.u_is_along_line),u_is_variable_anchor:new a.bP(_,n.u_is_variable_anchor),u_texsize:new a.bU(_,n.u_texsize),u_texture:new a.bP(_,n.u_texture),u_translation:new a.bU(_,n.u_translation),u_pitched_scale:new a.bg(_,n.u_pitched_scale)}),symbolSDF:(_,n)=>({u_is_size_zoom_constant:new a.bP(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(_,n.u_is_size_feature_constant),u_size_t:new a.bg(_,n.u_size_t),u_size:new a.bg(_,n.u_size),u_camera_to_center_distance:new a.bg(_,n.u_camera_to_center_distance),u_pitch:new a.bg(_,n.u_pitch),u_rotate_symbol:new a.bP(_,n.u_rotate_symbol),u_aspect_ratio:new a.bg(_,n.u_aspect_ratio),u_fade_change:new a.bg(_,n.u_fade_change),u_label_plane_matrix:new a.bR(_,n.u_label_plane_matrix),u_coord_matrix:new a.bR(_,n.u_coord_matrix),u_is_text:new a.bP(_,n.u_is_text),u_pitch_with_map:new a.bP(_,n.u_pitch_with_map),u_is_along_line:new a.bP(_,n.u_is_along_line),u_is_variable_anchor:new a.bP(_,n.u_is_variable_anchor),u_texsize:new a.bU(_,n.u_texsize),u_texture:new a.bP(_,n.u_texture),u_gamma_scale:new a.bg(_,n.u_gamma_scale),u_device_pixel_ratio:new a.bg(_,n.u_device_pixel_ratio),u_is_halo:new a.bP(_,n.u_is_halo),u_translation:new a.bU(_,n.u_translation),u_pitched_scale:new a.bg(_,n.u_pitched_scale)}),symbolTextAndIcon:(_,n)=>({u_is_size_zoom_constant:new a.bP(_,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bP(_,n.u_is_size_feature_constant),u_size_t:new a.bg(_,n.u_size_t),u_size:new a.bg(_,n.u_size),u_camera_to_center_distance:new a.bg(_,n.u_camera_to_center_distance),u_pitch:new a.bg(_,n.u_pitch),u_rotate_symbol:new a.bP(_,n.u_rotate_symbol),u_aspect_ratio:new a.bg(_,n.u_aspect_ratio),u_fade_change:new a.bg(_,n.u_fade_change),u_label_plane_matrix:new a.bR(_,n.u_label_plane_matrix),u_coord_matrix:new a.bR(_,n.u_coord_matrix),u_is_text:new a.bP(_,n.u_is_text),u_pitch_with_map:new a.bP(_,n.u_pitch_with_map),u_is_along_line:new a.bP(_,n.u_is_along_line),u_is_variable_anchor:new a.bP(_,n.u_is_variable_anchor),u_texsize:new a.bU(_,n.u_texsize),u_texsize_icon:new a.bU(_,n.u_texsize_icon),u_texture:new a.bP(_,n.u_texture),u_texture_icon:new a.bP(_,n.u_texture_icon),u_gamma_scale:new a.bg(_,n.u_gamma_scale),u_device_pixel_ratio:new a.bg(_,n.u_device_pixel_ratio),u_is_halo:new a.bP(_,n.u_is_halo),u_translation:new a.bU(_,n.u_translation),u_pitched_scale:new a.bg(_,n.u_pitched_scale)}),background:(_,n)=>({u_opacity:new a.bg(_,n.u_opacity),u_color:new a.bQ(_,n.u_color)}),backgroundPattern:(_,n)=>({u_opacity:new a.bg(_,n.u_opacity),u_image:new a.bP(_,n.u_image),u_pattern_tl_a:new a.bU(_,n.u_pattern_tl_a),u_pattern_br_a:new a.bU(_,n.u_pattern_br_a),u_pattern_tl_b:new a.bU(_,n.u_pattern_tl_b),u_pattern_br_b:new a.bU(_,n.u_pattern_br_b),u_texsize:new a.bU(_,n.u_texsize),u_mix:new a.bg(_,n.u_mix),u_pattern_size_a:new a.bU(_,n.u_pattern_size_a),u_pattern_size_b:new a.bU(_,n.u_pattern_size_b),u_scale_a:new a.bg(_,n.u_scale_a),u_scale_b:new a.bg(_,n.u_scale_b),u_pixel_coord_upper:new a.bU(_,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.bU(_,n.u_pixel_coord_lower),u_tile_units_to_pixels:new a.bg(_,n.u_tile_units_to_pixels)}),terrain:(_,n)=>({u_texture:new a.bP(_,n.u_texture),u_ele_delta:new a.bg(_,n.u_ele_delta),u_fog_matrix:new a.bR(_,n.u_fog_matrix),u_fog_color:new a.bQ(_,n.u_fog_color),u_fog_ground_blend:new a.bg(_,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.bg(_,n.u_fog_ground_blend_opacity),u_horizon_color:new a.bQ(_,n.u_horizon_color),u_horizon_fog_blend:new a.bg(_,n.u_horizon_fog_blend),u_is_globe_mode:new a.bg(_,n.u_is_globe_mode)}),terrainDepth:(_,n)=>({u_ele_delta:new a.bg(_,n.u_ele_delta)}),terrainCoords:(_,n)=>({u_texture:new a.bP(_,n.u_texture),u_terrain_coords_id:new a.bg(_,n.u_terrain_coords_id),u_ele_delta:new a.bg(_,n.u_ele_delta)}),projectionErrorMeasurement:(_,n)=>({u_input:new a.bg(_,n.u_input),u_output_expected:new a.bg(_,n.u_output_expected)}),atmosphere:(_,n)=>({u_sun_pos:new a.bT(_,n.u_sun_pos),u_atmosphere_blend:new a.bg(_,n.u_atmosphere_blend),u_globe_position:new a.bT(_,n.u_globe_position),u_globe_radius:new a.bg(_,n.u_globe_radius),u_inv_proj_matrix:new a.bR(_,n.u_inv_proj_matrix)}),sky:(_,n)=>({u_sky_color:new a.bQ(_,n.u_sky_color),u_horizon_color:new a.bQ(_,n.u_horizon_color),u_horizon:new a.bU(_,n.u_horizon),u_horizon_normal:new a.bU(_,n.u_horizon_normal),u_sky_horizon_blend:new a.bg(_,n.u_sky_horizon_blend),u_sky_blend:new a.bg(_,n.u_sky_blend)})};class Ov{constructor(n,u,f){this.context=n;const g=n.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Jd={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Xo{constructor(n,u,f,g){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=g,this.context=n;const b=n.gl;this.buffer=b.createBuffer(),n.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let f=0;f<this.attributes.length;f++){const g=u.attributes[this.attributes[f].name];g!==void 0&&n.enableVertexAttribArray(g)}}setVertexAttribPointers(n,u,f){for(let g=0;g<this.attributes.length;g++){const b=this.attributes[g],S=u.attributes[b.name];S!==void 0&&n.vertexAttribPointer(S,b.components,n[Jd[b.type]],!1,this.itemSize,b.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class pi{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class eg extends pi{getDefault(){return a.bf.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class tg extends pi{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Rv extends pi{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class ig extends pi{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Rl extends pi{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class rg extends pi{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class h2 extends pi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class d2 extends pi{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class p2 extends pi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class f2 extends pi{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Lv extends pi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class m2 extends pi{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Fv extends pi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class Kd extends pi{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Qd extends pi{getDefault(){return a.bf.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class ep extends pi{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class ng extends pi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class Ll extends pi{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class lh extends pi{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Lc extends pi{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class vs extends pi{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Nv extends pi{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Bv extends pi{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class sg extends pi{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Fl extends pi{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class tp extends pi{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ip extends pi{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ch extends pi{getDefault(){return null}set(n){var u;if(n===this.current&&!this.dirty)return;const f=this.gl;Co(f)?f.bindVertexArray(n):(u=f.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class rp extends pi{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class jv extends pi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Fc extends pi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Va extends pi{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class Uv extends Va{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class og extends Va{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class ii extends Va{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}const uh="Framebuffer is not complete";class g2{constructor(n,u,f,g,b){this.context=n,this.width=u,this.height=f;const S=n.gl,$=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new Uv(n,$),g)this.depthAttachment=b?new ii(n,$):new og(n,$);else if(b)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(uh)}destroy(){const n=this.context.gl,u=this.colorAttachment.get();if(u&&n.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&n.deleteRenderbuffer(f)}n.deleteFramebuffer(this.framebuffer)}}class Vv{constructor(n){var u,f;if(this.gl=n,this.clearColor=new eg(this),this.clearDepth=new tg(this),this.clearStencil=new Rv(this),this.colorMask=new ig(this),this.depthMask=new Rl(this),this.stencilMask=new rg(this),this.stencilFunc=new h2(this),this.stencilOp=new d2(this),this.stencilTest=new p2(this),this.depthRange=new f2(this),this.depthTest=new Lv(this),this.depthFunc=new m2(this),this.blend=new Fv(this),this.blendFunc=new Kd(this),this.blendColor=new Qd(this),this.blendEquation=new ep(this),this.cullFace=new ng(this),this.cullFaceSide=new Ll(this),this.frontFace=new lh(this),this.program=new Lc(this),this.activeTexture=new vs(this),this.viewport=new Nv(this),this.bindFramebuffer=new Bv(this),this.bindRenderbuffer=new sg(this),this.bindTexture=new Fl(this),this.bindVertexBuffer=new tp(this),this.bindElementBuffer=new ip(this),this.bindVertexArray=new ch(this),this.pixelStoreUnpack=new rp(this),this.pixelStoreUnpackPremultiplyAlpha=new jv(this),this.pixelStoreUnpackFlipY=new Fc(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Co(n)){this.HALF_FLOAT=n.HALF_FLOAT;const g=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=n.RGBA16F)!==null&&u!==void 0?u:g?.RGBA16F_EXT,this.RGB16F=(f=n.RGB16F)!==null&&f!==void 0?f:g?.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const g=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=g?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u){return new Ov(this,n,u)}createVertexBuffer(n,u,f){return new Xo(this,n,u,f)}createRenderbuffer(n,u,f){const g=this.gl,b=g.createRenderbuffer();return this.bindRenderbuffer.set(b),g.renderbufferStorage(g.RENDERBUFFER,n,u,f),this.bindRenderbuffer.set(null),b}createFramebuffer(n,u,f,g){return new g2(this,n,u,f,g)}clear({color:n,depth:u,stencil:f}){const g=this.gl;let b=0;n&&(b|=g.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(b|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),f!==void 0&&(b|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(b)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){a.bH(n.blendFunction,Ni.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Co(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var u;return Co(this.gl)?this.gl.deleteVertexArray(n):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}let Ga;function Gv(_,n,u,f,g){const b=_.context,S=_.transform,$=b.gl,M=_.useProgram("collisionBox"),z=[];let F=0,j=0;for(let re=0;re<f.length;re++){const se=f[re],ce=n.getTile(se).getBucket(u);if(!ce)continue;const oe=g?ce.textCollisionBox:ce.iconCollisionBox,he=ce.collisionCircleArray;he.length>0&&(z.push({circleArray:he,circleOffset:j,coord:se}),F+=he.length/4,j=F),oe&&M.draw(b,$.LINES,Bt.disabled,ci.disabled,_.colorModeForRenderPass(),kt.disabled,Yd(_.transform),_.style.map.terrain&&_.style.map.terrain.getTerrainData(se),S.getProjectionData({overscaledTileID:se,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,null,_.transform.zoom,null,null,oe.collisionVertexBuffer)}if(!g||!z.length)return;const B=_.useProgram("collisionCircle"),V=new a.b$;V.resize(4*F),V._trim();let W=0;for(const re of z)for(let se=0;se<re.circleArray.length/4;se++){const ce=4*se,oe=re.circleArray[ce+0],he=re.circleArray[ce+1],me=re.circleArray[ce+2],ae=re.circleArray[ce+3];V.emplace(W++,oe,he,me,ae,0),V.emplace(W++,oe,he,me,ae,1),V.emplace(W++,oe,he,me,ae,2),V.emplace(W++,oe,he,me,ae,3)}(!Ga||Ga.length<2*F)&&(Ga=(function(re){const se=2*re,ce=new a.c1;ce.resize(se),ce._trim();for(let oe=0;oe<se;oe++){const he=6*oe;ce.uint16[he+0]=4*oe+0,ce.uint16[he+1]=4*oe+1,ce.uint16[he+2]=4*oe+2,ce.uint16[he+3]=4*oe+2,ce.uint16[he+4]=4*oe+3,ce.uint16[he+5]=4*oe+0}return ce})(F));const te=b.createIndexBuffer(Ga,!0),ee=b.createVertexBuffer(V,a.c0.members,!0);for(const re of z){const se=a2(_.transform);B.draw(b,$.TRIANGLES,Bt.disabled,ci.disabled,_.colorModeForRenderPass(),kt.disabled,se,_.style.map.terrain&&_.style.map.terrain.getTerrainData(re.coord),null,u.id,ee,te,a.aM.simpleSegment(0,2*re.circleOffset,re.circleArray.length,re.circleArray.length/2),null,_.transform.zoom,null,null,null)}ee.destroy(),te.destroy()}const y2=a.ag(new Float32Array(16));function qv(_,n,u,f,g,b){const{horizontalAlign:S,verticalAlign:$}=a.aH(_);return new a.P((-(S-.5)*n/g+f[0])*b,(-($-.5)*u/g+f[1])*b)}function v2(_,n,u,f,g,b){const S=n.tileAnchorPoint.add(new a.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let $=f.mult(b);u||($=$.rotate(-g));const M=S.add($);return yr(M.x,M.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(u){const $=on(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(_),M=Math.atan($.y/$.x)+($.x<0?Math.PI:0);return _.add(f.rotate(M))}return _.add(f)}function ag(_,n,u,f,g,b,S,$,M,z,F,j){const B=_.text.placedSymbolArray,V=_.text.dynamicLayoutVertexArray,W=_.icon.dynamicLayoutVertexArray,te={};V.clear();for(let ee=0;ee<B.length;ee++){const re=B.get(ee),se=re.hidden||!re.crossTileID||_.allowVerticalPlacement&&!re.placedOrientation?null:f[re.crossTileID];if(se){const ce=new a.P(re.anchorX,re.anchorY),oe={getElevation:j,width:g.width,height:g.height,pitchedLabelPlaneMatrix:b,pitchWithMap:u,transform:g,tileAnchorPoint:ce,translation:z,unwrappedTileID:F},he=u?Fa(ce.x,ce.y,oe):on(ce.x,ce.y,oe),me=it(g.cameraToCenterDistance,he.signedDistanceFromCamera);let ae=a.ap(_.textSizeData,$,re)*me/a.aB;u&&(ae*=_.tilePixelRatio/S);const{width:we,height:Oe,anchor:Ee,textOffset:$e,textBoxScale:ze}=se,tt=qv(Ee,we,Oe,$e,ze,ae),st=g.getPitchedTextCorrection(ce.x+z[0],ce.y+z[1],F),He=v2(he.point,oe,n,tt,-g.bearingInRadians,st),xt=_.allowVerticalPlacement&&re.placedOrientation===a.ao.vertical?Math.PI/2:0;for(let Ht=0;Ht<re.numGlyphs;Ht++)a.av(V,He,xt);M&&re.associatedIconIndex>=0&&(te[re.associatedIconIndex]={shiftedAnchor:He,angle:xt})}else To(re.numGlyphs,V)}if(M){W.clear();const ee=_.icon.placedSymbolArray;for(let re=0;re<ee.length;re++){const se=ee.get(re);if(se.hidden)To(se.numGlyphs,W);else{const ce=te[re];if(ce)for(let oe=0;oe<se.numGlyphs;oe++)a.av(W,ce.shiftedAnchor,ce.angle);else To(se.numGlyphs,W)}}_.icon.dynamicLayoutVertexBuffer.updateData(W)}_.text.dynamicLayoutVertexBuffer.updateData(V)}function np(_,n,u){return u.iconsInText&&n?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function hh(_,n,u,f,g,b,S,$,M,z,F,j,B){const V=_.context,W=V.gl,te=_.transform,ee=$==="map",re=M==="map",se=$!=="viewport"&&u.layout.get("symbol-placement")!=="point",ce=ee&&!re&&!se,oe=!u.layout.get("symbol-sort-key").isConstant();let he=!1;const me=_.getDepthModeForSublayer(0,Bt.ReadOnly),ae=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),we=[],Oe=te.getCircleRadiusCorrection();for(const Ee of f){const $e=n.getTile(Ee),ze=$e.getBucket(u);if(!ze)continue;const tt=g?ze.text:ze.icon;if(!tt||!tt.segments.get().length||!tt.hasVisibleVertices)continue;const st=tt.programConfigurations.get(u.id),He=g||ze.sdfIcons,xt=g?ze.textSizeData:ze.iconSizeData,Ht=re||te.pitch!==0,yi=_.useProgram(np(He,g,ze),st),Ci=a.an(xt,te.zoom),wi=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ee);let Hi,Xi,Ut,Ei,_r=[0,0],Ar=null;if(g)Xi=$e.glyphAtlasTexture,Ut=W.LINEAR,Hi=$e.glyphAtlasTexture.size,ze.iconsInText&&(_r=$e.imageAtlasTexture.size,Ar=$e.imageAtlasTexture,Ei=Ht||_.options.rotating||_.options.zooming||xt.kind==="composite"||xt.kind==="camera"?W.LINEAR:W.NEAREST);else{const br=u.layout.get("icon-size").constantOr(0)!==1||ze.iconsNeedLinear;Xi=$e.imageAtlasTexture,Ut=He||_.options.rotating||_.options.zooming||br||Ht?W.LINEAR:W.NEAREST,Hi=$e.imageAtlasTexture.size}const Hr=a.aC($e,1,_.transform.zoom),In=ur(ee,_.transform,Hr),Zs=a.L();a.aq(Zs,In);const Ha=ti(re,ee,_.transform,Hr),Za=a.aD(te,$e,b,S),Xc=te.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),Jc=ae&&ze.hasTextData(),ql=u.layout.get("icon-text-fit")!=="none"&&Jc&&ze.hasIconData();if(se){const br=_.style.map.terrain?(xs,xr)=>_.style.map.terrain.getElevation(Ee,xs,xr):null,Dr=u.layout.get("text-rotation-alignment")==="map";Wi(ze,_,g,In,Zs,re,z,Dr,Ee.toUnwrapped(),te.width,te.height,Za,br)}const Hl=g&&ae||ql,jn=se||Hl?y2:re?In:_.transform.clipSpaceToPixelsMatrix,Ws=He&&u.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let $n;$n=He?ze.iconsInText?u2(xt.kind,Ci,ce,re,se,Hl,_,jn,Ha,Za,Hi,_r,Oe):Av(xt.kind,Ci,ce,re,se,Hl,_,jn,Ha,Za,g,Hi,0,Oe):ah(xt.kind,Ci,ce,re,se,Hl,_,jn,Ha,Za,g,Hi,Oe);const Wa={program:yi,buffers:tt,uniformValues:$n,projectionData:Xc,atlasTexture:Xi,atlasTextureIcon:Ar,atlasInterpolation:Ut,atlasInterpolationIcon:Ei,isSDF:He,hasHalo:Ws};if(oe&&ze.canOverlap){he=!0;const br=tt.segments.get();for(const Dr of br)we.push({segments:new a.aM([Dr]),sortKey:Dr.sortKey,state:Wa,terrainData:wi})}else we.push({segments:tt.segments,sortKey:0,state:Wa,terrainData:wi})}he&&we.sort(((Ee,$e)=>Ee.sortKey-$e.sortKey));for(const Ee of we){const $e=Ee.state;if(V.activeTexture.set(W.TEXTURE0),$e.atlasTexture.bind($e.atlasInterpolation,W.CLAMP_TO_EDGE),$e.atlasTextureIcon&&(V.activeTexture.set(W.TEXTURE1),$e.atlasTextureIcon&&$e.atlasTextureIcon.bind($e.atlasInterpolationIcon,W.CLAMP_TO_EDGE)),$e.isSDF){const ze=$e.uniformValues;$e.hasHalo&&(ze.u_is_halo=1,dh($e.buffers,Ee.segments,u,_,$e.program,me,F,j,ze,$e.projectionData,Ee.terrainData)),ze.u_is_halo=0}dh($e.buffers,Ee.segments,u,_,$e.program,me,F,j,$e.uniformValues,$e.projectionData,Ee.terrainData)}}function dh(_,n,u,f,g,b,S,$,M,z,F){const j=f.context;g.draw(j,j.gl.TRIANGLES,b,S,$,kt.backCCW,M,F,z,u.id,_.layoutVertexBuffer,_.indexBuffer,n,u.paint,f.transform.zoom,_.programConfigurations.get(u.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function lg(_,n,u,f,g){const b=_.context,S=b.gl,$=ci.disabled,M=new Ni([S.ONE,S.ONE],a.bf.transparent,[!0,!0,!0,!0]),z=n.getBucket(u);if(!z)return;const F=f.key;let j=u.heatmapFbos.get(F);j||(j=ph(b,n.tileSize,n.tileSize),u.heatmapFbos.set(F,j)),b.bindFramebuffer.set(j.framebuffer),b.viewport.set([0,0,n.tileSize,n.tileSize]),b.clear({color:a.bf.transparent});const B=z.programConfigurations.get(u.id),V=_.useProgram("heatmap",B,!g),W=_.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),te=_.style.map.terrain.getTerrainData(f);V.draw(b,S.TRIANGLES,Bt.disabled,$,M,kt.disabled,Iv(n,_.transform.zoom,u.paint.get("heatmap-intensity"),1),te,W,u.id,z.layoutVertexBuffer,z.indexBuffer,z.segments,u.paint,_.transform.zoom,B)}function Hv(_,n,u,f,g){const b=_.context,S=b.gl,$=_.transform;b.setColorMode(_.colorModeForRenderPass());const M=fh(b,n),z=u.key,F=n.heatmapFbos.get(z);if(!F)return;b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,F.colorAttachment.get()),b.activeTexture.set(S.TEXTURE1),M.bind(S.LINEAR,S.CLAMP_TO_EDGE);const j=$.getProjectionData({overscaledTileID:u,applyTerrainMatrix:g,applyGlobeMatrix:!f});_.useProgram("heatmapTexture").draw(b,S.TRIANGLES,Bt.disabled,ci.disabled,_.colorModeForRenderPass(),kt.disabled,Wm(_,n,0,1),null,j,n.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments,n.paint,$.zoom),F.destroy(),n.heatmapFbos.delete(z)}function ph(_,n,u){var f,g;const b=_.gl,S=b.createTexture();b.bindTexture(b.TEXTURE_2D,S),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);const $=(f=_.HALF_FLOAT)!==null&&f!==void 0?f:b.UNSIGNED_BYTE,M=(g=_.RGBA16F)!==null&&g!==void 0?g:b.RGBA;b.texImage2D(b.TEXTURE_2D,0,M,n,u,0,b.RGBA,$,null);const z=_.createFramebuffer(n,u,!1,!1);return z.colorAttachment.set(S),z}function fh(_,n){return n.colorRampTexture||(n.colorRampTexture=new a.T(_,n.colorRamp,_.gl.RGBA)),n.colorRampTexture}function mh(_,n,u,f,g){if(!u||!f||!f.imageAtlas)return;const b=f.imageAtlas.patternPositions;let S=b[u.to.toString()],$=b[u.from.toString()];if(!S&&$&&(S=$),!$&&S&&($=S),!S||!$){const M=g.getPaintProperty(n);S=b[M],$=b[M]}S&&$&&_.setConstantPatternPositions(S,$)}function sp(_,n,u,f,g,b,S,$){const M=_.context.gl,z="fill-pattern",F=u.paint.get(z),j=F&&F.constantOr(1),B=u.getCrossfadeParameters();let V,W,te,ee,re;const se=_.transform,ce=u.paint.get("fill-translate"),oe=u.paint.get("fill-translate-anchor");S?(W=j&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=M.LINES):(W=j?"fillPattern":"fill",V=M.TRIANGLES);const he=F.constantOr(null);for(const me of f){const ae=n.getTile(me);if(j&&!ae.patternsLoaded())continue;const we=ae.getBucket(u);if(!we)continue;const Oe=we.programConfigurations.get(u.id),Ee=_.useProgram(W,Oe),$e=_.style.map.terrain&&_.style.map.terrain.getTerrainData(me);j&&(_.context.activeTexture.set(M.TEXTURE0),ae.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Oe.updatePaintBuffers(B)),mh(Oe,z,he,ae,u);const ze=se.getProjectionData({overscaledTileID:me,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),tt=a.aD(se,ae,ce,oe);if(S){ee=we.indexBuffer2,re=we.segments2;const He=[M.drawingBufferWidth,M.drawingBufferHeight];te=W==="fillOutlinePattern"&&j?sh(_,B,ae,He,tt):nh(He,tt)}else ee=we.indexBuffer,re=we.segments,te=j?Wd(_,B,ae,tt):{u_fill_translate:tt};const st=_.stencilModeForClipping(me);Ee.draw(_.context,V,g,st,b,kt.backCCW,te,$e,ze,u.id,we.layoutVertexBuffer,ee,re,u.paint,_.transform.zoom,Oe)}}function cg(_,n,u,f,g,b,S,$){const M=_.context,z=M.gl,F="fill-extrusion-pattern",j=u.paint.get(F),B=j.constantOr(1),V=u.getCrossfadeParameters(),W=u.paint.get("fill-extrusion-opacity"),te=j.constantOr(null),ee=_.transform;for(const re of f){const se=n.getTile(re),ce=se.getBucket(u);if(!ce)continue;const oe=_.style.map.terrain&&_.style.map.terrain.getTerrainData(re),he=ce.programConfigurations.get(u.id),me=_.useProgram(B?"fillExtrusionPattern":"fillExtrusion",he);B&&(_.context.activeTexture.set(z.TEXTURE0),se.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),he.updatePaintBuffers(V));const ae=ee.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!$,applyTerrainMatrix:!0});mh(he,F,te,se,u);const we=a.aD(ee,se,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Oe=u.paint.get("fill-extrusion-vertical-gradient"),Ee=B?s2(_,Oe,W,we,re,V,se):js(_,Oe,W,we);me.draw(M,M.gl.TRIANGLES,g,b,S,kt.backCCW,Ee,oe,ae,u.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,u.paint,_.transform.zoom,he,_.style.map.terrain&&ce.centroidVertexBuffer)}}function Nl(_,n,u,f,g,b,S,$,M){var z;const F=_.style.projection,j=_.context,B=_.transform,V=j.gl,W=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],te=_.useProgram("hillshade",null,!1,W),ee=!_.options.moving;for(const re of f){const se=n.getTile(re),ce=se.fbo;if(!ce)continue;const oe=F.getMeshFromTileID(j,re.canonical,$,!0,"raster"),he=(z=_.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(re);j.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,ce.colorAttachment.get());const me=B.getProjectionData({overscaledTileID:re,aligned:ee,applyGlobeMatrix:!M,applyTerrainMatrix:!0});te.draw(j,V.TRIANGLES,b,g[re.overscaledZ],S,kt.backCCW,l2(_,se,u),he,me,u.id,oe.vertexBuffer,oe.indexBuffer,oe.segments)}}function ug(_,n,u,f,g,b,S,$,M){var z;const F=_.style.projection,j=_.context,B=_.transform,V=j.gl,W=_.useProgram("colorRelief"),te=!_.options.moving;let ee=!0,re=0;for(const se of f){const ce=n.getTile(se),oe=ce.dem;if(ee){const Ee=V.getParameter(V.MAX_TEXTURE_SIZE),{elevationTexture:$e,colorTexture:ze}=u.getColorRampTextures(j,Ee,oe.getUnpackVector());j.activeTexture.set(V.TEXTURE1),$e.bind(V.NEAREST,V.CLAMP_TO_EDGE),j.activeTexture.set(V.TEXTURE4),ze.bind(V.LINEAR,V.CLAMP_TO_EDGE),ee=!1,re=$e.size[0]}if(!oe||!oe.data)continue;const he=oe.stride,me=oe.getPixels();if(j.activeTexture.set(V.TEXTURE0),j.pixelStoreUnpackPremultiplyAlpha.set(!1),ce.demTexture=ce.demTexture||_.getTileTexture(he),ce.demTexture){const Ee=ce.demTexture;Ee.update(me,{premultiply:!1}),Ee.bind(V.LINEAR,V.CLAMP_TO_EDGE)}else ce.demTexture=new a.T(j,me,V.RGBA,{premultiply:!1}),ce.demTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE);const ae=F.getMeshFromTileID(j,se.canonical,$,!0,"raster"),we=(z=_.style.map.terrain)===null||z===void 0?void 0:z.getTerrainData(se),Oe=B.getProjectionData({overscaledTileID:se,aligned:te,applyGlobeMatrix:!M,applyTerrainMatrix:!0});W.draw(j,V.TRIANGLES,b,g[se.overscaledZ],S,kt.backCCW,Pv(u,ce.dem,re),we,Oe,u.id,ae.vertexBuffer,ae.indexBuffer,ae.segments)}}const op=[new a.P(0,0),new a.P(a.$,0),new a.P(a.$,a.$),new a.P(0,a.$)];function Bl(_,n,u,f,g,b,S,$,M=!1,z=!1){const F=f[f.length-1].overscaledZ,j=_.context,B=j.gl,V=_.useProgram("raster"),W=_.transform,te=_.style.projection,ee=_.colorModeForRenderPass(),re=!_.options.moving;for(const se of f){const ce=_.getDepthModeForSublayer(se.overscaledZ-F,u.paint.get("raster-opacity")===1?Bt.ReadWrite:Bt.ReadOnly,B.LESS),oe=n.getTile(se);oe.registerFadeDuration(u.paint.get("raster-fade-duration"));const he=n.findLoadedParent(se,0),me=n.findLoadedSibling(se),ae=hg(oe,he||me||null,n,u,_.transform,_.style.map.terrain);let we,Oe;const Ee=u.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;j.activeTexture.set(B.TEXTURE0),oe.texture.bind(Ee,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),j.activeTexture.set(B.TEXTURE1),he?(he.texture.bind(Ee,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),we=Math.pow(2,he.tileID.overscaledZ-oe.tileID.overscaledZ),Oe=[oe.tileID.canonical.x*we%1,oe.tileID.canonical.y*we%1]):oe.texture.bind(Ee,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),oe.texture.useMipmap&&j.extTextureFilterAnisotropic&&_.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const $e=_.style.map.terrain&&_.style.map.terrain.getTerrainData(se),ze=W.getProjectionData({overscaledTileID:se,aligned:re,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),tt=oh(Oe||[0,0],we||1,ae,u,$),st=te.getMeshFromTileID(j,se.canonical,b,S,"raster");V.draw(j,B.TRIANGLES,ce,g?g[se.overscaledZ]:ci.disabled,ee,M?kt.frontCCW:kt.backCCW,tt,$e,ze,u.id,st.vertexBuffer,st.indexBuffer,st.segments)}}function hg(_,n,u,f,g,b){const S=f.paint.get("raster-fade-duration");if(!b&&S>0){const $=L.now(),M=($-_.timeAdded)/S,z=n?($-n.timeAdded)/S:-1,F=u.getSource(),j=St(g,{tileSize:F.tileSize,roundZoom:F.roundZoom}),B=!n||Math.abs(n.tileID.overscaledZ-j)>Math.abs(_.tileID.overscaledZ-j),V=B&&_.refreshedUponExpiration?1:a.ah(B?M:1-z,0,1);return _.refreshedUponExpiration&&M>=1&&(_.refreshedUponExpiration=!1),n?{opacity:1,mix:1-V}:{opacity:V,mix:0}}return{opacity:1,mix:0}}const Zv=new a.bf(1,0,0,1),Wv=new a.bf(0,1,0,1),ap=new a.bf(0,0,1,1),dg=new a.bf(1,0,1,1),_2=new a.bf(0,1,1,1);function pg(_,n,u,f){$o(_,0,n+u/2,_.transform.width,u,f)}function Yi(_,n,u,f){$o(_,n-u/2,0,u,_.transform.height,f)}function $o(_,n,u,f,g,b){const S=_.context,$=S.gl;$.enable($.SCISSOR_TEST),$.scissor(n*_.pixelRatio,u*_.pixelRatio,f*_.pixelRatio,g*_.pixelRatio),S.clear({color:b}),$.disable($.SCISSOR_TEST)}function _s(_,n,u){const f=_.context,g=f.gl,b=_.useProgram("debug"),S=Bt.disabled,$=ci.disabled,M=_.colorModeForRenderPass(),z="$debug",F=_.style.map.terrain&&_.style.map.terrain.getTerrainData(u);f.activeTexture.set(g.TEXTURE0);const j=n.getTileByID(u.key).latestRawTileData,B=Math.floor((j&&j.byteLength||0)/1024),V=n.getTile(u).tileSize,W=512/Math.min(V,512)*(u.overscaledZ/_.transform.zoom)*.5;let te=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(te+=` => ${u.overscaledZ}`),(function(re,se){re.initDebugOverlayCanvas();const ce=re.debugOverlayCanvas,oe=re.context.gl,he=re.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,ce.width,ce.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(se,5,5),he.strokeText(se,5,5),re.debugOverlayTexture.update(ce),re.debugOverlayTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE)})(_,`${te} ${B}kB`);const ee=_.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});b.draw(f,g.TRIANGLES,S,$,Ni.alphaBlended,kt.disabled,zl(a.bf.transparent,W),null,ee,z,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),b.draw(f,g.LINE_STRIP,S,$,M,kt.disabled,zl(a.bf.red),F,ee,z,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function lp(_,n,u,f){const{isRenderingGlobe:g}=f,b=_.context,S=b.gl,$=_.transform,M=_.colorModeForRenderPass(),z=_.getDepthModeFor3D(),F=_.useProgram("terrain");b.bindFramebuffer.set(null),b.viewport.set([0,0,_.width,_.height]);for(const j of u){const B=n.getTerrainMesh(j.tileID),V=_.renderToTexture.getTexture(j),W=n.getTerrainData(j.tileID);b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,V.texture);const te=n.getMeshFrameDelta($.zoom),ee=$.calculateFogMatrix(j.tileID.toUnwrapped()),re=Hd(te,ee,_.style.sky,$.pitch,g),se=$.getProjectionData({overscaledTileID:j.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});F.draw(b,S.TRIANGLES,z,ci.disabled,M,kt.backCCW,re,W,se,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}}function gh(_,n){if(!n.mesh){const u=new a.aL;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const f=new a.aN;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),n.mesh=new $l(_.createVertexBuffer(u,Ua.members),_.createIndexBuffer(f),a.aM.simpleSegment(0,0,u.length,f.length))}return n.mesh}class Yv{constructor(n,u){this.context=new Vv(n),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Jt.maxUnderzooming+Jt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Dc}resize(n,u,f){if(this.width=Math.floor(n*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const n=this.context,u=new a.aL;u.emplaceBack(0,0),u.emplaceBack(a.$,0),u.emplaceBack(0,a.$),u.emplaceBack(a.$,a.$),this.tileExtentBuffer=n.createVertexBuffer(u,Ua.members),this.tileExtentSegments=a.aM.simpleSegment(0,0,4,2);const f=new a.aL;f.emplaceBack(0,0),f.emplaceBack(a.$,0),f.emplaceBack(0,a.$),f.emplaceBack(a.$,a.$),this.debugBuffer=n.createVertexBuffer(f,Ua.members),this.debugSegments=a.aM.simpleSegment(0,0,4,5);const g=new a.c6;g.emplaceBack(0,0,0,0),g.emplaceBack(a.$,0,a.$,0),g.emplaceBack(0,a.$,0,a.$),g.emplaceBack(a.$,a.$,a.$,a.$),this.rasterBoundsBuffer=n.createVertexBuffer(g,r2.members),this.rasterBoundsSegments=a.aM.simpleSegment(0,0,4,2);const b=new a.aL;b.emplaceBack(0,0),b.emplaceBack(a.$,0),b.emplaceBack(0,a.$),b.emplaceBack(a.$,a.$),this.rasterBoundsBufferPosOnly=n.createVertexBuffer(b,Ua.members),this.rasterBoundsSegmentsPosOnly=a.aM.simpleSegment(0,0,4,5);const S=new a.aL;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(S,Ua.members),this.viewportSegments=a.aM.simpleSegment(0,0,4,2);const $=new a.c7;$.emplaceBack(0),$.emplaceBack(1),$.emplaceBack(3),$.emplaceBack(2),$.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer($);const M=new a.aN;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(M);const z=this.context.gl;this.stencilClearMode=new ci({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.tileExtentMesh=new $l(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const n=this.context,u=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=a.L();a.bY(f,0,this.width,this.height,0,0,1),a.N(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const g={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(n,u.TRIANGLES,Bt.disabled,this.stencilClearMode,Ni.disabled,kt.disabled,null,null,g,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,u,f){if(this.currentStencilSource===n.source||!n.isTileClipped()||!u||!u.length)return;this.currentStencilSource=n.source,this.nextStencilID+u.length>256&&this.clearStencil();const g=this.context;g.setColorMode(Ni.disabled),g.setDepthMode(Bt.disabled);const b={};for(const S of u)b[S.key]=this.nextStencilID++;this._renderTileMasks(b,u,f,!0),this._renderTileMasks(b,u,f,!1),this._tileClippingMaskIDs=b}_renderTileMasks(n,u,f,g){const b=this.context,S=b.gl,$=this.style.projection,M=this.transform,z=this.useProgram("clippingMask");for(const F of u){const j=n[F.key],B=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),V=$.getMeshFromTileID(this.context,F.canonical,g,!0,"stencil"),W=M.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!f,applyTerrainMatrix:!0});z.draw(b,S.TRIANGLES,Bt.disabled,new ci({func:S.ALWAYS,mask:0},j,255,S.KEEP,S.KEEP,S.REPLACE),Ni.disabled,f?kt.disabled:kt.backCCW,null,B,W,"$clipping",V.vertexBuffer,V.indexBuffer,V.segments)}}_renderTilesDepthBuffer(){const n=this.context,u=n.gl,f=this.style.projection,g=this.transform,b=this.useProgram("depth"),S=this.getDepthModeFor3D(),$=Te(g,{tileSize:g.tileSize});for(const M of $){const z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(M),F=f.getMeshFromTileID(this.context,M.canonical,!0,!0,"raster"),j=g.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!0,applyTerrainMatrix:!0});b.draw(n,u.TRIANGLES,S,ci.disabled,Ni.disabled,kt.backCCW,null,z,j,"$clipping",F.vertexBuffer,F.indexBuffer,F.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new ci({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){const u=this.context.gl;return new ci({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(n){const u=this.context.gl,f=n.sort(((S,$)=>$.overscaledZ-S.overscaledZ)),g=f[f.length-1].overscaledZ,b=f[0].overscaledZ-g+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const S={};for(let $=0;$<b;$++)S[$+g]=new ci({func:u.GEQUAL,mask:255},$+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[S,f]}return[{[g]:ci.disabled},f]}stencilConfigForOverlapTwoPass(n){const u=this.context.gl,f=n.sort(((S,$)=>$.overscaledZ-S.overscaledZ)),g=f[f.length-1].overscaledZ,b=f[0].overscaledZ-g+1;if(this.clearStencil(),b>1){const S={},$={};for(let M=0;M<b;M++)S[M+g]=new ci({func:u.GREATER,mask:255},b+1+M,255,u.KEEP,u.KEEP,u.REPLACE),$[M+g]=new ci({func:u.GREATER,mask:255},1+M,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*b+1,[S,$,f]}return this.nextStencilID=3,[{[g]:new ci({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[g]:new ci({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},f]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Ni([n.CONSTANT_COLOR,n.ONE],new a.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ni.unblended:Ni.alphaBlended}getDepthModeForSublayer(n,u,f){if(!this.opaquePassEnabledForLayer())return Bt.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Bt(f||this.context.gl.LEQUAL,u,[g,g])}getDepthModeFor3D(){return new Bt(this.context.gl.LEQUAL,Bt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,u){var f,g;this.style=n,this.options=u,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(L.now()),this.imageManager.beginFrame();const b=this.style._order,S=this.style.sourceCaches,$={},M={},z={},F={isRenderingToTexture:!1,isRenderingGlobe:((f=n.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const B in S){const V=S[B];V.used&&V.prepare(this.context),$[B]=V.getVisibleCoordinates(!1),M[B]=$[B].slice().reverse(),z[B]=V.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<b.length;B++)if(this.style._layers[b[B]].is3D()){this.opaquePassCutoff=B;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const B of b){const V=this.style._layers[B];if(!V.hasOffscreenPass()||V.isHidden(this.transform.zoom))continue;const W=M[V.source];(V.type==="custom"||W.length)&&this.renderLayer(this,S[V.source],V,W,F)}if((g=this.style.projection)===null||g===void 0||g.updateGPUdependent({context:this.context,useProgram:B=>this.useProgram(B)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?a.bf.black:a.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(B,V){const W=B.context,te=W.gl,ee=((me,ae,we)=>{const Oe=Math.cos(ae.rollInRadians),Ee=Math.sin(ae.rollInRadians),$e=fe(ae),ze=ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:me.properties.get("sky-color"),u_horizon_color:me.properties.get("horizon-color"),u_horizon:[(ae.width/2-$e*Ee)*we,(ae.height/2+$e*Oe)*we],u_horizon_normal:[-Ee,Oe],u_sky_horizon_blend:me.properties.get("sky-horizon-blend")*ae.height/2*we,u_sky_blend:ze}})(V,B.style.map.transform,B.pixelRatio),re=new Bt(te.LEQUAL,Bt.ReadWrite,[0,1]),se=ci.disabled,ce=B.colorModeForRenderPass(),oe=B.useProgram("sky"),he=gh(W,V);oe.draw(W,te.TRIANGLES,re,se,ce,kt.disabled,ee,null,void 0,"sky",he.vertexBuffer,he.indexBuffer,he.segments)})(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[b[this.currentLayer]],V=S[B.source],W=$[B.source];this._renderTileClippingMasks(B,W,!1),this.renderLayer(this,V,B,W,F)}this.renderPass="translucent";let j=!1;for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const B=this.style._layers[b[this.currentLayer]],V=S[B.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(B,F))continue;this.opaquePassEnabledForLayer()||j||(j=!0,F.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const W=(B.type==="symbol"?z:M)[B.source];this._renderTileClippingMasks(B,$[B.source],!!this.renderToTexture),this.renderLayer(this,V,B,W,F)}if(F.isRenderingGlobe&&(function(B,V,W){const te=B.context,ee=te.gl,re=B.useProgram("atmosphere"),se=new Bt(ee.LEQUAL,Bt.ReadOnly,[0,1]),ce=B.transform,oe=(function(ze,tt){const st=ze.properties.get("position"),He=[-st.x,-st.y,-st.z],xt=a.ag(new Float64Array(16));return ze.properties.get("anchor")==="map"&&(a.b6(xt,xt,tt.rollInRadians),a.b7(xt,xt,-tt.pitchInRadians),a.b6(xt,xt,tt.bearingInRadians),a.b7(xt,xt,tt.center.lat*Math.PI/180),a.bz(xt,xt,-tt.center.lng*Math.PI/180)),a.c5(He,He,xt),He})(W,B.transform),he=ce.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),me=V.properties.get("atmosphere-blend")*he.projectionTransition;if(me===0)return;const ae=Oc(ce.worldSize,ce.center.lat),we=ce.inverseProjectionMatrix,Oe=new Float64Array(4);Oe[3]=1,a.aw(Oe,Oe,ce.modelViewProjectionMatrix),Oe[0]/=Oe[3],Oe[1]/=Oe[3],Oe[2]/=Oe[3],Oe[3]=1,a.aw(Oe,Oe,we),Oe[0]/=Oe[3],Oe[1]/=Oe[3],Oe[2]/=Oe[3],Oe[3]=1;const Ee=((ze,tt,st,He,xt)=>({u_sun_pos:ze,u_atmosphere_blend:tt,u_globe_position:st,u_globe_radius:He,u_inv_proj_matrix:xt}))(oe,me,[Oe[0],Oe[1],Oe[2]],ae,we),$e=gh(te,V);re.draw(te,ee.TRIANGLES,se,ci.disabled,Ni.alphaBlended,kt.disabled,Ee,null,null,"atmosphere",$e.vertexBuffer,$e.indexBuffer,$e.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const B=(function(V,W){let te=null;const ee=Object.values(V._layers).flatMap((oe=>oe.source&&!oe.isHidden(W)?[V.sourceCaches[oe.source]]:[])),re=ee.filter((oe=>oe.getSource().type==="vector")),se=ee.filter((oe=>oe.getSource().type!=="vector")),ce=oe=>{(!te||te.getSource().maxzoom<oe.getSource().maxzoom)&&(te=oe)};return re.forEach((oe=>ce(oe))),te||se.forEach((oe=>ce(oe))),te})(this.style,this.transform.zoom);B&&(function(V,W,te){for(let ee=0;ee<te.length;ee++)_s(V,W,te[ee])})(this,B,B.getVisibleCoordinates())}this.options.showPadding&&(function(B){const V=B.transform.padding;pg(B,B.transform.height-(V.top||0),3,Zv),pg(B,V.bottom||0,3,Wv),Yi(B,V.left||0,3,ap),Yi(B,B.transform.width-(V.right||0),3,dg);const W=B.transform.centerPoint;(function(te,ee,re,se){$o(te,ee-1,re-10,2,20,se),$o(te,ee-10,re-1,20,2,se)})(B,W.x,B.transform.height-W.y,_2)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=n?!a.c8(u,f):!a.c9(u,f)),g||(g=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),g&&(a.ca(u,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(b,S){const $=b.context,M=$.gl,z=b.transform,F=Ni.unblended,j=new Bt(M.LEQUAL,Bt.ReadWrite,[0,1]),B=S.sourceCache.getRenderableTiles(),V=b.useProgram("terrainDepth");$.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),$.viewport.set([0,0,b.width/devicePixelRatio,b.height/devicePixelRatio]),$.clear({color:a.bf.transparent,depth:1});for(const W of B){const te=S.getTerrainMesh(W.tileID),ee=S.getTerrainData(W.tileID),re=z.getProjectionData({overscaledTileID:W.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),se={u_ele_delta:S.getMeshFrameDelta(z.zoom)};V.draw($,M.TRIANGLES,j,ci.disabled,F,kt.backCCW,se,ee,re,"terrain",te.vertexBuffer,te.indexBuffer,te.segments)}$.bindFramebuffer.set(null),$.viewport.set([0,0,b.width,b.height])})(this,this.style.map.terrain),(function(b,S){const $=b.context,M=$.gl,z=b.transform,F=Ni.unblended,j=new Bt(M.LEQUAL,Bt.ReadWrite,[0,1]),B=S.getCoordsTexture(),V=S.sourceCache.getRenderableTiles(),W=b.useProgram("terrainCoords");$.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),$.viewport.set([0,0,b.width/devicePixelRatio,b.height/devicePixelRatio]),$.clear({color:a.bf.transparent,depth:1}),S.coordsIndex=[];for(const te of V){const ee=S.getTerrainMesh(te.tileID),re=S.getTerrainData(te.tileID);$.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,B.texture);const se={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(z.zoom)},ce=z.getProjectionData({overscaledTileID:te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});W.draw($,M.TRIANGLES,j,ci.disabled,F,kt.backCCW,se,re,ce,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments),S.coordsIndex.push(te.tileID.key)}$.bindFramebuffer.set(null),$.viewport.set([0,0,b.width,b.height])})(this,this.style.map.terrain))}renderLayer(n,u,f,g,b){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(g||[]).length)&&(this.id=f.id,a.cb(f)?(function(S,$,M,z,F,j){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:B}=j,V=ci.disabled,W=S.colorModeForRenderPass();(M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(te,ee,re,se,ce,oe,he,me,ae){const we=ee.transform,Oe=ee.style.map.terrain,Ee=ce==="map",$e=oe==="map";for(const ze of te){const tt=se.getTile(ze),st=tt.getBucket(re);if(!st||!st.text||!st.text.segments.get().length)continue;const He=a.an(st.textSizeData,we.zoom),xt=a.aC(tt,1,ee.transform.zoom),Ht=ur(Ee,ee.transform,xt),yi=re.layout.get("icon-text-fit")!=="none"&&st.hasIconData();if(He){const Ci=Math.pow(2,we.zoom-tt.tileID.overscaledZ),wi=Oe?(Hi,Xi)=>Oe.getElevation(ze,Hi,Xi):null;ag(st,Ee,$e,ae,we,Ht,Ci,He,yi,a.aD(we,tt,he,me),ze.toUnwrapped(),wi)}}})(z,S,M,$,M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),F),M.paint.get("icon-opacity").constantOr(1)!==0&&hh(S,$,M,z,!1,M.paint.get("icon-translate"),M.paint.get("icon-translate-anchor"),M.layout.get("icon-rotation-alignment"),M.layout.get("icon-pitch-alignment"),M.layout.get("icon-keep-upright"),V,W,B),M.paint.get("text-opacity").constantOr(1)!==0&&hh(S,$,M,z,!0,M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.layout.get("text-keep-upright"),V,W,B),$.map.showCollisionBoxes&&(Gv(S,$,M,z,!0),Gv(S,$,M,z,!1))})(n,u,f,g,this.style.placement.variableOffsets,b):a.cc(f)?(function(S,$,M,z,F){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:j}=F,B=M.paint.get("circle-opacity"),V=M.paint.get("circle-stroke-width"),W=M.paint.get("circle-stroke-opacity"),te=!M.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(V.constantOr(1)===0||W.constantOr(1)===0))return;const ee=S.context,re=ee.gl,se=S.transform,ce=S.getDepthModeForSublayer(0,Bt.ReadOnly),oe=ci.disabled,he=S.colorModeForRenderPass(),me=[],ae=se.getCircleRadiusCorrection();for(let we=0;we<z.length;we++){const Oe=z[we],Ee=$.getTile(Oe),$e=Ee.getBucket(M);if(!$e)continue;const ze=M.paint.get("circle-translate"),tt=M.paint.get("circle-translate-anchor"),st=a.aD(se,Ee,ze,tt),He=$e.programConfigurations.get(M.id),xt=S.useProgram("circle",He),Ht=$e.layoutVertexBuffer,yi=$e.indexBuffer,Ci=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Oe),wi={programConfiguration:He,program:xt,layoutVertexBuffer:Ht,indexBuffer:yi,uniformValues:o2(S,Ee,M,st,ae),terrainData:Ci,projectionData:se.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!j,applyTerrainMatrix:!0})};if(te){const Hi=$e.segments.get();for(const Xi of Hi)me.push({segments:new a.aM([Xi]),sortKey:Xi.sortKey,state:wi})}else me.push({segments:$e.segments,sortKey:0,state:wi})}te&&me.sort(((we,Oe)=>we.sortKey-Oe.sortKey));for(const we of me){const{programConfiguration:Oe,program:Ee,layoutVertexBuffer:$e,indexBuffer:ze,uniformValues:tt,terrainData:st,projectionData:He}=we.state;Ee.draw(ee,re.TRIANGLES,ce,oe,he,kt.backCCW,tt,st,He,M.id,$e,ze,we.segments,M.paint,S.transform.zoom,Oe)}})(n,u,f,g,b):a.cd(f)?(function(S,$,M,z,F){if(M.paint.get("heatmap-opacity")===0)return;const j=S.context,{isRenderingToTexture:B,isRenderingGlobe:V}=F;if(S.style.map.terrain){for(const W of z){const te=$.getTile(W);$.hasRenderableParent(W)||(S.renderPass==="offscreen"?lg(S,te,M,W,V):S.renderPass==="translucent"&&Hv(S,M,W,B,V))}j.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?(function(W,te,ee,re){const se=W.context,ce=se.gl,oe=W.transform,he=ci.disabled,me=new Ni([ce.ONE,ce.ONE],a.bf.transparent,[!0,!0,!0,!0]);(function(ae,we,Oe){const Ee=ae.gl;ae.activeTexture.set(Ee.TEXTURE1),ae.viewport.set([0,0,we.width/4,we.height/4]);let $e=Oe.heatmapFbos.get(a.c2);$e?(Ee.bindTexture(Ee.TEXTURE_2D,$e.colorAttachment.get()),ae.bindFramebuffer.set($e.framebuffer)):($e=ph(ae,we.width/4,we.height/4),Oe.heatmapFbos.set(a.c2,$e))})(se,W,ee),se.clear({color:a.bf.transparent});for(let ae=0;ae<re.length;ae++){const we=re[ae];if(te.hasRenderableParent(we))continue;const Oe=te.getTile(we),Ee=Oe.getBucket(ee);if(!Ee)continue;const $e=Ee.programConfigurations.get(ee.id),ze=W.useProgram("heatmap",$e),tt=oe.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),st=oe.getCircleRadiusCorrection();ze.draw(se,ce.TRIANGLES,Bt.disabled,he,me,kt.backCCW,Iv(Oe,oe.zoom,ee.paint.get("heatmap-intensity"),st),null,tt,ee.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,ee.paint,oe.zoom,$e)}se.viewport.set([0,0,W.width,W.height])})(S,$,M,z):S.renderPass==="translucent"&&(function(W,te){const ee=W.context,re=ee.gl;ee.setColorMode(W.colorModeForRenderPass());const se=te.heatmapFbos.get(a.c2);se&&(ee.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,se.colorAttachment.get()),ee.activeTexture.set(re.TEXTURE1),fh(ee,te).bind(re.LINEAR,re.CLAMP_TO_EDGE),W.useProgram("heatmapTexture").draw(ee,re.TRIANGLES,Bt.disabled,ci.disabled,W.colorModeForRenderPass(),kt.disabled,Wm(W,te,0,1),null,null,te.id,W.viewportBuffer,W.quadTriangleIndexBuffer,W.viewportSegments,te.paint,W.transform.zoom))})(S,M)})(n,u,f,g,b):a.ce(f)?(function(S,$,M,z,F){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:j}=F,B=M.paint.get("line-opacity"),V=M.paint.get("line-width");if(B.constantOr(1)===0||V.constantOr(1)===0)return;const W=S.getDepthModeForSublayer(0,Bt.ReadOnly),te=S.colorModeForRenderPass(),ee=M.paint.get("line-dasharray"),re=M.paint.get("line-pattern"),se=re.constantOr(1),ce=M.paint.get("line-gradient"),oe=M.getCrossfadeParameters(),he=se?"linePattern":ee?"lineSDF":ce?"lineGradient":"line",me=S.context,ae=me.gl,we=S.transform;let Oe=!0;for(const Ee of z){const $e=$.getTile(Ee);if(se&&!$e.patternsLoaded())continue;const ze=$e.getBucket(M);if(!ze)continue;const tt=ze.programConfigurations.get(M.id),st=S.context.program.get(),He=S.useProgram(he,tt),xt=Oe||He.program!==st,Ht=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ee),yi=re.constantOr(null);if(yi&&$e.imageAtlas){const Ut=$e.imageAtlas,Ei=Ut.patternPositions[yi.to.toString()],_r=Ut.patternPositions[yi.from.toString()];Ei&&_r&&tt.setConstantPatternPositions(Ei,_r)}const Ci=we.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),wi=we.getPixelScale(),Hi=se?kv(S,$e,M,wi,oe):ee?Ol(S,$e,M,wi,ee,oe):ce?Mv(S,$e,M,wi,ze.lineClipsArray.length):Xd(S,$e,M,wi);if(se)me.activeTexture.set(ae.TEXTURE0),$e.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),tt.updatePaintBuffers(oe);else if(ee&&(xt||S.lineAtlas.dirty))me.activeTexture.set(ae.TEXTURE0),S.lineAtlas.bind(me);else if(ce){const Ut=ze.gradients[M.id];let Ei=Ut.texture;if(M.gradientVersion!==Ut.version){let _r=256;if(M.stepInterpolant){const Ar=$.getSource().maxzoom,Hr=Ee.canonical.z===Ar?Math.ceil(1<<S.transform.maxZoom-Ee.canonical.z):1;_r=a.ah(a.c3(ze.maxLineLength/a.$*1024*Hr),256,me.maxTextureSize)}Ut.gradient=a.c4({expression:M.gradientExpression(),evaluationKey:"lineProgress",resolution:_r,image:Ut.gradient||void 0,clips:ze.lineClipsArray}),Ut.texture?Ut.texture.update(Ut.gradient):Ut.texture=new a.T(me,Ut.gradient,ae.RGBA),Ut.version=M.gradientVersion,Ei=Ut.texture}me.activeTexture.set(ae.TEXTURE0),Ei.bind(M.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}const Xi=S.stencilModeForClipping(Ee);He.draw(me,ae.TRIANGLES,W,Xi,te,kt.disabled,Hi,Ht,Ci,M.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,M.paint,S.transform.zoom,tt,ze.layoutVertexBuffer2),Oe=!1}})(n,u,f,g,b):a.cf(f)?(function(S,$,M,z,F){const j=M.paint.get("fill-color"),B=M.paint.get("fill-opacity");if(B.constantOr(1)===0)return;const{isRenderingToTexture:V}=F,W=S.colorModeForRenderPass(),te=M.paint.get("fill-pattern"),ee=S.opaquePassEnabledForLayer()&&!te.constantOr(1)&&j.constantOr(a.bf.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===ee){const re=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?Bt.ReadWrite:Bt.ReadOnly);sp(S,$,M,z,re,W,!1,V)}if(S.renderPass==="translucent"&&M.paint.get("fill-antialias")){const re=S.getDepthModeForSublayer(M.getPaintProperty("fill-outline-color")?2:0,Bt.ReadOnly);sp(S,$,M,z,re,W,!0,V)}})(n,u,f,g,b):a.cg(f)?(function(S,$,M,z,F){const j=M.paint.get("fill-extrusion-opacity");if(j===0)return;const{isRenderingToTexture:B}=F;if(S.renderPass==="translucent"){const V=new Bt(S.context.gl.LEQUAL,Bt.ReadWrite,S.depthRangeFor3D);if(j!==1||M.paint.get("fill-extrusion-pattern").constantOr(1))cg(S,$,M,z,V,ci.disabled,Ni.disabled,B),cg(S,$,M,z,V,S.stencilModeFor3D(),S.colorModeForRenderPass(),B);else{const W=S.colorModeForRenderPass();cg(S,$,M,z,V,ci.disabled,W,B)}}})(n,u,f,g,b):a.ch(f)?(function(S,$,M,z,F){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:j}=F,B=S.context,V=S.style.projection.useSubdivision,W=S.getDepthModeForSublayer(0,Bt.ReadOnly),te=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(ee,re,se,ce,oe,he,me){const ae=ee.context,we=ae.gl;for(const Oe of se){const Ee=re.getTile(Oe),$e=Ee.dem;if(!$e||!$e.data||!Ee.needsHillshadePrepare)continue;const ze=$e.dim,tt=$e.stride,st=$e.getPixels();if(ae.activeTexture.set(we.TEXTURE1),ae.pixelStoreUnpackPremultiplyAlpha.set(!1),Ee.demTexture=Ee.demTexture||ee.getTileTexture(tt),Ee.demTexture){const xt=Ee.demTexture;xt.update(st,{premultiply:!1}),xt.bind(we.NEAREST,we.CLAMP_TO_EDGE)}else Ee.demTexture=new a.T(ae,st,we.RGBA,{premultiply:!1}),Ee.demTexture.bind(we.NEAREST,we.CLAMP_TO_EDGE);ae.activeTexture.set(we.TEXTURE0);let He=Ee.fbo;if(!He){const xt=new a.T(ae,{width:ze,height:ze,data:null},we.RGBA);xt.bind(we.LINEAR,we.CLAMP_TO_EDGE),He=Ee.fbo=ae.createFramebuffer(ze,ze,!0,!1),He.colorAttachment.set(xt.texture)}ae.bindFramebuffer.set(He.framebuffer),ae.viewport.set([0,0,ze,ze]),ee.useProgram("hillshadePrepare").draw(ae,we.TRIANGLES,oe,he,me,kt.disabled,$v(Ee.tileID,$e),null,null,ce.id,ee.rasterBoundsBuffer,ee.quadTriangleIndexBuffer,ee.rasterBoundsSegments),Ee.needsHillshadePrepare=!1}})(S,$,z,M,W,ci.disabled,te),B.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(V){const[ee,re,se]=S.stencilConfigForOverlapTwoPass(z);Nl(S,$,M,se,ee,W,te,!1,j),Nl(S,$,M,se,re,W,te,!0,j)}else{const[ee,re]=S.getStencilConfigForOverlapAndUpdateStencilID(z);Nl(S,$,M,re,ee,W,te,!1,j)}})(n,u,f,g,b):a.ci(f)?(function(S,$,M,z,F){if(S.renderPass!=="translucent"||!z.length)return;const{isRenderingToTexture:j}=F,B=S.style.projection.useSubdivision,V=S.getDepthModeForSublayer(0,Bt.ReadOnly),W=S.colorModeForRenderPass();if(B){const[te,ee,re]=S.stencilConfigForOverlapTwoPass(z);ug(S,$,M,re,te,V,W,!1,j),ug(S,$,M,re,ee,V,W,!0,j)}else{const[te,ee]=S.getStencilConfigForOverlapAndUpdateStencilID(z);ug(S,$,M,ee,te,V,W,!1,j)}})(n,u,f,g,b):a.cj(f)?(function(S,$,M,z,F){if(S.renderPass!=="translucent"||M.paint.get("raster-opacity")===0||!z.length)return;const{isRenderingToTexture:j}=F,B=$.getSource(),V=S.style.projection.useSubdivision;if(B instanceof So)Bl(S,$,M,z,null,!1,!1,B.tileCoords,B.flippedWindingOrder,j);else if(V){const[W,te,ee]=S.stencilConfigForOverlapTwoPass(z);Bl(S,$,M,ee,W,!1,!0,op,!1,j),Bl(S,$,M,ee,te,!0,!0,op,!1,j)}else{const[W,te]=S.getStencilConfigForOverlapAndUpdateStencilID(z);Bl(S,$,M,te,W,!1,!0,op,!1,j)}})(n,u,f,g,b):a.ck(f)?(function(S,$,M,z,F){const j=M.paint.get("background-color"),B=M.paint.get("background-opacity");if(B===0)return;const{isRenderingToTexture:V}=F,W=S.context,te=W.gl,ee=S.style.projection,re=S.transform,se=re.tileSize,ce=M.paint.get("background-pattern");if(S.isPatternMissing(ce))return;const oe=!ce&&j.a===1&&B===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==oe)return;const he=ci.disabled,me=S.getDepthModeForSublayer(0,oe==="opaque"?Bt.ReadWrite:Bt.ReadOnly),ae=S.colorModeForRenderPass(),we=S.useProgram(ce?"backgroundPattern":"background"),Oe=z||Te(re,{tileSize:se,terrain:S.style.map.terrain});ce&&(W.activeTexture.set(te.TEXTURE0),S.imageManager.bind(S.context));const Ee=M.getCrossfadeParameters();for(const $e of Oe){const ze=re.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),tt=ce?zv(B,S,ce,{tileID:$e,tileSize:se},Ee):Dv(B,j),st=S.style.map.terrain&&S.style.map.terrain.getTerrainData($e),He=ee.getMeshFromTileID(W,$e.canonical,!1,!0,"raster");we.draw(W,te.TRIANGLES,me,he,ae,kt.backCCW,tt,st,ze,M.id,He.vertexBuffer,He.indexBuffer,He.segments)}})(n,0,f,g,b):a.cl(f)&&(function(S,$,M,z){const{isRenderingGlobe:F}=z,j=S.context,B=M.implementation,V=S.style.projection,W=S.transform,te=W.getProjectionDataForCustomLayer(F),ee={farZ:W.farZ,nearZ:W.nearZ,fov:W.fov*Math.PI/180,modelViewProjectionMatrix:W.modelViewProjectionMatrix,projectionMatrix:W.projectionMatrix,shaderData:{variantName:V.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${V.shaderPreludeCode.vertexSource}`,define:V.shaderDefine},defaultProjectionData:te},re=B.renderingMode?B.renderingMode:"2d";if(S.renderPass==="offscreen"){const se=B.prerender;se&&(S.setCustomLayerDefaults(),j.setColorMode(S.colorModeForRenderPass()),se.call(B,j.gl,ee),j.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),j.setColorMode(S.colorModeForRenderPass()),j.setStencilMode(ci.disabled);const se=re==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,Bt.ReadOnly);j.setDepthMode(se),B.render(j.gl,ee),j.setDirty(),S.setBaseState(),j.bindFramebuffer.set(null)}})(n,0,f,b))}saveTileTexture(n){const u=this._tileTextures[n.size[0]];u?u.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const u=this.imageManager.getPattern(n.from.toString()),f=this.imageManager.getPattern(n.to.toString());return!u||!f}useProgram(n,u,f=!1,g=[]){this.cache=this.cache||{};const b=!!this.style.map.terrain,S=this.style.projection,$=f?Ns.projectionMercator:S.shaderPreludeCode,M=f?Wo:S.shaderDefine,z=n+(u?u.cacheKey:"")+`/${f?Pl:S.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(b?"/terrain":"")+(g?`/${g.join("/")}`:"");return this.cache[z]||(this.cache[z]=new Zm(this.context,Ns[n],u,Qm[n],this._showOverdrawInspector,b,$,M,g)),this.cache[z]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:u}=this.context.gl;return this.width!==n||this.height!==u}}function jl(_,n){let u,f=!1,g=null,b=null;const S=()=>{g=null,f&&(_.apply(b,u),g=setTimeout(S,n),f=!1)};return(...$)=>(f=!0,b=this,u=$,g||S(),g)}class cp{constructor(n){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map((g=>g.split("="))).forEach((g=>{g[0]===this._hashName&&(f=g)})),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const f=u.join("/");let g=f;g.split("&").length>0&&(g=g.split("&")[0]),this._hashName&&(g=`${this._hashName}=${f}`);let b=window.location.hash.replace(g,"");b.startsWith("#&")?b=b.slice(0,1)+b.slice(2):b==="#"&&(b="");let S=window.location.href.replace(/(#.+)?$/,b);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=jl(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,g),S=Math.round(u.lng*b)/b,$=Math.round(u.lat*b)/b,M=this._map.getBearing(),z=this._map.getPitch();let F="";if(F+=n?`/${S}/${$}/${f}`:`${f}/${$}/${S}`,(M||z)&&(F+="/"+Math.round(10*M)/10),z&&(F+=`/${Math.round(z)}`),this._hashName){const j=this._hashName;let B=!1;const V=window.location.hash.slice(1).split("&").map((W=>{const te=W.split("=")[0];return te===j?(B=!0,`${te}=${F}`):W})).filter((W=>W));return B||V.push(`${j}=${F}`),`#${V.join("&")}`}return`#${F}`}_isValidHash(n){if(n.length<3||n.some(isNaN))return!1;try{new a.S(+n[2],+n[1])}catch{return!1}const u=+n[0],f=+(n[3]||0),g=+(n[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&f>=-180&&f<=180&&g>=this._map.getMinPitch()&&g<=this._map.getMaxPitch()}}const Jo={linearity:.3,easing:a.cm(0,0,.3,1)},fg=a.e({deceleration:2500,maxSpeed:1400},Jo),Xv=a.e({deceleration:20,maxSpeed:1400},Jo),Jv=a.e({deceleration:1e3,maxSpeed:360},Jo),Kv=a.e({deceleration:1e3,maxSpeed:90},Jo),Qv=a.e({deceleration:1e3,maxSpeed:360},Jo);class e_{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:L.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=L.now();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,u.roll+=b.rollDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(u.pan.mag()){const b=Nc(u.pan.mag(),f,a.e({},fg,n||{})),S=u.pan.mult(b.amount/u.pan.mag()),$=this._map.cameraHelper.handlePanInertia(S,this._map.transform);g.center=$.easingCenter,g.offset=$.easingOffset,Us(g,b)}if(u.zoom){const b=Nc(u.zoom,f,Xv);g.zoom=this._map.transform.zoom+b.amount,Us(g,b)}if(u.bearing){const b=Nc(u.bearing,f,Jv);g.bearing=this._map.transform.bearing+a.ah(b.amount,-179,179),Us(g,b)}if(u.pitch){const b=Nc(u.pitch,f,Kv);g.pitch=this._map.transform.pitch+b.amount,Us(g,b)}if(u.roll){const b=Nc(u.roll,f,Qv);g.roll=this._map.transform.roll+a.ah(b.amount,-179,179),Us(g,b)}if(g.zoom||g.bearing){const b=u.pinchAround===void 0?u.around:u.pinchAround;g.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),a.e(g,{noMoveStart:!0})}}function Us(_,n){(!_.duration||_.duration<n.duration)&&(_.duration=n.duration,_.easing=n.easing)}function Nc(_,n,u){const{maxSpeed:f,linearity:g,deceleration:b}=u,S=a.ah(_*g/(n/1e3),-f,f),$=Math.abs(S)/(b*g);return{easing:u.easing,duration:1e3*$,amount:S*($/2)}}class Nn extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f,g={}){f=f instanceof MouseEvent?f:new MouseEvent(n,f);const b=O.mousePos(u.getCanvas(),f),S=u.unproject(b);super(n,a.e({point:b,lngLat:S,originalEvent:f},g)),this._defaultPrevented=!1,this.target=u}}class Bc extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f){const g=n==="touchend"?f.changedTouches:f.touches,b=O.touchPos(u.getCanvasContainer(),g),S=b.map((M=>u.unproject(M))),$=b.reduce(((M,z,F,j)=>M.add(z.div(j.length))),new a.P(0,0));super(n,{points:b,point:$,lngLats:S,lngLat:u.unproject($),originalEvent:f}),this._defaultPrevented=!1}}class mg extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,f){super(n,{originalEvent:f}),this._defaultPrevented=!1}}class t_{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new mg(n.type,this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new Nn(n.type,this._map,n))}mouseup(n){this._map.fire(new Nn(n.type,this._map,n))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Nn(n.type,this._map,n))}dblclick(n){return this._firePreventable(new Nn(n.type,this._map,n))}mouseover(n){this._map.fire(new Nn(n.type,this._map,n))}mouseout(n){this._map.fire(new Nn(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Bc(n.type,this._map,n))}touchmove(n){this._map.fire(new Bc(n.type,this._map,n))}touchend(n){this._map.fire(new Bc(n.type,this._map,n))}touchcancel(n){this._map.fire(new Bc(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class i_{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Nn(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Nn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new Nn(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jc{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.screenPointToLocation(a.P.convert(n),this._map.terrain)}}class gg{constructor(n,u){this._map=n,this._tr=new jc(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(O.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=f,this._box||(this._box=O.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const b=Math.min(g.x,f.x),S=Math.max(g.x,f.x),$=Math.min(g.y,f.y),M=Math.max(g.y,f.y);O.setTransform(this._box,`translate(${b}px,${$}px)`),this._box.style.width=S-b+"px",this._box.style.height=M-$+"px"}mouseupWindow(n,u){if(!this._active||n.button!==0)return;const f=this._startPos,g=u;if(this.reset(),O.suppressClick(),f.x!==g.x||f.y!==g.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:n})),{cameraAnimation:b=>b.fitScreenCoordinates(f,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(O.remove(this._box),this._box=null),O.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new a.l(n,{originalEvent:u}))}}function Uc(_,n){if(_.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${n.length}`);const u={};for(let f=0;f<_.length;f++)u[_[f].identifier]=n[f];return u}class r_{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),f.length===this.numTouches&&(this.centroid=(function(g){const b=new a.P(0,0);for(const S of g)b._add(S);return b.div(g.length)})(u),this.touches=Uc(f,u)))}touchmove(n,u,f){if(this.aborted||!this.centroid)return;const g=Uc(f,u);for(const b in this.touches){const S=g[b];(!S||S.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(n,u,f){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Bn{constructor(n){this.singleTap=new r_(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,u,f){this.singleTap.touchstart(n,u,f)}touchmove(n,u,f){this.singleTap.touchmove(n,u,f)}touchend(n,u,f){const g=this.singleTap.touchend(n,u,f);if(g){const b=n.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(g)<30;if(b&&S||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Vs{constructor(n){this._tr=new jc(n),this._zoomIn=new Bn({numTouches:1,numTaps:2}),this._zoomOut=new Bn({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,f){this._zoomIn.touchstart(n,u,f),this._zoomOut.touchstart(n,u,f)}touchmove(n,u,f){this._zoomIn.touchmove(n,u,f),this._zoomOut.touchmove(n,u,f)}touchend(n,u,f){const g=this._zoomIn.touchend(n,u,f),b=this._zoomOut.touchend(n,u,f),S=this._tr;return g?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(g)},{originalEvent:n})}):b?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(b)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vc{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const u=this._moveFunction(...n);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(n,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,u){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const g=Array.isArray(u)?u[0]:u;return!this._moved&&g.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(f,g))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&O.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Gs=0,Gc=2,b2={[Gs]:1,[Gc]:2};class yh{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const u=O.mouseButton(n);this._eventButton=u}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!(function(u,f){const g=b2[f];return u.buttons===void 0||(u.buttons&g)!==g})(n,this._eventButton)}isValidEndEvent(n){return O.mouseButton(n)===this._eventButton}}class x2{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}class w2{constructor(n=new yh({checkCorrectEvent:()=>!0}),u=new x2){this.mouseMoveStateManager=n,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(n,u,f){return n instanceof MouseEvent?u(n):typeof TouchEvent<"u"&&n instanceof TouchEvent?f(n):void 0}startMove(n){this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.startMove(u)),(u=>this.oneFingerTouchMoveStateManager.startMove(u)))}endMove(n){this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.endMove(u)),(u=>this.oneFingerTouchMoveStateManager.endMove(u)))}isValidStartEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidStartEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u)))}isValidMoveEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidMoveEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u)))}isValidEndEvent(n){return this._executeRelevantHandler(n,(u=>this.mouseMoveStateManager.isValidEndEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u)))}}const vh=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=n=>{n.preventDefault()}};class _h{constructor(n,u){this._clickTolerance=n.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,u,f){return this._calculateTransform(n,u,f)}touchmove(n,u,f){if(this._active){if(!this._shouldBePrevented(f.length))return n.preventDefault(),this._calculateTransform(n,u,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,u,f){this._calculateTransform(n,u,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,f){f.length>0&&(this._active=!0);const g=Uc(f,u),b=new a.P(0,0),S=new a.P(0,0);let $=0;for(const z in g){const F=g[z],j=this._touches[z];j&&(b._add(F),S._add(F.sub(j)),$++,g[z]=F)}if(this._touches=g,this._shouldBePrevented($)||!S.mag())return;const M=S.div($);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div($),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qs{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,f){if(!this._firstTwoTouches)return;n.preventDefault();const[g,b]=this._firstTwoTouches,S=mt(f,u,g),$=mt(f,u,b);if(!S||!$)return;const M=this._aroundCenter?null:S.add($).div(2);return this._move([S,$],M,n)}touchend(n,u,f){if(!this._firstTwoTouches)return;const[g,b]=this._firstTwoTouches,S=mt(f,u,g),$=mt(f,u,b);S&&$||(this._active&&O.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function mt(_,n,u){for(let f=0;f<_.length;f++)if(_[f].identifier===u)return n[f]}function yg(_,n){return Math.log(_/n)/Math.LN2}class up extends qs{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const f=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(yg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:yg(this._distance,f),pinchAround:u}}}function vg(_,n){return 180*_.angleWith(n)/Math.PI}class qc extends qs{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u,f){const g=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:vg(this._vector,g),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,f=vg(n,this._startVector);return Math.abs(f)<u}}function Ul(_){return Math.abs(_.y)>Math.abs(_.x)}class hp extends qs{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,u,f){super.touchstart(n,u,f),this._currentTouchCount=f.length}_start(n){this._lastPoints=n,Ul(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=n[0].sub(this._lastPoints[0]),b=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,b,f.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(g.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(n,u,f){if(this._valid!==void 0)return this._valid;const g=n.mag()>=2,b=u.mag()>=2;if(!g&&!b)return;if(!g||!b)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const S=n.y>0==u.y>0;return Ul(n)&&Ul(u)&&S}}const ni={panStep:100,bearingStep:15,pitchStep:10};class dp{constructor(n){this._tr=new jc(n);const u=ni;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,f=0,g=0,b=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?f=-1:(n.preventDefault(),b=-1);break;case 39:n.shiftKey?f=1:(n.preventDefault(),b=1);break;case 38:n.shiftKey?g=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?g=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:$=>{const M=this._tr;$.easeTo({duration:300,easeId:"keyboardHandler",easing:S2,zoom:u?Math.round(M.zoom)+u*(n.shiftKey?2:1):M.zoom,bearing:M.bearing+f*this._bearingStep,pitch:M.pitch+g*this._pitchStep,offset:[-b*this._panStep,-S*this._panStep],center:M.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function S2(_){return _*(2-_)}const pp=4.000244140625,T2=1/450;class n_{constructor(n,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=n,this._tr=new jc(n),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=T2}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const f=L.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,u!==0&&u%pp==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(g*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=O.mousePos(this._map.getCanvas(),n),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(a.S.convert(f.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const $=n.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=$),typeof this._targetZoom=="number"&&(this._targetZoom+=$)}if(this._delta!==0){const $=this._type==="wheel"&&Math.abs(this._delta)>pp?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*$)));this._delta<0&&M!==0&&(M=1/M);const z=typeof this._targetZoom!="number"?n.scale:a.af(this._targetZoom);this._targetZoom=n.getConstrained(n.getCameraLngLat(),a.ak(z*M)).zoom,this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?n.zoom:this._targetZoom,f=this._startZoom,g=this._easing;let b,S=!1;if(this._type==="wheel"&&f&&g){const $=L.now()-this._lastWheelEventTime,M=Math.min(($+5)/200,1),z=g(M);b=a.C.number(f,u,z),M<1?this._frameId||(this._frameId=!0):S=!0}else b=u,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=b,{noInertia:!0,needsRenderFrame:!S,zoomDelta:b-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=a.co;if(this._prevEase){const f=this._prevEase,g=(L.now()-f.start)/f.duration,b=f.easing(g+.01)-f.easing(g),S=.27/Math.sqrt(b*b+1e-4)*.01,$=Math.sqrt(.0729-S*S);u=a.cm(S,$,.25,1)}return this._prevEase={start:L.now(),duration:n,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class _g{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class bg{constructor(n){this._tr=new jc(n),this.reset()}reset(){this._active=!1}dblclick(n,u){return n.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class s_{constructor(){this._tap=new Bn({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,u,f){if(!this._swipePoint)if(this._tapTime){const g=u[0],b=n.timeStamp-this._tapTime<500,S=this._tapPoint.dist(g)<30;b&&S?f.length>0&&(this._swipePoint=g,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(n,u,f)}touchmove(n,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=u[0],b=g.y-this._swipePoint.y;return this._swipePoint=g,n.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(n,u,f)}touchend(n,u,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const g=this._tap.touchend(n,u,f);g&&(this._tapTime=n.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class o_{constructor(n,u,f){this._el=n,this._mousePan=u,this._touchPan=f}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xg{constructor(n,u,f,g){this._pitchWithRotate=n.pitchWithRotate,this._rollEnabled=n.rollEnabled,this._mouseRotate=u,this._mousePitch=f,this._mouseRoll=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class a_{constructor(n,u,f,g){this._el=n,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class l_{constructor(n,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=O.create("div","maplibregl-cooperative-gesture-screen",n);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=u,this._container.appendChild(g);const b=document.createElement("div");b.className="maplibregl-mobile-message",b.textContent=f,this._container.appendChild(b),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(O.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,u){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:n,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Hs=_=>_.zoom||_.drag||_.roll||_.pitch||_.rotate;class ki extends a.l{}function Hc(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta||_.rollDelta}class wg{constructor(n,u){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,b)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=g.type==="renderFrame"?void 0:g,$={needsRenderFrame:!1},M={},z={};for(const{handlerName:B,handler:V,allowed:W}of this._handlers){if(!V.isEnabled())continue;let te;if(this._blockedByActive(z,W,B))V.reset();else if(V[b||g.type]){if(a.cp(g,b||g.type)){const ee=O.mousePos(this._map.getCanvas(),g);te=V[b||g.type](g,ee)}else if(a.cq(g,b||g.type)){const ee=this._getMapTouches(g.touches),re=O.touchPos(this._map.getCanvas(),ee);te=V[b||g.type](g,re,ee)}else a.cr(b||g.type)||(te=V[b||g.type](g));this.mergeHandlerResult($,M,te,B,S),te&&te.needsRenderFrame&&this._triggerRenderFrame()}(te||V.isActive())&&(z[B]=V)}const F={};for(const B in this._previousActiveHandlers)z[B]||(F[B]=S);this._previousActiveHandlers=z,(Object.keys(F).length||Hc($))&&(this._changes.push([$,M,F]),this._triggerRenderFrame()),(Object.keys(z).length||Hc($))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=$;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new e_(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,b,S]of this._listeners)O.addEventListener(g,b,g===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[n,u,f]of this._listeners)O.removeEventListener(n,u,n===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(n){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new t_(u,n));const g=u.boxZoom=new gg(u,n);this._add("boxZoom",g),n.interactive&&n.boxZoom&&g.enable();const b=u.cooperativeGestures=new l_(u,n.cooperativeGestures);this._add("cooperativeGestures",b),n.cooperativeGestures&&b.enable();const S=new Vs(u),$=new bg(u);u.doubleClickZoom=new _g($,S),this._add("tapZoom",S),this._add("clickZoom",$),n.interactive&&n.doubleClickZoom&&u.doubleClickZoom.enable();const M=new s_;this._add("tapDragZoom",M);const z=u.touchPitch=new hp(u);this._add("touchPitch",z),n.interactive&&n.touchPitch&&u.touchPitch.enable(n.touchPitch);const F=()=>u.project(u.getCenter()),j=(function({enable:oe,clickTolerance:he,aroundCenter:me=!0,minPixelCenterThreshold:ae=100,rotateDegreesPerPixelMoved:we=.8},Oe){const Ee=new yh({checkCorrectEvent:$e=>O.mouseButton($e)===0&&$e.ctrlKey||O.mouseButton($e)===2&&!$e.ctrlKey});return new Vc({clickTolerance:he,move:($e,ze)=>{const tt=Oe();if(me&&Math.abs(tt.y-$e.y)>ae)return{bearingDelta:a.cn(new a.P($e.x,ze.y),ze,tt)};let st=(ze.x-$e.x)*we;return me&&ze.y<tt.y&&(st=-st),{bearingDelta:st}},moveStateManager:Ee,enable:oe,assignEvents:vh})})(n,F),B=(function({enable:oe,clickTolerance:he,pitchDegreesPerPixelMoved:me=-.5}){const ae=new yh({checkCorrectEvent:we=>O.mouseButton(we)===0&&we.ctrlKey||O.mouseButton(we)===2});return new Vc({clickTolerance:he,move:(we,Oe)=>({pitchDelta:(Oe.y-we.y)*me}),moveStateManager:ae,enable:oe,assignEvents:vh})})(n),V=(function({enable:oe,clickTolerance:he,rollDegreesPerPixelMoved:me=.3},ae){const we=new yh({checkCorrectEvent:Oe=>O.mouseButton(Oe)===2&&Oe.ctrlKey});return new Vc({clickTolerance:he,move:(Oe,Ee)=>{const $e=ae();let ze=(Ee.x-Oe.x)*me;return Ee.y<$e.y&&(ze=-ze),{rollDelta:ze}},moveStateManager:we,enable:oe,assignEvents:vh})})(n,F);u.dragRotate=new xg(n,j,B,V),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",B,["mouseRotate","mouseRoll"]),this._add("mouseRoll",V,["mousePitch"]),n.interactive&&n.dragRotate&&u.dragRotate.enable();const W=(function({enable:oe,clickTolerance:he}){const me=new yh({checkCorrectEvent:ae=>O.mouseButton(ae)===0&&!ae.ctrlKey});return new Vc({clickTolerance:he,move:(ae,we)=>({around:we,panDelta:we.sub(ae)}),activateOnStart:!0,moveStateManager:me,enable:oe,assignEvents:vh})})(n),te=new _h(n,u);u.dragPan=new o_(f,W,te),this._add("mousePan",W),this._add("touchPan",te,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&u.dragPan.enable(n.dragPan);const ee=new qc,re=new up;u.touchZoomRotate=new a_(f,re,ee,M),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&u.touchZoomRotate.enable(n.touchZoomRotate);const se=u.scrollZoom=new n_(u,(()=>this._triggerRenderFrame()));this._add("scrollZoom",se,["mousePan"]),n.interactive&&n.scrollZoom&&u.scrollZoom.enable(n.scrollZoom);const ce=u.keyboard=new dp(u);this._add("keyboard",ce),n.interactive&&n.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new i_(u))}_add(n,u,f){this._handlers.push({handlerName:n,handler:u,allowed:f}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hs(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,u,f){for(const g in n)if(g!==f&&(!u||u.indexOf(g)<0))return!0;return!1}_getMapTouches(n){const u=[];for(const f of n)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(n,u,f,g,b){if(!f)return;a.e(n,f);const S={handlerName:g,originalEvent:f.originalEvent||b};f.zoomDelta!==void 0&&(u.zoom=S),f.panDelta!==void 0&&(u.drag=S),f.rollDelta!==void 0&&(u.roll=S),f.pitchDelta!==void 0&&(u.pitch=S),f.bearingDelta!==void 0&&(u.rotate=S)}_applyChanges(){const n={},u={},f={};for(const[g,b,S]of this._changes)g.panDelta&&(n.panDelta=(n.panDelta||new a.P(0,0))._add(g.panDelta)),g.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+g.pitchDelta),g.rollDelta&&(n.rollDelta=(n.rollDelta||0)+g.rollDelta),g.around!==void 0&&(n.around=g.around),g.pinchAround!==void 0&&(n.pinchAround=g.pinchAround),g.noInertia&&(n.noInertia=g.noInertia),a.e(u,b),a.e(f,S);this._updateMapTransform(n,u,f),this._changes=[]}_updateMapTransform(n,u,f){const g=this._map,b=g._getTransformForUpdate(),S=g.terrain;if(!(Hc(n)||S&&this._terrainMovement))return this._fireEvents(u,f,!0);g._stop(!0);let{panDelta:$,zoomDelta:M,bearingDelta:z,pitchDelta:F,rollDelta:j,around:B,pinchAround:V}=n;V!==void 0&&(B=V),B=B||g.transform.centerPoint,S&&!b.isPointOnMapSurface(B)&&(B=b.centerPoint);const W={panDelta:$,zoomDelta:M,rollDelta:j,pitchDelta:F,bearingDelta:z,around:B};this._map.cameraHelper.useGlobeControls&&!b.isPointOnMapSurface(B)&&(B=b.centerPoint);const te=B.distSqr(b.centerPoint)<.01?b.center:b.screenPointToLocation($?B.sub($):B);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,b),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?b.setCenter(b.screenPointToLocation(b.centerPoint.sub($))):this._map.cameraHelper.handleMapControlsPan(W,b,te):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(W,b,te))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,b),this._map.cameraHelper.handleMapControlsPan(W,b,te)),g._applyUpdatedTransform(b),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,f,!0)}_fireEvents(n,u,f){const g=Hs(this._eventsInProgress),b=Hs(n),S={};for(const j in n){const{originalEvent:B}=n[j];this._eventsInProgress[j]||(S[`${j}start`]=B),this._eventsInProgress[j]=n[j]}!g&&b&&this._fireEvent("movestart",b.originalEvent);for(const j in S)this._fireEvent(j,S[j]);b&&this._fireEvent("move",b.originalEvent);for(const j in n){const{originalEvent:B}=n[j];this._fireEvent(j,B)}const $={};let M;for(const j in this._eventsInProgress){const{handlerName:B,originalEvent:V}=this._eventsInProgress[j];this._handlersById[B].isActive()||(delete this._eventsInProgress[j],M=u[B]||V,$[`${j}end`]=M)}for(const j in $)this._fireEvent(j,$[j]);const z=Hs(this._eventsInProgress),F=(g||b)&&!z;if(F&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const j=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&j.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(j)}if(f&&F){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=V=>V!==0&&-this._bearingSnap<V&&V<this._bearingSnap;!j||!j.essential&&L.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:M})),B(this._map.getBearing())&&this._map.resetNorth()):(B(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new a.l(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((n=>{delete this._frameId,this.handleEvent(new ki("renderFrame",{timeStamp:n})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class c_ extends a.E{constructor(n,u,f){super(),this._renderFrameCallback=()=>{const g=Math.min((L.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=f.bearingSnap,this.cameraHelper=u,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(n,u){n.apply(this.transform),this.transform=n,this.cameraHelper=u}getCenter(){return new a.S(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(n,u){return this.jumpTo({elevation:n},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(n){this._centerClampedToGround=n}panBy(n,u,f){return n=a.P.convert(n).mult(-1),this.panTo(this.transform.center,a.e({offset:n},u),f)}panTo(n,u,f){return this.easeTo(a.e({center:n},u),f)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,f){return this.easeTo(a.e({zoom:n},u),f)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(n,u){return n!=this.transform.fov&&(this.transform.setFov(n),this.fire(new a.l("movestart",u)).fire(new a.l("move",u)).fire(new a.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,f){return this.easeTo(a.e({bearing:n},u),f)}resetNorth(n,u){return this.rotateTo(0,a.e({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}getRoll(){return this.transform.roll}setRoll(n,u){return this.jumpTo({roll:n},u),this}cameraForBounds(n,u){n=er.convert(n).adjustAntiMeridian();const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),f,u)}_cameraForBoxAndBearing(n,u,f,g){const b={top:0,bottom:0,right:0,left:0};if(typeof(g=a.e({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const z=g.padding;g.padding={top:z,bottom:z,right:z,left:z}}const S=a.e(b,g.padding);g.padding=S;const $=this.transform,M=new er(n,u);return this.cameraHelper.cameraForBoxAndBearing(g,S,M,f,$)}fitBounds(n,u,f){return this._fitInternal(this.cameraForBounds(n,u),u,f)}fitScreenCoordinates(n,u,f,g,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(n)),this.transform.screenPointToLocation(a.P.convert(u)),f,g),g,b)}_fitInternal(n,u,f){return n?(delete(u=a.e(n,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(n,u){this.stop();const f=this._getTransformForUpdate();let g=!1,b=!1,S=!1;const $=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,n);const M=f.zoom!==$;return"elevation"in n&&f.elevation!==+n.elevation&&f.setElevation(+n.elevation),"bearing"in n&&f.bearing!==+n.bearing&&(g=!0,f.setBearing(+n.bearing)),"pitch"in n&&f.pitch!==+n.pitch&&(b=!0,f.setPitch(+n.pitch)),"roll"in n&&f.roll!==+n.roll&&(S=!0,f.setRoll(+n.roll)),n.padding==null||f.isPaddingEqual(n.padding)||f.setPadding(n.padding),this._applyUpdatedTransform(f),this.fire(new a.l("movestart",u)).fire(new a.l("move",u)),M&&this.fire(new a.l("zoomstart",u)).fire(new a.l("zoom",u)).fire(new a.l("zoomend",u)),g&&this.fire(new a.l("rotatestart",u)).fire(new a.l("rotate",u)).fire(new a.l("rotateend",u)),b&&this.fire(new a.l("pitchstart",u)).fire(new a.l("pitch",u)).fire(new a.l("pitchend",u)),S&&this.fire(new a.l("rollstart",u)).fire(new a.l("roll",u)).fire(new a.l("rollend",u)),this.fire(new a.l("moveend",u))}calculateCameraOptionsFromTo(n,u,f,g=0){const b=a.a1.fromLngLat(n,u),S=a.a1.fromLngLat(f,g),$=S.x-b.x,M=S.y-b.y,z=S.z-b.z,F=Math.hypot($,M,z);if(F===0)throw new Error("Can't calculate camera options with same From and To");const j=Math.hypot($,M),B=a.ak(this.transform.cameraToCenterDistance/F/this.transform.tileSize),V=180*Math.atan2($,-M)/Math.PI;let W=180*Math.acos(j/F)/Math.PI;return W=z<0?90-W:90+W,{center:S.toLngLat(),elevation:g,zoom:B,pitch:W,bearing:V}}calculateCameraOptionsFromCameraLngLatAltRotation(n,u,f,g,b){const S=this.transform.calculateCenterFromCameraLngLatAlt(n,u,f,g);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:f,pitch:g,roll:b}}easeTo(n,u){this._stop(!1,n.easeId),((n=a.e({offset:[0,0],duration:500,easing:a.co},n)).animate===!1||!n.essential&&L.prefersReducedMotion)&&(n.duration=0);const f=this._getTransformForUpdate(),g=this.getBearing(),b=f.pitch,S=f.roll,$="bearing"in n?this._normalizeBearing(n.bearing,g):g,M="pitch"in n?+n.pitch:b,z="roll"in n?this._normalizeBearing(n.roll,S):S,F="padding"in n?n.padding:f.padding,j=a.P.convert(n.offset);let B,V;n.around&&(B=a.S.convert(n.around),V=f.locationToScreenPoint(B));const W={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},te=this.cameraHelper.handleEaseTo(f,{bearing:$,pitch:M,roll:z,padding:F,around:B,aroundPoint:V,offsetAsPoint:j,offset:n.offset,zoom:n.zoom,center:n.center});return this._rotating=this._rotating||g!==$,this._pitching=this._pitching||M!==b,this._rolling=this._rolling||z!==S,this._padding=!f.isPaddingEqual(F),this._zooming=this._zooming||te.isZooming,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,W),this.terrain&&this._prepareElevation(te.elevationCenter),this._ease((ee=>{te.easeFunc(ee),this.terrain&&!n.freezeElevation&&this._updateElevation(ee),this._applyUpdatedTransform(f),this._fireMoveEvents(u)}),(ee=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u,ee)}),n),this}_prepareEase(n,u,f={}){this._moving=!0,u||f.moving||this.fire(new a.l("movestart",n)),this._zooming&&!f.zooming&&this.fire(new a.l("zoomstart",n)),this._rotating&&!f.rotating&&this.fire(new a.l("rotatestart",n)),this._pitching&&!f.pitching&&this.fire(new a.l("pitchstart",n)),this._rolling&&!f.rolling&&this.fire(new a.l("rollstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&u!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(f-(u-(f*n+this._elevationStart))/(1-n)),this._elevationTarget=u}this.transform.setElevation(a.C.number(this._elevationStart,this._elevationTarget,n))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){if(!this.terrain&&n.elevation>=0&&n.pitch<=90)return{};const u=n.getCameraLngLat(),f=n.getCameraAltitude(),g=this.terrain?this.terrain.getElevationForLngLatZoom(u,n.zoom):0;if(f<g){const b=this.calculateCameraOptionsFromTo(u,g,n.center,n.elevation);return{pitch:b.pitch,zoom:b.zoom}}return{}}_applyUpdatedTransform(n){const u=[];if(u.push((g=>this._elevateCameraIfInsideTerrain(g))),this.transformCameraUpdate&&u.push((g=>this.transformCameraUpdate(g))),!u.length)return;const f=n.clone();for(const g of u){const b=f.clone(),{center:S,zoom:$,roll:M,pitch:z,bearing:F,elevation:j}=g(b);S&&b.setCenter(S),j!==void 0&&b.setElevation(j),$!==void 0&&b.setZoom($),M!==void 0&&b.setRoll(M),z!==void 0&&b.setPitch(z),F!==void 0&&b.setBearing(F),f.apply(b)}this.transform.apply(f)}_fireMoveEvents(n){this.fire(new a.l("move",n)),this._zooming&&this.fire(new a.l("zoom",n)),this._rotating&&this.fire(new a.l("rotate",n)),this._pitching&&this.fire(new a.l("pitch",n)),this._rolling&&this.fire(new a.l("roll",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const f=this._zooming,g=this._rotating,b=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new a.l("zoomend",n)),g&&this.fire(new a.l("rotateend",n)),b&&this.fire(new a.l("pitchend",n)),S&&this.fire(new a.l("rollend",n)),this.fire(new a.l("moveend",n))}flyTo(n,u){if(!n.essential&&L.prefersReducedMotion){const ze=a.Q(n,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(ze,u)}this.stop(),n=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.co},n);const f=this._getTransformForUpdate(),g=f.bearing,b=f.pitch,S=f.roll,$=f.padding,M="bearing"in n?this._normalizeBearing(n.bearing,g):g,z="pitch"in n?+n.pitch:b,F="roll"in n?this._normalizeBearing(n.roll,S):S,j="padding"in n?n.padding:f.padding,B=a.P.convert(n.offset);let V=f.centerPoint.add(B);const W=f.screenPointToLocation(V),te=this.cameraHelper.handleFlyTo(f,{bearing:M,pitch:z,roll:F,padding:j,locationAtOffset:W,offsetAsPoint:B,center:n.center,minZoom:n.minZoom,zoom:n.zoom});let ee=n.curve;const re=Math.max(f.width,f.height),se=re/te.scaleOfZoom,ce=te.pixelPathLength;typeof te.scaleOfMinZoom=="number"&&(ee=Math.sqrt(re/te.scaleOfMinZoom/ce*2));const oe=ee*ee;function he(ze){const tt=(se*se-re*re+(ze?-1:1)*oe*oe*ce*ce)/(2*(ze?se:re)*oe*ce);return Math.log(Math.sqrt(tt*tt+1)-tt)}function me(ze){return(Math.exp(ze)-Math.exp(-ze))/2}function ae(ze){return(Math.exp(ze)+Math.exp(-ze))/2}const we=he(!1);let Oe=function(ze){return ae(we)/ae(we+ee*ze)},Ee=function(ze){return re*((ae(we)*(me(tt=we+ee*ze)/ae(tt))-me(we))/oe)/ce;var tt},$e=(he(!0)-we)/ee;if(Math.abs(ce)<2e-6||!isFinite($e)){if(Math.abs(re-se)<1e-6)return this.easeTo(n,u);const ze=se<re?-1:1;$e=Math.abs(Math.log(se/re))/ee,Ee=()=>0,Oe=tt=>Math.exp(ze*ee*tt)}return n.duration="duration"in n?+n.duration:1e3*$e/("screenSpeed"in n?+n.screenSpeed/ee:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=g!==M,this._pitching=z!==b,this._rolling=F!==S,this._padding=!f.isPaddingEqual(j),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(te.targetCenter),this._ease((ze=>{const tt=ze*$e,st=1/Oe(tt),He=Ee(tt);this._rotating&&f.setBearing(a.C.number(g,M,ze)),this._pitching&&f.setPitch(a.C.number(b,z,ze)),this._rolling&&f.setRoll(a.C.number(S,F,ze)),this._padding&&(f.interpolatePadding($,j,ze),V=f.centerPoint.add(B)),te.easeFunc(ze,st,He,V),this.terrain&&!n.freezeElevation&&this._updateElevation(ze),this._applyUpdatedTransform(f),this._fireMoveEvents(u)}),(()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(u)}),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,u){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,u)}return n||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(n,u,f){f.animate===!1||f.duration===0?(n(1),u()):(this._easeStart=L.now(),this._easeOptions=f,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,u){n=a.aO(n,-180,180);const f=Math.abs(n-u);return Math.abs(n-360-u)<f&&(n-=360),Math.abs(n+360-u)<f&&(n+=360),n}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(a.S.convert(n),this.transform.tileZoom):null}}const Sg={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Tg{constructor(n=Sg){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=O.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=O.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=O.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){O.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,u){const f=this._map._getUIString(`AttributionControl.${u}`);n.title=f,n.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map((g=>typeof g!="string"?"":g))):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const u=this._map.style.sourceCaches;for(const g in u){const b=u[g];if(b.used||b.usedForTerrain){const S=b.getSource();S.attribution&&n.indexOf(S.attribution)<0&&n.push(S.attribution)}}n=n.filter((g=>String(g).trim())),n.sort(((g,b)=>g.length-b.length)),n=n.filter(((g,b)=>{for(let S=b+1;S<n.length;S++)if(n[S].indexOf(g)>=0)return!1;return!0}));const f=n.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,n.length?(this._innerContainer.innerHTML=O.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class u_{constructor(n={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=O.create("div","maplibregl-ctrl");const u=O.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){O.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Po{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const g of f)if(g.id===n)return void(g.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var fp=a.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Tt extends a.E{constructor(n){super(),this._lastTilesetChange=L.now(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=n._source.tileSize*2**this.deltaZoom,n.usedForTerrain=!0,n.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,u){this.sourceCache.update(n,u),this._renderableTilesKeys=[];const f={};for(const g of Te(n,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.terrainRttPosMatrix32f=new Float64Array(16),a.bY(g.terrainRttPosMatrix32f,0,a.$,a.$,0,0,1),this._tiles[g.key]=new Ic(g,this.tileSize),this._lastTilesetChange=L.now());for(const g in this._tiles)f[g]||delete this._tiles[g]}freeRtt(n){for(const u in this._tiles){const f=this._tiles[u];(!n||f.tileID.equals(n)||f.tileID.isChildOf(n)||n.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((n=>this.getTileByID(n)))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n,u){return u?this._getTerrainCoordsForTileRanges(n,u):this._getTerrainCoordsForRegularTile(n)}_getTerrainCoordsForRegularTile(n){const u={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID,b=n.clone(),S=a.ba();if(g.canonical.equals(n.canonical))a.bY(S,0,a.$,a.$,0,0,1);else if(g.canonical.isChildOf(n.canonical)){const $=g.canonical.z-n.canonical.z,M=g.canonical.x-(g.canonical.x>>$<<$),z=g.canonical.y-(g.canonical.y>>$<<$),F=a.$>>$;a.bY(S,0,F,F,0,0,1),a.M(S,S,[-M*F,-z*F,0])}else{if(!n.canonical.isChildOf(g.canonical))continue;{const $=n.canonical.z-g.canonical.z,M=n.canonical.x-(n.canonical.x>>$<<$),z=n.canonical.y-(n.canonical.y>>$<<$),F=a.$>>$;a.bY(S,0,a.$,a.$,0,0,1),a.M(S,S,[M*F,z*F,0]),a.N(S,S,[1/2**$,1/2**$,0])}}b.terrainRttPosMatrix32f=new Float32Array(S),u[f]=b}return u}_getTerrainCoordsForTileRanges(n,u){const f={};for(const g of this._renderableTilesKeys){const b=this._tiles[g].tileID;if(!this._isWithinTileRanges(b,u))continue;const S=n.clone(),$=a.ba();if(b.canonical.z===n.canonical.z){const M=n.canonical.x-b.canonical.x,z=n.canonical.y-b.canonical.y;a.bY($,0,a.$,a.$,0,0,1),a.M($,$,[M*a.$,z*a.$,0])}else if(b.canonical.z>n.canonical.z){const M=b.canonical.z-n.canonical.z,z=b.canonical.x-(b.canonical.x>>M<<M),F=b.canonical.y-(b.canonical.y>>M<<M),j=n.canonical.x-(b.canonical.x>>M),B=n.canonical.y-(b.canonical.y>>M),V=a.$>>M;a.bY($,0,V,V,0,0,1),a.M($,$,[-z*V+j*a.$,-F*V+B*a.$,0])}else{const M=n.canonical.z-b.canonical.z,z=n.canonical.x-(n.canonical.x>>M<<M),F=n.canonical.y-(n.canonical.y>>M<<M),j=(n.canonical.x>>M)-b.canonical.x,B=(n.canonical.y>>M)-b.canonical.y,V=a.$<<M;a.bY($,0,V,V,0,0,1),a.M($,$,[z*a.$+j*V,F*a.$+B*V,0])}S.terrainRttPosMatrix32f=new Float32Array($),f[g]=S}return f}getSourceTile(n,u){const f=this.sourceCache._source;let g=n.overscaledZ-this.deltaZoom;if(g>f.maxzoom&&(g=f.maxzoom),g<f.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(g).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!b||!b.dem)&&u)for(;g>=f.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(n.scaledTo(g--).key);return b}anyTilesAfterTime(n=Date.now()){return this._lastTilesetChange>=n}_isWithinTileRanges(n,u){return u[n.canonical.z]&&n.canonical.x>=u[n.canonical.z].minTileX&&n.canonical.x<=u[n.canonical.z].maxTileX&&n.canonical.y>=u[n.canonical.z].minTileY&&n.canonical.y<=u[n.canonical.z].maxTileY}}class Mt{constructor(n,u,f){this._meshCache={},this.painter=n,this.sourceCache=new Tt(u),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,u,f,g=a.$){var b;if(!(u>=0&&u<g&&f>=0&&f<g))return 0;const S=this.getTerrainData(n),$=(b=S.tile)===null||b===void 0?void 0:b.dem;if(!$)return 0;const M=a.cs([],[u/g*a.$,f/g*a.$],S.u_terrain_matrix),z=[M[0]*$.dim,M[1]*$.dim],F=Math.floor(z[0]),j=Math.floor(z[1]),B=z[0]-F,V=z[1]-j;return $.get(F,j)*(1-B)*(1-V)+$.get(F+1,j)*B*(1-V)+$.get(F,j+1)*(1-B)*V+$.get(F+1,j+1)*B*V}getElevationForLngLatZoom(n,u){if(!a.ct(u,n.wrap()))return 0;const{tileID:f,mercatorX:g,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(n,u);return this.getElevation(f,g%a.$,b%a.$,a.$)}getElevation(n,u,f,g=a.$){return this.getDEMElevation(n,u,f,g)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const g=this.painter.context,b=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new a.T(g,b,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new a.T(g,new a.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ag([])}const u=this.sourceCache.getSourceTile(n,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const g=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new a.T(g,u.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),u.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+n.key;if(f&&!this._demMatrixCache[f]){const g=this.sourceCache.sourceCache._source.maxzoom;let b=n.canonical.z-u.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=g?b=n.canonical.z-g:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=n.canonical.x-(n.canonical.x>>b<<b),$=n.canonical.y-(n.canonical.y>>b<<b),M=a.cu(new Float64Array(16),[1/(a.$<<b),1/(a.$<<b),0]);a.M(M,M,[S*a.$,$*a.$,0]),this._demMatrixCache[n.key]={matrix:M,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(n){const u=this.painter,f=u.width/devicePixelRatio,g=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new a.T(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new a.T(u.context,{width:f,height:g,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,g,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,g))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,S=0;b<this._coordsTextureSize;b++)for(let $=0;$<this._coordsTextureSize;$++,S+=4)u[S+0]=255&$,u[S+1]=255&b,u[S+2]=$>>8<<4|b>>8,u[S+3]=0;const f=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),g=new a.T(n,f,n.gl.RGBA,{premultiply:!1});return g.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),f=this.painter.context,g=f.gl,b=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),$=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(b,$-S-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);const M=u[0]+(u[2]>>4<<8),z=u[1]+((15&u[2])<<8),F=this.coordsIndex[255-u[3]],j=F&&this.sourceCache.getTileByID(F);if(!j)return null;const B=this._coordsTextureSize,V=(1<<j.tileID.canonical.z)*B;return new a.a1((j.tileID.canonical.x*B+M)/V+j.tileID.wrap,(j.tileID.canonical.y*B+z)/V,this.getElevation(j.tileID,M,z,B))}depthAtPoint(n){const u=new Uint8Array(4),f=this.painter.context,g=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(n){var u;const f=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,g=f&&n.canonical.y===0,b=f&&n.canonical.y===(1<<n.canonical.z)-1,S=`m_${g?"n":""}_${b?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const $=this.painter.context,M=new a.cv,z=new a.aN,F=this.meshSize,j=a.$/F,B=F*F;for(let ae=0;ae<=F;ae++)for(let we=0;we<=F;we++)M.emplaceBack(we*j,ae*j,0);for(let ae=0;ae<B;ae+=F+1)for(let we=0;we<F;we++)z.emplaceBack(we+ae,F+we+ae+1,F+we+ae+2),z.emplaceBack(we+ae,F+we+ae+2,we+ae+1);const V=M.length,W=V+(F+1),te=(F+1)*F,ee=g?a.bh:0,re=g?0:1,se=b?a.bi:a.$,ce=b?0:1;for(let ae=0;ae<=F;ae++)M.emplaceBack(ae*j,ee,re);for(let ae=0;ae<=F;ae++)M.emplaceBack(ae*j,se,ce);for(let ae=0;ae<F;ae++)z.emplaceBack(te+ae,W+ae,W+ae+1),z.emplaceBack(te+ae,W+ae+1,te+ae+1),z.emplaceBack(0+ae,V+ae+1,V+ae),z.emplaceBack(0+ae,0+ae+1,V+ae+1);const oe=M.length,he=oe+2*(F+1);for(const ae of[0,1])for(let we=0;we<=F;we++)for(const Oe of[0,1])M.emplaceBack(ae*a.$,we*j,Oe);for(let ae=0;ae<2*F;ae+=2)z.emplaceBack(oe+ae,oe+ae+1,oe+ae+3),z.emplaceBack(oe+ae,oe+ae+3,oe+ae+2),z.emplaceBack(he+ae,he+ae+3,he+ae+1),z.emplaceBack(he+ae,he+ae+2,he+ae+3);const me=new $l($.createVertexBuffer(M,fp.members),$.createIndexBuffer(z),a.aM.simpleSegment(0,0,M.length,z.length));return this._meshCache[S]=me,me}getMeshFrameDelta(n){return 2*Math.PI*a.bu/Math.pow(2,Math.max(n,0))/5}getMinTileElevationForLngLatZoom(n,u){var f;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(n,u);return(f=this.getMinMaxElevation(g).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(n){const u=this.getTerrainData(n).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(n,u){const f=a.a1.fromLngLat(n.wrap()),g=(1<<u)*a.$,b=f.x*g,S=f.y*g,$=Math.floor(b/a.$),M=Math.floor(S/a.$);return{tileID:new a.Z(u,0,u,$,M),mercatorX:b,mercatorY:S}}}class mp{constructor(n,u,f){this._context=n,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new a.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:n,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((u=>n.id!==u)),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((n=>!n.inUse))===!1}}const qa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class gp{constructor(n,u){this.painter=n,this.terrain=u,this.pool=new mp(n.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter((f=>!n._layers[f].isHidden(u))),this._coordsAscending={};for(const f in n.sourceCaches){this._coordsAscending[f]={};const g=n.sourceCaches[f].getVisibleCoordinates(),b=n.sourceCaches[f].getSource(),S=b instanceof So?b.terrainTileRanges:null;for(const $ of g){const M=this.terrain.sourceCache.getTerrainCoords($,S);for(const z in M)this._coordsAscending[f][z]||(this._coordsAscending[f][z]=[]),this._coordsAscending[f][z].push(M[z])}}this._coordsAscendingStr={};for(const f of n._order){const g=n._layers[f],b=g.source;if(qa[g.type]&&!this._coordsAscendingStr[b]){this._coordsAscendingStr[b]={};for(const S in this._coordsAscending[b])this._coordsAscendingStr[b][S]=this._coordsAscending[b][S].map(($=>$.key)).sort().join()}}for(const f of this._renderableTiles)for(const g in this._coordsAscendingStr){const b=this._coordsAscendingStr[g][f.tileID.key];b&&b!==f.rttCoords[g]&&(f.rtt=[])}}renderLayer(n,u){if(n.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),g=n.type,b=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(qa[g]&&(this._prevType&&qa[this._prevType]||this._stacks.push([]),this._prevType=g,this._stacks[this._stacks.length-1].push(n.id),!S))return!0;if(qa[this._prevType]||qa[g]&&S){this._prevType=g;const $=this._stacks.length-1,M=this._stacks[$]||[];for(const z of this._renderableTiles){if(this.pool.isFull()&&(lp(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(z),z.rtt[$]){const j=this.pool.getObjectForId(z.rtt[$].id);if(j.stamp===z.rtt[$].stamp){this.pool.useObject(j);continue}}const F=this.pool.getOrCreateFreeObject();this.pool.useObject(F),this.pool.stampObject(F),z.rtt[$]={id:F.id,stamp:F.stamp},b.context.bindFramebuffer.set(F.fbo.framebuffer),b.context.clear({color:a.bf.transparent,stencil:0}),b.currentStencilSource=void 0;for(let j=0;j<M.length;j++){const B=b.style._layers[M[j]],V=B.source?this._coordsAscending[B.source][z.tileID.key]:[z.tileID];b.context.viewport.set([0,0,F.fbo.width,F.fbo.height]),b._renderTileClippingMasks(B,V,!0),b.renderLayer(b,b.style.sourceCaches[B.source],B,V,f),B.source&&(z.rttCoords[B.source]=this._coordsAscendingStr[B.source][z.tileID.key])}}return lp(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),qa[g]}return!1}}const En={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},h_=v,bs={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Sg,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},C2={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class bh{constructor(n,u,f=!1){this.mousedown=b=>{this.startMove(b,O.mousePos(this.element,b)),O.addEventListener(window,"mousemove",this.mousemove),O.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.move(b,O.mousePos(this.element,b))},this.mouseup=b=>{this._rotatePitchHandler.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=O.touchPos(this.element,b.targetTouches)[0],this.startMove(b,this._startPos),O.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=O.touchPos(this.element,b.targetTouches)[0],this.move(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const g=new w2;this._rotatePitchHandler=new Vc({clickTolerance:3,move:(b,S)=>{const $=u.getBoundingClientRect(),M=new a.P(($.bottom-$.top)/2,($.right-$.left)/2);return{bearingDelta:a.cn(new a.P(b.x,S.y),S,M),pitchDelta:f?-.5*(S.y-b.y):void 0}},moveStateManager:g,enable:!0,assignEvents:()=>{}}),this.map=n,O.addEventListener(u,"mousedown",this.mousedown),O.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),O.addEventListener(u,"touchcancel",this.reset)}startMove(n,u){this._rotatePitchHandler.dragStart(n,u),O.disableDrag()}move(n,u){const f=this.map,{bearingDelta:g,pitchDelta:b}=this._rotatePitchHandler.dragMove(n,u)||{};g&&f.setBearing(f.getBearing()+g),b&&f.setPitch(f.getPitch()+b)}off(){const n=this.element;O.removeEventListener(n,"mousedown",this.mousedown),O.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),O.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.removeEventListener(window,"touchend",this.touchend),O.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){O.enableDrag(),O.removeEventListener(window,"mousemove",this.mousemove),O.removeEventListener(window,"mouseup",this.mouseup),O.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.removeEventListener(window,"touchend",this.touchend)}}let Ti;function rr(_,n,u,f=!1){if(f||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return _?.wrap();const g=new a.S(_.lng,_.lat);if(_=new a.S(_.lng,_.lat),n){const b=new a.S(_.lng-360,_.lat),S=new a.S(_.lng+360,_.lat),$=u.locationToScreenPoint(_).distSqr(n);u.locationToScreenPoint(b).distSqr(n)<$?_=b:u.locationToScreenPoint(S).distSqr(n)<$&&(_=S)}for(;Math.abs(_.lng-u.center.lng)>180;){const b=u.locationToScreenPoint(_);if(b.x>=0&&b.y>=0&&b.x<=u.width&&b.y<=u.height)break;_.lng>u.center.lng?_.lng-=360:_.lng+=360}return _.lng!==g.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(_))?_:g}const yp={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Zc(_,n,u){const f=_.classList;for(const g in yp)f.remove(`maplibregl-${u}-anchor-${g}`);f.add(`maplibregl-${u}-anchor-${n}`)}class Wc extends a.E{constructor(n){if(super(),this._onKeyPress=u=>{const f=u.code,g=u.charCode||u.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=u=>{const f=u.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=rr(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),O.setTransform(this._element,`${yp[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${g}`),L.frameAsync(new AbortController).then((()=>{this._updateOpacity(u&&u.type==="moveend")})).catch((()=>{}))},this._onMove=u=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(n?.opacity,n?.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=a.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=O.create("div");const u=O.createNS("http://www.w3.org/2000/svg","svg"),f=41,g=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${g}px`),u.setAttributeNS(null,"viewBox",`0 0 ${g} ${f}`);const b=O.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");const S=O.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const $=O.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const re of M){const se=O.createNS("http://www.w3.org/2000/svg","ellipse");se.setAttributeNS(null,"opacity","0.04"),se.setAttributeNS(null,"cx","10.5"),se.setAttributeNS(null,"cy","5.80029008"),se.setAttributeNS(null,"rx",re.rx),se.setAttributeNS(null,"ry",re.ry),$.appendChild(se)}const z=O.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const F=O.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(F);const j=O.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const B=O.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(B);const V=O.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(6.0, 7.0)"),V.setAttributeNS(null,"fill","#FFFFFF");const W=O.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=O.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const ee=O.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#FFFFFF"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962"),W.appendChild(te),W.appendChild(ee),S.appendChild($),S.appendChild(z),S.appendChild(j),S.appendChild(V),S.appendChild(W),u.appendChild(S),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(u),this._offset=a.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(u=>{u.preventDefault()})),this._element.addEventListener("mousedown",(u=>{u.preventDefault()})),Zc(this._element,this._anchor,"marker"),n&&n.className)for(const u of n.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),n.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),O.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=a.S.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const g=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var u,f;const g=(u=this._map)===null||u===void 0?void 0:u.terrain,b=this._map.transform.isLocationOccluded(this._lngLat);if(!g||b){const V=b?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==V&&(this._element.style.opacity=V))}if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const S=this._map,$=S.terrain.depthAtPoint(this._pos),M=S.terrain.getElevationForLngLatZoom(this._lngLat,S.transform.tileZoom);if(S.transform.lngLatToCameraDepth(this._lngLat,M)-$<.006)return void(this._element.style.opacity=this._opacity);const z=-this._offset.y/S.transform.pixelsPerMeter,F=Math.sin(S.getPitch()*Math.PI/180)*z,j=S.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),B=S.transform.lngLatToCameraDepth(this._lngLat,M+F)-j>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=a.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,u){return(this._opacity===void 0||n===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Cg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Yc=0,Vl=!1;const xh={maxWidth:100,unit:"metric"};function vp(_,n,u){const f=u&&u.maxWidth||100,g=_._container.clientHeight/2,b=_._container.clientWidth/2,S=_.unproject([b-f/2,g]),$=_.unproject([b+f/2,g]),M=Math.round(_.project($).x-_.project(S).x),z=Math.min(f,M,_._container.clientWidth),F=S.distanceTo($);if(u&&u.unit==="imperial"){const j=3.2808*F;j>5280?Gl(n,z,j/5280,_._getUIString("ScaleControl.Miles")):Gl(n,z,j,_._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Gl(n,z,F/1852,_._getUIString("ScaleControl.NauticalMiles")):F>=1e3?Gl(n,z,F/1e3,_._getUIString("ScaleControl.Kilometers")):Gl(n,z,F,_._getUIString("ScaleControl.Meters"))}function Gl(_,n,u,f){const g=(function(b){const S=Math.pow(10,`${Math.floor(b)}`.length-1);let $=b/S;return $=$>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:(function(M){const z=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*z)/z})($),S*$})(u);_.style.width=n*(g/u)+"px",_.innerHTML=`${g}&nbsp;${f}`}const Eg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Ig=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function _p(_){if(_){if(typeof _=="number"){const n=Math.round(Math.abs(_)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,_),"top-left":new a.P(n,n),"top-right":new a.P(-n,n),bottom:new a.P(0,-_),"bottom-left":new a.P(n,-n),"bottom-right":new a.P(-n,-n),left:new a.P(_,0),right:new a.P(-_,0)}}if(_ instanceof a.P||Array.isArray(_)){const n=a.P.convert(_);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:a.P.convert(_.center||[0,0]),top:a.P.convert(_.top||[0,0]),"top-left":a.P.convert(_["top-left"]||[0,0]),"top-right":a.P.convert(_["top-right"]||[0,0]),bottom:a.P.convert(_.bottom||[0,0]),"bottom-left":a.P.convert(_["bottom-left"]||[0,0]),"bottom-right":a.P.convert(_["bottom-right"]||[0,0]),left:a.P.convert(_.left||[0,0]),right:a.P.convert(_.right||[0,0])}}return _p(new a.P(0,0))}const $g=v;d.AJAXError=a.cz,d.Event=a.l,d.Evented=a.E,d.LngLat=a.S,d.MercatorCoordinate=a.a1,d.Point=a.P,d.addProtocol=a.cA,d.config=a.a,d.removeProtocol=a.cB,d.AttributionControl=Tg,d.BoxZoomHandler=gg,d.CanvasSource=ka,d.CooperativeGesturesHandler=l_,d.DoubleClickZoomHandler=_g,d.DragPanHandler=o_,d.DragRotateHandler=xg,d.EdgeInsets=Ml,d.FullscreenControl=class extends a.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var n;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=u?.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){O.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=O.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);O.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},d.GeoJSONSource=wo,d.GeolocateControl=class extends a.E{constructor(_){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",n)),this._finish()}},this._updateCamera=n=>{const u=new a.S(n.coords.longitude,n.coords.latitude),f=n.coords.accuracy,g=this._map.getBearing(),b=a.e({bearing:g},this.options.fitBoundsOptions),S=er.fromLngLat(u,f);this._map.fitBounds(S,b,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const u=new a.S(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=n.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=n=>{if(this._map){if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Vl)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this._geolocateButton=O.create("button","maplibregl-ctrl-geolocate",this._container),O.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=O.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Wc({element:this._dotElement}),this._circleElement=O.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(u=>{const f=u?.[0]instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))}))}},this.options=a.e({},Cg,_)}onAdd(_){return this._map=_,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return a._(this,arguments,void 0,(function*(n=!1){if(Ti!==void 0&&!n)return Ti;if(window.navigator.permissions===void 0)return Ti=!!window.navigator.geolocation,Ti;try{Ti=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ti=!!window.navigator.geolocation}return Ti}))})().then((n=>this._finishSetupUI(n))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),O.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Yc=0,Vl=!1}_isOutOfMapMaxBounds(_){const n=this._map.getMaxBounds(),u=_.coords;return n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const _=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&_))return;const n=this._map.project(_),u=this._map.unproject([n.x+100,n.y]),f=_.distanceTo(u)/100,g=2*this._accuracy/f;this._circleElement.style.width=`${g.toFixed(2)}px`,this._circleElement.style.height=`${g.toFixed(2)}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Yc--,Vl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Yc++,Yc>1?(_={maximumAge:6e5,timeout:0},Vl=!0):(_=this.options.positionOptions,Vl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},d.GlobeControl=class{constructor(){this._toggleProjection=()=>{var _;const n=(_=this._map.getProjection())===null||_===void 0?void 0:_.type;this._map.setProjection(n!=="mercator"&&n?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var _;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((_=this._map.getProjection())===null||_===void 0?void 0:_.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(_){return this._map=_,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=O.create("button","maplibregl-ctrl-globe",this._container),O.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){O.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},d.Hash=cp,d.ImageSource=So,d.KeyboardHandler=dp,d.LngLatBounds=er,d.LogoControl=u_,d.Map=class extends c_{constructor(_){var n,u;a.cw.mark(a.cx.create);const f=Object.assign(Object.assign(Object.assign({},bs),_),{canvasContextAttributes:Object.assign(Object.assign({},bs.canvasContextAttributes),_.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const g=new Mi,b=new fn;if(f.minZoom!==void 0&&g.setMinZoom(f.minZoom),f.maxZoom!==void 0&&g.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&g.setMinPitch(f.minPitch),f.maxPitch!==void 0&&g.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&g.setRenderWorldCopies(f.renderWorldCopies),super(g,b,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Po,this._controls=[],this._mapId=a.a7(),this._contextLost=$=>{$.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:$}))},this._contextRestored=$=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:$}))},this._onMapScroll=$=>{if($.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},En),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Ie.addThrottleControl((()=>this.isMoving())),this._requestManager=new ke(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let $=!1;const M=jl((z=>{this._trackResize&&!this._removed&&(this.resize(z),this.redraw())}),50);this._resizeObserver=new ResizeObserver((z=>{$?M(z):$=!0})),this._resizeObserver.observe(this._container)}this.handlers=new wg(this,f),this._hash=f.hash&&new cp(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,a.e({},f.fitBoundsOptions,{duration:0}))));const S=typeof f.style=="string"||((u=(n=f.style)===null||n===void 0?void 0:n.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Tg(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new u_,f.logoPosition),this.on("style.load",(()=>{if(S||this._resizeTransform(),this.transform.unmodified){const $=a.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo($)}})),this.on("data",($=>{this._update($.dataType==="style"),this.fire(new a.l(`${$.dataType}data`,$))})),this.on("dataloading",($=>{this.fire(new a.l(`${$.dataType}dataloading`,$))})),this.on("dataabort",($=>{this.fire(new a.l("sourcedataabort",$))}))}_getMapId(){return this._mapId}setGlobalStateProperty(_,n){return this.style.setGlobalStateProperty(_,n),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(_,n){if(n===void 0&&(n=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=_.onAdd(this);this._controls.push(_);const f=this._controlPositions[n];return n.indexOf("bottom")!==-1?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(_);return n>-1&&this._controls.splice(n,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}coveringTiles(_){return Te(this.transform,_)}calculateCameraOptionsFromTo(_,n,u,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,n,u,f)}resize(_,n=!0){const[u,f]=this._containerDimensions(),g=this._getClampedPixelRatio(u,f);if(this._resizeCanvas(u,f,g),this.painter.resize(u,f,g),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const $=this._getClampedPixelRatio(u,f);this._resizeCanvas(u,f,$),this.painter.resize(u,f,$)}this._resizeTransform(n);const b=!this._moving;return b&&(this.stop(),this.fire(new a.l("movestart",_)).fire(new a.l("move",_))),this.fire(new a.l("resize",_)),b&&this.fire(new a.l("moveend",_)),this}_resizeTransform(_=!0){var n;const[u,f]=this._containerDimensions();this.transform.resize(u,f,_),(n=this._requestedCameraState)===null||n===void 0||n.resize(u,f,_)}_getClampedPixelRatio(_,n){const{0:u,1:f}=this._maxCanvasSize,g=this.getPixelRatio(),b=_*g,S=n*g;return Math.min(b>u?u/b:1,S>f?f/S:1)*g}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(er.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.setMinZoom(_),this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.setMaxZoom(_),this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.setMinPitch(_),this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(_>=this.transform.minPitch)return this.transform.setMaxPitch(_),this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.setRenderWorldCopies(_),this._update()}project(_){return this.transform.locationToScreenPoint(a.S.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.screenPointToLocation(a.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,n,u){if(_==="mouseenter"||_==="mouseover"){let f=!1;return{layers:n,listener:u,delegates:{mousemove:b=>{const S=n.filter((M=>this.getLayer(M))),$=S.length!==0?this.queryRenderedFeatures(b.point,{layers:S}):[];$.length?f||(f=!0,u.call(this,new Nn(_,this,b.originalEvent,{features:$}))):f=!1},mouseout:()=>{f=!1}}}}if(_==="mouseleave"||_==="mouseout"){let f=!1;return{layers:n,listener:u,delegates:{mousemove:S=>{const $=n.filter((M=>this.getLayer(M)));($.length!==0?this.queryRenderedFeatures(S.point,{layers:$}):[]).length?f=!0:f&&(f=!1,u.call(this,new Nn(_,this,S.originalEvent)))},mouseout:S=>{f&&(f=!1,u.call(this,new Nn(_,this,S.originalEvent)))}}}}{const f=g=>{const b=n.filter(($=>this.getLayer($))),S=b.length!==0?this.queryRenderedFeatures(g.point,{layers:b}):[];S.length&&(g.features=S,u.call(this,g),delete g.features)};return{layers:n,listener:u,delegates:{[_]:f}}}}_saveDelegatedListener(_,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(n)}_removeDelegatedListener(_,n,u){if(!this._delegatedListeners||!this._delegatedListeners[_])return;const f=this._delegatedListeners[_];for(let g=0;g<f.length;g++){const b=f[g];if(b.listener===u&&b.layers.length===n.length&&b.layers.every((S=>n.includes(S)))){for(const S in b.delegates)this.off(S,b.delegates[S]);return void f.splice(g,1)}}}on(_,n,u){if(u===void 0)return super.on(_,n);const f=typeof n=="string"?[n]:n,g=this._createDelegatedListener(_,f,u);this._saveDelegatedListener(_,g);for(const b in g.delegates)this.on(b,g.delegates[b]);return{unsubscribe:()=>{this._removeDelegatedListener(_,f,u)}}}once(_,n,u){if(u===void 0)return super.once(_,n);const f=typeof n=="string"?[n]:n,g=this._createDelegatedListener(_,f,u);for(const b in g.delegates){const S=g.delegates[b];g.delegates[b]=(...$)=>{this._removeDelegatedListener(_,f,u),S(...$)}}this._saveDelegatedListener(_,g);for(const b in g.delegates)this.once(b,g.delegates[b]);return this}off(_,n,u){return u===void 0?super.off(_,n):(this._removeDelegatedListener(_,typeof n=="string"?[n]:n,u),this)}queryRenderedFeatures(_,n){if(!this.style)return[];let u;const f=_ instanceof a.P||Array.isArray(_),g=f?_:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(f?{}:_)||{},g instanceof a.P||typeof g[0]=="number")u=[a.P.convert(g)];else{const b=a.P.convert(g[0]),S=a.P.convert(g[1]);u=[b,new a.P(S.x,b.y),S,new a.P(b.x,S.y),b]}return this.style.queryRenderedFeatures(u,n,this.transform)}querySourceFeatures(_,n){return this.style.querySourceFeatures(_,n)}setStyle(_,n){return(n=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(_,n))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const n=this._locale[_];if(n==null)throw new Error(`Missing UI string '${_}'`);return n}_updateStyle(_,n){var u,f;if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(_,n)));const g=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new qm(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,n,g):this.style.loadJSON(_,n,g),this):((f=(u=this.style)===null||u===void 0?void 0:u.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new qm(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,n){if(typeof _=="string"){const u=this._requestManager.transformRequest(_,"Style");a.j(u,new AbortController).then((f=>{this._updateDiff(f.data,n)})).catch((f=>{f&&this.fire(new a.k(f))}))}else typeof _=="object"&&this._updateDiff(_,n)}_updateDiff(_,n){try{this.style.setState(_,n)&&this._update(!0)}catch(u){a.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(_,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(_,n){return this._lazyInitEmptyStyle(),this.style.addSource(_,n),this._update(!0)}isSourceLoaded(_){const n=this.style&&this.style.sourceCaches[_];if(n!==void 0)return n.loaded();this.fire(new a.k(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const n=this.style.sourceCaches[_.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&n.reload();for(const u in this.style._layers){const f=this.style._layers[u];f.type==="hillshade"&&f.source===_.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===_.source&&a.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Mt(this.painter,n,_),this.painter.renderToTexture=new gp(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var f;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==_.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=u.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:_})),this}getTerrain(){var _,n;return(n=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const n in _){const u=_[n]._tiles;for(const f in u){const g=u[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}setSourceTileLodParams(_,n,u){if(u){const f=this.getSource(u);if(!f)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);f.calculateTileZoom=Xe(Math.max(1,_),Math.max(1,n))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=Xe(Math.max(1,_),Math.max(1,n));return this._update(!0),this}refreshTiles(_,n){const u=this.style.sourceCaches[_];if(!u)throw new Error(`There is no source cache with ID "${_}", cannot refresh tile`);n===void 0?u.reload(!0):u.refreshTiles(n.map((f=>new a.a4(f.z,f.x,f.y))))}addImage(_,n,u={}){const{pixelRatio:f=1,sdf:g=!1,stretchX:b,stretchY:S,content:$,textFitWidth:M,textFitHeight:z}=u;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||a.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:j,data:B}=n,V=n;return this.style.addImage(_,{data:new a.R({width:F,height:j},new Uint8Array(B)),pixelRatio:f,stretchX:b,stretchY:S,content:$,textFitWidth:M,textFitHeight:z,sdf:g,version:0,userImage:V}),V.onAdd&&V.onAdd(this,_),this}}{const{width:F,height:j,data:B}=L.getImageData(n);this.style.addImage(_,{data:new a.R({width:F,height:j},B),pixelRatio:f,stretchX:b,stretchY:S,content:$,textFitWidth:M,textFitHeight:z,sdf:g,version:0})}}updateImage(_,n){const u=this.style.getImage(_);if(!u)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=n instanceof HTMLImageElement||a.b(n)?L.getImageData(n):n,{width:g,height:b,data:S}=f;if(g===void 0||b===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==u.data.width||b!==u.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const $=!(n instanceof HTMLImageElement||a.b(n));return u.data.replace(S,$),this.style.updateImage(_,u),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return Ie.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,n){return this._lazyInitEmptyStyle(),this.style.addLayer(_,n),this._update(!0)}moveLayer(_,n){return this.style.moveLayer(_,n),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,n,u){return this.style.setLayerZoomRange(_,n,u),this._update(!0)}setFilter(_,n,u={}){return this.style.setFilter(_,n,u),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,n,u,f={}){return this.style.setPaintProperty(_,n,u,f),this._update(!0)}getPaintProperty(_,n){return this.style.getPaintProperty(_,n)}setLayoutProperty(_,n,u,f={}){return this.style.setLayoutProperty(_,n,u,f),this._update(!0)}getLayoutProperty(_,n){return this.style.getLayoutProperty(_,n)}setGlyphs(_,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,n,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,n,u,(f=>{f||this._update(!0)})),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,n,(u=>{u||this._update(!0)})),this}setLight(_,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(_,n={}){return this._lazyInitEmptyStyle(),this.style.setSky(_,n),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(_,n){return this.style.setFeatureState(_,n),this._update()}removeFeatureState(_,n){return this.style.removeFeatureState(_,n),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,n=0;return this._container&&(_=this._container.clientWidth||400,n=this._container.clientHeight||300),[_,n]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const n=this._canvasContainer=O.create("div","maplibregl-canvas-container",_);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=O.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);const g=this._controlContainer=O.create("div","maplibregl-control-container",_),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((S=>{b[S]=O.create("div",`maplibregl-ctrl-${S} `,g)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,n,u){this._canvas.width=Math.floor(u*_),this._canvas.height=Math.floor(u*n),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const _=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let n=null;this._canvas.addEventListener("webglcontextcreationerror",(f=>{n={requestedAttributes:_},f&&(n.statusMessage=f.statusMessage,n.type=f.type)}),{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,_):this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_),!u){const f="Failed to initialize WebGL";throw n?(n.message=f,new Error(JSON.stringify(n))):new Error(f)}this.painter=new Yv(u,this.transform),H.testSupport(u)}migrateProjection(_,n){super.migrateProjection(_,n),this.painter.transform=_,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){var n,u,f,g,b;const S=this._idleTriggered?this._fadeDuration:0,$=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let M=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const j=this.transform.zoom,B=L.now();this.style.zoomHistory.update(j,B);const V=new a.F(j,{now:B,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),W=V.crossFadingFactor();W===1&&W===this._crossFadingFactor||(M=!0,this._crossFadingFactor=W),this.style.update(V)}const z=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==$;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((g=this.style.projection)===null||g===void 0?void 0:g.transitionState,(b=this.style.projection)===null||b===void 0?void 0:b.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||z)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,z),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cw.mark(a.cx.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,a.cw.mark(a.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ie.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n?.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),O.remove(this._canvasContainer),O.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cw.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,L.frame(this._frameRequest,(_=>{a.cw.frame(_),this._frameRequest=null;try{this._render(_)}catch(n){if(!a.cy(n)&&!(function(u){return u.message===uh})(n))throw n}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return h_}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(_){return this._lazyInitEmptyStyle(),this.style.setProjection(_),this._update(!0)}},d.MapMouseEvent=Nn,d.MapTouchEvent=Bc,d.MapWheelEvent=mg,d.Marker=Wc,d.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const n=this._map.getZoom(),u=n===this._map.getMaxZoom(),f=n===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(n,u)=>{const f=this._map._getUIString(`NavigationControl.${u}`);n.title=f,n.setAttribute("aria-label",f)},this.options=a.e({},C2,_),this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(n=>this._map.zoomIn({},{originalEvent:n}))),O.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(n=>this._map.zoomOut({},{originalEvent:n}))),O.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})})),this._compassIcon=O.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new bh(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){O.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,n){const u=O.create("button",_,this._container);return u.type="button",u.addEventListener("click",n),u}},d.Popup=class extends a.E{constructor(_){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&O.remove(this._content),this._container&&(O.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=O.create("div","maplibregl-popup",this._map.getContainer()),this._tip=O.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=rr(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!n)return;const u=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const g=_p(this.options.offset);if(!f){const S=this._container.offsetWidth,$=this._container.offsetHeight;let M;M=u.y+g.bottom.y<$?["top"]:u.y>this._map.transform.height-$?["bottom"]:[],u.x<S/2?M.push("left"):u.x>this._map.transform.width-S/2&&M.push("right"),f=M.length===0?"bottom":M.join("-")}let b=u.add(g[f]);this.options.subpixelPositioning||(b=b.round()),O.setTransform(this._container,`${yp[f]} translate(${b.x}px,${b.y}px)`),Zc(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(Eg),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=a.S.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const n=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=_;f=u.firstChild,f;)n.appendChild(f);return this.setDOMContent(n)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=O.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=O.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Ig);_&&_.focus()}},d.RasterDEMTileSource=Cl,d.RasterTileSource=xo,d.ScaleControl=class{constructor(_){this._onMove=()=>{vp(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,vp(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},xh),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){O.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},d.ScrollZoomHandler=n_,d.Style=qm,d.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=O.create("button","maplibregl-ctrl-terrain",this._container),O.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){O.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},d.TwoFingersTouchPitchHandler=hp,d.TwoFingersTouchRotateHandler=qc,d.TwoFingersTouchZoomHandler=up,d.TwoFingersTouchZoomRotateHandler=a_,d.VectorTileSource=Fs,d.VideoSource=Ec,d.addSourceType=(_,n)=>a._(void 0,void 0,void 0,(function*(){if(Da(_))throw new Error(`A source type called "${_}" already exists.`);((u,f)=>{Aa[u]=f})(_,n)})),d.clearPrewarmedResources=function(){const _=Vr;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(bt),Vr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},d.createTileMesh=Vm,d.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},d.getRTLTextPluginStatus=function(){return Ra().getRTLTextPluginStatus()},d.getVersion=function(){return $g},d.getWorkerCount=function(){return Dt.workerCount},d.getWorkerUrl=function(){return a.a.WORKER_URL},d.importScriptInWorkers=function(_){return bo().broadcast("IS",_)},d.prewarm=function(){es().acquire(bt)},d.setMaxParallelImageRequests=function(_){a.a.MAX_PARALLEL_IMAGE_REQUESTS=_},d.setRTLTextPlugin=function(_,n){return Ra().setRTLTextPlugin(_,n)},d.setWorkerCount=function(_){Dt.workerCount=_},d.setWorkerUrl=function(_){a.a.WORKER_URL=_}}));var h=i;return h}))})(ab)),ab.exports}var G9=V9();const Qa=Vz(G9);var dS,Vk;function q9(){if(Vk)return dS;Vk=1;function t(i,r){var o=i.getCenter(),h=i.getZoom(),d=i.getBearing(),a=i.getPitch();r.forEach(function(v){v.jumpTo({center:o,zoom:h,bearing:d,pitch:a})})}function e(){var i,r=arguments.length;if(r===1)i=arguments[0];else{i=[];for(var o=0;o<r;o++)i.push(arguments[o])}var h=[];i.forEach(function(T,E){h[E]=v.bind(null,T,i.filter(function(k,L){return L!==E}))});function d(){i.forEach(function(T,E){T.on("move",h[E])})}function a(){i.forEach(function(T,E){T.off("move",h[E])})}function v(T,E){a(),t(T,E),d()}return d(),function(){a(),h=[],i=[]}}return dS=e,dS}var H9=q9();const Z9=Vz(H9),No={LEFT_RIGHT:"left-right",TOP_BOTTOM:"top-bottom"};function qz(t,e,i,r){if(this.options=r||{},this.includeLabel=this.options.includeLabel||!0,this._mapA=t,this._mapB=e,this.orientation=this.options.orientation||No.LEFT_RIGHT,this._onDown=this._onDown.bind(this),this._onMove=this._onMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._ev=r.eventEmitter||new EventTarget,this._swiper=document.createElement("div"),this._swiper.className=this.orientation===No.LEFT_RIGHT?"compare-swiper-leftRight":"compare-swiper-topBottom",this._appendTarget=typeof i=="string"&&document.body.querySelectorAll?document.body.querySelectorAll(i)[0]:null,this._appendTarget&&(this._appendTarget.classList.remove("orientation-left-right","orientation-top-bottom"),this._appendTarget.classList.add(this.orientation==="top-bottom"?"orientation-top-bottom":"orientation-left-right")),this._controlContainer=document.createElement("div"),this._controlContainer.className=this.orientation===No.LEFT_RIGHT?"maplibregl-compare maplibregl-compare-leftRight":"maplibregl-compare maplibregl-compare-topBottom",this._controlContainer.append(this._swiper),this._appendTarget instanceof Element&&document.body.querySelectorAll){if(this._appendTarget.style.textAlign="left",!this._appendTarget)throw new Error("Cannot find element with specified container selector.");this._appendTarget.append(this._controlContainer)}else if(this._appendTarget instanceof Element&&i.appendChild)this._appendTarget.append(this._controlContainer);else throw new Error("Invalid container specified. Must be CSS selector or HTML element.");this._bounds=t.getContainer().getBoundingClientRect();const o=this.orientation===No.LEFT_RIGHT?this._bounds.width/2:this._bounds.height/2;if(this._setPosition(o),this._clearSync=Z9(t,e),this._onResize=(function(){const h=this.orientation===No.LEFT_RIGHT?this._bounds.width/2:this._bounds.height/2;this._setPosition(h),this._bounds=t.getContainer().getBoundingClientRect(),t.triggerRepaint(),e.triggerRepaint(),this.switchType(this?.options?.type||"slider")}).bind(this),e.on("resize",this._onResize),t.on("resize",this._onResize),window.addEventListener("resize",this._onResize),this._typeToggle=null,this.options.showTypeToggle!==!1)if(this._typeToggle=this._createTypeToggle(),typeof i=="string"&&document.body.querySelectorAll){const h=document.body.querySelectorAll(i)[0];h&&h.append(this._typeToggle)}else i instanceof Element&&i.appendChild&&i.append(this._typeToggle);this.switchType(this?.options?.type||"slider")}qz.prototype={_createTypeToggle(){const t=document.createElement("div");t.className="maplibregl-compare-type-toggle",this.options.position.forEach(H=>{t.classList.add(H)});const e=document.createElement("div");e.className="toggle-prepend";const i=document.createElement("div");i.className="toggle-divide";const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("viewBox","0 0 24 24"),r.setAttribute("width","20"),r.setAttribute("height","20"),r.style.fill="currentColor";const o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),r.append(o),e.append(i),e.append(r);const h=document.createElement("input");h.type="checkbox",h.className="toggle-switch",h.checked=(this?.options?.type||"slider")==="sideBySide",h.addEventListener("change",H=>{const ie=H.target.checked?"sideBySide":"slider";this.options.type=ie,this.switchType(ie)});const d=document.createElement("label");d.className="toggle-label",d.append(h);const a=document.createElement("div");a.className="toggle-append";const v=document.createElementNS("http://www.w3.org/2000/svg","svg");v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("width","20"),v.setAttribute("height","20"),v.style.fill="currentColor";const T=document.createElementNS("http://www.w3.org/2000/svg","path");T.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),v.append(T);const E=document.createElement("span");E.textContent="|",E.className="toggle-icon-divider";const k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.setAttribute("viewBox","0 0 24 24"),k.setAttribute("width","20"),k.setAttribute("height","20"),k.style.fill="currentColor";const L=document.createElementNS("http://www.w3.org/2000/svg","path");L.setAttribute("d","M20.5,3L20.34,3.03L15,5.1L9,3L3.36,4.9C3.15,4.97 3,5.15 3,5.38V20.5A0.5,0.5 0 0,0 3.5,21L3.66,20.97L9,18.9L15,21L20.64,19.1C20.85,19.03 21,18.85 21,18.62V3.5A0.5,0.5 0 0,0 20.5,3M10,5.47L14,6.87V18.53L10,17.13V5.47M5,6.46L8,5.45V17.15L5,18.31V6.46M16,18.55L19,17.54V5.84L16,6.85V18.55Z"),k.append(L),a.append(v),a.append(E),a.append(k);const O=document.createElement("div");if(O.className="toggle-controls-row",O.style.display="flex",O.style.alignItems="center",O.style.gap="8px",O.append(e),O.append(d),O.append(a),t.style.flexDirection="column",t.style.alignItems="center",t.append(O),this.includeLabel){const H=document.createElement("div");H.className="toggle-label",H.textContent="Slider | Side by Side",t.prepend(H)}return t},_setPointerEvents(t){this._controlContainer.style.pointerEvents=t,this._swiper.style.pointerEvents=t},_onDown(t){t.touches?(document.addEventListener("touchmove",this._onMove),document.addEventListener("touchend",this._onTouchEnd)):(document.addEventListener("mousemove",this._onMove),document.addEventListener("mouseup",this._onMouseUp))},_setPosition(t){t=Math.min(t,this.orientation===No.LEFT_RIGHT?this._bounds.width:this._bounds.height),t=t/document.body.style.zoom;const e=this.orientation===No.TOP_BOTTOM?"translate(0, "+t+"px)":"translate("+t+"px, 0)";this._controlContainer.style.transform=e,this._controlContainer.style.WebkitTransform=e;const i=this._bounds.height/document.body.style.zoom,r=this.orientation===No.TOP_BOTTOM?"rect(0, 999em, "+t+"px, 0)":"rect(0, "+t+"px, "+i+"px, 0)",o=this.orientation===No.TOP_BOTTOM?"rect("+t+"px, 999em, "+i+"px,0)":"rect(0, 999em, "+i+"px,"+t+"px)";this._mapA.getContainer().style.clip=r,this._mapB.getContainer().style.clip=o,this.currentPosition=t},_onMove(t){this.options&&this.options.mousemove&&this._setPointerEvents(t.touches?"auto":"none"),this.orientation===No.TOP_BOTTOM?this._setPosition(this._getY(t)):this._setPosition(this._getX(t))},_onMouseUp(){document.removeEventListener("mousemove",this._onMove),document.removeEventListener("mouseup",this._onMouseUp),this.fire("slideend",{currentPosition:this.currentPosition})},_onTouchEnd(){document.removeEventListener("touchmove",this._onMove),document.removeEventListener("touchend",this._onTouchEnd),this.fire("slideend",{currentPosition:this.currentPosition})},_getX(t){t=t.touches?t.touches[0]:t;const e=t.clientX-this._bounds.left;return e<0&&(e=0),e>this._bounds.width&&(e=this._bounds.width),e},_getY(t){t=t.touches?t.touches[0]:t;const e=t.clientY-this._bounds.top;return e<0?0:e>this._bounds.height?this._bounds.height:e},switchType(t="slider"){const e=this._mapA,i=this._mapB;this._appendTarget.classList.remove("slider","sideBySide"),this._appendTarget.classList.add(t);const r=this.orientation===No.LEFT_RIGHT?this._bounds.width/2:this._bounds.height/2;if(this._setPosition(r),this._typeToggle){const o=this._typeToggle.querySelector(".toggle-switch");o&&(o.checked=t==="sideBySide")}this.options.type=t,t==="sideBySide"?(e.getContainer().style.clip=null,i.getContainer().style.clip="unset",this.orientation===No.TOP_BOTTOM&&(i.getContainer().style.transform="none"),this._controlContainer.style.display="none",this.options&&this.options.mousemove&&(e.getContainer().removeEventListener("mousemove",this._onMove),i.getContainer().removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown)):(this._controlContainer.style.display="inline-block",i.getContainer().style.transform="none",this.options&&this.options.mousemove&&(e.getContainer().addEventListener("mousemove",this._onMove),i.getContainer().addEventListener("mousemove",this._onMove)),this._swiper.addEventListener("mousedown",this._onDown),this._swiper.addEventListener("touchstart",this._onDown))},setSlider(t){this._setPosition(t)},onceBoth(t,e){let i=!1,r=!1;return this._mapA.once(t,()=>{i=!0,r&&e()}),this._mapB.once(t,()=>{r=!0,i&&e()}),this},onBoth(t,e){let i=!1,r=!1;return this._mapA.on(t,()=>{i=!0,r&&e()}),this._mapB.on(t,()=>{r=!0,i&&e()}),this},on(t,e){return this._ev.addEventListener(t,e),this},fire(t,e){return this._ev.dispatchEvent(new CustomEvent(t,{detail:e})),this},off(t,e){return this._ev.removeEventListener(t,e),this},remove(){this._clearSync(),this._mapB.off("resize",this._onResize),this._mapA.off("resize",this._onResize);const t=this._mapA.getContainer();t&&(t.style.clip=null,t.removeEventListener("mousemove",this._onMove));const e=this._mapB.getContainer();e&&(e.style.clip=null,e.removeEventListener("mousemove",this._onMove)),this._swiper.removeEventListener("mousedown",this._onDown),this._swiper.removeEventListener("touchstart",this._onDown),this._controlContainer.remove(),this._typeToggle&&this._typeToggle.parentNode&&this._typeToggle.remove()}};function lb(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function W9(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Hz(t){let e,i,r;t.length!==2?(e=lb,i=(a,v)=>lb(t(a),v),r=(a,v)=>t(a)-v):(e=t===lb||t===W9?t:Y9,i=t,r=t);function o(a,v,T=0,E=a.length){if(T<E){if(e(v,v)!==0)return E;do{const k=T+E>>>1;i(a[k],v)<0?T=k+1:E=k}while(T<E)}return T}function h(a,v,T=0,E=a.length){if(T<E){if(e(v,v)!==0)return E;do{const k=T+E>>>1;i(a[k],v)<=0?T=k+1:E=k}while(T<E)}return T}function d(a,v,T=0,E=a.length){const k=o(a,v,T,E-1);return k>T&&r(a[k-1],v)>-r(a[k],v)?k-1:k}return{left:o,center:d,right:h}}function Y9(){return 0}function X9(t){return t===null?NaN:+t}const J9=Hz(lb),K9=J9.right;Hz(X9).center;class Gk extends Map{constructor(e,i=t7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),e!=null)for(const[r,o]of e)this.set(r,o)}get(e){return super.get(qk(this,e))}has(e){return super.has(qk(this,e))}set(e,i){return super.set(Q9(this,e),i)}delete(e){return super.delete(e7(this,e))}}function qk({_intern:t,_key:e},i){const r=e(i);return t.has(r)?t.get(r):i}function Q9({_intern:t,_key:e},i){const r=e(i);return t.has(r)?t.get(r):(t.set(r,i),i)}function e7({_intern:t,_key:e},i){const r=e(i);return t.has(r)&&(i=t.get(r),t.delete(r)),i}function t7(t){return t!==null&&typeof t=="object"?t.valueOf():t}const i7=Math.sqrt(50),r7=Math.sqrt(10),n7=Math.sqrt(2);function ux(t,e,i){const r=(e-t)/Math.max(0,i),o=Math.floor(Math.log10(r)),h=r/Math.pow(10,o),d=h>=i7?10:h>=r7?5:h>=n7?2:1;let a,v,T;return o<0?(T=Math.pow(10,-o)/d,a=Math.round(t*T),v=Math.round(e*T),a/T<t&&++a,v/T>e&&--v,T=-T):(T=Math.pow(10,o)*d,a=Math.round(t/T),v=Math.round(e/T),a*T<t&&++a,v*T>e&&--v),v<a&&.5<=i&&i<2?ux(t,e,i*2):[a,v,T]}function s7(t,e,i){if(e=+e,t=+t,i=+i,!(i>0))return[];if(t===e)return[t];const r=e<t,[o,h,d]=r?ux(e,t,i):ux(t,e,i);if(!(h>=o))return[];const a=h-o+1,v=new Array(a);if(r)if(d<0)for(let T=0;T<a;++T)v[T]=(h-T)/-d;else for(let T=0;T<a;++T)v[T]=(h-T)*d;else if(d<0)for(let T=0;T<a;++T)v[T]=(o+T)/-d;else for(let T=0;T<a;++T)v[T]=(o+T)*d;return v}function BT(t,e,i){return e=+e,t=+t,i=+i,ux(t,e,i)[2]}function o7(t,e,i){e=+e,t=+t,i=+i;const r=e<t,o=r?BT(e,t,i):BT(t,e,i);return(r?-1:1)*(o<0?1/-o:o)}function a7(t){return t}var pS=1,fS=2,jT=3,cy=4,Hk=1e-6;function l7(t){return"translate("+t+",0)"}function c7(t){return"translate(0,"+t+")"}function u7(t){return e=>+t(e)}function h7(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),i=>+t(i)+e}function d7(){return!this.__axis}function Zz(t,e){var i=[],r=null,o=null,h=6,d=6,a=3,v=typeof window<"u"&&window.devicePixelRatio>1?0:.5,T=t===pS||t===cy?-1:1,E=t===cy||t===fS?"x":"y",k=t===pS||t===jT?l7:c7;function L(O){var H=r??(e.ticks?e.ticks.apply(e,i):e.domain()),ie=o??(e.tickFormat?e.tickFormat.apply(e,i):a7),pe=Math.max(h,0)+a,be=e.range(),Ce=+be[0]+v,Pe=+be[be.length-1]+v,Ie=(e.bandwidth?h7:u7)(e.copy(),v),ke=O.selection?O.selection():O,Ke=ke.selectAll(".domain").data([null]),qe=ke.selectAll(".tick").data(H,e).order(),dt=qe.exit(),ft=qe.enter().append("g").attr("class","tick"),et=qe.select("line"),We=qe.select("text");Ke=Ke.merge(Ke.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),qe=qe.merge(ft),et=et.merge(ft.append("line").attr("stroke","currentColor").attr(E+"2",T*h)),We=We.merge(ft.append("text").attr("fill","currentColor").attr(E,T*pe).attr("dy",t===pS?"0em":t===jT?"0.71em":"0.32em")),O!==ke&&(Ke=Ke.transition(O),qe=qe.transition(O),et=et.transition(O),We=We.transition(O),dt=dt.transition(O).attr("opacity",Hk).attr("transform",function(Be){return isFinite(Be=Ie(Be))?k(Be+v):this.getAttribute("transform")}),ft.attr("opacity",Hk).attr("transform",function(Be){var ge=this.parentNode.__axis;return k((ge&&isFinite(ge=ge(Be))?ge:Ie(Be))+v)})),dt.remove(),Ke.attr("d",t===cy||t===fS?d?"M"+T*d+","+Ce+"H"+v+"V"+Pe+"H"+T*d:"M"+v+","+Ce+"V"+Pe:d?"M"+Ce+","+T*d+"V"+v+"H"+Pe+"V"+T*d:"M"+Ce+","+v+"H"+Pe),qe.attr("opacity",1).attr("transform",function(Be){return k(Ie(Be)+v)}),et.attr(E+"2",T*h),We.attr(E,T*pe).text(ie),ke.filter(d7).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===fS?"start":t===cy?"end":"middle"),ke.each(function(){this.__axis=Ie})}return L.scale=function(O){return arguments.length?(e=O,L):e},L.ticks=function(){return i=Array.from(arguments),L},L.tickArguments=function(O){return arguments.length?(i=O==null?[]:Array.from(O),L):i.slice()},L.tickValues=function(O){return arguments.length?(r=O==null?null:Array.from(O),L):r&&r.slice()},L.tickFormat=function(O){return arguments.length?(o=O,L):o},L.tickSize=function(O){return arguments.length?(h=d=+O,L):h},L.tickSizeInner=function(O){return arguments.length?(h=+O,L):h},L.tickSizeOuter=function(O){return arguments.length?(d=+O,L):d},L.tickPadding=function(O){return arguments.length?(a=+O,L):a},L.offset=function(O){return arguments.length?(v=+O,L):v},L}function Zk(t){return Zz(jT,t)}function p7(t){return Zz(cy,t)}var f7={value:()=>{}};function Wz(){for(var t=0,e=arguments.length,i={},r;t<e;++t){if(!(r=arguments[t]+"")||r in i||/[\s.]/.test(r))throw new Error("illegal type: "+r);i[r]=[]}return new cb(i)}function cb(t){this._=t}function m7(t,e){return t.trim().split(/^|\s+/).map(function(i){var r="",o=i.indexOf(".");if(o>=0&&(r=i.slice(o+1),i=i.slice(0,o)),i&&!e.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:r}})}cb.prototype=Wz.prototype={constructor:cb,on:function(t,e){var i=this._,r=m7(t+"",i),o,h=-1,d=r.length;if(arguments.length<2){for(;++h<d;)if((o=(t=r[h]).type)&&(o=g7(i[o],t.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++h<d;)if(o=(t=r[h]).type)i[o]=Wk(i[o],t.name,e);else if(e==null)for(o in i)i[o]=Wk(i[o],t.name,null);return this},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new cb(t)},call:function(t,e){if((o=arguments.length-2)>0)for(var i=new Array(o),r=0,o,h;r<o;++r)i[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(h=this._[t],r=0,o=h.length;r<o;++r)h[r].value.apply(e,i)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,h=r.length;o<h;++o)r[o].value.apply(e,i)}};function g7(t,e){for(var i=0,r=t.length,o;i<r;++i)if((o=t[i]).name===e)return o.value}function Wk(t,e,i){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=f7,t=t.slice(0,r).concat(t.slice(r+1));break}return i!=null&&t.push({name:e,value:i}),t}var UT="http://www.w3.org/1999/xhtml";const Yk={svg:"http://www.w3.org/2000/svg",xhtml:UT,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function H1(t){var e=t+="",i=e.indexOf(":");return i>=0&&(e=t.slice(0,i))!=="xmlns"&&(t=t.slice(i+1)),Yk.hasOwnProperty(e)?{space:Yk[e],local:t}:t}function y7(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===UT&&e.documentElement.namespaceURI===UT?e.createElement(t):e.createElementNS(i,t)}}function v7(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Yz(t){var e=H1(t);return(e.local?v7:y7)(e)}function _7(){}function HI(t){return t==null?_7:function(){return this.querySelector(t)}}function b7(t){typeof t!="function"&&(t=HI(t));for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o)for(var h=e[o],d=h.length,a=r[o]=new Array(d),v,T,E=0;E<d;++E)(v=h[E])&&(T=t.call(v,v.__data__,E,h))&&("__data__"in v&&(T.__data__=v.__data__),a[E]=T);return new gs(r,this._parents)}function Xz(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function x7(){return[]}function Jz(t){return t==null?x7:function(){return this.querySelectorAll(t)}}function w7(t){return function(){return Xz(t.apply(this,arguments))}}function S7(t){typeof t=="function"?t=w7(t):t=Jz(t);for(var e=this._groups,i=e.length,r=[],o=[],h=0;h<i;++h)for(var d=e[h],a=d.length,v,T=0;T<a;++T)(v=d[T])&&(r.push(t.call(v,v.__data__,T,d)),o.push(v));return new gs(r,o)}function Kz(t){return function(){return this.matches(t)}}function Qz(t){return function(e){return e.matches(t)}}var T7=Array.prototype.find;function C7(t){return function(){return T7.call(this.children,t)}}function E7(){return this.firstElementChild}function I7(t){return this.select(t==null?E7:C7(typeof t=="function"?t:Qz(t)))}var $7=Array.prototype.filter;function P7(){return Array.from(this.children)}function M7(t){return function(){return $7.call(this.children,t)}}function k7(t){return this.selectAll(t==null?P7:M7(typeof t=="function"?t:Qz(t)))}function A7(t){typeof t!="function"&&(t=Kz(t));for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o)for(var h=e[o],d=h.length,a=r[o]=[],v,T=0;T<d;++T)(v=h[T])&&t.call(v,v.__data__,T,h)&&a.push(v);return new gs(r,this._parents)}function eO(t){return new Array(t.length)}function D7(){return new gs(this._enter||this._groups.map(eO),this._parents)}function hx(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}hx.prototype={constructor:hx,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function z7(t){return function(){return t}}function O7(t,e,i,r,o,h){for(var d=0,a,v=e.length,T=h.length;d<T;++d)(a=e[d])?(a.__data__=h[d],r[d]=a):i[d]=new hx(t,h[d]);for(;d<v;++d)(a=e[d])&&(o[d]=a)}function R7(t,e,i,r,o,h,d){var a,v,T=new Map,E=e.length,k=h.length,L=new Array(E),O;for(a=0;a<E;++a)(v=e[a])&&(L[a]=O=d.call(v,v.__data__,a,e)+"",T.has(O)?o[a]=v:T.set(O,v));for(a=0;a<k;++a)O=d.call(t,h[a],a,h)+"",(v=T.get(O))?(r[a]=v,v.__data__=h[a],T.delete(O)):i[a]=new hx(t,h[a]);for(a=0;a<E;++a)(v=e[a])&&T.get(L[a])===v&&(o[a]=v)}function L7(t){return t.__data__}function F7(t,e){if(!arguments.length)return Array.from(this,L7);var i=e?R7:O7,r=this._parents,o=this._groups;typeof t!="function"&&(t=z7(t));for(var h=o.length,d=new Array(h),a=new Array(h),v=new Array(h),T=0;T<h;++T){var E=r[T],k=o[T],L=k.length,O=N7(t.call(E,E&&E.__data__,T,r)),H=O.length,ie=a[T]=new Array(H),pe=d[T]=new Array(H),be=v[T]=new Array(L);i(E,k,ie,pe,be,O,e);for(var Ce=0,Pe=0,Ie,ke;Ce<H;++Ce)if(Ie=ie[Ce]){for(Ce>=Pe&&(Pe=Ce+1);!(ke=pe[Pe])&&++Pe<H;);Ie._next=ke||null}}return d=new gs(d,r),d._enter=a,d._exit=v,d}function N7(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function B7(){return new gs(this._exit||this._groups.map(eO),this._parents)}function j7(t,e,i){var r=this.enter(),o=this,h=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(o=e(o),o&&(o=o.selection())),i==null?h.remove():i(h),r&&o?r.merge(o).order():o}function U7(t){for(var e=t.selection?t.selection():t,i=this._groups,r=e._groups,o=i.length,h=r.length,d=Math.min(o,h),a=new Array(o),v=0;v<d;++v)for(var T=i[v],E=r[v],k=T.length,L=a[v]=new Array(k),O,H=0;H<k;++H)(O=T[H]||E[H])&&(L[H]=O);for(;v<o;++v)a[v]=i[v];return new gs(a,this._parents)}function V7(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var r=t[e],o=r.length-1,h=r[o],d;--o>=0;)(d=r[o])&&(h&&d.compareDocumentPosition(h)^4&&h.parentNode.insertBefore(d,h),h=d);return this}function G7(t){t||(t=q7);function e(k,L){return k&&L?t(k.__data__,L.__data__):!k-!L}for(var i=this._groups,r=i.length,o=new Array(r),h=0;h<r;++h){for(var d=i[h],a=d.length,v=o[h]=new Array(a),T,E=0;E<a;++E)(T=d[E])&&(v[E]=T);v.sort(e)}return new gs(o,this._parents).order()}function q7(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function H7(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Z7(){return Array.from(this)}function W7(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r=t[e],o=0,h=r.length;o<h;++o){var d=r[o];if(d)return d}return null}function Y7(){let t=0;for(const e of this)++t;return t}function X7(){return!this.node()}function J7(t){for(var e=this._groups,i=0,r=e.length;i<r;++i)for(var o=e[i],h=0,d=o.length,a;h<d;++h)(a=o[h])&&t.call(a,a.__data__,h,o);return this}function K7(t){return function(){this.removeAttribute(t)}}function Q7(t){return function(){this.removeAttributeNS(t.space,t.local)}}function eU(t,e){return function(){this.setAttribute(t,e)}}function tU(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function iU(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttribute(t):this.setAttribute(t,i)}}function rU(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function nU(t,e){var i=H1(t);if(arguments.length<2){var r=this.node();return i.local?r.getAttributeNS(i.space,i.local):r.getAttribute(i)}return this.each((e==null?i.local?Q7:K7:typeof e=="function"?i.local?rU:iU:i.local?tU:eU)(i,e))}function tO(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function sU(t){return function(){this.style.removeProperty(t)}}function oU(t,e,i){return function(){this.style.setProperty(t,e,i)}}function aU(t,e,i){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,i)}}function lU(t,e,i){return arguments.length>1?this.each((e==null?sU:typeof e=="function"?aU:oU)(t,e,i??"")):Jf(this.node(),t)}function Jf(t,e){return t.style.getPropertyValue(e)||tO(t).getComputedStyle(t,null).getPropertyValue(e)}function cU(t){return function(){delete this[t]}}function uU(t,e){return function(){this[t]=e}}function hU(t,e){return function(){var i=e.apply(this,arguments);i==null?delete this[t]:this[t]=i}}function dU(t,e){return arguments.length>1?this.each((e==null?cU:typeof e=="function"?hU:uU)(t,e)):this.node()[t]}function iO(t){return t.trim().split(/^|\s+/)}function ZI(t){return t.classList||new rO(t)}function rO(t){this._node=t,this._names=iO(t.getAttribute("class")||"")}rO.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function nO(t,e){for(var i=ZI(t),r=-1,o=e.length;++r<o;)i.add(e[r])}function sO(t,e){for(var i=ZI(t),r=-1,o=e.length;++r<o;)i.remove(e[r])}function pU(t){return function(){nO(this,t)}}function fU(t){return function(){sO(this,t)}}function mU(t,e){return function(){(e.apply(this,arguments)?nO:sO)(this,t)}}function gU(t,e){var i=iO(t+"");if(arguments.length<2){for(var r=ZI(this.node()),o=-1,h=i.length;++o<h;)if(!r.contains(i[o]))return!1;return!0}return this.each((typeof e=="function"?mU:e?pU:fU)(i,e))}function yU(){this.textContent=""}function vU(t){return function(){this.textContent=t}}function _U(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function bU(t){return arguments.length?this.each(t==null?yU:(typeof t=="function"?_U:vU)(t)):this.node().textContent}function xU(){this.innerHTML=""}function wU(t){return function(){this.innerHTML=t}}function SU(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function TU(t){return arguments.length?this.each(t==null?xU:(typeof t=="function"?SU:wU)(t)):this.node().innerHTML}function CU(){this.nextSibling&&this.parentNode.appendChild(this)}function EU(){return this.each(CU)}function IU(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $U(){return this.each(IU)}function PU(t){var e=typeof t=="function"?t:Yz(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function MU(){return null}function kU(t,e){var i=typeof t=="function"?t:Yz(t),r=e==null?MU:typeof e=="function"?e:HI(e);return this.select(function(){return this.insertBefore(i.apply(this,arguments),r.apply(this,arguments)||null)})}function AU(){var t=this.parentNode;t&&t.removeChild(this)}function DU(){return this.each(AU)}function zU(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function OU(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function RU(t){return this.select(t?OU:zU)}function LU(t){return arguments.length?this.property("__data__",t):this.node().__data__}function FU(t){return function(e){t.call(this,e,this.__data__)}}function NU(t){return t.trim().split(/^|\s+/).map(function(e){var i="",r=e.indexOf(".");return r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),{type:e,name:i}})}function BU(t){return function(){var e=this.__on;if(e){for(var i=0,r=-1,o=e.length,h;i<o;++i)h=e[i],(!t.type||h.type===t.type)&&h.name===t.name?this.removeEventListener(h.type,h.listener,h.options):e[++r]=h;++r?e.length=r:delete this.__on}}}function jU(t,e,i){return function(){var r=this.__on,o,h=FU(e);if(r){for(var d=0,a=r.length;d<a;++d)if((o=r[d]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=h,o.options=i),o.value=e;return}}this.addEventListener(t.type,h,i),o={type:t.type,name:t.name,value:e,listener:h,options:i},r?r.push(o):this.__on=[o]}}function UU(t,e,i){var r=NU(t+""),o,h=r.length,d;if(arguments.length<2){var a=this.node().__on;if(a){for(var v=0,T=a.length,E;v<T;++v)for(o=0,E=a[v];o<h;++o)if((d=r[o]).type===E.type&&d.name===E.name)return E.value}return}for(a=e?jU:BU,o=0;o<h;++o)this.each(a(r[o],e,i));return this}function oO(t,e,i){var r=tO(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,i):(o=r.document.createEvent("Event"),i?(o.initEvent(e,i.bubbles,i.cancelable),o.detail=i.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function VU(t,e){return function(){return oO(this,t,e)}}function GU(t,e){return function(){return oO(this,t,e.apply(this,arguments))}}function qU(t,e){return this.each((typeof e=="function"?GU:VU)(t,e))}function*HU(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r=t[e],o=0,h=r.length,d;o<h;++o)(d=r[o])&&(yield d)}var WI=[null];function gs(t,e){this._groups=t,this._parents=e}function Y0(){return new gs([[document.documentElement]],WI)}function ZU(){return this}gs.prototype=Y0.prototype={constructor:gs,select:b7,selectAll:S7,selectChild:I7,selectChildren:k7,filter:A7,data:F7,enter:D7,exit:B7,join:j7,merge:U7,selection:ZU,order:V7,sort:G7,call:H7,nodes:Z7,node:W7,size:Y7,empty:X7,each:J7,attr:nU,style:lU,property:dU,classed:gU,text:bU,html:TU,raise:EU,lower:$U,append:PU,insert:kU,remove:DU,clone:RU,datum:LU,on:UU,dispatch:qU,[Symbol.iterator]:HU};function Ph(t){return typeof t=="string"?new gs([[document.querySelector(t)]],[document.documentElement]):new gs([[t]],WI)}function Yl(t){return typeof t=="string"?new gs([document.querySelectorAll(t)],[document.documentElement]):new gs([Xz(t)],WI)}function YI(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function aO(t,e){var i=Object.create(t.prototype);for(var r in e)i[r]=e[r];return i}function X0(){}var c0=.7,dx=1/c0,$f="\\s*([+-]?\\d+)\\s*",u0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",fl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",WU=/^#([0-9a-f]{3,8})$/,YU=new RegExp(`^rgb\\(${$f},${$f},${$f}\\)$`),XU=new RegExp(`^rgb\\(${fl},${fl},${fl}\\)$`),JU=new RegExp(`^rgba\\(${$f},${$f},${$f},${u0}\\)$`),KU=new RegExp(`^rgba\\(${fl},${fl},${fl},${u0}\\)$`),QU=new RegExp(`^hsl\\(${u0},${fl},${fl}\\)$`),eV=new RegExp(`^hsla\\(${u0},${fl},${fl},${u0}\\)$`),Xk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};YI(X0,md,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Jk,formatHex:Jk,formatHex8:tV,formatHsl:iV,formatRgb:Kk,toString:Kk});function Jk(){return this.rgb().formatHex()}function tV(){return this.rgb().formatHex8()}function iV(){return lO(this).formatHsl()}function Kk(){return this.rgb().formatRgb()}function md(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=WU.exec(t))?(i=e[1].length,e=parseInt(e[1],16),i===6?Qk(e):i===3?new Ds(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):i===8?M_(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):i===4?M_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=YU.exec(t))?new Ds(e[1],e[2],e[3],1):(e=XU.exec(t))?new Ds(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=JU.exec(t))?M_(e[1],e[2],e[3],e[4]):(e=KU.exec(t))?M_(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=QU.exec(t))?i3(e[1],e[2]/100,e[3]/100,1):(e=eV.exec(t))?i3(e[1],e[2]/100,e[3]/100,e[4]):Xk.hasOwnProperty(t)?Qk(Xk[t]):t==="transparent"?new Ds(NaN,NaN,NaN,0):null}function Qk(t){return new Ds(t>>16&255,t>>8&255,t&255,1)}function M_(t,e,i,r){return r<=0&&(t=e=i=NaN),new Ds(t,e,i,r)}function rV(t){return t instanceof X0||(t=md(t)),t?(t=t.rgb(),new Ds(t.r,t.g,t.b,t.opacity)):new Ds}function VT(t,e,i,r){return arguments.length===1?rV(t):new Ds(t,e,i,r??1)}function Ds(t,e,i,r){this.r=+t,this.g=+e,this.b=+i,this.opacity=+r}YI(Ds,VT,aO(X0,{brighter(t){return t=t==null?dx:Math.pow(dx,t),new Ds(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?c0:Math.pow(c0,t),new Ds(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ds(ad(this.r),ad(this.g),ad(this.b),px(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:e3,formatHex:e3,formatHex8:nV,formatRgb:t3,toString:t3}));function e3(){return`#${ed(this.r)}${ed(this.g)}${ed(this.b)}`}function nV(){return`#${ed(this.r)}${ed(this.g)}${ed(this.b)}${ed((isNaN(this.opacity)?1:this.opacity)*255)}`}function t3(){const t=px(this.opacity);return`${t===1?"rgb(":"rgba("}${ad(this.r)}, ${ad(this.g)}, ${ad(this.b)}${t===1?")":`, ${t})`}`}function px(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ad(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ed(t){return t=ad(t),(t<16?"0":"")+t.toString(16)}function i3(t,e,i,r){return r<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new _a(t,e,i,r)}function lO(t){if(t instanceof _a)return new _a(t.h,t.s,t.l,t.opacity);if(t instanceof X0||(t=md(t)),!t)return new _a;if(t instanceof _a)return t;t=t.rgb();var e=t.r/255,i=t.g/255,r=t.b/255,o=Math.min(e,i,r),h=Math.max(e,i,r),d=NaN,a=h-o,v=(h+o)/2;return a?(e===h?d=(i-r)/a+(i<r)*6:i===h?d=(r-e)/a+2:d=(e-i)/a+4,a/=v<.5?h+o:2-h-o,d*=60):a=v>0&&v<1?0:d,new _a(d,a,v,t.opacity)}function sV(t,e,i,r){return arguments.length===1?lO(t):new _a(t,e,i,r??1)}function _a(t,e,i,r){this.h=+t,this.s=+e,this.l=+i,this.opacity=+r}YI(_a,sV,aO(X0,{brighter(t){return t=t==null?dx:Math.pow(dx,t),new _a(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?c0:Math.pow(c0,t),new _a(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,r=i+(i<.5?i:1-i)*e,o=2*i-r;return new Ds(mS(t>=240?t-240:t+120,o,r),mS(t,o,r),mS(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new _a(r3(this.h),k_(this.s),k_(this.l),px(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=px(this.opacity);return`${t===1?"hsl(":"hsla("}${r3(this.h)}, ${k_(this.s)*100}%, ${k_(this.l)*100}%${t===1?")":`, ${t})`}`}}));function r3(t){return t=(t||0)%360,t<0?t+360:t}function k_(t){return Math.max(0,Math.min(1,t||0))}function mS(t,e,i){return(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)*255}const XI=t=>()=>t;function oV(t,e){return function(i){return t+i*e}}function aV(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(r){return Math.pow(t+r*e,i)}}function lV(t){return(t=+t)==1?cO:function(e,i){return i-e?aV(e,i,t):XI(isNaN(e)?i:e)}}function cO(t,e){var i=e-t;return i?oV(t,i):XI(isNaN(t)?e:t)}const fx=(function t(e){var i=lV(e);function r(o,h){var d=i((o=VT(o)).r,(h=VT(h)).r),a=i(o.g,h.g),v=i(o.b,h.b),T=cO(o.opacity,h.opacity);return function(E){return o.r=d(E),o.g=a(E),o.b=v(E),o.opacity=T(E),o+""}}return r.gamma=t,r})(1);function cV(t,e){e||(e=[]);var i=t?Math.min(e.length,t.length):0,r=e.slice(),o;return function(h){for(o=0;o<i;++o)r[o]=t[o]*(1-h)+e[o]*h;return r}}function uV(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function hV(t,e){var i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),h=new Array(i),d;for(d=0;d<r;++d)o[d]=JI(t[d],e[d]);for(;d<i;++d)h[d]=e[d];return function(a){for(d=0;d<r;++d)h[d]=o[d](a);return h}}function dV(t,e){var i=new Date;return t=+t,e=+e,function(r){return i.setTime(t*(1-r)+e*r),i}}function va(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}function pV(t,e){var i={},r={},o;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(o in e)o in t?i[o]=JI(t[o],e[o]):r[o]=e[o];return function(h){for(o in i)r[o]=i[o](h);return r}}var GT=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gS=new RegExp(GT.source,"g");function fV(t){return function(){return t}}function mV(t){return function(e){return t(e)+""}}function uO(t,e){var i=GT.lastIndex=gS.lastIndex=0,r,o,h,d=-1,a=[],v=[];for(t=t+"",e=e+"";(r=GT.exec(t))&&(o=gS.exec(e));)(h=o.index)>i&&(h=e.slice(i,h),a[d]?a[d]+=h:a[++d]=h),(r=r[0])===(o=o[0])?a[d]?a[d]+=o:a[++d]=o:(a[++d]=null,v.push({i:d,x:va(r,o)})),i=gS.lastIndex;return i<e.length&&(h=e.slice(i),a[d]?a[d]+=h:a[++d]=h),a.length<2?v[0]?mV(v[0].x):fV(e):(e=v.length,function(T){for(var E=0,k;E<e;++E)a[(k=v[E]).i]=k.x(T);return a.join("")})}function JI(t,e){var i=typeof e,r;return e==null||i==="boolean"?XI(e):(i==="number"?va:i==="string"?(r=md(e))?(e=r,fx):uO:e instanceof md?fx:e instanceof Date?dV:uV(e)?cV:Array.isArray(e)?hV:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?pV:va)(t,e)}function gV(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}}var n3=180/Math.PI,qT={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hO(t,e,i,r,o,h){var d,a,v;return(d=Math.sqrt(t*t+e*e))&&(t/=d,e/=d),(v=t*i+e*r)&&(i-=t*v,r-=e*v),(a=Math.sqrt(i*i+r*r))&&(i/=a,r/=a,v/=a),t*r<e*i&&(t=-t,e=-e,v=-v,d=-d),{translateX:o,translateY:h,rotate:Math.atan2(e,t)*n3,skewX:Math.atan(v)*n3,scaleX:d,scaleY:a}}var A_;function yV(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?qT:hO(e.a,e.b,e.c,e.d,e.e,e.f)}function vV(t){return t==null||(A_||(A_=document.createElementNS("http://www.w3.org/2000/svg","g")),A_.setAttribute("transform",t),!(t=A_.transform.baseVal.consolidate()))?qT:(t=t.matrix,hO(t.a,t.b,t.c,t.d,t.e,t.f))}function dO(t,e,i,r){function o(T){return T.length?T.pop()+" ":""}function h(T,E,k,L,O,H){if(T!==k||E!==L){var ie=O.push("translate(",null,e,null,i);H.push({i:ie-4,x:va(T,k)},{i:ie-2,x:va(E,L)})}else(k||L)&&O.push("translate("+k+e+L+i)}function d(T,E,k,L){T!==E?(T-E>180?E+=360:E-T>180&&(T+=360),L.push({i:k.push(o(k)+"rotate(",null,r)-2,x:va(T,E)})):E&&k.push(o(k)+"rotate("+E+r)}function a(T,E,k,L){T!==E?L.push({i:k.push(o(k)+"skewX(",null,r)-2,x:va(T,E)}):E&&k.push(o(k)+"skewX("+E+r)}function v(T,E,k,L,O,H){if(T!==k||E!==L){var ie=O.push(o(O)+"scale(",null,",",null,")");H.push({i:ie-4,x:va(T,k)},{i:ie-2,x:va(E,L)})}else(k!==1||L!==1)&&O.push(o(O)+"scale("+k+","+L+")")}return function(T,E){var k=[],L=[];return T=t(T),E=t(E),h(T.translateX,T.translateY,E.translateX,E.translateY,k,L),d(T.rotate,E.rotate,k,L),a(T.skewX,E.skewX,k,L),v(T.scaleX,T.scaleY,E.scaleX,E.scaleY,k,L),T=E=null,function(O){for(var H=-1,ie=L.length,pe;++H<ie;)k[(pe=L[H]).i]=pe.x(O);return k.join("")}}}var _V=dO(yV,"px, ","px)","deg)"),bV=dO(vV,", ",")",")"),Kf=0,uy=0,Zg=0,pO=1e3,mx,hy,gx=0,gd=0,Z1=0,h0=typeof performance=="object"&&performance.now?performance:Date,fO=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function KI(){return gd||(fO(xV),gd=h0.now()+Z1)}function xV(){gd=0}function yx(){this._call=this._time=this._next=null}yx.prototype=mO.prototype={constructor:yx,restart:function(t,e,i){if(typeof t!="function")throw new TypeError("callback is not a function");i=(i==null?KI():+i)+(e==null?0:+e),!this._next&&hy!==this&&(hy?hy._next=this:mx=this,hy=this),this._call=t,this._time=i,HT()},stop:function(){this._call&&(this._call=null,this._time=1/0,HT())}};function mO(t,e,i){var r=new yx;return r.restart(t,e,i),r}function wV(){KI(),++Kf;for(var t=mx,e;t;)(e=gd-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Kf}function s3(){gd=(gx=h0.now())+Z1,Kf=uy=0;try{wV()}finally{Kf=0,TV(),gd=0}}function SV(){var t=h0.now(),e=t-gx;e>pO&&(Z1-=e,gx=t)}function TV(){for(var t,e=mx,i,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(i=e._next,e._next=null,e=t?t._next=i:mx=i);hy=t,HT(r)}function HT(t){if(!Kf){uy&&(uy=clearTimeout(uy));var e=t-gd;e>24?(t<1/0&&(uy=setTimeout(s3,t-h0.now()-Z1)),Zg&&(Zg=clearInterval(Zg))):(Zg||(gx=h0.now(),Zg=setInterval(SV,pO)),Kf=1,fO(s3))}}function o3(t,e,i){var r=new yx;return e=e==null?0:+e,r.restart(o=>{r.stop(),t(o+e)},e,i),r}var CV=Wz("start","end","cancel","interrupt"),EV=[],gO=0,a3=1,ZT=2,ub=3,l3=4,WT=5,hb=6;function W1(t,e,i,r,o,h){var d=t.__transition;if(!d)t.__transition={};else if(i in d)return;IV(t,i,{name:e,index:r,group:o,on:CV,tween:EV,time:h.time,delay:h.delay,duration:h.duration,ease:h.ease,timer:null,state:gO})}function QI(t,e){var i=Ma(t,e);if(i.state>gO)throw new Error("too late; already scheduled");return i}function Sl(t,e){var i=Ma(t,e);if(i.state>ub)throw new Error("too late; already running");return i}function Ma(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function IV(t,e,i){var r=t.__transition,o;r[e]=i,i.timer=mO(h,0,i.time);function h(T){i.state=a3,i.timer.restart(d,i.delay,i.time),i.delay<=T&&d(T-i.delay)}function d(T){var E,k,L,O;if(i.state!==a3)return v();for(E in r)if(O=r[E],O.name===i.name){if(O.state===ub)return o3(d);O.state===l3?(O.state=hb,O.timer.stop(),O.on.call("interrupt",t,t.__data__,O.index,O.group),delete r[E]):+E<e&&(O.state=hb,O.timer.stop(),O.on.call("cancel",t,t.__data__,O.index,O.group),delete r[E])}if(o3(function(){i.state===ub&&(i.state=l3,i.timer.restart(a,i.delay,i.time),a(T))}),i.state=ZT,i.on.call("start",t,t.__data__,i.index,i.group),i.state===ZT){for(i.state=ub,o=new Array(L=i.tween.length),E=0,k=-1;E<L;++E)(O=i.tween[E].value.call(t,t.__data__,i.index,i.group))&&(o[++k]=O);o.length=k+1}}function a(T){for(var E=T<i.duration?i.ease.call(null,T/i.duration):(i.timer.restart(v),i.state=WT,1),k=-1,L=o.length;++k<L;)o[k].call(t,E);i.state===WT&&(i.on.call("end",t,t.__data__,i.index,i.group),v())}function v(){i.state=hb,i.timer.stop(),delete r[e];for(var T in r)return;delete t.__transition}}function $V(t,e){var i=t.__transition,r,o,h=!0,d;if(i){e=e==null?null:e+"";for(d in i){if((r=i[d]).name!==e){h=!1;continue}o=r.state>ZT&&r.state<WT,r.state=hb,r.timer.stop(),r.on.call(o?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete i[d]}h&&delete t.__transition}}function PV(t){return this.each(function(){$V(this,t)})}function MV(t,e){var i,r;return function(){var o=Sl(this,t),h=o.tween;if(h!==i){r=i=h;for(var d=0,a=r.length;d<a;++d)if(r[d].name===e){r=r.slice(),r.splice(d,1);break}}o.tween=r}}function kV(t,e,i){var r,o;if(typeof i!="function")throw new Error;return function(){var h=Sl(this,t),d=h.tween;if(d!==r){o=(r=d).slice();for(var a={name:e,value:i},v=0,T=o.length;v<T;++v)if(o[v].name===e){o[v]=a;break}v===T&&o.push(a)}h.tween=o}}function AV(t,e){var i=this._id;if(t+="",arguments.length<2){for(var r=Ma(this.node(),i).tween,o=0,h=r.length,d;o<h;++o)if((d=r[o]).name===t)return d.value;return null}return this.each((e==null?MV:kV)(i,t,e))}function e$(t,e,i){var r=t._id;return t.each(function(){var o=Sl(this,r);(o.value||(o.value={}))[e]=i.apply(this,arguments)}),function(o){return Ma(o,r).value[e]}}function yO(t,e){var i;return(typeof e=="number"?va:e instanceof md?fx:(i=md(e))?(e=i,fx):uO)(t,e)}function DV(t){return function(){this.removeAttribute(t)}}function zV(t){return function(){this.removeAttributeNS(t.space,t.local)}}function OV(t,e,i){var r,o=i+"",h;return function(){var d=this.getAttribute(t);return d===o?null:d===r?h:h=e(r=d,i)}}function RV(t,e,i){var r,o=i+"",h;return function(){var d=this.getAttributeNS(t.space,t.local);return d===o?null:d===r?h:h=e(r=d,i)}}function LV(t,e,i){var r,o,h;return function(){var d,a=i(this),v;return a==null?void this.removeAttribute(t):(d=this.getAttribute(t),v=a+"",d===v?null:d===r&&v===o?h:(o=v,h=e(r=d,a)))}}function FV(t,e,i){var r,o,h;return function(){var d,a=i(this),v;return a==null?void this.removeAttributeNS(t.space,t.local):(d=this.getAttributeNS(t.space,t.local),v=a+"",d===v?null:d===r&&v===o?h:(o=v,h=e(r=d,a)))}}function NV(t,e){var i=H1(t),r=i==="transform"?bV:yO;return this.attrTween(t,typeof e=="function"?(i.local?FV:LV)(i,r,e$(this,"attr."+t,e)):e==null?(i.local?zV:DV)(i):(i.local?RV:OV)(i,r,e))}function BV(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function jV(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function UV(t,e){var i,r;function o(){var h=e.apply(this,arguments);return h!==r&&(i=(r=h)&&jV(t,h)),i}return o._value=e,o}function VV(t,e){var i,r;function o(){var h=e.apply(this,arguments);return h!==r&&(i=(r=h)&&BV(t,h)),i}return o._value=e,o}function GV(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;var r=H1(t);return this.tween(i,(r.local?UV:VV)(r,e))}function qV(t,e){return function(){QI(this,t).delay=+e.apply(this,arguments)}}function HV(t,e){return e=+e,function(){QI(this,t).delay=e}}function ZV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?qV:HV)(e,t)):Ma(this.node(),e).delay}function WV(t,e){return function(){Sl(this,t).duration=+e.apply(this,arguments)}}function YV(t,e){return e=+e,function(){Sl(this,t).duration=e}}function XV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?WV:YV)(e,t)):Ma(this.node(),e).duration}function JV(t,e){if(typeof e!="function")throw new Error;return function(){Sl(this,t).ease=e}}function KV(t){var e=this._id;return arguments.length?this.each(JV(e,t)):Ma(this.node(),e).ease}function QV(t,e){return function(){var i=e.apply(this,arguments);if(typeof i!="function")throw new Error;Sl(this,t).ease=i}}function eG(t){if(typeof t!="function")throw new Error;return this.each(QV(this._id,t))}function tG(t){typeof t!="function"&&(t=Kz(t));for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o)for(var h=e[o],d=h.length,a=r[o]=[],v,T=0;T<d;++T)(v=h[T])&&t.call(v,v.__data__,T,h)&&a.push(v);return new yc(r,this._parents,this._name,this._id)}function iG(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,r=e.length,o=i.length,h=Math.min(r,o),d=new Array(r),a=0;a<h;++a)for(var v=e[a],T=i[a],E=v.length,k=d[a]=new Array(E),L,O=0;O<E;++O)(L=v[O]||T[O])&&(k[O]=L);for(;a<r;++a)d[a]=e[a];return new yc(d,this._parents,this._name,this._id)}function rG(t){return(t+"").trim().split(/^|\s+/).every(function(e){var i=e.indexOf(".");return i>=0&&(e=e.slice(0,i)),!e||e==="start"})}function nG(t,e,i){var r,o,h=rG(e)?QI:Sl;return function(){var d=h(this,t),a=d.on;a!==r&&(o=(r=a).copy()).on(e,i),d.on=o}}function sG(t,e){var i=this._id;return arguments.length<2?Ma(this.node(),i).on.on(t):this.each(nG(i,t,e))}function oG(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}function aG(){return this.on("end.remove",oG(this._id))}function lG(t){var e=this._name,i=this._id;typeof t!="function"&&(t=HI(t));for(var r=this._groups,o=r.length,h=new Array(o),d=0;d<o;++d)for(var a=r[d],v=a.length,T=h[d]=new Array(v),E,k,L=0;L<v;++L)(E=a[L])&&(k=t.call(E,E.__data__,L,a))&&("__data__"in E&&(k.__data__=E.__data__),T[L]=k,W1(T[L],e,i,L,T,Ma(E,i)));return new yc(h,this._parents,e,i)}function cG(t){var e=this._name,i=this._id;typeof t!="function"&&(t=Jz(t));for(var r=this._groups,o=r.length,h=[],d=[],a=0;a<o;++a)for(var v=r[a],T=v.length,E,k=0;k<T;++k)if(E=v[k]){for(var L=t.call(E,E.__data__,k,v),O,H=Ma(E,i),ie=0,pe=L.length;ie<pe;++ie)(O=L[ie])&&W1(O,e,i,ie,L,H);h.push(L),d.push(E)}return new yc(h,d,e,i)}var uG=Y0.prototype.constructor;function hG(){return new uG(this._groups,this._parents)}function dG(t,e){var i,r,o;return function(){var h=Jf(this,t),d=(this.style.removeProperty(t),Jf(this,t));return h===d?null:h===i&&d===r?o:o=e(i=h,r=d)}}function vO(t){return function(){this.style.removeProperty(t)}}function pG(t,e,i){var r,o=i+"",h;return function(){var d=Jf(this,t);return d===o?null:d===r?h:h=e(r=d,i)}}function fG(t,e,i){var r,o,h;return function(){var d=Jf(this,t),a=i(this),v=a+"";return a==null&&(v=a=(this.style.removeProperty(t),Jf(this,t))),d===v?null:d===r&&v===o?h:(o=v,h=e(r=d,a))}}function mG(t,e){var i,r,o,h="style."+e,d="end."+h,a;return function(){var v=Sl(this,t),T=v.on,E=v.value[h]==null?a||(a=vO(e)):void 0;(T!==i||o!==E)&&(r=(i=T).copy()).on(d,o=E),v.on=r}}function gG(t,e,i){var r=(t+="")=="transform"?_V:yO;return e==null?this.styleTween(t,dG(t,r)).on("end.style."+t,vO(t)):typeof e=="function"?this.styleTween(t,fG(t,r,e$(this,"style."+t,e))).each(mG(this._id,t)):this.styleTween(t,pG(t,r,e),i).on("end.style."+t,null)}function yG(t,e,i){return function(r){this.style.setProperty(t,e.call(this,r),i)}}function vG(t,e,i){var r,o;function h(){var d=e.apply(this,arguments);return d!==o&&(r=(o=d)&&yG(t,d,i)),r}return h._value=e,h}function _G(t,e,i){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,vG(t,e,i??""))}function bG(t){return function(){this.textContent=t}}function xG(t){return function(){var e=t(this);this.textContent=e??""}}function wG(t){return this.tween("text",typeof t=="function"?xG(e$(this,"text",t)):bG(t==null?"":t+""))}function SG(t){return function(e){this.textContent=t.call(this,e)}}function TG(t){var e,i;function r(){var o=t.apply(this,arguments);return o!==i&&(e=(i=o)&&SG(o)),e}return r._value=t,r}function CG(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,TG(t))}function EG(){for(var t=this._name,e=this._id,i=_O(),r=this._groups,o=r.length,h=0;h<o;++h)for(var d=r[h],a=d.length,v,T=0;T<a;++T)if(v=d[T]){var E=Ma(v,e);W1(v,t,i,T,d,{time:E.time+E.delay+E.duration,delay:0,duration:E.duration,ease:E.ease})}return new yc(r,this._parents,t,i)}function IG(){var t,e,i=this,r=i._id,o=i.size();return new Promise(function(h,d){var a={value:d},v={value:function(){--o===0&&h()}};i.each(function(){var T=Sl(this,r),E=T.on;E!==t&&(e=(t=E).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(v)),T.on=e}),o===0&&h()})}var $G=0;function yc(t,e,i,r){this._groups=t,this._parents=e,this._name=i,this._id=r}function _O(){return++$G}var Xl=Y0.prototype;yc.prototype={constructor:yc,select:lG,selectAll:cG,selectChild:Xl.selectChild,selectChildren:Xl.selectChildren,filter:tG,merge:iG,selection:hG,transition:EG,call:Xl.call,nodes:Xl.nodes,node:Xl.node,size:Xl.size,empty:Xl.empty,each:Xl.each,on:sG,attr:NV,attrTween:GV,style:gG,styleTween:_G,text:wG,textTween:CG,remove:aG,tween:AV,delay:ZV,duration:XV,ease:KV,easeVarying:eG,end:IG,[Symbol.iterator]:Xl[Symbol.iterator]};function PG(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var MG={time:null,delay:0,duration:250,ease:PG};function kG(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}function AG(t){var e,i;t instanceof yc?(e=t._id,t=t._name):(e=_O(),(i=MG).time=KI(),t=t==null?null:t+"");for(var r=this._groups,o=r.length,h=0;h<o;++h)for(var d=r[h],a=d.length,v,T=0;T<a;++T)(v=d[T])&&W1(v,t,e,T,d,i||kG(v,e));return new yc(r,this._parents,t,e)}Y0.prototype.interrupt=PV;Y0.prototype.transition=AG;const YT=Math.PI,XT=2*YT,Lh=1e-6,DG=XT-Lh;function bO(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=arguments[e]+t[e]}function zG(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return bO;const i=10**e;return function(r){this._+=r[0];for(let o=1,h=r.length;o<h;++o)this._+=Math.round(arguments[o]*i)/i+r[o]}}class OG{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?bO:zG(e)}moveTo(e,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,i){this._append`L${this._x1=+e},${this._y1=+i}`}quadraticCurveTo(e,i,r,o){this._append`Q${+e},${+i},${this._x1=+r},${this._y1=+o}`}bezierCurveTo(e,i,r,o,h,d){this._append`C${+e},${+i},${+r},${+o},${this._x1=+h},${this._y1=+d}`}arcTo(e,i,r,o,h){if(e=+e,i=+i,r=+r,o=+o,h=+h,h<0)throw new Error(`negative radius: ${h}`);let d=this._x1,a=this._y1,v=r-e,T=o-i,E=d-e,k=a-i,L=E*E+k*k;if(this._x1===null)this._append`M${this._x1=e},${this._y1=i}`;else if(L>Lh)if(!(Math.abs(k*v-T*E)>Lh)||!h)this._append`L${this._x1=e},${this._y1=i}`;else{let O=r-d,H=o-a,ie=v*v+T*T,pe=O*O+H*H,be=Math.sqrt(ie),Ce=Math.sqrt(L),Pe=h*Math.tan((YT-Math.acos((ie+L-pe)/(2*be*Ce)))/2),Ie=Pe/Ce,ke=Pe/be;Math.abs(Ie-1)>Lh&&this._append`L${e+Ie*E},${i+Ie*k}`,this._append`A${h},${h},0,0,${+(k*O>E*H)},${this._x1=e+ke*v},${this._y1=i+ke*T}`}}arc(e,i,r,o,h,d){if(e=+e,i=+i,r=+r,d=!!d,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(o),v=r*Math.sin(o),T=e+a,E=i+v,k=1^d,L=d?o-h:h-o;this._x1===null?this._append`M${T},${E}`:(Math.abs(this._x1-T)>Lh||Math.abs(this._y1-E)>Lh)&&this._append`L${T},${E}`,r&&(L<0&&(L=L%XT+XT),L>DG?this._append`A${r},${r},0,1,${k},${e-a},${i-v}A${r},${r},0,1,${k},${this._x1=T},${this._y1=E}`:L>Lh&&this._append`A${r},${r},0,${+(L>=YT)},${k},${this._x1=e+r*Math.cos(h)},${this._y1=i+r*Math.sin(h)}`)}rect(e,i,r,o){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}h${r=+r}v${+o}h${-r}Z`}toString(){return this._}}function RG(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function vx(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,r=t.slice(0,i);return[r.length>1?r[0]+r.slice(2):r,+t.slice(i+1)]}function Qf(t){return t=vx(Math.abs(t)),t?t[1]:NaN}function LG(t,e){return function(i,r){for(var o=i.length,h=[],d=0,a=t[0],v=0;o>0&&a>0&&(v+a+1>r&&(a=Math.max(1,r-v)),h.push(i.substring(o-=a,o+a)),!((v+=a+1)>r));)a=t[d=(d+1)%t.length];return h.reverse().join(e)}}function FG(t){return function(e){return e.replace(/[0-9]/g,function(i){return t[+i]})}}var NG=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _x(t){if(!(e=NG.exec(t)))throw new Error("invalid format: "+t);var e;return new t$({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}_x.prototype=t$.prototype;function t$(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}t$.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function BG(t){e:for(var e=t.length,i=1,r=-1,o;i<e;++i)switch(t[i]){case".":r=o=i;break;case"0":r===0&&(r=i),o=i;break;default:if(!+t[i])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(o+1):t}var xO;function jG(t,e){var i=vx(t,e);if(!i)return t+"";var r=i[0],o=i[1],h=o-(xO=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,d=r.length;return h===d?r:h>d?r+new Array(h-d+1).join("0"):h>0?r.slice(0,h)+"."+r.slice(h):"0."+new Array(1-h).join("0")+vx(t,Math.max(0,e+h-1))[0]}function c3(t,e){var i=vx(t,e);if(!i)return t+"";var r=i[0],o=i[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}const u3={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:RG,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>c3(t*100,e),r:c3,s:jG,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function h3(t){return t}var d3=Array.prototype.map,p3=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function UG(t){var e=t.grouping===void 0||t.thousands===void 0?h3:LG(d3.call(t.grouping,Number),t.thousands+""),i=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",o=t.decimal===void 0?".":t.decimal+"",h=t.numerals===void 0?h3:FG(d3.call(t.numerals,String)),d=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",v=t.nan===void 0?"NaN":t.nan+"";function T(k){k=_x(k);var L=k.fill,O=k.align,H=k.sign,ie=k.symbol,pe=k.zero,be=k.width,Ce=k.comma,Pe=k.precision,Ie=k.trim,ke=k.type;ke==="n"?(Ce=!0,ke="g"):u3[ke]||(Pe===void 0&&(Pe=12),Ie=!0,ke="g"),(pe||L==="0"&&O==="=")&&(pe=!0,L="0",O="=");var Ke=ie==="$"?i:ie==="#"&&/[boxX]/.test(ke)?"0"+ke.toLowerCase():"",qe=ie==="$"?r:/[%p]/.test(ke)?d:"",dt=u3[ke],ft=/[defgprs%]/.test(ke);Pe=Pe===void 0?6:/[gprs]/.test(ke)?Math.max(1,Math.min(21,Pe)):Math.max(0,Math.min(20,Pe));function et(We){var Be=Ke,ge=qe,De,Je,Qe;if(ke==="c")ge=dt(We)+ge,We="";else{We=+We;var yt=We<0||1/We<0;if(We=isNaN(We)?v:dt(Math.abs(We),Pe),Ie&&(We=BG(We)),yt&&+We==0&&H!=="+"&&(yt=!1),Be=(yt?H==="("?H:a:H==="-"||H==="("?"":H)+Be,ge=(ke==="s"?p3[8+xO/3]:"")+ge+(yt&&H==="("?")":""),ft){for(De=-1,Je=We.length;++De<Je;)if(Qe=We.charCodeAt(De),48>Qe||Qe>57){ge=(Qe===46?o+We.slice(De+1):We.slice(De))+ge,We=We.slice(0,De);break}}}Ce&&!pe&&(We=e(We,1/0));var Et=Be.length+We.length+ge.length,Ye=Et<be?new Array(be-Et+1).join(L):"";switch(Ce&&pe&&(We=e(Ye+We,Ye.length?be-ge.length:1/0),Ye=""),O){case"<":We=Be+We+ge+Ye;break;case"=":We=Be+Ye+We+ge;break;case"^":We=Ye.slice(0,Et=Ye.length>>1)+Be+We+ge+Ye.slice(Et);break;default:We=Ye+Be+We+ge;break}return h(We)}return et.toString=function(){return k+""},et}function E(k,L){var O=T((k=_x(k),k.type="f",k)),H=Math.max(-8,Math.min(8,Math.floor(Qf(L)/3)))*3,ie=Math.pow(10,-H),pe=p3[8+H/3];return function(be){return O(ie*be)+pe}}return{format:T,formatPrefix:E}}var D_,wO,SO;VG({thousands:",",grouping:[3],currency:["$",""]});function VG(t){return D_=UG(t),wO=D_.format,SO=D_.formatPrefix,D_}function GG(t){return Math.max(0,-Qf(Math.abs(t)))}function qG(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qf(e)/3)))*3-Qf(Math.abs(t)))}function HG(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Qf(e)-Qf(t))+1}function TO(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const f3=Symbol("implicit");function CO(){var t=new Gk,e=[],i=[],r=f3;function o(h){let d=t.get(h);if(d===void 0){if(r!==f3)return r;t.set(h,d=e.push(h)-1)}return i[d%i.length]}return o.domain=function(h){if(!arguments.length)return e.slice();e=[],t=new Gk;for(const d of h)t.has(d)||t.set(d,e.push(d)-1);return o},o.range=function(h){return arguments.length?(i=Array.from(h),o):i.slice()},o.unknown=function(h){return arguments.length?(r=h,o):r},o.copy=function(){return CO(e,i).unknown(r)},TO.apply(o,arguments),o}function ZG(t){return function(){return t}}function WG(t){return+t}var m3=[0,1];function pf(t){return t}function JT(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:ZG(isNaN(e)?NaN:.5)}function YG(t,e){var i;return t>e&&(i=t,t=e,e=i),function(r){return Math.max(t,Math.min(e,r))}}function XG(t,e,i){var r=t[0],o=t[1],h=e[0],d=e[1];return o<r?(r=JT(o,r),h=i(d,h)):(r=JT(r,o),h=i(h,d)),function(a){return h(r(a))}}function JG(t,e,i){var r=Math.min(t.length,e.length)-1,o=new Array(r),h=new Array(r),d=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++d<r;)o[d]=JT(t[d],t[d+1]),h[d]=i(e[d],e[d+1]);return function(a){var v=K9(t,a,1,r)-1;return h[v](o[v](a))}}function KG(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function QG(){var t=m3,e=m3,i=JI,r,o,h,d=pf,a,v,T;function E(){var L=Math.min(t.length,e.length);return d!==pf&&(d=YG(t[0],t[L-1])),a=L>2?JG:XG,v=T=null,k}function k(L){return L==null||isNaN(L=+L)?h:(v||(v=a(t.map(r),e,i)))(r(d(L)))}return k.invert=function(L){return d(o((T||(T=a(e,t.map(r),va)))(L)))},k.domain=function(L){return arguments.length?(t=Array.from(L,WG),E()):t.slice()},k.range=function(L){return arguments.length?(e=Array.from(L),E()):e.slice()},k.rangeRound=function(L){return e=Array.from(L),i=gV,E()},k.clamp=function(L){return arguments.length?(d=L?!0:pf,E()):d!==pf},k.interpolate=function(L){return arguments.length?(i=L,E()):i},k.unknown=function(L){return arguments.length?(h=L,k):h},function(L,O){return r=L,o=O,E()}}function eq(){return QG()(pf,pf)}function tq(t,e,i,r){var o=o7(t,e,i),h;switch(r=_x(r??",f"),r.type){case"s":{var d=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(h=qG(o,d))&&(r.precision=h),SO(r,d)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(h=HG(o,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=h-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(h=GG(o))&&(r.precision=h-(r.type==="%")*2);break}}return wO(r)}function iq(t){var e=t.domain;return t.ticks=function(i){var r=e();return s7(r[0],r[r.length-1],i??10)},t.tickFormat=function(i,r){var o=e();return tq(o[0],o[o.length-1],i??10,r)},t.nice=function(i){i==null&&(i=10);var r=e(),o=0,h=r.length-1,d=r[o],a=r[h],v,T,E=10;for(a<d&&(T=d,d=a,a=T,T=o,o=h,h=T);E-- >0;){if(T=BT(d,a,i),T===v)return r[o]=d,r[h]=a,e(r);if(T>0)d=Math.floor(d/T)*T,a=Math.ceil(a/T)*T;else if(T<0)d=Math.ceil(d*T)/T,a=Math.floor(a*T)/T;else break;v=T}return t},t}function db(){var t=eq();return t.copy=function(){return KG(t,db())},TO.apply(t,arguments),iq(t)}function Lp(t){return function(){return t}}function rq(t){let e=3;return t.digits=function(i){if(!arguments.length)return e;if(i==null)e=null;else{const r=Math.floor(i);if(!(r>=0))throw new RangeError(`invalid digits: ${i}`);e=r}return t},()=>new OG(e)}function nq(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function EO(t){this._context=t}EO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function sq(t){return new EO(t)}function oq(t){return t[0]}function aq(t){return t[1]}function g3(t,e){var i=Lp(!0),r=null,o=sq,h=null,d=rq(a);t=typeof t=="function"?t:t===void 0?oq:Lp(t),e=typeof e=="function"?e:e===void 0?aq:Lp(e);function a(v){var T,E=(v=nq(v)).length,k,L=!1,O;for(r==null&&(h=o(O=d())),T=0;T<=E;++T)!(T<E&&i(k=v[T],T,v))===L&&((L=!L)?h.lineStart():h.lineEnd()),L&&h.point(+t(k,T,v),+e(k,T,v));if(O)return h=null,O+""||null}return a.x=function(v){return arguments.length?(t=typeof v=="function"?v:Lp(+v),a):t},a.y=function(v){return arguments.length?(e=typeof v=="function"?v:Lp(+v),a):e},a.defined=function(v){return arguments.length?(i=typeof v=="function"?v:Lp(!!v),a):i},a.curve=function(v){return arguments.length?(o=v,r!=null&&(h=o(r)),a):o},a.context=function(v){return arguments.length?(v==null?r=h=null:h=o(r=v),a):r},a}function y3(t){return t<0?-1:1}function v3(t,e,i){var r=t._x1-t._x0,o=e-t._x1,h=(t._y1-t._y0)/(r||o<0&&-0),d=(i-t._y1)/(o||r<0&&-0),a=(h*o+d*r)/(r+o);return(y3(h)+y3(d))*Math.min(Math.abs(h),Math.abs(d),.5*Math.abs(a))||0}function _3(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function yS(t,e,i){var r=t._x0,o=t._y0,h=t._x1,d=t._y1,a=(h-r)/3;t._context.bezierCurveTo(r+a,o+a*e,h-a,d-a*i,h,d)}function bx(t){this._context=t}bx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:yS(this,this._t0,_3(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var i=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,yS(this,_3(this,i=v3(this,t,e)),i);break;default:yS(this,this._t0,i=v3(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=i}}};Object.create(bx.prototype).point=function(t,e){bx.prototype.point.call(this,e,t)};function b3(t){return new bx(t)}function dy(t,e,i){this.k=t,this.x=e,this.y=i}dy.prototype={constructor:dy,scale:function(t){return t===1?this:new dy(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new dy(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};dy.prototype;const lq={ref:"popupContainer",class:"popup-container"},cq={class:"feature-details"},uq={key:0,class:"popup-header"},hq={class:"header-content"},dq={key:0,class:"feature-name"},pq={key:1,class:"feature-name"},fq={key:2,class:"feature-address"},mq={key:1,class:"stats-section"},gq={class:"indicator-title"},yq={class:"stats-grid"},vq={class:"stat-label"},_q={class:"stat-value percentage"},bq={key:0,class:"stat-value count"},xq={key:2,class:"more-info-section"},wq=["innerHTML"],Sq={key:3,class:"popup-header area"},Tq={class:"header-content"},Cq={key:0,class:"feature-name"},Eq={key:1,class:"feature-name"},Iq={key:2,class:"feature-address"},$q=kd({__name:"Popup",props:{properties:{},side:{}},setup(t){const e=t,i=yd(e.side);q1(()=>{const a=document.getElementsByClassName("maplibregl-popup-content");if(a&&a.length>0)for(const v of a)v.style.transform=`scale(${Math.min(1,window.innerWidth/1e3)})`,v.style.transformOrigin="bottom"});const r=xn(()=>i.getCurrentIndicator()),o=xn(()=>e.properties.more_info?decodeURIComponent(e.properties.more_info).split(`
`).join("<br/>"):""),h={pct:"pct_",count:"count_",pop:"pop_"},d=xn(()=>{const a=Array.from(new Set(Object.keys(e.properties).map(E=>Number(E.toLowerCase().replace("count_","").replace("pop_","").replace("pct_",""))).filter(E=>!isNaN(+E)))),v=[],T=r?.value?.popup;for(const E of a){const k=e.properties[h.count+E.toString()]||"",L=e.properties[h.pop+E.toString()]||"",O=e.properties[h.pct+E.toString()]||"",H=k===""&&L===""&&O==="",ie=O!==""&&k===""&&L==="";v.push({isEmpty:H,pctOnly:ie,year:E,title:T?.format?.title?.replace("{{count}}",(+k).toLocaleString()).replace("{{pop}}",(+L).toLocaleString()).replace("{{pct}}",O.toLocaleString()),subtitle:T?.format?.subtitle?.replace("{{count}}",(+k).toLocaleString()).replace("{{pop}}",(+L).toLocaleString()).replace("{{pct}}",O.toLocaleString())})}return v});return(a,v)=>{const T=mr("v-icon"),E=mr("v-divider"),k=mr("v-expansion-panel-title"),L=mr("v-expansion-panel-text"),O=mr("v-expansion-panel"),H=mr("v-expansion-panels");return di(),qi("div",lq,[Ct("div",cq,[r.value?.geotype==="protected"||r.value?.geotype==="tract"||r.value?.geotype==="county"?Ir("",!0):(di(),qi("div",uq,[$i(T,{icon:"mdi-map-marker",size:"24",color:"primary",class:"header-icon"}),Ct("div",hq,[a.properties.name?(di(),qi("h3",dq,Qi(a.properties.name),1)):a.properties.geoid?(di(),qi("h3",pq,Qi(r.value?.geotype==="tract"?"Census Tract Number":r.value?.geotype==="county"?"County FIPS code":"ID")+": "+Qi(a.properties.geoid),1)):Ir("",!0),a.properties.address?(di(),qi("div",fq,[$i(T,{icon:"mdi-map-marker-outline",size:"14",class:"mr-1"}),ms(" "+Qi(decodeURIComponent(a.properties.address)),1)])):Ir("",!0)])])),r.value?(di(),qi("div",mq,[Ct("div",gq,[$i(T,{icon:"mdi-chart-line",size:"18",class:"mr-2"}),ms(" "+Qi(r.value.title),1)]),$i(E,{class:"my-3"}),Ct("div",yq,[(di(!0),qi(z9,null,O9(d.value,ie=>(di(),qi("div",{key:ie.year,class:W0({"stat-item":!0,"stat-item-empty":ie.isEmpty})},[Ct("div",vq,Qi(ie.year),1),Ct("div",_q,Qi(ie.title),1),ie.pctOnly?Ir("",!0):(di(),qi("div",bq,Qi(ie.subtitle),1))],2))),128))])])):Ir("",!0),o.value.length>0?(di(),qi("div",xq,[$i(H,{color:"primary",variant:"accordion",class:"info-panels"},{default:As(()=>[$i(O,null,{default:As(()=>[$i(k,{class:"info-panel-title"},{default:As(()=>[$i(T,{icon:"mdi-information-outline",size:"18",class:"mx-2"}),v[0]||(v[0]=Ct("span",null,"More Information",-1)),v[1]||(v[1]=Ct("span",{class:"info-hint"},"(Click to expand)",-1))]),_:1}),$i(L,{class:"info-panel-content"},{default:As(()=>[Ct("div",{innerHTML:o.value,class:"info-text"},null,8,wq)]),_:1})]),_:1})]),_:1})])):Ir("",!0),r.value?.geotype==="protected"||r.value?.geotype==="tract"||r.value?.geotype==="county"?(di(),qi("div",Sq,[$i(T,{icon:"mdi-map-marker",size:"24",color:"primary",class:"header-icon"}),Ct("div",Tq,[a.properties.name?(di(),qi("h3",Cq,Qi(a.properties.name),1)):a.properties.geoid?(di(),qi("h3",Eq,Qi(r.value?.geotype==="tract"?"Census Tract Number":r.value?.geotype==="county"?"County FIPS code":"ID")+": "+Qi(a.properties.geoid),1)):Ir("",!0),a.properties.address?(di(),qi("div",Iq,[$i(T,{icon:"mdi-map-marker-outline",size:"14",class:"mr-1"}),ms(" "+Qi(decodeURIComponent(a.properties.address)),1)])):Ir("",!0)])])):Ir("",!0)])],512)}}}),Pq=Ad($q,[["__scopeId","data-v-af6482b4"]]),Mq=2023,vS="overall",IO=/^\d{4}$/,_S=3,kq=20,Aq=10,Dq=400,bS=.75,zq=1,xS=["overall","statewide","school district"],Oq=.95,Rq=1.05,x3=12,w3=500,S3=.5;class $O{data;map;emitter;events;year;side;popup=null;frozenPopup=!1;popupApp=null;highlightedGeoid=null;lastPopupGeoid=null;popupProperties=null;arrasBranding;sitePath;hoveringPlaceId=-1;minValue;maxValue;rangeValues;constructor(e,i,r=null,o,h,d){this.data=e,this.map=i,this.emitter=o,this.events={click:null,mousemove:null,mouseleave:null},this.year=null,this.side=r,this.highlightedGeoid=null,this.arrasBranding=h,this.sitePath=d||"",this.hoveringPlaceId=-1,this.minValue=null,this.maxValue=null,this.rangeValues={count:{min:0,max:100},pop:{min:0,max:100},pct:{min:0,max:100},acres:{min:0,max:100}}}async setupIndicator(e){this.year=e||this.year||null,this.rangeValues.pop.min=this.getMin("pop")??null,this.rangeValues.pop.max=this.getMax("pop")??null,this.rangeValues.pct.min=this.getMin("pct")??null,this.rangeValues.pct.max=this.getMax("pct")??null,this.rangeValues.count.min=this.getMin("count")??null,this.rangeValues.count.max=this.getMax("count")??null,this.rangeValues.acres.min=this.getMin("acres")??null,this.rangeValues.acres.max=this.getMax("acres")??null;const{minValue:i,maxValue:r}=this.getMinMaxValues();this.minValue=i,this.maxValue=r;const o=this.data.legend?.extra_layers;return o?.data_merge&&await this.generateExtraGeojson(o.data_merge),!0}async generateExtraGeojson(e){if(!this.map||!this.data||!e)return null;const i=e?.google_sheets_url;if(e?.source){const r=this.map.getSource(e.source);if(r){const o=await r.getData();if(i){const d=await(await fetch(i)).text(),a=j9(d);o.features=o.features.map(v=>{const T=a.data.find(E=>+E.geoid==+v.properties.geoid);if(T)return{...v,properties:T}})}r&&typeof r.setData=="function"?r.setData(o):console.error(`Source ${e.source} not found`)}}return null}getGradientExpression(){const e=this.data,i=this.minValue||this.getMinMaxValues().minValue,r=this.maxValue||this.getMinMaxValues().maxValue,o=this.arrasBranding.colors[e.style.min.color],h=this.arrasBranding.colors[e.style.max.color];if(!e||!e.layers||!e.layers.main||!e.style||!e.style.min||!e.style.max)return console.error("Missing required data properties:",{data:e,layers:e?.layers,style:e?.style}),!1;const d=this.data.timeline?.yearValuePrefix||"",a=["case",["has",d+String(this.year)],["interpolate",["linear"],["to-number",["get",d+String(this.year)]],i,o,r,h],"#0000"];return e.layers.main?a:(console.error("data.layers.main is undefined"),!1)}hideLayers(){this.map&&(this.data.layers.main&&this.map.setLayoutProperty(this.data.layers.main,"visibility","none"),this.data.layers.outline&&this.map.setLayoutProperty(this.data.layers.outline,"visibility","none"),this.data.legend?.extra_layers?.layer_name&&this.map.setLayoutProperty(this.data.legend?.extra_layers?.layer_name,"visibility","none"),this.data.layers.circle&&this.map.setLayoutProperty(this.data.layers.circle,"visibility","none"))}removeOldEvents(){if(!this.map){this.popupApp&&(this.popupApp.unmount(),this.popupApp=null),this.popup&&(this.popup.remove(),this.popup=null);return}this.events.click&&this.map.off("click",this.events.click),this.events.mousemove&&this.map.off("mousemove",this.events.mousemove),this.events.mouseleave&&this.map.off("mouseleave",this.events.mouseleave),this.popupApp&&(this.popupApp.unmount(),this.popupApp=null),this.popup&&(this.popup.remove(),this.popup=null)}addNewEvents(){this.events.mouseleave=()=>{this.frozenPopup||!this.popup||this.removePopup()};const e=this.data.layers.main;this.map.on("mouseleave",e,this.events.mouseleave),this.events.mousemove=i=>{const r=this.map.queryRenderedFeatures(i.point,{layers:["places-fill"]});r.length>0?(this.hoveringPlaceId=r[0].id,this.map.setFeatureState({source:"places-source",id:this.hoveringPlaceId},{hover:!0})):(this.map.setFeatureState({source:"places-source",id:this.hoveringPlaceId},{hover:!1}),this.hoveringPlaceId=-1)},this.map.on("mousemove",this.events.mousemove),this.events.click=i=>{this.frozenPopup=!this.frozenPopup},this.map.on("click",this.events.click)}createPopupIfNeeded(){this.popup||(this.popup=new Qa.Popup({closeButton:!0,closeOnClick:!1,closeOnMove:!1,focusAfterOpen:!1}))}showPopup(e,i,r){if(!this.map)return;const o=i?.geoid||i?.id||null,h=o!==this.lastPopupGeoid,d=`popup-container-${r}`;this.createPopupIfNeeded(),this.popup.setLngLat(e),(h||!this.popupApp)&&this.popup.setHTML(`<div id="${d}"></div>`).addTo(this.map);const a=document.getElementById(d);a&&(h||!this.popupApp?(this.popupApp&&(this.popupApp.unmount(),this.popupApp=null),this.popupProperties=R9({...i}),this.popupApp=L9(Pq,{properties:this.popupProperties,side:r}).use(F9),this.popupApp.mount(a),this.lastPopupGeoid=o):this.popupProperties&&Object.assign(this.popupProperties,i))}removePopup(){this.popupApp&&(this.popupApp.unmount(),this.popupApp=null),this.popup&&(this.popup.remove(),this.popup=null),this.lastPopupGeoid=null,this.popupProperties=null}async setPaintAndLayoutProperties(e){if(!this.map)return!1;if(this.year=e||this.year||null,this.map&&this.data.layers.main&&this.map.setLayoutProperty(this.data.layers.main,"visibility","visible"),this.map&&this.data.layers.outline&&this.map.setLayoutProperty(this.data.layers.outline,"visibility","visible"),this.map&&this.data.legend?.extra_layers?.layer_name){this.map.setLayoutProperty(this.data.legend?.extra_layers?.layer_name,"visibility","visible");const i=this.data.legend?.extra_layers?.styling;if(i){if(i.image){const r=await this.map.loadImage(i.image.url);this.map.addImage(i.image.id,r.data)}if(i.paint&&Object.entries(i.paint).forEach(([r,o])=>{this.map.setPaintProperty(this.data.legend?.extra_layers?.layer_name,r,o)}),i.filter){const r=JSON.stringify(i.filter).replace(/\{\{pct\}\}/g,`pct_${e||this.year}`).replace(/\{\{count\}\}/g,`count_${e||this.year}`).replace(/\{\{pop\}\}/g,`pop_${e||this.year}`),o=JSON.parse(r);this.map.setFilter(this.data.legend?.extra_layers?.layer_name,o)}}}return!0}getAllYears(){const e=this.data.google_sheets_data.headerShortNames;return Array.from(new Set(e.map(i=>Number(i.toLowerCase().replace("count_","").replace("pop_","").replace("pct_",""))).filter(i=>!isNaN(+i))))}getMinForYear(e,i){const r=this.data.google_sheets_data.data;let o;if(e==="acres"?o=r.filter(d=>d.geoid!==null&&d.geoid!==void 0&&d.acres!==null&&d.acres!==void 0):o=r.filter(d=>d.geoid!==null&&d.geoid!==void 0&&d[e+"_"+(i||this.year)]!==null&&d[e+"_"+(i||this.year)]!==void 0),(e==="pop"||e==="count"||e==="acres")&&(o=o.filter(d=>!xS.some(a=>d?.geoid?.toLowerCase()?.includes(a)))),o.length===0)return console.warn(i,e,"no data"),null;let h;return e==="acres"?h=Math.min(...o.map(d=>+d.acres)):h=Math.min(...o.map(d=>+d[e+"_"+(i||this.year)])),isNaN(+h)?(console.warn(i,e,"isNaN",h),Number.MAX_SAFE_INTEGER):h}getMaxForYear(e,i){const r=this.data.google_sheets_data.data;let o;if(e==="acres"?o=r.filter(d=>d.geoid!==null&&d.geoid!==void 0&&d.acres!==null&&d.acres!==void 0):o=r.filter(d=>d.geoid!==null&&d.geoid!==void 0&&d[e+"_"+(i||this.year)]!==null&&d[e+"_"+(i||this.year)]!==void 0),(e==="pop"||e==="count"||e==="acres")&&(o=o.filter(d=>!xS.some(a=>d?.geoid?.toLowerCase()?.includes(a)))),o.length===0)return console.warn(i,e,"no data"),Number.MAX_SAFE_INTEGER;let h;return e==="acres"?h=Math.max(...o.map(d=>+d.acres)):h=Math.max(...o.map(d=>+d[e+"_"+(i||this.year)])),isNaN(h)?(console.warn(i,e,"isNaN",h),Number.MAX_SAFE_INTEGER):h}getMin(e){let i=Number.MAX_SAFE_INTEGER;const r=this.getAllYears();for(let o=0;o<r.length;o++){const h=r[o],d=this.getMinForYear(e,+h);d!==null&&d<i&&!isNaN(d)&&(i=d)}return i}getMax(e){let i=0;const r=this.getAllYears();for(let o=0;o<r.length;o++){const h=r[o],d=this.getMaxForYear(e,+h);d!==null&&d>i&&!isNaN(d)&&(i=d)}return i}getMinMaxValues(){const e=this.data,i=e.timeline?.yearValuePrefix||"";let r=e.google_sheets_data.headerShortNames.filter(d=>i.length>0?d.startsWith(i):IO.test(d)&&!isNaN(Number(d))),o=Number.MAX_SAFE_INTEGER,h=0;for(let d=0;d<r.length;d++){const a=r[d],v=e.google_sheets_data.data.filter(k=>{const L=k?.geoid?.toLowerCase()||"",O=k?.name?.toLowerCase()||"";return!xS.some(H=>L.includes(H)||O.includes(H))}).map(k=>k[a]).filter(k=>k!=null&&!isNaN(Number(k)));if(v.length===0)continue;const T=Math.min(...v),E=Math.max(...v);T<o&&(o=T),E>h&&(h=E)}return{minValue:Math.floor(o*Oq),maxValue:Math.ceil(h*Rq)}}}class Lq extends $O{selectedGeography=null;constructor(e,i,r=null,o,h,d){super(e,i,r,o,h,d),this.selectedGeography=null}async setupIndicator(e){await super.setupIndicator?.(e),this.removeOldEvents();const i=this.map,r=this.data,o=i.getSource(r.source_name),h=await o.getData();return h.features=h.features.map(d=>{let a=r.google_sheets_data.data.find(v=>+v.geoid==+d.properties.geoid);return Object.keys(a).forEach(v=>{(a[v]===null||a[v]===void 0)&&delete a[v]}),a?{type:"Feature",geometry:d.geometry,properties:a}:!1}),o&&typeof o.setData=="function"?o.setData(h):console.error(`Source ${r.source_name} not found`),await this.setPaintAndLayoutProperties(e),this.addNewEvents(),!0}removeOldEvents(){super.removeOldEvents()}addNewEvents(){super.addNewEvents();const e=this.map,i=this.data.layers.main;if(!e)return;const r=this.data;this.events.mousemove=o=>{if(this.frozenPopup)return;this.createPopupIfNeeded();const h=e.queryRenderedFeatures(o.point,{layers:[i]}),d=r.layers.outline;if(h.length>0){if(this.highlightedGeoid&&this.highlightedGeoid===h[0].properties.geoid)return;this.highlightedGeoid=this.highlightedGeoid||h[0]}else{this.emitter?.emit(`feature-${this.side||"left"}-hovered`,null),d&&e.setPaintProperty(d,"line-color",["case",["==",["get","geoid"],""+this.selectedGeography],["literal","#08ff"],"#0000"]),this.removePopup();return}const a=h[0],v=a.properties;d&&e.setPaintProperty(d,"line-color",["case",["==",["get","geoid"],""+v.geoid],["literal","#000f"],["==",["get","geoid"],""+this.selectedGeography],["literal","#08ff"],"#0000"]),this.showPopup(o.lngLat,a.properties,this.side),this.emitter?.emit(`feature-${this.side||"left"}-hovered`,a.properties.geoid)},e.on("mousemove",this.events.mousemove),this.events.click=o=>{if(!e)return;const h=e.queryRenderedFeatures(o.point,{layers:[i]});if(h.length===0||h[0].properties.geoid===this.selectedGeography){this.emitter?.emit(`feature-${this.side||"left"}-clicked`,null),this.selectedGeography=null,r.layers.outline&&e.setPaintProperty(r.layers.outline,"line-color","#0000");return}e.getLayer(r.layers.outline)&&e.setPaintProperty(r.layers.outline,"line-color",["case",["==",["get","geoid"],h[0].properties.geoid],["literal","#08ff"],"#0000"]),this.emitter?.emit(`feature-${this.side||"left"}-clicked`,h[0].properties.geoid),this.selectedGeography=h[0].properties.geoid},e.on("click",this.events.click)}async setPaintAndLayoutProperties(e){await super.setPaintAndLayoutProperties(e);const i=this.map;if(!i)return!1;const r=this.data,o=this.getGradientExpression();return o?(i.setPaintProperty(r.layers.main,"fill-color",o),i.setLayoutProperty(r.layers.main,"visibility","visible"),r.layers.supplementary&&r.layers.supplementary.forEach(h=>{i.setLayoutProperty(h,"visibility","visible")}),!0):(console.error("Failed to generate gradient expression"),!1)}async generateGeojson(){}}class Fq extends $O{constructor(e,i,r=null,o,h,d){super(e,i,r,o,h,d),this.arrasBranding=h}getSizeExpression(){let i=this.data.map?.size+"_"+String(this.year);return i?["case",["has",i],["interpolate",["linear"],["to-number",["get",i]],Aq,_S,Dq,kq],_S+3]:_S+3}async setupIndicator(e){await super.setupIndicator?.(e),this.removeOldEvents();const i=this.generateGeojson(),r=this.map,o=this.data,h=await r.getSource(o.source_name);return h&&typeof h.setData=="function"?h.setData(i):console.error(`Source ${o.source_name} not found`),await this.setPaintAndLayoutProperties(e),this.addNewEvents(),!0}removeOldEvents(){super.removeOldEvents()}addNewEvents(){super.addNewEvents();const e=this.map,i=this.data.layers.main;e&&(this.events.mousemove=r=>{if(this.frozenPopup)return;this.createPopupIfNeeded();const o=e.queryRenderedFeatures(r.point,{layers:[i]});if(o.length===0){e.setPaintProperty(i,"circle-opacity",bS),this.removePopup(),this.emitter?.emit(`feature-${this.side||"left"}-hovered`,null),this.emitter?.emit(`feature-name-${this.side||"left"}-hovered`,null);return}else e.setPaintProperty(i,"circle-opacity",["case",["==",["get","geoid"],o[0].properties.geoid],zq,bS]),this.showPopup(r.lngLat,o[0].properties,this.side),this.emitter?.emit(`feature-${this.side||"left"}-hovered`,o[0].properties.geoid),this.emitter?.emit(`feature-name-${this.side||"left"}-hovered`,o[0].properties.name)},e.on("mousemove",this.events.mousemove))}async setPaintAndLayoutProperties(e){await super.setPaintAndLayoutProperties(e);const i=this.map;if(!i)return!1;const r=this.data.layers.main;i.setLayoutProperty(r,"visibility","visible"),i.setPaintProperty(r,"circle-radius",this.getSizeExpression()),i.setPaintProperty(r,"circle-opacity",bS),i.setLayoutProperty(r,"circle-sort-key",["case",["has",`cohort_${this.year}`],["/",1,["to-number",["get",`cohort_${this.year}`]]],["has",`count_${this.year}`],["/",1,["to-number",["get",`count_${this.year}`]]],["has",`pct_${this.year}`],["/",1,["to-number",["get",`pct_${this.year}`]]],0]);const o=this.arrasBranding.colors[this.data.style.max.color],h=this.data.map?.color===null?o:this.getGradientExpression();return i.setPaintProperty(r,"circle-color",h),i.setLayoutProperty(r,"visibility","visible"),!0}generateGeojson(){return{type:"FeatureCollection",features:this.data.google_sheets_data.data.map(r=>({type:"Feature",geometry:{type:"Point",coordinates:[+r.lng,+r.lat]},properties:r}))}}}function Nq(t,e,i=null,r,o,h){if(!e)return null;switch(t?.geolevel){case"protected":case"area":return new Lq(t,e,i,r,o,h);case"point":return new Fq(t,e,i,r,o,h);default:return console.warn(`Unknown geolevel: ${t?.geolevel}`),null}}const Bq=If(),jq=t=>{const e=Yn(qo("arrasBranding")),i=qo("sitePath"),r=Yn(null),o=Yn(null);let h=null;const d=Yn(Mq),a=Yn(null),v=Yn(null);function T(){return Bq.getAllCurrentThemeIndicators()}function E(ke,Ke){h=ke,ke.on("load",async()=>{const dt=T()?.find(ft=>t.includes(ft.default))||null;await be(dt?.short_name||"",Ke)})}let k=null;function L(){k&&(k.removeOldEvents(),k.hideLayers(),k=null),h=null}async function O(ke){typeof ke=="string"&&(ke=+ke.replace(/[^0-9]/g,"")),d.value=ke,k&&await k.setPaintAndLayoutProperties(ke)}function H(){return d.value}function ie(){return o.value?.toLowerCase()||vS}function pe(ke){o.value=ke?.toLowerCase()||null}async function be(ke,Ke){const dt=T()?.find(ft=>ft.short_name===ke)||null;if(dt){if(r.value=dt,!dt.google_sheets_data)return!1;if(k&&(k.removeOldEvents(),k.hideLayers(),k=null),k=Nq(dt,h,t,Ke,e.value,i),k){const ft=dt.google_sheets_data.headerShortNames;let et=ft&&ft.length>0?ft.filter(We=>/^\d{4}$/.test(We)).sort((We,Be)=>Number(We)-Number(Be)):null;(!et||et.length===0)&&(et=ft.filter(We=>We.toLowerCase().startsWith(dt.timeline?.yearValuePrefix||"")).sort((We,Be)=>Number(We.replace(dt.timeline?.yearValuePrefix||"",""))-Number(Be.replace(dt.timeline?.yearValuePrefix||"",""))).map(We=>Number(We.replace(dt.timeline?.yearValuePrefix||"","")))),await k.setupIndicator(et[et.length-1]),a.value=k.minValue??null,v.value=k.maxValue??null,await O(et[et.length-1]),pe(vS),Ke?.on(`feature-${t}-clicked`,We=>{pe(We||vS)})}}else r.value=null}function Ce(){return r.value||null}function Pe(ke){return ke==="count"?k?.rangeValues.count.min??null:ke==="pop"?k?.rangeValues.pop.min??null:ke==="pct"?k?.rangeValues.pct.min??null:ke==="acres"?k?.rangeValues.acres.min??null:null}function Ie(ke){return ke==="count"?k?.rangeValues.count.max??null:ke==="pop"?k?.rangeValues.pop.max??null:ke==="pct"?k?.rangeValues.pct.max??null:ke==="acres"?k?.rangeValues.acres.max??null:null}return{setIndicatorFromIndicatorShortName:be,getCurrentIndicator:Ce,initializeMap:E,removeMap:L,setCurrentYear:O,getCurrentYear:H,getCurrentGeoSelection:ie,setCurrentGeoSelection:pe,getMinValue:Pe,getMaxValue:Ie,minValue:a,maxValue:v}},yd=t=>N9(`${t}-indicator`,()=>jq(t))(),Uq=kd({__name:"IndicatorSelector",props:{side:{}},setup(t,{expose:e}){const i=t,r=yd(i.side),o=If(),h=qo("mitt"),d=async a=>{await r.setIndicatorFromIndicatorShortName(a.short_name,h),h?.emit(`indicator-changed-${i.side}`,a,i.side)};return e({indicatorStore:r}),(a,v)=>{const T=mr("v-list-item"),E=mr("v-select");return di(),al(E,{"model-value":us(r)?.getCurrentIndicator(),items:us(o)?.getAllCurrentThemeIndicators()||[],"return-object":"","item-title":"short_title",density:"compact",variant:"outlined",width:"100%","hide-details":"",class:"indicator-select","onUpdate:modelValue":d},{item:As(({props:k})=>[$i(T,qI({class:"indicator-select-item"},k),null,16)]),_:1},8,["model-value","items"])}}}),Vq=Ad(Uq,[["__scopeId","data-v-712c6649"]]),Gq={class:"timeline-header"},qq={class:"chart-label"},Hq={class:"viz-legend"},Zq={key:0},Wq={class:"hovered-geo mx-0"},Yq={key:1},Xq={class:"hovered-geo mx-0"},wS="#2563eb",SS="#f80",TS="#7d7d7d",Jq=kd({__name:"TimelineVisualization",props:{side:{}},emits:["indicatorChanged","close"],setup(t){const e=qo("mitt"),i=t,r=yd(i.side),o=Yn(wS),h=Yn(SS),d=Yn(null),a=Yn();let v,T=document.body.clientWidth*.33,E=130,k={top:15,right:5,bottom:0,left:20},L=db().domain([0,100]).range([E-k.bottom,k.top]);function O(){if(d.value){const Be=d.value.clientWidth;Be>0&&(T=Be)}else T=document.body.clientWidth*.33;L.range([E-k.bottom,k.top])}const H=xn(()=>{const Be=r.getCurrentIndicator(),ge=Be?.google_sheets_data;if(!ge)return[];const De=ge.headerShortNames;return Array.from(new Set(De.map(Je=>Number(Je.replace(Be?.timeline?.yearValuePrefix||"",""))).filter(Je=>Je!=null&&!isNaN(Je)).sort((Je,Qe)=>Je-Qe)))});xn(()=>r.getCurrentIndicator()?.timeline?.yearValueShortFormat||null);const ie=xn({get:()=>r.getCurrentYear(),set:Be=>{Be!==null&&r.setCurrentYear(Be)}}),pe=Be=>{r.setCurrentYear(Be)},be=Be=>{const ge=r.getCurrentIndicator(),De=ge?.google_sheets_data;if(!De)return[];const Je=De.data,Qe=Be||r.getCurrentGeoSelection();let yt;const Et=[];return yt=Je.find(Ye=>""+Ye.geoid==""+Qe),yt?(H.value.forEach(Ye=>{let bt=ge?.timeline?.yearValuePrefix?`${ge.timeline.yearValuePrefix}${Ye}`:Ye.toString(),Dt=yt?.[bt];Et.push({year:Ye,value:Dt!=null&&Dt!==""?Number(Dt):null})}),Et):[]},Ce=()=>{if(!a.value)return;O();const Be=be(null);if(Be.length===0)return;Ph(a.value).selectAll("*").remove(),v=Ph(a.value).attr("width",T).attr("height",E);const ge=Be.filter(bt=>bt.value!==null&&!isNaN(+bt.value)).map(bt=>({year:bt.year,value:bt.value?.toFixed(2)?Number(bt.value?.toFixed(2)):null}));if(ge.length===0){Ke(Be);return}const De=qe(Be);L=ft(ge);const Je=Zk(De).tickFormat(bt=>bt.toString()).tickSize(0).tickPadding(8),Qe=p7(L).tickFormat(bt=>bt.toLocaleString().replace(",000","K")).tickSize(-T+k.left+k.right).tickPadding(2).ticks(5);v.append("g").attr("class","x-axis").attr("transform",`translate(0, ${E+k.bottom})`).call(Je).selectAll("text").style("font-size","10px").style("fill","#666"),v.append("g").attr("class","y-axis").attr("transform",`translate(${k.left}, 0)`).call(Qe).selectAll("text").style("font-size","10px").style("fill","#666"),v.selectAll(".y-axis .tick line").style("stroke","#e0e0e0").style("stroke-width",1);const yt=r.getCurrentYear();if(yt&&Be.some(bt=>bt.year===yt)){const bt=De(yt);v.append("line").attr("class","current-year-line").attr("x1",bt).attr("x2",bt).attr("y1",k.top).attr("y2",E+k.bottom).style("stroke","#dc2626").style("stroke-width",1.5).style("stroke-dasharray","3,3").style("opacity",.7)}const Et=g3().x(bt=>De(bt.year)).y(bt=>L(bt.value)).curve(b3);v.append("path").datum(ge).attr("class","timeline-line").attr("d",Et).style("fill","none").style("stroke",wS).style("stroke-width",2),v.selectAll(".data-point").data(ge).enter().append("circle").attr("class","data-point").attr("cx",bt=>De(bt.year)).attr("cy",bt=>L(bt.value)).attr("r",4).style("fill",wS).style("stroke","#fff").style("stroke-width",2).style("cursor","pointer").on("click",(bt,Dt)=>{r.setCurrentYear(Dt.year)}).on("mouseover",function(bt,Dt){Dt.year!==r.getCurrentYear()&&Ph(this).transition().duration(200).attr("r",6).style("fill","#1d4ed8")}).on("mouseout",function(bt,Dt){Dt.year!==r.getCurrentYear()&&Ph(this).transition().duration(200).attr("r",4).style("fill","#2563eb")}).filter(bt=>bt.year===r.getCurrentYear()).style("fill","#dc2626").attr("r",5)},Pe=Yn(""),Ie=Yn(""),ke=Be=>{const ge=Be.toLowerCase().includes("statewide");if(Pe.value=ge?Pe.value:Be,!a.value)return;const De=be(Be);if(De.length===0)return;v=Ph(a.value).attr("width",T).attr("height",E);const Je=De.filter(Ye=>Ye.value!==null&&!isNaN(+Ye.value)),Qe=qe(De);ge||v.append("rect").attr("class",`${ge?"statewide-":""}data-feature-point-label-background`).attr("x",k.left).attr("y",0).attr("width",T).attr("height",E).style("fill","#fff").style("opacity",.667);const yt=g3().x(Ye=>Qe(Ye.year)).y(Ye=>L(Ye.value)).curve(b3);Yl(`.${i.side} .data-feature-point`).remove(),Yl(`.${i.side} .data-feature-point-label`).remove(),Yl(`.${i.side} .data-feature-point-label-background`).remove(),Yl(`.${i.side} .timeline-feature-line`).remove(),ge&&Yl(`.${i.side} ${ge?"statewide-":""}timeline-feature-line`).remove(),v.append("path").datum(Je).attr("class",`${ge?"statewide-":""}timeline-feature-line`).attr("d",yt).style("fill","none").style("stroke",ge?TS:SS).style("stroke-width",1),v.selectAll(`.${ge?"statewide-":""}data-feature-point`).data(Je).enter().append("circle").attr("class",`${ge?"statewide-":""}data-feature-point`).attr("cx",Ye=>Qe(Ye.year)).attr("cy",Ye=>L(Ye.value)).attr("r",4).style("fill",ge?TS:SS).style("stroke","#fff").style("stroke-width",1).style("cursor","pointer").on("click",(Ye,bt)=>{r.setCurrentYear(bt.year)}).on("mouseover",function(Ye,bt){bt.year!==r.getCurrentYear()&&Ph(this).transition().duration(200).attr("r",6)}).on("mouseout",function(Ye,bt){bt.year!==r.getCurrentYear()&&Ph(this).transition().duration(200).attr("r",4)}).filter(Ye=>Ye.year===r.getCurrentYear()).style("fill","#dc2626").attr("r",5)},Ke=Be=>{const ge=qe(Be),De=Zk(ge).tickFormat(Qe=>Qe.toString()).tickSize(0).tickPadding(8);v.append("g").attr("class","x-axis").attr("transform",`translate(0, ${E+k.bottom})`).call(De).selectAll("text").style("font-size","10px").style("fill","#666");const Je=r.getCurrentYear();if(Je&&Be.some(Qe=>Qe.year===Je)){const Qe=ge(Je);v.append("line").attr("class","current-year-line").attr("x1",Qe).attr("x2",Qe).attr("y1",k.top).attr("y2",E+k.bottom).style("stroke","#dc2626").style("stroke-width",1.5).style("stroke-dasharray","3,3").style("opacity",.7)}v.append("text").attr("x",T/2).attr("y",E/2).attr("text-anchor","middle").style("font-size","12px").style("fill","#999").text("No data available")},qe=Be=>{const ge=Be.map(Qe=>Qe.year).filter(Qe=>Qe!=null&&!isNaN(Number(Qe))).sort((Qe,yt)=>Qe-yt),De=[];let Je=k.left+5;for(let Qe=0;Qe<ge.length;Qe++)if(De.push(Je),Qe<ge.length-1){const yt=ge[Qe],Ye=ge[Qe+1]-yt,bt=T/ge.length*(Math.sqrt(Ye)/ge.length)*1.333;Je+=bt}return CO().domain(ge).range(De)},dt=()=>{const Be=r.getCurrentIndicator(),ge=Be?.google_sheets_data;if(!ge)return{minValue:0,maxValue:100};const De=Be?.timeline?.yearValuePrefix||"";let Je=ge.headerShortNames.filter(Et=>De.length>0?Et.startsWith(De):IO.test(Et)&&!isNaN(Number(Et))),Qe=Number.MAX_SAFE_INTEGER,yt=0;for(let Et=0;Et<Je.length;Et++){const Ye=ge.data.filter(Si=>!Be?.timeline?.filterOut?.some(Vr=>Si?.geoid.toLowerCase().includes(Vr))).filter(Si=>!Si?.name?.toLowerCase().includes("school district")).map(Si=>Si[Je[Et]]).filter(Si=>Si!=null&&!isNaN(Number(Si))).map(Si=>Number(Si)),bt=Math.min(...Ye),Dt=Math.max(...Ye);+bt<Qe&&(Qe=+bt),+Dt>yt&&(yt=+Dt)}return{minValue:Math.floor(Qe*.95),maxValue:Math.ceil(yt*1.05)}},ft=Be=>{if(Be.map(Qe=>Qe.value).filter(Qe=>Qe!=null&&!isNaN(+Qe)).length===0)return db().domain([0,100]).range([E-k.bottom,k.top]);const{minValue:De,maxValue:Je}=dt();return db().domain([De,Je]).range([E+k.bottom,k.top])},et=async()=>{Qh(()=>{Ce(),ke("statewide")})},We=xn(()=>r?.getCurrentIndicator()?.google_sheets_data?.data?.find(Be=>Be?.geoid?.toLowerCase()==="statewide")!==void 0&&!r?.getCurrentIndicator()?.timeline?.filterOut?.some(Be=>Be.toLowerCase()==="statewide"));return e.on("resize-maps",()=>{Qh(()=>{O(),Ce(),ke("statewide")})}),jz([()=>r.getCurrentIndicator(),()=>r.getCurrentYear(),()=>r.getCurrentGeoSelection()],()=>{Qh(()=>{Ce(),ke("statewide")})},{deep:!0}),q1(()=>{Qh(()=>{Ce()}),e.on(`feature-${i.side}-hovered`,Be=>{Yl(".timeline-feature-line").remove(),Yl(".data-feature-point").remove(),Yl(".data-feature-point-label").remove(),Yl(".data-feature-point-label-background").remove(),Be===null?Pe.value="":(Pe.value=Be,ke(Be))}),e.on(`feature-name-${i.side}-hovered`,Be=>{Be===null?Ie.value="":Ie.value=Be})}),Uz(()=>{e.off("feature-left-hovered",ke),e.off("feature-right-hovered",ke)}),(Be,ge)=>{const De=mr("v-select");return di(),qi("div",{class:W0(["timeline-visualization-container",Be.side==="left"?"left":"right"])},[Ct("div",Gq,[$i(Vq,{side:Be.side,onIndicatorChanged:et},null,8,["side"])]),H.value.length>0?(di(),al(De,{key:0,modelValue:ie.value,"onUpdate:modelValue":[ge[0]||(ge[0]=Je=>ie.value=Je),pe],items:H.value,label:"Year",density:"compact",variant:"solo",elevation:"0","hide-details":"",class:"year-selector"},null,8,["modelValue","items"])):Ir("",!0),Ct("div",{ref_key:"container",ref:d,class:"timeline-visualization"},[Ct("div",qq,[Ct("table",Hq,[Ct("tbody",null,[Ct("tr",null,[us(r)?.getCurrentIndicator()?.timeline?.filterOut?.some(Je=>Je.toLowerCase()==="overall")?Ir("",!0):(di(),qi("td",Zq,[Ct("span",Wq,[ge[1]||(ge[1]=ms("Chester & Lancaster avg.",-1)),ge[2]||(ge[2]=Ct("br",null,null,-1)),Ct("span",{class:"selected-color",style:pl({border:`2px solid ${o.value}`})},null,4)])])),We.value?(di(),qi("td",Yq,[ge[3]||(ge[3]=Ct("span",{class:"selected-geo"},"Statewide",-1)),ge[4]||(ge[4]=Ct("br",null,null,-1)),Ct("span",{class:"selected-color",style:pl({border:`2px solid ${TS}`})},null,4)])):Ir("",!0),Ct("td",null,[a0(Ct("span",Xq,[ge[5]||(ge[5]=ms("Selected area",-1)),ge[6]||(ge[6]=Ct("br",null,null,-1)),Ct("span",{class:"hovered-color",style:pl({border:`2px solid ${h.value}`})},null,4)],512),[[l0,Pe.value]])])])])])]),(di(),qi("svg",{ref_key:"svg",ref:a,class:"timeline-chart"},null,512))],512)],2)}}}),T3=Ad(Jq,[["__scopeId","data-v-ee8b1011"]]),Kq={class:"legend-container"},Qq={class:"legend-header"},eH={class:"legend-title"},tH={class:"legend-content"},iH={class:"legend-gradient"},rH={class:"legend-labels"},nH={class:"min-label"},sH={class:"max-label"},oH=["innerHTML"],aH={class:"data-source"},lH=["href"],cH=kd({__name:"ColorLegend",props:{selectedIndicator:{},side:{}},setup(t){const e=qo("arrasBranding"),i=t,r=yd(i.side),o=qo("mainConfig"),h=xn(()=>o?.data_sources?.[i.selectedIndicator?.data_source]),d=xn(()=>i.selectedIndicator?.legend?.extra_layers?.html),a=xn(()=>{const E=i.selectedIndicator?.legend?.title,k=i.selectedIndicator?.legend?.["title-column"],L=r.getMinValue(k)??0,O=r.getMaxValue(k)??0;return E?{min:E.replace(`{{${k}}}`,(+L).toLocaleString()),max:E.replace(`{{${k}}}`,(+O).toLocaleString())}:{min:"",mid:"",max:""}}),v=xn(()=>{const E=i.selectedIndicator?.style?.min?.color;return E?e.colors[E]:"#f2f0f7"}),T=xn(()=>{const E=i.selectedIndicator?.style?.max?.color;return E?e.colors[E]:"#000000"});return(E,k)=>{const L=mr("v-icon"),O=mr("v-tooltip");return di(),qi("div",{class:W0(["color-legend",{left:E.side==="left",right:E.side==="right"}])},[Ct("div",Kq,[Ct("div",Qq,[Ct("span",eH,[ms(Qi(E.selectedIndicator?.title||"Indicator")+" ",1),$i(O,{interactive:"","close-delay":"1250",style:{display:"inline-block"},"max-width":500,location:E.side==="left"?"bottom start":"bottom end",text:E.selectedIndicator["tooltip-info"]},{activator:As(({props:H})=>[$i(L,qI(H,{icon:"mdi-information-outline",size:"18",class:"mx-2"}),null,16)]),_:1},8,["location","text"])])]),Ct("div",tH,[Ct("div",iH,[Ct("div",{class:"gradient-bar",style:pl({background:`linear-gradient(to right, ${v.value}, ${T.value})`})},null,4)]),Ct("div",rH,[Ct("span",nH,Qi(a.value.min),1),Ct("span",sH,Qi(a.value.max),1)]),d.value?(di(),qi("div",{key:0,class:"extra-layer",innerHTML:d.value},null,8,oH)):Ir("",!0),a0(Ct("div",aH,[k[0]||(k[0]=ms("Data Source: ",-1)),Ct("a",{href:h.value?.url,target:"_blank"},[ms(Qi(h.value?.text)+" ",1),$i(L,{icon:"mdi-open-in-new",size:"12"})],8,lH)],512),[[l0,h.value]])])])],2)}}}),C3=Ad(cH,[["__scopeId","data-v-8d616179"]]),uH={class:"legend-container"},hH={class:"legend-header"},dH={class:"legend-title"},pH={class:"legend-content"},fH={key:0,class:"legend-icon-container"},mH={style:{"text-align":"left","vertical-align":"bottom"}},gH={style:{"text-align":"center","vertical-align":"bottom"}},yH={style:{"text-align":"right","vertical-align":"bottom"}},vH={class:"legend-labels"},_H={style:{"text-align":"left"}},bH={class:"min-label"},xH={style:{"text-align":"center"}},wH={class:"mid-label"},SH={style:{"text-align":"right"}},TH={class:"max-label"},CH={key:2,class:"legend-icon-container"},EH={class:"legend-labels"},IH={style:{"text-align":"left"}},$H={class:"min-label"},PH={style:{"text-align":"center"}},MH={class:"mid-label"},kH={style:{"text-align":"right"}},AH={class:"max-label"},DH={class:"data-source"},zH=["href"],OH=kd({__name:"PointLegend",props:{selectedIndicator:{},side:{}},setup(t){const e=qo("arrasBranding"),i=t,r=yd(i.side),o=qo("mainConfig"),h=xn(()=>o?.data_sources?.[i.selectedIndicator?.data_source]),d=xn(()=>i.selectedIndicator?.legend?.["secondary-title-column"]),a=xn(()=>{const k=i.selectedIndicator?.legend?.["secondary-title"],L=r.getMinValue(d.value)??0,O=r.getMaxValue(d.value)??0,H=((L+O)/2).toFixed(0).toLocaleString();return k?{min:k.replace(`{{${d.value}}}`,L.toLocaleString()??"0"),mid:k.replace(`{{${d.value}}}`,H.toLocaleString()??"0"),max:k.replace(`{{${d.value}}}`,O.toLocaleString()??"0")}:{min:"",mid:"",max:""}}),v=xn(()=>{const k=i.selectedIndicator?.legend?.title,L=i.selectedIndicator?.legend?.["title-column"],O=r.getMinValue(L)??0,H=r.getMaxValue(L)??0,ie=+((O+H)/2).toFixed(0).toLocaleString();return k?{min:k.replace(`{{${L}}}`,O.toLocaleString()??"0"),mid:k.replace(`{{${L}}}`,ie.toLocaleString()??"0"),max:k.replace(`{{${L}}}`,H.toLocaleString()??"0")}:{min:"",mid:"",max:""}}),T=xn(()=>{const k=i.selectedIndicator?.style?.max?.color;return k?e.colors[k]:"#000000"}),E=xn(()=>{const k=i.selectedIndicator?.style?.min?.color;return k?e.colors[k]:"#000000"});return(k,L)=>{const O=mr("v-icon"),H=mr("v-tooltip");return di(),qi("div",{class:W0(["color-legend",{left:k.side==="left",right:k.side==="right"}])},[Ct("div",uH,[Ct("div",hH,[Ct("span",dH,[ms(Qi(k.selectedIndicator?.title||"Indicator")+" ",1),$i(H,{interactive:"","close-delay":"1250",style:{display:"inline-block","max-width":"500px"},location:"bottom",text:k.selectedIndicator["tooltip-info"]},{activator:As(({props:ie})=>[$i(O,qI(ie,{icon:"mdi-information-outline",size:"18",class:"mx-2"}),null,16)]),_:1},8,["text"])])]),Ct("div",pH,[v.value.min!==""&&v.value.max!==""&&v.value.mid!==""?(di(),qi("table",fH,[Ct("tbody",null,[Ct("tr",null,[Ct("td",mH,[Ct("span",{style:pl([{display:"inline-block",width:"8px",height:"8px","border-radius":"50%"},{border:"1px solid black"}])})]),Ct("td",gH,[Ct("span",{style:pl([{display:"inline-block",width:"16px",height:"16px","border-radius":"50%"},{border:"1px solid black"}])})]),Ct("td",yH,[Ct("span",{style:pl([{display:"inline-block",width:"32px",height:"32px","border-radius":"50%"},{border:"1px solid black"}])})])]),Ct("tr",vH,[Ct("td",_H,[Ct("span",bH,Qi(v.value.min??""),1)]),Ct("td",xH,[Ct("span",wH,Qi(v.value.mid.toLocaleString()??""),1)]),Ct("td",SH,[Ct("span",TH,Qi(v.value.max??""),1)])])])])):Ir("",!0),d.value?(di(),qi("div",{key:1,class:"gradient-bar",style:pl({width:"100%",background:`linear-gradient(to right, ${E.value}, ${T.value})`})},null,4)):Ir("",!0),d.value?(di(),qi("table",CH,[Ct("tbody",null,[Ct("tr",EH,[Ct("td",IH,[Ct("span",$H,Qi(a.value?.min.toLocaleString()),1)]),Ct("td",PH,[Ct("span",MH,Qi(a.value?.mid.toLocaleString()),1)]),Ct("td",kH,[Ct("span",AH,Qi(a.value?.max.toLocaleString()),1)])])])])):Ir("",!0),a0(Ct("div",DH,[L[0]||(L[0]=ms("Data Source: ",-1)),Ct("a",{href:h.value?.url,target:"_blank"},[ms(Qi(h.value?.text)+" ",1),$i(O,{icon:"mdi-open-in-new",size:"12"})],8,zH)],512),[[l0,h.value]])])])],2)}}}),E3=Ad(OH,[["__scopeId","data-v-2493c75c"]]);async function I3(t){return await fetch(t+"assets/localStyle.json").then(e=>e.json())}function RH(t){return e=>{if(e.includes("arcgisonline.com")||e.includes("arcgis.com"))return{url:e};if(e.startsWith("/"))return{url:t+e};if(t&&typeof window<"u"){const i=window.location.origin;if(e.startsWith(i+"/")&&!e.includes(t)){const r=e.substring(i.length),o=t.endsWith("/")?t.slice(0,-1):t,h=r.startsWith("/")?r:"/"+r;return{url:i+o+h}}}return{url:e}}}const LH={key:0,class:"solo-exit-wrap"},FH={class:"side-panel left-panel"},NH={class:"side-panel right-panel"},$3="#comparison-container",BH=kd({__name:"ComparisonMap",props:{_center:{},_zoom:{},_type:{},_orientation:{}},setup(t){const e=Yn();let i=null;const r=Yn();let o=null;const h=t,d=Yn();d.value=window.innerWidth>window.innerHeight?"left-right":"top-bottom";const a=yd("left"),v=yd("right"),T=If(),E=qo("mitt");let k=null,L=null,O=null;const H=Yn("side-by-side");function ie(){i?.resize(),o?.resize(),E.emit("resize-maps")}jz(()=>T.currentThemeShortName,async(Pe,Ie)=>{if(Pe&&Pe!==Ie&&i&&o&&i.loaded()&&o.loaded()){const ke=T.getAllCurrentThemeIndicators();if(ke){const Ke=ke.find(dt=>"left".includes(dt.default)),qe=ke.find(dt=>"right".includes(dt.default));Ke&&await a.setIndicatorFromIndicatorShortName(Ke.short_name,E),qe&&await v.setIndicatorFromIndicatorShortName(qe.short_name,E)}}});let pe=!1;B9(()=>{pe=!!(window?.location?.hash&&window.location.hash!=="")}),q1(async()=>{const Pe=qo("sitePath"),Ie=RH(Pe),ke=await I3(Pe),Ke=await I3(Pe);if(e.value&&(i=new Qa.Map({container:e.value,style:ke,center:h._center,zoom:h._zoom,hash:!0,attributionControl:!1,transformRequest:Ie}).addControl(new Qa.NavigationControl({visualizePitch:!0,visualizeRoll:!0,showZoom:!0,showCompass:!0})).addControl(new Qa.AttributionControl({compact:!0}),"top-right"),a.initializeMap(i,E)),r.value&&(o=new Qa.Map({container:r.value,style:Ke,center:h._center,zoom:h._zoom,attributionControl:!1,hash:!0,canvasContextAttributes:{antialias:!0},transformRequest:Ie}).addControl(new Qa.NavigationControl({visualizePitch:!0,visualizeRoll:!0,showZoom:!0,showCompass:!0})).addControl(new Qa.AttributionControl({compact:!0}),"top-right"),v.initializeMap(o,E)),i&&o){const qe=d.value==="top-bottom"?["bottom","left"]:["top","horiz-center"],dt={orientation:d.value,type:"sideBySide",position:qe,showTypeToggle:!1};O=new qz(i,o,$3,dt);let ft=new Qa.LngLatBounds([-81.63527368320112,34.24556219498636],[-80.2,35.22169720245361]);pe||(i.fitBounds(ft,{padding:{top:10,bottom:25,left:5,right:5},animate:!1}),o.fitBounds(ft,{padding:{top:10,bottom:25,left:5,right:5},animate:!1})),O.onceBoth("load",()=>{const et=document.getElementById("loading");et&&et.style&&(et.style.display="none"),Array.from(document.getElementsByClassName("maplibregl-ctrl-attrib")).forEach(We=>{We.classList.remove("maplibregl-compact-show")})})}E.on("location-selected",be),E.on("location-cleared",Ce)});const be=Pe=>{const[Ie,ke]=Pe.coordinates;i&&(i.flyTo({center:[Ie,ke],zoom:Math.max(i.getZoom(),x3),duration:w3,padding:{top:0,bottom:0,left:0,right:window.innerWidth*S3}}),i.once("moveend",()=>{o?.flyTo({center:[Ie,ke],zoom:Math.max(o.getZoom(),x3),duration:w3,padding:{top:0,bottom:0,left:0,right:window.innerWidth*S3}})})),k&&(k.remove(),k=null),L&&(L.remove(),L=null);const Ke=()=>{const qe=document.createElement("div");qe.className="location-marker";const dt=document.createElement("div");return dt.className="pin-icon",dt.innerHTML=`
      <svg width="32" height="40" viewBox="0 0 32 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M16 0C7.163 0 0 7.163 0 16C0 24.837 16 40 16 40C16 40 32 24.837 32 16C32 7.163 24.837 0 16 0Z" fill="#dc2626"/>
        <circle cx="16" cy="16" r="8" fill="white"/>
      </svg>
    `,qe.onclick=ft=>{ft.stopPropagation(),Ce()},qe.appendChild(dt),qe};if(i){const qe=Ke();k=new Qa.Marker({element:qe,anchor:"bottom"}).setLngLat([Ie,ke]).addTo(i)}if(o){const qe=Ke();L=new Qa.Marker({element:qe,anchor:"bottom"}).setLngLat([Ie,ke]).addTo(o)}},Ce=()=>{k&&(k.remove(),k=null),L&&(L.remove(),L=null)};return Uz(()=>{E.off("location-selected",be),E.off("location-cleared",Ce),Ce(),a.removeMap(),v.removeMap(),i&&i.remove(),o&&o.remove(),document.querySelector($3)?.classList.remove("orientation-left-right","orientation-top-bottom")}),(Pe,Ie)=>{const ke=mr("v-icon"),Ke=mr("v-btn");return di(),qi("div",{id:"comparison-container",class:W0([d.value==="top-bottom"?"orientation-top-bottom":"orientation-left-right",H.value==="solo-left"?"solo-left":H.value==="solo-right"?"solo-right":"sideBySide"])},[H.value!=="side-by-side"?(di(),qi("div",LH,[$i(Ke,{size:"small",variant:"tonal",color:"primary",class:"solo-exit-btn",onClick:Ie[0]||(Ie[0]=qe=>{H.value="side-by-side",Qh(ie)})},{default:As(()=>[$i(ke,{start:"",icon:"mdi-arrow-left-right"}),Ie[3]||(Ie[3]=ms(" Back to side-by-side ",-1))]),_:1})])):Ir("",!0),a0(Ct("div",FH,[Ct("div",{ref_key:"mapContainerLeft",ref:e,class:"map-container left"},null,512),H.value==="side-by-side"?(di(),al(Ke,{key:0,size:"small",variant:"tonal",class:"solo-btn solo-btn-left",onClick:Ie[1]||(Ie[1]=qe=>{H.value="solo-left",Qh(ie)})},{default:As(()=>[$i(ke,{start:"",icon:"mdi-fullscreen",size:"18"}),Ie[4]||(Ie[4]=ms(" Solo ",-1))]),_:1})):Ir("",!0),$i(T3,{side:"left"}),us(a).getCurrentIndicator()&&us(a).getCurrentIndicator()?.geolevel==="area"?(di(),al(C3,{key:1,selectedIndicator:us(a).getCurrentIndicator(),side:"left"},null,8,["selectedIndicator"])):us(a).getCurrentIndicator()&&us(a).getCurrentIndicator()?.geolevel==="point"?(di(),al(E3,{key:2,"selected-indicator":us(a).getCurrentIndicator(),side:"left"},null,8,["selected-indicator"])):Ir("",!0)],512),[[l0,H.value!=="solo-right"]]),a0(Ct("div",NH,[Ct("div",{ref_key:"mapContainerRight",ref:r,class:"map-container right"},null,512),H.value==="side-by-side"?(di(),al(Ke,{key:0,size:"small",variant:"tonal",class:"solo-btn solo-btn-right",onClick:Ie[2]||(Ie[2]=qe=>{H.value="solo-right",Qh(ie)})},{default:As(()=>[$i(ke,{start:"",icon:"mdi-fullscreen",size:"18"}),Ie[5]||(Ie[5]=ms(" Solo ",-1))]),_:1})):Ir("",!0),$i(T3,{side:"right"}),us(v).getCurrentIndicator()&&us(v).getCurrentIndicator()?.geolevel==="area"?(di(),al(C3,{key:1,selectedIndicator:us(v).getCurrentIndicator(),side:"right"},null,8,["selectedIndicator"])):us(v).getCurrentIndicator()&&us(v).getCurrentIndicator()?.geolevel==="point"?(di(),al(E3,{key:2,"selected-indicator":us(v).getCurrentIndicator(),side:"right"},null,8,["selected-indicator"])):Ir("",!0)],512),[[l0,H.value!=="solo-left"]])],2)}}}),fr=(t,e,...i)=>{try{return t?.call(e,...i)}catch(r){console.error(r,t)}},KT=async(t,e,...i)=>{try{return await t?.call(e,...i)}catch(r){console.error(r,t)}},i$=Symbol.for("controller"),jH=t=>typeof t=="object"&&t!==null&&(i$ in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),UH=t=>typeof t?.then=="function";let py;const ff=t=>{py!==t&&(py=t,queueMicrotask(()=>py===t?py=void 0:0))},xm=t=>py;let Fh=[];const PO=t=>{if(t===void 0){Fh=[];return}const e=Fh.indexOf(t);Fh=e===-1?[...Fh,t]:Fh.slice(0,e+1),queueMicrotask(()=>Fh=[])},MO=()=>Fh;let mf;const VH=t=>{mf!==t&&(mf=t,queueMicrotask(()=>mf===t?mf=void 0:0))},GH=()=>{const t=mf;return mf=void 0,t},qH=async(t,e)=>{const i=r$(t);if(i===void 0)return t;if(await i.ready,typeof e=="function"){const r=i.watchExports(o=>e(o,r))}return i.exports},HH=async t=>{const e=r$(t);return await e.ready,e},r$=t=>{const i=xm().manager.X(t);if(i!==void 0)return i;if(jH(t))return t;const r=GH();if(r!==void 0)return r};let QT=!1;const ZH=t=>{QT=!0;try{return t()}finally{QT=!1}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const pb=globalThis,n$=pb.ShadowRoot&&(pb.ShadyCSS===void 0||pb.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$=Symbol(),P3=new WeakMap;let kO=class{constructor(e,i,r){if(this._$cssResult$=!0,r!==s$)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=i}get styleSheet(){let e=this.o;const i=this.t;if(n$&&e===void 0){const r=i!==void 0&&i.length===1;r&&(e=P3.get(i)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&P3.set(i,e))}return e}toString(){return this.cssText}};const WH=t=>new kO(typeof t=="string"?t:t+"",void 0,s$),Gi=(t,...e)=>{const i=t.length===1?t[0]:e.reduce(((r,o,h)=>r+(d=>{if(d._$cssResult$===!0)return d.cssText;if(typeof d=="number")return d;throw Error("Value passed to 'css' function must be a 'css' function result: "+d+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+t[h+1]),t[0]);return new kO(i,t,s$)},YH=(t,e)=>{if(n$)t.adoptedStyleSheets=e.map((i=>i instanceof CSSStyleSheet?i:i.styleSheet));else for(const i of e){const r=document.createElement("style"),o=pb.litNonce;o!==void 0&&r.setAttribute("nonce",o),r.textContent=i.cssText,t.appendChild(r)}},M3=n$?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let i="";for(const r of e.cssRules)i+=r.cssText;return WH(i)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:XH,defineProperty:JH,getOwnPropertyDescriptor:KH,getOwnPropertyNames:QH,getOwnPropertySymbols:eZ,getPrototypeOf:tZ}=Object,Y1=globalThis,k3=Y1.trustedTypes,iZ=k3?k3.emptyScript:"",rZ=Y1.reactiveElementPolyfillSupport,Ry=(t,e)=>t,eC={toAttribute(t,e){switch(e){case Boolean:t=t?iZ:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=t!==null;break;case Number:i=t===null?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch{i=null}}return i}},o$=(t,e)=>!XH(t,e),A3={attribute:!0,type:String,converter:eC,reflect:!1,useDefault:!1,hasChanged:o$};Symbol.metadata??=Symbol("metadata"),Y1.litPropertyMetadata??=new WeakMap;let ef=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,i=A3){if(i.state&&(i.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((i=Object.create(i)).wrapped=!0),this.elementProperties.set(e,i),!i.noAccessor){const r=Symbol(),o=this.getPropertyDescriptor(e,r,i);o!==void 0&&JH(this.prototype,e,o)}}static getPropertyDescriptor(e,i,r){const{get:o,set:h}=KH(this.prototype,e)??{get(){return this[i]},set(d){this[i]=d}};return{get:o,set(d){const a=o?.call(this);h?.call(this,d),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??A3}static _$Ei(){if(this.hasOwnProperty(Ry("elementProperties")))return;const e=tZ(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Ry("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ry("properties"))){const i=this.properties,r=[...QH(i),...eZ(i)];for(const o of r)this.createProperty(o,i[o])}const e=this[Symbol.metadata];if(e!==null){const i=litPropertyMetadata.get(e);if(i!==void 0)for(const[r,o]of i)this.elementProperties.set(r,o)}this._$Eh=new Map;for(const[i,r]of this.elementProperties){const o=this._$Eu(i,r);o!==void 0&&this._$Eh.set(o,i)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const i=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const o of r)i.unshift(M3(o))}else e!==void 0&&i.push(M3(e));return i}static _$Eu(e,i){const r=i.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,i=this.constructor.elementProperties;for(const r of i.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return YH(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,i,r){this._$AK(e,r)}_$ET(e,i){const r=this.constructor.elementProperties.get(e),o=this.constructor._$Eu(e,r);if(o!==void 0&&r.reflect===!0){const h=(r.converter?.toAttribute!==void 0?r.converter:eC).toAttribute(i,r.type);this._$Em=e,h==null?this.removeAttribute(o):this.setAttribute(o,h),this._$Em=null}}_$AK(e,i){const r=this.constructor,o=r._$Eh.get(e);if(o!==void 0&&this._$Em!==o){const h=r.getPropertyOptions(o),d=typeof h.converter=="function"?{fromAttribute:h.converter}:h.converter?.fromAttribute!==void 0?h.converter:eC;this._$Em=o;const a=d.fromAttribute(i,h.type);this[o]=a??this._$Ej?.get(o)??a,this._$Em=null}}requestUpdate(e,i,r){if(e!==void 0){const o=this.constructor,h=this[e];if(r??=o.getPropertyOptions(e),!((r.hasChanged??o$)(h,i)||r.useDefault&&r.reflect&&h===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,r))))return;this.C(e,i,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,i,{useDefault:r,reflect:o,wrapped:h},d){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,d??i??this[e]),h!==!0||d!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(i=void 0),this._$AL.set(e,i)),o===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(i){Promise.reject(i)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[o,h]of this._$Ep)this[o]=h;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[o,h]of r){const{wrapped:d}=h,a=this[o];d!==!0||this._$AL.has(o)||a===void 0||this.C(o,void 0,h,a)}}let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),this._$EO?.forEach((r=>r.hostUpdate?.())),this.update(i)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(i)}willUpdate(e){}_$AE(e){this._$EO?.forEach((i=>i.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((i=>this._$ET(i,this[i]))),this._$EM()}updated(e){}firstUpdated(e){}};ef.elementStyles=[],ef.shadowRootOptions={mode:"open"},ef[Ry("elementProperties")]=new Map,ef[Ry("finalized")]=new Map,rZ?.({ReactiveElement:ef}),(Y1.reactiveElementVersions??=[]).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const a$=globalThis,xx=a$.trustedTypes,D3=xx?xx.createPolicy("lit-html",{createHTML:t=>t}):void 0,AO="$lit$",Tu=`lit$${Math.random().toFixed(9).slice(2)}$`,DO="?"+Tu,nZ=`<${DO}>`,vd=document,d0=()=>vd.createComment(""),p0=t=>t===null||typeof t!="object"&&typeof t!="function",l$=Array.isArray,sZ=t=>l$(t)||typeof t?.[Symbol.iterator]=="function",CS=`[ 	
\f\r]`,Wg=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,z3=/-->/g,O3=/>/g,Mh=RegExp(`>|${CS}(?:([^\\s"'>=/]+)(${CS}*=${CS}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),R3=/'/g,L3=/"/g,zO=/^(?:script|style|textarea|title)$/i,OO=t=>(e,...i)=>({_$litType$:t,strings:e,values:i}),Fe=OO(1),f0=OO(2),uo=Symbol.for("lit-noChange"),ut=Symbol.for("lit-nothing"),F3=new WeakMap,td=vd.createTreeWalker(vd,129);function RO(t,e){if(!l$(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return D3!==void 0?D3.createHTML(e):e}const oZ=(t,e)=>{const i=t.length-1,r=[];let o,h=e===2?"<svg>":e===3?"<math>":"",d=Wg;for(let a=0;a<i;a++){const v=t[a];let T,E,k=-1,L=0;for(;L<v.length&&(d.lastIndex=L,E=d.exec(v),E!==null);)L=d.lastIndex,d===Wg?E[1]==="!--"?d=z3:E[1]!==void 0?d=O3:E[2]!==void 0?(zO.test(E[2])&&(o=RegExp("</"+E[2],"g")),d=Mh):E[3]!==void 0&&(d=Mh):d===Mh?E[0]===">"?(d=o??Wg,k=-1):E[1]===void 0?k=-2:(k=d.lastIndex-E[2].length,T=E[1],d=E[3]===void 0?Mh:E[3]==='"'?L3:R3):d===L3||d===R3?d=Mh:d===z3||d===O3?d=Wg:(d=Mh,o=void 0);const O=d===Mh&&t[a+1].startsWith("/>")?" ":"";h+=d===Wg?v+nZ:k>=0?(r.push(T),v.slice(0,k)+AO+v.slice(k)+Tu+O):v+Tu+(k===-2?a:O)}return[RO(t,h+(t[i]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};let tC=class LO{constructor({strings:e,_$litType$:i},r){let o;this.parts=[];let h=0,d=0;const a=e.length-1,v=this.parts,[T,E]=oZ(e,i);if(this.el=LO.createElement(T,r),td.currentNode=this.el.content,i===2||i===3){const k=this.el.content.firstChild;k.replaceWith(...k.childNodes)}for(;(o=td.nextNode())!==null&&v.length<a;){if(o.nodeType===1){if(o.hasAttributes())for(const k of o.getAttributeNames())if(k.endsWith(AO)){const L=E[d++],O=o.getAttribute(k).split(Tu),H=/([.?@])?(.*)/.exec(L);v.push({type:1,index:h,name:H[2],strings:O,ctor:H[1]==="."?lZ:H[1]==="?"?cZ:H[1]==="@"?uZ:J1}),o.removeAttribute(k)}else k.startsWith(Tu)&&(v.push({type:6,index:h}),o.removeAttribute(k));if(zO.test(o.tagName)){const k=o.textContent.split(Tu),L=k.length-1;if(L>0){o.textContent=xx?xx.emptyScript:"";for(let O=0;O<L;O++)o.append(k[O],d0()),td.nextNode(),v.push({type:2,index:++h});o.append(k[L],d0())}}}else if(o.nodeType===8)if(o.data===DO)v.push({type:2,index:h});else{let k=-1;for(;(k=o.data.indexOf(Tu,k+1))!==-1;)v.push({type:7,index:h}),k+=Tu.length-1}h++}}static createElement(e,i){const r=vd.createElement("template");return r.innerHTML=e,r}};function em(t,e,i=t,r){if(e===uo)return e;let o=r!==void 0?i._$Co?.[r]:i._$Cl;const h=p0(e)?void 0:e._$litDirective$;return o?.constructor!==h&&(o?._$AO?.(!1),h===void 0?o=void 0:(o=new h(t),o._$AT(t,i,r)),r!==void 0?(i._$Co??=[])[r]=o:i._$Cl=o),o!==void 0&&(e=em(t,o._$AS(t,e.values),o,r)),e}let aZ=class{constructor(e,i){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:i},parts:r}=this._$AD,o=(e?.creationScope??vd).importNode(i,!0);td.currentNode=o;let h=td.nextNode(),d=0,a=0,v=r[0];for(;v!==void 0;){if(d===v.index){let T;v.type===2?T=new X1(h,h.nextSibling,this,e):v.type===1?T=new v.ctor(h,v.name,v.strings,this,e):v.type===6&&(T=new hZ(h,this,e)),this._$AV.push(T),v=r[++a]}d!==v?.index&&(h=td.nextNode(),d++)}return td.currentNode=vd,o}p(e){let i=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,i),i+=r.strings.length-2):r._$AI(e[i])),i++}},X1=class FO{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,i,r,o){this.type=2,this._$AH=ut,this._$AN=void 0,this._$AA=e,this._$AB=i,this._$AM=r,this.options=o,this._$Cv=o?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const i=this._$AM;return i!==void 0&&e?.nodeType===11&&(e=i.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,i=this){e=em(this,e,i),p0(e)?e===ut||e==null||e===""?(this._$AH!==ut&&this._$AR(),this._$AH=ut):e!==this._$AH&&e!==uo&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):sZ(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==ut&&p0(this._$AH)?this._$AA.nextSibling.data=e:this.T(vd.createTextNode(e)),this._$AH=e}$(e){const{values:i,_$litType$:r}=e,o=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=tC.createElement(RO(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===o)this._$AH.p(i);else{const h=new aZ(o,this),d=h.u(this.options);h.p(i),this.T(d),this._$AH=h}}_$AC(e){let i=F3.get(e.strings);return i===void 0&&F3.set(e.strings,i=new tC(e)),i}k(e){l$(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let r,o=0;for(const h of e)o===i.length?i.push(r=new FO(this.O(d0()),this.O(d0()),this,this.options)):r=i[o],r._$AI(h),o++;o<i.length&&(this._$AR(r&&r._$AB.nextSibling,o),i.length=o)}_$AR(e=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}},J1=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,i,r,o,h){this.type=1,this._$AH=ut,this._$AN=void 0,this.element=e,this.name=i,this._$AM=o,this.options=h,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=ut}_$AI(e,i=this,r,o){const h=this.strings;let d=!1;if(h===void 0)e=em(this,e,i,0),d=!p0(e)||e!==this._$AH&&e!==uo,d&&(this._$AH=e);else{const a=e;let v,T;for(e=h[0],v=0;v<h.length-1;v++)T=em(this,a[r+v],i,v),T===uo&&(T=this._$AH[v]),d||=!p0(T)||T!==this._$AH[v],T===ut?e=ut:e!==ut&&(e+=(T??"")+h[v+1]),this._$AH[v]=T}d&&!o&&this.j(e)}j(e){e===ut?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},lZ=class extends J1{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===ut?void 0:e}},cZ=class extends J1{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==ut)}},uZ=class extends J1{constructor(e,i,r,o,h){super(e,i,r,o,h),this.type=5}_$AI(e,i=this){if((e=em(this,e,i,0)??ut)===uo)return;const r=this._$AH,o=e===ut&&r!==ut||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,h=e!==ut&&(r===ut||o);o&&this.element.removeEventListener(this.name,this,r),h&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},hZ=class{constructor(e,i,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=i,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){em(this,e)}};const dZ={I:X1},pZ=a$.litHtmlPolyfillSupport;pZ?.(tC,X1),(a$.litHtmlVersions??=[]).push("3.3.1");const NO=(t,e,i)=>{const r=i?.renderBefore??e;let o=r._$litPart$;if(o===void 0){const h=i?.renderBefore??null;r._$litPart$=o=new X1(e.insertBefore(d0(),h),h,void 0,i??{})}return o._$AI(t),o};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const c$=globalThis;let Pf=class extends ef{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const i=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=NO(i,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return uo}};Pf._$litElement$=!0,Pf.finalized=!0,c$.litElementHydrateSupport?.({LitElement:Pf});const fZ=c$.litElementPolyfillSupport;fZ?.({LitElement:Pf});(c$.litElementVersions??=[]).push("4.2.1");class m0{constructor(){this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}}const mZ=(t,e)=>{const i=e/gZ;let r=0;const o=setInterval(()=>{r+=i,r>=e&&(clearInterval(o),t())},i);return o},gZ=4,yZ=(t,e,i)=>{const r=Object.keys(t),o=r.length;gf===void 0&&queueMicrotask(K1),gf??=new Map;let h=gf.get(t);return h===void 0&&(h={callbacks:[],keyCount:o},gf.set(t,h)),h.keyCount!==o&&(h.callbacks.forEach(d=>d(r)),h.callbacks=[],h.keyCount=o),h.callbacks.push(d=>{const a=T=>fr(e,null,T),v=d[o];v===void 0?a(void 0):t[v]===i?a(v):a(void 0)}),i};let gf;const K1=()=>{gf?.forEach(({callbacks:t},e)=>{const i=Object.keys(e);t.forEach(r=>r(i))}),gf=void 0},BO=(t,e,i)=>{const r=t.manager;return r.V!==ut&&r.V!==i&&r.S(void 0,void 0),r.T.length===0&&queueMicrotask(()=>r.S(void 0,void 0)),r.V=i,r.T.push((o,h)=>fr(e,void 0,i===h?o:void 0)),i},u$=(t=[xm(),...MO()],e,i)=>{const r=Array.isArray(t)?t:[t];let o=r.length+1;const h=d=>{o-=1,d!==void 0&&(o=Math.min(o,0)),o===0&&e(d)};r.forEach(d=>yZ(d,a=>h(a===void 0?void 0:{key:a,host:d,isReactive:!1}),i));for(const d of r)if("manager"in d&&d.manager.component===d){BO(d,a=>h(a===void 0?void 0:{key:a,host:d,isReactive:!0}),i);break}return i},h$=(t="",e={},i=xm())=>{const r={emit:o=>{t===""&&K1();const h=new CustomEvent(t,{detail:o,cancelable:!0,bubbles:!0,composed:!0,...e});return i.el.dispatchEvent(h),h}};return t===""&&u$(void 0,o=>t=o.key,r),r},vt=h$.bind(null,"");var jO;jO=i$;class d${constructor(e){this.#e=[],this.#t=[],this.#i=[],this.#l=[],this.#c=[],this.#u=[],this.#h=[],this.#d=[],this.#o=[],this.#a=!1,this.P=new m0,this.connectedCalled=!1,this.loadedCalled=!1,this[jO]=!0,this.#s=[];const i=this,r=e??xm();i.#r=r,i.ready=i.P.promise,i.#n=B3(i),i.component=r,i.#r.addController(i),i.#r.manager===void 0||(PO(i),queueMicrotask(()=>i.catchUpLifecycle()))}#e;#t;#i;#l;#c;#u;#h;#d;#o;#a;#r;catchUpLifecycle(){const{manager:e}=this.#r;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#n;get exports(){return this.#n}set exports(e){const i=this.#n;i!==e&&(this.#n=e,this.#s.forEach(fr),this.connectedCalled&&this.O!==!1&&this.#r.requestUpdate(this.O,i)),this.P.resolve(e)}setProvisionalExports(e,i=!0){this.#n=i?B3(e):e,this.#s.forEach(fr)}#s;watchExports(e){const i=()=>e(this.#n);return this.#s.push(i),()=>void this.#s.splice(this.#s.indexOf(i),1)}get use(){return ff(this.#r),qH}get useRef(){return ff(this.#r),HH}get useRefSync(){return ff(this.#r),r$}controllerRemoved(){this.#r.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#e.push(e)}onDisconnected(e){this.#t.push(e)}onLoad(e){this.#i.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#c.push(e)}onUpdated(e){this.#u.push(e)}onDestroy(e){this.#h.push(e)}onLifecycle(e){this.#d.push(e),this.connectedCalled&&this.#r.el.isConnected&&this.#p(e)}triggerConnected(){const e=this;e.hostConnected&&fr(e.hostConnected,e),e.#e.forEach(fr),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&fr(e.hostDisconnected,e),e.#t.forEach(fr),e.#o.forEach(fr),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await KT(e.hostLoad,e),this.#i.length>0&&await Promise.allSettled(this.#i.map(KT)),this.P.resolve(this.#n)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&fr(this.hostLoaded,this),this.#l.forEach(fr),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&fr(this.hostUpdate,this,e),this.#c.forEach(N3,e)}triggerUpdated(e){this.hostUpdated&&fr(this.hostUpdated,this,e),this.#u.forEach(N3,e)}triggerDestroy(){this.hostDestroy&&fr(this.hostDestroy,this),this.#h.forEach(fr)}triggerLifecycle(){this.hostLifecycle&&this.#p(()=>this.hostLifecycle()),this.#d.forEach(this.#p,this)}#p(e){ff(this.#r);const i=fr(e);(Array.isArray(i)?i:[i]).forEach(o=>{typeof o=="function"?this.#o.push(o):typeof o=="object"&&typeof o.remove=="function"&&this.#o.push(o.remove)})}}function N3(t){fr(t,void 0,this)}const p$=d$,B3=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(r,o,h){if(!((o==="exports"||o==="_exports")&&o in r&&r[o]===i)&&(o in r||o in Promise.prototype||typeof o=="symbol"))return typeof r=="function"?r[o]:Reflect.get(r,o,h)}},i=new Proxy(t,e);return i},vZ=t=>t.replace(_Z,(e,i)=>`${i===0?"":"-"}${e.toLowerCase()}`),_Z=/[A-Z]+(?![a-z])|[A-Z]/gu,bZ=1,xZ=2,wZ=4,SZ=8,TZ=16,CZ=32,EZ=64,UO=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const i=e;return i.manager?.loadedCalled||(i.J??i._offspring).push(t),(i.I??i._postLoad).promise}return!1},j3={};function VO(){}const fb=Object.defineProperty,IZ=globalThis.HTMLElement??VO;var Ts,pc,Nf,q0,iC;const sM=class sM extends IZ{constructor(){var o;super();na(this,q0);na(this,Ts);na(this,pc);na(this,Nf);sa(this,pc,{}),sa(this,Nf,[]),this.I=new m0,this.H=new m0,this.J=[];const i=this,r=i.constructor;i._offspring=i.J,i._postLoad=i.I,r.C?.forEach(h=>{Object.hasOwn(i,h)&&(Ai(i,pc)[h]=i[h],delete i[h])}),r.A?Hg(o=i,q0,iC).call(o,{a:r.A}):r.B.then(async h=>{var d;await r.K.p,Hg(d=i,q0,iC).call(d,await(h.default?.then(a=>typeof a=="function"?{a}:a)??h))}).catch(h=>{i.H.reject(h),setTimeout(()=>{throw h})})}static F(){for(const i of this.C??[])fb(this.prototype,i,{configurable:!0,enumerable:!0,get(){return Ai(this,pc)[i]},set(r){Ai(this,pc)[i]=r}});for(const i of this.E??[])fb(this.prototype,i,{async value(...r){return Ai(this,Ts)||await this.H.promise,await Ai(this,Ts)[i](...r)},configurable:!0});for(const i of this.D??[])fb(this.prototype,i,{value(...r){return Ai(this,Ts)[i](...r)},configurable:!0})}get manager(){return Ai(this,Ts)?.manager}attributeChangedCallback(i,r,o){Ai(this,Ts)?.attributeChangedCallback(i,r,o),Ai(this,Ts)||Ai(this,Nf).push(i)}connectedCallback(){Ai(this,Ts)?Ai(this,Ts).connectedCallback?.():queueMicrotask(()=>this.G=UO(this))}disconnectedCallback(){Ai(this,Ts)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){Ai(this,Ts)?.requestUpdate()}};Ts=new WeakMap,pc=new WeakMap,Nf=new WeakMap,q0=new WeakSet,iC=function(i){const r=this.constructor,o=r.L,h=Ai(this,pc),d=Object.values(i).find(L=>L.L===o),a=`${o}--lazy`;let v=d;for(;v&&!Object.hasOwn(v,"lumina");)v=Object.getPrototypeOf(v);PZ(v),!r.A&&(r.A=d,customElements.define(a,d)),d.N=this;const E=document.createElement(a);d.N=void 0,sa(this,Ts,E),sa(this,pc,E),Ai(this,Nf).forEach(L=>E.attributeChangedCallback(L,null,this.getAttribute(L))),Object.entries(h).forEach($Z,E);const k=this.isConnected;(k||this.G)&&(E.connectedCallback?.(),k||E.disconnectedCallback())},sM.lumina=!0;let U3=sM;function $Z([t,e]){this[t]=e}const PZ=t=>{const e=t.prototype,i=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(o,h){i.setAttribute.call(this.el,o,h)},e.removeAttribute=function(o){i.removeAttribute.call(this.el,o)},fb(e,"isConnected",{get(){return Reflect.get(i,"isConnected",this.el)}}))};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ll={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},wm=t=>(...e)=>({_$litDirective$:t,values:e});let Sm=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,i,r){this._$Ct=e,this._$AM=i,this._$Ci=r}_$AS(e,i){return this.update(e,i)}update(e,i){return this.render(...i)}};/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const MZ=wm(class extends Sm{constructor(t){if(super(t),t.type!==ll.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((r=>r!==""))));for(const r in e)e[r]&&!this.nt?.has(r)&&this.st.add(r);return this.render(e)}const i=t.element.classList;for(const r of this.st)r in e||(i.remove(r),this.st.delete(r));for(const r in e){const o=!!e[r];o===this.st.has(r)||this.nt?.has(r)||(o?(i.add(r),this.st.add(r)):(i.remove(r),this.st.delete(r)))}return uo}});/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const GO="important",kZ=" !"+GO,AZ=wm(class extends Sm{constructor(t){if(super(t),t.type!==ll.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce(((e,i)=>{const r=t[i];return r==null?e:e+`${i=i.includes("-")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`}),"")}update(t,[e]){const{style:i}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const r of this.ft)e[r]==null&&(this.ft.delete(r),r.includes("-")?i.removeProperty(r):i[r]=null);for(const r in e){const o=e[r];if(o!=null){this.ft.add(r);const h=typeof o=="string"&&o.endsWith(kZ);r.includes("-")||h?i.setProperty(r,h?o.slice(0,-11):o,h?GO:""):i[r]=o}}return uo}});/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{I:DZ}=dZ,qO=t=>t.strings===void 0,V3=()=>document.createComment(""),Yg=(t,e,i)=>{const r=t._$AA.parentNode,o=e===void 0?t._$AB:e._$AA;if(i===void 0){const h=r.insertBefore(V3(),o),d=r.insertBefore(V3(),o);i=new DZ(h,d,t,t.options)}else{const h=i._$AB.nextSibling,d=i._$AM,a=d!==t;if(a){let v;i._$AQ?.(t),i._$AM=t,i._$AP!==void 0&&(v=t._$AU)!==d._$AU&&i._$AP(v)}if(h!==o||a){let v=i._$AA;for(;v!==h;){const T=v.nextSibling;r.insertBefore(v,o),v=T}}}return i},kh=(t,e,i=t)=>(t._$AI(e,i),t),zZ={},f$=(t,e=zZ)=>t._$AH=e,OZ=t=>t._$AH,ES=t=>{t._$AR(),t._$AA.remove()};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const G3=wm(class extends Sm{constructor(t){if(super(t),t.type!==ll.PROPERTY&&t.type!==ll.ATTRIBUTE&&t.type!==ll.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!qO(t))throw Error("`live` bindings can only contain a single expression")}render(t){return t}update(t,[e]){if(e===uo||e===ut)return e;const i=t.element,r=t.name;if(t.type===ll.PROPERTY){if(e===i[r])return uo}else if(t.type===ll.BOOLEAN_ATTRIBUTE){if(!!e===i.hasAttribute(r))return uo}else if(t.type===ll.ATTRIBUTE&&i.getAttribute(r)===e+"")return uo;return f$(t),e}});/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ly=(t,e)=>{const i=t._$AN;if(i===void 0)return!1;for(const r of i)r._$AO?.(e,!1),Ly(r,e);return!0},wx=t=>{let e,i;do{if((e=t._$AM)===void 0)break;i=e._$AN,i.delete(t),t=e}while(i?.size===0)},HO=t=>{for(let e;e=t._$AM;t=e){let i=e._$AN;if(i===void 0)e._$AN=i=new Set;else if(i.has(t))break;i.add(t),FZ(e)}};function RZ(t){this._$AN!==void 0?(wx(this),this._$AM=t,HO(this)):this._$AM=t}function LZ(t,e=!1,i=0){const r=this._$AH,o=this._$AN;if(o!==void 0&&o.size!==0)if(e)if(Array.isArray(r))for(let h=i;h<r.length;h++)Ly(r[h],!1),wx(r[h]);else r!=null&&(Ly(r,!1),wx(r));else Ly(this,t)}const FZ=t=>{t.type==ll.CHILD&&(t._$AP??=LZ,t._$AQ??=RZ)};let NZ=class extends Sm{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,i,r){super._$AT(e,i,r),HO(this),this.isConnected=e._$AU}_$AO(e,i=!0){e!==this.isConnected&&(this.isConnected=e,e?this.reconnected?.():this.disconnected?.()),i&&(Ly(this,e),wx(this))}setValue(e){if(qO(this._$Ct))this._$Ct._$AI(e,this);else{const i=[...this._$Ct._$AH];i[this._$Ci]=e,this._$Ct._$AI(i,this,0)}}disconnected(){}reconnected(){}};/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Xn=()=>new BZ;let BZ=class{};const IS=new WeakMap,hi=wm(class extends NZ{render(t){return ut}update(t,[e]){const i=e!==this.G;return i&&this.G!==void 0&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.G=e,this.ht=t.options?.host,this.rt(this.ct=t.element)),ut}rt(t){if(this.isConnected||(t=void 0),typeof this.G=="function"){const e=this.ht??globalThis;let i=IS.get(e);i===void 0&&(i=new WeakMap,IS.set(e,i)),i.get(this.G)!==void 0&&this.G.call(this.ht,void 0),i.set(this.G,t),t!==void 0&&this.G.call(this.ht,t)}else this.G.value=t}get lt(){return typeof this.G=="function"?IS.get(this.ht??globalThis)?.get(this.G):this.G?.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});class jZ extends p${constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=ut,this.T=[],this.#i=new WeakMap,this.#t=e,this.exports=void 0,this.hasDestroy=rC in e&&typeof e.destroy=="function",Pf.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const i=e.el.localName;throw e.el.remove(),new Error(`The ${i} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${rC} prop.`)}this.#e!==void 0&&clearTimeout(this.#e),K1();for(const i of e.M)"triggerConnected"in i?i.triggerConnected():fr(i.hostConnected,i)},hostDisconnected:()=>{for(const i of e.M)"triggerDisconnected"in i?i.triggerDisconnected():fr(i.hostDisconnected,i);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const i of e.M)"triggerUpdate"in i?i.triggerUpdate(this.Q):fr(i.hostUpdate,i,this.Q)},hostUpdated:()=>{for(const i of e.M)"triggerUpdated"in i?i.triggerUpdated(this.Q):fr(i.hostUpdated,i,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),ff(e)}#e;#t;async destroy(){if(!this.destroyed){this.#t.el.isConnected&&(this.hasDestroy=!1,this.#t.el.remove()),this.#e=void 0,this.destroyed=!0;for(const e of this.#t.M)"triggerDestroy"in e?e.triggerDestroy():fr(e.hostDestroy,e);this.#t.M.splice(0)}}U(){if(this.#e!==void 0&&clearTimeout(this.#e),!this.#t.el.isConnected&&!this.#t.autoDestroyDisabled){const e=()=>void this.#t.destroy();this.#e=mZ(e,UZ)}}S(e,i){const r=this.T;this.V=ut,this.T=[],r.forEach(o=>o(e,i))}#i;W(e,i){(typeof i=="object"&&i!==null||typeof i=="function")&&this.#i.set(i,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#i.get(e)}}let UZ=1e3;const rC="autoDestroyDisabled";var sd,H0,Z0,od,ol,bm,ZO,WO;const r0=class r0 extends Pf{constructor(){super();na(this,bm);na(this,sd);na(this,H0);na(this,Z0);na(this,od);na(this,ol);this.M=[],this.manager=new jZ(this);const i=this,r=i.constructor,o=r.N,h=r.K.o,d=r0.prototype.shouldUpdate;sa(i,od,o?.H??new m0),i.I=o?.I??new m0,i.J=o?.J??[],i._offspring=i.J,i._postLoad=i.I,i.el=o??i,sa(i,Z0,i.enableUpdating),i.enableUpdating=VO,i.shouldUpdate!==d&&(sa(i,H0,i.shouldUpdate),i.shouldUpdate=d),h&&(sa(i,sd,new Map),r.elementProperties.forEach((a,v)=>Ai(i,sd).set(v,h())))}static finalizeStyles(i){const r=super.finalizeStyles(i),o=this.shadowRootOptions===j3;return this.K?.commonStyles===void 0||o?r:[this.K.commonStyles,...r]}static createProperty(i,r){const o=typeof r=="number"?r:Array.isArray(r)?r[0]:0,h=Array.isArray(r)?r[1]:void 0,d=h?.hasChanged??o$,a={attribute:o&bZ&&typeof i=="string"?vZ(i):!1,reflect:!!(o&xZ),type:o&wZ?Boolean:o&SZ?Number:void 0,state:!!(o&TZ),readOnly:!!(o&CZ),noAccessor:!!(o&EZ),c:!1,...h,hasChanged(v,T){const E=d(v,T);return a.c=E,E}};super.createProperty(i,a)}static getPropertyDescriptor(i,r,o){const h=this.K,d=super.getPropertyDescriptor(i,r,o);return o.d=d,{...d,get(){return h.t?.(Ai(this,sd).get(i)),d.get?.call(this)},set(a){const v=this.manager;if(o.readOnly&&!QT&&(v.R||v.connectedCalled))throw Error(`Cannot assign to read-only property "${i}" of ${this.el.localName}. Trying to assign "${a}"`);d.set.call(this,a??void 0),o.c&&Ai(this,sd)?.get(i)?.notify(),v.T.length>0&&(K1(),v?.S(i,a))}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const i=this.constructor.K.c?.(()=>this.requestUpdate());sa(this,ol,i);const r=!this.manager.connectedCalled;super.connectedCallback(),r?queueMicrotask(()=>Hg(this,bm,WO).call(this).catch(o=>{Ai(this,od).reject(o),setTimeout(()=>{throw o})})):i&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),Ai(this,ol)?.destroy(),sa(this,ol,void 0)}createRenderRoot(){const i=this.el.shadowRoot,r=this.constructor,o=r.shadowRootOptions,d=i??(o===j3?this.el:this.el.attachShadow(o));if(this.isConnected){const a=d.getRootNode();a.adoptedStyleSheets=[...a.adoptedStyleSheets,...r.elementStyles.map(v=>"styleSheet"in v?v.styleSheet:v)]}return d}shouldUpdate(i){var r;return this.manager.Q=i,((r=Ai(this,H0))==null?void 0:r.call(this,i))??!0}update(i){Ai(this,ol)?Hg(this,bm,ZO).call(this,i):super.update(i)}listen(i,r,o){const h=r?.bind(this)??r;this.manager.onLifecycle(()=>(this.el.addEventListener(i,h,o),()=>this.el.removeEventListener(i,h,o)))}listenOn(i,r,o,h){const d=o?.bind(this)??o;this.manager.onLifecycle(()=>(i.addEventListener(r,d,h),()=>i.removeEventListener(r,d,h)))}async componentOnReady(){return await Ai(this,od).promise,this}addController(i){this.M.push(i),!(i$ in i)&&this.renderRoot&&this.el.isConnected&&i.hostConnected?.()}removeController(i){this.M.splice(this.M.indexOf(i),1),i.controllerRemoved?.()}};sd=new WeakMap,H0=new WeakMap,Z0=new WeakMap,od=new WeakMap,ol=new WeakMap,bm=new WeakSet,ZO=function(i){try{Ai(this,ol).clear(),this.constructor.K.r(Ai(this,ol),()=>jk(r0.prototype,this,"update").call(this,i))}catch(r){throw Ai(this,ol).clear(),r}},WO=async function(){const i=this.el.G??UO(this.el);i&&await i;const r=[];for(const h of this.M)"triggerLoad"in h?r.push(h.triggerLoad()):r.push(KT(h.hostLoad,h));await Promise.all(r),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(h=>h.has(rC)&&this.manager.U()),Ai(this,Z0).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const o=this.J.filter(h=>!h.manager?.loadedCalled);o.length&&await Promise.allSettled(o.map(async h=>await h.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const h of this.M)"triggerLoaded"in h?h.triggerLoaded():fr(h.hostLoaded,h);this.loaded?.(),Ai(this,od).resolve()},r0.lumina=!0;let Vi=r0;const YO=t=>{let e;const i=o=>{e=new URL(o,globalThis.location?.href||void 0).href},r={...t,getAssetPath(o){const h=new URL(o,e);return h.origin!==globalThis.location?.origin?h.href:h.pathname},setAssetPath:i,customElement(o,h){h.K=r,h.L=o,customElements.get(o)||customElements.define(o,h)}};return i(t.defaultAssetPath),r},Le=t=>typeof t=="object"&&t!=null?MZ(t):t,XO=t=>typeof t=="object"&&t!=null?AZ(t):t,Ou=ut;function Q1(t,e,i){i==null?t.removeAttribute(e):t.setAttribute(e,i)}const _d={toAttribute:t=>t===!0?"":t===!1?null:t},VZ=t=>{const e=document.createElement("div");return NO(t,e),e.firstElementChild},GZ="calcite-mode-auto",qZ="calcite-mode-dark",JO={rtl:"calcite--rtl"},m$={filter:250,nextTick:0,reposition:100},bpe=25;function q3(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains(qZ)||t.contains(GZ)&&e?"dark":"light",r=d=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:d}})),o=d=>{h!==d&&r(d),h=d};let h=i();r(h),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",d=>o(d.matches?"dark":"light")),new MutationObserver(()=>o(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const Fy=globalThis.calciteConfig,HZ=Fy?.focusTrapStack||[],ZZ=Fy?.logLevel||"info",H3="3.3.3",WZ="2025-10-08",YZ="7391af08e";function XZ(){if(Fy&&Fy.version)return;console.info(`Using Calcite Components ${H3} [Date: ${WZ}, Revision: ${YZ}]`);const t=Fy||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:H3,writable:!1}),globalThis.calciteConfig=t}document.readyState==="interactive"?q3():document.addEventListener("DOMContentLoaded",q3,{once:!0});queueMicrotask(XZ);const JZ=YO({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.3.3/",hydratedAttribute:"calcite-hydrated"}),{customElement:lr,getAssetPath:KO,setAssetPath:xpe}=JZ;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function KZ(t){return t.map(e=>{let i="";for(let r=0;r<e;r++)i+=((1+Math.random())*65536|0).toString(16).substring(1);return i}).join("-")}const Hu=()=>KZ([2,1,1,1,3]),QO=t=>(...e)=>{const i=MO(),r=new t(...e),o=r.exports;PO(i.at(-1));const h=r.component.manager;h.W(r,o),r.watchExports(h.W.bind(h,r)),VH(r);const d=[r.component,...i].reverse();return u$(d,a=>a===void 0?void 0:QZ(r,a,o),o)},QZ=(t,{host:e,key:i,isReactive:r},o)=>{const h=e,d=h[i]!==t.exports,a=h[i]!==o,v=o!==t.exports;if(d&&!a&&v&&(h[i]=t.exports),e===t.component){if(r){const k=t.component.manager;a&&k.W(t,h[i]),t.onUpdate(L=>{if(L.has(i)){const O=h[i];O!==t.exports&&k.W(t,O)}})}t.O=r?void 0:i}const E=t.component.constructor.elementProperties.get(i)?.readOnly;t.watchExports(()=>{h[i]!==t.exports&&(E?ZH(()=>{h[i]=t.exports}):h[i]=t.exports)})},eR=(...t)=>{const e=[];for(let r=0;r<t.length;r++){const o=t[r];if(typeof o=="string")e.push(o);else if(Array.isArray(o))e.push.apply(e,o);else if(typeof o=="object")for(const h in o)o[h]&&e.push(h)}const i=e.join(" ");return e.length=0,i},eW=(t,e)=>{let i=t;for(;i;){if(i===e)return!0;if(!i.parentNode)return!1;i.parentNode instanceof ShadowRoot?i=i.parentNode.host:i=i.parentNode}return!1},tW=(t,e,i)=>{const r=iW(e).subscribe;return r(o=>{o.some(d=>eW(t,d.target))&&i()})},$S={},iW=t=>{const e=t.join(","),i=$S[e];if(i!==void 0)return i;const r=new Set,o=new MutationObserver(d=>r.forEach(a=>a(d)));globalThis.document&&o.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const h={subscribe:d=>(r.add(d),()=>{r.delete(d),r.size===0&&(o.disconnect(),$S[e]=void 0)})};return $S[e]=h,h},tR=(t,e)=>{let i=t;for(;i;){const r=i.closest?.(e);if(r)return r;const o=i.getRootNode?.();if(o===globalThis.document)return;i=o.host}};function wpe(t){const e=tR(t,".calcite-mode-dark, .calcite-mode-light, .calcite-mode-auto");return e?.classList.contains("calcite-mode-dark")||e?.classList.contains("calcite-mode-auto")&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const rW=(t,e,i)=>tR(t,`[${e}]`)?.getAttribute(e)??i,nW="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),sW=new Set(nW),Sx="en",oW={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},aW=async(t,e,i="")=>{const r=`${e}/${i}`,o=`${r}${t}.json`;return PS[o]??(PS[o]=iR(t,r)),await PS[o]},PS={},iR=async(t,e)=>{const i=`${e}${t}.json`;try{const r=await fetch(i);if(r.ok)return await r.json()}catch(r){return console.error(r),{}}return t===Sx?{}:await iR(Sx,e)},rR=t=>{const e=rW(t,"lang",globalThis.navigator?.language||Sx);return{lang:e,t9nLocale:nR(e)}},nR=t=>{const[e,i]=t.split("-"),r=e.toLowerCase();let o=r;return i&&(o=`${r}-${i.toUpperCase()}`),o=oW[o]??o,sW.has(o)?o:i?nR(r):Sx},lW=(t,e,i,r)=>{let o;const h=()=>cW(t,e(),r).then(d=>{(o?.lang!==d.lang||o.t9nLocale!==d.t9nLocale||o.t9nStrings!==d.t9nStrings)&&i(d),o=d}).catch(console.error);return queueMicrotask(h),tW(t,["lang"],h)},cW=async(t,e,i=t.localName.split("-").slice(1).join("-"))=>{const{lang:r,t9nLocale:o}=rR(t),h=`${e}/${i}/t9n`,a=i===null?{}:await aW(o,h,"messages.");return{lang:r,t9nLocale:o,t9nStrings:a}},uW=t=>sR(void 0,t),g$=t=>e=>sR(e,t);class hW extends d${constructor(e,i){super(e);const r=this.exports;try{ff(this.component);const o=i(this.component,this),h=this.exports!==r;if(UH(o)){h||this.setProvisionalExports(o);const d=o.then(a=>{this.exports=a,super.catchUpLifecycle()}).catch(a=>{this.P.reject(a),console.error(a)});this.onLoad(async()=>await d)}else(!h||o!==void 0)&&(this.exports=o),queueMicrotask(()=>super.catchUpLifecycle())}catch(o){this.P.reject(o),console.error(o)}}catchUpLifecycle(){}}const sR=QO(hW),y$=(t,e)=>new dW(t,e);class dW extends d${#e;#t;#i;constructor(e,i){super(),this.#t=e,this.#i=i,this.#e=new MutationObserver(r=>{r.forEach(o=>{e.includes(o.attributeName)&&i.call(this.component,this.component.el.getAttribute(o.attributeName),o.oldValue,o.attributeName)})})}hostConnected(){this.#t.forEach(e=>{this.component.el.hasAttribute(e)&&this.#i.call(this.component,null,this.component.el.getAttribute(e),e)}),this.#e.observe(this.component.el,{attributes:!0,attributeOldValue:!0,attributeFilter:this.#t})}hostDisconnected(){this.#e.disconnect()}}const oR=t=>(e={})=>uW((i,r)=>{const o=rR(i.el),h={_lang:o.lang,_t9nLocale:o.t9nLocale,_loading:!0},d=i;r.onLifecycle(()=>lW(i.el,()=>t("./assets"),({t9nLocale:v,t9nStrings:T,lang:E})=>{const k={...T,_lang:E,_t9nLocale:v,_loading:!1};r.exports=k;const L=T.componentLabel;typeof L=="string"&&"label"in i&&i.label==null&&(i.label??=L),a(d.messageOverrides)},e.name));const a=v=>{const T=r.exports,E=T._original??T,k=aR(E,v);v&&(k._original=E),r.exports=k};return"messageOverrides"in d&&r.onUpdate(v=>{v.has("messageOverrides")&&a(d.messageOverrides)}),e.blocking?(r.setProvisionalExports(h,!1),r.ready):h}),aR=(t,e)=>{if(!e)return t;const i={...t};return Object.entries(e).forEach(([r,o])=>{typeof o=="object"?i[r]=aR(t[r],o):i[r]=o??t[r]}),i},pW=t=>mW,fW="arcgisPropertyChange",mW=(...t)=>{const e=xm(),i=h$(fW,void 0,e);let r=!0;return e.manager.onUpdated(o=>{if(r||!e.el.isConnected){r=!1;return}for(const h of t)o.has(h)&&i.emit({name:h})}),i};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const go=oR(KO);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Fp={percentage:"percentage",progressRing:"ring--progress",ring:"ring",rings:"rings",text:"text",trackRing:"ring--track"},gW=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{position:relative;margin-inline:auto;display:flex;align-items:center;justify-content:center;opacity:1;flex-direction:column;min-block-size:var(--calcite-loader-size);font-size:var(--calcite-loader-font-size);stroke-width:var(--calcite-internal-stroke-width);fill:none;transform:scale(1);padding-block:var(--calcite-loader-spacing, 4rem)}:host([scale=s]){--calcite-internal-stroke-width: 3;--calcite-internal-text-offset: var(--calcite-spacing-xxs);--calcite-internal-loader-font-size: var(--calcite-font-size--3);--calcite-internal-loader-size: 2rem;--calcite-internal-loader-size-inline: .75rem;--calcite-internal-loader-value-line-height: .625rem}:host([scale=m]){--calcite-internal-stroke-width: 6;--calcite-internal-text-offset: var(--calcite-spacing-sm);--calcite-internal-loader-font-size: var(--calcite-font-size-0);--calcite-internal-loader-size: 4rem;--calcite-internal-loader-size-inline: 1rem;--calcite-internal-loader-value-line-height: 1.375rem}:host([scale=l]){--calcite-internal-stroke-width: 8;--calcite-internal-text-offset: var(--calcite-spacing-md);--calcite-internal-loader-font-size: var(--calcite-font-size-2);--calcite-internal-loader-size: 6rem;--calcite-internal-loader-size-inline: 1.5rem;--calcite-internal-loader-value-line-height: 1.71875rem}.text{display:block;text-align:center;font-size:var(--calcite-font-size--2);line-height:1rem;margin-block-start:var(--calcite-loader-text-spacing, var(--calcite-internal-text-offset));font-weight:var(--calcite-loader-text-weight, var(--calcite-font-weight-normal));color:var(--calcite-loader-text-color, var(--calcite-color-text-1))}.percentage{display:block;text-align:center;font-size:var(--calcite-loader-font-size);inline-size:var(--calcite-loader-size, var(--calcite-internal-loader-size));line-height:var(--calcite-internal-loader-value-line-height);align-self:center;color:var(--calcite-loader-text-color, var(--calcite-color-text-1))}.rings{position:relative;display:flex;overflow:visible;opacity:1;inline-size:var(--calcite-loader-size, var(--calcite-internal-loader-size));block-size:var(--calcite-loader-size, var(--calcite-internal-loader-size))}.ring{position:absolute;inset-block-start:0px;transform-origin:center;overflow:visible;inset-inline-start:0;inline-size:var(--calcite-loader-size, var(--calcite-internal-loader-size));block-size:var(--calcite-loader-size, var(--calcite-internal-loader-size))}.ring--track{stroke:var(--calcite-loader-track-color, var(--calcite-color-transparent-press))}.ring--progress{stroke:var(--calcite-loader-progress-color, var(--calcite-color-brand));transform:rotate(-90deg);transition:all var(--calcite-internal-animation-timing-fast) linear}:host([type=indeterminate]) .ring--progress{animation:loader-clockwise calc(var(--calcite-internal-animation-timing-slow) / var(--calcite-internal-duration-factor) * 2 / var(--calcite-internal-duration-factor)) linear infinite}:host([inline]){--calcite-internal-stroke-width: 2;position:relative;margin:0;stroke:currentColor;stroke-width:2;padding-block:0px;block-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));min-block-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));inline-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));vertical-align:calc(var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline))) * -1 * .2)}:host([inline]) .rings{inset-block-start:0px;margin:0;inset-inline-start:0;inline-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));block-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)))}:host([inline]) .ring{inline-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)));block-size:var(--calcite-loader-size, var(--calcite-loader-size-inline, var(--calcite-internal-loader-size-inline)))}:host([inline]) .ring--progress{stroke:var(--calcite-loader-progress-color-inline, currentColor)}:host([complete]){opacity:0;transform:scale(.75);transform-origin:center;transition:opacity var(--calcite-internal-animation-timing-medium) linear 1s,transform var(--calcite-internal-animation-timing-medium) linear 1s}:host([complete]) .rings{opacity:0;transform:scale(.75);transform-origin:center;transition:opacity calc(.18s * var(--calcite-internal-duration-factor)) linear .8s,transform calc(.18s * var(--calcite-internal-duration-factor)) linear .8s}:host([complete]) .percentage{color:var(--calcite-color-brand);transform:scale(1.05);transform-origin:center;transition:color var(--calcite-internal-animation-timing-medium) linear,transform var(--calcite-internal-animation-timing-medium) linear}@keyframes loader-clockwise{0%{transform:rotate(0)}to{transform:rotate(360deg)}}:host([hidden]){display:none}[hidden]{display:none}`,S1=class S1 extends Vi{constructor(){super(...arguments),this.messages=go({name:null}),this.complete=!1,this.inline=!1,this.scale="m",this.text="",this.type="indeterminate",this.value=0}connectedCallback(){super.connectedCallback(),this.updateFormatter()}load(){requestAnimationFrame(()=>this.valueChangeHandler())}willUpdate(e){e.has("value")&&(this.hasUpdated||this.value!==0)&&this.valueChangeHandler(),(e.has("type")&&(this.hasUpdated||this.type!=="indeterminate")||e.has("messages"))&&this.updateFormatter()}valueChangeHandler(){this.complete=this.type.startsWith("determinate")&&this.value===100}formatValue(){return this.type!=="determinate-value"?`${this.value}`:this.formatter.format(this.value/100)}getSize(e){return{s:32,m:64,l:96}[e]}getInlineSize(e){return{s:12,m:16,l:24}[e]}updateFormatter(){this.type!=="determinate-value"||this.formatter?.resolvedOptions().locale===this.messages._lang||(this.formatter=new Intl.NumberFormat(this.messages._lang,{style:"percent"}))}render(){const{el:e,inline:i,label:r,text:o,type:h,value:d}=this,a=e.id||Hu(),v=h!=="indeterminate",T=Math.floor(d);return this.el.ariaLabel=r,this.el.ariaValueMax=v?"100":void 0,this.el.ariaValueMin=v?"0":void 0,this.el.ariaValueNow=v?T.toString():void 0,Q1(this.el,"id",a),this.el.role="progressbar",Fe`<div class=${Le(Fp.rings)}>${this.renderRing("track")}${this.renderRing("progress")}${!i&&v&&Fe`<div class=${Le(Fp.percentage)}>${this.formatValue()}</div>`||""}</div>${!i&&o&&Fe`<div class=${Le(Fp.text)}>${o}</div>`||""}`}renderRing(e){const{inline:i,scale:r,value:o}=this,h=i?this.getInlineSize(r):this.getSize(r),a=h*.45;let v;if(e==="progress"){const T=2*a*Math.PI,E=(this.type.startsWith("determinate")?o:24)/100*T,k=T-E;v={"stroke-dasharray":`${E} ${k}`}}return Fe`<svg aria-hidden=true class=${Le({[Fp.ring]:!0,[Fp.trackRing]:e==="track",[Fp.progressRing]:e==="progress"})} style=${XO(v)} viewBox=${`0 0 ${h} ${h}`}>${f0`<circle cx=${h/2} cy=${h/2} r=${a??ut} />`}</svg>`}};S1.properties={complete:[7,{},{reflect:!0,type:Boolean}],inline:[7,{},{reflect:!0,type:Boolean}],label:1,scale:[3,{},{reflect:!0}],text:1,type:[3,{},{reflect:!0}],value:[9,{},{type:Number}]},S1.styles=gW;let nC=S1;lr("calcite-loader",nC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function Ho(t,e,i){const r=yW(t);return new r(e,i)}function yW(t){class e extends window.MutationObserver{constructor(r){super(r),this.observedEntry=[],this.callback=r}observe(r,o){return this.observedEntry.push({target:r,options:o}),super.observe(r,o)}unobserve(r){const o=this.observedEntry.filter(h=>h.target!==r);this.observedEntry=[],this.callback(super.takeRecords(),this),this.disconnect(),o.forEach(h=>this.observe(h.target,h.options))}}return(function(){return t==="intersection"?window.IntersectionObserver:t==="mutation"?e:window.ResizeObserver})()}function Tx(t,e,i,r){if(t&&(e&&t.unobserve(e),!!i)){if(t instanceof MutationObserver){t.observe(i,r);return}t.observe(i)}}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 *//*!
* tabbable 6.2.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var vW=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],sC=vW.join(","),lR=typeof Element>"u",g0=lR?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Cx=!lR&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t?.ownerDocument},Ex=function t(e,i){var r;i===void 0&&(i=!0);var o=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"inert"),h=o===""||o==="true",d=h||i&&e&&t(e.parentNode);return d},_W=function(e){var i,r=e==null||(i=e.getAttribute)===null||i===void 0?void 0:i.call(e,"contenteditable");return r===""||r==="true"},cR=function(e,i,r){if(Ex(e))return[];var o=Array.prototype.slice.apply(e.querySelectorAll(sC));return i&&g0.call(e,sC)&&o.unshift(e),o=o.filter(r),o},uR=function t(e,i,r){for(var o=[],h=Array.from(e);h.length;){var d=h.shift();if(!Ex(d,!1))if(d.tagName==="SLOT"){var a=d.assignedElements(),v=a.length?a:d.children,T=t(v,!0,r);r.flatten?o.push.apply(o,T):o.push({scopeParent:d,candidates:T})}else{var E=g0.call(d,sC);E&&r.filter(d)&&(i||!e.includes(d))&&o.push(d);var k=d.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(d),L=!Ex(k,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(d));if(k&&L){var O=t(k===!0?d.children:k.children,!0,r);r.flatten?o.push.apply(o,O):o.push({scopeParent:d,candidates:O})}else h.unshift.apply(h,d.children)}}return o},hR=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},dR=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||_W(e))&&!hR(e)?0:e.tabIndex},bW=function(e,i){var r=dR(e);return r<0&&i&&!hR(e)?0:r},xW=function(e,i){return e.tabIndex===i.tabIndex?e.documentOrder-i.documentOrder:e.tabIndex-i.tabIndex},pR=function(e){return e.tagName==="INPUT"},wW=function(e){return pR(e)&&e.type==="hidden"},SW=function(e){var i=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(r){return r.tagName==="SUMMARY"});return i},TW=function(e,i){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===i)return e[r]},CW=function(e){if(!e.name)return!0;var i=e.form||Cx(e),r=function(a){return i.querySelectorAll('input[type="radio"][name="'+a+'"]')},o;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")o=r(window.CSS.escape(e.name));else try{o=r(e.name)}catch(d){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",d.message),!1}var h=TW(o,e.form);return!h||h===e},EW=function(e){return pR(e)&&e.type==="radio"},IW=function(e){return EW(e)&&!CW(e)},$W=function(e){var i,r=e&&Cx(e),o=(i=r)===null||i===void 0?void 0:i.host,h=!1;if(r&&r!==e){var d,a,v;for(h=!!((d=o)!==null&&d!==void 0&&(a=d.ownerDocument)!==null&&a!==void 0&&a.contains(o)||e!=null&&(v=e.ownerDocument)!==null&&v!==void 0&&v.contains(e));!h&&o;){var T,E,k;r=Cx(o),o=(T=r)===null||T===void 0?void 0:T.host,h=!!((E=o)!==null&&E!==void 0&&(k=E.ownerDocument)!==null&&k!==void 0&&k.contains(o))}}return h},Z3=function(e){var i=e.getBoundingClientRect(),r=i.width,o=i.height;return r===0&&o===0},PW=function(e,i){var r=i.displayCheck,o=i.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var h=g0.call(e,"details>summary:first-of-type"),d=h?e.parentElement:e;if(g0.call(d,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="legacy-full"){if(typeof o=="function"){for(var a=e;e;){var v=e.parentElement,T=Cx(e);if(v&&!v.shadowRoot&&o(v)===!0)return Z3(e);e.assignedSlot?e=e.assignedSlot:!v&&T!==e.ownerDocument?e=T.host:e=v}e=a}if($W(e))return!e.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return Z3(e);return!1},MW=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var i=e.parentElement;i;){if(i.tagName==="FIELDSET"&&i.disabled){for(var r=0;r<i.children.length;r++){var o=i.children.item(r);if(o.tagName==="LEGEND")return g0.call(i,"fieldset[disabled] *")?!0:!o.contains(e)}return!0}i=i.parentElement}return!1},oC=function(e,i){return!(i.disabled||Ex(i)||wW(i)||PW(i,e)||SW(i)||MW(i))},W3=function(e,i){return!(IW(i)||dR(i)<0||!oC(e,i))},kW=function(e){var i=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(i)||i>=0)},AW=function t(e){var i=[],r=[];return e.forEach(function(o,h){var d=!!o.scopeParent,a=d?o.scopeParent:o,v=bW(a,d),T=d?t(o.candidates):a;v===0?d?i.push.apply(i,T):i.push(a):r.push({documentOrder:h,tabIndex:v,item:o,isScope:d,content:T})}),r.sort(xW).reduce(function(o,h){return h.isScope?o.push.apply(o,h.content):o.push(h.content),o},[]).concat(i)},DW=function(e,i){i=i||{};var r;return i.getShadowRoot?r=uR([e],i.includeContainer,{filter:W3.bind(null,i),flatten:!1,getShadowRoot:i.getShadowRoot,shadowRootFilter:kW}):r=cR(e,i.includeContainer,W3.bind(null,i)),AW(r)},zW=function(e,i){i=i||{};var r;return i.getShadowRoot?r=uR([e],i.includeContainer,{filter:oC.bind(null,i),flatten:!0,getShadowRoot:i.getShadowRoot}):r=cR(e,i.includeContainer,oC.bind(null,i)),r};const v$={getShadowRoot:!0};function J0(t){const r=Tm(t,"[dir]");return r?r.getAttribute("dir"):"ltr"}function ew(t){return t.getRootNode()}function fR(t){return t.host||null}function tw(t,{selector:e,id:i}){if(!t)return null;t.assignedSlot&&(t=t.assignedSlot);const r=ew(t);return(i?"getElementById"in r?r.getElementById(i):null:e?r.querySelector(e):null)||tw(fR(r),{selector:e,id:i})}function Tm(t,e){return t?t.closest(e)||Tm(fR(ew(t)),e):null}function OW(t){return typeof t?.setFocus=="function"}async function y0(t,e=!1,i="tabbable",r,o){return t?OW(t)&&r!==t?t.setFocus(o):(i==="tabbable"?RW:FW)(t,e,o):void 0}function mR(t,e){if(t)return DW(t,{...v$,includeContainer:e})[0]??t}function RW(t,e,i){mR(t,e)?.focus(i)}function LW(t,e){if(t)return zW(t,{...v$,includeContainer:e})[0]??t}function FW(t,e,i){LW(t,e)?.focus(i)}function NW(t,e){return t.filter(i=>i.matches(e))}function tm(t,e,i){if(typeof e=="string"&&e!=="")return e;if(e===""||e===!0)return t[i]}function iw(t){return(!!t).toString()}function BW(t){return $r(t)||VW(t)}function jW(t){return GW(t).filter(e=>e.nodeType===Node.TEXT_NODE).map(e=>e.textContent).join("").trim()}function UW(t){for(const e of t.childNodes)if(e.nodeType===Node.TEXT_NODE&&e.textContent?.trim()!==""||e.nodeType===Node.ELEMENT_NODE)return!0;return!1}function VW(t){return!!jW(t)}function GW(t){return t.currentTarget.assignedNodes({flatten:!0})}function $r(t){return!!gR(t).length}function gR(t,e){return qW(t.currentTarget,e)}function qW(t,e){const i=t.assignedElements({flatten:!0});return e?NW(i,e):i}function yR(t){return!!(t.isPrimary&&t.button===0)}function HW(t){return t.detail===0}const z_=(t,e,i,r=!0,o=!0,h=!1)=>{const d=t.indexOf(e),a=d===0,v=d===t.length-1;r&&(i=i==="previous"&&a?"last":i==="next"&&v?"first":i);let T;return i==="previous"?T=t[d-1]||t[r?t.length-1:d]:i==="next"?T=t[d+1]||t[r?0:d]:i==="last"?T=t[t.length-1]:T=t[0],y0(T,o,"tabbable",h?T:void 0),T};function ZW(t,e){if(t.parentNode!==e.parentNode)return!1;const i=Array.from(t.parentNode.children);return i.indexOf(t)<i.indexOf(e)}async function WW(t,e){return YW(t,e,"transition")}function Y3(t,e,i){const r="transitionProperty";return t.getAnimations().find(o=>o[r]===i)}async function YW(t,e,i){let r=Y3(t,i,e);if(r||(await aC(),r=Y3(t,i,e)),!!r)try{await r.finished}catch{}}async function aC(){await new Promise(t=>requestAnimationFrame(()=>t()))}function Spe(t){return t.endsWith("px")?parseFloat(t):t.endsWith("vw")?X3(parseFloat(t),window.innerWidth):t.endsWith("vh")?X3(parseFloat(t),window.innerHeight):0}function X3(t,e){return t*e/100}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const J3={scrim:"scrim",content:"content"},K3={s:72,l:480},XW=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{position:absolute;inset:0;z-index:var(--calcite-z-index-overlay);display:flex;block-size:100%;inline-size:100%;flex-direction:column;align-items:stretch}@keyframes calcite-scrim-fade-in{0%{--tw-bg-opacity: 0}to{--tw-text-opacity: 1}}.scrim{position:absolute;inset:0;display:flex;flex-direction:column;align-content:center;align-items:center;justify-content:center;overflow:hidden;animation:calcite-scrim-fade-in var(--calcite-internal-animation-timing-medium) ease-in-out;background-color:var(--calcite-scrim-background, var(--calcite-color-transparent-scrim))}.content{padding:1rem}:host([hidden]){display:none}[hidden]{display:none}`,T1=class T1 extends Vi{constructor(){super(...arguments),this.loaderRef=Xn(),this.resizeObserver=Ho("resize",()=>this.handleResize()),this.messages=go(),this.hasContent=!1,this.loading=!1}connectedCallback(){super.connectedCallback(),this.resizeObserver?.observe(this.el)}disconnectedCallback(){super.disconnectedCallback(),this.resizeObserver?.disconnect()}handleDefaultSlotChange(e){this.hasContent=BW(e)}getScale(e){return e<K3.s?"s":e>=K3.l?"l":"m"}handleResize(){const{el:e}=this;this.loaderScale=this.getScale(Math.min(e.clientHeight,e.clientWidth)??0)}render(){const{hasContent:e,loading:i,loaderScale:r,messages:o}=this;return Fe`<div class=${Le(J3.scrim)}>${i&&r?Fe`<calcite-loader .label=${o.loading} .scale=${r} ${hi(this.loaderRef)}></calcite-loader>`:null}<div class=${Le(J3.content)} .hidden=${!e}><slot @slotchange=${this.handleDefaultSlotChange}></slot></div></div>`}};T1.properties={hasContent:[16,{},{state:!0}],loaderScale:[16,{},{state:!0}],loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}]},T1.styles=XW;let lC=T1;lr("calcite-scrim",lC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Q3=new Set,eA={trace:0,debug:1,info:2,warn:4,error:8,off:10};function JW(t){return eA[t]>=eA[ZZ]}function tf(t,...e){if(!JW(t))return;console[t].call(this,"%ccalcite","background: #007AC2; color: #fff; border-radius: 4px; padding: 2px 4px;",...e)}let MS;const Ix={debug:t=>tf("debug",t),info:t=>tf("info",t),warn:t=>tf("warn",t),error:t=>tf("error",t),trace:t=>tf("trace",t),deprecated:KW};function KW(t,{component:e,name:i,suggested:r,removalVersion:o}){const h=`${t}:${t==="component"?"":e}${i}`;if(Q3.has(h))return;Q3.add(h);const d=Array.isArray(r);d&&!MS&&(MS=new Intl.ListFormat("en",{style:"long",type:"disjunction"}));const a=`[${i}] ${t} is deprecated and will be removed in ${o==="future"?"a future version":`v${o}`}.${r?` Use ${d?MS.format(r.map(v=>`"${v}"`)):`"${r}"`} instead.`:""}`;tf("warn",a)}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const tA={flipRtl:"flip-rtl",svg:"svg"},vR={},kS={},_R={s:16,m:24,l:32};function bR({icon:t,scale:e}){const i=_R[e],r=tY(t),o=r.charAt(r.length-1)==="F";return`${o?r.substring(0,r.length-1):r}${i}${o?"F":""}`}async function QW(t){const e=bR(t),i=xR(e);if(i)return i;kS[e]||(kS[e]=fetch(KO(`./assets/icon/${e}.json`)).then(o=>o.json()).catch(()=>(Ix.error(`${t.icon} (${t.scale}) icon failed to load`),"")));const r=await kS[e];return vR[e]=r,r}function eY(t){return xR(bR(t))}function xR(t){return vR[t]}function tY(t){const e=!isNaN(Number(t.charAt(0))),i=t.split("-");if(i.length>0){const o=/[a-z]/i;t=i.map((h,d)=>h.replace(o,function(v,T){return d===0&&T===0?v:v.toUpperCase()})).join("")}return e?`i${t}`:t}const iY=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{display:inline-flex;color:var(--calcite-icon-color, var(--calcite-ui-icon-color, currentColor))}:host([scale=s]){inline-size:16px;block-size:16px;min-inline-size:16px;min-block-size:16px}:host([scale=m]){inline-size:24px;block-size:24px;min-inline-size:24px;min-block-size:24px}:host([scale=l]){inline-size:32px;block-size:32px;min-inline-size:32px;min-block-size:32px}.flip-rtl{transform:scaleX(-1)}.svg{display:block}:host([hidden]){display:none}[hidden]{display:none}`,C1=class C1 extends Vi{constructor(){super(...arguments),this.visible=!1,this.flipRtl=!1,this.icon=null,this.preload=!1,this.scale="m"}connectedCallback(){if(super.connectedCallback(),this.preload){this.visible=!0,this.loadIconPathData();return}this.visible||this.waitUntilVisible(()=>{this.visible=!0,this.loadIconPathData()})}willUpdate(e){(e.has("icon")&&(this.hasUpdated||this.icon!==null)||e.has("scale")&&(this.hasUpdated||this.scale!=="m"))&&this.loadIconPathData()}disconnectedCallback(){super.disconnectedCallback(),this.intersectionObserver?.disconnect(),this.intersectionObserver=null}async loadIconPathData(){const{icon:e,scale:i,visible:r}=this;if(!e||!r)return;const o={icon:e,scale:i},h=eY(o)||await QW(o);e===this.icon&&(this.pathData=h)}waitUntilVisible(e){if(this.intersectionObserver=Ho("intersection",i=>{i.forEach(r=>{r.isIntersecting&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,e())})},{rootMargin:"50px"}),!this.intersectionObserver){e();return}this.intersectionObserver.observe(this.el)}render(){const{el:e,flipRtl:i,pathData:r,scale:o,textLabel:h}=this,d=J0(e),a=_R[o],v=!!h,T=[].concat(r||"");return this.el.ariaHidden=iw(!v),this.el.ariaLabel=v?h:null,this.el.role=v?"img":null,Fe`<svg aria-hidden=true class=${Le({[tA.flipRtl]:d==="rtl"&&i,[tA.svg]:!0})} fill=currentColor height=100% viewBox=${`0 0 ${a} ${a}`} width=100% xmlns=http://www.w3.org/2000/svg>${T.map(E=>typeof E=="string"?f0`<path d=${E??ut} />`:f0`<path d=${E.d??ut} opacity=${("opacity"in E?E.opacity:1)??ut} />`)}</svg>`}};C1.properties={pathData:[16,{},{state:!0}],visible:[16,{},{state:!0}],flipRtl:[7,{},{reflect:!0,type:Boolean}],icon:[3,{},{reflect:!0}],preload:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],textLabel:1},C1.styles=iY;let cC=C1;lr("calcite-icon",cC);const wR=["top","right","bottom","left"],iA=["start","end"],rA=wR.reduce((t,e)=>t.concat(e,e+"-"+iA[0],e+"-"+iA[1]),[]),im=Math.min,ld=Math.max,$x=Math.round,O_=Math.floor,ml=t=>({x:t,y:t}),rY={left:"right",right:"left",bottom:"top",top:"bottom"},nY={start:"end",end:"start"};function uC(t,e,i){return ld(t,im(e,i))}function Dd(t,e){return typeof t=="function"?t(e):t}function vc(t){return t.split("-")[0]}function gl(t){return t.split("-")[1]}function SR(t){return t==="x"?"y":"x"}function _$(t){return t==="y"?"height":"width"}const sY=new Set(["top","bottom"]);function $u(t){return sY.has(vc(t))?"y":"x"}function b$(t){return SR($u(t))}function TR(t,e,i){i===void 0&&(i=!1);const r=gl(t),o=b$(t),h=_$(o);let d=o==="x"?r===(i?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[h]>e.floating[h]&&(d=Mx(d)),[d,Mx(d)]}function oY(t){const e=Mx(t);return[Px(t),e,Px(e)]}function Px(t){return t.replace(/start|end/g,e=>nY[e])}const nA=["left","right"],sA=["right","left"],aY=["top","bottom"],lY=["bottom","top"];function cY(t,e,i){switch(t){case"top":case"bottom":return i?e?sA:nA:e?nA:sA;case"left":case"right":return e?aY:lY;default:return[]}}function uY(t,e,i,r){const o=gl(t);let h=cY(vc(t),i==="start",r);return o&&(h=h.map(d=>d+"-"+o),e&&(h=h.concat(h.map(Px)))),h}function Mx(t){return t.replace(/left|right|bottom|top/g,e=>rY[e])}function hY(t){return{top:0,right:0,bottom:0,left:0,...t}}function CR(t){return typeof t!="number"?hY(t):{top:t,right:t,bottom:t,left:t}}function kx(t){const{x:e,y:i,width:r,height:o}=t;return{width:r,height:o,top:i,left:e,right:e+r,bottom:i+o,x:e,y:i}}function oA(t,e,i){let{reference:r,floating:o}=t;const h=$u(e),d=b$(e),a=_$(d),v=vc(e),T=h==="y",E=r.x+r.width/2-o.width/2,k=r.y+r.height/2-o.height/2,L=r[a]/2-o[a]/2;let O;switch(v){case"top":O={x:E,y:r.y-o.height};break;case"bottom":O={x:E,y:r.y+r.height};break;case"right":O={x:r.x+r.width,y:k};break;case"left":O={x:r.x-o.width,y:k};break;default:O={x:r.x,y:r.y}}switch(gl(e)){case"start":O[d]-=L*(i&&T?-1:1);break;case"end":O[d]+=L*(i&&T?-1:1);break}return O}const dY=async(t,e,i)=>{const{placement:r="bottom",strategy:o="absolute",middleware:h=[],platform:d}=i,a=h.filter(Boolean),v=await(d.isRTL==null?void 0:d.isRTL(e));let T=await d.getElementRects({reference:t,floating:e,strategy:o}),{x:E,y:k}=oA(T,r,v),L=r,O={},H=0;for(let ie=0;ie<a.length;ie++){const{name:pe,fn:be}=a[ie],{x:Ce,y:Pe,data:Ie,reset:ke}=await be({x:E,y:k,initialPlacement:r,placement:L,strategy:o,middlewareData:O,rects:T,platform:d,elements:{reference:t,floating:e}});E=Ce??E,k=Pe??k,O={...O,[pe]:{...O[pe],...Ie}},ke&&H<=50&&(H++,typeof ke=="object"&&(ke.placement&&(L=ke.placement),ke.rects&&(T=ke.rects===!0?await d.getElementRects({reference:t,floating:e,strategy:o}):ke.rects),{x:E,y:k}=oA(T,L,v)),ie=-1)}return{x:E,y:k,placement:L,strategy:o,middlewareData:O}};async function v0(t,e){var i;e===void 0&&(e={});const{x:r,y:o,platform:h,rects:d,elements:a,strategy:v}=t,{boundary:T="clippingAncestors",rootBoundary:E="viewport",elementContext:k="floating",altBoundary:L=!1,padding:O=0}=Dd(e,t),H=CR(O),pe=a[L?k==="floating"?"reference":"floating":k],be=kx(await h.getClippingRect({element:(i=await(h.isElement==null?void 0:h.isElement(pe)))==null||i?pe:pe.contextElement||await(h.getDocumentElement==null?void 0:h.getDocumentElement(a.floating)),boundary:T,rootBoundary:E,strategy:v})),Ce=k==="floating"?{x:r,y:o,width:d.floating.width,height:d.floating.height}:d.reference,Pe=await(h.getOffsetParent==null?void 0:h.getOffsetParent(a.floating)),Ie=await(h.isElement==null?void 0:h.isElement(Pe))?await(h.getScale==null?void 0:h.getScale(Pe))||{x:1,y:1}:{x:1,y:1},ke=kx(h.convertOffsetParentRelativeRectToViewportRelativeRect?await h.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:Ce,offsetParent:Pe,strategy:v}):Ce);return{top:(be.top-ke.top+H.top)/Ie.y,bottom:(ke.bottom-be.bottom+H.bottom)/Ie.y,left:(be.left-ke.left+H.left)/Ie.x,right:(ke.right-be.right+H.right)/Ie.x}}const pY=t=>({name:"arrow",options:t,async fn(e){const{x:i,y:r,placement:o,rects:h,platform:d,elements:a,middlewareData:v}=e,{element:T,padding:E=0}=Dd(t,e)||{};if(T==null)return{};const k=CR(E),L={x:i,y:r},O=b$(o),H=_$(O),ie=await d.getDimensions(T),pe=O==="y",be=pe?"top":"left",Ce=pe?"bottom":"right",Pe=pe?"clientHeight":"clientWidth",Ie=h.reference[H]+h.reference[O]-L[O]-h.floating[H],ke=L[O]-h.reference[O],Ke=await(d.getOffsetParent==null?void 0:d.getOffsetParent(T));let qe=Ke?Ke[Pe]:0;(!qe||!await(d.isElement==null?void 0:d.isElement(Ke)))&&(qe=a.floating[Pe]||h.floating[H]);const dt=Ie/2-ke/2,ft=qe/2-ie[H]/2-1,et=im(k[be],ft),We=im(k[Ce],ft),Be=et,ge=qe-ie[H]-We,De=qe/2-ie[H]/2+dt,Je=uC(Be,De,ge),Qe=!v.arrow&&gl(o)!=null&&De!==Je&&h.reference[H]/2-(De<Be?et:We)-ie[H]/2<0,yt=Qe?De<Be?De-Be:De-ge:0;return{[O]:L[O]+yt,data:{[O]:Je,centerOffset:De-Je-yt,...Qe&&{alignmentOffset:yt}},reset:Qe}}});function fY(t,e,i){return(t?[...i.filter(o=>gl(o)===t),...i.filter(o=>gl(o)!==t)]:i.filter(o=>vc(o)===o)).filter(o=>t?gl(o)===t||(e?Px(o)!==o:!1):!0)}const mY=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var i,r,o;const{rects:h,middlewareData:d,placement:a,platform:v,elements:T}=e,{crossAxis:E=!1,alignment:k,allowedPlacements:L=rA,autoAlignment:O=!0,...H}=Dd(t,e),ie=k!==void 0||L===rA?fY(k||null,O,L):L,pe=await v0(e,H),be=((i=d.autoPlacement)==null?void 0:i.index)||0,Ce=ie[be];if(Ce==null)return{};const Pe=TR(Ce,h,await(v.isRTL==null?void 0:v.isRTL(T.floating)));if(a!==Ce)return{reset:{placement:ie[0]}};const Ie=[pe[vc(Ce)],pe[Pe[0]],pe[Pe[1]]],ke=[...((r=d.autoPlacement)==null?void 0:r.overflows)||[],{placement:Ce,overflows:Ie}],Ke=ie[be+1];if(Ke)return{data:{index:be+1,overflows:ke},reset:{placement:Ke}};const qe=ke.map(et=>{const We=gl(et.placement);return[et.placement,We&&E?et.overflows.slice(0,2).reduce((Be,ge)=>Be+ge,0):et.overflows[0],et.overflows]}).sort((et,We)=>et[1]-We[1]),ft=((o=qe.filter(et=>et[2].slice(0,gl(et[0])?2:3).every(We=>We<=0))[0])==null?void 0:o[0])||qe[0][0];return ft!==a?{data:{index:be+1,overflows:ke},reset:{placement:ft}}:{}}}},gY=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var i,r;const{placement:o,middlewareData:h,rects:d,initialPlacement:a,platform:v,elements:T}=e,{mainAxis:E=!0,crossAxis:k=!0,fallbackPlacements:L,fallbackStrategy:O="bestFit",fallbackAxisSideDirection:H="none",flipAlignment:ie=!0,...pe}=Dd(t,e);if((i=h.arrow)!=null&&i.alignmentOffset)return{};const be=vc(o),Ce=$u(a),Pe=vc(a)===a,Ie=await(v.isRTL==null?void 0:v.isRTL(T.floating)),ke=L||(Pe||!ie?[Mx(a)]:oY(a)),Ke=H!=="none";!L&&Ke&&ke.push(...uY(a,ie,H,Ie));const qe=[a,...ke],dt=await v0(e,pe),ft=[];let et=((r=h.flip)==null?void 0:r.overflows)||[];if(E&&ft.push(dt[be]),k){const De=TR(o,d,Ie);ft.push(dt[De[0]],dt[De[1]])}if(et=[...et,{placement:o,overflows:ft}],!ft.every(De=>De<=0)){var We,Be;const De=(((We=h.flip)==null?void 0:We.index)||0)+1,Je=qe[De];if(Je&&(!(k==="alignment"?Ce!==$u(Je):!1)||et.every(Et=>$u(Et.placement)===Ce?Et.overflows[0]>0:!0)))return{data:{index:De,overflows:et},reset:{placement:Je}};let Qe=(Be=et.filter(yt=>yt.overflows[0]<=0).sort((yt,Et)=>yt.overflows[1]-Et.overflows[1])[0])==null?void 0:Be.placement;if(!Qe)switch(O){case"bestFit":{var ge;const yt=(ge=et.filter(Et=>{if(Ke){const Ye=$u(Et.placement);return Ye===Ce||Ye==="y"}return!0}).map(Et=>[Et.placement,Et.overflows.filter(Ye=>Ye>0).reduce((Ye,bt)=>Ye+bt,0)]).sort((Et,Ye)=>Et[1]-Ye[1])[0])==null?void 0:ge[0];yt&&(Qe=yt);break}case"initialPlacement":Qe=a;break}if(o!==Qe)return{reset:{placement:Qe}}}return{}}}};function aA(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function lA(t){return wR.some(e=>t[e]>=0)}const yY=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:i}=e,{strategy:r="referenceHidden",...o}=Dd(t,e);switch(r){case"referenceHidden":{const h=await v0(e,{...o,elementContext:"reference"}),d=aA(h,i.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:lA(d)}}}case"escaped":{const h=await v0(e,{...o,altBoundary:!0}),d=aA(h,i.floating);return{data:{escapedOffsets:d,escaped:lA(d)}}}default:return{}}}}},vY=new Set(["left","top"]);async function _Y(t,e){const{placement:i,platform:r,elements:o}=t,h=await(r.isRTL==null?void 0:r.isRTL(o.floating)),d=vc(i),a=gl(i),v=$u(i)==="y",T=vY.has(d)?-1:1,E=h&&v?-1:1,k=Dd(e,t);let{mainAxis:L,crossAxis:O,alignmentAxis:H}=typeof k=="number"?{mainAxis:k,crossAxis:0,alignmentAxis:null}:{mainAxis:k.mainAxis||0,crossAxis:k.crossAxis||0,alignmentAxis:k.alignmentAxis};return a&&typeof H=="number"&&(O=a==="end"?H*-1:H),v?{x:O*E,y:L*T}:{x:L*T,y:O*E}}const bY=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var i,r;const{x:o,y:h,placement:d,middlewareData:a}=e,v=await _Y(e,t);return d===((i=a.offset)==null?void 0:i.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:o+v.x,y:h+v.y,data:{...v,placement:d}}}}},xY=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:i,y:r,placement:o}=e,{mainAxis:h=!0,crossAxis:d=!1,limiter:a={fn:pe=>{let{x:be,y:Ce}=pe;return{x:be,y:Ce}}},...v}=Dd(t,e),T={x:i,y:r},E=await v0(e,v),k=$u(vc(o)),L=SR(k);let O=T[L],H=T[k];if(h){const pe=L==="y"?"top":"left",be=L==="y"?"bottom":"right",Ce=O+E[pe],Pe=O-E[be];O=uC(Ce,O,Pe)}if(d){const pe=k==="y"?"top":"left",be=k==="y"?"bottom":"right",Ce=H+E[pe],Pe=H-E[be];H=uC(Ce,H,Pe)}const ie=a.fn({...e,[L]:O,[k]:H});return{...ie,data:{x:ie.x-i,y:ie.y-r,enabled:{[L]:h,[k]:d}}}}}};function rw(){return typeof window<"u"}function Cm(t){return ER(t)?(t.nodeName||"").toLowerCase():"#document"}function po(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Tl(t){var e;return(e=(ER(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function ER(t){return rw()?t instanceof Node||t instanceof po(t).Node:!1}function Ca(t){return rw()?t instanceof Element||t instanceof po(t).Element:!1}function vl(t){return rw()?t instanceof HTMLElement||t instanceof po(t).HTMLElement:!1}function cA(t){return!rw()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof po(t).ShadowRoot}const wY=new Set(["inline","contents"]);function K0(t){const{overflow:e,overflowX:i,overflowY:r,display:o}=Ea(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+i)&&!wY.has(o)}const SY=new Set(["table","td","th"]);function TY(t){return SY.has(Cm(t))}const CY=[":popover-open",":modal"];function nw(t){return CY.some(e=>{try{return t.matches(e)}catch{return!1}})}const EY=["transform","translate","scale","rotate","perspective"],IY=["transform","translate","scale","rotate","perspective","filter"],$Y=["paint","layout","strict","content"];function sw(t){const e=x$(),i=Ca(t)?Ea(t):t;return EY.some(r=>i[r]?i[r]!=="none":!1)||(i.containerType?i.containerType!=="normal":!1)||!e&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!e&&(i.filter?i.filter!=="none":!1)||IY.some(r=>(i.willChange||"").includes(r))||$Y.some(r=>(i.contain||"").includes(r))}function PY(t){let e=ju(t);for(;vl(e)&&!rm(e);){if(sw(e))return e;if(nw(e))return null;e=ju(e)}return null}function x$(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const MY=new Set(["html","body","#document"]);function rm(t){return MY.has(Cm(t))}function Ea(t){return po(t).getComputedStyle(t)}function ow(t){return Ca(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ju(t){if(Cm(t)==="html")return t;const e=t.assignedSlot||t.parentNode||cA(t)&&t.host||Tl(t);return cA(e)?e.host:e}function IR(t){const e=ju(t);return rm(e)?t.ownerDocument?t.ownerDocument.body:t.body:vl(e)&&K0(e)?e:IR(e)}function _0(t,e,i){var r;e===void 0&&(e=[]),i===void 0&&(i=!0);const o=IR(t),h=o===((r=t.ownerDocument)==null?void 0:r.body),d=po(o);if(h){const a=hC(d);return e.concat(d,d.visualViewport||[],K0(o)?o:[],a&&i?_0(a):[])}return e.concat(o,_0(o,[],i))}function hC(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function $R(t){const e=Ea(t);let i=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=vl(t),h=o?t.offsetWidth:i,d=o?t.offsetHeight:r,a=$x(i)!==h||$x(r)!==d;return a&&(i=h,r=d),{width:i,height:r,$:a}}function w$(t){return Ca(t)?t:t.contextElement}function Mf(t){const e=w$(t);if(!vl(e))return ml(1);const i=e.getBoundingClientRect(),{width:r,height:o,$:h}=$R(e);let d=(h?$x(i.width):i.width)/r,a=(h?$x(i.height):i.height)/o;return(!d||!Number.isFinite(d))&&(d=1),(!a||!Number.isFinite(a))&&(a=1),{x:d,y:a}}const kY=ml(0);function PR(t){const e=po(t);return!x$()||!e.visualViewport?kY:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function AY(t,e,i){return e===void 0&&(e=!1),!i||e&&i!==po(t)?!1:e}function bd(t,e,i,r){e===void 0&&(e=!1),i===void 0&&(i=!1);const o=t.getBoundingClientRect(),h=w$(t);let d=ml(1);e&&(r?Ca(r)&&(d=Mf(r)):d=Mf(t));const a=AY(h,i,r)?PR(h):ml(0);let v=(o.left+a.x)/d.x,T=(o.top+a.y)/d.y,E=o.width/d.x,k=o.height/d.y;if(h){const L=po(h),O=r&&Ca(r)?po(r):r;let H=L,ie=hC(H);for(;ie&&r&&O!==H;){const pe=Mf(ie),be=ie.getBoundingClientRect(),Ce=Ea(ie),Pe=be.left+(ie.clientLeft+parseFloat(Ce.paddingLeft))*pe.x,Ie=be.top+(ie.clientTop+parseFloat(Ce.paddingTop))*pe.y;v*=pe.x,T*=pe.y,E*=pe.x,k*=pe.y,v+=Pe,T+=Ie,H=po(ie),ie=hC(H)}}return kx({width:E,height:k,x:v,y:T})}function aw(t,e){const i=ow(t).scrollLeft;return e?e.left+i:bd(Tl(t)).left+i}function MR(t,e){const i=t.getBoundingClientRect(),r=i.left+e.scrollLeft-aw(t,i),o=i.top+e.scrollTop;return{x:r,y:o}}function DY(t){let{elements:e,rect:i,offsetParent:r,strategy:o}=t;const h=o==="fixed",d=Tl(r),a=e?nw(e.floating):!1;if(r===d||a&&h)return i;let v={scrollLeft:0,scrollTop:0},T=ml(1);const E=ml(0),k=vl(r);if((k||!k&&!h)&&((Cm(r)!=="body"||K0(d))&&(v=ow(r)),vl(r))){const O=bd(r);T=Mf(r),E.x=O.x+r.clientLeft,E.y=O.y+r.clientTop}const L=d&&!k&&!h?MR(d,v):ml(0);return{width:i.width*T.x,height:i.height*T.y,x:i.x*T.x-v.scrollLeft*T.x+E.x+L.x,y:i.y*T.y-v.scrollTop*T.y+E.y+L.y}}function zY(t){return Array.from(t.getClientRects())}function OY(t){const e=Tl(t),i=ow(t),r=t.ownerDocument.body,o=ld(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),h=ld(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let d=-i.scrollLeft+aw(t);const a=-i.scrollTop;return Ea(r).direction==="rtl"&&(d+=ld(e.clientWidth,r.clientWidth)-o),{width:o,height:h,x:d,y:a}}const uA=25;function RY(t,e){const i=po(t),r=Tl(t),o=i.visualViewport;let h=r.clientWidth,d=r.clientHeight,a=0,v=0;if(o){h=o.width,d=o.height;const E=x$();(!E||E&&e==="fixed")&&(a=o.offsetLeft,v=o.offsetTop)}const T=aw(r);if(T<=0){const E=r.ownerDocument,k=E.body,L=getComputedStyle(k),O=E.compatMode==="CSS1Compat"&&parseFloat(L.marginLeft)+parseFloat(L.marginRight)||0,H=Math.abs(r.clientWidth-k.clientWidth-O);H<=uA&&(h-=H)}else T<=uA&&(h+=T);return{width:h,height:d,x:a,y:v}}const LY=new Set(["absolute","fixed"]);function FY(t,e){const i=bd(t,!0,e==="fixed"),r=i.top+t.clientTop,o=i.left+t.clientLeft,h=vl(t)?Mf(t):ml(1),d=t.clientWidth*h.x,a=t.clientHeight*h.y,v=o*h.x,T=r*h.y;return{width:d,height:a,x:v,y:T}}function hA(t,e,i){let r;if(e==="viewport")r=RY(t,i);else if(e==="document")r=OY(Tl(t));else if(Ca(e))r=FY(e,i);else{const o=PR(t);r={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return kx(r)}function kR(t,e){const i=ju(t);return i===e||!Ca(i)||rm(i)?!1:Ea(i).position==="fixed"||kR(i,e)}function NY(t,e){const i=e.get(t);if(i)return i;let r=_0(t,[],!1).filter(a=>Ca(a)&&Cm(a)!=="body"),o=null;const h=Ea(t).position==="fixed";let d=h?ju(t):t;for(;Ca(d)&&!rm(d);){const a=Ea(d),v=sw(d);!v&&a.position==="fixed"&&(o=null),(h?!v&&!o:!v&&a.position==="static"&&!!o&&LY.has(o.position)||K0(d)&&!v&&kR(t,d))?r=r.filter(E=>E!==d):o=a,d=ju(d)}return e.set(t,r),r}function BY(t){let{element:e,boundary:i,rootBoundary:r,strategy:o}=t;const d=[...i==="clippingAncestors"?nw(e)?[]:NY(e,this._c):[].concat(i),r],a=d[0],v=d.reduce((T,E)=>{const k=hA(e,E,o);return T.top=ld(k.top,T.top),T.right=im(k.right,T.right),T.bottom=im(k.bottom,T.bottom),T.left=ld(k.left,T.left),T},hA(e,a,o));return{width:v.right-v.left,height:v.bottom-v.top,x:v.left,y:v.top}}function jY(t){const{width:e,height:i}=$R(t);return{width:e,height:i}}function UY(t,e,i){const r=vl(e),o=Tl(e),h=i==="fixed",d=bd(t,!0,h,e);let a={scrollLeft:0,scrollTop:0};const v=ml(0);function T(){v.x=aw(o)}if(r||!r&&!h)if((Cm(e)!=="body"||K0(o))&&(a=ow(e)),r){const O=bd(e,!0,h,e);v.x=O.x+e.clientLeft,v.y=O.y+e.clientTop}else o&&T();h&&!r&&o&&T();const E=o&&!r&&!h?MR(o,a):ml(0),k=d.left+a.scrollLeft-v.x-E.x,L=d.top+a.scrollTop-v.y-E.y;return{x:k,y:L,width:d.width,height:d.height}}function AS(t){return Ea(t).position==="static"}function dA(t,e){if(!vl(t)||Ea(t).position==="fixed")return null;if(e)return e(t);let i=t.offsetParent;return Tl(t)===i&&(i=i.ownerDocument.body),i}function AR(t,e){const i=po(t);if(nw(t))return i;if(!vl(t)){let o=ju(t);for(;o&&!rm(o);){if(Ca(o)&&!AS(o))return o;o=ju(o)}return i}let r=dA(t,e);for(;r&&TY(r)&&AS(r);)r=dA(r,e);return r&&rm(r)&&AS(r)&&!sw(r)?i:r||PY(t)||i}const VY=async function(t){const e=this.getOffsetParent||AR,i=this.getDimensions,r=await i(t.floating);return{reference:UY(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function GY(t){return Ea(t).direction==="rtl"}const dC={convertOffsetParentRelativeRectToViewportRelativeRect:DY,getDocumentElement:Tl,getClippingRect:BY,getOffsetParent:AR,getElementRects:VY,getClientRects:zY,getDimensions:jY,getScale:Mf,isElement:Ca,isRTL:GY};function DR(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function qY(t,e){let i=null,r;const o=Tl(t);function h(){var a;clearTimeout(r),(a=i)==null||a.disconnect(),i=null}function d(a,v){a===void 0&&(a=!1),v===void 0&&(v=1),h();const T=t.getBoundingClientRect(),{left:E,top:k,width:L,height:O}=T;if(a||e(),!L||!O)return;const H=O_(k),ie=O_(o.clientWidth-(E+L)),pe=O_(o.clientHeight-(k+O)),be=O_(E),Pe={rootMargin:-H+"px "+-ie+"px "+-pe+"px "+-be+"px",threshold:ld(0,im(1,v))||1};let Ie=!0;function ke(Ke){const qe=Ke[0].intersectionRatio;if(qe!==v){if(!Ie)return d();qe?d(!1,qe):r=setTimeout(()=>{d(!1,1e-7)},1e3)}qe===1&&!DR(T,t.getBoundingClientRect())&&d(),Ie=!1}try{i=new IntersectionObserver(ke,{...Pe,root:o.ownerDocument})}catch{i=new IntersectionObserver(ke,Pe)}i.observe(t)}return d(!0),h}function HY(t,e,i,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:h=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:v=!1}=r,T=w$(t),E=o||h?[...T?_0(T):[],..._0(e)]:[];E.forEach(be=>{o&&be.addEventListener("scroll",i,{passive:!0}),h&&be.addEventListener("resize",i)});const k=T&&a?qY(T,i):null;let L=-1,O=null;d&&(O=new ResizeObserver(be=>{let[Ce]=be;Ce&&Ce.target===T&&O&&(O.unobserve(e),cancelAnimationFrame(L),L=requestAnimationFrame(()=>{var Pe;(Pe=O)==null||Pe.observe(e)})),i()}),T&&!v&&O.observe(T),O.observe(e));let H,ie=v?bd(t):null;v&&pe();function pe(){const be=bd(t);ie&&!DR(ie,be)&&i(),ie=be,H=requestAnimationFrame(pe)}return i(),()=>{var be;E.forEach(Ce=>{o&&Ce.removeEventListener("scroll",i),h&&Ce.removeEventListener("resize",i)}),k?.(),(be=O)==null||be.disconnect(),O=null,v&&cancelAnimationFrame(H)}}const ZY=bY,WY=mY,YY=xY,pA=gY,XY=yY,JY=pY,KY=(t,e,i)=>{const r=new Map,o={platform:dC,...i},h={...o.platform,_c:r};return dY(t,e,{...o,platform:h})};function lw(t,e,{signal:i,edges:r}={}){let o,h=null;const d=r!=null&&r.includes("leading"),a=r==null||r.includes("trailing"),v=()=>{h!==null&&(t.apply(o,h),o=void 0,h=null)},T=()=>{a&&v(),O()};let E=null;const k=()=>{E!=null&&clearTimeout(E),E=setTimeout(()=>{E=null,T()},e)},L=()=>{E!==null&&(clearTimeout(E),E=null)},O=()=>{L(),o=void 0,h=null},H=()=>{v()},ie=function(...pe){if(i?.aborted)return;o=this,h=pe;const be=E==null;k(),d&&be&&v()};return ie.schedule=k,ie.cancel=O,ie.flush=H,i?.addEventListener("abort",O,{once:!0}),ie}function QY(t){return t}function eX(t){return t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}function tX(t){return iX(t)}function DS(t){return t.assignedSlot?t.assignedSlot:t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}function iX(t){for(let e=t;e;e=DS(e))if(e instanceof Element&&getComputedStyle(e).display==="none")return null;for(let e=DS(t);e;e=DS(e)){if(!(e instanceof Element))continue;const i=getComputedStyle(e);if(i.display!=="contents"&&(i.position!=="static"||sw(i)||e.tagName==="BODY"))return e}return null}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */(function(){{const e=dC.getOffsetParent;dC.getOffsetParent=i=>e(i,tX)}})();function fA(t){const e=window.devicePixelRatio||1;return Math.round(t*e)/e}const zR=(async(t,{referenceEl:e,floatingEl:i,overlayPositioning:r="absolute",placement:o,flipDisabled:h,flipPlacements:d,offsetDistance:a,offsetSkidding:v,arrowEl:T,type:E})=>{if(!e||!i)return;const k=J0(i)==="rtl",{x:L,y:O,placement:H,strategy:ie,middlewareData:pe}=await KY(e,i,{strategy:r,placement:o==="auto"||o==="auto-start"||o==="auto-end"?void 0:mA(o,k),middleware:sX({placement:o,flipDisabled:h,flipPlacements:d?.map(Ie=>mA(Ie,k)),offsetDistance:a,offsetSkidding:v,arrowEl:T,type:E})});if(T&&pe.arrow){const{x:Ie,y:ke}=pe.arrow,Ke=H.split("-")[0],qe=Ie!=null?"left":"top",dt=lX[Ke],ft={left:"",top:"",bottom:"",right:""};"floatingLayout"in t&&(t.floatingLayout=Ke==="left"||Ke==="right"?"horizontal":"vertical"),Object.assign(T.style,{...ft,[qe]:`${qe=="left"?Ie:ke}px`,[Ke]:"100%",transform:dt})}const Ce=pe.hide?.referenceHidden?"hidden":null,Pe=Ce?"none":null;i.setAttribute(rX,H),Object.assign(i.style,{pointerEvents:Pe,position:ie,transform:`translate(${fA(L)}px,${fA(O)}px)`,visibility:Ce})}),rX="data-placement",OR=["top","bottom","right","left","top-start","top-end","bottom-start","bottom-end","right-start","right-end","left-start","left-end","leading","trailing","leading-start","leading-end","trailing-start","trailing-end"],b0="bottom-start",nX="bottom-end",nm={animation:"calcite-floating-ui-anim",animationActive:"calcite-floating-ui-anim--active"};function sX({placement:t,flipDisabled:e,flipPlacements:i,offsetDistance:r,offsetSkidding:o,arrowEl:h,type:d}){const a=[YY(),XY()];return d==="menu"&&a.push(pA({fallbackPlacements:i||["top-start","top","top-end","bottom-start","bottom","bottom-end"]})),a.push(ZY({mainAxis:typeof r=="number"?r:0,crossAxis:typeof o=="number"?o:0})),t==="auto"||t==="auto-start"||t==="auto-end"?a.push(WY({alignment:t==="auto-start"?"start":t==="auto-end"?"end":null})):e||a.push(pA(i?{fallbackPlacements:i}:{})),h&&a.push(JY({element:h})),a}function oX(t){return OR.includes(t)}function RR(t,e){const i=t.filter(oX);return i.length!==t.length&&console.warn(`${e.tagName}: Invalid value found in: flipPlacements. Try any of these: ${OR.map(r=>`"${r}"`).join(", ").trim()}`,{el:e}),i}function mA(t,e=!1){const i=["left","right"];return e&&i.reverse(),t.replace(/leading/gi,i[0]).replace(/trailing/gi,i[1])}async function S$(t,e,i=!1){if(!t.open||!e.floatingEl||!e.referenceEl)return;if(Object.assign(e.floatingEl.style,{display:"block",position:e.overlayPositioning??"absolute"}),!x0.get(t))return LR(t);await(i?aX(t):zR)(t,e)}function aX(t){let e=Ax.get(t);return e||(e=lw(zR,m$.reposition,{edges:["leading","trailing"]}),Ax.set(t,e),e)}const lX={top:"",left:"rotate(-90deg)",bottom:"rotate(180deg)",right:"rotate(90deg)"},x0=new WeakMap,Ax=new WeakMap;async function LR(t){const{referenceEl:e,floatingEl:i}=t;if(!i.isConnected)return;const r=HY;x0.set(t,{state:"pending"});let o;const h=r(e,i,()=>{const d=t.reposition();o||(o=d)});return x0.set(t,{state:"active",cleanUp:h}),o}function T$(t){const{floatingEl:e}=t;e&&Object.assign(e.style,{display:"",pointerEvents:"",position:"",transform:"",visibility:""})}async function fc(t){const{floatingEl:e,referenceEl:i}=t;if(T$(t),!(!e||!i)&&(cw(t),!!t.open))return LR(t)}function cw(t){const e=x0.get(t);e?.state==="active"&&e.cleanUp(),x0.delete(t),Ax.get(t)?.cancel(),Ax.delete(t)}const gA=4,yA=Math.ceil(Math.hypot(gA,gA));/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function cX(){const{disabled:t}=this;t||HTMLElement.prototype.click.call(this)}function FR(t){t.target.disabled&&t.preventDefault()}const NR=["mousedown","mouseup","click"];function BR(t){t.target.disabled&&(t.stopImmediatePropagation(),t.preventDefault())}const Dx={capture:!0};function yo(t){if(t.disabled){t.el.setAttribute("aria-disabled","true"),t.el.contains(document.activeElement)&&document.activeElement.blur(),uX(t);return}dX(t),t.el.removeAttribute("aria-disabled")}function uX(t){t.el.click=cX,hX(t.el)}function hX(t){t.addEventListener("pointerdown",FR,Dx),NR.forEach(e=>t.addEventListener(e,BR,Dx))}function dX(t){delete t.el.click,pX(t.el)}function pX(t){t.removeEventListener("pointerdown",FR,Dx),NR.forEach(e=>t.removeEventListener(e,BR,Dx))}const fX={container:"interaction-container"},vo=({children:t,disabled:e})=>Fe`<div class=${Le(fX.container)} .inert=${e}>${t}</div>`;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function C$(t){return t==="Enter"||t===" "}const uw=["0","1","2","3","4","5","6","7","8","9"];/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function vA(t){return t[t.openProp||"open"]}async function Q0(t){await t.updateComplete,vA(t)?t.onBeforeOpen():t.onBeforeClose(),await t.updateComplete,t.transitionEl&&await WW(t.transitionEl,t.transitionProp),vA(t)?t.onOpen():t.onClose()}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function mX(t,e,i){return e?`${t}-${e}`:i?`${t}-${i}`:`${t}-m`}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function Ur(t){return t==="l"?"m":"s"}async function gX(t){await t.componentOnReady(),await t.updateComplete}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Rs=()=>g$((t,e)=>{let i;function r(){i?.abort()}return e.onLoad(()=>{t.listen("focus",()=>{i=new AbortController,t.el.addEventListener("focusout",r,{signal:i.signal})})}),e.onDisconnected(()=>{t.el.removeEventListener("focusout",r)}),async(o,h)=>{if(t.disabled)return;const d=vX(o());if(!d)return;const{target:a,includeContainer:v,strategy:T}=d,E=ew(t.el),k=E.activeElement;if(await gX(t),!(k!==E.activeElement||i&&!i?.signal.aborted))return t.el.removeEventListener("focus",r),y0(a,v,T,t.el,h)}});function yX(t){return"target"in t&&("includeContainer"in t||"strategy"in t)}function vX(t){if(t)return yX(t)?t:{target:t}}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const _X={trigger:"trigger"},zS={content:"content",wrapper:"wrapper",triggerContainer:"trigger-container"},_A="calcite-dropdown",R_={menuButton:t=>`${_A}-${t}-menubutton`,menu:t=>`${_A}-${t}-menu`},bX=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block}.wrapper{--calcite-floating-ui-z-index: var(--calcite-z-index-dropdown);inline-size:max-content;display:none;max-inline-size:100vw;max-block-size:100vh;inset-block-start:0;left:0;z-index:var(--calcite-floating-ui-z-index)}@starting-style{.wrapper{opacity:0;inset-block-start:0;left:0}}.wrapper .calcite-floating-ui-anim{position:relative;transition-duration:var(--calcite-floating-ui-transition);transition-property:inset-block-start,left,opacity,display;transition-behavior:allow-discrete;opacity:0;box-shadow:0 0 16px #00000029;z-index:var(--calcite-z-index);border-radius:.25rem}.wrapper[data-placement^=bottom] .calcite-floating-ui-anim{inset-block-start:-5px}.wrapper[data-placement^=top] .calcite-floating-ui-anim{inset-block-start:5px}.wrapper[data-placement^=left] .calcite-floating-ui-anim{left:5px}.wrapper[data-placement^=right] .calcite-floating-ui-anim{left:-5px}.wrapper[data-placement] .calcite-floating-ui-anim--active{opacity:1;inset-block-start:0;left:0}@starting-style{.wrapper[data-placement] .calcite-floating-ui-anim--active{opacity:0}}.content{max-height:45vh;width:auto;overflow-y:auto;overflow-x:hidden;inline-size:var(--calcite-dropdown-width, var(--calcite-internal-dropdown-width));background-color:var(--calcite-dropdown-background-color, var(--calcite-color-foreground-1))}.trigger-container{position:relative;display:flex;height:100%;flex:1 1 auto;word-wrap:break-word;word-break:break-word}.width-s{--calcite-internal-dropdown-width: 12rem}.width-m{--calcite-internal-dropdown-width: 14rem}.width-l{--calcite-internal-dropdown-width: 16rem}@media (forced-colors: active){:host([open]) .wrapper{border:var(--calcite-border-width-sm) solid canvasText}}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}`,n0=class n0 extends Vi{constructor(){super(),this.focusLastDropdownItem=!1,this.groups=[],this.guid=Hu(),this.items=[],this.mutationObserver=Ho("mutation",()=>this.updateItems()),this.transitionProp="opacity",this.resizeObserver=Ho("resize",e=>this.resizeObserverCallback(e)),this.focusSetter=Rs()(this),this.closeOnSelectDisabled=!1,this.disabled=!1,this.maxItems=0,this.offsetDistance=0,this.offsetSkidding=0,this.open=!1,this.overlayPositioning="absolute",this.placement=b0,this.scale="m",this.selectedItems=[],this.type="click",this.calciteDropdownBeforeClose=vt({cancelable:!1}),this.calciteDropdownBeforeOpen=vt({cancelable:!1}),this.calciteDropdownClose=vt({cancelable:!1}),this.calciteDropdownOpen=vt({cancelable:!1}),this.calciteDropdownSelect=vt({cancelable:!1}),this.listenOn(window,"click",this.closeCalciteDropdownOnClick),this.listen("calciteInternalDropdownCloseRequest",this.closeCalciteDropdownOnEvent),this.listenOn(window,"calciteDropdownOpen",this.closeCalciteDropdownOnOpenEvent),this.listen("pointerenter",this.pointerEnterHandler),this.listen("pointerleave",this.pointerLeaveHandler),this.listen("calciteInternalDropdownItemKeyEvent",this.calciteInternalDropdownItemKeyEvent),this.listen("calciteInternalDropdownItemSelect",this.handleItemSelect)}async reposition(e=!1){const{filteredFlipPlacements:i,floatingEl:r,offsetDistance:o,offsetSkidding:h,overlayPositioning:d,placement:a,referenceEl:v}=this;return S$(this,{floatingEl:r,referenceEl:v,offsetDistance:o,offsetSkidding:h,overlayPositioning:d,placement:a,flipPlacements:i,type:"menu"},e)}async setFocus(e){return this.focusSetter(()=>this.referenceEl,e)}connectedCallback(){super.connectedCallback(),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0}),this.setFilteredPlacements(),this.updateItems(),fc(this)}willUpdate(e){e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler(),e.has("disabled")&&(this.hasUpdated||this.disabled!==!1)&&this.handleDisabledChange(this.disabled),e.has("flipPlacements")&&this.flipPlacementsHandler(),e.has("maxItems")&&this.hasUpdated&&this.setMaxScrollerHeight(),this.hasUpdated&&(e.has("offsetDistance")&&this.offsetDistance!==0||e.has("offsetSkidding")&&this.offsetSkidding!==0||e.has("overlayPositioning")&&this.overlayPositioning!=="absolute"||e.has("placement")&&this.placement!==b0)&&this.reposition(!0),e.has("scale")&&(this.hasUpdated||this.scale!=="m")&&this.handlePropsChange()}updated(){yo(this)}loaded(){this.updateSelectedItems(),fc(this)}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.resizeObserver?.disconnect(),cw(this)}openHandler(){Q0(this),!this.disabled&&this.reposition(!0)}handleDisabledChange(e){e||(this.open=!1)}flipPlacementsHandler(){this.setFilteredPlacements(),this.reposition(!0)}handlePropsChange(){this.updateItems(),this.updateGroupProps()}closeCalciteDropdownOnClick(e){this.disabled||!this.open||e.composedPath().includes(this.el)||this.closeCalciteDropdown(!1)}closeCalciteDropdownOnEvent(e){this.closeCalciteDropdown(),e.stopPropagation()}closeCalciteDropdownOnOpenEvent(e){e.composedPath().includes(this.el)||(this.open=!1)}pointerEnterHandler(){this.disabled||this.type!=="hover"||this.toggleDropdown()}pointerLeaveHandler(){this.disabled||this.type!=="hover"||this.closeCalciteDropdown()}getTraversableItems(){return this.items.filter(e=>!e.disabled&&!e.hidden)}calciteInternalDropdownItemKeyEvent(e){const{keyboardEvent:i}=e.detail,r=i.target,o=this.getTraversableItems();switch(i.key){case"Tab":this.open=!1,this.updateTabIndexOfItems(r);break;case"ArrowDown":z_(o,r,"next");break;case"ArrowUp":z_(o,r,"previous");break;case"Home":z_(o,r,"first");break;case"End":z_(o,r,"last");break}e.stopPropagation()}handleItemSelect(e){this.updateSelectedItems(),e.stopPropagation(),this.calciteDropdownSelect.emit(),(!this.closeOnSelectDisabled||e.detail.requestedDropdownGroup.selectionMode==="none")&&this.closeCalciteDropdown(),e.stopPropagation()}setFilteredPlacements(){const{el:e,flipPlacements:i}=this;this.filteredFlipPlacements=i?RR(i,e):null}updateTriggers(e){this.triggers=e.target.assignedElements({flatten:!0}),this.reposition(!0)}updateItems(){this.items=this.groups.map(e=>Array.from(e?.querySelectorAll("calcite-dropdown-item"))).reduce((e,i)=>[...e,...i],[]),this.updateSelectedItems(),this.reposition(!0),this.items.forEach(e=>e.scale=this.scale)}updateGroups(e){const i=e.target.assignedElements({flatten:!0}).filter(r=>r?.matches("calcite-dropdown-group"));this.groups=i,this.updateItems(),this.updateGroupProps()}updateGroupProps(){this.groups.forEach((e,i)=>{e.scale=this.scale,e.position=i})}resizeObserverCallback(e){e.forEach(({target:i})=>{i===this.referenceEl?this.setDropdownWidth():i===this.scrollerEl&&this.setMaxScrollerHeight()})}setDropdownWidth(){const{referenceEl:e,scrollerEl:i}=this;!i||!e||(i.style.minWidth=`${e.clientWidth}px`)}setMaxScrollerHeight(){const{maxItems:e,items:i,scrollerEl:r}=this;if(!r)return;const o=i.length>=e&&e>0?this.getYDistanceFromScroller(i.at(e-1)):0;r.style.maxBlockSize=o>0?`${o}px`:"",this.reposition(!0)}setScrollerAndTransitionEl(e){Tx(this.resizeObserver,this.scrollerEl,e),this.scrollerEl=e,this.transitionEl=e}onBeforeOpen(){this.focusOnFirstActiveOrDefaultItem(),this.calciteDropdownBeforeOpen.emit()}onOpen(){this.calciteDropdownOpen.emit()}onBeforeClose(){this.calciteDropdownBeforeClose.emit()}onClose(){this.calciteDropdownClose.emit(),T$(this)}setReferenceEl(e){Tx(this.resizeObserver,this.referenceEl,e),this.referenceEl=e,fc(this)}setFloatingEl(e){this.floatingEl=e,fc(this)}keyDownHandler(e){if(!e.composedPath().includes(this.referenceEl))return;const{defaultPrevented:i,key:r}=e;if(!i){if(r==="Escape"){this.closeCalciteDropdown(),e.preventDefault();return}if(this.open&&e.shiftKey&&r==="Tab"){this.closeCalciteDropdown(),e.preventDefault();return}C$(r)?(this.toggleDropdown(),e.preventDefault()):(r==="ArrowDown"||r==="ArrowUp")&&(e.preventDefault(),this.focusLastDropdownItem=r==="ArrowUp",this.open=!0)}}updateSelectedItems(){this.selectedItems=this.items.filter(e=>e.selected)}getYDistanceFromScroller(e){const i=e.getBoundingClientRect();return e.offsetTop+i.height}closeCalciteDropdown(e=!0){this.open=!1,e&&y0(this.triggers[0])}async focusOnFirstActiveOrDefaultItem(){const i=this.getTraversableItems().find(r=>r.selected)||(this.focusLastDropdownItem?this.items.at(-1):this.items[0]);this.focusLastDropdownItem=!1,i&&(await this.updateComplete,await aC(),await aC(),await y0(i),i.scrollIntoView({block:"nearest"}))}toggleDropdown(){this.open=!this.open}updateTabIndexOfItems(e){this.items.forEach(i=>{i.tabIndex=e!==i?-1:0})}render(){const{open:e,guid:i}=this;return vo({disabled:this.disabled,children:Fe`<div class=${Le(zS.triggerContainer)} id=${R_.menuButton(i)??ut} @click=${this.toggleDropdown} @keydown=${this.keyDownHandler} ${hi(this.setReferenceEl)}><slot aria-controls=${R_.menu(i)??ut} .ariaExpanded=${e} aria-haspopup=menu name=${_X.trigger} @slotchange=${this.updateTriggers}></slot></div><div .ariaHidden=${!e} class=${Le({[zS.wrapper]:!0,[mX("width",this.width,this.widthScale)]:!!(this.width||this.widthScale)})} ${hi(this.setFloatingEl)}><div aria-labelledby=${R_.menuButton(i)??ut} class=${Le({[zS.content]:!0,[nm.animation]:!0,[nm.animationActive]:e})} id=${R_.menu(i)??ut} role=menu ${hi(this.setScrollerAndTransitionEl)}><slot @slotchange=${this.updateGroups}></slot></div></div>`})}};n0.properties={closeOnSelectDisabled:[7,{},{reflect:!0,type:Boolean}],disabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],maxItems:[11,{},{reflect:!0,type:Number}],offsetDistance:[11,{},{type:Number,reflect:!0}],offsetSkidding:[11,{},{reflect:!0,type:Number}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}],selectedItems:[0,{},{attribute:!1}],type:[3,{},{reflect:!0}],widthScale:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]},n0.shadowRootOptions={mode:"open",delegatesFocus:!0},n0.styles=bX;let pC=n0;lr("calcite-dropdown",pC);/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ai=wm(class extends Sm{constructor(){super(...arguments),this.key=ut}render(t,e){return this.key=t,e}update(t,[e,i]){return e!==this.key&&(f$(t),this.key=e),i}});/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const xX=["calcite-input","calcite-input-number","calcite-input-text","calcite-text-area"];function wX(t){return`${t.split("-").map((r,o)=>o===0?r:`${r[0].toUpperCase()}${r.slice(1)}`).join("")}${xX.includes(t)?"Input":"Change"}`}const fC="hidden-form-input";function E$(t){return"checked"in t}const mC=new WeakMap,I$=new WeakSet;function SX(t,e){if(Tm(e.parentElement,"[form]"))return!0;const r="calciteInternalFormComponentRegister";let o=!1;return t.addEventListener(r,h=>{o=h.composedPath().some(d=>I$.has(d)),h.stopPropagation()},{once:!0}),e.dispatchEvent(new CustomEvent(r,{bubbles:!0,composed:!0})),o}function TX(t,{status:e,message:i,icon:r}){"status"in t&&(t.status=e),"validationIcon"in t&&typeof t.validationIcon!="string"&&(t.validationIcon=r),"validationMessage"in t&&!t.validationMessage&&(t.validationMessage=i)}function jR(t){return t.nodeName==="CALCITE-RADIO-BUTTON"?Tm(t,"calcite-radio-button-group"):t}const CX=new CustomEvent("calciteInvalid",{bubbles:!0,composed:!0});function bA(t){const e=t?.target,i=e?.validationMessage,r=jR(e?.parentElement);if(!r)return;const o=r?.nodeName?.toLowerCase(),h=o?.split("-");if(h.length<2||h[0]!=="calcite")return;t?.preventDefault(),"validity"in r&&(r.validity=e?.validity),r.dispatchEvent(CX),TX(r,{message:i,icon:!0,status:"invalid"});const d=wX(o);r.addEventListener(d,()=>{"status"in r&&(r.status="idle"),"validationIcon"in r&&(r.validationIcon===""||r.validationIcon===!0)&&(r.validationIcon=!1),"validationMessage"in r&&r.validationMessage===i&&(r.validationMessage=""),"validity"in r&&(r.validity=e?.validity)},{once:!0})}function hw(t){const{formEl:e}=t;return e?(e.addEventListener("invalid",bA,!0),e.requestSubmit(),e.removeEventListener("invalid",bA,!0),requestAnimationFrame(()=>{const i=e.querySelectorAll("[status=invalid]");for(const r of i)if(r?.validationMessage){r?.setFocus();break}}),!0):!1}function UR(t){t.formEl?.reset()}function VR(t){const{el:e,value:i}=t,r=$$(t);if(!r||SX(r,e))return;t.formEl=r,t.defaultValue=i,E$(t)&&(t.defaultChecked=t.checked);const o=EX.bind(t);r.addEventListener("reset",o),mC.set(t.el,o),I$.add(e)}function $$(t){const{el:e,form:i}=t;return i?tw(e,{id:i}):Tm(e,"form")}function EX(){if("status"in this&&(this.status="idle"),"validationIcon"in this&&(this.validationIcon=!1),"validationMessage"in this&&(this.validationMessage=""),E$(this)){this.checked=this.defaultChecked;return}this.value=this.defaultValue,this.onFormReset?.()}function GR(t){const{el:e,formEl:i}=t;if(!i)return;const r=mC.get(e);i.removeEventListener("reset",r),mC.delete(e),t.formEl=null,I$.delete(e)}function IX(t,e){t.defaultValue=e}const gC="calciteInternalHiddenInputInput",qR=t=>{t.target.dispatchEvent(new CustomEvent(gC,{bubbles:!0}))},xA=t=>t.removeEventListener("input",qR);function $X(t){const{el:e,formEl:i,name:r,value:o}=t,{ownerDocument:h}=e,d=e.querySelectorAll(`input[slot="${fC}"]`);if(!i||!r){d.forEach(k=>{xA(k),k.remove()});return}const a=Array.isArray(o)?o:[o],v=[],T=new Set;d.forEach(k=>{const L=a.find(O=>O==k.value);L!=null?(T.add(L),wA(t,k,L)):v.push(k)});let E;a.forEach(k=>{if(T.has(k))return;let L=v.pop();L||(L=h.createElement("input"),L.ariaHidden="true",L.slot=fC),E||(E=h.createDocumentFragment()),E.append(L),L.addEventListener("input",qR),wA(t,L,k)}),E&&e.append(E),v.forEach(k=>{xA(k),k.remove()})}function wA(t,e,i){const{defaultValue:r,disabled:o,form:h,name:d,required:a}=t;e.defaultValue=r,e.disabled=o,e.name=d,e.required=a,e.tabIndex=-1,h?e.setAttribute("form",h):e.removeAttribute("form"),E$(t)?(e.checked=t.checked,e.defaultChecked=t.defaultChecked,e.value=t.checked?i||"on":""):e.value=i||"",t.syncHiddenFormInput?.(e);const v=jR(t.el);if(v&&"validity"in v)for(const T in{...e?.validity})v.validity[T]=e.validity[T]}const HR=({component:t})=>($X(t),Fe`<slot name=${fC}></slot>`);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const oa={button:"button",buttonTextVisible:"button--text-visible",buttonCompact:"button--compact",indicatorText:"indicator-text",iconContainer:"icon-container",slotContainer:"slot-container",slotContainerHidden:"slot-container--hidden",textContainer:"text-container",textContainerVisible:"text-container--visible",indicatorWithIcon:"indicator-with-icon",indicatorWithoutIcon:"indicator-without-icon"},SA="calcite-action",PX={button:t=>`${SA}-${t}-button`,indicator:t=>`${SA}-${t}-indicator`},MX={tooltip:"tooltip"},kX=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;cursor:pointer;background-color:transparent;--calcite-internal-action-text-color: var(--calcite-color-text-3);border-radius:var(--calcite-action-corner-radius, var(--calcite-action-corner-radius-start-start, var(--calcite-corner-radius)) var(--calcite-action-corner-radius-start-end, var(--calcite-corner-radius)) var(--calcite-action-corner-radius-end-end, var(--calcite-corner-radius)) var(--calcite-action-corner-radius-end-start, var(--calcite-corner-radius)))}.interaction-container{border-radius:inherit}:host([width=full]){flex:1 0 auto}:host([width=full]) .button{justify-content:center}:host([width=full]) .button .text-container--visible{flex:none}:host([drag-handle]){cursor:move;--calcite-internal-action-text-color: var(--calcite-color-border-input);--calcite-internal-action-padding-inline: var(--calcite-spacing-xxs)}.button{border-radius:inherit;position:relative;margin:0;display:flex;inline-size:auto;align-items:center;justify-content:flex-start;border-style:none;font-family:var(--calcite-font-family);font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-medium);outline-color:transparent;background-color:var(--calcite-action-background-color, var(--calcite-color-foreground-1));color:var(--calcite-action-text-color, var(--calcite-internal-action-text-color));text-align:unset;flex:1 0 auto;cursor:inherit}.button:hover{background-color:var(--calcite-action-background-color-hover, var(--calcite-color-foreground-2));color:var(--calcite-action-text-color-press, var(--calcite-action-text-color-pressed, var(--calcite-color-text-1)))}.button:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.button:active{background-color:var(--calcite-action-background-color-press, var(--calcite-action-background-color-pressed, var(--calcite-color-foreground-3)))}.icon-container{pointer-events:none;margin:0;display:flex;align-items:center;justify-content:center;min-inline-size:1rem;min-block-size:1.5rem}.text-container{margin:0;inline-size:0px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:1.5rem;opacity:0;transition-property:opacity;transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.4,0,.2,1);transition-property:inline-size}.text-container--visible{inline-size:auto;flex:1 1 auto;opacity:1}:host([active]) .button{background-color:var(--calcite-action-background-color, var(--calcite-color-foreground-3));color:var(--calcite-action-text-color-press, var(--calcite-action-text-color-pressed, var(--calcite-color-text-1)))}:host([active]) .button:hover{background-color:var(--calcite-action-background-color-hover, var(--calcite-color-foreground-3))}:host([active]) .button:active{background-color:var(--calcite-action-background-color-press, var(--calcite-action-background-color-pressed, var(--calcite-color-foreground-3)))}:host([loading]) .button:hover,:host([loading]) .button:focus{background-color:var(--calcite-action-background-color, var(--calcite-color-foreground-1))}:host([loading]) .text-container{opacity:var(--calcite-opacity-disabled)}:host([loading]) calcite-loader[inline]{margin-inline-end:0px}:host([appearance=transparent]):host([active]) .button{background-color:var(--calcite-color-transparent-press)}:host([appearance=transparent]) .button{background-color:transparent;transition-property:box-shadow;transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.4,0,.2,1)}:host([appearance=transparent]) .button:hover{background-color:var(--calcite-color-transparent-hover)}:host([appearance=transparent]) .button:active{background-color:var(--calcite-color-transparent-press)}:host([active-descendant]) .button{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([scale=s]) .button{font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-normal);padding-inline:var(--calcite-internal-action-padding-inline, .5rem);padding-block:var(--calcite-internal-action-padding-block, var(--calcite-spacing-xxs))}:host([scale=s]) .button--text-visible .icon-container{margin-inline-end:.5rem}:host([scale=m]) .button{font-size:var(--calcite-font-size--1);line-height:1rem;font-weight:var(--calcite-font-weight-normal);padding-inline:var(--calcite-internal-action-padding-inline, 1rem);padding-block:var(--calcite-internal-action-padding-block, var(--calcite-spacing-md))}:host([scale=m]) .button--text-visible .icon-container{margin-inline-end:.75rem}:host([scale=l]) .button{font-size:var(--calcite-font-size-0);line-height:1.25rem;font-weight:var(--calcite-font-weight-normal);padding-inline:var(--calcite-internal-action-padding-inline, 1.25rem);padding-block:var(--calcite-internal-action-padding-block, var(--calcite-spacing-xl))}:host([scale=l]) .button--text-visible .icon-container{margin-inline-end:1rem}:host([alignment=center]) .button{justify-content:center}:host([alignment=end]) .button{justify-content:flex-end}:host([alignment=center]) .button .text-container--visible,:host([alignment=end]) .button .text-container--visible{flex:0 1 auto}:host([scale=s][compact]) .button,:host([scale=m][compact]) .button,:host([scale=l][compact]) .button{padding-inline:0px}.slot-container{display:flex}.slot-container--hidden{display:none}.button--text-visible{inline-size:100%}.indicator-with-icon{position:relative}.indicator-with-icon:after{content:"";position:absolute;block-size:.5rem;inline-size:.5rem;border-radius:9999px;inset-block-end:-.275rem;inset-inline-end:-.275rem;background-color:var(--calcite-action-indicator-color, var(--calcite-color-brand))}.indicator-without-icon{margin-inline:.25rem;inline-size:1rem;position:relative}.indicator-without-icon:after{content:"";position:absolute;block-size:.5rem;inline-size:.5rem;border-radius:9999px;inset-block-end:-.275rem;inset-inline-end:-.275rem;background-color:var(--calcite-action-indicator-color, var(--calcite-color-brand))}.indicator-text{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) .button,:host([disabled]) .button:hover,:host([disabled]) .button:focus{cursor:default;opacity:var(--calcite-opacity-disabled);background-color:var(--calcite-action-background-color, var(--calcite-action-background-color, var(--calcite-color-foreground-1)))}:host([disabled]):host([active]) .button,:host([disabled]):host([active]) .button:hover,:host([disabled]):host([active]) .button:focus{opacity:var(--calcite-opacity-disabled);background-color:var(--calcite-action-background-color-press, var(--calcite-action-background-color-press, var(--calcite-action-background-color-pressed, var(--calcite-color-foreground-3))))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}`,E1=class E1 extends Vi{constructor(){super(...arguments),this.guid=Hu(),this.buttonEl=Xn(),this.buttonId=PX.button(this.guid),this.mutationObserver=Ho("mutation",()=>this.requestUpdate()),this.messages=go({blocking:!0}),this.focusSetter=Rs()(this),this.active=!1,this.activeDescendant=!1,this.appearance="solid",this.compact=!1,this.disabled=!1,this.dragHandle=!1,this.iconFlipRtl=!1,this.indicator=!1,this.loading=!1,this.scale="m",this.width="auto",this.textEnabled=!1,this.type="button"}async setFocus(e){return this.focusSetter(()=>this.buttonEl.value,e)}connectedCallback(){super.connectedCallback(),this.formEl=$$(this),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}updated(){yo(this)}disconnectedCallback(){super.disconnectedCallback(),this.formEl=null,this.mutationObserver?.disconnect()}handleClick(){const{type:e}=this;e==="submit"?hw(this):e==="reset"&&UR(this)}handleTooltipSlotChange(e){const r=e.target.assignedElements({flatten:!0}).filter(o=>o?.matches("calcite-tooltip"))[0];r&&(r.referenceElement=this.buttonEl.value)}storeIndicatorEl(e){this.indicatorEl=e}renderTextContainer(){const{text:e,textEnabled:i}=this,r={[oa.textContainer]:!0,[oa.textContainerVisible]:i};return e?ai("text-container",Fe`<div class=${Le(r)}>${e}</div>`):null}renderIndicatorText(){const{indicator:e,messages:i,buttonId:r}=this;return Fe`<div aria-labelledby=${r??Ou} aria-live=polite class=${Le(oa.indicatorText)} role=region ${hi(this.storeIndicatorEl)}>${e?i.indicator:null}</div>`}renderIconContainer(){const{loading:e,icon:i,scale:r,el:o,iconFlipRtl:h,indicator:d}=this,a=r==="l"?"l":"m",v=e?Fe`<calcite-loader inline .label=${this.messages.loading} .scale=${a}></calcite-loader>`:null,T=i?Fe`<calcite-icon class=${Le({[oa.indicatorWithIcon]:d})} .flipRtl=${h} .icon=${i} .scale=${Ur(this.scale)}></calcite-icon>`:null,E=v||T,k=E||o.children?.length,L=Fe`<div class=${Le({[oa.slotContainer]:!0,[oa.slotContainerHidden]:e})}><slot></slot></div>`;return k?ai("icon-container",Fe`<div aria-hidden=true class=${Le(oa.iconContainer)}>${E}${L}</div>`):null}renderButton(){const{compact:e,disabled:i,icon:r,loading:o,textEnabled:h,label:d,text:a,indicator:v,indicatorEl:T,buttonId:E,messages:k}=this,L=d||a||"",O=v?k.indicatorLabel.replace("{label}",L):L,H={[oa.button]:!0,[oa.buttonTextVisible]:h,[oa.buttonCompact]:e},ie=Fe`${this.renderIconContainer()}${this.renderTextContainer()}${!r&&v&&ai("indicator-no-icon",Fe`<div class=${Le(oa.indicatorWithoutIcon)}></div>`)||""}`,pe=v&&T?[T]:[],be=[...this.aria?.controlsElements??[],...pe];return this.dragHandle?Fe`<span .ariaBusy=${o} .ariaControlsElements=${be} .ariaDescribedByElements=${this.aria?.describedByElements} .ariaExpanded=${this.aria?.expanded} .ariaHasPopup=${this.aria?.hasPopup} .ariaLabel=${O} .ariaLabelledByElements=${this.aria?.labelledByElements} .ariaOwnsElements=${this.aria?.ownsElements} .ariaPressed=${this.aria?.pressed} class=${Le(H)} id=${E??Ou} role=button tabindex=${this.disabled?null:0} ${hi(this.buttonEl)}>${ie}</span>`:Fe`<button .ariaBusy=${o} .ariaControlsElements=${be} .ariaDescribedByElements=${this.aria?.describedByElements} .ariaExpanded=${this.aria?.expanded} .ariaHasPopup=${this.aria?.hasPopup} .ariaLabel=${O} .ariaLabelledByElements=${this.aria?.labelledByElements} .ariaOwnsElements=${this.aria?.ownsElements} .ariaPressed=${this.aria?.pressed} class=${Le(H)} .disabled=${i} id=${E??Ou} @click=${this.handleClick} ${hi(this.buttonEl)}>${ie}</button>`}render(){return vo({disabled:this.disabled,children:Fe`${this.renderButton()}<slot name=${MX.tooltip} @slotchange=${this.handleTooltipSlotChange}></slot>${this.renderIndicatorText()}`})}};E1.properties={aria:[0,{},{attribute:!1}],active:[7,{},{reflect:!0,type:Boolean}],activeDescendant:[7,{},{reflect:!0,type:Boolean}],alignment:[3,{},{reflect:!0}],appearance:[3,{},{reflect:!0}],compact:[7,{},{reflect:!0,type:Boolean}],disabled:[7,{},{reflect:!0,type:Boolean}],dragHandle:[7,{},{reflect:!0,type:Boolean}],form:[3,{},{reflect:!0}],icon:[3,{},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],indicator:[7,{},{reflect:!0,type:Boolean}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}],scale:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}],text:1,textEnabled:[7,{},{reflect:!0,type:Boolean}],type:[3,{},{reflect:!0}]},E1.styles=kX;let yC=E1;lr("calcite-action",yC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const du={container:"container",containerNone:"container--none-selection",icon:"dropdown-item-icon",iconEnd:"dropdown-item-icon--end",iconStart:"dropdown-item-icon--start",itemContent:"dropdown-item-content",link:"dropdown-link"},TA={check:"check",bulletPoint:"bullet-point"};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const AX=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{position:relative;display:flex;flex-grow:1;align-items:center;outline-color:transparent}.container{position:relative;display:flex;flex-grow:1;cursor:pointer;align-items:center;text-decoration-line:none;color:var(--calcite-dropdown-item-text-color, var(--calcite-color-text-3));text-align:start;outline-color:transparent}.container a{outline:none;position:relative;display:flex;flex-grow:1;cursor:pointer;align-items:center;text-decoration-line:none;color:var(--calcite-dropdown-item-text-color, var(--calcite-color-text-3))}.dropdown-item-content{flex:1 1 auto;padding-block:.125rem}.dropdown-item-icon{position:relative;opacity:0;transition-timing-function:cubic-bezier(.4,0,.2,1);transform:scale(.9)}:host([scale=s]) .container{padding-block:.25rem;padding-inline:.5rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) .dropdown-item-icon,:host([scale=s]) .dropdown-item-icon--start{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .dropdown-item-icon--end{padding-inline-start:var(--calcite-spacing-sm)}:host([scale=m]) .container{padding-block:.5rem;padding-inline:.75rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) .dropdown-item-icon,:host([scale=m]) .dropdown-item-icon--start{padding-inline-end:var(--calcite-spacing-md)}:host([scale=m]) .dropdown-item-icon--end{padding-inline-start:var(--calcite-spacing-md)}:host([scale=l]) .container{padding-block:.625rem;padding-inline:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .dropdown-item-icon,:host([scale=l]) .dropdown-item-icon--start{padding-inline-end:var(--calcite-spacing-lg)}:host([scale=l]) .dropdown-item-icon--end{padding-inline-start:var(--calcite-spacing-lg)}:host(:focus) .container{text-decoration-line:none;outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host(:hover:not([disabled])) .container{background-color:var(--calcite-dropdown-item-background-color-hover, var(--calcite-color-foreground-2))}:host(:active:not([disabled])) .container{background-color:var(--calcite-dropdown-item-background-color-press, var(--calcite-color-foreground-3))}:host(:hover:not([disabled])) .container,:host(:active:not([disabled])) .container{text-decoration-line:none;color:var(--calcite-dropdown-item-text-color-press, var(--calcite-color-text-1))}:host(:hover:not([disabled])) .dropdown-link,:host(:active:not([disabled])) .dropdown-link{color:var(--calcite-dropdown-item-text-color-press, var(--calcite-color-text-1))}:host([selected]) .container:not(.container--none-selection),:host([selected]) .dropdown-link{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-dropdown-item-text-color-press, var(--calcite-color-text-1))}:host([selected]) .container:not(.container--none-selection) calcite-icon,:host([selected]) .dropdown-link calcite-icon{color:var(--calcite-dropdown-item-icon-color-press, var(--calcite-color-brand))}:host(:hover:not([disabled])) .dropdown-item-icon{color:var(--calcite-dropdown-item-icon-color-hover)}:host([selected]) .dropdown-item-icon{opacity:1}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}`,I1=class I1 extends Vi{constructor(){super(),this.childLink=Xn(),this.focusSetter=Rs()(this),this.disabled=!1,this.scale="m",this.selected=!1,this.selectionMode="single",this.calciteDropdownItemSelect=vt({cancelable:!1}),this.calciteInternalDropdownCloseRequest=vt({cancelable:!1}),this.calciteInternalDropdownItemKeyEvent=vt({cancelable:!1}),this.calciteInternalDropdownItemSelect=vt({cancelable:!1}),this.listen("click",this.onClick),this.listen("keydown",this.keyDownHandler),this.listenOn(document.body,"calciteInternalDropdownItemChange",this.updateActiveItemOnChange)}async setFocus(e){return this.focusSetter(()=>this.el,e)}connectedCallback(){super.connectedCallback(),this.initialize()}load(){this.initialize()}updated(){yo(this)}onClick(){this.emitRequestedItem()}keyDownHandler(e){switch(e.key){case" ":case"Enter":this.emitRequestedItem(),this.href&&this.childLink.value.click(),e.preventDefault();break;case"Escape":this.calciteInternalDropdownCloseRequest.emit(),e.preventDefault();break;case"Tab":this.calciteInternalDropdownItemKeyEvent.emit({keyboardEvent:e});break;case"ArrowUp":case"ArrowDown":case"Home":case"End":e.preventDefault(),this.calciteInternalDropdownItemKeyEvent.emit({keyboardEvent:e});break}}updateActiveItemOnChange(e){e.composedPath().includes(this.parentDropdownGroupEl)&&(this.requestedDropdownGroup=e.detail.requestedDropdownGroup,this.requestedDropdownItem=e.detail.requestedDropdownItem,this.determineActiveItem()),e.stopPropagation()}initialize(){this.parentDropdownGroupEl=this.el.closest("calcite-dropdown-group"),this.selectionMode==="none"&&(this.selected=!1)}determineActiveItem(){switch(this.selectionMode){case"multiple":this.el===this.requestedDropdownItem&&(this.selected=!this.selected);break;case"single":this.el===this.requestedDropdownItem?this.selected=!0:this.requestedDropdownGroup===this.parentDropdownGroupEl&&(this.selected=!1);break;case"none":this.selected=!1;break}}emitRequestedItem(){this.calciteDropdownItemSelect.emit(),this.calciteInternalDropdownItemSelect.emit({requestedDropdownItem:this.el,requestedDropdownGroup:this.parentDropdownGroupEl})}render(){const{href:e,selectionMode:i,label:r,iconFlipRtl:o}=this,h=Fe`<calcite-icon class=${Le(du.iconStart)} .flipRtl=${o==="start"||o==="both"} .icon=${this.iconStart} .scale=${Ur(this.scale)}></calcite-icon>`,d=Fe`<span class=${Le(du.itemContent)}><slot></slot></span>`,a=Fe`<calcite-icon class=${Le(du.iconEnd)} .flipRtl=${o==="end"||o==="both"} .icon=${this.iconEnd} .scale=${Ur(this.scale)}></calcite-icon>`,v=this.iconStart&&this.iconEnd?[h,d,a]:this.iconStart?[h,d]:this.iconEnd?[d,a]:d,T=e?Fe`<a .ariaLabel=${r} class=${Le(du.link)} href=${e??Ou} rel=${this.rel??Ou} tabindex=-1 target=${this.target??Ou} ${hi(this.childLink)}>${v}</a>`:v,E=e?null:i==="single"?"menuitemradio":i==="multiple"?"menuitemcheckbox":"menuitem",k=i!=="none"?iw(this.selected):null,{disabled:L}=this;return this.el.ariaChecked=k,this.el.ariaLabel=e?"":r,this.el.role=E,Q1(this.el,"tabIndex",L?-1:0),vo({disabled:L,children:Fe`<div class=${Le({[du.container]:!0,[du.containerNone]:i==="none"})}>${i!=="none"?Fe`<calcite-icon class=${Le(du.icon)} .icon=${i==="multiple"?TA.check:TA.bulletPoint} .scale=${Ur(this.scale)}></calcite-icon>`:null}${T}</div>`})}};I1.properties={disabled:[7,{},{reflect:!0,type:Boolean}],href:[3,{},{reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],label:1,rel:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}],selected:[7,{},{reflect:!0,type:Boolean}],selectionMode:1,target:[3,{},{reflect:!0}]},I1.styles=AX;let vC=I1;lr("calcite-dropdown-item",vC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const CA={title:"dropdown-title",separator:"dropdown-separator"},DX=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{display:block}.container{text-align:start}.dropdown-title{margin-block-end:-1px;display:block;cursor:default;overflow-wrap:break-word;border-width:0px;border-block-end-width:1px;border-style:solid;font-weight:var(--calcite-font-weight-bold);border-color:var(--calcite-dropdown-group-border-color, var(--calcite-color-border-3));color:var(--calcite-dropdown-group-title-text-color, var(--calcite-color-text-2))}.dropdown-separator{display:block;block-size:1px;background-color:var(--calcite-dropdown-group-border-color, var(--calcite-color-border-3))}:host([scale=s]){font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) .dropdown-title{padding:.5rem}:host([scale=m]){font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) .dropdown-title{padding:.75rem}:host([scale=l]){font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .dropdown-title{padding:1rem}:host([hidden]){display:none}[hidden]{display:none}`,s0=class s0 extends Vi{constructor(){super(),this.mutationObserver=Ho("mutation",()=>this.updateItems()),this.position=-1,this.scale="m",this.selectionMode="single",this.calciteInternalDropdownItemChange=vt({cancelable:!1}),this.listen("calciteInternalDropdownItemSelect",this.updateActiveItemOnChange)}connectedCallback(){super.connectedCallback(),this.updateItems(),this.mutationObserver?.observe(this.el,{childList:!0})}willUpdate(e){e.has("selectionMode")&&(this.hasUpdated||this.selectionMode!=="single")&&this.updateItems()}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect()}updateActiveItemOnChange(e){this.requestedDropdownGroup=e.detail.requestedDropdownGroup,this.requestedDropdownItem=e.detail.requestedDropdownItem,this.calciteInternalDropdownItemChange.emit({requestedDropdownGroup:this.requestedDropdownGroup,requestedDropdownItem:this.requestedDropdownItem})}updateItems(){Array.from(this.el.querySelectorAll("calcite-dropdown-item")).forEach(e=>e.selectionMode=this.selectionMode)}render(){const e=this.groupTitle?Fe`<span aria-hidden=true class=${Le(CA.title)}>${this.groupTitle}</span>`:null,i=this.position>0?Fe`<div class=${Le(CA.separator)} role=separator></div>`:null;return this.el.ariaLabel=this.groupTitle,this.el.role="group",Fe`<div class=${Le({[du.container]:!0})}>${i}${e}<slot></slot></div>`}};s0.properties={groupTitle:[3,{},{reflect:!0}],position:[9,{},{type:Number}],scale:[3,{},{reflect:!0}],selectionMode:[3,{},{reflect:!0}]},s0.shadowRootOptions={mode:"open",delegatesFocus:!0},s0.styles=DX;let _C=s0;lr("calcite-dropdown-group",_C);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const EA={handle:"handle",dropdown:"dropdown"},IA={drag:"drag",blank:"blank"},OS={label:"{label}",position:"{position}",total:"{total}"},$A=["top","up","down","bottom"],zX={trigger:"trigger"},RS={add:"add",move:"move",reorder:"reorder"},OX=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex}.dropdown{block-size:100%}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}:host([hidden]){display:none}[hidden]{display:none}`,$1=class $1 extends Vi{constructor(){super(...arguments),this.focusSetter=Rs()(this),this.disabled=!1,this.messages=go({blocking:!0}),this.addToItems=[],this.moveToItems=[],this.open=!1,this.overlayPositioning="absolute",this.placement=b0,this.scale="m",this.sortDisabled=!1,this.calciteSortHandleBeforeClose=vt({cancelable:!1}),this.calciteSortHandleBeforeOpen=vt({cancelable:!1}),this.calciteSortHandleClose=vt({cancelable:!1}),this.calciteSortHandleMove=vt({cancelable:!0}),this.calciteSortHandleAdd=vt({cancelable:!0}),this.calciteSortHandleOpen=vt({cancelable:!1}),this.calciteSortHandleReorder=vt({cancelable:!0})}get hasSetInfo(){return typeof this.setPosition=="number"&&typeof this.setSize=="number"}get hasValidSetInfo(){return this.hasSetInfo?this.setPosition>0&&this.setSize>1:!0}get hasReorderItems(){return!this.sortDisabled&&this.hasValidSetInfo}get hasNoItems(){return!this.hasReorderItems&&this.moveToItems.length<1&&this.addToItems.length<1}async setFocus(e){return this.focusSetter(()=>this.dropdownEl,e)}willUpdate(e){e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler()}updated(){yo(this)}openHandler(){if(this.disabled){this.open=!1;return}this.dropdownEl&&(this.dropdownEl.open=this.open)}setDropdownEl(e){e&&(this.dropdownEl=e,this.openHandler())}getLabel(){const{label:e,messages:i,setPosition:r,setSize:o,hasSetInfo:h}=this;if(!h)return e??"";let d=e?i.repositionLabel.replace(OS.label,e):i.reposition;return d=d.replace(OS.position,r?r.toString():""),d.replace(OS.total,o?o.toString():"")}handleBeforeOpen(e){e.stopPropagation(),this.calciteSortHandleBeforeOpen.emit()}handleOpen(e){e.stopPropagation(),this.calciteSortHandleOpen.emit(),this.open=!0}handleBeforeClose(e){e.stopPropagation(),this.calciteSortHandleBeforeClose.emit()}handleClose(e){e.stopPropagation(),this.calciteSortHandleClose.emit(),this.open=!1}handleReorder(e){this.calciteSortHandleReorder.emit({reorder:e.target.dataset.value})}handleMoveTo(e){const i=e.target.dataset.id,r=this.moveToItems.find(o=>o.id===i);this.calciteSortHandleMove.emit({moveTo:r})}handleAddTo(e){const i=e.target.dataset.id,r=this.addToItems.find(o=>o.id===i);this.calciteSortHandleAdd.emit({addTo:r})}render(){const{disabled:e,flipPlacements:i,open:r,overlayPositioning:o,placement:h,scale:d,widthScale:a,hasNoItems:v}=this,T=this.getLabel(),E=e||v;return vo({disabled:e,children:Fe`<calcite-dropdown class=${Le(EA.dropdown)} .disabled=${E} .flipPlacements=${i} @calciteDropdownBeforeClose=${this.handleBeforeClose} @calciteDropdownBeforeOpen=${this.handleBeforeOpen} @calciteDropdownClose=${this.handleClose} @calciteDropdownOpen=${this.handleOpen} .overlayPositioning=${o} .placement=${h} .scale=${d} .widthScale=${a} ${hi(this.setDropdownEl)}><calcite-action .active=${r} appearance=transparent .aria=${{expanded:r}} class=${Le(EA.handle)} .dragHandle=${!0} .icon=${e?IA.blank:IA.drag} .label=${T} .scale=${d} slot=${zX.trigger} .text=${T} title=${T??ut}></calcite-action>${this.renderReorderGroup()}${this.renderMoveToGroup()}${this.renderAddToGroup()}</calcite-dropdown>`})}renderAddToItem(e){return ai(e.id,Fe`<calcite-dropdown-item data-id=${e.id??ut} .label=${e.label} @calciteDropdownItemSelect=${this.handleAddTo}>${e.label}</calcite-dropdown-item>`)}renderMoveToItem(e){return ai(e.id,Fe`<calcite-dropdown-item data-id=${e.id??ut} .label=${e.label} @calciteDropdownItemSelect=${this.handleMoveTo}>${e.label}</calcite-dropdown-item>`)}renderReorderGroup(){return this.hasReorderItems?ai("reorder",Fe`<calcite-dropdown-group .groupTitle=${this.messages.reorder} id=${RS.reorder} .scale=${this.scale} selection-mode=none>${this.renderTop()}${this.renderUp()}${this.renderDown()}${this.renderBottom()}</calcite-dropdown-group>`):null}renderAddToGroup(){const{messages:e,addToItems:i,scale:r}=this;return i.length?ai("add-to-items",Fe`<calcite-dropdown-group .groupTitle=${e.addTo} id=${RS.add} .scale=${r} selection-mode=none>${i.map(o=>this.renderAddToItem(o))}</calcite-dropdown-group>`):null}renderMoveToGroup(){const{messages:e,moveToItems:i,scale:r}=this;return i.length?ai("move-to-items",Fe`<calcite-dropdown-group .groupTitle=${e.moveTo} id=${RS.move} .scale=${r} selection-mode=none>${i.map(o=>this.renderMoveToItem(o))}</calcite-dropdown-group>`):null}renderDropdownItem(e,i){return ai($A[e],Fe`<calcite-dropdown-item data-value=${$A[e]??ut} .label=${i} @calciteDropdownItemSelect=${this.handleReorder}>${i}</calcite-dropdown-item>`)}renderTop(){const{setPosition:e}=this;return e!==1&&e!==2?this.renderDropdownItem(0,this.messages.moveToTop):null}renderUp(){return this.setPosition!==1?this.renderDropdownItem(1,this.messages.moveUp):null}renderDown(){return this.setPosition!==this.setSize?this.renderDropdownItem(2,this.messages.moveDown):null}renderBottom(){const{setPosition:e,setSize:i}=this;return e!==i&&e!==i-1?this.renderDropdownItem(3,this.messages.moveToBottom):null}};$1.properties={disabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],label:1,messageOverrides:[0,{},{attribute:!1}],messages:[0,{},{attribute:!1}],addToItems:[0,{},{attribute:!1}],moveToItems:[0,{},{attribute:!1}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}],setPosition:[9,{},{type:Number}],setSize:[9,{},{type:Number}],sortDisabled:[7,{},{reflect:!0,type:Boolean}],widthScale:[3,{},{reflect:!0}]},$1.styles=OX;let bC=$1;lr("calcite-sort-handle",bC);/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const P$=Symbol.for(""),RX=t=>{if(t?.r===P$)return t?._$litStatic$},LX=t=>({_$litStatic$:t,r:P$}),w0=(t,...e)=>({_$litStatic$:e.reduce(((i,r,o)=>i+(h=>{if(h._$litStatic$!==void 0)return h._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${h}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(r)+t[o+1]),t[0]),r:P$}),PA=new Map,FX=t=>(e,...i)=>{const r=i.length;let o,h;const d=[],a=[];let v,T=0,E=!1;for(;T<r;){for(v=e[T];T<r&&(h=i[T],(o=RX(h))!==void 0);)v+=o+e[++T],E=!0;T!==r&&a.push(h),d.push(v),T++}if(T===r&&d.push(e[r]),E){const k=d.join("$$lit$$");(e=PA.get(k))===void 0&&(d.raw=d,PA.set(k,e=d)),i=a}return t(e,...i)},M$=FX(Fe);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const ZR=({children:t,...e})=>{const i=e.level?LX(`h${e.level}`):w0`div`;return ai(e.key,M$`<${i} class=${Le(e.class)}>${t}</${i}>`)};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const MA={arrow:"calcite-floating-ui-arrow",arrowStroke:"calcite-floating-ui-arrow__stroke"},NX={width:12,height:6,strokeWidth:1},BX=({floatingLayout:t,key:e,ref:i})=>{const{width:r,height:o,strokeWidth:h}=NX,d=r/2,a=t==="vertical",v=`M0,0 H${r} L${r-d},${o} Q${d},${o} ${d},${o} Z`;return ai(e,Fe`<svg aria-hidden=true class=${Le(MA.arrow)} height=${r} viewBox=${`0 0 ${r} ${r+(a?0:h)}`} width=${r+(a?h:0)} ${hi(i)}>${f0`${f0`<path class=${Le(MA.arrowStroke)} d=${v??ut} fill=none stroke-width=${h+1} />`||""}<path d=${v??ut} stroke=none />`}</svg>`)};/*!
* tabbable 6.3.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var WR=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],zx=WR.join(","),YR=typeof Element>"u",xd=YR?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,Ox=!YR&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t?.ownerDocument},S0=function(e,i){var r;i===void 0&&(i=!0);var o=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"inert"),h=o===""||o==="true",d=h||i&&e&&S0(e.parentNode);return d},jX=function(e){var i,r=e==null||(i=e.getAttribute)===null||i===void 0?void 0:i.call(e,"contenteditable");return r===""||r==="true"},XR=function(e,i,r){if(S0(e))return[];var o=Array.prototype.slice.apply(e.querySelectorAll(zx));return i&&xd.call(e,zx)&&o.unshift(e),o=o.filter(r),o},Rx=function(e,i,r){for(var o=[],h=Array.from(e);h.length;){var d=h.shift();if(!S0(d,!1))if(d.tagName==="SLOT"){var a=d.assignedElements(),v=a.length?a:d.children,T=Rx(v,!0,r);r.flatten?o.push.apply(o,T):o.push({scopeParent:d,candidates:T})}else{var E=xd.call(d,zx);E&&r.filter(d)&&(i||!e.includes(d))&&o.push(d);var k=d.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(d),L=!S0(k,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(d));if(k&&L){var O=Rx(k===!0?d.children:k.children,!0,r);r.flatten?o.push.apply(o,O):o.push({scopeParent:d,candidates:O})}else h.unshift.apply(h,d.children)}}return o},JR=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},Jh=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||jX(e))&&!JR(e)?0:e.tabIndex},UX=function(e,i){var r=Jh(e);return r<0&&i&&!JR(e)?0:r},VX=function(e,i){return e.tabIndex===i.tabIndex?e.documentOrder-i.documentOrder:e.tabIndex-i.tabIndex},KR=function(e){return e.tagName==="INPUT"},GX=function(e){return KR(e)&&e.type==="hidden"},qX=function(e){var i=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(r){return r.tagName==="SUMMARY"});return i},HX=function(e,i){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===i)return e[r]},ZX=function(e){if(!e.name)return!0;var i=e.form||Ox(e),r=function(a){return i.querySelectorAll('input[type="radio"][name="'+a+'"]')},o;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")o=r(window.CSS.escape(e.name));else try{o=r(e.name)}catch(d){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",d.message),!1}var h=HX(o,e.form);return!h||h===e},WX=function(e){return KR(e)&&e.type==="radio"},YX=function(e){return WX(e)&&!ZX(e)},XX=function(e){var i,r=e&&Ox(e),o=(i=r)===null||i===void 0?void 0:i.host,h=!1;if(r&&r!==e){var d,a,v;for(h=!!((d=o)!==null&&d!==void 0&&(a=d.ownerDocument)!==null&&a!==void 0&&a.contains(o)||e!=null&&(v=e.ownerDocument)!==null&&v!==void 0&&v.contains(e));!h&&o;){var T,E,k;r=Ox(o),o=(T=r)===null||T===void 0?void 0:T.host,h=!!((E=o)!==null&&E!==void 0&&(k=E.ownerDocument)!==null&&k!==void 0&&k.contains(o))}}return h},kA=function(e){var i=e.getBoundingClientRect(),r=i.width,o=i.height;return r===0&&o===0},JX=function(e,i){var r=i.displayCheck,o=i.getShadowRoot;if(r==="full-native"&&"checkVisibility"in e){var h=e.checkVisibility({checkOpacity:!1,opacityProperty:!1,contentVisibilityAuto:!0,visibilityProperty:!0,checkVisibilityCSS:!0});return!h}if(getComputedStyle(e).visibility==="hidden")return!0;var d=xd.call(e,"details>summary:first-of-type"),a=d?e.parentElement:e;if(xd.call(a,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="full-native"||r==="legacy-full"){if(typeof o=="function"){for(var v=e;e;){var T=e.parentElement,E=Ox(e);if(T&&!T.shadowRoot&&o(T)===!0)return kA(e);e.assignedSlot?e=e.assignedSlot:!T&&E!==e.ownerDocument?e=E.host:e=T}e=v}if(XX(e))return!e.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return kA(e);return!1},KX=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var i=e.parentElement;i;){if(i.tagName==="FIELDSET"&&i.disabled){for(var r=0;r<i.children.length;r++){var o=i.children.item(r);if(o.tagName==="LEGEND")return xd.call(i,"fieldset[disabled] *")?!0:!o.contains(e)}return!0}i=i.parentElement}return!1},Lx=function(e,i){return!(i.disabled||S0(i)||GX(i)||JX(i,e)||qX(i)||KX(i))},xC=function(e,i){return!(YX(i)||Jh(i)<0||!Lx(e,i))},QX=function(e){var i=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(i)||i>=0)},QR=function(e){var i=[],r=[];return e.forEach(function(o,h){var d=!!o.scopeParent,a=d?o.scopeParent:o,v=UX(a,d),T=d?QR(o.candidates):a;v===0?d?i.push.apply(i,T):i.push(a):r.push({documentOrder:h,tabIndex:v,item:o,isScope:d,content:T})}),r.sort(VX).reduce(function(o,h){return h.isScope?o.push.apply(o,h.content):o.push(h.content),o},[]).concat(i)},eJ=function(e,i){i=i||{};var r;return i.getShadowRoot?r=Rx([e],i.includeContainer,{filter:xC.bind(null,i),flatten:!1,getShadowRoot:i.getShadowRoot,shadowRootFilter:QX}):r=XR(e,i.includeContainer,xC.bind(null,i)),QR(r)},tJ=function(e,i){i=i||{};var r;return i.getShadowRoot?r=Rx([e],i.includeContainer,{filter:Lx.bind(null,i),flatten:!0,getShadowRoot:i.getShadowRoot}):r=XR(e,i.includeContainer,Lx.bind(null,i)),r},Np=function(e,i){if(i=i||{},!e)throw new Error("No node provided");return xd.call(e,zx)===!1?!1:xC(i,e)},iJ=WR.concat("iframe").join(","),LS=function(e,i){if(i=i||{},!e)throw new Error("No node provided");return xd.call(e,iJ)===!1?!1:Lx(i,e)};/*!
* focus-trap 7.6.6
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function wC(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function rJ(t){if(Array.isArray(t))return wC(t)}function nJ(t,e,i){return(e=cJ(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function sJ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function oJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AA(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,r)}return i}function DA(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?AA(Object(i),!0).forEach(function(r){nJ(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):AA(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function aJ(t){return rJ(t)||sJ(t)||uJ(t)||oJ()}function lJ(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cJ(t){var e=lJ(t,"string");return typeof e=="symbol"?e:e+""}function uJ(t,e){if(t){if(typeof t=="string")return wC(t,e);var i={}.toString.call(t).slice(8,-1);return i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set"?Array.from(t):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?wC(t,e):void 0}}var zA={activateTrap:function(e,i){if(e.length>0){var r=e[e.length-1];r!==i&&r._setPausedState(!0)}var o=e.indexOf(i);o===-1||e.splice(o,1),e.push(i)},deactivateTrap:function(e,i){var r=e.indexOf(i);r!==-1&&e.splice(r,1),e.length>0&&!e[e.length-1]._isManuallyPaused()&&e[e.length-1]._setPausedState(!1)}},hJ=function(e){return e.tagName&&e.tagName.toLowerCase()==="input"&&typeof e.select=="function"},dJ=function(e){return e?.key==="Escape"||e?.key==="Esc"||e?.keyCode===27},Ny=function(e){return e?.key==="Tab"||e?.keyCode===9},pJ=function(e){return Ny(e)&&!e.shiftKey},fJ=function(e){return Ny(e)&&e.shiftKey},OA=function(e){return setTimeout(e,0)},Xg=function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return typeof e=="function"?e.apply(void 0,r):e},L_=function(e){return e.target.shadowRoot&&typeof e.composedPath=="function"?e.composedPath()[0]:e.target},mJ=[],gJ=function(e,i){var r=i?.document||document,o=i?.trapStack||mJ,h=DA({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:pJ,isKeyBackward:fJ},i),d={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,manuallyPaused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},a,v=function(ge,De,Je){return ge&&ge[De]!==void 0?ge[De]:h[Je||De]},T=function(ge,De){var Je=typeof De?.composedPath=="function"?De.composedPath():void 0;return d.containerGroups.findIndex(function(Qe){var yt=Qe.container,Et=Qe.tabbableNodes;return yt.contains(ge)||Je?.includes(yt)||Et.find(function(Ye){return Ye===ge})})},E=function(ge){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Je=De.hasFallback,Qe=Je===void 0?!1:Je,yt=De.params,Et=yt===void 0?[]:yt,Ye=h[ge];if(typeof Ye=="function"&&(Ye=Ye.apply(void 0,aJ(Et))),Ye===!0&&(Ye=void 0),!Ye){if(Ye===void 0||Ye===!1)return Ye;throw new Error("`".concat(ge,"` was specified but was not a node, or did not return a node"))}var bt=Ye;if(typeof Ye=="string"){try{bt=r.querySelector(Ye)}catch(Dt){throw new Error("`".concat(ge,'` appears to be an invalid selector; error="').concat(Dt.message,'"'))}if(!bt&&!Qe)throw new Error("`".concat(ge,"` as selector refers to no known node"))}return bt},k=function(){var ge=E("initialFocus",{hasFallback:!0});if(ge===!1)return!1;if(ge===void 0||ge&&!LS(ge,h.tabbableOptions))if(T(r.activeElement)>=0)ge=r.activeElement;else{var De=d.tabbableGroups[0],Je=De&&De.firstTabbableNode;ge=Je||E("fallbackFocus")}else ge===null&&(ge=E("fallbackFocus"));if(!ge)throw new Error("Your focus-trap needs to have at least one focusable element");return ge},L=function(){if(d.containerGroups=d.containers.map(function(ge){var De=eJ(ge,h.tabbableOptions),Je=tJ(ge,h.tabbableOptions),Qe=De.length>0?De[0]:void 0,yt=De.length>0?De[De.length-1]:void 0,Et=Je.find(function(Dt){return Np(Dt)}),Ye=Je.slice().reverse().find(function(Dt){return Np(Dt)}),bt=!!De.find(function(Dt){return Jh(Dt)>0});return{container:ge,tabbableNodes:De,focusableNodes:Je,posTabIndexesFound:bt,firstTabbableNode:Qe,lastTabbableNode:yt,firstDomTabbableNode:Et,lastDomTabbableNode:Ye,nextTabbableNode:function(Si){var Vr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,nn=De.indexOf(Si);return nn<0?Vr?Je.slice(Je.indexOf(Si)+1).find(function(es){return Np(es)}):Je.slice(0,Je.indexOf(Si)).reverse().find(function(es){return Np(es)}):De[nn+(Vr?1:-1)]}}}),d.tabbableGroups=d.containerGroups.filter(function(ge){return ge.tabbableNodes.length>0}),d.tabbableGroups.length<=0&&!E("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(d.containerGroups.find(function(ge){return ge.posTabIndexesFound})&&d.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},O=function(ge){var De=ge.activeElement;if(De)return De.shadowRoot&&De.shadowRoot.activeElement!==null?O(De.shadowRoot):De},H=function(ge){if(ge!==!1&&ge!==O(document)){if(!ge||!ge.focus){H(k());return}ge.focus({preventScroll:!!h.preventScroll}),d.mostRecentlyFocusedNode=ge,hJ(ge)&&ge.select()}},ie=function(ge){var De=E("setReturnFocus",{params:[ge]});return De||(De===!1?!1:ge)},pe=function(ge){var De=ge.target,Je=ge.event,Qe=ge.isBackward,yt=Qe===void 0?!1:Qe;De=De||L_(Je),L();var Et=null;if(d.tabbableGroups.length>0){var Ye=T(De,Je),bt=Ye>=0?d.containerGroups[Ye]:void 0;if(Ye<0)yt?Et=d.tabbableGroups[d.tabbableGroups.length-1].lastTabbableNode:Et=d.tabbableGroups[0].firstTabbableNode;else if(yt){var Dt=d.tabbableGroups.findIndex(function(bo){var dn=bo.firstTabbableNode;return De===dn});if(Dt<0&&(bt.container===De||LS(De,h.tabbableOptions)&&!Np(De,h.tabbableOptions)&&!bt.nextTabbableNode(De,!1))&&(Dt=Ye),Dt>=0){var Si=Dt===0?d.tabbableGroups.length-1:Dt-1,Vr=d.tabbableGroups[Si];Et=Jh(De)>=0?Vr.lastTabbableNode:Vr.lastDomTabbableNode}else Ny(Je)||(Et=bt.nextTabbableNode(De,!1))}else{var nn=d.tabbableGroups.findIndex(function(bo){var dn=bo.lastTabbableNode;return De===dn});if(nn<0&&(bt.container===De||LS(De,h.tabbableOptions)&&!Np(De,h.tabbableOptions)&&!bt.nextTabbableNode(De))&&(nn=Ye),nn>=0){var es=nn===d.tabbableGroups.length-1?0:nn+1,sn=d.tabbableGroups[es];Et=Jh(De)>=0?sn.firstTabbableNode:sn.firstDomTabbableNode}else Ny(Je)||(Et=bt.nextTabbableNode(De))}}else Et=E("fallbackFocus");return Et},be=function(ge){var De=L_(ge);if(!(T(De,ge)>=0)){if(Xg(h.clickOutsideDeactivates,ge)){a.deactivate({returnFocus:h.returnFocusOnDeactivate});return}Xg(h.allowOutsideClick,ge)||ge.preventDefault()}},Ce=function(ge){var De=L_(ge),Je=T(De,ge)>=0;if(Je||De instanceof Document)Je&&(d.mostRecentlyFocusedNode=De);else{ge.stopImmediatePropagation();var Qe,yt=!0;if(d.mostRecentlyFocusedNode)if(Jh(d.mostRecentlyFocusedNode)>0){var Et=T(d.mostRecentlyFocusedNode),Ye=d.containerGroups[Et].tabbableNodes;if(Ye.length>0){var bt=Ye.findIndex(function(Dt){return Dt===d.mostRecentlyFocusedNode});bt>=0&&(h.isKeyForward(d.recentNavEvent)?bt+1<Ye.length&&(Qe=Ye[bt+1],yt=!1):bt-1>=0&&(Qe=Ye[bt-1],yt=!1))}}else d.containerGroups.some(function(Dt){return Dt.tabbableNodes.some(function(Si){return Jh(Si)>0})})||(yt=!1);else yt=!1;yt&&(Qe=pe({target:d.mostRecentlyFocusedNode,isBackward:h.isKeyBackward(d.recentNavEvent)})),H(Qe||d.mostRecentlyFocusedNode||k())}d.recentNavEvent=void 0},Pe=function(ge){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;d.recentNavEvent=ge;var Je=pe({event:ge,isBackward:De});Je&&(Ny(ge)&&ge.preventDefault(),H(Je))},Ie=function(ge){(h.isKeyForward(ge)||h.isKeyBackward(ge))&&Pe(ge,h.isKeyBackward(ge))},ke=function(ge){dJ(ge)&&Xg(h.escapeDeactivates,ge)!==!1&&(ge.preventDefault(),a.deactivate())},Ke=function(ge){var De=L_(ge);T(De,ge)>=0||Xg(h.clickOutsideDeactivates,ge)||Xg(h.allowOutsideClick,ge)||(ge.preventDefault(),ge.stopImmediatePropagation())},qe=function(){if(d.active)return zA.activateTrap(o,a),d.delayInitialFocusTimer=h.delayInitialFocus?OA(function(){H(k())}):H(k()),r.addEventListener("focusin",Ce,!0),r.addEventListener("mousedown",be,{capture:!0,passive:!1}),r.addEventListener("touchstart",be,{capture:!0,passive:!1}),r.addEventListener("click",Ke,{capture:!0,passive:!1}),r.addEventListener("keydown",Ie,{capture:!0,passive:!1}),r.addEventListener("keydown",ke),a},dt=function(){if(d.active)return r.removeEventListener("focusin",Ce,!0),r.removeEventListener("mousedown",be,!0),r.removeEventListener("touchstart",be,!0),r.removeEventListener("click",Ke,!0),r.removeEventListener("keydown",Ie,!0),r.removeEventListener("keydown",ke),a},ft=function(ge){var De=ge.some(function(Je){var Qe=Array.from(Je.removedNodes);return Qe.some(function(yt){return yt===d.mostRecentlyFocusedNode})});De&&H(k())},et=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(ft):void 0,We=function(){et&&(et.disconnect(),d.active&&!d.paused&&d.containers.map(function(ge){et.observe(ge,{subtree:!0,childList:!0})}))};return a={get active(){return d.active},get paused(){return d.paused},activate:function(ge){if(d.active)return this;var De=v(ge,"onActivate"),Je=v(ge,"onPostActivate"),Qe=v(ge,"checkCanFocusTrap");Qe||L(),d.active=!0,d.paused=!1,d.nodeFocusedBeforeActivation=O(r),De?.();var yt=function(){Qe&&L(),qe(),We(),Je?.()};return Qe?(Qe(d.containers.concat()).then(yt,yt),this):(yt(),this)},deactivate:function(ge){if(!d.active)return this;var De=DA({onDeactivate:h.onDeactivate,onPostDeactivate:h.onPostDeactivate,checkCanReturnFocus:h.checkCanReturnFocus},ge);clearTimeout(d.delayInitialFocusTimer),d.delayInitialFocusTimer=void 0,dt(),d.active=!1,d.paused=!1,We(),zA.deactivateTrap(o,a);var Je=v(De,"onDeactivate"),Qe=v(De,"onPostDeactivate"),yt=v(De,"checkCanReturnFocus"),Et=v(De,"returnFocus","returnFocusOnDeactivate");Je?.();var Ye=function(){OA(function(){Et&&H(ie(d.nodeFocusedBeforeActivation)),Qe?.()})};return Et&&yt?(yt(ie(d.nodeFocusedBeforeActivation)).then(Ye,Ye),this):(Ye(),this)},pause:function(ge){return d.active?(d.manuallyPaused=!0,this._setPausedState(!0,ge)):this},unpause:function(ge){return d.active?(d.manuallyPaused=!1,o[o.length-1]!==this?this:this._setPausedState(!1,ge)):this},updateContainerElements:function(ge){var De=[].concat(ge).filter(Boolean);return d.containers=De.map(function(Je){return typeof Je=="string"?r.querySelector(Je):Je}),d.active&&L(),We(),this}},Object.defineProperties(a,{_isManuallyPaused:{value:function(){return d.manuallyPaused}},_setPausedState:{value:function(ge,De){if(d.paused===ge)return this;if(d.paused=ge,ge){var Je=v(De,"onPause"),Qe=v(De,"onPostPause");Je?.(),dt(),We(),Qe?.()}else{var yt=v(De,"onUnpause"),Et=v(De,"onPostUnpause");yt?.(),L(),qe(),We(),Et?.()}return this}}}),a.updateContainerElements(e),a};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const mb=new WeakSet;function yJ(t,e){return mb.has(t)||y0(e),!1}function vJ(t,e){const i=e?.fallbackFocus||t,r=e?.clickOutsideDeactivates??!0;return{fallbackFocus:i,...e,document:t.ownerDocument,tabbableOptions:v$,trapStack:HZ,clickOutsideDeactivates:o=>(mb.has(t)||mb.add(t),typeof r=="function"?r(o):r),onPostDeactivate:()=>{mb.delete(t)},setReturnFocus:o=>{const h=typeof e?.setReturnFocus=="function"?e.setReturnFocus(o):e?.setReturnFocus;return h===void 0?yJ(t,o):h}}}function RA(t,{focusTrapOptions:e},i){return!e?.extraContainers&&!i?t:[t,...LA(e?.extraContainers),...LA(i)]}function LA(t=[]){return Array.isArray(t)?t:[t]}const _J=t=>g$((e,i)=>{let r,o,h;const d=t.focusTrapOptions;i.onConnected(()=>{e[t.triggerProp]&&r&&a.activate()}),i.onUpdate(v=>{e.hasUpdated&&v.has("focusTrapDisabled")&&(e.focusTrapDisabled?a.deactivate():a.activate())}),i.onDisconnected(()=>a.deactivate());const a={activate:()=>{const v=o||e.el;if(v.isConnected){if(!r){const T={...d,...e.focusTrapOptions};h||=RA(v,e),r=gJ(h,vJ(v,T))}(typeof e.focusTrapDisabledOverride=="function"?!e.focusTrapDisabledOverride():!e.focusTrapDisabled)&&r.activate()}},deactivate:()=>r?.deactivate(),overrideFocusTrapEl:v=>{if(r)throw new Error("Focus trap already created");o=v},setExtraContainers:v=>{const T=o||e.el;h=RA(T,e,v)},updateContainerElements:()=>r?.updateContainerElements(h)};return a});/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const bJ=5;function xJ({startX:t,startY:e,endX:i,endY:r}){return Math.hypot(i-t,r-e)>bJ}class wJ{constructor(){this.registeredElements=new Map,this.registeredElementCount=0,this.queryPopover=e=>{const{registeredElements:i}=this,r=e.find(o=>i.has(o));return i.get(r)},this.togglePopovers=e=>{const i=e.composedPath(),r=this.queryPopover(i);r&&!r.triggerDisabled&&(r.open=!r.open),Array.from(this.registeredElements.values()).filter(o=>o!==r&&o.autoClose&&o.open&&!i.includes(o)).forEach(o=>o.open=!1)},this.keyDownHandler=e=>{e.defaultPrevented||(e.key==="Escape"?this.closeAllPopovers():C$(e.key)&&this.togglePopovers(e))},this.pointerDownHandler=e=>{if(e.defaultPrevented||!yR(e))return;const{clientX:i,clientY:r}=e;this.pointerDownPosition={x:i,y:r}},this.clickHandler=e=>{HW(e)||e.defaultPrevented||this.pointerDownPosition&&xJ({endY:e.clientY,endX:e.clientX,startY:this.pointerDownPosition.y,startX:this.pointerDownPosition.x})||(this.pointerDownPosition=void 0,this.togglePopovers(e))}}registerElement(e,i){this.registeredElementCount++,this.registeredElements.set(e,i),this.registeredElementCount===1&&this.addListeners()}unregisterElement(e){this.registeredElements.delete(e)&&this.registeredElementCount--,this.registeredElementCount===0&&this.removeListeners()}closeAllPopovers(){Array.from(this.registeredElements.values()).forEach(e=>e.open=!1)}addListeners(){window.addEventListener("pointerdown",this.pointerDownHandler),window.addEventListener("click",this.clickHandler),window.addEventListener("keydown",this.keyDownHandler)}removeListeners(){window.removeEventListener("pointerdown",this.pointerDownHandler),window.removeEventListener("click",this.clickHandler),window.removeEventListener("keydown",this.keyDownHandler)}}const aa={positionContainer:"position-container",container:"container",closeButtonContainer:"close-button-container",closeButton:"close-button",content:"content",hasHeader:"has-header",header:"header",headerContainer:"header-container",heading:"heading"},FA="auto",NA="aria-controls",BA="aria-expanded",SJ=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{display:contents;--calcite-floating-ui-z-index: var(--calcite-popover-z-index, var(--calcite-z-index-popup))}.position-container{inline-size:max-content;display:none;max-inline-size:100vw;max-block-size:100vh;inset-block-start:0;left:0;z-index:var(--calcite-floating-ui-z-index)}@starting-style{.position-container{opacity:0;inset-block-start:0;left:0}}.position-container{max-inline-size:var(--calcite-popover-max-size-x, 100vw)}.position-container .calcite-floating-ui-anim{position:relative;transition-duration:var(--calcite-floating-ui-transition);transition-property:inset-block-start,left,opacity,display;transition-behavior:allow-discrete;opacity:0;box-shadow:0 0 16px #00000029;z-index:var(--calcite-z-index);border-radius:.25rem}.position-container[data-placement^=bottom] .calcite-floating-ui-anim{inset-block-start:-5px}.position-container[data-placement^=top] .calcite-floating-ui-anim{inset-block-start:5px}.position-container[data-placement^=left] .calcite-floating-ui-anim{left:5px}.position-container[data-placement^=right] .calcite-floating-ui-anim{left:-5px}.position-container[data-placement] .calcite-floating-ui-anim--active{opacity:1;inset-block-start:0;left:0}@starting-style{.position-container[data-placement] .calcite-floating-ui-anim--active{opacity:0}}.calcite-floating-ui-arrow{pointer-events:none;position:absolute;z-index:calc(var(--calcite-z-index) * -1);fill:var(--calcite-color-foreground-1)}.calcite-floating-ui-arrow__stroke{stroke:var(--calcite-color-border-3)}:host([scale=s]) .heading{padding:.5rem .75rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=m]) .heading{padding:.75rem 1rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([scale=l]) .heading{padding:1rem 1.25rem;font-size:var(--calcite-font-size-1);line-height:1.375}.position-container .calcite-floating-ui-anim{border-width:1px;border-style:solid;background-color:var(--calcite-popover-background-color, var(--calcite-color-foreground-1));border-color:var(--calcite-popover-border-color, var(--calcite-color-border-3));border-radius:var(--calcite-popover-corner-radius, var(--calcite-corner-radius-round))}.calcite-floating-ui-arrow{fill:var(--calcite-popover-background-color, var(--calcite-color-foreground-1))}.calcite-floating-ui-arrow__stroke{stroke:var(--calcite-popover-border-color, var(--calcite-color-border-3))}.header{display:flex;flex:1 1 auto;align-items:stretch;justify-content:flex-start;border-width:0px;border-bottom-width:1px;border-style:solid;border-block-end-color:var(--calcite-popover-border-color, var(--calcite-color-border-3))}.heading{margin:0;display:block;flex:1 1 auto;align-self:center;white-space:normal;font-weight:var(--calcite-font-weight-medium);word-wrap:break-word;word-break:break-word;color:var(--calcite-popover-text-color, var(--calcite-color-text-1))}.header-container{position:relative;display:flex;height:100%;flex-direction:row;flex-wrap:nowrap;border-radius:.25rem;color:var(--calcite-popover-text-color, var(--calcite-color-text-1))}.header-container.has-header{flex-direction:column}.content{display:flex;height:100%;width:100%;flex-direction:column;flex-wrap:nowrap;align-self:center;word-wrap:break-word;word-break:break-word}.close-button-container{display:flex;overflow:hidden;flex:0 0 auto;border-start-end-radius:var(--calcite-popover-corner-radius, var(--calcite-corner-radius-round));border-end-end-radius:var(--calcite-popover-corner-radius, var(--calcite-corner-radius-round));--calcite-action-corner-radius-start-end: var(--calcite-popover-corner-radius, var(--calcite-corner-radius-sharp));--calcite-action-corner-radius-end-end: var(--calcite-popover-corner-radius, var(--calcite-corner-radius-sharp))}::slotted(calcite-panel),::slotted(calcite-flow){height:100%}:host([hidden]){display:none}[hidden]{display:none}`,jA=new wJ,P1=class P1 extends Vi{constructor(){super(...arguments),this.focusTrap=_J({triggerProp:"open",focusTrapOptions:{allowOutsideClick:!0,escapeDeactivates:e=>(e.defaultPrevented||(this.open=!1,e.preventDefault()),!1)}})(this),this.guid=`calcite-popover-${Hu()}`,this.hasLoaded=!1,this.mutationObserver=Ho("mutation",()=>this.focusTrap.updateContainerElements()),this.transitionProp="opacity",this.messages=go(),this.focusSetter=Rs()(this),this.floatingLayout="vertical",this.autoClose=!1,this.closable=!1,this.flipDisabled=!1,this.focusTrapDisabled=!1,this.offsetDistance=yA,this.offsetSkidding=0,this.open=!1,this.overlayPositioning="absolute",this.placement=FA,this.pointerDisabled=!1,this.scale="m",this.triggerDisabled=!1,this.calcitePopoverBeforeClose=vt({cancelable:!1}),this.calcitePopoverBeforeOpen=vt({cancelable:!1}),this.calcitePopoverClose=vt({cancelable:!1}),this.calcitePopoverOpen=vt({cancelable:!1})}async reposition(e=!1){const{referenceEl:i,placement:r,overlayPositioning:o,flipDisabled:h,filteredFlipPlacements:d,offsetDistance:a,offsetSkidding:v,arrowEl:T,floatingEl:E}=this;return S$(this,{floatingEl:E,referenceEl:i,overlayPositioning:o,placement:r,flipDisabled:h,flipPlacements:d,offsetDistance:a,offsetSkidding:v,arrowEl:T,type:"popover"},e)}async setFocus(e){return this.focusSetter(()=>this.el,e)}async updateFocusTrapElements(){this.focusTrap.updateContainerElements()}connectedCallback(){super.connectedCallback(),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0}),this.setFilteredPlacements(),requestAnimationFrame(()=>this.setUpReferenceElement(this.hasLoaded))}willUpdate(e){e.has("flipPlacements")&&this.flipPlacementsHandler(),e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler(),(e.has("offsetDistance")&&(this.hasUpdated||this.offsetDistance!==yA)||e.has("offsetSkidding")&&(this.hasUpdated||this.offsetSkidding!==0)||e.has("overlayPositioning")&&(this.hasUpdated||this.overlayPositioning!=="absolute")||e.has("placement")&&(this.hasUpdated||this.placement!==FA))&&this.reposition(!0),e.has("referenceElement")&&this.referenceElementHandler()}loaded(){this.referenceElement&&!this.referenceEl&&this.setUpReferenceElement(),this.hasLoaded=!0}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.removeReferences(),cw(this)}flipPlacementsHandler(){this.setFilteredPlacements(),this.reposition(!0)}openHandler(){Q0(this),this.reposition(!0),this.setExpandedAttr()}referenceElementHandler(){this.setUpReferenceElement(),this.reposition(!0)}setFloatingEl(e){this.floatingEl=e,e&&requestAnimationFrame(()=>this.setUpReferenceElement())}setTransitionEl(e){e&&(this.transitionEl=e)}setFilteredPlacements(){const{el:e,flipPlacements:i}=this;this.filteredFlipPlacements=i?RR(i,e):null}setUpReferenceElement(e=!0){this.removeReferences(),this.referenceEl=this.getReferenceElement(),fc(this);const{el:i,referenceElement:r,referenceEl:o}=this;e&&r&&!o&&console.warn(`${i.tagName}: reference-element id "${r}" was not found.`,{el:i}),this.addReferences()}getId(){return this.el.id||this.guid}setExpandedAttr(){const{referenceEl:e,open:i}=this;e&&"setAttribute"in e&&e.setAttribute(BA,iw(i))}addReferences(){const{referenceEl:e}=this;if(!e)return;const i=this.getId();"setAttribute"in e&&e.setAttribute(NA,i),jA.registerElement(e,this.el),this.setExpandedAttr()}removeReferences(){const{referenceEl:e}=this;e&&("removeAttribute"in e&&(e.removeAttribute(NA),e.removeAttribute(BA)),jA.unregisterElement(e))}getReferenceElement(){const{referenceElement:e,el:i}=this;return(typeof e=="string"?tw(i,{id:e}):e)||null}hide(){this.open=!1}onBeforeOpen(){this.calcitePopoverBeforeOpen.emit()}onOpen(){this.calcitePopoverOpen.emit(),this.focusTrap.activate()}onBeforeClose(){this.calcitePopoverBeforeClose.emit()}onClose(){this.calcitePopoverClose.emit(),T$(this),this.focusTrap.deactivate()}storeArrowEl(e){this.arrowEl=e,this.reposition(!0)}renderCloseButton(){const{messages:e,closable:i}=this;return i?ai(aa.closeButtonContainer,Fe`<div class=${Le(aa.closeButtonContainer)}><calcite-action appearance=transparent class=${Le(aa.closeButton)} @click=${this.hide} .scale=${this.scale} .text=${e.close}><calcite-icon icon=x .scale=${Ur(this.scale)}></calcite-icon></calcite-action></div>`):null}renderHeader(){const{heading:e,headingLevel:i}=this,r=e?ZR({class:aa.heading,level:i,children:e}):null;return r?ai(aa.header,Fe`<div class=${Le(aa.header)}>${r}${this.renderCloseButton()}</div>`):null}render(){const{referenceEl:e,heading:i,label:r,open:o,pointerDisabled:h,floatingLayout:d}=this,a=e&&o,v=!a,T=h?null:ai("floating-arrow",BX({floatingLayout:d,ref:this.storeArrowEl}));return this.el.inert=v,this.el.ariaLabel=r,this.el.ariaLive="polite",Q1(this.el,"id",this.getId()),this.el.role="dialog",Fe`<div class=${Le(aa.positionContainer)} ${hi(this.setFloatingEl)}><div class=${Le({[aa.container]:!0,[nm.animation]:!0,[nm.animationActive]:a})} ${hi(this.setTransitionEl)}>${T}<div class=${Le({[aa.hasHeader]:!!i,[aa.headerContainer]:!0})}>${this.renderHeader()}<div class=${Le(aa.content)}><slot></slot></div>${i?null:this.renderCloseButton()}</div></div></div>`}};P1.properties={floatingLayout:[16,{},{state:!0}],referenceEl:[16,{},{state:!0}],autoClose:[7,{},{reflect:!0,type:Boolean}],closable:[7,{},{reflect:!0,type:Boolean}],flipDisabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],focusTrapDisabled:[7,{},{reflect:!0,type:Boolean}],focusTrapOptions:[0,{},{attribute:!1}],heading:1,headingLevel:[11,{},{type:Number,reflect:!0}],label:1,messageOverrides:[0,{},{attribute:!1}],offsetDistance:[11,{},{type:Number,reflect:!0}],offsetSkidding:[11,{},{reflect:!0,type:Number}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],pointerDisabled:[7,{},{reflect:!0,type:Boolean}],referenceElement:1,scale:[3,{},{reflect:!0}],triggerDisabled:[7,{},{reflect:!0,type:Boolean}]},P1.styles=SJ;let SC=P1;lr("calcite-popover",SC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */function UA(t,e){return(t+e)%e}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const VA={menu:"menu",defaultTrigger:"default-trigger"},FS="calcite-action-menu",NS={button:t=>`${FS}-${t}-menu-button`,menu:t=>`${FS}-${t}-menu`,action:(t,e)=>`${FS}-${t}-action-${e}`},GA={tooltip:"tooltip",trigger:"trigger"},TJ={menu:"ellipsis"};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const CJ=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;display:flex;flex-direction:column;font-size:var(--calcite-font-size-1)}::slotted(calcite-action-group:not(:last-of-type)){border-block-end-width:var(--calcite-border-width-sm)}.default-trigger{position:relative;block-size:100%;flex:0 1 auto;align-self:stretch}slot[name=trigger]::slotted(calcite-action),calcite-action::slotted([slot=trigger]){position:relative;block-size:100%;flex:0 1 auto;align-self:stretch}.menu{display:flex;max-block-size:45vh;flex-direction:column;flex-wrap:nowrap;overflow-y:auto;overflow-x:hidden;outline:2px solid transparent;outline-offset:2px;gap:var(--calcite-action-menu-items-space, 0)}:host([hidden]){display:none}[hidden]{display:none}`,EJ=["ArrowUp","ArrowDown","End","Home"],M1=class M1 extends Vi{constructor(){super(...arguments),this.guid=Hu(),this.actionElements=[],this.menuButtonClick=()=>{this.toggleOpen()},this.menuButtonId=NS.button(this.guid),this.menuButtonKeyDown=e=>{const{key:i}=e,{actionElements:r,activeMenuItemIndex:o,open:h}=this;if(r.length){if(C$(i)){if(e.preventDefault(),!h){this.toggleOpen();return}const d=r[o];d?d.click():this.toggleOpen(!1)}if(i==="Tab"){this.open=!1;return}if(i==="Escape"){this.toggleOpen(!1),e.preventDefault();return}this.handleActionNavigation(e,i,r)}},this.menuId=NS.menu(this.guid),this._open=!1,this.updateAction=(e,i)=>{const{guid:r,activeMenuItemIndex:o}=this,h=NS.action(r,i);e.tabIndex=-1,e.setAttribute("role","menuitem"),e.id||(e.id=h),e.activeDescendant=i===o},this.focusSetter=Rs()(this),this.activeMenuItemIndex=-1,this.appearance="solid",this.expanded=!1,this.overlayPositioning="absolute",this.placement="auto",this.scale="m",this.calciteActionMenuCollapse=vt({cancelable:!1}),this.calciteActionMenuExpand=vt({cancelable:!1}),this.calciteActionMenuOpen=vt({cancelable:!1})}get open(){return this._open}set open(e){const i=this._open;e!==i&&(this._open=e,this.openHandler(e))}async setFocus(e){return this.focusSetter(()=>this.menuButtonEl,e)}connectedCallback(){super.connectedCallback(),this.connectMenuButtonEl()}willUpdate(e){e.has("expanded")&&(this.hasUpdated||this.expanded!==!1)&&this.expandedHandler(),e.has("activeMenuItemIndex")&&(this.hasUpdated||this.activeMenuItemIndex!==-1)&&this.updateActions(this.actionElements),e.has("expanded")&&this.hasUpdated&&(this.expanded?this.calciteActionMenuExpand.emit():this.calciteActionMenuCollapse.emit())}disconnectedCallback(){super.disconnectedCallback(),this.disconnectMenuButtonEl()}expandedHandler(){this.open=!1,this.setTooltipReferenceElement()}openHandler(e){this.menuButtonEl&&(this.menuButtonEl.active=e,this.menuButtonEl.aria={expanded:e}),this.popoverEl&&(this.popoverEl.open=e),this.activeMenuItemIndex=this.open?0:-1,this.calciteActionMenuOpen.emit(),this.setTooltipReferenceElement()}connectMenuButtonEl(){const{menuButtonId:e,menuId:i,open:r,label:o}=this,h=this.slottedMenuButtonEl||this.defaultMenuButtonEl;this.menuButtonEl!==h&&(this.disconnectMenuButtonEl(),this.menuButtonEl=h,this.setTooltipReferenceElement(),h&&(h.active=r,h.setAttribute("aria-controls",i),h.setAttribute("aria-expanded",iw(r)),h.setAttribute("aria-haspopup","true"),h.id||(h.id=e),h.label||(h.label=o),h.text||(h.text=o),h.addEventListener("click",this.menuButtonClick),h.addEventListener("keydown",this.menuButtonKeyDown)))}disconnectMenuButtonEl(){const{menuButtonEl:e}=this;e&&(e.removeEventListener("click",this.menuButtonClick),e.removeEventListener("keydown",this.menuButtonKeyDown),this.menuButtonEl=null)}setMenuButtonEl(e){const i=e.target.assignedElements({flatten:!0}).filter(r=>r?.matches("calcite-action"));this.slottedMenuButtonEl=i[0],this.connectMenuButtonEl()}setDefaultMenuButtonEl(e){this.defaultMenuButtonEl=e,this.connectMenuButtonEl()}setPopoverEl(e){e&&(this.popoverEl=e,e.open=this.open)}handleCalciteActionClick(){this.open=!1,this.setFocus()}updateTooltip(e){const i=e.target.assignedElements({flatten:!0}).filter(r=>r?.matches("calcite-tooltip"));this.tooltipEl=i[0],this.setTooltipReferenceElement()}setTooltipReferenceElement(){const{tooltipEl:e,expanded:i,menuButtonEl:r,open:o}=this;e&&(e.referenceElement=!i&&!o?r:null)}updateActions(e){e?.forEach(this.updateAction)}async handleDefaultSlotChange(e){const i=e.target.assignedElements({flatten:!0}).reduce((r,o)=>o?.matches("calcite-action")?(r.push(o),r):o?.matches("calcite-action-group")?r.concat(Array.from(o.querySelectorAll("calcite-action"))):r,[]);await this.componentOnReady(),this.actionElements=i.filter(r=>!r.disabled&&!r.hidden)}isValidKey(e,i){return!!i.find(r=>r===e)}handleActionNavigation(e,i,r){if(!this.isValidKey(i,EJ))return;if(e.preventDefault(),!this.open){this.toggleOpen(),(i==="Home"||i==="ArrowDown")&&(this.activeMenuItemIndex=0),(i==="End"||i==="ArrowUp")&&(this.activeMenuItemIndex=r.length-1);return}i==="Home"&&(this.activeMenuItemIndex=0),i==="End"&&(this.activeMenuItemIndex=r.length-1);const o=this.activeMenuItemIndex;i==="ArrowUp"&&(this.activeMenuItemIndex=UA(Math.max(o-1,-1),r.length)),i==="ArrowDown"&&(this.activeMenuItemIndex=UA(o+1,r.length))}toggleOpen(e=!this.open){this.open=e}handlePopoverOpen(e){e.stopPropagation(),this.open=!0,this.setFocus()}handlePopoverClose(e){e.stopPropagation(),this.open=!1}renderMenuButton(){const{appearance:e,label:i,scale:r,expanded:o}=this;return Fe`<slot name=${GA.trigger} @slotchange=${this.setMenuButtonEl}><calcite-action .appearance=${e} .aria=${{expanded:o}} class=${Le(VA.defaultTrigger)} .icon=${TJ.menu} .scale=${r} .text=${i} .textEnabled=${o} ${hi(this.setDefaultMenuButtonEl)}></calcite-action></slot>`}renderMenuItems(){const{actionElements:e,activeMenuItemIndex:i,menuId:r,menuButtonEl:o,label:h,placement:d,overlayPositioning:a,flipPlacements:v}=this,E=e[i]?.id||null;return Fe`<calcite-popover auto-close .flipPlacements=${v} focus-trap-disabled .label=${h} offset-distance=0 @calcitePopoverClose=${this.handlePopoverClose} @calcitePopoverOpen=${this.handlePopoverOpen} .overlayPositioning=${a} .placement=${d} pointer-disabled .referenceElement=${o} trigger-disabled ${hi(this.setPopoverEl)}><div aria-activedescendant=${E??ut} aria-labelledby=${o?.id??ut} class=${Le(VA.menu)} id=${r??ut} @click=${this.handleCalciteActionClick} role=menu tabindex=-1><slot @slotchange=${this.handleDefaultSlotChange}></slot></div></calcite-popover>`}render(){return Fe`${this.renderMenuButton()}${this.renderMenuItems()}<slot name=${GA.tooltip} @slotchange=${this.updateTooltip}></slot>`}};M1.properties={activeMenuItemIndex:[16,{},{state:!0}],menuButtonEl:[16,{},{state:!0}],appearance:[3,{},{reflect:!0}],expanded:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],label:1,open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],placement:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}]},M1.styles=CJ;let TC=M1;lr("calcite-action-menu",TC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const eL=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host(.calcite-sortable--chosen),:host(.calcite-sortable--drag),:host(.calcite-sortable--fallback),:host(.calcite-sortable--ghost){position:relative;overflow:hidden}:host(.calcite-sortable--ghost):before{content:"";position:absolute;inset-block:0px;inset-inline-start:0px;inset-inline-end:0px;z-index:var(--calcite-z-index);box-sizing:border-box;border-width:1px;border-style:dashed;border-color:var(--calcite-color-brand);background-color:var(--calcite-color-foreground-2)}:host(.calcite-sortable--drag){--tw-shadow: 0 6px 20px -4px rgba(0, 0, 0, .1), 0 4px 12px -2px rgba(0, 0, 0, .08);--tw-shadow-colored: 0 6px 20px -4px var(--tw-shadow-color), 0 4px 12px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}`;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Ah={content:"content",toggle:"toggle",header:"header"},dr={actionsEnd:"actions-end",container:"container",content:"content",contentStart:"content-start",controlContainer:"control-container",description:"description",header:"header",headerContainer:"header-container",headerHasContent:"header--has-content",heading:"heading",icon:"icon",iconStart:"icon--start",iconEnd:"icon--end",iconEndContainer:"icon-end-container",invalid:"invalid",statusIcon:"status-icon",title:"title",toggle:"toggle",toggleIcon:"toggle-icon",valid:"valid"},Jg={actionsEnd:"actions-end",contentStart:"content-start",control:"control",headerMenuActions:"header-menu-actions",icon:"icon"},BS={expanded:"chevron-up",collapsed:"chevron-down",valid:"check-circle",invalid:"exclamation-mark-triangle"},IJ=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host{--calcite-icon-size: 1rem;--calcite-spacing-eighth: .125rem;--calcite-spacing-quarter: .25rem;--calcite-spacing-half: .5rem;--calcite-spacing-three-quarters: .75rem;--calcite-spacing: 1rem;--calcite-spacing-plus-quarter: 1.25rem;--calcite-spacing-plus-half: 1.5rem;--calcite-spacing-double: 2rem;--calcite-menu-min-width: 10rem;--calcite-header-min-height: 3rem;--calcite-footer-min-height: 3rem}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host([scale=s]) .header{gap:var(--calcite-spacing-sm)}:host([scale=s]) .header--has-content{padding:var(--calcite-spacing-sm)}:host([scale=s]) .icon-end-container{gap:var(--calcite-spacing-sm);padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .heading{font-size:var(--calcite-font-size-sm)}:host([scale=s]) .description{font-size:var(--calcite-font-size-xs)}:host([scale=s]){--calcite-internal-block-padding-block: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-xxs)) );--calcite-internal-block-padding-inline: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-sm)) )}:host([scale=m]) .header{gap:var(--calcite-spacing-md)}:host([scale=m]) .header--has-content{padding:var(--calcite-spacing-md)}:host([scale=m]) .icon-end-container{gap:var(--calcite-spacing-md);padding-inline-end:var(--calcite-spacing-md)}:host([scale=m]) .heading{font-size:var(--calcite-font-size)}:host([scale=m]) .description{font-size:var(--calcite-font-size-sm)}:host([scale=m]){--calcite-internal-block-padding-block: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-sm)) );--calcite-internal-block-padding-inline: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-md)) )}:host([scale=l]) .header{gap:var(--calcite-spacing-lg)}:host([scale=l]) .header--has-content{padding:var(--calcite-spacing-lg)}:host([scale=l]) .icon-end-container{gap:var(--calcite-spacing-lg);padding-inline-end:var(--calcite-spacing-lg)}:host([scale=l]) .heading{font-size:var(--calcite-font-size-md)}:host([scale=l]) .description{font-size:var(--calcite-font-size)}:host([scale=l]){--calcite-internal-block-padding-block: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-md)) );--calcite-internal-block-padding-inline: var( --calcite-block-content-space, var(--calcite-block-padding, var(--calcite-spacing-lg)) )}:host{display:flex;flex-shrink:0;flex-grow:0;flex-direction:column;border-width:0px;border-block-end-width:1px;border-style:solid;padding:0;transition-property:margin;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.215,.44,.42,.88);flex-basis:auto;border-color:var(--calcite-block-border-color, var(--calcite-color-border-3))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.header{margin:0;display:flex;align-content:space-between;align-items:center;fill:var(--calcite-color-text-2);color:var(--calcite-color-text-2)}.heading{margin:0;padding:0;font-weight:var(--calcite-font-weight-medium)}.header .heading{flex:1 1 auto;padding:.5rem}.header{justify-content:flex-start}.header,.toggle{grid-area:header}.header-container{display:grid;align-items:stretch;grid-template:auto/auto 1fr auto auto auto auto;grid-template-areas:"handle header icon-end control menu actions-end"}.icon--start,.icon--end{color:var(--calcite-block-icon-color, var(--calcite-color-text-3))}.actions-end{grid-area:actions-end}.toggle{margin:0;display:flex;cursor:pointer;flex-wrap:nowrap;align-items:center;justify-content:space-between;border-style:none;padding:0;font-family:var(--calcite-font-family);outline-color:transparent;text-align:initial;background-color:var(--calcite-block-header-background-color, transparent)}.toggle:hover{background-color:var(--calcite-block-header-background-color-hover, var(--calcite-color-foreground-2))}.toggle:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.toggle:active{background-color:var(--calcite-block-header-background-color-press, var(--calcite-color-foreground-3))}calcite-loader[inline]{align-self:center}calcite-sort-handle{grid-area:handle}.title{display:flex;flex-direction:column}.header .title .heading{padding:0;transition-property:color;transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.4,0,.2,1);word-wrap:break-word;word-break:break-word;color:var(--calcite-block-heading-text-color, var(--calcite-color-text-2));font-weight:var(--calcite-font-weight-medium);line-height:var(--calcite-font-line-height-relative-snug)}.description{padding:0;word-wrap:break-word;word-break:break-word;color:var(--calcite-block-description-text-color, var(--calcite-color-text-3));font-weight:var(--calcite-font-weight-regular);line-height:var(--calcite-font-line-height-relative-snug)}.icon{display:flex}.status-icon.valid{color:var(--calcite-color-status-success)}.status-icon.invalid{color:var(--calcite-color-status-danger)}@keyframes spin{0%{transform:rotate(0)}50%{transform:rotate(180deg)}to{transform:rotate(360deg)}}.icon-end-container{display:flex;align-items:center;grid-area:icon-end}.toggle-icon{align-self:center;justify-self:end;transition-property:color;transition-duration:var(--calcite-animation-timing);transition-timing-function:cubic-bezier(.4,0,.2,1);color:var(--calcite-block-icon-color, var(--calcite-color-text-3))}.toggle:hover .toggle-icon{color:var(--calcite-block-icon-color-hover, var(--calcite-color-text-1))}.container{position:relative;display:flex;block-size:100%;flex-direction:column}.content{position:relative;min-block-size:0px;flex:1 1 0%}@keyframes in{0%{opacity:0}to{opacity:1}}.content{animation:in var(--calcite-internal-animation-timing-slow) ease-in-out;padding-block:var(--calcite-internal-block-padding-block);padding-inline:var(--calcite-internal-block-padding-inline)}.content-start{display:flex;align-items:center;color:var(--calcite-block-text-color, var(--calcite-color-text-3))}.control-container{margin:0;display:flex;grid-area:control}calcite-action-menu{grid-area:menu}.actions-end{display:flex;align-items:stretch}:host([expanded]){margin-block:.5rem}:host([expanded]) .header .title .heading{color:var(--calcite-block-heading-text-color, var(--calcite-block-heading-text-color-press, var(--calcite-color-text-1)))}:host([expanded]) .description{color:var(--calcite-block-description-text-color, var(--calcite-color-text-2))}:host([expanded]) .icon--start,:host([expanded]) .icon--end{color:var(--calcite-block-icon-color, var(--calcite-color-text-1))}:host([expanded][scale=s]){margin-block:var(--calcite-spacing-xxs)}:host([expanded][scale=l]){margin-block:var(--calcite-spacing-md)}:host([hidden]){display:none}[hidden]{display:none}`,k1=class k1 extends Vi{constructor(){super(...arguments),this.transitionProp="margin-top",this.blockSectionChildren=[],this.messages=go(),this.focusSetter=Rs()(this),this.hasContentStart=!1,this.hasControl=!1,this.hasEndActions=!1,this.hasIcon=!1,this.hasMenuActions=!1,this.collapsible=!1,this.disabled=!1,this.dragDisabled=!1,this.dragHandle=!1,this.expanded=!1,this.loading=!1,this.menuPlacement=nX,this.addToItems=[],this.moveToItems=[],this.sortDisabled=!1,this.overlayPositioning="absolute",this.scale="m",this.setPosition=null,this.setSize=null,this.sortHandleOpen=!1,this.calciteInternalBlockUpdateSortMenuItems=vt({cancelable:!1}),this.calciteBlockBeforeClose=vt({cancelable:!1}),this.calciteBlockBeforeOpen=vt({cancelable:!1}),this.calciteBlockClose=vt({cancelable:!1}),this.calciteBlockCollapse=vt({cancelable:!1}),this.calciteBlockExpand=vt({cancelable:!1}),this.calciteBlockOpen=vt({cancelable:!1}),this.calciteBlockSortHandleBeforeClose=vt({cancelable:!1}),this.calciteBlockSortHandleBeforeOpen=vt({cancelable:!1}),this.calciteBlockSortHandleClose=vt({cancelable:!1}),this.calciteBlockSortHandleOpen=vt({cancelable:!1}),this.calciteBlockToggle=vt({cancelable:!1})}get open(){return this.expanded}set open(e){Ix.deprecated("property",{name:"open",removalVersion:4,suggested:"expanded"}),this.expanded=e}async setFocus(e){return this.focusSetter(()=>this.el,e)}connectedCallback(){super.connectedCallback(),this.transitionEl=this.el}load(){!this.heading&&!this.label&&Ix.warn(`${this.el.tagName} is missing both heading & label. Please provide a heading or label for the component to be accessible.`)}willUpdate(e){e.has("expanded")&&(this.hasUpdated||this.expanded!==!1)&&Q0(this),e.has("sortHandleOpen")&&(this.hasUpdated||this.sortHandleOpen!==!1)&&this.sortHandleOpenHandler(),e.has("expanded")&&this.hasUpdated&&(this.expanded?this.calciteBlockExpand.emit():this.calciteBlockCollapse.emit()),e.has("scale")&&this.hasUpdated&&this.updateBlockSectionScale()}updated(){yo(this)}onBeforeOpen(){this.calciteBlockBeforeOpen.emit()}onOpen(){this.calciteBlockOpen.emit()}onBeforeClose(){this.calciteBlockBeforeClose.emit()}onClose(){this.calciteBlockClose.emit()}sortHandleOpenHandler(){this.sortHandleEl&&(this.sortHandleEl.open=this.sortHandleOpen)}setSortHandleEl(e){this.sortHandleEl=e,this.sortHandleOpenHandler()}handleSortHandleBeforeOpen(e){e.stopPropagation(),this.calciteBlockSortHandleBeforeOpen.emit()}handleSortHandleBeforeClose(e){e.stopPropagation(),this.calciteBlockSortHandleBeforeClose.emit()}handleSortHandleClose(e){e.stopPropagation(),this.sortHandleOpen=!1,this.calciteBlockSortHandleClose.emit()}handleSortHandleOpen(e){e.stopPropagation(),this.sortHandleOpen=!0,this.calciteBlockSortHandleOpen.emit()}onHeaderClick(){this.expanded=!this.expanded,this.calciteBlockToggle.emit()}controlSlotChangeHandler(e){this.hasControl=$r(e)}menuActionsSlotChangeHandler(e){this.hasMenuActions=$r(e)}iconSlotChangeHandler(e){this.hasIcon=$r(e)}actionsEndSlotChangeHandler(e){this.hasEndActions=$r(e)}handleContentStartSlotChange(e){this.hasContentStart=$r(e)}handleDefaultSlotChange(e){this.blockSectionChildren=gR(e,"calcite-block-section"),this.updateBlockSectionScale()}updateBlockSectionScale(){this.blockSectionChildren.forEach(e=>{e.scale=this.scale})}renderScrim(){const{loading:e}=this,i=Fe`<slot @slotchange=${this.handleDefaultSlotChange}></slot>`;return[e?Fe`<calcite-scrim .loading=${e}></calcite-scrim>`:null,i]}renderLoaderStatusIcon(){const{loading:e,messages:i,status:r}=this;return e?ai("loader",Fe`<div class=${Le(dr.icon)}><calcite-loader inline .label=${i.loading} .scale=${this.scale}></calcite-loader></div>`):r?ai("status-icon",Fe`<div class=${Le(dr.icon)}><calcite-icon class=${Le({[dr.statusIcon]:!0,[dr.valid]:r=="valid",[dr.invalid]:r=="invalid"})} .icon=${BS[r]} .scale=${Ur(this.scale)}></calcite-icon></div>`):ai("icon-slot",Fe`<div class=${Le(dr.icon)} .hidden=${!this.hasIcon}>${ai("icon-slot",Fe`<slot name=${Jg.icon} @slotchange=${this.iconSlotChangeHandler}></slot>`)}</div>`)}renderActionsEnd(){return Fe`<div class=${Le(dr.actionsEnd)} .hidden=${!this.hasEndActions}><slot name=${Jg.actionsEnd} @slotchange=${this.actionsEndSlotChangeHandler}></slot></div>`}renderContentStart(){return Fe`<div class=${Le(dr.contentStart)} .hidden=${!this.hasContentStart}><slot name=${Jg.contentStart} @slotchange=${this.handleContentStartSlotChange}></slot></div>`}renderTitle(){const{heading:e,headingLevel:i,description:r}=this;return e||r?Fe`<div class=${Le(dr.title)}>${ZR({class:dr.heading,level:i,children:e})}${r?Fe`<div class=${Le(dr.description)}>${r}</div>`:null}</div>`:null}renderIcon(e){const{iconFlipRtl:i}=this,r=i==="both"||e==="start"?i==="start":i==="end",o=e==="start"?this.iconStart:this.iconEnd,h=e==="start"?dr.iconStart:dr.iconEnd;if(o)return ai(o,Fe`<calcite-icon class=${Le(h)} .flipRtl=${r} .icon=${o} .scale=${Ur(this.scale)}></calcite-icon>`)}render(){const{collapsible:e,loading:i,expanded:r,label:o,heading:h,messages:d,description:a,menuFlipPlacements:v,menuPlacement:T,moveToItems:E,addToItems:k,setPosition:L,setSize:O,dragDisabled:H,sortDisabled:ie,iconEnd:pe,hasContentStart:be,iconStart:Ce}=this,Pe=r?d.collapse:d.expand,Ie=!!(h||a||be||Ce||i||status),ke=Fe`<header class=${Le({[dr.header]:!0,[dr.headerHasContent]:Ie})} id=${Ah.header}>${this.renderIcon("start")}${this.renderContentStart()}${this.renderLoaderStatusIcon()}${this.renderTitle()}</header>`,Ke=r?BS.expanded:BS.collapsed,qe=Fe`<div class=${Le(dr.headerContainer)}>${this.dragHandle?Fe`<calcite-sort-handle .addToItems=${k} .disabled=${H} .label=${h||o} .moveToItems=${E} @calciteSortHandleBeforeClose=${this.handleSortHandleBeforeClose} @calciteSortHandleBeforeOpen=${this.handleSortHandleBeforeOpen} @calciteSortHandleClose=${this.handleSortHandleClose} @calciteSortHandleOpen=${this.handleSortHandleOpen} overlay-positioning=fixed .scale=${this.scale} .setPosition=${L} .setSize=${O} .sortDisabled=${ie} ${hi(this.setSortHandleEl)}></calcite-sort-handle>`:null}${e?Fe`<button aria-controls=${Ah.content} aria-describedby=${Ah.header} .ariaExpanded=${e?r:null} class=${Le(dr.toggle)} id=${Ah.toggle} @click=${this.onHeaderClick} title=${Pe??ut}>${ke}<div class=${Le(dr.iconEndContainer)}>${this.renderIcon("end")}<calcite-icon class=${Le(dr.toggleIcon)} .icon=${Ke} .scale=${Ur(this.scale)}></calcite-icon></div></button>`:ke}${pe&&!e?Fe`<div class=${Le(dr.iconEndContainer)}>${this.renderIcon("end")}</div>`:null}<div aria-labelledby=${Ah.header} class=${Le(dr.controlContainer)} .hidden=${!this.hasControl}><slot name=${Jg.control} @slotchange=${this.controlSlotChangeHandler}></slot></div><calcite-action-menu .flipPlacements=${v??["top","bottom"]} .hidden=${!this.hasMenuActions} .label=${d.options} .overlayPositioning=${this.overlayPositioning} .placement=${T} .scale=${this.scale}><slot name=${Jg.headerMenuActions} @slotchange=${this.menuActionsSlotChangeHandler}></slot></calcite-action-menu>${this.renderActionsEnd()}</div>`;return vo({disabled:this.disabled,children:Fe`<article aria-label=${o??ut} .ariaBusy=${i} class=${Le({[dr.container]:!0})}>${qe}<section aria-labelledby=${Ah.toggle} class=${Le(dr.content)} .hidden=${!r} id=${Ah.content}>${this.renderScrim()}</section></article>`})}};k1.properties={hasContentStart:[16,{},{state:!0}],hasControl:[16,{},{state:!0}],hasEndActions:[16,{},{state:!0}],hasIcon:[16,{},{state:!0}],hasMenuActions:[16,{},{state:!0}],collapsible:[7,{},{reflect:!0,type:Boolean}],description:1,disabled:[7,{},{reflect:!0,type:Boolean}],dragDisabled:[7,{},{reflect:!0,type:Boolean}],dragHandle:[7,{},{reflect:!0,type:Boolean}],expanded:[7,{},{reflect:!0,type:Boolean}],heading:1,headingLevel:[11,{},{type:Number,reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],loading:[7,{},{reflect:!0,type:Boolean}],label:1,menuFlipPlacements:[0,{},{attribute:!1}],menuPlacement:[3,{},{reflect:!0}],messageOverrides:[0,{},{attribute:!1}],addToItems:[0,{},{attribute:!1}],moveToItems:[0,{},{attribute:!1}],sortDisabled:[5,{},{type:Boolean}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}],setPosition:[9,{},{type:Number}],setSize:[9,{},{type:Number}],sortHandleOpen:[7,{},{reflect:!0,type:Boolean}],status:[3,{},{reflect:!0}]},k1.styles=[IJ,eL];let CC=k1;lr("calcite-block",CC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Bp={container:"container",actionsStart:"actions-start",contentStart:"content-start",content:"content",contentEnd:"content-end",actionsEnd:"actions-end"},yf={actionsStart:"actions-start",contentStart:"content-start",contentEnd:"content-end",actionsEnd:"actions-end"};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const $J=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]) .content{cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) .content *,:host([disabled]) .content ::slotted(*){pointer-events:none}:host{display:flex;flex:1 1 0%;flex-direction:column}.container{display:flex;flex:1 1 auto;align-items:stretch;font-weight:var(--calcite-font-weight-normal);color:var(--calcite-color-text-2)}.content{display:flex;flex:1 1 auto;flex-direction:column;justify-content:center;font-size:var(--calcite-font-size--2);line-height:1.375;padding-inline:var(--calcite-stack-padding-inline, .75rem);padding-block:var(--calcite-stack-padding-block, .5rem)}.content-start{justify-content:flex-start}.content-end{justify-content:flex-end}.content-start,.content-end{flex:0 1 auto}.content-start ::slotted(calcite-icon),.content-end ::slotted(calcite-icon){margin-inline:.75rem;align-self:center}.actions-start,.actions-end,.content-start,.content-end{display:flex;align-items:center}.actions-start ::slotted(calcite-action),.actions-start ::slotted(calcite-action-menu),.actions-start ::slotted(calcite-handle),.actions-start ::slotted(calcite-dropdown),.actions-end ::slotted(calcite-action),.actions-end ::slotted(calcite-action-menu),.actions-end ::slotted(calcite-handle),.actions-end ::slotted(calcite-dropdown){align-self:stretch;color:inherit}:host([hidden]){display:none}[hidden]{display:none}`,A1=class A1 extends Vi{constructor(){super(...arguments),this.hasActionsEnd=!1,this.hasActionsStart=!1,this.hasContentEnd=!1,this.hasContentStart=!1,this.disabled=!1}handleActionsStartSlotChange(e){this.hasActionsStart=$r(e)}handleActionsEndSlotChange(e){this.hasActionsEnd=$r(e)}handleContentStartSlotChange(e){this.hasContentStart=$r(e)}handleContentEndSlotChange(e){this.hasContentEnd=$r(e)}renderActionsStart(){const{hasActionsStart:e}=this;return ai("actions-start-container",Fe`<div class=${Le(Bp.actionsStart)} .hidden=${!e}><slot name=${yf.actionsStart} @slotchange=${this.handleActionsStartSlotChange}></slot></div>`)}renderActionsEnd(){const{hasActionsEnd:e}=this;return ai("actions-end-container",Fe`<div class=${Le(Bp.actionsEnd)} .hidden=${!e}><slot name=${yf.actionsEnd} @slotchange=${this.handleActionsEndSlotChange}></slot></div>`)}renderContentStart(){const{hasContentStart:e}=this;return Fe`<div class=${Le(Bp.contentStart)} .hidden=${!e}><slot name=${yf.contentStart} @slotchange=${this.handleContentStartSlotChange}></slot></div>`}renderDefaultContent(){return Fe`<div class=${Le(Bp.content)}><slot></slot></div>`}renderContentEnd(){const{hasContentEnd:e}=this;return Fe`<div class=${Le(Bp.contentEnd)} .hidden=${!e}><slot name=${yf.contentEnd} @slotchange=${this.handleContentEndSlotChange}></slot></div>`}render(){return Fe`<div class=${Le(Bp.container)}>${this.renderActionsStart()}${this.renderContentStart()}${this.renderDefaultContent()}${this.renderContentEnd()}${this.renderActionsEnd()}</div>`}};A1.properties={hasActionsEnd:[16,{},{state:!0}],hasActionsStart:[16,{},{state:!0}],hasContentEnd:[16,{},{state:!0}],hasContentStart:[16,{},{state:!0}],disabled:[7,{},{reflect:!0,type:Boolean}]},A1.styles=$J;let EC=A1;lr("calcite-stack",EC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const qA={valid:"check-circle",invalid:"exclamation-mark-triangle",idle:"information"},PJ=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;display:flex;block-size:auto;inline-size:100%;align-items:center;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-text-1);opacity:1;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;margin-block-start:var(--calcite-input-message-spacing, var(--calcite-input-message-spacing-value, var(--calcite-spacing-xxs)))}.calcite-input-message-icon{pointer-events:none;display:inline-flex;flex-shrink:0;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;margin-inline-end:var(--calcite-spacing-sm)}:host([status=invalid]) .calcite-input-message-icon{color:var(--calcite-input-message-icon-color, var(--calcite-icon-color, var(--calcite-color-status-danger)))}:host([status=valid]) .calcite-input-message-icon{color:var(--calcite-input-message-icon-color, var(--calcite-icon-color, var(--calcite-color-status-success)))}:host([status=idle]) .calcite-input-message-icon{color:var(--calcite-input-message-icon-color, var(--calcite-icon-color, var(--calcite-color-brand)))}:host([scale=s]){font-size:var(--calcite-font-size--3);line-height:.75rem}:host([scale=m]){font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=l]){font-size:var(--calcite-font-size--1);line-height:1rem}:host([hidden]){display:none}[hidden]{display:none}`,MJ={inputMessageIcon:"calcite-input-message-icon"},D1=class D1 extends Vi{constructor(){super(...arguments),this.iconFlipRtl=!1,this.scale="m",this.status="idle"}connectedCallback(){super.connectedCallback(),this.requestedIcon=tm(qA,this.icon,this.status)}willUpdate(e){(e.has("status")&&(this.hasUpdated||this.status!=="idle")||e.has("icon"))&&(this.requestedIcon=tm(qA,this.icon,this.status))}render(){const e=this.el.hidden;return Q1(this.el,"calcite-hydrated-hidden",e),Fe`${this.renderIcon(this.requestedIcon)}<slot></slot>`}renderIcon(e){if(e)return Fe`<calcite-icon class=${Le(MJ.inputMessageIcon)} .flipRtl=${this.iconFlipRtl} .icon=${e} scale=s></calcite-icon>`}};D1.properties={icon:[3,{converter:_d},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}]},D1.styles=PJ;let IC=D1;lr("calcite-input-message",IC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const kJ=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{position:relative;display:block;inline-size:100%}.track,.bar{position:absolute;inset-block-start:0px;block-size:2px}.track{z-index:var(--calcite-z-index);inline-size:100%;overflow:hidden;background-color:var(--calcite-progress-background-color, var(--calcite-color-border-3))}.bar{z-index:var(--calcite-z-index);background-color:var(--calcite-progress-fill-color, var(--calcite-color-brand))}@media (forced-colors: active){.track{background-color:highlightText}.bar{background-color:linkText}}.indeterminate{inline-size:20%;animation:looping-progress-bar-ani calc(var(--calcite-internal-animation-timing-medium) / var(--calcite-internal-duration-factor) * 11 / var(--calcite-internal-duration-factor)) linear infinite}.indeterminate.calcite--rtl{animation-name:looping-progress-bar-ani-rtl}.reversed{animation-direction:reverse}.text{padding-inline:0px;padding-block:1rem 0px;text-align:center;font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-progress-text-color, var(--calcite-color-text-2))}@keyframes looping-progress-bar-ani{0%{transform:translate3d(-100%,0,0)}50%{inline-size:40%}to{transform:translate3d(600%,0,0)}}@keyframes looping-progress-bar-ani-rtl{0%{transform:translate3d(100%,0,0)}50%{inline-size:40%}to{transform:translate3d(-600%,0,0)}}:host([hidden]){display:none}[hidden]{display:none}`,jS={track:"track",bar:"bar",text:"text"},z1=class z1 extends Vi{constructor(){super(...arguments),this.reversed=!1,this.type="determinate",this.value=0}render(){const e=this.type==="determinate",i=e?{width:`${this.value}%`}:{},r=J0(this.el);return Fe`<div .ariaLabel=${this.label||this.text} .ariaValueMax=${e?"100":void 0} .ariaValueMin=${e?"0":void 0} .ariaValueNow=${e?this.value:void 0} role=progressbar><div class=${Le(jS.track)}><div class=${Le({[jS.bar]:!0,indeterminate:this.type==="indeterminate",[JO.rtl]:r==="rtl",reversed:this.reversed})} style=${XO(i)}></div></div>${this.text?Fe`<div class=${Le(jS.text)}>${this.text}</div>`:null}</div>`}};z1.properties={label:1,reversed:[7,{},{reflect:!0,type:Boolean}],text:1,type:[3,{},{reflect:!0}],value:[9,{},{type:Number}]},z1.styles=kJ;let $C=z1;lr("calcite-progress",$C);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const tL="calciteInternalLabelClick",k$="calciteInternalLabelConnected",PC="calciteInternalLabelDisconnected",HA="calcite-label",sm=new WeakMap,By=new WeakMap,T0=new WeakMap,Fx=new WeakMap,cd=new Set,AJ=t=>{const{id:e}=t,i=e&&tw(t,{selector:`${HA}[for="${e}"]`});if(i)return i;const r=Tm(t,HA);return!r||DJ(r,t)?null:r};function DJ(t,e){let i;const r="custom-element-ancestor-check",o=d=>{d.stopImmediatePropagation();const a=d.composedPath();i=a.slice(a.indexOf(e),a.indexOf(t))};return t.addEventListener(r,o,{once:!0}),e.dispatchEvent(new CustomEvent(r,{composed:!0,bubbles:!0})),t.removeEventListener(r,o),i.filter(d=>d!==e&&d!==t).filter(d=>d.tagName?.includes("-")).length>0}function ev(t){if(!t)return;const e=AJ(t.el);if(By.has(e)&&e===t.labelEl||!e&&cd.has(t))return;const i=OJ.bind(t);if(e){t.labelEl=e;const r=sm.get(e)||[];r.push(t),sm.set(e,r.sort(iL)),By.has(t.labelEl)||(By.set(t.labelEl,ZA),t.labelEl.addEventListener(tL,ZA)),cd.delete(t),document.removeEventListener(k$,T0.get(t)),Fx.set(t,i),document.addEventListener(PC,i)}else cd.has(t)||(i(),document.removeEventListener(PC,Fx.get(t)))}function A$(t){if(!t||(cd.delete(t),document.removeEventListener(k$,T0.get(t)),document.removeEventListener(PC,Fx.get(t)),T0.delete(t),Fx.delete(t),!t.labelEl))return;const e=sm.get(t.labelEl);e.length===1&&(t.labelEl.removeEventListener(tL,By.get(t.labelEl)),By.delete(t.labelEl)),sm.set(t.labelEl,e.filter(i=>i!==t).sort(iL)),t.labelEl=null}function iL(t,e){return ZW(t.el,e.el)?-1:1}function Nx(t){return t.label||t.labelEl?.textContent?.trim()||""}function ZA(t){const e=t.detail.sourceEvent.target,i=sm.get(this),r=i.find(d=>d.el===e);if(i.includes(r))return;const h=i[0];h.disabled||h.onLabelClick(t)}function zJ(){cd.has(this)&&ev(this)}function OJ(){cd.add(this);const t=T0.get(this)||zJ.bind(this);T0.set(this,t),document.addEventListener(k$,t)}async function Tpe(t){if(await t.componentOnReady(),sm.has(t))return;const i=t.ownerDocument?.getElementById(t.for);i&&requestAnimationFrame(()=>{for(const r of cd)if(r.el===i){ev(r);break}})}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const RJ=new RegExp("\\.(0+)?$"),LJ=new RegExp("0+$"),Li=class Li{constructor(e){if(e instanceof Li)return e;const[i,r]=HJ(e).split(".").concat("");this.value=BigInt(i+r.padEnd(Li.DECIMALS,"0").slice(0,Li.DECIMALS))+BigInt(Li.ROUNDED&&r[Li.DECIMALS]>="5"),this.isNegative=e.charAt(0)==="-"}getIntegersAndDecimals(){const e=this.value.toString().replace("-","").padStart(Li.DECIMALS+1,"0"),i=e.slice(0,-Li.DECIMALS),r=e.slice(-Li.DECIMALS).replace(LJ,"");return{integers:i,decimals:r}}toString(){const{integers:e,decimals:i}=this.getIntegersAndDecimals();return`${this.isNegative?"-":""}${e}${i.length?"."+i:""}`}formatToParts(e){const{integers:i,decimals:r}=this.getIntegersAndDecimals(),o=e.numberFormatter.formatToParts(BigInt(i));return this.isNegative&&o.unshift({type:"minusSign",value:e.minusSign}),r.length&&(o.push({type:"decimal",value:e.decimal}),r.split("").forEach(h=>o.push({type:"fraction",value:h}))),o}format(e){const{integers:i,decimals:r}=this.getIntegersAndDecimals(),o=`${this.isNegative?e.minusSign:""}${e.numberFormatter.format(BigInt(i))}`,h=r.length?`${e.decimal}${r.split("").map(d=>e.numberFormatter.format(Number(d))).join("")}`:"";return`${o}${h}`}add(e){return Li.fromBigInt(this.value+new Li(e).value)}subtract(e){return Li.fromBigInt(this.value-new Li(e).value)}multiply(e){return Li._divRound(this.value*new Li(e).value,Li.SHIFT)}divide(e){return Li._divRound(this.value*Li.SHIFT,new Li(e).value)}};Li.DECIMALS=100,Li.ROUNDED=!0,Li.SHIFT=BigInt("1"+"0".repeat(Li.DECIMALS)),Li._divRound=(e,i)=>Li.fromBigInt(e/i+(Li.ROUNDED?e*BigInt(2)/i%BigInt(2):BigInt(0))),Li.fromBigInt=e=>Object.assign(Object.create(Li.prototype),{value:e,isNegative:e<BigInt(0)});let om=Li;function cc(t){return!(!t||isNaN(Number(t)))}function FJ(t){return!t||!ZJ(t)?"":Bx(t,e=>{let i=!1;const r=e.split("").filter((o,h)=>o.match(/\./g)&&!i?(i=!0,!0):o.match(/-/g)&&h===0?!0:uw.includes(o)).join("");return cc(r)?new om(r).toString():""})}const rL=/^([-0])0+(?=\d)/,NJ=/(?!^\.)\.$/,BJ=/(?!^-)-/g,jJ=/^-\b0\b\.?0*$/,UJ=/0*$/,VJ=new Set(["e","E","-",",",".",...uw]),GJ=t=>{const e=Array.from(t).filter(i=>VJ.has(i)).join("");return Bx(e,i=>{const r=i.replace(BJ,"").replace(NJ,"").replace(rL,"$1");return cc(r)?jJ.test(r)?r:qJ(r):i})};function qJ(t){const e=t.split(".")[1],i=new om(t).toString(),[r,o]=i.split(".");return e&&o!==e?`${r}.${e}`:i}function Bx(t,e){if(!t)return t;const i=t.toLowerCase().indexOf("e")+1;return i?t.replace(/[eE]*$/g,"").substring(0,i).concat(t.slice(i).replace(/[eE]/g,"")).split(/[eE]/).map((r,o)=>e(o===1?r.replace(/\./g,""):r)).join("e").replace(/^e/,"1e"):e(t)}function HJ(t){const e=t.split(/[eE]/);if(e.length===1)return t;const i=+t;if(Number.isSafeInteger(i))return`${i}`;const r=t.charAt(0)==="-",o=+e[1],h=e[0].split("."),d=(r?h[0].substring(1):h[0])||"",a=h[1]||"",v=(k,L)=>{const O=Math.abs(L)-k.length,H=O>0?`${"0".repeat(O)}${k}`:k;return`${H.slice(0,L)}.${H.slice(L)}`},T=(k,L)=>{const O=L>k.length?`${k}${"0".repeat(L-k.length)}`:k;return`${O.slice(0,L)}.${O.slice(L)}`},E=o>0?`${d}${T(a,o)}`:`${v(d,o)}${a}`;return`${r?"-":""}${E.charAt(0)==="."?"0":""}${E.replace(RJ,"").replace(rL,"")}`}function ZJ(t){return uw.some(e=>t.includes(e))}function WJ(t,e,i){const r=e.split(".")[1];if(r){const o=r.match(UJ)[0];if(o&&i.delocalize(t).length!==e.length&&r.indexOf("e")===-1){const h=i.decimal;return t=t.includes(h)?t:`${t}${h}`,t.padEnd(t.length+o.length,i.localize("0"))}}return t}const jx="en",YJ=["ar","bg","bs","ca","cs","da","de","de-AT","de-CH","el",jx,"en-AU","en-CA","en-GB","es","es-MX","et","fi","fr","fr-CH","he","hi","hr","hu","id","it","it-CH","ja","ko","lt","lv","mk","no","nl","pl","pt","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"];new Map(Object.entries({bg:{am:"..",pm:".."},bs:{am:"prijepodne",pm:"popodne"},ca:{am:"a.m.",pm:"p.m."},cs:{am:"dop.",pm:"odp."},es:{am:"a.m.",pm:"p.m."},"es-mx":{am:"a.m.",pm:"p.m."},"es-MX":{am:"a.m.",pm:"p.m."},fi:{am:"ap.",pm:"ip."},he:{am:"",pm:""},hu:{am:"de. ",pm:"du."},lt:{am:"priepiet",pm:"popiet"},lv:{am:"priekpusdien",pm:"pcpusdien"},mk:{am:".",pm:"."},no:{am:"a.m.",pm:"p.m."},nl:{am:"a.m.",pm:"p.m."},"pt-pt":{am:"da manh",pm:"da tarde"},"pt-PT":{am:"da manh",pm:"da tarde"},ro:{am:"a.m.",pm:"p.m."},sl:{am:"dop.",pm:"pop."},sv:{am:"fm",pm:"em"},th:{am:"",pm:""},tr:{am:"",pm:"S"},uk:{am:"",pm:""},vi:{am:"SA",pm:"CH"}}));const XJ=["arab","arabext","latn"],US=[...YJ],nL=t=>XJ.includes(t),VS=new Intl.NumberFormat().resolvedOptions().numberingSystem,sL=VS==="arab"||!nL(VS)?"latn":VS,JJ=t=>nL(t)?t:sL;function KJ(t){return t?US.includes(t)?t:(t=t.toLowerCase(),t.includes("-")&&(t=t.replace(/(\w+)-(\w+)/,(e,i,r)=>`${i}-${r.toUpperCase()}`),US.includes(t)||(t=t.split("-")[0])),t==="nb"||t==="nn"?"no":t==="zh"?"zh-CN":US.includes(t)?t:(console.warn(`Translations for the "${t}" locale are not available and will fall back to the default, English (en).`),jx)):jx}class QJ{constructor(){this.delocalize=e=>this._numberFormatOptions?Bx(e,i=>i.replace(new RegExp(`[${this._minusSign}]`,"g"),"-").replace(new RegExp(`[${this._group}]`,"g"),"").replace(new RegExp(`[${this._decimal}]`,"g"),".").replace(new RegExp(`[${this._digits.join("")}]`,"g"),this._getDigitIndex)):e,this.localize=e=>this._numberFormatOptions?Bx(e,i=>cc(i.trim())?new om(i.trim()).format(this).replace(new RegExp(`[${this._actualGroup}]`,"g"),this._group):i):e}get group(){return this._group}get decimal(){return this._decimal}get minusSign(){return this._minusSign}get digits(){return this._digits}get numberFormatter(){return this._numberFormatter}get numberFormatOptions(){return this._numberFormatOptions}set numberFormatOptions(e){if(e.locale=KJ(e?.locale),e.numberingSystem=JJ(e?.numberingSystem),!this._numberFormatOptions&&e.locale===jx&&e.numberingSystem===sL&&Object.keys(e).length===2||JSON.stringify(this._numberFormatOptions)===JSON.stringify(e))return;this._numberFormatOptions=e,this._numberFormatter=new Intl.NumberFormat(this._numberFormatOptions.locale,this._numberFormatOptions),this._digits=[...new Intl.NumberFormat(this._numberFormatOptions.locale,{useGrouping:!1,numberingSystem:this._numberFormatOptions.numberingSystem}).format(9876543210)].reverse();const i=new Map(this._digits.map((o,h)=>[o,h])),r=new Intl.NumberFormat(this._numberFormatOptions.locale,{numberingSystem:this._numberFormatOptions.numberingSystem}).formatToParts(-123456789e-1);this._actualGroup=r.find(o=>o.type==="group").value,this._group=this._actualGroup.trim().length===0||this._actualGroup==" "?"":this._actualGroup,this._decimal=e.locale==="bs"||e.locale==="mk"?",":r.find(o=>o.type==="decimal").value,this._minusSign=r.find(o=>o.type==="minusSign").value,this._getDigitIndex=o=>i.get(o)}}const Oo=new QJ;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const ru={alignmentCenter:"internal-label-alignment--center",alignmentEnd:"internal-label-alignment--end",container:"internal-label--container",requiredIndicator:"internal-label-required--indicator",spacingBottom:"internal-label-spacing--bottom",spacingInlineEnd:"internal-label-spacing-inline--end",spacingInlineStart:"internal-label-spacing-inline--start",text:"internal-label--text"},oL=({alignmentCenter:t,bottomSpacingDisabled:e,labelText:i,onClick:r,required:o,spacingInlineEnd:h,spacingInlineStart:d,tooltipText:a})=>Fe`<div class=${Le({[ru.alignmentCenter]:t,[ru.alignmentEnd]:!t,[ru.container]:!0,[ru.spacingBottom]:!e,[ru.spacingInlineEnd]:h,[ru.spacingInlineStart]:d})} @click=${r}><div class=${Le(ru.text)}>${i}${o&&Fe`<span aria-hidden=true class=${Le(ru.requiredIndicator)} title=${a??ut}>*</span>`||""}</div><slot name=label-content></slot></div>`;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const eK={validationContainer:"validation-container"},tK=()=>{},aL=({scale:t,status:e,id:i,icon:r,message:o,ref:h})=>Fe`<div class=${Le(eK.validationContainer)} ${hi(h||tK)}><calcite-input-message aria-live=polite .icon=${r} id=${i??ut} .scale=${t} .status=${e}>${o}</calcite-input-message></div>`;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const iK=["date","datetime-local","month","number","range","time","week"],rK=["email","password","search","tel","text","url"],nK=["email","password","search","tel","text","textarea","url"];function jp(t,e,i,r){const o=i.toLowerCase(),h=t[i];r&&h!=null?e.setAttribute(o,`${h}`):e.removeAttribute(o)}function sK(t,e,i){i.type=t==="textarea"?"text":t;const r=iK.includes(t),o=e;jp(o,i,"min",r),jp(o,i,"max",r),jp(o,i,"step",r);const h=nK.includes(t),d=e;jp(d,i,"minLength",h),jp(d,i,"maxLength",h);const a=rK.includes(t);jp(d,i,"pattern",a)}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Mn={loader:"loader",clearButton:"clear-button",editingEnabled:"editing-enabled",inlineChild:"inline-child",inputIcon:"icon",prefix:"prefix",suffix:"suffix",numberButtonWrapper:"number-button-wrapper",buttonItemHorizontal:"number-button-item--horizontal",wrapper:"element-wrapper",inputWrapper:"wrapper",actionWrapper:"action-wrapper",numberButtonItem:"number-button-item",hasSuffix:"has-suffix",hasPrefix:"has-prefix"},GS={validationMessage:"inputValidationMessage"},WA={tel:"phone",password:"lock",email:"email-address",date:"calendar",time:"clock",search:"search"},oK={action:"action"},YA={up:"up",down:"down"},qS={chevronUp:"chevron-up",chevronDown:"chevron-down",close:"x"},aK=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}:host([scale=s]) input,:host([scale=s]) .prefix,:host([scale=s]) .suffix{block-size:1.5rem;padding-inline:.5rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) input[type=file],:host([scale=s]) textarea{min-block-size:1.5rem}:host([scale=s]) .number-button-wrapper,:host([scale=s]) .action-wrapper{block-size:1.5rem}:host([scale=s]) .clear-button{min-block-size:1.5rem;min-inline-size:1.5rem}:host([scale=s]) textarea{block-size:auto;padding-block:.25rem;padding-inline:.5rem;font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=m]) input,:host([scale=m]) .prefix,:host([scale=m]) .suffix{block-size:2rem;padding-inline:.75rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) textarea,:host([scale=m]) input[type=file]{min-block-size:2rem}:host([scale=m]) .number-button-wrapper,:host([scale=m]) .action-wrapper{block-size:2rem}:host([scale=m]) .clear-button{min-block-size:2rem;min-inline-size:2rem}:host([scale=m]) textarea{block-size:auto;padding-block:.5rem;padding-inline:.75rem;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=l]) input,:host([scale=l]) .prefix,:host([scale=l]) .suffix{block-size:2.75rem;padding-inline:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) textarea,:host([scale=l]) input[type=file]{min-block-size:2.75rem}:host([scale=l]) .number-button-wrapper,:host([scale=l]) .action-wrapper{block-size:2.75rem}:host([scale=l]) .clear-button{min-block-size:2.75rem;min-inline-size:2.75rem}:host([scale=l]) textarea{block-size:auto;padding-block:.75rem;padding-inline:1rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([disabled]) textarea{resize:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}textarea,input{position:relative;margin:0;box-sizing:border-box;display:flex;max-block-size:100%;inline-size:100%;max-inline-size:100%;flex:1 1 0%;text-overflow:ellipsis;border-width:1px;border-style:solid;font-family:inherit;font-weight:var(--calcite-font-weight-normal);border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-background-color, var(--calcite-color-foreground-1));color:var(--calcite-input-text-color, var(--calcite-color-text-1));transition:var(--calcite-animation-timing),block-size 0,outline-offset 0s;-webkit-appearance:none}textarea:placeholder-shown,input:placeholder-shown{text-overflow:ellipsis}textarea{border-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}input{border-start-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}.has-prefix input{border-start-start-radius:0;border-end-start-radius:0}.has-suffix input,.element-wrapper:has(.clear-button) input,:host([number-button-type=vertical][type=number]) input,:host([number-button-type=horizontal]) .has-suffix .suffix,:host([number-button-type=vertical][type=number]) .has-suffix .suffix,:host([number-button-type=vertical][type=number]) .clear-button,:host([number-button-type=horizontal][type=number]) .clear-button{border-start-end-radius:0;border-end-end-radius:0}:host([number-button-type=horizontal]) input{border-start-start-radius:0;border-start-end-radius:0;border-end-start-radius:0;border-end-end-radius:0}.has-prefix .prefix:first-child,:host([number-button-type=horizontal]) .number-button-item[data-adjustment=down]{border-start-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-end-start-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}.has-suffix .suffix,:host([number-button-type=vertical][type=number][read-only]) .has-suffix .suffix,:host([clearable]) .clear-button,:host([number-button-type=horizontal]) .number-button-item[data-adjustment=up]{border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}:host([clearable]) .has-suffix .clear-button{border-end-end-radius:0;border-start-end-radius:0}:host([number-button-type=vertical]) .number-button-item[data-adjustment=down]{border-block-start-width:0px;border-end-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}:host([number-button-type=vertical]) .number-button-item[data-adjustment=up]{border-start-end-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp))}input[type=search]::-webkit-search-decoration{-webkit-appearance:none}input:focus,textarea:focus{border-color:var(--calcite-color-brand);color:var(--calcite-input-text-color, var(--calcite-color-text-1))}input[readonly],textarea[readonly]{font-weight:var(--calcite-font-weight-medium);background-color:var(--calcite-input-background-color, var(--calcite-color-background))}input[readonly]:focus,textarea[readonly]:focus{color:var(--calcite-input-text-color, var(--calcite-color-text-1))}textarea,input{outline-color:transparent}textarea:focus,input:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([status=invalid]) input,:host([status=invalid]) textarea{border-color:var(--calcite-color-status-danger)}:host([status=invalid]) input:focus,:host([status=invalid]) textarea:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-status-danger);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host([scale=s]) .icon{inset-inline-start:.5rem}:host([scale=m]) .icon{inset-inline-start:.75rem}:host([scale=l]) .icon{inset-inline-start:1rem}:host([icon][scale=s]) input{padding-inline-start:2rem}:host([icon][scale=m]) input{padding-inline-start:2.5rem}:host([icon][scale=l]) input{padding-inline-start:3.5rem}.element-wrapper{position:relative;order:3;display:inline-flex;flex:1 1 0%;align-items:center;isolation:isolate}.icon{pointer-events:none;position:absolute;display:block;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-icon-color, var(--calcite-color-text-3));z-index:var(--calcite-z-index)}input[type=text]::-ms-clear,input[type=text]::-ms-reveal{display:none;block-size:0px;inline-size:0px}input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration,input[type=date]::-webkit-clear-button,input[type=time]::-webkit-clear-button{display:none}.clear-button{pointer-events:initial;order:4;margin:0;box-sizing:border-box;display:flex;min-block-size:100%;cursor:pointer;align-items:center;justify-content:center;align-self:stretch;border-width:1px;border-style:solid;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;outline-color:transparent;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-actions-background-color, var(--calcite-color-foreground-1));border-inline-start-width:0px}.clear-button calcite-icon{transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-actions-icon-color, var(--calcite-color-text-3))}.clear-button:hover{background-color:var(--calcite-input-actions-background-color-hover, var(--calcite-color-foreground-2))}.clear-button:hover calcite-icon{color:var(--calcite-input-actions-icon-color-hover, var(--calcite-color-text-1))}.clear-button:active{background-color:var(--calcite-input-actions-background-color-press, var(--calcite-color-foreground-3))}.clear-button:active calcite-icon{color:var(--calcite-input-actions-icon-color-press, var(--calcite-color-text-1))}.clear-button:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.clear-button:disabled{opacity:var(--calcite-opacity-disabled)}.loader{inset-block-start:1px;inset-inline:1px;pointer-events:none;position:absolute;display:block;--calcite-progress-background-color: var(--calcite-input-loading-background-color);--calcite-progress-fill-color: var(--calcite-input-loading-fill-color)}.action-wrapper{order:7;display:flex}.prefix,.suffix{box-sizing:border-box;display:flex;block-size:auto;min-block-size:100%;-webkit-user-select:none;user-select:none;align-content:center;align-items:center;overflow-wrap:break-word;border-width:1px;border-style:solid;font-weight:var(--calcite-font-weight-medium);line-height:1;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input))}.prefix{order:2;border-inline-end-width:0px;inline-size:var(--calcite-input-prefix-size, auto);background-color:var(--calcite-input-prefix-background-color, var(--calcite-color-background));color:var(--calcite-input-prefix-text-color, var(--calcite-color-text-2))}.suffix{order:5;border-inline-start-width:0px;inline-size:var(--calcite-input-suffix-size, auto);background-color:var(--calcite-input-suffix-background-color, var(--calcite-color-background));color:var(--calcite-input-suffix-text-color, var(--calcite-color-text-2))}:host([alignment=start]) textarea,:host([alignment=start]) input{text-align:start}:host([alignment=end]) textarea,:host([alignment=end]) input{text-align:end}input[type=number]{-moz-appearance:textfield}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;-moz-appearance:textfield;margin:0}.number-button-wrapper{pointer-events:none;order:6;box-sizing:border-box;display:flex;flex-direction:column;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out}:host([number-button-type=vertical]) .wrapper{flex-direction:row;display:flex}:host([number-button-type=vertical]) input,:host([number-button-type=vertical]) textarea{order:2}:host([number-button-type=horizontal]) .calcite--rtl .number-button-item[data-adjustment=down] calcite-icon{transform:rotate(-90deg)}:host([number-button-type=horizontal]) .calcite--rtl .number-button-item[data-adjustment=up] calcite-icon{transform:rotate(-90deg)}.number-button-item.number-button-item--horizontal{border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));order:1;max-block-size:100%;min-block-size:100%;align-self:stretch;border-width:1px;border-style:solid}.number-button-item.number-button-item--horizontal[data-adjustment=down] calcite-icon,.number-button-item.number-button-item--horizontal[data-adjustment=up] calcite-icon{transform:rotate(90deg)}.number-button-item.number-button-item--horizontal[data-adjustment=down]{border-inline-end-width:0px}.number-button-item.number-button-item--horizontal[data-adjustment=up]{border-inline-start-width:0px;order:5}.number-button-item{max-block-size:50%;min-block-size:50%;pointer-events:initial;margin:0;box-sizing:border-box;display:flex;cursor:pointer;align-items:center;align-self:center;border-width:1px;border-style:solid;background-color:var(--calcite-color-foreground-1);padding-block:0px;padding-inline:.5rem;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));background-color:var(--calcite-input-actions-background-color, var(--calcite-color-foreground-1));border-inline-start-width:0px}.number-button-item calcite-icon{pointer-events:none;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;color:var(--calcite-input-actions-icon-color, var(--calcite-color-text-3))}.number-button-item:hover{background-color:var(--calcite-input-actions-background-color-hover, var(--calcite-color-foreground-2))}.number-button-item:hover calcite-icon{color:var(--calcite-input-actions-icon-color-hover, var(--calcite-color-text-1))}.number-button-item:active{background-color:var(--calcite-input-actions-background-color-press, var(--calcite-color-foreground-3))}.number-button-item:active calcite-icon{color:var(--calcite-input-actions-icon-color-press, var(--calcite-color-text-1))}.number-button-item:disabled{pointer-events:none}.wrapper{position:relative;display:flex;flex-direction:row;align-items:center;border-radius:var(--calcite-input-corner-radius, var(--calcite-corner-radius-sharp));box-shadow:var(--calcite-input-shadow, var(--calcite-shadow-none))}input[type=date]::-webkit-input-placeholder{visibility:hidden!important}:host([type=color]) input{padding:.25rem}:host([type=file]) input{cursor:pointer;border-width:1px;border-style:dashed;background-color:var(--calcite-color-foreground-1);text-align:center;border-color:var(--calcite-input-border-color, var(--calcite-color-border-input));block-size:initial}:host([type=file][scale=s]) input{padding-block:1px;padding-inline:.5rem}:host([type=file][scale=m]) input{padding-block:.25rem;padding-inline:.75rem}:host([type=file][scale=l]) input{padding-block:.5rem;padding-inline:1rem}:host(.no-bottom-border) input{border-block-end-width:0px}:host(.border-top-color-one) input{border-block-start-color:var(--calcite-color-border-1)}input.inline-child{background-color:transparent;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out}input.inline-child .editing-enabled{background-color:inherit}input.inline-child:not(.editing-enabled){display:flex;cursor:pointer;text-overflow:ellipsis;border-color:transparent;padding-inline-start:0}:host([type=datetime-local]) .element-wrapper{inline-size:100%}:host([type=datetime-local]) .element-wrapper input{display:inline-block;min-inline-size:0}.internal-label-alignment--center{align-items:center}.internal-label-alignment--end{align-items:end}.internal-label--container{display:flex;justify-content:space-between;color:var(--calcite-color-text-1)}.internal-label-required--indicator{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-status-danger);padding-inline:var(--calcite-spacing-base)}.internal-label-required--indicator:hover{cursor:help}.internal-label--text{line-height:1}:host([scale=s]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-xxs)}:host([scale=s]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label--text{font-size:var(--calcite-font-size--2)}:host([scale=m]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label--text{font-size:var(--calcite-font-size--1)}:host([scale=l]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=l]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-md)}:host([scale=l]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-md)}:host([scale=l]) .internal-label--text{font-size:var(--calcite-font-size-0)}.validation-container{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch}:host([scale=m]) .validation-container,:host([scale=l]) .validation-container{padding-block-start:.5rem}:host([scale=s]) .validation-container{padding-block-start:.25rem}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}::placeholder{font-weight:var(--calcite-font-weight-normal);color:var(--calcite-input-placeholder-text-color, var(--calcite-color-text-3))}`,O1=class O1 extends Vi{constructor(){super(),this.actionWrapperRef=Xn(),this.attributeWatch=y$(["autofocus","enterkeyhint","inputmode","spellcheck"],this.handleGlobalAttributesChanged),this.childRef=Xn(),this.childElType="input",this.childNumberRef=Xn(),this.inputWrapperRef=Xn(),this.onHiddenFormInputInput=e=>{e.target.name===this.name&&this.setValue({value:e.target.value,origin:"direct"}),this.setFocus(),e.stopPropagation()},this.previousValueOrigin="initial",this.userChangedValue=!1,this._value="",this.messages=go(),this.focusSetter=Rs()(this),this.slottedActionElDisabledInternally=!1,this.alignment="start",this.clearable=!1,this.disabled=!1,this.editingEnabled=!1,this.groupSeparator=!1,this.iconFlipRtl=!1,this.loading=!1,this.localeFormat=!1,this.multiple=!1,this.numberButtonType="vertical",this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.type="text",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.calciteInputChange=vt({cancelable:!1}),this.calciteInputInput=vt(),this.calciteInternalInputBlur=vt({cancelable:!1}),this.calciteInternalInputFocus=vt({cancelable:!1}),this.listen("click",this.clickHandler),this.listen("keydown",this.keyDownHandler)}get value(){return this._value}set value(e){const i=this._value;e!==i&&(this._value=e,this.valueWatcher(e,i),e&&this._value===""&&this.setValue({origin:"reset",value:i}))}async selectText(){(this.type==="number"?this.childNumberRef:this.childRef).value?.select()}async setFocus(e){return this.focusSetter(()=>this.type==="number"?this.childNumberRef.value:this.childRef.value,e)}connectedCallback(){super.connectedCallback(),this.inlineEditableEl=this.el.closest("calcite-inline-editable"),this.inlineEditableEl&&(this.editingEnabled=this.inlineEditableEl.editingEnabled||!1),ev(this),VR(this),this.el.addEventListener(gC,this.onHiddenFormInputInput)}async load(){this.childElType=this.type==="textarea"?"textarea":"input",this.maxString=this.max?.toString(),this.minString=this.min?.toString(),this.requestedIcon=tm(WA,this.icon,this.type),this.setPreviousEmittedValue(this.value),this.setPreviousValue(this.value),this.type==="number"&&(this.value==="Infinity"||this.value==="-Infinity"?(this.displayedValue=this.value,this.previousEmittedValue=this.value):(this.warnAboutInvalidNumberValue(this.value),this.setValue({origin:"connected",value:cc(this.value)?this.value:""})))}willUpdate(e){e.has("max")&&(this.maxString=this.max?.toString()||null),e.has("min")&&(this.minString=this.min?.toString()||null),(e.has("icon")||e.has("type")&&(this.hasUpdated||this.type!=="text"))&&(this.requestedIcon=tm(WA,this.icon,this.type))}updated(){yo(this)}disconnectedCallback(){super.disconnectedCallback(),A$(this),GR(this),this.el.removeEventListener(gC,this.onHiddenFormInputInput)}get isClearable(){return!this.isTextarea&&(this.clearable||this.type==="search")&&this.value?.length>0}get isTextarea(){return this.childElType==="textarea"}handleGlobalAttributesChanged(){this.requestUpdate()}valueWatcher(e,i){if(!this.userChangedValue){if(this.type==="number"&&(e==="Infinity"||e==="-Infinity")){this.displayedValue=e,this.previousEmittedValue=e;return}this.setValue({origin:"direct",previousValue:i,value:e==null||e==""?"":this.type==="number"?cc(e)?e:this.previousValue||"":e}),this.warnAboutInvalidNumberValue(e)}this.userChangedValue=!1}keyDownHandler(e){this.readOnly||this.disabled||e.defaultPrevented||(this.isClearable&&e.key==="Escape"&&(this.clearInputValue(e),e.preventDefault()),e.key==="Enter"&&hw(this)&&e.preventDefault())}onLabelClick(){this.setFocus()}incrementOrDecrementNumberValue(e,i,r,o){const{value:h}=this;if(h==="Infinity"||h==="-Infinity")return;const d=e==="up"?1:-1,a=this.step==="any"?1:Math.abs(this.step||1),T=new om(h!==""?h:"0").add(`${a*d}`),E=()=>typeof r=="number"&&!isNaN(r)&&T.subtract(`${r}`).isNegative,k=()=>typeof i=="number"&&!isNaN(i)&&!T.subtract(`${i}`).isNegative,L=E()?`${r}`:k()?`${i}`:T.toString();this.setValue({committing:!0,nativeEvent:o,origin:"user",value:L})}clearInputValue(e){this.setValue({committing:!0,nativeEvent:e,origin:"user",value:""})}emitChangeIfUserModified(){this.previousValueOrigin==="user"&&this.value!==this.previousEmittedValue&&(this.calciteInputChange.emit(),this.setPreviousEmittedValue(this.value))}inputBlurHandler(){window.clearInterval(this.nudgeNumberValueIntervalId),this.calciteInternalInputBlur.emit(),this.emitChangeIfUserModified()}clickHandler(e){if(this.disabled)return;const i=e.composedPath();!i.includes(this.inputWrapperRef.value)||i.includes(this.actionWrapperRef.value)||this.setFocus()}inputFocusHandler(){this.calciteInternalInputFocus.emit()}inputInputHandler(e){this.disabled||this.readOnly||(this.type==="file"&&(this.files=this.childRef.value.files),this.setValue({nativeEvent:e,origin:"user",value:e.target.value}))}inputKeyDownHandler(e){this.disabled||this.readOnly||e.key==="Enter"&&this.emitChangeIfUserModified()}inputNumberInputHandler(e){if(this.disabled||this.readOnly||this.value==="Infinity"||this.value==="-Infinity")return;const i=e.target.value;Oo.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator};const r=Oo.delocalize(i);e.inputType==="insertFromPaste"?(cc(r)||e.preventDefault(),this.setValue({nativeEvent:e,origin:"user",value:FJ(r)}),this.childNumberRef.value.value=this.displayedValue):this.setValue({nativeEvent:e,origin:"user",value:r})}inputNumberKeyDownHandler(e){if(this.type!=="number"||this.disabled||this.readOnly)return;if(this.value==="Infinity"||this.value==="-Infinity"){e.preventDefault(),(e.key==="Backspace"||e.key==="Delete")&&this.clearInputValue(e);return}if(e.key==="ArrowUp"){e.preventDefault(),this.nudgeNumberValue("up",e);return}if(e.key==="ArrowDown"){this.nudgeNumberValue("down",e);return}const i=[...uw,"ArrowLeft","ArrowRight","Backspace","Delete","Enter","Escape","Tab"];if(e.altKey||e.ctrlKey||e.metaKey)return;const r=e.shiftKey&&e.key==="Tab";if(i.includes(e.key)||r){e.key==="Enter"&&this.emitChangeIfUserModified();return}Oo.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator},!(e.key===Oo.decimal&&(!this.value&&!this.childNumberRef.value.value||this.value&&this.childNumberRef.value.value.indexOf(Oo.decimal)===-1))&&(/[eE]/.test(e.key)&&(!this.value&&!this.childNumberRef.value.value||this.value&&!/[eE]/.test(this.childNumberRef.value.value))||e.key==="-"&&(!this.value&&!this.childNumberRef.value.value||this.value&&this.childNumberRef.value.value.split("-").length<=2)||e.preventDefault())}nudgeNumberValue(e,i){if(i instanceof KeyboardEvent&&i.repeat||this.type!=="number")return;const r=this.maxString?parseFloat(this.maxString):null,o=this.minString?parseFloat(this.minString):null,h=150;this.incrementOrDecrementNumberValue(e,r,o,i),this.nudgeNumberValueIntervalId&&window.clearInterval(this.nudgeNumberValueIntervalId);let d=!0;this.nudgeNumberValueIntervalId=window.setInterval(()=>{if(d){d=!1;return}this.incrementOrDecrementNumberValue(e,r,o,i)},h)}numberButtonPointerUpAndOutHandler(){window.clearInterval(this.nudgeNumberValueIntervalId)}numberButtonPointerDownHandler(e){if(!yR(e))return;e.preventDefault();const i=e.target.dataset.adjustment;this.disabled||this.nudgeNumberValue(i,e)}syncHiddenFormInput(e){sK(this.type,this,e)}setInputValue(e){const i=this.type==="number"?this.childNumberRef:this.childRef;i.value&&(i.value.value=e)}setPreviousEmittedValue(e){this.previousEmittedValue=this.normalizeValue(e)}normalizeValue(e){return this.type==="number"?cc(e)?e:"":e}setPreviousValue(e){this.previousValue=this.normalizeValue(e)}setValue({committing:e=!1,nativeEvent:i,origin:r,previousValue:o,value:h}){if(this.setPreviousValue(o??this.value),this.previousValueOrigin=r,this.type==="number"){Oo.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator,signDisplay:"never"};const d=this.previousValue?.length>h.length||this.value?.length>h.length,a=h.charAt(h.length-1)===".",v=a&&d?h:GJ(h),T=h&&!v?cc(this.previousValue)?this.previousValue:"":v;let E=Oo.localize(T);r!=="connected"&&!a&&(E=WJ(E,T,Oo)),this.displayedValue=a&&d?`${E}${Oo.decimal}`:E,this.userChangedValue=r==="user"&&this.value!==T,this.value=["-","."].includes(T)?"":T}else this.userChangedValue=r==="user"&&this.value!==h,this.value=h;r==="direct"&&(this.setInputValue(h),this.previousEmittedValue=h),i&&(this.calciteInputInput.emit().defaultPrevented?(this.value=this.previousValue,this.displayedValue=this.type==="number"?Oo.localize(this.previousValue):this.previousValue):e&&this.emitChangeIfUserModified())}inputKeyUpHandler(){window.clearInterval(this.nudgeNumberValueIntervalId)}warnAboutInvalidNumberValue(e){this.type==="number"&&e&&!cc(e)&&console.warn(`The specified value "${e}" cannot be parsed, or is out of range.`)}render(){const e=J0(this.el),i=Fe`<div class=${Le(Mn.loader)}><calcite-progress .label=${this.messages.loading} type=indeterminate></calcite-progress></div>`,r=Fe`<button .ariaLabel=${this.messages.clear} class=${Le(Mn.clearButton)} .disabled=${this.disabled||this.readOnly} @click=${this.clearInputValue} tabindex=-1 title=${this.messages.clear??ut} type=button><calcite-icon .icon=${qS.close} .scale=${Ur(this.scale)}></calcite-icon></button>`,o=Fe`<calcite-icon class=${Le(Mn.inputIcon)} .flipRtl=${this.iconFlipRtl} .icon=${this.requestedIcon} .scale=${Ur(this.scale)}></calcite-icon>`,h=this.numberButtonType==="horizontal",d=Fe`<button aria-hidden=true class=${Le({[Mn.numberButtonItem]:!0,[Mn.buttonItemHorizontal]:h})} data-adjustment=${YA.up} .disabled=${this.disabled||this.readOnly} @pointerdown=${this.numberButtonPointerDownHandler} @pointerout=${this.numberButtonPointerUpAndOutHandler} @pointerup=${this.numberButtonPointerUpAndOutHandler} tabindex=-1 type=button><calcite-icon .icon=${qS.chevronUp} .scale=${Ur(this.scale)}></calcite-icon></button>`,a=Fe`<button aria-hidden=true class=${Le({[Mn.numberButtonItem]:!0,[Mn.buttonItemHorizontal]:h})} data-adjustment=${YA.down} .disabled=${this.disabled||this.readOnly} @pointerdown=${this.numberButtonPointerDownHandler} @pointerout=${this.numberButtonPointerUpAndOutHandler} @pointerup=${this.numberButtonPointerUpAndOutHandler} tabindex=-1 type=button><calcite-icon .icon=${qS.chevronDown} .scale=${Ur(this.scale)}></calcite-icon></button>`,v=Fe`<div class=${Le(Mn.numberButtonWrapper)}>${d}${a}</div>`,T=Fe`<div class=${Le(Mn.prefix)}>${this.prefixText}</div>`,E=Fe`<div class=${Le(Mn.suffix)}>${this.suffixText}</div>`,k=this.el.autofocus,L=this.el.enterKeyHint,O=this.el.inputMode,H=this.type==="number"?ai("localized-input",Fe`<input accept=${this.accept??ut} aria-errormessage=${GS.validationMessage} .ariaInvalid=${this.status==="invalid"} .ariaLabel=${Nx(this)} autocomplete=${this.autocomplete??ut} .autofocus=${k} value=${this.defaultValue??ut} .disabled=${this.disabled?!0:null} enterkeyhint=${L??ut} inputmode=${O??ut} maxlength=${this.maxLength??ut} minlength=${this.minLength??ut} .multiple=${this.multiple} name=${ut} @blur=${this.inputBlurHandler} @focus=${this.inputFocusHandler} @input=${this.inputNumberInputHandler} @keydown=${this.inputNumberKeyDownHandler} @keyup=${this.inputKeyUpHandler} pattern=${this.pattern??ut} placeholder=${(this.placeholder||"")??ut} .readOnly=${this.readOnly} .required=${this.required} type=text .value=${G3(this.displayedValue??"")} ${hi(this.childNumberRef)}>`):null,ie=this.childElType==="input"?w0`input`:w0`textarea`,pe=this.type!=="number"?M$`<${ie} accept=${this.accept??ut} aria-errormessage=${GS.validationMessage} .ariaInvalid=${this.status==="invalid"} .ariaLabel=${Nx(this)} autocomplete=${this.autocomplete??ut} .autofocus=${k} class=${Le({[Mn.editingEnabled]:this.editingEnabled,[Mn.inlineChild]:!!this.inlineEditableEl})} .defaultValue=${this.defaultValue??""} .disabled=${this.disabled?!0:null} enterkeyhint=${L??ut} inputmode=${O??ut} max=${this.maxString??ut} maxlength=${this.maxLength??ut} min=${this.minString??ut} minlength=${this.minLength??ut} .multiple=${this.multiple} name=${this.name??ut} @blur=${this.inputBlurHandler} @focus=${this.inputFocusHandler} @input=${this.inputInputHandler} @keydown=${this.inputKeyDownHandler} @keyup=${this.inputKeyUpHandler} pattern=${this.pattern??ut} placeholder=${(this.placeholder||"")??ut} .readOnly=${this.readOnly} .required=${this.required?!0:null} spellcheck=${this.el.spellcheck??ut} step=${this.step??ut} tabindex=${(this.disabled||this.inlineEditableEl&&!this.editingEnabled?-1:null)??ut} type=${this.type??ut} .value=${G3(this.value??"")} ${hi(this.childRef)}></${ie}>`:null;return vo({disabled:this.disabled,children:Fe`${this.labelText&&oL({labelText:this.labelText,onClick:this.onLabelClick,required:this.required,tooltipText:this.messages.required})||""}<div class=${Le({[Mn.inputWrapper]:!0,[JO.rtl]:e==="rtl",[Mn.hasSuffix]:this.suffixText,[Mn.hasPrefix]:this.prefixText})} ${hi(this.inputWrapperRef)}>${this.type==="number"&&this.numberButtonType==="horizontal"&&!this.readOnly?a:null}${this.prefixText?T:null}<div class=${Le(Mn.wrapper)}>${H}${pe}${this.isClearable?r:null}${this.requestedIcon?o:null}${this.loading?i:null}</div><div class=${Le(Mn.actionWrapper)} ${hi(this.actionWrapperRef)}><slot name=${oK.action}></slot></div>${this.type==="number"&&this.numberButtonType==="vertical"&&!this.readOnly?v:null}${this.suffixText?E:null}${this.type==="number"&&this.numberButtonType==="horizontal"&&!this.readOnly?d:null}${HR({component:this})}</div>${this.validationMessage&&this.status==="invalid"?aL({icon:this.validationIcon,id:GS.validationMessage,message:this.validationMessage,scale:this.scale,status:this.status}):null}`})}};O1.properties={displayedValue:[16,{},{state:!0}],slottedActionElDisabledInternally:[16,{},{state:!0}],accept:1,alignment:[3,{},{reflect:!0}],autocomplete:[0,{},{attribute:!1}],clearable:[7,{},{reflect:!0,type:Boolean}],disabled:[7,{},{reflect:!0,type:Boolean}],editingEnabled:[7,{},{reflect:!0,type:Boolean}],files:[0,{},{attribute:!1}],form:[3,{},{reflect:!0}],groupSeparator:[7,{},{reflect:!0,type:Boolean}],icon:[3,{converter:_d},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],label:1,labelText:1,loading:[7,{},{reflect:!0,type:Boolean}],localeFormat:[5,{},{type:Boolean}],max:[11,{},{reflect:!0,type:Number}],maxLength:[11,{},{reflect:!0,type:Number}],messageOverrides:[0,{},{attribute:!1}],min:[11,{},{reflect:!0,type:Number}],minLength:[11,{},{reflect:!0,type:Number}],multiple:[5,{},{type:Boolean}],name:[3,{},{reflect:!0}],numberButtonType:[3,{},{reflect:!0}],numberingSystem:[3,{},{reflect:!0}],pattern:1,placeholder:1,prefixText:1,readOnly:[7,{},{reflect:!0,type:Boolean}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}],step:[3,{},{reflect:!0}],suffixText:1,type:[3,{},{reflect:!0}],validationIcon:[3,{converter:_d},{reflect:!0}],validationMessage:1,validity:[0,{},{attribute:!1}],value:1},O1.styles=aK;let MC=O1;lr("calcite-input",MC);function lL(t){if(t==null)return"";if(typeof t=="string")return t;if(Array.isArray(t))return t.map(lL).join(",");const e=String(t);return e==="0"&&Object.is(Number(t),-0)?"-0":e}function lK(t,e=QY){if(t==null)return t;for(const i in t)if(e(t[i],i,t)===!1)break;return t}function cL(t){return eX(lL(t))}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const HS=(t,e,i)=>{const r=cL(e),o=new RegExp(r,"i");t.length===0&&console.warn(`No data was passed to the filter function.
    The data argument should be an array of objects`);const h=(d,a,v)=>{if(d?.constant||d?.filterDisabled)return!0;let T=!1;return lK(d,(E,k)=>{typeof E=="function"||E==null||v&&!v.includes(k)||(Array.isArray(E)||typeof E=="object"&&E!==null?h(E,a)&&(T=!0):a.test(E)&&(T=!0))}),T};return t.filter(d=>h(d,o,i))};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const D$=()=>g$((t,e)=>{const i=new Set;return e.onDisconnected(()=>{i.forEach(r=>r.cancel())}),{add:r=>{[r].flat().forEach(o=>i.add(o))},resources:i}});/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const cK={container:"container"},uK={search:"search"},hK=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host{box-sizing:border-box;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-2);font-size:var(--calcite-font-size--1)}:host *{box-sizing:border-box}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;inline-size:100%}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{display:flex;inline-size:100%}:host([scale=s]) .container{padding:var(--calcite-filter-content-space, var(--calcite-spacing-sm))}:host([scale=m]) .container{padding:var(--calcite-filter-content-space, var(--calcite-spacing-md))}:host([scale=l]) .container{padding:var(--calcite-filter-content-space, var(--calcite-spacing-lg))}label{position:relative;margin-block:0px;display:flex;inline-size:100%;align-items:center;overflow:hidden}calcite-input{inline-size:100%;--calcite-input-background-color: var(--calcite-filter-input-background-color);--calcite-input-border-color: var(--calcite-filter-input-border-color);--calcite-input-corner-radius: var(--calcite-filter-input-corner-radius);--calcite-input-shadow: var(--calcite-filter-input-shadow);--calcite-input-icon-color: var(--calcite-filter-input-icon-color);--calcite-input-text-color: var(--calcite-filter-input-text-color);--calcite-input-placeholder-text-color: var(--calcite-filter-input-placeholder-text-color);--calcite-input-actions-background-color: var(--calcite-filter-input-actions-background-color);--calcite-input-actions-background-color-hover: var(--calcite-filter-input-actions-background-color-hover);--calcite-input-actions-background-color-press: var(--calcite-filter-input-actions-background-color-press);--calcite-input-actions-icon-color: var(--calcite-filter-input-actions-icon-color);--calcite-input-actions-icon-color-hover: var(--calcite-filter-input-actions-icon-color-hover);--calcite-input-actions-icon-color-press: var(--calcite-filter-input-actions-icon-color-press)}:host([hidden]){display:none}[hidden]{display:none}`,o0=class o0 extends Vi{constructor(){super(...arguments),this.cancelable=D$()(this),this.filterDebounced=lw((e,i=!1,r)=>this.updateFiltered(HS(this.items??[],e,this.filterProps),i,r),m$.filter),this.textInput=Xn(),this._value="",this.messages=go(),this.focusSetter=Rs()(this),this.disabled=!1,this.filteredItems=[],this.items=[],this.scale="m",this.calciteFilterChange=vt({cancelable:!1})}get value(){return this._value}set value(e){const i=this._value;e!==i&&(this._value=e,this.valueHandler(e))}async filter(e=this.value){return new Promise(i=>{this.value=e,this.updateFiltered(HS(this.items??[],e,this.filterProps),!1,i)})}async setFocus(e){return this.focusSetter(()=>this.textInput.value,e)}connectedCallback(){super.connectedCallback(),this.cancelable.add(this.filterDebounced)}async load(){this.updateFiltered(HS(this.items??[],this.value,this.filterProps))}willUpdate(e){(e.has("items")&&(this.hasUpdated||this.items?.length>0)||e.has("filterProps"))&&this.filterDebounced(this.value)}updated(){yo(this)}valueHandler(e){this.filterDebounced(e)}inputHandler(e){const i=e.target;this.value=i.value,this.filterDebounced(i.value,!0)}keyDownHandler(e){e.defaultPrevented||(e.key==="Escape"&&(this.clear(),e.preventDefault()),e.key==="Enter"&&e.preventDefault())}clear(){this.value="",this.filterDebounced("",!0),this.setFocus()}updateFiltered(e,i=!1,r){this.filteredItems=e,i&&this.calciteFilterChange.emit(),r?.()}render(){const{disabled:e,scale:i}=this;return vo({disabled:e,children:Fe`<div class=${Le(cK.container)}><label><calcite-input clearable .disabled=${e} .icon=${uK.search} .label=${this.label??this.messages.label} .messageOverrides=${{clear:this.messages.clear}} @keydown=${this.keyDownHandler} @calciteInputInput=${this.inputHandler} .placeholder=${this.placeholder} .scale=${i} type=text .value=${this.value} ${hi(this.textInput)}></calcite-input></label></div>`})}};o0.properties={disabled:[7,{},{reflect:!0,type:Boolean}],filterProps:[0,{},{attribute:!1}],filteredItems:[0,{},{attribute:!1}],items:[0,{},{attribute:!1}],label:1,messageOverrides:[0,{},{attribute:!1}],placeholder:1,scale:[3,{},{reflect:!0}],value:1},o0.shadowRootOptions={mode:"open",delegatesFocus:!0},o0.styles=hK;let kC=o0;lr("calcite-filter",kC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const jy="calcite-list",Ux="calcite-list-item-group",mc="calcite-list-item";function AC(t){const e=t.parentElement?.closest(mc);e&&(e.open=!0,AC(e))}function dK(t){const e=t.assignedElements({flatten:!0}),i=e.filter(h=>h?.matches(Ux)).map(h=>Array.from(h.querySelectorAll(mc))).flat(),r=e.filter(h=>h?.matches(mc));return{lists:e.filter(h=>h?.matches(jy)),items:i.concat(r)}}function pK(t){const e=t.assignedElements({flatten:!0}).filter(r=>r.matches(mc)),i=e.filter(r=>!r.filterHidden);e.forEach(r=>{const o=i.indexOf(r);r.setPosition=o===-1?void 0:o+1,r.setSize=o===-1?void 0:i.length})}function fK(t,e=!1){const i=e?"ancestor::calcite-list-item | ancestor::calcite-list-item-group":"ancestor::calcite-list-item";return document.evaluate(i,t,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null).snapshotLength}function F_(t){return t.tagName==="CALCITE-LIST-ITEM"}/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function XA(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,r)}return i}function _l(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?XA(Object(i),!0).forEach(function(r){mK(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):XA(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function gb(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?gb=function(e){return typeof e}:gb=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gb(t)}function mK(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _c(){return _c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},_c.apply(this,arguments)}function gK(t,e){if(t==null)return{};var i={},r=Object.keys(t),o,h;for(h=0;h<r.length;h++)o=r[h],!(e.indexOf(o)>=0)&&(i[o]=t[o]);return i}function yK(t,e){if(t==null)return{};var i=gK(t,e),r,o;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);for(o=0;o<h.length;o++)r=h[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}var vK="1.15.6";function gc(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var xc=gc(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),tv=gc(/Edge/i),JA=gc(/firefox/i),Uy=gc(/safari/i)&&!gc(/chrome/i)&&!gc(/android/i),z$=gc(/iP(ad|od|hone)/i),uL=gc(/chrome/i)&&gc(/android/i),hL={capture:!1,passive:!1};function vi(t,e,i){t.addEventListener(e,i,!xc&&hL)}function mi(t,e,i){t.removeEventListener(e,i,!xc&&hL)}function Vx(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function dL(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function ya(t,e,i,r){if(t){i=i||document;do{if(e!=null&&(e[0]===">"?t.parentNode===i&&Vx(t,e):Vx(t,e))||r&&t===i)return t;if(t===i)break}while(t=dL(t))}return null}var KA=/\s+/g;function to(t,e,i){if(t&&e)if(t.classList)t.classList[i?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(KA," ").replace(" "+e+" "," ");t.className=(r+(i?" "+e:"")).replace(KA," ")}}function Vt(t,e,i){var r=t&&t.style;if(r){if(i===void 0)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),e===void 0?i:i[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=i+(typeof i=="string"?"":"px")}}function kf(t,e){var i="";if(typeof t=="string")i=t;else do{var r=Vt(t,"transform");r&&r!=="none"&&(i=r+" "+i)}while(!e&&(t=t.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(i)}function pL(t,e,i){if(t){var r=t.getElementsByTagName(e),o=0,h=r.length;if(i)for(;o<h;o++)i(r[o],o);return r}return[]}function yl(){var t=document.scrollingElement;return t||document.documentElement}function rn(t,e,i,r,o){if(!(!t.getBoundingClientRect&&t!==window)){var h,d,a,v,T,E,k;if(t!==window&&t.parentNode&&t!==yl()?(h=t.getBoundingClientRect(),d=h.top,a=h.left,v=h.bottom,T=h.right,E=h.height,k=h.width):(d=0,a=0,v=window.innerHeight,T=window.innerWidth,E=window.innerHeight,k=window.innerWidth),(e||i)&&t!==window&&(o=o||t.parentNode,!xc))do if(o&&o.getBoundingClientRect&&(Vt(o,"transform")!=="none"||i&&Vt(o,"position")!=="static")){var L=o.getBoundingClientRect();d-=L.top+parseInt(Vt(o,"border-top-width")),a-=L.left+parseInt(Vt(o,"border-left-width")),v=d+h.height,T=a+h.width;break}while(o=o.parentNode);if(r&&t!==window){var O=kf(o||t),H=O&&O.a,ie=O&&O.d;O&&(d/=ie,a/=H,k/=H,E/=ie,v=d+E,T=a+k)}return{top:d,left:a,bottom:v,right:T,width:k,height:E}}}function QA(t,e,i){for(var r=Pu(t,!0),o=rn(t)[e];r;){var h=rn(r)[i],d=void 0;if(d=o>=h,!d)return r;if(r===yl())break;r=Pu(r,!1)}return!1}function am(t,e,i,r){for(var o=0,h=0,d=t.children;h<d.length;){if(d[h].style.display!=="none"&&d[h]!==Gt.ghost&&(r||d[h]!==Gt.dragged)&&ya(d[h],i.draggable,t,!1)){if(o===e)return d[h];o++}h++}return null}function O$(t,e){for(var i=t.lastElementChild;i&&(i===Gt.ghost||Vt(i,"display")==="none"||e&&!Vx(i,e));)i=i.previousElementSibling;return i||null}function Ro(t,e){var i=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==Gt.clone&&(!e||Vx(t,e))&&i++;return i}function eD(t){var e=0,i=0,r=yl();if(t)do{var o=kf(t),h=o.a,d=o.d;e+=t.scrollLeft*h,i+=t.scrollTop*d}while(t!==r&&(t=t.parentNode));return[e,i]}function _K(t,e){for(var i in t)if(t.hasOwnProperty(i)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t[i][r])return Number(i)}return-1}function Pu(t,e){if(!t||!t.getBoundingClientRect)return yl();var i=t,r=!1;do if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var o=Vt(i);if(i.clientWidth<i.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||i.clientHeight<i.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!i.getBoundingClientRect||i===document.body)return yl();if(r||e)return i;r=!0}}while(i=i.parentNode);return yl()}function bK(t,e){if(t&&e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function ZS(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var Vy;function fL(t,e){return function(){if(!Vy){var i=arguments,r=this;i.length===1?t.call(r,i[0]):t.apply(r,i),Vy=setTimeout(function(){Vy=void 0},e)}}}function xK(){clearTimeout(Vy),Vy=void 0}function mL(t,e,i){t.scrollLeft+=e,t.scrollTop+=i}function gL(t){var e=window.Polymer,i=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):i?i(t).clone(!0)[0]:t.cloneNode(!0)}function yL(t,e,i){var r={};return Array.from(t.children).forEach(function(o){var h,d,a,v;if(!(!ya(o,e.draggable,t,!1)||o.animated||o===i)){var T=rn(o);r.left=Math.min((h=r.left)!==null&&h!==void 0?h:1/0,T.left),r.top=Math.min((d=r.top)!==null&&d!==void 0?d:1/0,T.top),r.right=Math.max((a=r.right)!==null&&a!==void 0?a:-1/0,T.right),r.bottom=Math.max((v=r.bottom)!==null&&v!==void 0?v:-1/0,T.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var ks="Sortable"+new Date().getTime();function wK(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(o){if(!(Vt(o,"display")==="none"||o===Gt.ghost)){t.push({target:o,rect:rn(o)});var h=_l({},t[t.length-1].rect);if(o.thisAnimationDuration){var d=kf(o,!0);d&&(h.top-=d.f,h.left-=d.e)}o.fromRect=h}})}},addAnimationState:function(r){t.push(r)},removeAnimationState:function(r){t.splice(_K(t,{target:r}),1)},animateAll:function(r){var o=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var h=!1,d=0;t.forEach(function(a){var v=0,T=a.target,E=T.fromRect,k=rn(T),L=T.prevFromRect,O=T.prevToRect,H=a.rect,ie=kf(T,!0);ie&&(k.top-=ie.f,k.left-=ie.e),T.toRect=k,T.thisAnimationDuration&&ZS(L,k)&&!ZS(E,k)&&(H.top-k.top)/(H.left-k.left)===(E.top-k.top)/(E.left-k.left)&&(v=TK(H,L,O,o.options)),ZS(k,E)||(T.prevFromRect=E,T.prevToRect=k,v||(v=o.options.animation),o.animate(T,H,k,v)),v&&(h=!0,d=Math.max(d,v),clearTimeout(T.animationResetTimer),T.animationResetTimer=setTimeout(function(){T.animationTime=0,T.prevFromRect=null,T.fromRect=null,T.prevToRect=null,T.thisAnimationDuration=null},v),T.thisAnimationDuration=v)}),clearTimeout(e),h?e=setTimeout(function(){typeof r=="function"&&r()},d):typeof r=="function"&&r(),t=[]},animate:function(r,o,h,d){if(d){Vt(r,"transition",""),Vt(r,"transform","");var a=kf(this.el),v=a&&a.a,T=a&&a.d,E=(o.left-h.left)/(v||1),k=(o.top-h.top)/(T||1);r.animatingX=!!E,r.animatingY=!!k,Vt(r,"transform","translate3d("+E+"px,"+k+"px,0)"),this.forRepaintDummy=SK(r),Vt(r,"transition","transform "+d+"ms"+(this.options.easing?" "+this.options.easing:"")),Vt(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){Vt(r,"transition",""),Vt(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},d)}}}}function SK(t){return t.offsetWidth}function TK(t,e,i,r){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))*r.animation}var Up=[],WS={initializeByDefault:!0},iv={mount:function(e){for(var i in WS)WS.hasOwnProperty(i)&&!(i in e)&&(e[i]=WS[i]);Up.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Up.push(e)},pluginEvent:function(e,i,r){var o=this;this.eventCanceled=!1,r.cancel=function(){o.eventCanceled=!0};var h=e+"Global";Up.forEach(function(d){i[d.pluginName]&&(i[d.pluginName][h]&&i[d.pluginName][h](_l({sortable:i},r)),i.options[d.pluginName]&&i[d.pluginName][e]&&i[d.pluginName][e](_l({sortable:i},r)))})},initializePlugins:function(e,i,r,o){Up.forEach(function(a){var v=a.pluginName;if(!(!e.options[v]&&!a.initializeByDefault)){var T=new a(e,i,e.options);T.sortable=e,T.options=e.options,e[v]=T,_c(r,T.defaults)}});for(var h in e.options)if(e.options.hasOwnProperty(h)){var d=this.modifyOption(e,h,e.options[h]);typeof d<"u"&&(e.options[h]=d)}},getEventProperties:function(e,i){var r={};return Up.forEach(function(o){typeof o.eventProperties=="function"&&_c(r,o.eventProperties.call(i[o.pluginName],e))}),r},modifyOption:function(e,i,r){var o;return Up.forEach(function(h){e[h.pluginName]&&h.optionListeners&&typeof h.optionListeners[i]=="function"&&(o=h.optionListeners[i].call(e[h.pluginName],r))}),o}};function CK(t){var e=t.sortable,i=t.rootEl,r=t.name,o=t.targetEl,h=t.cloneEl,d=t.toEl,a=t.fromEl,v=t.oldIndex,T=t.newIndex,E=t.oldDraggableIndex,k=t.newDraggableIndex,L=t.originalEvent,O=t.putSortable,H=t.extraEventProperties;if(e=e||i&&i[ks],!!e){var ie,pe=e.options,be="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!xc&&!tv?ie=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(ie=document.createEvent("Event"),ie.initEvent(r,!0,!0)),ie.to=d||i,ie.from=a||i,ie.item=o||i,ie.clone=h,ie.oldIndex=v,ie.newIndex=T,ie.oldDraggableIndex=E,ie.newDraggableIndex=k,ie.originalEvent=L,ie.pullMode=O?O.lastPutMode:void 0;var Ce=_l(_l({},H),iv.getEventProperties(r,e));for(var Pe in Ce)ie[Pe]=Ce[Pe];i&&i.dispatchEvent(ie),pe[be]&&pe[be].call(e,ie)}}var EK=["evt"],ws=function(e,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=r.evt,h=yK(r,EK);iv.pluginEvent.bind(Gt)(e,i,_l({dragEl:gt,parentEl:Sr,ghostEl:Xt,rootEl:nr,nextEl:Nh,lastDownEl:yb,cloneEl:pr,cloneHidden:Cu,dragStarted:fy,putSortable:zn,activeSortable:Gt.active,originalEvent:o,oldIndex:vf,oldDraggableIndex:Gy,newIndex:so,newDraggableIndex:vu,hideGhostForTarget:xL,unhideGhostForTarget:wL,cloneNowHidden:function(){Cu=!0},cloneNowShown:function(){Cu=!1},dispatchSortableEvent:function(a){ls({sortable:i,name:a,originalEvent:o})}},h))};function ls(t){CK(_l({putSortable:zn,cloneEl:pr,targetEl:gt,rootEl:nr,oldIndex:vf,oldDraggableIndex:Gy,newIndex:so,newDraggableIndex:vu},t))}var gt,Sr,Xt,nr,Nh,yb,pr,Cu,vf,so,Gy,vu,N_,zn,rf=!1,Gx=!1,qx=[],Dh,la,YS,XS,tD,iD,fy,Vp,qy,Hy=!1,B_=!1,vb,Vn,JS=[],DC=!1,Hx=[],dw=typeof document<"u",j_=z$,rD=tv||xc?"cssFloat":"float",IK=dw&&!uL&&!z$&&"draggable"in document.createElement("div"),vL=(function(){if(dw){if(xc)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}})(),_L=function(e,i){var r=Vt(e),o=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),h=am(e,0,i),d=am(e,1,i),a=h&&Vt(h),v=d&&Vt(d),T=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+rn(h).width,E=v&&parseInt(v.marginLeft)+parseInt(v.marginRight)+rn(d).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(h&&a.float&&a.float!=="none"){var k=a.float==="left"?"left":"right";return d&&(v.clear==="both"||v.clear===k)?"vertical":"horizontal"}return h&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||T>=o&&r[rD]==="none"||d&&r[rD]==="none"&&T+E>o)?"vertical":"horizontal"},$K=function(e,i,r){var o=r?e.left:e.top,h=r?e.right:e.bottom,d=r?e.width:e.height,a=r?i.left:i.top,v=r?i.right:i.bottom,T=r?i.width:i.height;return o===a||h===v||o+d/2===a+T/2},PK=function(e,i){var r;return qx.some(function(o){var h=o[ks].options.emptyInsertThreshold;if(!(!h||O$(o))){var d=rn(o),a=e>=d.left-h&&e<=d.right+h,v=i>=d.top-h&&i<=d.bottom+h;if(a&&v)return r=o}}),r},bL=function(e){function i(h,d){return function(a,v,T,E){var k=a.options.group.name&&v.options.group.name&&a.options.group.name===v.options.group.name;if(h==null&&(d||k))return!0;if(h==null||h===!1)return!1;if(d&&h==="clone")return h;if(typeof h=="function")return i(h(a,v,T,E),d)(a,v,T,E);var L=(d?a:v).options.group.name;return h===!0||typeof h=="string"&&h===L||h.join&&h.indexOf(L)>-1}}var r={},o=e.group;(!o||gb(o)!="object")&&(o={name:o}),r.name=o.name,r.checkPull=i(o.pull,!0),r.checkPut=i(o.put),r.revertClone=o.revertClone,e.group=r},xL=function(){!vL&&Xt&&Vt(Xt,"display","none")},wL=function(){!vL&&Xt&&Vt(Xt,"display","")};dw&&!uL&&document.addEventListener("click",function(t){if(Gx)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Gx=!1,!1},!0);var zh=function(e){if(gt){e=e.touches?e.touches[0]:e;var i=PK(e.clientX,e.clientY);if(i){var r={};for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);r.target=r.rootEl=i,r.preventDefault=void 0,r.stopPropagation=void 0,i[ks]._onDragOver(r)}}},MK=function(e){gt&&gt.parentNode[ks]._isOutsideThisEl(e.target)};function Gt(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=_c({},e),t[ks]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return _L(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(d,a){d.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Gt.supportPointer!==!1&&"PointerEvent"in window&&(!Uy||z$),emptyInsertThreshold:5};iv.initializePlugins(this,t,i);for(var r in i)!(r in e)&&(e[r]=i[r]);bL(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:IK,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?vi(t,"pointerdown",this._onTapStart):(vi(t,"mousedown",this._onTapStart),vi(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(vi(t,"dragover",this),vi(t,"dragenter",this)),qx.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),_c(this,wK())}Gt.prototype={constructor:Gt,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Vp=null)},_getDirection:function(e,i){return typeof this.options.direction=="function"?this.options.direction.call(this,e,i,gt):this.options.direction},_onTapStart:function(e){if(e.cancelable){var i=this,r=this.el,o=this.options,h=o.preventOnFilter,d=e.type,a=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,v=(a||e).target,T=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||v,E=o.filter;if(FK(r),!gt&&!(/mousedown|pointerdown/.test(d)&&e.button!==0||o.disabled)&&!T.isContentEditable&&!(!this.nativeDraggable&&Uy&&v&&v.tagName.toUpperCase()==="SELECT")&&(v=ya(v,o.draggable,r,!1),!(v&&v.animated)&&yb!==v)){if(vf=Ro(v),Gy=Ro(v,o.draggable),typeof E=="function"){if(E.call(this,e,v,this)){ls({sortable:i,rootEl:T,name:"filter",targetEl:v,toEl:r,fromEl:r}),ws("filter",i,{evt:e}),h&&e.preventDefault();return}}else if(E&&(E=E.split(",").some(function(k){if(k=ya(T,k.trim(),r,!1),k)return ls({sortable:i,rootEl:k,name:"filter",targetEl:v,fromEl:r,toEl:r}),ws("filter",i,{evt:e}),!0}),E)){h&&e.preventDefault();return}o.handle&&!ya(T,o.handle,r,!1)||this._prepareDragStart(e,a,v)}}},_prepareDragStart:function(e,i,r){var o=this,h=o.el,d=o.options,a=h.ownerDocument,v;if(r&&!gt&&r.parentNode===h){var T=rn(r);if(nr=h,gt=r,Sr=gt.parentNode,Nh=gt.nextSibling,yb=r,N_=d.group,Gt.dragged=gt,Dh={target:gt,clientX:(i||e).clientX,clientY:(i||e).clientY},tD=Dh.clientX-T.left,iD=Dh.clientY-T.top,this._lastX=(i||e).clientX,this._lastY=(i||e).clientY,gt.style["will-change"]="all",v=function(){if(ws("delayEnded",o,{evt:e}),Gt.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!JA&&o.nativeDraggable&&(gt.draggable=!0),o._triggerDragStart(e,i),ls({sortable:o,name:"choose",originalEvent:e}),to(gt,d.chosenClass,!0)},d.ignore.split(",").forEach(function(E){pL(gt,E.trim(),KS)}),vi(a,"dragover",zh),vi(a,"mousemove",zh),vi(a,"touchmove",zh),d.supportPointer?(vi(a,"pointerup",o._onDrop),!this.nativeDraggable&&vi(a,"pointercancel",o._onDrop)):(vi(a,"mouseup",o._onDrop),vi(a,"touchend",o._onDrop),vi(a,"touchcancel",o._onDrop)),JA&&this.nativeDraggable&&(this.options.touchStartThreshold=4,gt.draggable=!0),ws("delayStart",this,{evt:e}),d.delay&&(!d.delayOnTouchOnly||i)&&(!this.nativeDraggable||!(tv||xc))){if(Gt.eventCanceled){this._onDrop();return}d.supportPointer?(vi(a,"pointerup",o._disableDelayedDrag),vi(a,"pointercancel",o._disableDelayedDrag)):(vi(a,"mouseup",o._disableDelayedDrag),vi(a,"touchend",o._disableDelayedDrag),vi(a,"touchcancel",o._disableDelayedDrag)),vi(a,"mousemove",o._delayedDragTouchMoveHandler),vi(a,"touchmove",o._delayedDragTouchMoveHandler),d.supportPointer&&vi(a,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(v,d.delay)}else v()}},_delayedDragTouchMoveHandler:function(e){var i=e.touches?e.touches[0]:e;Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){gt&&KS(gt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;mi(e,"mouseup",this._disableDelayedDrag),mi(e,"touchend",this._disableDelayedDrag),mi(e,"touchcancel",this._disableDelayedDrag),mi(e,"pointerup",this._disableDelayedDrag),mi(e,"pointercancel",this._disableDelayedDrag),mi(e,"mousemove",this._delayedDragTouchMoveHandler),mi(e,"touchmove",this._delayedDragTouchMoveHandler),mi(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,i){i=i||e.pointerType=="touch"&&e,!this.nativeDraggable||i?this.options.supportPointer?vi(document,"pointermove",this._onTouchMove):i?vi(document,"touchmove",this._onTouchMove):vi(document,"mousemove",this._onTouchMove):(vi(gt,"dragend",this),vi(nr,"dragstart",this._onDragStart));try{document.selection?_b(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,i){if(rf=!1,nr&&gt){ws("dragStarted",this,{evt:i}),this.nativeDraggable&&vi(document,"dragover",MK);var r=this.options;!e&&to(gt,r.dragClass,!1),to(gt,r.ghostClass,!0),Gt.active=this,e&&this._appendGhost(),ls({sortable:this,name:"start",originalEvent:i})}else this._nulling()},_emulateDragOver:function(){if(la){this._lastX=la.clientX,this._lastY=la.clientY,xL();for(var e=document.elementFromPoint(la.clientX,la.clientY),i=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(la.clientX,la.clientY),e!==i);)i=e;if(gt.parentNode[ks]._isOutsideThisEl(e),i)do{if(i[ks]){var r=void 0;if(r=i[ks]._onDragOver({clientX:la.clientX,clientY:la.clientY,target:e,rootEl:i}),r&&!this.options.dragoverBubble)break}e=i}while(i=dL(i));wL()}},_onTouchMove:function(e){if(Dh){var i=this.options,r=i.fallbackTolerance,o=i.fallbackOffset,h=e.touches?e.touches[0]:e,d=Xt&&kf(Xt,!0),a=Xt&&d&&d.a,v=Xt&&d&&d.d,T=j_&&Vn&&eD(Vn),E=(h.clientX-Dh.clientX+o.x)/(a||1)+(T?T[0]-JS[0]:0)/(a||1),k=(h.clientY-Dh.clientY+o.y)/(v||1)+(T?T[1]-JS[1]:0)/(v||1);if(!Gt.active&&!rf){if(r&&Math.max(Math.abs(h.clientX-this._lastX),Math.abs(h.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(Xt){d?(d.e+=E-(YS||0),d.f+=k-(XS||0)):d={a:1,b:0,c:0,d:1,e:E,f:k};var L="matrix(".concat(d.a,",").concat(d.b,",").concat(d.c,",").concat(d.d,",").concat(d.e,",").concat(d.f,")");Vt(Xt,"webkitTransform",L),Vt(Xt,"mozTransform",L),Vt(Xt,"msTransform",L),Vt(Xt,"transform",L),YS=E,XS=k,la=h}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Xt){var e=this.options.fallbackOnBody?document.body:nr,i=rn(gt,!0,j_,!0,e),r=this.options;if(j_){for(Vn=e;Vt(Vn,"position")==="static"&&Vt(Vn,"transform")==="none"&&Vn!==document;)Vn=Vn.parentNode;Vn!==document.body&&Vn!==document.documentElement?(Vn===document&&(Vn=yl()),i.top+=Vn.scrollTop,i.left+=Vn.scrollLeft):Vn=yl(),JS=eD(Vn)}Xt=gt.cloneNode(!0),to(Xt,r.ghostClass,!1),to(Xt,r.fallbackClass,!0),to(Xt,r.dragClass,!0),Vt(Xt,"transition",""),Vt(Xt,"transform",""),Vt(Xt,"box-sizing","border-box"),Vt(Xt,"margin",0),Vt(Xt,"top",i.top),Vt(Xt,"left",i.left),Vt(Xt,"width",i.width),Vt(Xt,"height",i.height),Vt(Xt,"opacity","0.8"),Vt(Xt,"position",j_?"absolute":"fixed"),Vt(Xt,"zIndex","100000"),Vt(Xt,"pointerEvents","none"),Gt.ghost=Xt,e.appendChild(Xt),Vt(Xt,"transform-origin",tD/parseInt(Xt.style.width)*100+"% "+iD/parseInt(Xt.style.height)*100+"%")}},_onDragStart:function(e,i){var r=this,o=e.dataTransfer,h=r.options;if(ws("dragStart",this,{evt:e}),Gt.eventCanceled){this._onDrop();return}ws("setupClone",this),Gt.eventCanceled||(pr=gL(gt),pr.removeAttribute("id"),pr.draggable=!1,pr.style["will-change"]="",this._hideClone(),to(pr,this.options.chosenClass,!1),Gt.clone=pr),r.cloneId=_b(function(){ws("clone",r),!Gt.eventCanceled&&(r.options.removeCloneOnHide||nr.insertBefore(pr,gt),r._hideClone(),ls({sortable:r,name:"clone"}))}),!i&&to(gt,h.dragClass,!0),i?(Gx=!0,r._loopId=setInterval(r._emulateDragOver,50)):(mi(document,"mouseup",r._onDrop),mi(document,"touchend",r._onDrop),mi(document,"touchcancel",r._onDrop),o&&(o.effectAllowed="move",h.setData&&h.setData.call(r,o,gt)),vi(document,"drop",r),Vt(gt,"transform","translateZ(0)")),rf=!0,r._dragStartId=_b(r._dragStarted.bind(r,i,e)),vi(document,"selectstart",r),fy=!0,window.getSelection().removeAllRanges(),Uy&&Vt(document.body,"user-select","none")},_onDragOver:function(e){var i=this.el,r=e.target,o,h,d,a=this.options,v=a.group,T=Gt.active,E=N_===v,k=a.sort,L=zn||T,O,H=this,ie=!1;if(DC)return;function pe(Et,Ye){ws(Et,H,_l({evt:e,isOwner:E,axis:O?"vertical":"horizontal",revert:d,dragRect:o,targetRect:h,canSort:k,fromSortable:L,target:r,completed:Ce,onMove:function(Dt,Si){return U_(nr,i,gt,o,Dt,rn(Dt),e,Si)},changed:Pe},Ye))}function be(){pe("dragOverAnimationCapture"),H.captureAnimationState(),H!==L&&L.captureAnimationState()}function Ce(Et){return pe("dragOverCompleted",{insertion:Et}),Et&&(E?T._hideClone():T._showClone(H),H!==L&&(to(gt,zn?zn.options.ghostClass:T.options.ghostClass,!1),to(gt,a.ghostClass,!0)),zn!==H&&H!==Gt.active?zn=H:H===Gt.active&&zn&&(zn=null),L===H&&(H._ignoreWhileAnimating=r),H.animateAll(function(){pe("dragOverAnimationComplete"),H._ignoreWhileAnimating=null}),H!==L&&(L.animateAll(),L._ignoreWhileAnimating=null)),(r===gt&&!gt.animated||r===i&&!r.animated)&&(Vp=null),!a.dragoverBubble&&!e.rootEl&&r!==document&&(gt.parentNode[ks]._isOutsideThisEl(e.target),!Et&&zh(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),ie=!0}function Pe(){so=Ro(gt),vu=Ro(gt,a.draggable),ls({sortable:H,name:"change",toEl:i,newIndex:so,newDraggableIndex:vu,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=ya(r,a.draggable,i,!0),pe("dragOver"),Gt.eventCanceled)return ie;if(gt.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||H._ignoreWhileAnimating===r)return Ce(!1);if(Gx=!1,T&&!a.disabled&&(E?k||(d=Sr!==nr):zn===this||(this.lastPutMode=N_.checkPull(this,T,gt,e))&&v.checkPut(this,T,gt,e))){if(O=this._getDirection(e,r)==="vertical",o=rn(gt),pe("dragOverValid"),Gt.eventCanceled)return ie;if(d)return Sr=nr,be(),this._hideClone(),pe("revert"),Gt.eventCanceled||(Nh?nr.insertBefore(gt,Nh):nr.appendChild(gt)),Ce(!0);var Ie=O$(i,a.draggable);if(!Ie||zK(e,O,this)&&!Ie.animated){if(Ie===gt)return Ce(!1);if(Ie&&i===e.target&&(r=Ie),r&&(h=rn(r)),U_(nr,i,gt,o,r,h,e,!!r)!==!1)return be(),Ie&&Ie.nextSibling?i.insertBefore(gt,Ie.nextSibling):i.appendChild(gt),Sr=i,Pe(),Ce(!0)}else if(Ie&&DK(e,O,this)){var ke=am(i,0,a,!0);if(ke===gt)return Ce(!1);if(r=ke,h=rn(r),U_(nr,i,gt,o,r,h,e,!1)!==!1)return be(),i.insertBefore(gt,ke),Sr=i,Pe(),Ce(!0)}else if(r.parentNode===i){h=rn(r);var Ke=0,qe,dt=gt.parentNode!==i,ft=!$K(gt.animated&&gt.toRect||o,r.animated&&r.toRect||h,O),et=O?"top":"left",We=QA(r,"top","top")||QA(gt,"top","top"),Be=We?We.scrollTop:void 0;Vp!==r&&(qe=h[et],Hy=!1,B_=!ft&&a.invertSwap||dt),Ke=OK(e,r,h,O,ft?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,B_,Vp===r);var ge;if(Ke!==0){var De=Ro(gt);do De-=Ke,ge=Sr.children[De];while(ge&&(Vt(ge,"display")==="none"||ge===Xt))}if(Ke===0||ge===r)return Ce(!1);Vp=r,qy=Ke;var Je=r.nextElementSibling,Qe=!1;Qe=Ke===1;var yt=U_(nr,i,gt,o,r,h,e,Qe);if(yt!==!1)return(yt===1||yt===-1)&&(Qe=yt===1),DC=!0,setTimeout(AK,30),be(),Qe&&!Je?i.appendChild(gt):r.parentNode.insertBefore(gt,Qe?Je:r),We&&mL(We,0,Be-We.scrollTop),Sr=gt.parentNode,qe!==void 0&&!B_&&(vb=Math.abs(qe-rn(r)[et])),Pe(),Ce(!0)}if(i.contains(gt))return Ce(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){mi(document,"mousemove",this._onTouchMove),mi(document,"touchmove",this._onTouchMove),mi(document,"pointermove",this._onTouchMove),mi(document,"dragover",zh),mi(document,"mousemove",zh),mi(document,"touchmove",zh)},_offUpEvents:function(){var e=this.el.ownerDocument;mi(e,"mouseup",this._onDrop),mi(e,"touchend",this._onDrop),mi(e,"pointerup",this._onDrop),mi(e,"pointercancel",this._onDrop),mi(e,"touchcancel",this._onDrop),mi(document,"selectstart",this)},_onDrop:function(e){var i=this.el,r=this.options;if(so=Ro(gt),vu=Ro(gt,r.draggable),ws("drop",this,{evt:e}),Sr=gt&&gt.parentNode,so=Ro(gt),vu=Ro(gt,r.draggable),Gt.eventCanceled){this._nulling();return}rf=!1,B_=!1,Hy=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),zC(this.cloneId),zC(this._dragStartId),this.nativeDraggable&&(mi(document,"drop",this),mi(i,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Uy&&Vt(document.body,"user-select",""),Vt(gt,"transform",""),e&&(fy&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),Xt&&Xt.parentNode&&Xt.parentNode.removeChild(Xt),(nr===Sr||zn&&zn.lastPutMode!=="clone")&&pr&&pr.parentNode&&pr.parentNode.removeChild(pr),gt&&(this.nativeDraggable&&mi(gt,"dragend",this),KS(gt),gt.style["will-change"]="",fy&&!rf&&to(gt,zn?zn.options.ghostClass:this.options.ghostClass,!1),to(gt,this.options.chosenClass,!1),ls({sortable:this,name:"unchoose",toEl:Sr,newIndex:null,newDraggableIndex:null,originalEvent:e}),nr!==Sr?(so>=0&&(ls({rootEl:Sr,name:"add",toEl:Sr,fromEl:nr,originalEvent:e}),ls({sortable:this,name:"remove",toEl:Sr,originalEvent:e}),ls({rootEl:Sr,name:"sort",toEl:Sr,fromEl:nr,originalEvent:e}),ls({sortable:this,name:"sort",toEl:Sr,originalEvent:e})),zn&&zn.save()):so!==vf&&so>=0&&(ls({sortable:this,name:"update",toEl:Sr,originalEvent:e}),ls({sortable:this,name:"sort",toEl:Sr,originalEvent:e})),Gt.active&&((so==null||so===-1)&&(so=vf,vu=Gy),ls({sortable:this,name:"end",toEl:Sr,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){ws("nulling",this),nr=gt=Sr=Xt=Nh=pr=yb=Cu=Dh=la=fy=so=vu=vf=Gy=Vp=qy=zn=N_=Gt.dragged=Gt.ghost=Gt.clone=Gt.active=null,Hx.forEach(function(e){e.checked=!0}),Hx.length=YS=XS=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":gt&&(this._onDragOver(e),kK(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],i,r=this.el.children,o=0,h=r.length,d=this.options;o<h;o++)i=r[o],ya(i,d.draggable,this.el,!1)&&e.push(i.getAttribute(d.dataIdAttr)||LK(i));return e},sort:function(e,i){var r={},o=this.el;this.toArray().forEach(function(h,d){var a=o.children[d];ya(a,this.options.draggable,o,!1)&&(r[h]=a)},this),i&&this.captureAnimationState(),e.forEach(function(h){r[h]&&(o.removeChild(r[h]),o.appendChild(r[h]))}),i&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,i){return ya(e,i||this.options.draggable,this.el,!1)},option:function(e,i){var r=this.options;if(i===void 0)return r[e];var o=iv.modifyOption(this,e,i);typeof o<"u"?r[e]=o:r[e]=i,e==="group"&&bL(r)},destroy:function(){ws("destroy",this);var e=this.el;e[ks]=null,mi(e,"mousedown",this._onTapStart),mi(e,"touchstart",this._onTapStart),mi(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(mi(e,"dragover",this),mi(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(i){i.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),qx.splice(qx.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Cu){if(ws("hideClone",this),Gt.eventCanceled)return;Vt(pr,"display","none"),this.options.removeCloneOnHide&&pr.parentNode&&pr.parentNode.removeChild(pr),Cu=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Cu){if(ws("showClone",this),Gt.eventCanceled)return;gt.parentNode==nr&&!this.options.group.revertClone?nr.insertBefore(pr,gt):Nh?nr.insertBefore(pr,Nh):nr.appendChild(pr),this.options.group.revertClone&&this.animate(gt,pr),Vt(pr,"display",""),Cu=!1}}};function kK(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function U_(t,e,i,r,o,h,d,a){var v,T=t[ks],E=T.options.onMove,k;return window.CustomEvent&&!xc&&!tv?v=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(v=document.createEvent("Event"),v.initEvent("move",!0,!0)),v.to=e,v.from=t,v.dragged=i,v.draggedRect=r,v.related=o||e,v.relatedRect=h||rn(e),v.willInsertAfter=a,v.originalEvent=d,t.dispatchEvent(v),E&&(k=E.call(T,v,d)),k}function KS(t){t.draggable=!1}function AK(){DC=!1}function DK(t,e,i){var r=rn(am(i.el,0,i.options,!0)),o=yL(i.el,i.options,Xt),h=10;return e?t.clientX<o.left-h||t.clientY<r.top&&t.clientX<r.right:t.clientY<o.top-h||t.clientY<r.bottom&&t.clientX<r.left}function zK(t,e,i){var r=rn(O$(i.el,i.options.draggable)),o=yL(i.el,i.options,Xt),h=10;return e?t.clientX>o.right+h||t.clientY>r.bottom&&t.clientX>r.left:t.clientY>o.bottom+h||t.clientX>r.right&&t.clientY>r.top}function OK(t,e,i,r,o,h,d,a){var v=r?t.clientY:t.clientX,T=r?i.height:i.width,E=r?i.top:i.left,k=r?i.bottom:i.right,L=!1;if(!d){if(a&&vb<T*o){if(!Hy&&(qy===1?v>E+T*h/2:v<k-T*h/2)&&(Hy=!0),Hy)L=!0;else if(qy===1?v<E+vb:v>k-vb)return-qy}else if(v>E+T*(1-o)/2&&v<k-T*(1-o)/2)return RK(e)}return L=L||d,L&&(v<E+T*h/2||v>k-T*h/2)?v>E+T/2?1:-1:0}function RK(t){return Ro(gt)<Ro(t)?1:-1}function LK(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,r=0;i--;)r+=e.charCodeAt(i);return r.toString(36)}function FK(t){Hx.length=0;for(var e=t.getElementsByTagName("input"),i=e.length;i--;){var r=e[i];r.checked&&Hx.push(r)}}function _b(t){return setTimeout(t,0)}function zC(t){return clearTimeout(t)}dw&&vi(document,"touchmove",function(t){(Gt.active||rf)&&t.cancelable&&t.preventDefault()});Gt.utils={on:vi,off:mi,css:Vt,find:pL,is:function(e,i){return!!ya(e,i,e,!1)},extend:bK,throttle:fL,closest:ya,toggleClass:to,clone:gL,index:Ro,nextTick:_b,cancelNextTick:zC,detectDirection:_L,getChild:am,expando:ks};Gt.get=function(t){return t[ks]};Gt.mount=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Gt.utils=_l(_l({},Gt.utils),r.utils)),iv.mount(r)})};Gt.create=function(t,e){return new Gt(t,e)};Gt.version=vK;var Qr=[],my,OC,RC=!1,QS,eT,Zx,gy;function NK(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(i){var r=i.originalEvent;this.sortable.nativeDraggable?vi(document,"dragover",this._handleAutoScroll):this.options.supportPointer?vi(document,"pointermove",this._handleFallbackAutoScroll):r.touches?vi(document,"touchmove",this._handleFallbackAutoScroll):vi(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(i){var r=i.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?mi(document,"dragover",this._handleAutoScroll):(mi(document,"pointermove",this._handleFallbackAutoScroll),mi(document,"touchmove",this._handleFallbackAutoScroll),mi(document,"mousemove",this._handleFallbackAutoScroll)),nD(),bb(),xK()},nulling:function(){Zx=OC=my=RC=gy=QS=eT=null,Qr.length=0},_handleFallbackAutoScroll:function(i){this._handleAutoScroll(i,!0)},_handleAutoScroll:function(i,r){var o=this,h=(i.touches?i.touches[0]:i).clientX,d=(i.touches?i.touches[0]:i).clientY,a=document.elementFromPoint(h,d);if(Zx=i,r||this.options.forceAutoScrollFallback||tv||xc||Uy){tT(i,this.options,a,r);var v=Pu(a,!0);RC&&(!gy||h!==QS||d!==eT)&&(gy&&nD(),gy=setInterval(function(){var T=Pu(document.elementFromPoint(h,d),!0);T!==v&&(v=T,bb()),tT(i,o.options,T,r)},10),QS=h,eT=d)}else{if(!this.options.bubbleScroll||Pu(a,!0)===yl()){bb();return}tT(i,this.options,Pu(a,!1),!1)}}},_c(t,{pluginName:"scroll",initializeByDefault:!0})}function bb(){Qr.forEach(function(t){clearInterval(t.pid)}),Qr=[]}function nD(){clearInterval(gy)}var tT=fL(function(t,e,i,r){if(e.scroll){var o=(t.touches?t.touches[0]:t).clientX,h=(t.touches?t.touches[0]:t).clientY,d=e.scrollSensitivity,a=e.scrollSpeed,v=yl(),T=!1,E;OC!==i&&(OC=i,bb(),my=e.scroll,E=e.scrollFn,my===!0&&(my=Pu(i,!0)));var k=0,L=my;do{var O=L,H=rn(O),ie=H.top,pe=H.bottom,be=H.left,Ce=H.right,Pe=H.width,Ie=H.height,ke=void 0,Ke=void 0,qe=O.scrollWidth,dt=O.scrollHeight,ft=Vt(O),et=O.scrollLeft,We=O.scrollTop;O===v?(ke=Pe<qe&&(ft.overflowX==="auto"||ft.overflowX==="scroll"||ft.overflowX==="visible"),Ke=Ie<dt&&(ft.overflowY==="auto"||ft.overflowY==="scroll"||ft.overflowY==="visible")):(ke=Pe<qe&&(ft.overflowX==="auto"||ft.overflowX==="scroll"),Ke=Ie<dt&&(ft.overflowY==="auto"||ft.overflowY==="scroll"));var Be=ke&&(Math.abs(Ce-o)<=d&&et+Pe<qe)-(Math.abs(be-o)<=d&&!!et),ge=Ke&&(Math.abs(pe-h)<=d&&We+Ie<dt)-(Math.abs(ie-h)<=d&&!!We);if(!Qr[k])for(var De=0;De<=k;De++)Qr[De]||(Qr[De]={});(Qr[k].vx!=Be||Qr[k].vy!=ge||Qr[k].el!==O)&&(Qr[k].el=O,Qr[k].vx=Be,Qr[k].vy=ge,clearInterval(Qr[k].pid),(Be!=0||ge!=0)&&(T=!0,Qr[k].pid=setInterval((function(){r&&this.layer===0&&Gt.active._onTouchMove(Zx);var Je=Qr[this.layer].vy?Qr[this.layer].vy*a:0,Qe=Qr[this.layer].vx?Qr[this.layer].vx*a:0;typeof E=="function"&&E.call(Gt.dragged.parentNode[ks],Qe,Je,t,Zx,Qr[this.layer].el)!=="continue"||mL(Qr[this.layer].el,Qe,Je)}).bind({layer:k}),24))),k++}while(e.bubbleScroll&&L!==v&&(L=Pu(L,!1)));RC=T}},30),SL=function(e){var i=e.originalEvent,r=e.putSortable,o=e.dragEl,h=e.activeSortable,d=e.dispatchSortableEvent,a=e.hideGhostForTarget,v=e.unhideGhostForTarget;if(i){var T=r||h;a();var E=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:i,k=document.elementFromPoint(E.clientX,E.clientY);v(),T&&!T.el.contains(k)&&(d("spill"),this.onSpill({dragEl:o,putSortable:r}))}};function R$(){}R$.prototype={startIndex:null,dragStart:function(e){var i=e.oldDraggableIndex;this.startIndex=i},onSpill:function(e){var i=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var o=am(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(i,o):this.sortable.el.appendChild(i),this.sortable.animateAll(),r&&r.animateAll()},drop:SL};_c(R$,{pluginName:"revertOnSpill"});function L$(){}L$.prototype={onSpill:function(e){var i=e.dragEl,r=e.putSortable,o=r||this.sortable;o.captureAnimationState(),i.parentNode&&i.parentNode.removeChild(i),o.animateAll()},drop:SL};_c(L$,{pluginName:"removeOnSpill"});Gt.mount(new NK);Gt.mount(L$,R$);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const pw=new Set,BK={ghostClass:"calcite-sortable--ghost",chosenClass:"calcite-sortable--chosen",dragClass:"calcite-sortable--drag",fallbackClass:"calcite-sortable--fallback"};function jK(t){if(CL(t))return;TL(t),pw.add(t);const e="id",{group:i,handleSelector:r,dragSelector:o,sortDisabled:h}=t;t.sortable=Gt.create(t.el,{dataIdAttr:e,swapThreshold:.5,...BK,...!!o&&{draggable:o},...!!i&&{sort:!h,group:{name:i,...!!t.canPull&&{pull:(d,a,v,{newDraggableIndex:T,oldDraggableIndex:E})=>t.canPull({toEl:d.el,fromEl:a.el,dragEl:v,newIndex:T,oldIndex:E})},...!!t.canPut&&{put:(d,a,v,{newDraggableIndex:T,oldDraggableIndex:E})=>t.canPut({toEl:d.el,fromEl:a.el,dragEl:v,newIndex:T,oldIndex:E})}}},onMove:({from:d,dragged:a,to:v,related:T})=>{t.onDragMove&&t.onDragMove({fromEl:d,dragEl:a,toEl:v,relatedEl:T})},handle:r,filter:`${r}[disabled]`,onStart:({from:d,item:a,to:v,newDraggableIndex:T,oldDraggableIndex:E})=>{LC.active=!0,UK(),t.onDragStart({fromEl:d,dragEl:a,toEl:v,newIndex:T,oldIndex:E})},onEnd:({from:d,item:a,to:v,newDraggableIndex:T,oldDraggableIndex:E})=>{LC.active=!1,VK(),t.onDragEnd({fromEl:d,dragEl:a,toEl:v,newIndex:T,oldIndex:E})},onSort:({from:d,item:a,to:v,newDraggableIndex:T,oldDraggableIndex:E})=>{t.onDragSort({fromEl:d,dragEl:a,toEl:v,newIndex:T,oldIndex:E})}})}function TL(t){CL(t)||(pw.delete(t),t.sortable?.destroy(),t.sortable=null)}const LC={active:!1};function CL(t){return t.dragEnabled&&LC.active}function UK(){Array.from(pw).forEach(t=>t.onGlobalDragStart())}function VK(){Array.from(pw).forEach(t=>t.onGlobalDragEnd())}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Jl={container:"container",table:"table",scrim:"scrim",stack:"stack",tableContainer:"table-container",sticky:"sticky-pos",assistiveText:"assistive-text",containerHeight:"container-height"},iT={filterNoResults:"filter-no-results",filterActionsStart:"filter-actions-start",filterActionsEnd:"filter-actions-end"},GK=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{position:relative;background-color:var(--calcite-list-background-color, var(--calcite-color-foreground-1))}.container-height{block-size:100%}.table-container{box-sizing:border-box;display:flex;inline-size:100%;flex-direction:column;background-color:transparent}.table-container *{box-sizing:border-box}.table{inline-size:100%}.stack{--calcite-stack-padding-inline: 0;--calcite-stack-padding-block: 0}.sticky-pos{position:sticky;inset-block-start:0px;z-index:var(--calcite-z-index-sticky);background-color:var(--calcite-list-background-color, var(--calcite-color-foreground-1))}.assistive-text{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}:host([hidden]){display:none}[hidden]{display:none}`,qK=`${Ux}, ${mc}`,R1=class R1 extends Vi{constructor(){super(),this.dragSelector=mc,this.focusableItems=[],this.handleSelector="calcite-sort-handle",this.listItems=[],this.listItemGroups=[],this.mutationObserver=Ho("mutation",()=>{this.willPerformFilter=!0,this.updateListItemsDebounced()}),this.cancelable=D$()(this),this.updateListItemsDebounced=lw(this.updateListItems,m$.nextTick),this.visibleItems=[],this.willFilterEmit=!1,this.willPerformFilter=!1,this.messages=go({blocking:!0}),this.focusSetter=Rs()(this),this.dataForFilter=[],this.hasFilterActionsEnd=!1,this.hasFilterActionsStart=!1,this.hasFilterNoResults=!1,this.sortHandleMenuItems=[],this.disabled=!1,this.dragEnabled=!1,this.filterEnabled=!1,this.filteredData=[],this.filteredItems=[],this.interactionMode="interactive",this.loading=!1,this.displayMode="flat",this.scale="m",this.selectedItems=[],this.selectionAppearance="icon",this.selectionMode="none",this.sortDisabled=!1,this.calciteInternalListDefaultSlotChange=vt({cancelable:!1}),this.calciteListChange=vt({cancelable:!1}),this.calciteListDragEnd=vt({cancelable:!1}),this.calciteListDragStart=vt({cancelable:!1}),this.calciteListFilter=vt({cancelable:!1}),this.calciteListMoveHalt=vt({cancelable:!1}),this.calciteListOrderChange=vt({cancelable:!1}),this.listen("calciteInternalListItemToggle",this.handleCalciteListItemToggle),this.listen("calciteInternalFocusPreviousItem",this.handleCalciteInternalFocusPreviousItem),this.listen("calciteInternalListItemActive",this.handleCalciteInternalListItemActive),this.listen("calciteListItemSelect",this.handleCalciteListItemSelect),this.listen("calciteInternalAssistiveTextChange",this.handleCalciteInternalAssistiveTextChange),this.listen("calciteListItemSortHandleBeforeOpen",this.updateListItemsDebounced),this.listen("calciteSortHandleReorder",this.handleSortReorder),this.listen("calciteSortHandleMove",this.handleSortMove),this.listen("calciteSortHandleAdd",this.handleSortAdd),this.listen("calciteInternalListItemSelect",this.handleCalciteInternalListItemSelect),this.listen("calciteInternalListItemSelectMultiple",this.handleCalciteInternalListItemSelectMultiple),this.listen("calciteInternalListItemChange",this.handleCalciteInternalListItemChange),this.listen("calciteInternalListItemGroupDefaultSlotChange",this.handleCalciteInternalListItemGroupDefaultSlotChange)}get hasActiveFilter(){return this.filterEnabled&&this.filterText&&this.filteredItems.length!==this.visibleItems.length}get showNoResultsContainer(){return this.filterEnabled&&this.filterText&&this.hasFilterNoResults&&this.visibleItems.length&&!this.filteredItems.length}async setFocus(e){return this.focusSetter(()=>this.filterEnabled?this.filterEl:this.focusableItems.find(i=>i.active),e)}emitOrderChangeEvent(e){this.calciteListOrderChange.emit(e)}connectedCallback(){super.connectedCallback(),this.connectObserver(),this.willPerformFilter=!0,this.updateListItemsDebounced(),this.setUpSorting(),this.setParentList(),this.setListItemGroups(),this.cancelable.add(this.updateListItemsDebounced)}async load(){this.handleInteractionModeWarning()}willUpdate(e){(e.has("filterText")||e.has("filterProps")||e.has("filterPredicate"))&&this.performFilter(),(e.has("filterEnabled")&&(this.hasUpdated||this.filterEnabled!==!1)||e.has("group")||e.has("sortDisabled")&&(this.hasUpdated||this.sortDisabled!==!1)||e.has("dragEnabled")&&(this.hasUpdated||this.dragEnabled!==!1)||e.has("selectionMode")&&(this.hasUpdated||this.selectionMode!=="none")||e.has("selectionAppearance")&&(this.hasUpdated||this.selectionAppearance!=="icon")||e.has("displayMode")&&this.hasUpdated||e.has("scale")&&this.hasUpdated||e.has("canPull")&&this.hasUpdated||e.has("canPut")&&this.hasUpdated||e.has("filterPredicate")&&this.hasUpdated)&&this.handleListItemChange()}updated(){yo(this)}disconnectedCallback(){super.disconnectedCallback(),this.disconnectObserver(),TL(this)}updateListItems(){this.updateGroupItems();const{selectionAppearance:e,selectionMode:i,interactionMode:r,dragEnabled:o,el:h,filterEl:d,displayMode:a,scale:v,sortDisabled:T,sortHandleMenuItems:E}=this,k=Array.from(this.el.querySelectorAll(mc)),L=h,O=Array.from(L.children).filter(F_);if(k.forEach(H=>{H.scale=v,H.selectionAppearance=e,H.selectionMode=i,H.interactionMode=r,H.closest(jy)===h&&(H.moveToItems=E.filter(ie=>this.validateSortMenuItem({type:"move",fromEl:L,toEl:ie.element,dragEl:H,newIndex:0,oldIndex:O.indexOf(H)})),H.addToItems=this.sortHandleMenuItems.filter(ie=>this.validateSortMenuItem({type:"add",fromEl:L,toEl:ie.element,dragEl:H,newIndex:0,oldIndex:O.indexOf(H)})),H.dragHandle=o,H.displayMode=a,H.sortDisabled=T)}),this.parentListEl){this.setUpSorting();return}this.listItems=k,this.filterEnabled&&this.willPerformFilter&&(this.willPerformFilter=!1,this.dataForFilter=this.getItemData(),d&&(d.items=this.dataForFilter,this.filterAndUpdateData())),this.visibleItems=this.listItems.filter(H=>!H.closed&&!H.hidden),this.updateFilteredItems(),this.borderItems(),this.focusableItems=this.filteredItems.filter(H=>!H.disabled),this.setActiveListItem(),this.updateSelectedItems(),this.setUpSorting()}handleListItemChange(){this.willPerformFilter=!0,this.updateListItemsDebounced()}handleCalciteListItemToggle(e){this.parentListEl||(e.stopPropagation(),this.borderItems())}handleCalciteInternalFocusPreviousItem(e){if(this.parentListEl)return;e.stopPropagation();const{focusableItems:i}=this,o=i.findIndex(h=>h.active)-1;i[o]&&this.focusRow(i[o])}handleCalciteInternalListItemActive(e){if(this.parentListEl)return;e.stopPropagation();const i=e.target,{listItems:r}=this;r.forEach(o=>{o.active=o===i})}handleCalciteListItemSelect(){this.parentListEl||this.updateSelectedItems(!0)}handleCalciteInternalAssistiveTextChange(e){this.assistiveText=e.detail.message,e.stopPropagation()}handleSortReorder(e){this.parentListEl||e.defaultPrevented||(e.preventDefault(),this.handleReorder(e))}handleSortAdd(e){this.parentListEl||e.defaultPrevented||(e.preventDefault(),this.handleAdd(e))}handleSortMove(e){this.parentListEl||e.defaultPrevented||(e.preventDefault(),this.handleMove(e))}handleCalciteInternalListItemSelect(e){if(this.parentListEl)return;e.stopPropagation();const i=e.target,{listItems:r,selectionMode:o}=this;i.selected&&(o==="single"||o==="single-persist")&&r.forEach(h=>h.selected=h===i),this.updateSelectedItems()}handleCalciteInternalListItemSelectMultiple(e){if(this.parentListEl)return;e.stopPropagation();const{target:i,detail:r}=e,{focusableItems:o,lastSelectedInfo:h}=this,d=i;if(r.selectMultiple&&h){const a=o.indexOf(d),v=o.indexOf(h.selectedItem),T=Math.min(v,a),E=Math.max(v,a);o.slice(T,E+1).forEach(k=>k.selected=h.selected)}else this.lastSelectedInfo={selectedItem:d,selected:d.selected}}handleCalciteInternalListItemChange(e){this.parentListEl||(e.stopPropagation(),this.updateListItemsDebounced())}handleCalciteInternalListItemGroupDefaultSlotChange(e){e.stopPropagation()}connectObserver(){this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}disconnectObserver(){this.mutationObserver?.disconnect()}setUpSorting(){const{dragEnabled:e,defaultSlotEl:i}=this;e&&(i&&pK(i),jK(this))}onGlobalDragStart(){this.disconnectObserver()}onGlobalDragEnd(){this.connectObserver()}onDragEnd(e){this.calciteListDragEnd.emit(e)}onDragStart(e){e.dragEl.sortHandleOpen=!1,this.calciteListDragStart.emit(e)}onDragSort(e){this.setParentList(),this.updateListItemsDebounced(),this.calciteListOrderChange.emit(e)}setParentList(){this.parentListEl=this.el.parentElement?.closest(jy)}handleDefaultSlotChange(){this.parentListEl&&this.calciteInternalListDefaultSlotChange.emit()}setListItemGroups(){this.listItemGroups=Array.from(this.el.querySelectorAll(Ux))}handleFilterActionsStartSlotChange(e){this.hasFilterActionsStart=$r(e)}handleFilterActionsEndSlotChange(e){this.hasFilterActionsEnd=$r(e)}handleFilterNoResultsSlotChange(e){this.hasFilterNoResults=$r(e)}setActiveListItem(){const{focusableItems:e}=this;e.some(i=>i.active)||e[0]&&(e[0].active=!0)}async updateSelectedItems(e=!1){await this.updateComplete,this.selectedItems=this.visibleItems.filter(i=>i.selected),e&&this.calciteListChange.emit()}filterElements({el:e,filteredItems:i,visibleParents:r}){const o=!r.has(e)&&!i.includes(e);e.filterHidden=o;const h=e.parentElement.closest(qK);h&&(o||r.add(h),this.filterElements({el:h,filteredItems:i,visibleParents:r}))}allParentListItemsExpanded(e){const i=e.parentElement?.closest(mc);if(i){if(!i.expanded)return!1}else return!0;return this.allParentListItemsExpanded(i)}borderItems(){const e=this.visibleItems.filter(i=>!i.filterHidden&&this.allParentListItemsExpanded(i));e.forEach(i=>i.bordered=i!==e[e.length-1])}updateFilteredItems(){const{visibleItems:e,filteredData:i,filterText:r,filterPredicate:o}=this,h=e?.filter(v=>e.every(T=>T===v||!v.contains(T))),d=o?e.filter(o):r?i.map(v=>v.el):e||[],a=new WeakSet;h.forEach(v=>this.filterElements({el:v,filteredItems:d,visibleParents:a})),this.filteredItems=d,this.willFilterEmit&&(this.willFilterEmit=!1,this.calciteListFilter.emit())}updateFilteredData(){const{filterEl:e}=this;e&&(e.filteredItems&&(this.filteredData=e.filteredItems),this.updateListItemsDebounced())}async filterAndUpdateData(){await this.filterEl?.filter(this.filterText),this.updateFilteredData()}get effectiveFilterProps(){return this.filterProps?this.filterProps.filter(e=>e!=="el"):["description","label","metadata","heading"]}performFilter(){const{filterEl:e,filterText:i,effectiveFilterProps:r}=this;e&&(e.value=i,e.filterProps=r,this.filterAndUpdateData())}setDefaultSlotEl(e){this.defaultSlotEl=e}setFilterEl(e){this.filterEl=e,this.performFilter()}handleFilterChange(e){e.stopPropagation();const{value:i}=e.currentTarget;this.filterText=i,this.willFilterEmit=!0,this.updateFilteredData()}getItemData(){return this.listItems.map(e=>({label:e.label,description:e.description,metadata:e.metadata,heading:this.getGroupHeading(e),el:e}))}getGroupHeading(e){return this.listItemGroups.filter(r=>r.contains(e)).map(r=>r.heading)}updateGroupItems(){const{el:e,group:i,scale:r}=this,o=ew(e),h=i?Array.from(o.querySelectorAll(`${jy}[group="${i}"]`)).filter(a=>!a.disabled&&a.dragEnabled):[];this.sortHandleMenuItems=h.map(a=>({element:a,label:a.label??a.id,id:Hu()})),Array.from(this.el.querySelectorAll(Ux)).forEach(a=>{a.scale=r})}focusRow(e){const{focusableItems:i}=this;e&&(i.forEach(r=>r.active=r===e),e.setFocus())}isNavigable(e){const i=e.parentElement?.closest(mc);return i?i.expanded&&this.isNavigable(i):!0}handleListKeydown(e){if(e.defaultPrevented||this.parentListEl)return;const{key:i}=e,r=this.focusableItems.filter(h=>this.isNavigable(h)),o=r.findIndex(h=>h.active);if(i==="ArrowDown"){e.preventDefault();const h=e.target===this.filterEl?0:o+1;r[h]&&this.focusRow(r[h])}else if(i==="ArrowUp"){if(e.preventDefault(),o===0&&this.filterEnabled){this.filterEl.setFocus();return}const h=o-1;r[h]&&this.focusRow(r[h])}else if(i==="Home"){e.preventDefault();const h=r[0];h&&this.focusRow(h)}else if(i==="End"){e.preventDefault();const h=r[r.length-1];h&&this.focusRow(h)}}handleInteractionModeWarning(){this.interactionMode==="static"&&this.selectionMode!=="none"&&this.selectionAppearance==="border"&&console.warn('selection-appearance="border" requires interaction-mode="interactive"')}validateSortMenuItem({fromEl:e,toEl:i,dragEl:r,newIndex:o,oldIndex:h,type:d}){if(!e||!i||i===e||r.contains(i))return!1;const a=e.canPull?.({toEl:i,fromEl:e,dragEl:r,newIndex:o,oldIndex:h})??!0,v=i.canPut?.({toEl:i,fromEl:e,dragEl:r,newIndex:o,oldIndex:h})??!0;return(d==="add"?a==="clone":a===!0)&&v}handleAdd(e){const{addTo:i}=e.detail,r=e.target,o=r?.parentElement,h=i.element,a=Array.from(o.children).filter(F_).indexOf(r),v=0;if(!this.validateSortMenuItem({type:"add",fromEl:o,toEl:h,dragEl:r,newIndex:v,oldIndex:a}))return;r.sortHandleOpen=!1,this.disconnectObserver();const T=r.cloneNode();h.prepend(T),AC(r),this.updateListItemsDebounced(),this.connectObserver();const E={dragEl:r,fromEl:o,toEl:h,newIndex:v,oldIndex:a};this.calciteListOrderChange.emit(E),h.emitOrderChangeEvent(E)}handleMove(e){const{moveTo:i}=e.detail,r=e.target,o=r?.parentElement,h=i.element,a=Array.from(o.children).filter(F_).indexOf(r),v=0;if(!this.validateSortMenuItem({type:"move",fromEl:o,toEl:h,dragEl:r,newIndex:v,oldIndex:a}))return;r.sortHandleOpen=!1,this.disconnectObserver(),h.prepend(r),AC(r),this.updateListItemsDebounced(),this.connectObserver();const T={dragEl:r,fromEl:o,toEl:h,newIndex:v,oldIndex:a};this.calciteListOrderChange.emit(T),h.emitOrderChangeEvent(T)}handleReorder(e){const{reorder:i}=e.detail,r=e.target,o=r?.parentElement;if(!o)return;r.sortHandleOpen=!1;const h=Array.from(o.children).filter(F_),d=h.length-1,a=h.indexOf(r);let v=a;switch(i){case"top":v=0;break;case"bottom":v=d;break;case"up":v=a===0?0:a-1;break;case"down":v=a===d?d:a+1;break}this.disconnectObserver();const T=i==="up"||i==="top"?h[v]:h[v].nextSibling;o.insertBefore(r,T),this.updateListItemsDebounced(),this.connectObserver(),this.calciteListOrderChange.emit({dragEl:r,fromEl:o,toEl:o,newIndex:v,oldIndex:a})}render(){const{loading:e,label:i,disabled:r,dataForFilter:o,filterEnabled:h,filterPlaceholder:d,filterText:a,filterLabel:v,hasFilterActionsStart:T,hasFilterActionsEnd:E,effectiveFilterProps:k}=this;return vo({disabled:this.disabled,children:Fe`<div class=${Le({[Jl.container]:!0,[Jl.containerHeight]:this.listItems.length<1&&e})}>${this.dragEnabled?Fe`<span aria-live=assertive class=${Le(Jl.assistiveText)}>${this.assistiveText}</span>`:null}${this.renderItemAriaLive()}${e?Fe`<calcite-scrim class=${Le(Jl.scrim)} .loading=${e}></calcite-scrim>`:null}<div .ariaBusy=${e} .ariaLabel=${i||""} class=${Le(Jl.table)} @keydown=${this.handleListKeydown} role=treegrid>${h||T||E?Fe`<div class=${Le(Jl.sticky)} role=rowgroup><div role=row><div role=columnheader><calcite-stack class=${Le(Jl.stack)}><slot name=${iT.filterActionsStart} @slotchange=${this.handleFilterActionsStartSlotChange} slot=${yf.actionsStart}></slot><calcite-filter .ariaLabel=${d} .disabled=${r} .filterProps=${k} .items=${o} .label=${v} @calciteFilterChange=${this.handleFilterChange} .placeholder=${d} .scale=${this.scale} .value=${a} ${hi(this.setFilterEl)}></calcite-filter><slot name=${iT.filterActionsEnd} @slotchange=${this.handleFilterActionsEndSlotChange} slot=${yf.actionsEnd}></slot></calcite-stack></div></div></div>`:null}<div class=${Le(Jl.tableContainer)} role=rowgroup><slot @slotchange=${this.handleDefaultSlotChange} ${hi(this.setDefaultSlotEl)}></slot></div></div><div aria-live=polite data-test-id=no-results-container .hidden=${!this.showNoResultsContainer}><slot name=${iT.filterNoResults} @slotchange=${this.handleFilterNoResultsSlotChange}></slot></div></div>`})}renderItemAriaLive(){const{messages:e,filteredItems:i,parentListEl:r,messages:{_lang:o},numberingSystem:h}=this;return Oo.numberFormatOptions={locale:o,numberingSystem:h},r?null:Fe`<div aria-live=polite class=${Le(Jl.assistiveText)}>${this.hasActiveFilter?ai("aria-filter-enabled",Fe`<div>${e.filterEnabled}</div>`):null}${ai("aria-item-count",Fe`<div>${e.total.replace("{count}",Oo.localize(i.length.toString()))}</div>`)}${i.length?ai("aria-item-list",Fe`<ol>${i.map(d=>Fe`<li>${d.label}</li>`)}</ol>`):null}</div>`}};R1.properties={assistiveText:[16,{},{state:!0}],dataForFilter:[16,{},{state:!0}],hasFilterActionsEnd:[16,{},{state:!0}],hasFilterActionsStart:[16,{},{state:!0}],hasFilterNoResults:[16,{},{state:!0}],sortHandleMenuItems:[16,{},{state:!0}],canPull:[0,{},{attribute:!1}],canPut:[0,{},{attribute:!1}],disabled:[7,{},{reflect:!0,type:Boolean}],dragEnabled:[7,{},{reflect:!0,type:Boolean}],filterEnabled:[7,{},{reflect:!0,type:Boolean}],filterPredicate:[0,{},{attribute:!1}],filterLabel:[3,{},{reflect:!0}],filterPlaceholder:[3,{},{reflect:!0}],filterProps:[0,{},{attribute:!1}],filterText:[3,{},{reflect:!0}],filteredData:[0,{},{attribute:!1}],filteredItems:[0,{},{attribute:!1}],group:[3,{},{reflect:!0}],interactionMode:[3,{},{reflect:!0}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}],displayMode:[3,{},{reflect:!0}],numberingSystem:1,scale:[3,{},{reflect:!0}],selectedItems:[0,{},{attribute:!1}],selectionAppearance:[3,{},{reflect:!0}],selectionMode:[3,{},{reflect:!0}],sortDisabled:[7,{},{reflect:!0,type:Boolean}]},R1.styles=GK;let FC=R1;lr("calcite-list",FC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const fi={actionsEnd:"actions-end",actionsStart:"actions-start",description:"description",close:"close",container:"container",containerHover:"container--hover",containerBorder:"container--border",containerBorderSelected:"container--border-selected",containerBorderUnselected:"container--border-unselected",content:"content",contentBottom:"content-bottom",contentContainer:"content-container",contentContainerHasCenterContent:"content-container--has-center-content",contentContainerSelectable:"content-container--selectable",contentContainerUnavailable:"content-container--unavailable",contentContainerWrapper:"content-container-wrapper",contentContainerWrapperBordered:"content-container-wrapper--bordered",contentEnd:"content-end",contentStart:"content-start",customContent:"custom-content",expandedContainer:"expanded-container",dragContainer:"drag-container",gridCell:"grid-cell",icon:"icon",nestedContainer:"nested-container",nestedContainerExpanded:"nested-container--expanded",label:"label",row:"row",selectionContainer:"selection-container",selectionContainerSingle:"selection-container--single",wrapper:"wrapper",wrapperBordered:"wrapper--bordered"},Gp={actionsStart:"actions-start",contentStart:"content-start",content:"content",contentBottom:"content-bottom",contentEnd:"content-end",actionsEnd:"actions-end"},HK=0,Kl={selectedMultiple:"check-square-f",selectedSingle:"circle-inset-large",unselectedMultiple:"square",unselectedSingle:"circle",collapsedLTR:"chevron-right",collapsedRTL:"chevron-left",open:"chevron-down",blank:"blank",close:"x"},sD="data-test-active";/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const oD={container:"container",heading:"heading"},ZK=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;flex-direction:column}:host([filter-hidden]){display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{margin:0;display:flex;flex:1 1 0%;background-color:var(--calcite-list-background-color, var(--calcite-color-foreground-1));color:var(--calcite-list-color, var(--calcite-color-text-2))}.heading{font-weight:var(--calcite-font-weight-medium)}:host([scale=s]) .container{padding-inline:var(--calcite-spacing-sm)}:host([scale=s]) .heading{font-size:var(--calcite-font-size-sm);line-height:var(--calcite-font-line-height-fixed-base);padding-block:var(--calcite-spacing-sm) var(--calcite-spacing-xxs)}:host([scale=s]:not(:first-child)) .container{padding-block-start:var(--calcite-spacing-sm)}:host([scale=m]) .container{padding-inline:var(--calcite-spacing-md)}:host([scale=m]) .heading{font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-fixed-base);padding-block:var(--calcite-spacing-lg) var(--calcite-spacing-sm)}:host([scale=m]:not(:first-child)) .container{padding-block-start:var(--calcite-spacing-md)}:host([scale=l]) .container{padding-inline:var(--calcite-spacing-lg)}:host([scale=l]) .heading{font-size:var(--calcite-font-size-md);line-height:var(--calcite-font-line-height-fixed-lg);padding-block:var(--calcite-spacing-xl) var(--calcite-spacing-sm-plus, .625rem)}:host([scale=l]:not(:first-child)) .container{padding-block-start:var(--calcite-spacing-md-plus, .875rem)}.heading{padding:0}:host([hidden]){display:none}[hidden]{display:none}`,L1=class L1 extends Vi{constructor(){super(...arguments),this.disabled=!1,this.filterHidden=!1,this.scale="m",this.calciteInternalListItemGroupDefaultSlotChange=vt({cancelable:!1})}updated(){yo(this)}handleDefaultSlotChange(){this.calciteInternalListItemGroupDefaultSlotChange.emit()}render(){const{disabled:e,heading:i}=this;return vo({disabled:e,children:Fe`<div class=${Le(oD.container)} role=row><div .ariaColSpan=${HK} class=${Le(oD.heading)} role=cell>${i}</div></div><slot @slotchange=${this.handleDefaultSlotChange}></slot>`})}};L1.properties={disabled:[7,{},{reflect:!0,type:Boolean}],filterHidden:[7,{},{reflect:!0,type:Boolean}],heading:[3,{},{reflect:!0}],scale:[3,{},{reflect:!0}]},L1.styles=ZK;let NC=L1;lr("calcite-list-item-group",NC);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const WK=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:flex;flex-direction:column}:host([filter-hidden]),:host([closed]){display:none}.wrapper--bordered{border-block-end:1px solid var(--calcite-list-border-color, var(--calcite-color-border-3))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.container{box-sizing:border-box;display:flex;flex:1 1 0%;overflow:hidden;background-color:var(--calcite-list-background-color, var(--calcite-color-foreground-1))}.container *{box-sizing:border-box}.container--hover:hover{cursor:pointer;background-color:var(--calcite-list-background-color-hover, var(--calcite-color-foreground-2))}.container:active{background-color:var(--calcite-list-background-color-press, var(--calcite-color-foreground-3))}.container--border{position:relative}.container--border:before{position:absolute;inline-size:var(--calcite-border-width-lg);inset-block:0;inset-inline-start:0;background-color:transparent;content:""}.container--border-selected:before{background-color:var(--calcite-list-selection-border-color, var(--calcite-color-brand))}.container--border-selected:focus{box-shadow:inset var(--calcite-border-width-lg) 0 0 0 var(--calcite-list-selection-border-color, var(--calcite-color-brand))}.nested-container{display:none;flex-direction:column;border-width:0px;border-style:solid;border-color:1px solid var(--calcite-list-border-color, var(--calcite-color-border-3));margin-inline-start:var(--calcite-list-spacing-indent, 1.5rem)}.nested-container--expanded{display:flex}.selection-container{display:flex;padding-block:0px;color:var(--calcite-list-icon-color, var(--calcite-color-border-input))}:host(:not([disabled]):not([selected])) .container:hover .selection-container--single{color:var(--calcite-list-icon-color, var(--calcite-color-border-input))}:host([selected]:hover) .selection-container,:host([selected]:hover) .selection-container--single,:host([selected]) .selection-container{color:var(--calcite-list-icon-color, var(--calcite-color-brand))}.content-container-wrapper{display:flex;flex:1 1 auto}.content-container-wrapper--bordered{border-block-end:1px solid var(--calcite-list-border-color, var(--calcite-color-border-3))}.content-container{display:flex;flex:1 1 auto;-webkit-user-select:none;user-select:none;align-items:stretch;font-weight:var(--calcite-font-weight-normal);color:var(--calcite-list-content-text-color, var(--calcite-color-text-2))}.content-container--unavailable{opacity:var(--calcite-opacity-disabled)}.row,.grid-cell{outline-color:transparent}.row{position:relative}.row:focus,.grid-cell:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.content,.custom-content{display:flex;flex:1 1 auto;flex-direction:column;justify-content:center;line-height:var(--calcite-font-line-height-relative-snug)}.label{color:var(--calcite-list-label-text-color, var(--calcite-color-text-1))}.description{color:var(--calcite-list-description-text-color, var(--calcite-color-text-3))}.icon{align-self:center;color:var(--calcite-list-icon-color, var(--calcite-color-text-3))}.icon:hover,.icon:active{color:var(--calcite-color-text-1)}:host([display-mode=flat][drag-handle]:is([selection-mode=none],[selection-appearance=border])) .drag-container{padding-inline-end:var(--calcite-spacing-xxs)}:host([scale=s]) .actions-start{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .content-container{gap:var(--calcite-spacing-sm);min-block-size:32px;padding-block:var(--calcite-spacing-xxs);padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .content,:host([scale=s]) .custom-content,:host([scale=s]) .label{font-size:var(--calcite-font-size--2)}:host([scale=s]) .description{font-size:var(--calcite-font-size--3)}:host([scale=s][display-mode=flat]:not([drag-handle])) .container{padding-inline-start:var(--calcite-spacing-sm)}:host([scale=s][display-mode=flat]:not([drag-handle])) .selection-container{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=s][display-mode=flat][drag-handle]) .selection-container{padding-inline:var(--calcite-spacing-xxs) var(--calcite-spacing-sm)}:host([scale=s][display-mode=nested]) .selection-container{padding-inline-end:var(--calcite-spacing-xxs)}:host([scale=s][display-mode=nested][selection-appearance=icon]:not([selection-mode=none]):not([drag-handle])) .container{padding-inline-start:var(--calcite-spacing-sm)}:host([scale=s][display-mode=nested][selection-appearance=icon]:not([selection-mode=none]):not([drag-handle])) .selection-container{padding-inline-end:var(--calcite-spacing-xxs)}:host([scale=s][display-mode=nested][drag-handle]) .selection-container{padding-inline:var(--calcite-spacing-xxs)}:host([scale=m]) .actions-start{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=m]) .content-container{gap:var(--calcite-spacing-sm);min-block-size:40px;padding-block:var(--calcite-spacing-sm);padding-inline-end:var(--calcite-spacing-md)}:host([scale=m]) .content,:host([scale=m]) .custom-content{font-size:var(--calcite-font-size--2)}:host([scale=m]) .label{font-size:var(--calcite-font-size--1)}:host([scale=m]) .description{font-size:var(--calcite-font-size--2)}:host([scale=m][display-mode=flat]) .container{padding-inline-start:var(--calcite-spacing-md)}:host([scale=m][display-mode=flat]) .selection-container{padding-inline-end:var(--calcite-spacing-sm)}:host([scale=m][display-mode=flat][drag-handle]) .container{padding-inline-start:0}:host([scale=m][display-mode=flat][drag-handle]) .selection-container{padding-inline:var(--calcite-spacing-xxs) var(--calcite-spacing-sm)}:host([scale=m][display-mode=nested]) .container{padding-inline-start:var(--calcite-spacing-xxs)}:host([scale=m][display-mode=nested]) .selection-container{padding-inline-end:var(--calcite-spacing-xxs)}:host([scale=m][display-mode=nested][selection-appearance=icon]:not([selection-mode=none]):not([drag-handle])) .container{padding-inline-start:var(--calcite-spacing-md)}:host([scale=m][display-mode=nested][drag-handle]) .container{padding-inline-start:0}:host([scale=m][display-mode=nested][drag-handle]) .selection-container{padding-inline:var(--calcite-spacing-xxs)}:host([scale=l]) .actions-start{padding-inline-end:var(--calcite-spacing-md)}:host([scale=l]) .content-container{gap:var(--calcite-spacing-md);min-block-size:56px;padding-block:.625rem;padding-inline-end:var(--calcite-spacing-lg)}:host([scale=l]) .content,:host([scale=l]) .custom-content,:host([scale=l]) .label{font-size:var(--calcite-font-size-0)}:host([scale=l]) .description{font-size:var(--calcite-font-size--1)}:host([scale=l]) .nested-container{margin-inline-start:1.75rem}:host([scale=l][display-mode=flat]) .container{padding-inline-start:var(--calcite-spacing-lg)}:host([scale=l][display-mode=flat]) .selection-container{padding-inline-end:var(--calcite-spacing-md)}:host([scale=l][display-mode=flat][drag-handle]) .container{padding-inline-start:0}:host([scale=l][display-mode=flat][drag-handle]) .selection-container{padding-inline-end:var(--calcite-spacing-md)}:host([scale=l][display-mode=nested]) .container{padding-inline-start:var(--calcite-spacing-xxs)}:host([scale=l][display-mode=nested][drag-handle]) .container{padding-inline-start:0}:host([scale=l][display-mode=nested][selection-appearance=icon]:not([selection-mode=none]):not([drag-handle])) .container{padding-inline-start:var(--calcite-spacing-lg)}.label,.description,.content-bottom{font-family:var(--calcite-font-family);font-weight:var(--calcite-font-weight-normal);word-wrap:break-word;word-break:break-word}:host([selected]) .label{font-weight:var(--calcite-font-weight-medium)}:host([selected]) .icon{color:var(--calcite-list-icon-color, var(--calcite-color-text-1))}:host([selected]) .description{color:var(--calcite-list-description-text-color, var(--calcite-color-text-2))}.content-start{justify-content:flex-start}.content-end{justify-content:flex-end}.content-start,.content-end{flex:1 1 auto}.content-start ::slotted(calcite-icon),.content-end ::slotted(calcite-icon){align-self:center}.content-bottom{display:flex;flex-direction:column}.content-container--has-center-content .content-start,.content-container--has-center-content .content-end{flex:0 1 auto}.expanded-container{color:var(--calcite-list-icon-color, var(--calcite-color-text-3));padding-inline:var(--calcite-spacing-xxs)}:host(:not([disabled])) .expanded-container:hover{color:var(--calcite-list-icon-color, var(--calcite-color-text-1))}.actions-start,.actions-end,.content-start,.content-end,.selection-container,.drag-container,.expanded-container{display:flex;align-items:center}.actions-start calcite-action,.actions-start calcite-sort-handle,.actions-end calcite-action,.actions-end calcite-sort-handle,.content-start calcite-action,.content-start calcite-sort-handle,.content-end calcite-action,.content-end calcite-sort-handle,.selection-container calcite-action,.selection-container calcite-sort-handle,.drag-container calcite-action,.drag-container calcite-sort-handle,.expanded-container calcite-action,.expanded-container calcite-sort-handle{align-self:stretch}.drag-container,.selection-container,.expanded-container{padding-block-end:var(--calcite-spacing-px)}.expanded-container,.selection-container{cursor:pointer}.actions-start,.actions-end{position:relative;padding:0}.actions-start ::slotted(calcite-action),.actions-start ::slotted(calcite-action-menu),.actions-start ::slotted(calcite-sort-handle),.actions-start ::slotted(calcite-dropdown),.actions-end ::slotted(calcite-action),.actions-end ::slotted(calcite-action-menu),.actions-end ::slotted(calcite-sort-handle),.actions-end ::slotted(calcite-dropdown){align-self:stretch;color:inherit}.row:focus .actions-start,.row:focus .actions-end{inset-block:.125rem}.row:focus .actions-start .close,.row:focus .actions-start ::slotted(calcite-action),.row:focus .actions-start ::slotted(calcite-action-menu),.row:focus .actions-start ::slotted(calcite-sort-handle),.row:focus .actions-start ::slotted(calcite-dropdown),.row:focus .actions-end .close,.row:focus .actions-end ::slotted(calcite-action),.row:focus .actions-end ::slotted(calcite-action-menu),.row:focus .actions-end ::slotted(calcite-sort-handle),.row:focus .actions-end ::slotted(calcite-dropdown){block-size:calc(100% - .25rem)}.row:focus:after,.row:focus:before{position:absolute;content:"";inline-size:.125rem;z-index:var(--calcite-z-index-header);background-color:var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));inset-block:0}.row:focus:before{inset-inline-start:0}.row:focus:after{inset-inline-end:0}.container--border:focus:before{display:none}::slotted(calcite-list:empty){border-block-start-width:0px}:host([hidden]){display:none}[hidden]{display:none}`,V_=new Map,F1=class F1 extends Vi{constructor(){super(),this.actionsEndRef=Xn(),this.actionsStartRef=Xn(),this.containerRef=Xn(),this.contentRef=Xn(),this.defaultSlotRef=Xn(),this.handleGridRef=Xn(),this.messages=go(),this.focusSetter=Rs()(this),this.hasActionsEnd=!1,this.hasActionsStart=!1,this.hasContentBottom=!1,this.hasContentEnd=!1,this.hasContentStart=!1,this.hasCustomContent=!1,this.level=null,this.expandable=!1,this.active=!1,this.bordered=!1,this.sortDisabled=!1,this.closable=!1,this.closed=!1,this.disabled=!1,this.dragDisabled=!1,this.dragHandle=!1,this.expanded=!1,this.filterHidden=!1,this.interactionMode=null,this.displayMode="flat",this.addToItems=[],this.moveToItems=[],this.scale="m",this.selected=!1,this.selectionAppearance=null,this.selectionMode=null,this.sortHandleOpen=!1,this.unavailable=!1,this.calciteInternalFocusPreviousItem=vt({cancelable:!1}),this.calciteInternalListItemActive=vt({cancelable:!1}),this.calciteInternalListItemChange=vt({cancelable:!1}),this.calciteInternalListItemSelect=vt({cancelable:!1}),this.calciteInternalListItemSelectMultiple=vt({cancelable:!1}),this.calciteInternalListItemToggle=vt({cancelable:!1}),this.calciteListItemClose=vt({cancelable:!1}),this.calciteListItemCollapse=vt({cancelable:!1}),this.calciteListItemExpand=vt({cancelable:!1}),this.calciteListItemSelect=vt({cancelable:!1}),this.calciteListItemSortHandleBeforeClose=vt({cancelable:!1}),this.calciteListItemSortHandleBeforeOpen=vt({cancelable:!1}),this.calciteListItemSortHandleClose=vt({cancelable:!1}),this.calciteListItemSortHandleOpen=vt({cancelable:!1}),this.calciteListItemToggle=vt({cancelable:!1}),this.listen("calciteInternalListItemGroupDefaultSlotChange",this.handleCalciteInternalListDefaultSlotChanges),this.listen("calciteInternalListDefaultSlotChange",this.handleCalciteInternalListDefaultSlotChanges)}get open(){return this.expanded}set open(e){Ix.deprecated("property",{name:"open",removalVersion:4,suggested:"expanded"}),this.expanded=e}async setFocus(e){return this.focusSetter(()=>{const{containerRef:i,parentListEl:r}=this,o=V_.get(r);if(typeof o=="number"){const h=this.getGridCells()[o];if(h){this.focusCell(h);return}}return{target:i.value,includeContainer:!0,strategy:"focusable"}},e)}connectedCallback(){super.connectedCallback();const{el:e}=this;this.parentListEl=e.closest(jy),this.level=fK(e)+1,this.setSelectionDefaults()}disconnectedCallback(){super.disconnectedCallback(),V_.clear()}willUpdate(e){e.has("active")&&(this.hasUpdated||this.active!==!1)&&this.activeHandler(this.active),e.has("closed")&&(this.hasUpdated||this.closed!==!1)&&this.handleClosedChange(),e.has("disabled")&&(this.hasUpdated||this.disabled!==!1)&&this.handleDisabledChange(),e.has("selected")&&(this.hasUpdated||this.selected!==!1)&&this.handleSelectedChange(),e.has("sortHandleOpen")&&(this.hasUpdated||this.sortHandleOpen!==!1)&&this.sortHandleOpenHandler(),e.has("displayMode")&&this.hasUpdated&&this.handleExpandableChange(this.defaultSlotRef.value),e.has("expanded")&&this.hasUpdated&&(this.expanded?(this.handleExpandedChange(),this.calciteListItemExpand.emit()):this.calciteListItemCollapse.emit())}updated(){yo(this)}activeHandler(e){e||this.focusCell(null,!1)}handleClosedChange(){this.emitCalciteInternalListItemChange()}handleDisabledChange(){this.emitCalciteInternalListItemChange()}handleExpandedChange(){this.emitCalciteInternalListItemToggle()}handleSelectedChange(){this.calciteInternalListItemSelect.emit()}sortHandleOpenHandler(){this.sortHandleEl&&(this.sortHandleEl.open=this.sortHandleOpen)}handleCalciteInternalListDefaultSlotChanges(e){e.stopPropagation(),this.handleExpandableChange(this.defaultSlotRef.value)}setSortHandleEl(e){this.sortHandleEl=e,this.sortHandleOpenHandler()}handleSortHandleBeforeOpen(e){e.stopPropagation(),this.calciteListItemSortHandleBeforeOpen.emit()}handleSortHandleBeforeClose(e){e.stopPropagation(),this.calciteListItemSortHandleBeforeClose.emit()}handleSortHandleClose(e){e.stopPropagation(),this.sortHandleOpen=!1,this.calciteListItemSortHandleClose.emit()}handleSortHandleOpen(e){e.stopPropagation(),this.sortHandleOpen=!0,this.calciteListItemSortHandleOpen.emit()}emitInternalListItemActive(){this.calciteInternalListItemActive.emit()}emitCalciteInternalListItemToggle(){this.calciteInternalListItemToggle.emit()}emitCalciteInternalListItemChange(){this.calciteInternalListItemChange.emit()}handleCloseClick(){this.closed=!0,this.calciteListItemClose.emit()}handleContentSlotChange(e){this.hasCustomContent=$r(e)}handleActionsStartSlotChange(e){this.hasActionsStart=$r(e)}handleActionsEndSlotChange(e){this.hasActionsEnd=$r(e)}handleContentStartSlotChange(e){this.hasContentStart=$r(e)}handleContentEndSlotChange(e){this.hasContentEnd=$r(e)}handleContentBottomSlotChange(e){this.hasContentBottom=$r(e)}setSelectionDefaults(){const{parentListEl:e,selectionMode:i,selectionAppearance:r}=this;e&&(i||(this.selectionMode=e.selectionMode),r||(this.selectionAppearance=e.selectionAppearance))}handleExpandableChange(e){if(!e)return;const i=dK(e);i.lists.forEach(r=>{r.displayMode=this.displayMode}),this.expandable=this.displayMode==="nested"&&(i.lists.length>0||i.items.length>0)}handleDefaultSlotChange(e){this.handleExpandableChange(e.target)}handleToggleClick(){this.toggle()}toggle(e=!this.expanded){this.expanded=e,this.calciteListItemToggle.emit()}handleItemClick(e){e.defaultPrevented||this.toggleSelected(e.shiftKey)}async toggleSelected(e){const{selectionMode:i,selected:r}=this;this.disabled||(i==="multiple"||i==="single"?this.selected=!r:i==="single-persist"&&(this.selected=!0),this.calciteInternalListItemSelectMultiple.emit({selectMultiple:e&&i==="multiple"}),await this.updateComplete,this.calciteListItemSelect.emit())}getGridCells(){return[this.handleGridRef.value,this.actionsStartRef.value,this.contentRef.value,this.actionsEndRef.value].filter(e=>e&&!e.hidden)}handleItemKeyDown(e){if(e.defaultPrevented)return;const{key:i}=e,r=e.composedPath(),{containerRef:o,actionsStartRef:{value:h},actionsEndRef:{value:d},expanded:a,expandable:v}=this,T=this.getGridCells(),E=T.findIndex(k=>r.includes(k));if(i==="Enter"&&!r.includes(h)&&!r.includes(d))e.preventDefault(),this.toggleSelected(e.shiftKey);else if(i==="ArrowRight"){e.preventDefault();const k=E+1;E===-1?!a&&v?(this.toggle(!0),this.focusCell(null)):T[0]&&this.focusCell(T[0]):T[E]&&T[k]&&this.focusCell(T[k])}else if(i==="ArrowLeft"){e.preventDefault();const k=E-1;E===-1?(this.focusCell(null),a&&v?this.toggle(!1):this.calciteInternalFocusPreviousItem.emit()):E===0?(this.focusCell(null),o.value.focus()):T[E]&&T[k]&&this.focusCell(T[k])}}focusCellNull(){this.focusCell(null)}setFocusCell(e,i,r){const{parentListEl:o}=this;r&&V_.set(o,null);const h=this.getGridCells();h.forEach(d=>{d.removeAttribute("tabindex"),d.removeAttribute(sD)}),e&&(e===i?e.tabIndex=0:e.removeAttribute("tabindex"),e.setAttribute(sD,""),r&&V_.set(o,h.indexOf(e)))}focusCell(e,i=!0){const r=mR(e);this.setFocusCell(e,r,i),r?.focus()}renderSelected(){const{selected:e,selectionMode:i,selectionAppearance:r}=this;return i==="none"||r==="border"?null:ai("selection-container",Fe`<div class=${Le({[fi.selectionContainer]:!0,[fi.selectionContainerSingle]:i==="single"||i==="single-persist"})} @click=${this.handleItemClick}><calcite-icon .icon=${e?i==="multiple"?Kl.selectedMultiple:Kl.selectedSingle:i==="multiple"?Kl.unselectedMultiple:Kl.unselectedSingle} .scale=${Ur(this.scale)}></calcite-icon></div>`)}renderDragHandle(){const{label:e,dragHandle:i,dragDisabled:r,setPosition:o,setSize:h,moveToItems:d,sortDisabled:a,addToItems:v}=this;return i?ai("drag-handle-container",Fe`<div .ariaLabel=${e} class=${Le({[fi.dragContainer]:!0,[fi.gridCell]:!0})} role=gridcell ${hi(this.handleGridRef)}><calcite-sort-handle .addToItems=${v} .disabled=${r} .label=${e} .moveToItems=${d} @calciteSortHandleBeforeClose=${this.handleSortHandleBeforeClose} @calciteSortHandleBeforeOpen=${this.handleSortHandleBeforeOpen} @calciteSortHandleClose=${this.handleSortHandleClose} @calciteSortHandleOpen=${this.handleSortHandleOpen} overlay-positioning=fixed .scale=${this.scale} .setPosition=${o} .setSize=${h} .sortDisabled=${a} ${hi(this.setSortHandleEl)}></calcite-sort-handle></div>`):null}renderExpanded(){const{el:e,expanded:i,expandable:r,messages:o,displayMode:h,scale:d}=this;if(h!=="nested")return null;const a=J0(e),v=r?i?Kl.open:a==="rtl"?Kl.collapsedRTL:Kl.collapsedLTR:Kl.blank,T=Ur(d),E=r?i?o.collapse:o.expand:void 0,k=r?this.handleToggleClick:void 0;return ai("expanded-container",Fe`<div class=${Le(fi.expandedContainer)} @click=${k} title=${E??ut}>${ai(v,Fe`<calcite-icon .icon=${v} .scale=${T}></calcite-icon>`)}</div>`)}renderActionsStart(){const{label:e,hasActionsStart:i}=this;return ai("actions-start-container",Fe`<div .ariaLabel=${e} class=${Le({[fi.actionsStart]:!0,[fi.gridCell]:!0})} .hidden=${!i} role=gridcell ${hi(this.actionsStartRef)}><slot name=${Gp.actionsStart} @slotchange=${this.handleActionsStartSlotChange}></slot></div>`)}renderActionsEnd(){const{label:e,hasActionsEnd:i,closable:r,messages:o}=this;return ai("actions-end-container",Fe`<div .ariaLabel=${e} class=${Le({[fi.actionsEnd]:!0,[fi.gridCell]:!0})} .hidden=${!(i||r)} role=gridcell ${hi(this.actionsEndRef)}><slot name=${Gp.actionsEnd} @slotchange=${this.handleActionsEndSlotChange}></slot>${r?ai("close-action",Fe`<calcite-action appearance=transparent class=${Le(fi.close)} .icon=${Kl.close} .label=${o.close} @click=${this.handleCloseClick} .scale=${this.scale} .text=${o.close}></calcite-action>`):null}</div>`)}renderContentStart(){const{hasContentStart:e}=this;return Fe`<div class=${Le(fi.contentStart)} .hidden=${!e}><slot name=${Gp.contentStart} @slotchange=${this.handleContentStartSlotChange}></slot></div>`}renderCustomContent(){const{hasCustomContent:e}=this;return Fe`<div class=${Le(fi.customContent)} .hidden=${!e}><slot name=${Gp.content} @slotchange=${this.handleContentSlotChange}></slot></div>`}renderIconStart(){const{iconStart:e,iconFlipRtl:i,scale:r}=this;return e?ai("icon-start",Fe`<calcite-icon class=${Le(fi.icon)} .flipRtl=${i==="both"||i==="start"} .icon=${e} .scale=${Ur(r)}></calcite-icon>`):null}renderIconEnd(){const{iconEnd:e,iconFlipRtl:i,scale:r}=this;return e?ai("icon-end",Fe`<calcite-icon class=${Le(fi.icon)} .flipRtl=${i==="both"||i==="end"} .icon=${e} .scale=${Ur(r)}></calcite-icon>`):null}renderContentEnd(){const{hasContentEnd:e}=this;return Fe`<div class=${Le(fi.contentEnd)} .hidden=${!e}><slot name=${Gp.contentEnd} @slotchange=${this.handleContentEndSlotChange}></slot></div>`}renderContentBottom(){const{hasContentBottom:e}=this;return Fe`<div class=${Le(fi.contentBottom)} .hidden=${!e}><slot name=${Gp.contentBottom} @slotchange=${this.handleContentBottomSlotChange}></slot></div>`}renderDefaultContainer(){return Fe`<div class=${Le({[fi.nestedContainer]:!0,[fi.nestedContainerExpanded]:this.expandable&&this.expanded})}><slot @slotchange=${this.handleDefaultSlotChange} ${hi(this.defaultSlotRef)}></slot></div>`}renderContentProperties(){const{label:e,description:i,hasCustomContent:r}=this;return!r&&(e||i)?ai("content",Fe`<div class=${Le(fi.content)}>${e?ai("label",Fe`<div class=${Le(fi.label)}>${e}</div>`):null}${i?ai("description",Fe`<div class=${Le(fi.description)}>${i}</div>`):null}</div>`):null}renderContentContainer(){const{description:e,label:i,selectionMode:r,hasCustomContent:o,unavailable:h}=this,d=o||!!i||!!e,a=[this.renderContentStart(),this.renderCustomContent(),this.renderIconStart(),this.renderContentProperties(),this.renderIconEnd(),this.renderContentEnd()];return ai("content-container",Fe`<div .ariaLabel=${i} class=${Le({[fi.gridCell]:!0,[fi.contentContainer]:!0,[fi.contentContainerUnavailable]:h,[fi.contentContainerSelectable]:r!=="none",[fi.contentContainerHasCenterContent]:d})} @click=${this.handleItemClick} role=gridcell ${hi(this.contentRef)}>${a}</div>`)}render(){const{expandable:e,expanded:i,level:r,active:o,label:h,selected:d,selectionAppearance:a,selectionMode:v,interactionMode:T,closed:E,filterHidden:k,bordered:L,disabled:O,hasContentBottom:H}=this,ie=L&&H,pe=L&&!H,be=v!=="none"&&a==="border",Ce=be&&d,Pe=be&&!d,Ie=T==="interactive"||T==="static"&&v!=="none"&&a==="border";return vo({disabled:O,children:Fe`<div class=${Le({[fi.wrapper]:!0,[fi.wrapperBordered]:ie})}><div .ariaExpanded=${e?i:null} .ariaLabel=${h} .ariaLevel=${r} .ariaSelected=${d} class=${Le({[fi.row]:!0,[fi.container]:!0,[fi.containerHover]:Ie,[fi.containerBorder]:be,[fi.containerBorderSelected]:Ce,[fi.containerBorderUnselected]:Pe})} .hidden=${E||k} @focus=${this.focusCellNull} @focusin=${this.emitInternalListItemActive} @keydown=${this.handleItemKeyDown} role=row .tabIndex=${o?0:-1} ${hi(this.containerRef)}>${this.renderDragHandle()}${this.renderSelected()}${this.renderExpanded()}<div class=${Le({[fi.contentContainerWrapper]:!0,[fi.contentContainerWrapperBordered]:pe})}>${this.renderActionsStart()}${this.renderContentContainer()}${this.renderActionsEnd()}</div></div>${this.renderContentBottom()}</div>${this.renderDefaultContainer()}`})}};F1.properties={hasActionsEnd:[16,{},{state:!0}],hasActionsStart:[16,{},{state:!0}],hasContentBottom:[16,{},{state:!0}],hasContentEnd:[16,{},{state:!0}],hasContentStart:[16,{},{state:!0}],hasCustomContent:[16,{},{state:!0}],level:[16,{},{state:!0}],expandable:[16,{},{state:!0}],parentListEl:[16,{},{state:!0}],active:[5,{},{type:Boolean}],bordered:[5,{},{type:Boolean}],sortDisabled:[5,{},{type:Boolean}],closable:[7,{},{reflect:!0,type:Boolean}],closed:[7,{},{reflect:!0,type:Boolean}],description:1,disabled:[7,{},{reflect:!0,type:Boolean}],dragDisabled:[7,{},{reflect:!0,type:Boolean}],dragHandle:[7,{},{reflect:!0,type:Boolean}],expanded:[7,{},{reflect:!0,type:Boolean}],filterHidden:[7,{},{reflect:!0,type:Boolean}],interactionMode:1,label:1,messageOverrides:[0,{},{attribute:!1}],metadata:[0,{},{attribute:!1}],displayMode:[3,{},{reflect:!0}],addToItems:[0,{},{attribute:!1}],moveToItems:[0,{},{attribute:!1}],open:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],selected:[7,{},{reflect:!0,type:Boolean}],selectionAppearance:[3,{},{reflect:!0}],selectionMode:[3,{},{reflect:!0}],setPosition:[9,{},{type:Number}],setSize:[9,{},{type:Number}],sortHandleOpen:[7,{},{reflect:!0,type:Boolean}],unavailable:[7,{},{reflect:!0,type:Boolean}],value:1,iconStart:[3,{},{reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}]},F1.styles=[WK,eL];let BC=F1;lr("calcite-list-item",BC);let Mu;const kn=globalThis;function Ue(t){return typeof Mu[t]=="function"?Mu[t]=Mu[t](kn):Mu[t]}Mu=kn.dojoConfig?.has||kn.esriConfig?.has?{...kn.dojoConfig?.has,...kn.esriConfig?.has}:{},Ue.add=(t,e,i,r)=>{(r||Mu[t]===void 0)&&(Mu[t]=e),i&&Ue(t)},Ue.cache=Mu,Ue.add("big-integer-warning-enabled",!0),Ue.add("esri-deprecation-warnings",!0),Ue.add("esri-tests-disable-screenshots",!1),Ue.add("esri-tests-use-full-window",!1),Ue.add("esri-tests-post-to-influx",!0),Ue.add("esri-cim-animations-enable-status","enabled"),Ue.add("esri-cim-animations-spotlight",!1),Ue.add("esri-cim-animations-freeze-time",!1),(()=>{Ue.add("host-webworker",kn.WorkerGlobalScope!==void 0&&self instanceof kn.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(Ue.add("host-browser",t),Ue.add("host-node",!(typeof kn.process!="object"||!kn.process.versions?.node||!kn.process.versions.v8)),Ue.add("dom",t),Ue("host-browser")){const e=navigator,i=e.userAgent,r=e.appVersion,o=parseFloat(r);if(Ue.add("wp",parseFloat(i.split("Windows Phone")[1])||void 0),Ue.add("msapp",parseFloat(i.split("MSAppHost/")[1])||void 0),Ue.add("khtml",r.includes("Konqueror")?o:void 0),Ue.add("edge",parseFloat(i.split("Edge/")[1])||void 0),Ue.add("opr",parseFloat(i.split("OPR/")[1])||void 0),Ue.add("webkit",!Ue("wp")&&!Ue("edge")&&parseFloat(i.split("WebKit/")[1])||void 0),Ue.add("chrome",!Ue("edge")&&!Ue("opr")&&parseFloat(i.split("Chrome/")[1])||void 0),Ue.add("android",!Ue("wp")&&parseFloat(i.split("Android ")[1])||void 0),Ue.add("safari",!r.includes("Safari")||Ue("wp")||Ue("chrome")||Ue("android")||Ue("edge")||Ue("opr")?void 0:parseFloat(r.split("Version/")[1])),Ue.add("mac",r.includes("Macintosh")),!Ue("wp")&&/(iPhone|iPod|iPad)/.test(i)){const h=RegExp.$1.replace(/P/,"p"),d=/OS ([\d_]+)/.test(i)?RegExp.$1:"1",a=parseFloat(d.replace(/_/,".").replaceAll("_",""));Ue.add(h,a),Ue.add("ios",a)}Ue("webkit")||(!i.includes("Gecko")||Ue("wp")||Ue("khtml")||Ue("edge")||Ue.add("mozilla",o),Ue("mozilla")&&Ue.add("ff",parseFloat(i.split("Firefox/")[1]||i.split("Minefield/")[1])||void 0))}})(),(()=>{if(kn.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&Ue.add("esri-mobile",e),i&&Ue.add("esri-iPhone",i),Ue.add("esri-geolocation",!!navigator.geolocation)}Ue.add("esri-wasm","WebAssembly"in kn),Ue.add("esri-performance-mode-frames-between-render",20),Ue.add("esri-force-performance-mode",!1),Ue.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in kn,e=kn.crossOriginIsolated===!1;return t&&!e}),Ue.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),Ue.add("esri-atomics","Atomics"in kn),Ue.add("esri-workers","Worker"in kn),Ue.add("web-feat:cache","caches"in kn),Ue.add("esri-workers-arraybuffer-transfer",!Ue("safari")||Number(Ue("safari"))>=12),Ue.add("workers-pool-size",8),Ue.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),Ue.add("featurelayer-simplify-payload-size-factors",[1,1,4]),Ue.add("featurelayer-fast-triangulation-enabled",!0),Ue.add("featurelayer-animation-enabled",!0),Ue.add("featurelayer-snapshot-enabled",!0),Ue.add("featurelayer-snapshot-initial-tolerance",0),Ue.add("featurelayer-snapshot-point-min-threshold",8e4),Ue.add("featurelayer-snapshot-point-max-threshold",4e5),Ue.add("featurelayer-snapshot-multipoint-min-threshold",2e4),Ue.add("featurelayer-snapshot-multipoint-max-threshold",1e5),Ue.add("featurelayer-snapshot-polygon-min-threshold",2e3),Ue.add("featurelayer-snapshot-polygon-max-threshold",2e3),Ue.add("featurelayer-snapshot-polyline-min-threshold",2e3),Ue.add("featurelayer-snapshot-polyline-max-threshold",2e3),Ue.add("featurelayer-snapshot-max-vertex-count",25e4),Ue.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!0),Ue.add("featurelayer-snapshot-concurrency",4),Ue.add("featurelayer-snapshot-coverage",.1),Ue.add("featurelayer-query-max-depth",4),Ue.add("featurelayer-query-pausing-enabled",!1),Ue.add("featurelayer-query-tile-concurrency",4),Ue.add("featurelayer-query-tile-max-features",6e5),Ue.add("featurelayer-advanced-symbols",!1),Ue.add("featurelayer-pbf",!0),Ue.add("featurelayer-pbf-statistics",!1),Ue.add("feature-layers-workers",!0),Ue.add("feature-polyline-generalization-factor",1),Ue.add("parquetlayer-full-query-feature-count",2e4),Ue.add("parquetlayer-hittest-max-feature-count",1),Ue.add("parquetlayer-persistence-enabled",!1),Ue.add("mapview-transitions-duration",200),Ue.add("mapview-essential-goto-duration",200),Ue.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),Ue.add("mapserver-pbf-version-support",10.81),Ue.add("mapservice-popup-identify-max-tolerance",20),Ue.add("request-queue-concurrency-hosted",16),Ue.add("request-queue-concurrency-non-hosted",4),Ue.add("curve-densification-coarse-segments",128),Ue.add("curve-densification-max-segments",2e3),Ue.add("curve-densification-min-segments",3),Ue.add("curve-densification-pixel-deviation",.5),Ue.add("view-readyState-waiting-delay",1e3),Ue.add("gradient-depth-bias",.01),Ue.add("gradient-depth-epsilon",1e-8),Ue.add("enable-feature:esri-compress-textures",!0),Ue("host-webworker")||Ue("host-browser")&&(Ue.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),Ue.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function Cpe(t){}function Epe(t){return t}var $s;let YK=($s=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*$s._m}getInt(){return this._seed=($s._a*this._seed+$s._c)%$s._m,this._seed}getFloat(){return this.getInt()/($s._m-1)}getIntRange(e,i){return Math.round(this.getFloatRange(e,i))}getFloatRange(e,i){const r=i-e;return e+this.getInt()/$s._m*r}},$s._m=2147483647,$s._a=48271,$s._c=0,$s);const Ipe=1.5;function $pe(t,e){return e?t.filter((i,r,o)=>o.findIndex(e.bind(null,i))===r):Array.from(new Set(t))}function XK(t,e,i,r,o,h,d){if(t==null&&r==null)return!0;e=Math.max(0,e),o=Math.max(0,o),i=Math.max(0,i<0?(t?.length??0)+i:i),h=Math.max(0,h<0?(r?.length??0)+h:h);const a=i-e;if(t==null||r==null||a!==h-o)return!1;if(d){for(let v=0;v<a;v++)if(!d(t[e+v],r[o+v]))return!1}else for(let v=0;v<a;v++)if(t[e+v]!==r[o+v])return!1;return!0}function fw(t,e,i){return XK(t,0,t?.length??0,e,0,e?.length??0,i)}function Ppe(){return(t,e)=>{if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}}function Mpe(t,e,i){let r,o;return i?(r=e.filter(h=>!t.some(d=>i(d,h))),o=t.filter(h=>!e.some(d=>i(d,h)))):(r=e.filter(h=>!t.includes(h)),o=t.filter(h=>!e.includes(h))),{added:r,removed:o}}let EL=class{constructor(){this.last=0}};const IL=new EL;function jC(t,e,i,r){r=r||IL;const o=Math.max(0,r.last-10);for(let d=o;d<i;++d)if(t[d]===e)return r.last=d,d;const h=Math.min(o,i);for(let d=0;d<h;++d)if(t[d]===e)return r.last=d,d;return-1}function Ape(t,e,i,r){const o=t.length,h=jC(t,e,o,r);if(h!==-1)return t[h]=t[o-1],t.pop(),e}const ca=new Set;function JK(t,e,i=t.length,r=e.length,o,h){if(r===0||i===0)return i;ca.clear();for(let a=0;a<r;++a)ca.add(e[a]);o=o||IL;const d=Math.max(0,o.last-10);for(let a=d;a<i;++a)if(ca.has(t[a])&&(h?.push(t[a]),ca.delete(t[a]),t[a]=t[i-1],--i,--a,ca.size===0||i===0))return ca.clear(),i;for(let a=0;a<d;++a)if(ca.has(t[a])&&(h?.push(t[a]),ca.delete(t[a]),t[a]=t[i-1],--i,--a,ca.size===0||i===0))return ca.clear(),i;return ca.clear(),i}function KK(t){return t?(aD.seed=t,()=>aD.getFloat()):Math.random}const aD=new YK;function Dpe(t,e){if(!t)return t;const i=KK(e);for(let r=t.length-1;r>0;r--){const o=Math.floor(i()*(r+1)),h=t[r];t[r]=t[o],t[o]=h}return t}function QK(t,e){const i=t.indexOf(e);return i!==-1?(t.splice(i,1),e):null}function xb(t,e){return t!=null}function zpe(t){return t instanceof ArrayBuffer}function F$(t){return t?.constructor?.name==="Int8Array"}function $L(t){return t?.constructor?.name==="Uint8Array"}function PL(t){return t?.constructor?.name==="Uint8ClampedArray"}function N$(t){return t?.constructor?.name==="Int16Array"}function ML(t){return t?.constructor?.name==="Uint16Array"}function B$(t){return t?.constructor?.name==="Int32Array"}function kL(t){return t?.constructor?.name==="Uint32Array"}function eQ(t){return t?.constructor?.name==="Float16Array"}function mw(t){return t?.constructor?.name==="Float32Array"}function gw(t){return t?.constructor?.name==="Float64Array"}function tQ(t){return"buffer"in t}const AL=1024;function Ope(t){return gw(t)||mw(t)||B$(t)||N$(t)||F$(t)}function Rpe(t){return gw(t)||mw(t)}function Lpe(t){return gw(t)?179769e303:eQ(t)?65504:mw(t)?3402823e32:kL(t)?4294967295:ML(t)?65535:$L(t)||PL(t)?255:B$(t)?2147483647:N$(t)?32767:F$(t)?127:256}const Fpe=-32768,Npe=-2147483648;function Bpe(t,e){let i;for(i in t)t.hasOwnProperty(i)&&t[i]===void 0&&delete t[i];return t}function ht(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=RL(t);if(e!=null)return e;if(DL(t))return t.clone();if(zL(t))return t.map(ht);if(OL(t))throw new Error("Trying to clone an unclonable Accessor instance");const i={};for(const r of Object.getOwnPropertyNames(t))i[r]=ht(t[r]);return i}function UC(t,e){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const i=RL(t);if(i!=null)return i;if(zL(t)){let o=!0;const h=t.map(d=>{const a=UC(d,e);return d!=null&&a==null&&(o=!1),a});return o?h:null}if(DL(t))return t.clone(e);if(t instanceof File||t instanceof Blob)return t;if(OL(t))return null;const r=new(Object.getPrototypeOf(t)).constructor;for(const o of Object.getOwnPropertyNames(t)){const h=t[o],d=UC(h);if(h!=null&&d==null)return null;r[o]=d}return r}function DL(t){return typeof t.clone=="function"}function zL(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function OL(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function lD(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function RL(t){if(F$(t)||$L(t)||PL(t)||N$(t)||ML(t)||B$(t)||kL(t)||mw(t)||gw(t))return t.slice();if(t instanceof Date)return new Date(t);if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[i,r]of t)e.set(i,ht(r));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(ht(i));return e}return null}function j$(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function iQ(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&fw(t,e):t instanceof Set?e instanceof Set&&nQ(t,e):t instanceof Map?e instanceof Map&&sQ(t,e):!!lD(t)&&lD(e)&&rQ(t,e))}function rQ(t,e){if(t===null||e===null)return!1;const i=Object.keys(t);if(e===null||Object.keys(e).length!==i.length)return!1;for(const r of i)if(t[r]!==e[r]||!Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function nQ(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function sQ(t,e){if(t.size!==e.size)return!1;for(const[i,r]of t){const o=e.get(i);if(o!==r||o===void 0&&!e.has(i))return!1}return!0}function oQ(t,e,i=!1){return FL(t,e,i)}function yw(t,e){if(e!=null)return e[t]||LL(t.split("."),!1,e)}function Em(t,e,i){const r=t.split("."),o=r.pop(),h=LL(r,!0,i);h&&o&&(h[o]=e)}function cD(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const i=e;if(t.length!==i.length)return!0;for(let r=0;r<t.length;r++)if(cD(t[r],i[r]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const i in t)if(cD(t[i],e[i]))return!0;return!1}return t!==e}function LL(t,e,i){let r=i;for(const o of t){if(r==null)return;if(!(o in r)){if(!e)return;r[o]={}}r=r[o]}return r}function FL(t,e,i){return e?Object.keys(e).reduce((r,o)=>{if(o==="__proto__")return r;let h=r[o],d=e[o];return h===d?r:h===void 0?(r[o]=ht(d),r):(Array.isArray(d)||Array.isArray(r)?(h=h?Array.isArray(h)?r[o]=h.slice():r[o]=[h]:r[o]=[],d&&(Array.isArray(d)||(d=[d]),i?d.forEach(a=>{h.includes(a)||h.push(a)}):r[o]=d.slice())):d&&typeof d=="object"?r[o]=FL(h,d,i):r.hasOwnProperty(o)&&!e.hasOwnProperty(o)||(r[o]=d),r)},t||{}):t}function jpe(t,e){for(const i of Object.entries(t))if(e===i[1])return i[0]}function Upe(t,e){return Object.values(t).includes(e)}const zi={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(oQ(zi,globalThis.esriConfig,!0),delete zi.has),!zi.assetsPath){{const t="4.34";zi.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}zi.defaultAssetsPath=zi.assetsPath}const aQ=/\{([^}]+)\}/g;function uD(t){return t??""}function U$(t,e){return e?t.replaceAll(aQ,typeof e=="object"?(i,r)=>uD(yw(r,e)):(i,r)=>uD(e(r))):t}function Vpe(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,i=>e?.includes(i)?i:`\\${i}`)}function NL(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}let hD;function Gpe(t){return hD??=new DOMParser,hD.parseFromString(t||"","text/html").body.innerText||""}const dD={info:0,warn:1,error:2,none:3};var Fr;let ui=(Fr=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,Fr._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=Fr.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,Fr._loggers.get(e)||new Fr({module:e})}_log(e,i,...r){if(this._matchLevel(e)){if(i!=="always"&&!Fr._throttlingDisabled){const o=cQ(r),h=this._loggedMessages[e].get(o);if(i==="once"&&h!=null||i==="oncePerTick"&&h&&h>=Fr._tickCounter)return;this._loggedMessages[e].set(o,Fr._tickCounter),Fr._scheduleTickCounterIncrement()}for(const o of zi.log.interceptors)if(o(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,i){let r=this;for(;r!=null;){const o=r[e];if(o!=null)return o;r=r.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",lQ)}_matchLevel(e){const i=zi.log.level||"warn";return dD[this._parentWithMember("level",i)]<=dD[e]}static _scheduleTickCounterIncrement(){Fr._tickCounterScheduled||(Fr._tickCounterScheduled=!0,Promise.resolve().then(()=>{Fr._tickCounter++,Fr._tickCounterScheduled=!1}))}},Fr._loggers=new Map,Fr._tickCounter=0,Fr._tickCounterScheduled=!1,Fr._throttlingDisabled=!1,Fr);function lQ(t,e,...i){console[t](`[${e}]`,...i)}function cQ(...t){return NL(JSON.stringify(t,(i,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}const uQ={remove:()=>{}};function hn(t){return t?{remove(){t&&(t(),t=void 0)}}:uQ}function hQ(t){t.forEach(e=>e?.remove())}function V$(t){return hn(()=>hQ(t))}function dQ(t){return hn(()=>t?.abort())}function qpe(t){return{[Symbol.dispose](){t.remove()}}}function Uu(t){return t.__accessor__??null}function pQ(t,e){return t?.metadata?.[e]!=null}function wb(t,e,i){return i?Wx(t,e,{policy:i,path:""}):Wx(t,e,null)}function Wx(t,e,i){return e?Object.keys(e).reduce((r,o)=>{const h=o;if(h==="__proto__")return r;let d=null,a="merge";if(i&&(d=i.path?`${i.path}.${o}`:o,a=i.policy(d)),a==="replace"||a==="replace-arrays"&&Array.isArray(r[h]))return r[h]=e[h],r;if(r[h]===void 0)return r[h]=ht(e[h]),r;let v=r[h],T=e[h];if(v===T)return r;if(Array.isArray(T)||Array.isArray(r))v=v?Array.isArray(v)?r[h]=v.slice():r[h]=[v]:r[h]=[],T&&(Array.isArray(T)||(T=[T]),T.forEach(E=>{v.includes(E)||v.push(E)}));else if(T&&typeof T=="object")if(i){const E=i.path;i.path=d,r[h]=Wx(v,T,i),i.path=E}else r[h]=Wx(v,T,null);else r.hasOwnProperty(o)&&!e.hasOwnProperty(o)||(r[h]=T);return r},t||{}):t}function BL(t){return Array.isArray(t)?t:t.split(".")}function pD(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function fQ(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...pD(i));return e}return pD(t)}function jL(t,e,i,r){const o=fQ(e);if(o.length!==1){const h=o.map(d=>r(t,d,i));return V$(h)}return r(t,o[0],i)}const Ki={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let vw=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const Yx=new vw,yy=[];let Zy=Yx;function Yt(t){Zy.onAccessed(t)}let Sb=!1,Tb=!1;function bc(t,e,i){if(Sb)return G$(t,e,i);let r=null;return UL(t),r=e.call(i),VL(),r}function mQ(t,e){return bc(Yx,t,e)}function G$(t,e,i){const r=Sb;Sb=!0,UL(t);let o=null;try{o=e.call(i)}catch(h){Tb&&ui.getLogger("esri.core.accessorSupport.tracking").error(h)}return VL(),Sb=r,o}function UL(t){Zy=t,yy.push(t)}function VL(){const t=yy.length;if(t>1){const e=yy.pop();Zy=yy[t-2],e.onTrackingEnd()}else if(t===1){const e=yy.pop();Zy=Yx,e.onTrackingEnd()}else Zy=Yx}function GL(t,e){if(e.flags&Ki.DepTrackingInitialized)return;e.flags|=Ki.DepTrackingInitialized;const i=Tb;Tb=!1,e.flags&Ki.AutoTracked?G$(e.trackingTarget,e.metadata.get,t):qL(t,e),Tb=i}const gQ=[];function qL(t,e){e.flags&Ki.ExplicitlyTracking||(e.flags|=Ki.ExplicitlyTracking,G$(e.trackingTarget,()=>{const i=e.metadata.dependsOn||gQ;for(const r of i)if(typeof r!="string"||r.includes(".")){const o=BL(r);for(let h=0,d=t;h<o.length&&d!=null&&typeof d=="object";++h)d=fD(d,o[h],h!==o.length-1)}else fD(t,r,!1)}),e.flags&=-129)}function fD(t,e,i){const r=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const h=parseInt(r,10);if(!isNaN(h))return Array.isArray(t)?t[h]:t.at(h)}const o=Uu(t);if(o){const h=o.propertiesByName.get(r);h&&(Yt(h),GL(t,h))}return i?t[r]:void 0}let yQ=class{constructor(e,i){this._observers=e,this._observer=i}remove(){QK(this._observers,this._observer)}},HL=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return vQ;this._observers==null&&(this._observers=[]);const i=this._observers;let r=!1,o=!1;const h=i.length;for(let d=0;d<h;++d){const a=i[d];if(a.destroyed)o=!0;else if(a===e){r=!0;break}}return r||(i.push(e),o&&this._removeDestroyedObservers()),new yQ(i,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const i=e.length;let r=0;for(let o=0;o<i;++o){for(;o+r<i&&e[o+r].destroyed;)++r;if(r>0){if(!(o+r<i))break;e[o]=e[o+r]}}e.length=i-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const i of e)i.onCommitted();this._observers=null}}};const vQ=hn();let ZL=class extends HL{notify(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onInvalidated(),r.onCommitted()}}},_w=class extends vw{constructor(e){super(new _Q(e)),this._observer&&mD.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&mD.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},_Q=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=bQ}};const mD=new FinalizationRegistry(t=>{t.deref()?.destroy()});function bQ(){}function WL(){return new ZL}function xQ(t){return new _w(t)}function YL(t){Yt(t)}function wQ(t,e){return bc(t,e)}/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const SQ=Gi`:host{display:block;box-sizing:border-box;*,*:before,*:after{box-sizing:inherit}}:host([hidden]){display:none}:host(:not(arcgis-basemap-gallery-item,arcgis-layer-list-item,arcgis-print-custom-text-elements,arcgis-print-dpi-input,arcgis-print-export-button,arcgis-print-exported-link,arcgis-print-exports-panel,arcgis-print-format-select,arcgis-print-layout-advanced-options,arcgis-print-layout-panel,arcgis-print-main-panel,arcgis-print-map-only-advanced-options,arcgis-print-map-only-panel,arcgis-print-out-spatial-reference-input,arcgis-print-preview-input,arcgis-print-scale-section,arcgis-print-template-select,arcgis-print-template-selector,arcgis-labeled-switch,arcgis-measurement-content,arcgis-version-management-service-item,arcgis-version-management-version-item,arcgis-version-management-version-list,arcgis-version-management-version-properties,arcgis-video-player-action-bar,arcgis-video-player-actions-group,arcgis-video-player-controls-group,arcgis-video-player-metadata,arcgis-video-player-settings,arcgis-video-player-slider)){font-family:var(--calcite-font-family)}`,rv=YO({defaultAssetPath:"https://js.arcgis.com/4.34/map-components/",hydratedAttribute:"hydrated",commonStyles:SQ}),{customElement:XL,getAssetPath:TQ,setAssetPath:Kpe}=rv;rv.t=YL;rv.o=WL;rv.c=xQ;rv.r=wQ;/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const JL={widget:"esri-widget"};function q$(t){return CQ(t)||KL(t)}function CQ(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function KL(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function QL(t,e,i){if(!q$(t))throw new TypeError("target is not a Evented or EventTarget object");return KL(t)?EQ(t,e,i):t.on(e,i)}function EQ(t,e,i,r){if(Array.isArray(e)){const o=e.slice();for(const h of o)t.addEventListener(h,i,r);return hn(()=>{for(const h of o)t.removeEventListener(h,i,r)})}return t.addEventListener(e,i,r),hn(()=>t.removeEventListener(e,i,r))}function e4(t,e,i){if(!q$(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const r=QL(t,e,o=>{r.remove(),i.call(t,o)});return r}function t4(t,e){if(t==null)throw new Error(e??"value is None")}function Cb(t){return t?.destroy(),null}function Qpe(t){return t?.dispose(),null}function nv(t){return t?.remove(),null}function IQ(t){return t?.abort(),null}function efe(t){return t?.release(),null}function tfe(t,e,i){return t!=null&&e!=null?i!=null?i(t,e):t.equals(e):t===e}function Xx(t,e){let i;return t.some((r,o)=>(i=e(r,o),i!=null)),i??void 0}function $Q(t){return{setTimeout:(e,i)=>{const r=t.setTimeout(e,i);return hn(()=>t.clearTimeout(r))}}}const PQ=$Q(globalThis);function MQ(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(i,r)=>r===""?"$":(yw(r,e)??"").toString())}let i4=class{constructor(e,i,r=void 0){this.name=e,this.details=r,this.message=(i&&MQ(i,r))??""}toString(){return"["+this.name+"]: "+this.message}},Lt=class r4 extends i4{constructor(e,i,r){super(e,i,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return ht(i)}catch{return"[object]"}}))}}catch(e){throw ui.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new r4(e.name,e.message,e.details)}};Lt.prototype.type="error";function zs(t="Aborted"){return new Lt("AbortError",t)}function C0(t,e="Aborted"){if(Vu(t))throw zs(e)}function bw(t){return t instanceof AbortSignal?t:t?.signal??void 0}function Vu(t){const e=bw(t);return e!=null&&e.aborted}function kQ(t){if(zd(t))throw t}function rfe(t){if(!zd(t))throw t}function E0(t,e){const i=bw(t);if(i!=null){if(!i.aborted)return e4(i,"abort",()=>e());e()}}function AQ(t,e){const i=bw(t);if(i!=null)return C0(i),e4(i,"abort",()=>e(zs()))}function nfe(t,e){return bw(e)==null?t:new Promise((i,r)=>{let o=E0(e,()=>r(zs()));const h=()=>{o=nv(o)};t.then(h,h),t.then(i,r)})}function zd(t){return t?.name==="AbortError"}async function sfe(t){try{return await t}catch(e){if(!zd(e))throw e;return}}async function vy(t){if(!t)return;if(typeof t.forEach!="function"){const i=Object.keys(t),r=i.map(d=>t[d]),o=await vy(r),h={};return i.map((d,a)=>h[d]=o[a]),h}const e=t;return Promise.allSettled(e).then(i=>Array.from(e,(r,o)=>{const h=i[o];return h.status==="fulfilled"?{promise:r,value:h.value}:{promise:r,error:h.reason}}))}async function ofe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function afe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function n4(t,e=void 0,i){const r=new AbortController;return E0(i,()=>r.abort()),new Promise((o,h)=>{let d=setTimeout(()=>{d=0,o(e)},t);E0(r,()=>{d&&(clearTimeout(d),h(zs()))})})}function s4(t){return t&&typeof t.then=="function"}function gD(t){return s4(t)?t:Promise.resolve(t)}function lfe(t,e=-1){let i,r,o,h,d=null;const a=(...v)=>{if(i){r=v,h&&h.reject(zs()),h=lm();const L=h.promise;if(d){const O=d;d=null,O.abort()}return L}if(o=h||lm(),h=null,e>0){const L=new AbortController;i=gD(t(...v,L.signal));const O=i;n4(e).then(()=>{i===O&&(h?L.abort():d=L)})}else i=1,i=gD(t(...v));const T=()=>{const L=r;r=o=i=d=null,L!=null&&a(...L)},E=i,k=o;return E.then(T,T),E.then(k.resolve,k.reject),k.promise};return a}function lm(){let t,e;const i=new Promise((o,h)=>{t=o,e=h}),r=o=>{t(o)};return r.resolve=o=>t(o),r.reject=o=>e(o),r.timeout=(o,h)=>PQ.setTimeout(()=>r.reject(h),o),r.promise=i,r}function cfe(t,e){e.then(t.resolve,t.reject)}async function ufe(t){await Promise.resolve(),C0(t)}function DQ(t){return t?.release&&typeof t.release=="function"}function zQ(t){return t?.acquire&&typeof t.acquire=="function"}var Nu;let xw=(Nu=class{constructor(e,i,r,o=1,h=0){this._creator=e,this._acquireFunction=i,this._releaseFunction=r,this.allocationSize=o,this._pool=new Array(h),this._initialSize=h;for(let d=0;d<h;d++)this._pool[d]=this._creator();this.allocationSize=Math.max(o,1)}destroy(){this.prune(0)}acquire(...e){let i;if(Nu.test.disabled)i=this._creator();else{if(this._pool.length===0){const r=this.allocationSize;for(let o=0;o<r;o++)this._pool[o]=this._creator()}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...e):zQ(i)&&i.acquire(...e),i}release(e){e&&!Nu.test.disabled&&(this._releaseFunction?this._releaseFunction(e):DQ(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let i=e;i<this._pool.length;++i){const r=this._pool[i];this._dispose(r)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},Nu.test={disabled:!!Ue("esri-tests-disable-memory-pools")},Nu);function OQ(t){t.length=0}let _u=class{constructor(e=50,i=50){this._pool=new xw(()=>[],void 0,OQ,i,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return rT.acquire()}static release(e){return rT.release(e)}static prune(){rT.prune()}};const rT=new _u(100);let RQ=class extends xw{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const i=super.acquire(...e);return this._set.delete(i),i}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const G_=[];function o4(t){G_.push(t),G_.length===1&&queueMicrotask(()=>{const e=G_.slice();G_.length=0;for(const i of e)i()})}let a4=class{constructor(e,i=30){this.name=e,this._counter=0,this._samples=new Array(i)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,i)=>e-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,i)=>e+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const Jx=(t,e,i,r)=>{let o=e,h=e;const d=i>>>1,a=t[o-1];for(;h<=d;){h=o<<1,h<i&&r(t[h-1],t[h])<0&&++h;const v=t[h-1];if(r(v,a)<=0)break;t[o-1]=v,o=h}t[o-1]=a},l4=(t,e)=>t<e?-1:t>e?1:0;function LQ(t,e,i,r){i===void 0&&(i=t.length),r===void 0&&(r=l4);for(let h=i>>>1;h>e;h--)Jx(t,h,i,r);const o=e+1;for(let h=i-1;h>e;h--){const d=t[e];t[e]=t[h],t[h]=d,Jx(t,o,h,r)}}function*FQ(t,e,i,r){i===void 0&&(i=t.length),r===void 0&&(r=l4);for(let h=i>>>1;h>e;h--)Jx(t,h,i,r),yield;const o=e+1;for(let h=i-1;h>e;h--){const d=t[e];t[e]=t[h],t[h]=d,Jx(t,o,h,r),yield}}const NQ=1.5,BQ=1.1;let c4=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new EL,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>yD(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const i=new Array;for(let r=0;r<this._length;r++){const o=this.data[r];e(o)&&i.push(o)}return i}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,i){const r=this.data.indexOf(e,i);return r!==-1&&r<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let i=e;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,i=e.length){for(let r=0;r<i;r++)this.data[this._length++]=e[r]}fill(e,i){for(let r=0;r<i;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,yD(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const i=jC(this.data,e,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(jC(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,i=e.length,r){this.length=JK(this.data,e,this.length,i,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,i){if(e>=this.length||i>=this.length||e===i)return;const r=this.data[e];this.data[e]=this.data[i],this.data[i]=r}sort(e){LQ(this.data,0,this.length,e)}iterableSort(e){return FQ(this.data,0,this.length,e)}some(e,i){for(let r=0;r<this.length;++r)if(e.call(i,this.data[r],r,this.data))return!0;return!1}find(e,i){const{data:r,length:o}=this;for(let h=0;h<o;++h)if(e.call(i,r[h]))return r[h]}filterInPlace(e,i){let r=0;for(let o=0;o<this._length;++o){const h=this.data[o];e.call(i,h,o,this.data)&&(this.data[o]=this.data[r],this.data[r]=h,r++)}if(this._deallocator)for(let o=r;o<this._length;o++)this.data[o]=this._deallocator(this.data[o]);return this._length=r,this._shrink(),this}forAll(e,i){const{data:r,length:o}=this;for(let h=0;h<o;++h)e.call(i,r[h],h,r)}forEach(e,i){this.data.slice(0,this.length).forEach(e,i)}map(e,i){const r=new Array(this.length);for(let o=0;o<this.length;++o)r[o]=e.call(i,this.data[o],o,this.data);return r}reduce(e,i){let r=i;for(let o=0;o<this.length;++o)r=e(r,this.data[o],o,this.data);return r}has(e){const i=this.length,r=this.data;for(let o=0;o<i;++o)if(r[o]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function yD(t){t.data.length>NQ*t.length&&(t.data.length=Math.floor(t.length*BQ))}let jQ=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}};const UQ=["prepare","preRender","render","postRender","update","finish"],VC=[];new c4;const GC={willDispatch:!1};function u4(t){const e=new jQ(t);return VC.push(e),GC.willDispatch||(GC.willDispatch=!0,o4(VQ)),e}new c4;function VQ(){for(;VC.length;){const t=VC.shift();t.isActive&&t.callback()}GC.willDispatch=!1}function GQ(t=1,e){const i=lm(),r=()=>{Vu(e)?i.reject(zs()):t===0?i():(--t,o4(()=>r()))};return r(),i.promise}function qQ(t){return GQ(1,t)}async function gfe(t){await qQ(t),await new Promise(e=>requestAnimationFrame(()=>{t?.aborted||e()}))}UQ.map(t=>new a4(t));new a4("total");function yfe(t,e){for(const i of t.values())if(e(i))return!0;return!1}function vD(t,e){if(!e)return t;for(const i of e)i!=null&&t.add(i);return t}function vfe(t,e){return e!=null&&t.add(e),t}function h4(t,e){const i=new Set;return vD(i,t),vD(i,e),i}function _fe(t,e){const i=new Set;for(const r of e)t.has(r)&&i.add(r);return i}function bfe(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const i of t)if(!e.has(i))return!1;return!0}function xfe(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function wfe(t,e){const i=new Set(t);for(const r of e)i.delete(r);return i}let HQ=0;function Eb(){return++HQ}function d4(t,e){const i=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const o=parseInt(i,10);if(!isNaN(o))return Array.isArray(e)?e[o]:e.at(o)}const r=Uu(e);return pQ(r,i)?r.get(i):e[i]}function p4(t,e,i){if(t==null)return t;const r=d4(e[i],t);return!r&&i<e.length-1?void 0:i===e.length-1?r:p4(r,e,i+1)}function sv(t,e,i=0){return typeof e!="string"||e.includes(".")?p4(t,BL(e),i):d4(e,t)}function cm(t,e){return sv(t,e)}function _D(t,e){return sv(e,t)!==void 0}const co={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};let Af=!1;const Kx=[];function f4(t,e){let i=new _w(h),r=null,o=!1;function h(){if(!i||o)return;if(Af)return void g4(h);const a=r;i.clear(),Af=!0,o=!0,r=bc(i,t),o=!1,Af=!1,e(r,a),y4()}function d(){i&&(i.destroy(),i=null,r=null)}return o=!0,r=bc(i,t),o=!1,hn(d)}function m4(t,e){let i=new _w(o),r=null;function o(){e(r,d)}function h(){i&&(i.destroy(),i=null),r=null}function d(){return i?(i.clear(),r=bc(i,t),r):null}return d(),hn(h)}function Sfe(t,e){let i=!1,r=!1;const o=!!e?.sync;let h=new _w(()=>{i||r||(r=!0,o?d():queueMicrotask(d))});function d(){r=!1,h&&!i&&(Af?g4(d):(h.clear(),Af=!0,i=!0,bc(h,t),i=!1,Af=!1,y4()))}function a(){h&&(h.destroy(),h=null)}return i=!0,bc(h,t),i=!1,hn(a)}function g4(t){Kx.includes(t)||Kx.unshift(t)}function y4(){for(;Kx.length;)Kx.pop()()}var pd;let H$=(pd=class{constructor(){this.uid=Eb(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,i,r,o,h){return this.pool.acquire(0,e,i,r,o,h,j$)}static acquireTracked(e,i,r,o){return this.pool.acquire(1,e,i,r,null,null,o)}notify(e,i){this.type===0?this.callback.call(this.target,e,i,this.path,this.target):this.callback.call(null,e,i,void 0,void 0)}acquire(e,i,r,o,h,d,a){this.uid=Eb(),this.removed=!1,this.type=e,this.oldValue=i,this.callback=r,this.getValue=o,this.target=h,this.path=d,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=Eb(),this.removed=!0}},pd.pool=new RQ(()=>new pd),pd);const Ib=new _u,Ru=new Set;let Qx;function e1(t){Ru.delete(t),Ru.add(t),ZQ()}function ZQ(){Qx||(Qx=u4(XQ))}function WQ(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function YQ(t){for(const e of Ru.values())e.target===t&&(e.removed=!0)}function XQ(){let t=10;for(;Qx&&t--;){Qx=null;const e=JQ(),i=Ib.acquire();for(const r of e){const o=r.uid;WQ(r),o===r.uid&&r.removed&&i.push(r)}for(const r of Ru)r.removed&&(i.push(r),Ru.delete(r));for(const r of i)H$.pool.release(r);Ib.release(i),Ib.release(e),KQ.forEach(r=>r())}}function JQ(){const t=Ib.acquire();t.length=Ru.size;let e=0;for(const i of Ru)t[e]=i,++e;return Ru.clear(),t}const KQ=new Set;function QQ(t,e,i){let r=jL(t,e,i,(o,h,d)=>{let a,v,T=m4(()=>sv(o,h),(E,k)=>{o.__accessor__?.lifecycle===co.DESTROYED||a&&a.uid!==v?r.remove():(a||(a=H$.acquireUntracked(E,d,k,o,h),v=a.uid),e1(a))});return hn(()=>{T.remove(),a&&(a.uid!==v||a.removed||(a.removed=!0,e1(a)),a=null),r=T=null})});return r}function eee(t,e,i){const r=jL(t,e,i,(o,h,d)=>{let a=!1;return f4(()=>sv(o,h),(v,T)=>{o.__accessor__.lifecycle!==co.DESTROYED?a||(a=!0,j$(T,v)||d.call(o,v,T,h,o),a=!1):r.remove()})});return r}function tee(t,e,i,r=!1){return t.__accessor__&&t.__accessor__.lifecycle!==co.DESTROYED?r?eee(t,e,i):QQ(t,e,i):hn()}function iee(t,e,i){let r,o,h=m4(t,(d,a)=>{r&&r.uid!==o?h.remove():(r||(r=H$.acquireTracked(d,e,a,i),o=r.uid),e1(r))});return hn(()=>{h.remove(),r&&(r.uid!==o||r.removed||(r.removed=!0,e1(r)),r=null),h=null})}function ree(t,e,i){let r=!1;return f4(t,(o,h)=>{r||(r=!0,i(h,o)||e(o,h),r=!1)})}function nee(t,e,i=!1,r=iQ){return i?ree(t,e,r):iee(t,e,r)}function bl(t,e,i={}){return Z$(t,e,i,_4)}function qC(t,e,i={}){return Z$(t,e,i,b4)}function Z$(t,e,i={},r){let o=null;const h=i.once?(d,a)=>{r(d)&&(nv(o),e(d,a))}:(d,a)=>{r(d)&&e(d,a)};if(o=nee(t,h,i.sync,i.equals),i.initial){const d=t();h(d,d)}return o}function v4(t,e,i,r={}){let o=null,h=null,d=null;function a(){o&&h&&(h.remove(),r.onListenerRemove?.(o),o=null,h=null)}function v(E){r.once&&r.once&&nv(d),i(E)}const T=bl(t,(E,k)=>{a(),q$(E)&&(o=E,h=QL(E,e,v),r.onListenerAdd?.(E))},{sync:r.sync,initial:!0});return d=hn(()=>{T.remove(),a()}),d}function see(t,e){return oee(t,b4,e)}function oee(t,e,i){if(Vu(i))return Promise.reject(zs());const r=t();if(e?.(r))return Promise.resolve(r);let o=null;function h(){o=nv(o)}return new Promise((d,a)=>{o=V$([E0(i,()=>{h(),a(zs())}),Z$(t,v=>{h(),d(v)},{sync:!1,once:!0},e??_4)])})}function _4(t){return!0}function b4(t){return!!t}const aee={sync:!0},bD={initial:!0},Tfe={sync:!0,initial:!0};let xl=class{constructor(e,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=lee(e),this.apiValues=xD(this._apiToJSON),this.jsonValues=xD(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,o,h)=>{const d=this.toJSON(r);d!==void 0&&Em(h,d,o)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const i=this._apiToJSON[e];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function lee(t){const e={};for(const i in t)e[t[i]]=i;return e}function xD(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}function _o(){return function(t,e){return new xl(t,{ignoreUnknown:!0,...e})}}let Wy;const cee=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,HC=globalThis.document?.documentElement;function x4(){const t=HC?.getAttribute("lang"),e=globalThis.navigator?.language;return cee??t??e??"en"}function ud(){return Wy===void 0&&(Wy=x4()),Wy}const uee=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function W$(t=ud()){return S4(t)?.language}function w4(t=ud()){const e=S4(t);return e?.language&&e?.extlang?t.replace(`${e.language}-`,""):t}function S4(t=ud()){return uee.exec(t)?.groups}const $b=[];function Efe(t){return $b.push(t),hn(()=>{$b.splice($b.indexOf(t),1)})}const Pb=[];function Y$(t){return Pb.push(t),hn(()=>Pb.splice(Pb.indexOf(t),1))}function wD(){const t=x4();Wy!==t&&([...Pb].forEach(e=>e(t)),Wy=t,[...$b].forEach(e=>e(t)))}globalThis.addEventListener?.("languagechange",wD),HC&&new MutationObserver(()=>{wD()}).observe(HC,{attributeFilter:["lang"]});const um="system",hee="unknown",X$="UTC",dee=Intl.DateTimeFormat().resolvedOptions().timeZone;class Od extends Error{}class pee extends Od{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class fee extends Od{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class mee extends Od{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class _f extends Od{}class T4 extends Od{constructor(e){super(`Invalid unit ${e}`)}}class Zn extends Od{}class nu extends Od{constructor(){super("Zone is an abstract class")}}const _t="numeric",Ia="short",fo="long",t1={year:_t,month:_t,day:_t},C4={year:_t,month:Ia,day:_t},gee={year:_t,month:Ia,day:_t,weekday:Ia},E4={year:_t,month:fo,day:_t},I4={year:_t,month:fo,day:_t,weekday:fo},$4={hour:_t,minute:_t},P4={hour:_t,minute:_t,second:_t},M4={hour:_t,minute:_t,second:_t,timeZoneName:Ia},k4={hour:_t,minute:_t,second:_t,timeZoneName:fo},A4={hour:_t,minute:_t,hourCycle:"h23"},D4={hour:_t,minute:_t,second:_t,hourCycle:"h23"},z4={hour:_t,minute:_t,second:_t,hourCycle:"h23",timeZoneName:Ia},O4={hour:_t,minute:_t,second:_t,hourCycle:"h23",timeZoneName:fo},R4={year:_t,month:_t,day:_t,hour:_t,minute:_t},L4={year:_t,month:_t,day:_t,hour:_t,minute:_t,second:_t},F4={year:_t,month:Ia,day:_t,hour:_t,minute:_t},N4={year:_t,month:Ia,day:_t,hour:_t,minute:_t,second:_t},yee={year:_t,month:Ia,day:_t,weekday:Ia,hour:_t,minute:_t},B4={year:_t,month:fo,day:_t,hour:_t,minute:_t,timeZoneName:Ia},j4={year:_t,month:fo,day:_t,hour:_t,minute:_t,second:_t,timeZoneName:Ia},U4={year:_t,month:fo,day:_t,weekday:fo,hour:_t,minute:_t,timeZoneName:fo},V4={year:_t,month:fo,day:_t,weekday:fo,hour:_t,minute:_t,second:_t,timeZoneName:fo};class ov{get type(){throw new nu}get name(){throw new nu}get ianaName(){return this.name}get isUniversal(){throw new nu}offsetName(e,i){throw new nu}formatOffset(e,i){throw new nu}offset(e){throw new nu}equals(e){throw new nu}get isValid(){throw new nu}}let nT=null;class ww extends ov{static get instance(){return nT===null&&(nT=new ww),nT}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return e6(e,i,r)}formatOffset(e,i){return Yy(this.offset(e),i)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const ZC=new Map;function vee(t){let e=ZC.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),ZC.set(t,e)),e}const _ee={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function bee(t,e){const i=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,o,h,d,a,v,T,E]=r;return[d,o,h,a,v,T,E]}function xee(t,e){const i=t.formatToParts(e),r=[];for(let o=0;o<i.length;o++){const{type:h,value:d}=i[o],a=_ee[h];h==="era"?r[a]=d:Zt(a)||(r[a]=parseInt(d,10))}return r}const sT=new Map;class $a extends ov{static create(e){let i=sT.get(e);return i===void 0&&sT.set(e,i=new $a(e)),i}static resetCache(){sT.clear(),ZC.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=$a.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return e6(e,i,r,this.name)}formatOffset(e,i){return Yy(this.offset(e),i)}offset(e){if(!this.valid)return NaN;const i=new Date(e);if(isNaN(i))return NaN;const r=vee(this.name);let[o,h,d,a,v,T,E]=r.formatToParts?xee(r,i):bee(r,i);a==="BC"&&(o=-Math.abs(o)+1);const L=Tw({year:o,month:h,day:d,hour:v===24?0:v,minute:T,second:E,millisecond:0});let O=+i;const H=O%1e3;return O-=H>=0?H:1e3+H,(L-O)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let SD={};function wee(t,e={}){const i=JSON.stringify([t,e]);let r=SD[i];return r||(r=new Intl.ListFormat(t,e),SD[i]=r),r}const WC=new Map;function YC(t,e={}){const i=JSON.stringify([t,e]);let r=WC.get(i);return r===void 0&&(r=new Intl.DateTimeFormat(t,e),WC.set(i,r)),r}const XC=new Map;function See(t,e={}){const i=JSON.stringify([t,e]);let r=XC.get(i);return r===void 0&&(r=new Intl.NumberFormat(t,e),XC.set(i,r)),r}const JC=new Map;function Tee(t,e={}){const{base:i,...r}=e,o=JSON.stringify([t,r]);let h=JC.get(o);return h===void 0&&(h=new Intl.RelativeTimeFormat(t,e),JC.set(o,h)),h}let _y=null;function Cee(){return _y||(_y=new Intl.DateTimeFormat().resolvedOptions().locale,_y)}const KC=new Map;function G4(t){let e=KC.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),KC.set(t,e)),e}const QC=new Map;function Eee(t){let e=QC.get(t);if(!e){const i=new Intl.Locale(t);e="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,"minimalDays"in e||(e={...q4,...e}),QC.set(t,e)}return e}function Iee(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const i=t.indexOf("-u-");if(i===-1)return[t];{let r,o;try{r=YC(t).resolvedOptions(),o=t}catch{const v=t.substring(0,i);r=YC(v).resolvedOptions(),o=v}const{numberingSystem:h,calendar:d}=r;return[o,h,d]}}function $ee(t,e,i){return(i||e)&&(t.includes("-u-")||(t+="-u"),i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`)),t}function Pee(t){const e=[];for(let i=1;i<=12;i++){const r=Rt.utc(2009,i,1);e.push(t(r))}return e}function Mee(t){const e=[];for(let i=1;i<=7;i++){const r=Rt.utc(2016,11,13+i);e.push(t(r))}return e}function q_(t,e,i,r){const o=t.listingMode();return o==="error"?null:o==="en"?i(e):r(e)}function kee(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||G4(t.locale).numberingSystem==="latn"}class Aee{constructor(e,i,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:o,floor:h,...d}=r;if(!i||Object.keys(d).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=See(e,a)}}format(e){if(this.inf){const i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{const i=this.floor?Math.floor(e):tP(e,3);return tn(i,this.padTo)}}}class Dee{constructor(e,i,r){this.opts=r,this.originalZone=void 0;let o;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const d=-1*(e.offset/60),a=d>=0?`Etc/GMT+${d}`:`Etc/GMT${d}`;e.offset!==0&&$a.create(a).valid?(o=a,this.dt=e):(o="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,o=e.zone.name):(o="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const h={...this.opts};h.timeZone=h.timeZone||o,this.dtf=YC(i,h)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(i=>{if(i.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:r}}else return i}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class zee{constructor(e,i,r){this.opts={style:"long",...r},!i&&K4()&&(this.rtf=Tee(e,r))}format(e,i){return this.rtf?this.rtf.format(e,i):ite(i,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,i){return this.rtf?this.rtf.formatToParts(e,i):[]}}const q4={firstDay:1,minimalDays:4,weekend:[6,7]};class Di{static fromOpts(e){return Di.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,i,r,o,h=!1){const d=e||Er.defaultLocale,a=d||(h?"en-US":Cee()),v=i||Er.defaultNumberingSystem,T=r||Er.defaultOutputCalendar,E=tE(o)||Er.defaultWeekSettings;return new Di(a,v,T,E,d)}static resetCache(){_y=null,WC.clear(),XC.clear(),JC.clear(),KC.clear(),QC.clear()}static fromObject({locale:e,numberingSystem:i,outputCalendar:r,weekSettings:o}={}){return Di.create(e,i,r,o)}constructor(e,i,r,o,h){const[d,a,v]=Iee(e);this.locale=d,this.numberingSystem=i||a||null,this.outputCalendar=r||v||null,this.weekSettings=o,this.intl=$ee(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=h,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=kee(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Di.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,tE(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,i=!1){return q_(this,e,r6,()=>{const r=this.intl==="ja"||this.intl.startsWith("ja-");i&=!r;const o=i?{month:e,day:"numeric"}:{month:e},h=i?"format":"standalone";if(!this.monthsCache[h][e]){const d=r?a=>this.dtFormatter(a,o).format():a=>this.extract(a,o,"month");this.monthsCache[h][e]=Pee(d)}return this.monthsCache[h][e]})}weekdays(e,i=!1){return q_(this,e,o6,()=>{const r=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},o=i?"format":"standalone";return this.weekdaysCache[o][e]||(this.weekdaysCache[o][e]=Mee(h=>this.extract(h,r,"weekday"))),this.weekdaysCache[o][e]})}meridiems(){return q_(this,void 0,()=>a6,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Rt.utc(2016,11,13,9),Rt.utc(2016,11,13,19)].map(i=>this.extract(i,e,"dayperiod"))}return this.meridiemCache})}eras(e){return q_(this,e,l6,()=>{const i={era:e};return this.eraCache[e]||(this.eraCache[e]=[Rt.utc(-40,1,1),Rt.utc(2017,1,1)].map(r=>this.extract(r,i,"era"))),this.eraCache[e]})}extract(e,i,r){const o=this.dtFormatter(e,i),h=o.formatToParts(),d=h.find(a=>a.type.toLowerCase()===r);return d?d.value:null}numberFormatter(e={}){return new Aee(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,i={}){return new Dee(e,this.intl,i)}relFormatter(e={}){return new zee(this.intl,this.isEnglish(),e)}listFormatter(e={}){return wee(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||G4(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Q4()?Eee(this.locale):q4}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let oT=null;class fs extends ov{static get utcInstance(){return oT===null&&(oT=new fs(0)),oT}static instance(e){return e===0?fs.utcInstance:new fs(e)}static parseSpecifier(e){if(e){const i=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new fs(Cw(i[1],i[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Yy(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Yy(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,i){return Yy(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class Oee extends ov{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Eu(t,e){if(Zt(t)||t===null)return e;if(t instanceof ov)return t;if(jee(t)){const i=t.toLowerCase();return i==="default"?e:i==="local"||i==="system"?ww.instance:i==="utc"||i==="gmt"?fs.utcInstance:fs.parseSpecifier(i)||$a.create(t)}else return Lu(t)?fs.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new Oee(t)}const J$={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},TD={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Ree=J$.hanidec.replace(/[\[|\]]/g,"").split("");function Lee(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);if(t[i].search(J$.hanidec)!==-1)e+=Ree.indexOf(t[i]);else for(const o in TD){const[h,d]=TD[o];r>=h&&r<=d&&(e+=r-h)}}return parseInt(e,10)}else return e}const eE=new Map;function Fee(){eE.clear()}function ua({numberingSystem:t},e=""){const i=t||"latn";let r=eE.get(i);r===void 0&&(r=new Map,eE.set(i,r));let o=r.get(e);return o===void 0&&(o=new RegExp(`${J$[i]}${e}`),r.set(e,o)),o}let CD=()=>Date.now(),ED="system",ID=null,$D=null,PD=null,MD=60,kD,AD=null;class Er{static get now(){return CD}static set now(e){CD=e}static set defaultZone(e){ED=e}static get defaultZone(){return Eu(ED,ww.instance)}static get defaultLocale(){return ID}static set defaultLocale(e){ID=e}static get defaultNumberingSystem(){return $D}static set defaultNumberingSystem(e){$D=e}static get defaultOutputCalendar(){return PD}static set defaultOutputCalendar(e){PD=e}static get defaultWeekSettings(){return AD}static set defaultWeekSettings(e){AD=tE(e)}static get twoDigitCutoffYear(){return MD}static set twoDigitCutoffYear(e){MD=e%100}static get throwOnInvalid(){return kD}static set throwOnInvalid(e){kD=e}static resetCaches(){Di.resetCache(),$a.resetCache(),Rt.resetCache(),Fee()}}class ba{constructor(e,i){this.reason=e,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const H4=[0,31,59,90,120,151,181,212,243,273,304,334],Z4=[0,31,60,91,121,152,182,213,244,274,305,335];function Uo(t,e){return new ba("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function K$(t,e,i){const r=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const o=r.getUTCDay();return o===0?7:o}function W4(t,e,i){return i+(av(t)?Z4:H4)[e-1]}function Y4(t,e){const i=av(t)?Z4:H4,r=i.findIndex(h=>h<e),o=e-i[r];return{month:r+1,day:o}}function Q$(t,e){return(t-e+7)%7+1}function i1(t,e=4,i=1){const{year:r,month:o,day:h}=t,d=W4(r,o,h),a=Q$(K$(r,o,h),i);let v=Math.floor((d-a+14-e)/7),T;return v<1?(T=r-1,v=I0(T,e,i)):v>I0(r,e,i)?(T=r+1,v=1):T=r,{weekYear:T,weekNumber:v,weekday:a,...Ew(t)}}function DD(t,e=4,i=1){const{weekYear:r,weekNumber:o,weekday:h}=t,d=Q$(K$(r,1,e),i),a=Df(r);let v=o*7+h-d-7+e,T;v<1?(T=r-1,v+=Df(T)):v>a?(T=r+1,v-=Df(r)):T=r;const{month:E,day:k}=Y4(T,v);return{year:T,month:E,day:k,...Ew(t)}}function aT(t){const{year:e,month:i,day:r}=t,o=W4(e,i,r);return{year:e,ordinal:o,...Ew(t)}}function zD(t){const{year:e,ordinal:i}=t,{month:r,day:o}=Y4(e,i);return{year:e,month:r,day:o,...Ew(t)}}function OD(t,e){if(!Zt(t.localWeekday)||!Zt(t.localWeekNumber)||!Zt(t.localWeekYear)){if(!Zt(t.weekday)||!Zt(t.weekNumber)||!Zt(t.weekYear))throw new _f("Cannot mix locale-based week fields with ISO-based week fields");return Zt(t.localWeekday)||(t.weekday=t.localWeekday),Zt(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),Zt(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Nee(t,e=4,i=1){const r=Sw(t.weekYear),o=Vo(t.weekNumber,1,I0(t.weekYear,e,i)),h=Vo(t.weekday,1,7);return r?o?h?!1:Uo("weekday",t.weekday):Uo("week",t.weekNumber):Uo("weekYear",t.weekYear)}function Bee(t){const e=Sw(t.year),i=Vo(t.ordinal,1,Df(t.year));return e?i?!1:Uo("ordinal",t.ordinal):Uo("year",t.year)}function X4(t){const e=Sw(t.year),i=Vo(t.month,1,12),r=Vo(t.day,1,r1(t.year,t.month));return e?i?r?!1:Uo("day",t.day):Uo("month",t.month):Uo("year",t.year)}function J4(t){const{hour:e,minute:i,second:r,millisecond:o}=t,h=Vo(e,0,23)||e===24&&i===0&&r===0&&o===0,d=Vo(i,0,59),a=Vo(r,0,59),v=Vo(o,0,999);return h?d?a?v?!1:Uo("millisecond",o):Uo("second",r):Uo("minute",i):Uo("hour",e)}function Zt(t){return typeof t>"u"}function Lu(t){return typeof t=="number"}function Sw(t){return typeof t=="number"&&t%1===0}function jee(t){return typeof t=="string"}function Uee(t){return Object.prototype.toString.call(t)==="[object Date]"}function K4(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Q4(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function Vee(t){return Array.isArray(t)?t:[t]}function RD(t,e,i){if(t.length!==0)return t.reduce((r,o)=>{const h=[e(o),o];return r&&i(r[0],h[0])===r[0]?r:h},null)[1]}function Gee(t,e){return e.reduce((i,r)=>(i[r]=t[r],i),{})}function hm(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function tE(t){if(t==null)return null;if(typeof t!="object")throw new Zn("Week settings must be an object");if(!Vo(t.firstDay,1,7)||!Vo(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!Vo(e,1,7)))throw new Zn("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function Vo(t,e,i){return Sw(t)&&t>=e&&t<=i}function qee(t,e){return t-e*Math.floor(t/e)}function tn(t,e=2){const i=t<0;let r;return i?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function bu(t){if(!(Zt(t)||t===null||t===""))return parseInt(t,10)}function Oh(t){if(!(Zt(t)||t===null||t===""))return parseFloat(t)}function eP(t){if(!(Zt(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function tP(t,e,i="round"){const r=10**e;switch(i){case"expand":return t>0?Math.ceil(t*r)/r:Math.floor(t*r)/r;case"trunc":return Math.trunc(t*r)/r;case"round":return Math.round(t*r)/r;case"floor":return Math.floor(t*r)/r;case"ceil":return Math.ceil(t*r)/r;default:throw new RangeError(`Value rounding ${i} is out of range`)}}function av(t){return t%4===0&&(t%100!==0||t%400===0)}function Df(t){return av(t)?366:365}function r1(t,e){const i=qee(e-1,12)+1,r=t+(e-i)/12;return i===2?av(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function Tw(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function LD(t,e,i){return-Q$(K$(t,1,e),i)+e-1}function I0(t,e=4,i=1){const r=LD(t,e,i),o=LD(t+1,e,i);return(Df(t)-r+o)/7}function iE(t){return t>99?t:t>Er.twoDigitCutoffYear?1900+t:2e3+t}function e6(t,e,i,r=null){const o=new Date(t),h={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(h.timeZone=r);const d={timeZoneName:e,...h},a=new Intl.DateTimeFormat(i,d).formatToParts(o).find(v=>v.type.toLowerCase()==="timezonename");return a?a.value:null}function Cw(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const r=parseInt(e,10)||0,o=i<0||Object.is(i,-0)?-r:r;return i*60+o}function t6(t){const e=Number(t);if(typeof t=="boolean"||t===""||!Number.isFinite(e))throw new Zn(`Invalid unit value ${t}`);return e}function n1(t,e){const i={};for(const r in t)if(hm(t,r)){const o=t[r];if(o==null)continue;i[e(r)]=t6(o)}return i}function Yy(t,e){const i=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),o=t>=0?"+":"-";switch(e){case"short":return`${o}${tn(i,2)}:${tn(r,2)}`;case"narrow":return`${o}${i}${r>0?`:${r}`:""}`;case"techie":return`${o}${tn(i,2)}${tn(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function Ew(t){return Gee(t,["hour","minute","second","millisecond"])}const Hee=["January","February","March","April","May","June","July","August","September","October","November","December"],i6=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Zee=["J","F","M","A","M","J","J","A","S","O","N","D"];function r6(t){switch(t){case"narrow":return[...Zee];case"short":return[...i6];case"long":return[...Hee];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const n6=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],s6=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Wee=["M","T","W","T","F","S","S"];function o6(t){switch(t){case"narrow":return[...Wee];case"short":return[...s6];case"long":return[...n6];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const a6=["AM","PM"],Yee=["Before Christ","Anno Domini"],Xee=["BC","AD"],Jee=["B","A"];function l6(t){switch(t){case"narrow":return[...Jee];case"short":return[...Xee];case"long":return[...Yee];default:return null}}function Kee(t){return a6[t.hour<12?0:1]}function Qee(t,e){return o6(e)[t.weekday-1]}function ete(t,e){return r6(e)[t.month-1]}function tte(t,e){return l6(e)[t.year<0?0:1]}function ite(t,e,i="always",r=!1){const o={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},h=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&h){const k=t==="days";switch(e){case 1:return k?"tomorrow":`next ${o[t][0]}`;case-1:return k?"yesterday":`last ${o[t][0]}`;case 0:return k?"today":`this ${o[t][0]}`}}const d=Object.is(e,-0)||e<0,a=Math.abs(e),v=a===1,T=o[t],E=r?v?T[1]:T[2]||T[1]:v?o[t][0]:t;return d?`${a} ${E} ago`:`in ${a} ${E}`}function FD(t,e){let i="";for(const r of t)r.literal?i+=r.val:i+=e(r.val);return i}const rte={D:t1,DD:C4,DDD:E4,DDDD:I4,t:$4,tt:P4,ttt:M4,tttt:k4,T:A4,TT:D4,TTT:z4,TTTT:O4,f:R4,ff:F4,fff:B4,ffff:U4,F:L4,FF:N4,FFF:j4,FFFF:V4};class Jn{static create(e,i={}){return new Jn(e,i)}static parseFormat(e){let i=null,r="",o=!1;const h=[];for(let d=0;d<e.length;d++){const a=e.charAt(d);a==="'"?((r.length>0||o)&&h.push({literal:o||/^\s+$/.test(r),val:r===""?"'":r}),i=null,r="",o=!o):o||a===i?r+=a:(r.length>0&&h.push({literal:/^\s+$/.test(r),val:r}),r=a,i=a)}return r.length>0&&h.push({literal:o||/^\s+$/.test(r),val:r}),h}static macroTokenToFormatOpts(e){return rte[e]}constructor(e,i){this.opts=i,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...i}).format()}dtFormatter(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i})}formatDateTime(e,i){return this.dtFormatter(e,i).format()}formatDateTimeParts(e,i){return this.dtFormatter(e,i).formatToParts()}formatInterval(e,i){return this.dtFormatter(e.start,i).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,i){return this.dtFormatter(e,i).resolvedOptions()}num(e,i=0,r=void 0){if(this.opts.forceSimple)return tn(e,i);const o={...this.opts};return i>0&&(o.padTo=i),r&&(o.signDisplay=r),this.loc.numberFormatter(o).format(e)}formatDateTimeFromString(e,i){const r=this.loc.listingMode()==="en",o=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",h=(O,H)=>this.loc.extract(e,O,H),d=O=>e.isOffsetFixed&&e.offset===0&&O.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,O.format):"",a=()=>r?Kee(e):h({hour:"numeric",hourCycle:"h12"},"dayperiod"),v=(O,H)=>r?ete(e,O):h(H?{month:O}:{month:O,day:"numeric"},"month"),T=(O,H)=>r?Qee(e,O):h(H?{weekday:O}:{weekday:O,month:"long",day:"numeric"},"weekday"),E=O=>{const H=Jn.macroTokenToFormatOpts(O);return H?this.formatWithSystemDefault(e,H):O},k=O=>r?tte(e,O):h({era:O},"era"),L=O=>{switch(O){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return d({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return d({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return d({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return o?h({day:"numeric"},"day"):this.num(e.day);case"dd":return o?h({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return T("short",!0);case"cccc":return T("long",!0);case"ccccc":return T("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return T("short",!1);case"EEEE":return T("long",!1);case"EEEEE":return T("narrow",!1);case"L":return o?h({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return o?h({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return v("short",!0);case"LLLL":return v("long",!0);case"LLLLL":return v("narrow",!0);case"M":return o?h({month:"numeric"},"month"):this.num(e.month);case"MM":return o?h({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return v("short",!1);case"MMMM":return v("long",!1);case"MMMMM":return v("narrow",!1);case"y":return o?h({year:"numeric"},"year"):this.num(e.year);case"yy":return o?h({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return o?h({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return o?h({year:"numeric"},"year"):this.num(e.year,6);case"G":return k("short");case"GG":return k("long");case"GGGGG":return k("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return E(O)}};return FD(Jn.parseFormat(i),L)}formatDurationFromString(e,i){const r=this.opts.signMode==="negativeLargestOnly"?-1:1,o=E=>{switch(E[0]){case"S":return"milliseconds";case"s":return"seconds";case"m":return"minutes";case"h":return"hours";case"d":return"days";case"w":return"weeks";case"M":return"months";case"y":return"years";default:return null}},h=(E,k)=>L=>{const O=o(L);if(O){const H=k.isNegativeDuration&&O!==k.largestUnit?r:1;let ie;return this.opts.signMode==="negativeLargestOnly"&&O!==k.largestUnit?ie="never":this.opts.signMode==="all"?ie="always":ie="auto",this.num(E.get(O)*H,L.length,ie)}else return L},d=Jn.parseFormat(i),a=d.reduce((E,{literal:k,val:L})=>k?E:E.concat(L),[]),v=e.shiftTo(...a.map(o).filter(E=>E)),T={isNegativeDuration:v<0,largestUnit:Object.keys(v.values)[0]};return FD(d,h(v,T))}}const c6=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Im(...t){const e=t.reduce((i,r)=>i+r.source,"");return RegExp(`^${e}$`)}function $m(...t){return e=>t.reduce(([i,r,o],h)=>{const[d,a,v]=h(e,o);return[{...i,...d},a||r,v]},[{},null,1]).slice(0,2)}function Pm(t,...e){if(t==null)return[null,null];for(const[i,r]of e){const o=i.exec(t);if(o)return r(o)}return[null,null]}function u6(...t){return(e,i)=>{const r={};let o;for(o=0;o<t.length;o++)r[t[o]]=bu(e[i+o]);return[r,null,i+o]}}const h6=/(?:([Zz])|([+-]\d\d)(?::?(\d\d))?)/,nte=`(?:${h6.source}?(?:\\[(${c6.source})\\])?)?`,iP=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,d6=RegExp(`${iP.source}${nte}`),rP=RegExp(`(?:[Tt]${d6.source})?`),ste=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,ote=/(\d{4})-?W(\d\d)(?:-?(\d))?/,ate=/(\d{4})-?(\d{3})/,lte=u6("weekYear","weekNumber","weekDay"),cte=u6("year","ordinal"),ute=/(\d{4})-(\d\d)-(\d\d)/,p6=RegExp(`${iP.source} ?(?:${h6.source}|(${c6.source}))?`),hte=RegExp(`(?: ${p6.source})?`);function zf(t,e,i){const r=t[e];return Zt(r)?i:bu(r)}function dte(t,e){return[{year:zf(t,e),month:zf(t,e+1,1),day:zf(t,e+2,1)},null,e+3]}function Mm(t,e){return[{hours:zf(t,e,0),minutes:zf(t,e+1,0),seconds:zf(t,e+2,0),milliseconds:eP(t[e+3])},null,e+4]}function lv(t,e){const i=!t[e]&&!t[e+1],r=Cw(t[e+1],t[e+2]),o=i?null:fs.instance(r);return[{},o,e+3]}function cv(t,e){const i=t[e]?$a.create(t[e]):null;return[{},i,e+1]}const pte=RegExp(`^T?${iP.source}$`),fte=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function mte(t){const[e,i,r,o,h,d,a,v,T]=t,E=e[0]==="-",k=v&&v[0]==="-",L=(O,H=!1)=>O!==void 0&&(H||O&&E)?-O:O;return[{years:L(Oh(i)),months:L(Oh(r)),weeks:L(Oh(o)),days:L(Oh(h)),hours:L(Oh(d)),minutes:L(Oh(a)),seconds:L(Oh(v),v==="-0"),milliseconds:L(eP(T),k)}]}const gte={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function nP(t,e,i,r,o,h,d){const a={year:e.length===2?iE(bu(e)):bu(e),month:i6.indexOf(i)+1,day:bu(r),hour:bu(o),minute:bu(h)};return d&&(a.second=bu(d)),t&&(a.weekday=t.length>3?n6.indexOf(t)+1:s6.indexOf(t)+1),a}const yte=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function vte(t){const[,e,i,r,o,h,d,a,v,T,E,k]=t,L=nP(e,o,r,i,h,d,a);let O;return v?O=gte[v]:T?O=0:O=Cw(E,k),[L,new fs(O)]}function _te(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const bte=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,xte=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,wte=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function ND(t){const[,e,i,r,o,h,d,a]=t;return[nP(e,o,r,i,h,d,a),fs.utcInstance]}function Ste(t){const[,e,i,r,o,h,d,a]=t;return[nP(e,a,i,r,o,h,d),fs.utcInstance]}const Tte=Im(ste,rP),Cte=Im(ote,rP),Ete=Im(ate,rP),Ite=Im(d6),f6=$m(dte,Mm,lv,cv),$te=$m(lte,Mm,lv,cv),Pte=$m(cte,Mm,lv,cv),Mte=$m(Mm,lv,cv);function kte(t){return Pm(t,[Tte,f6],[Cte,$te],[Ete,Pte],[Ite,Mte])}function Ate(t){return Pm(_te(t),[yte,vte])}function Dte(t){return Pm(t,[bte,ND],[xte,ND],[wte,Ste])}function zte(t){return Pm(t,[fte,mte])}const Ote=$m(Mm);function Rte(t){return Pm(t,[pte,Ote])}const Lte=Im(ute,hte),Fte=Im(p6),Nte=$m(Mm,lv,cv);function Bte(t){return Pm(t,[Lte,f6],[Fte,Nte])}const BD="Invalid Duration",m6={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},jte={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...m6},Mo=146097/400,qp=146097/4800,Ute={years:{quarters:4,months:12,weeks:Mo/7,days:Mo,hours:Mo*24,minutes:Mo*24*60,seconds:Mo*24*60*60,milliseconds:Mo*24*60*60*1e3},quarters:{months:3,weeks:Mo/28,days:Mo/4,hours:Mo*24/4,minutes:Mo*24*60/4,seconds:Mo*24*60*60/4,milliseconds:Mo*24*60*60*1e3/4},months:{weeks:qp/7,days:qp,hours:qp*24,minutes:qp*24*60,seconds:qp*24*60*60,milliseconds:qp*24*60*60*1e3},...m6},id=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Vte=id.slice(0).reverse();function Ql(t,e,i=!1){const r={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new xi(r)}function g6(t,e){let i=e.milliseconds??0;for(const r of Vte.slice(1))e[r]&&(i+=e[r]*t[r].milliseconds);return i}function jD(t,e){const i=g6(t,e)<0?-1:1;id.reduceRight((r,o)=>{if(Zt(e[o]))return r;if(r){const h=e[r]*i,d=t[o][r],a=Math.floor(h/d);e[o]+=a*i,e[r]-=a*d*i}return o},null),id.reduce((r,o)=>{if(Zt(e[o]))return r;if(r){const h=e[r]%1;e[r]-=h,e[o]+=h*t[r][o]}return o},null)}function UD(t){const e={};for(const[i,r]of Object.entries(t))r!==0&&(e[i]=r);return e}class xi{constructor(e){const i=e.conversionAccuracy==="longterm"||!1;let r=i?Ute:jte;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||Di.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,i){return xi.fromObject({milliseconds:e},i)}static fromObject(e,i={}){if(e==null||typeof e!="object")throw new Zn(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new xi({values:n1(e,xi.normalizeUnit),loc:Di.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(e){if(Lu(e))return xi.fromMillis(e);if(xi.isDuration(e))return e;if(typeof e=="object")return xi.fromObject(e);throw new Zn(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,i){const[r]=zte(e);return r?xi.fromObject(r,i):xi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,i){const[r]=Rte(e);return r?xi.fromObject(r,i):xi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,i=null){if(!e)throw new Zn("need to specify a reason the Duration is invalid");const r=e instanceof ba?e:new ba(e,i);if(Er.throwOnInvalid)throw new mee(r);return new xi({invalid:r})}static normalizeUnit(e){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!i)throw new T4(e);return i}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,i={}){const r={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?Jn.create(this.loc,r).formatDurationFromString(this,e):BD}toHuman(e={}){if(!this.isValid)return BD;const i=e.showZeros!==!1,r=id.map(o=>{const h=this.values[o];return Zt(h)||h===0&&!i?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:o.slice(0,-1)}).format(h)}).filter(o=>o);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=tP(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},Rt.fromMillis(i,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?g6(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const i=xi.fromDurationLike(e),r={};for(const o of id)(hm(i.values,o)||hm(this.values,o))&&(r[o]=i.get(o)+this.get(o));return Ql(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const i=xi.fromDurationLike(e);return this.plus(i.negate())}mapUnits(e){if(!this.isValid)return this;const i={};for(const r of Object.keys(this.values))i[r]=t6(e(this.values[r],r));return Ql(this,{values:i},!0)}get(e){return this[xi.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const i={...this.values,...n1(e,xi.normalizeUnit)};return Ql(this,{values:i})}reconfigure({locale:e,numberingSystem:i,conversionAccuracy:r,matrix:o}={}){const d={loc:this.loc.clone({locale:e,numberingSystem:i}),matrix:o,conversionAccuracy:r};return Ql(this,d)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return jD(this.matrix,e),Ql(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=UD(this.normalize().shiftToAll().toObject());return Ql(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(d=>xi.normalizeUnit(d));const i={},r={},o=this.toObject();let h;for(const d of id)if(e.indexOf(d)>=0){h=d;let a=0;for(const T in r)a+=this.matrix[T][d]*r[T],r[T]=0;Lu(o[d])&&(a+=o[d]);const v=Math.trunc(a);i[d]=v,r[d]=(a*1e3-v*1e3)/1e3}else Lu(o[d])&&(r[d]=o[d]);for(const d in r)r[d]!==0&&(i[h]+=d===h?r[d]:r[d]/this.matrix[h][d]);return jD(this.matrix,i),Ql(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=this.values[i]===0?0:-this.values[i];return Ql(this,{values:e},!0)}removeZeros(){if(!this.isValid)return this;const e=UD(this.values);return Ql(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function i(r,o){return r===void 0||r===0?o===void 0||o===0:r===o}for(const r of id)if(!i(this.values[r],e.values[r]))return!1;return!0}}const Hp="Invalid Interval";function Gte(t,e){return!t||!t.isValid?Cr.invalid("missing or invalid start"):!e||!e.isValid?Cr.invalid("missing or invalid end"):e<t?Cr.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Cr{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,i=null){if(!e)throw new Zn("need to specify a reason the Interval is invalid");const r=e instanceof ba?e:new ba(e,i);if(Er.throwOnInvalid)throw new fee(r);return new Cr({invalid:r})}static fromDateTimes(e,i){const r=Kg(e),o=Kg(i),h=Gte(r,o);return h??new Cr({start:r,end:o})}static after(e,i){const r=xi.fromDurationLike(i),o=Kg(e);return Cr.fromDateTimes(o,o.plus(r))}static before(e,i){const r=xi.fromDurationLike(i),o=Kg(e);return Cr.fromDateTimes(o.minus(r),o)}static fromISO(e,i){const[r,o]=(e||"").split("/",2);if(r&&o){let h,d;try{h=Rt.fromISO(r,i),d=h.isValid}catch{d=!1}let a,v;try{a=Rt.fromISO(o,i),v=a.isValid}catch{v=!1}if(d&&v)return Cr.fromDateTimes(h,a);if(d){const T=xi.fromISO(o,i);if(T.isValid)return Cr.after(h,T)}else if(v){const T=xi.fromISO(r,i);if(T.isValid)return Cr.before(a,T)}}return Cr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",i){if(!this.isValid)return NaN;const r=this.start.startOf(e,i);let o;return i?.useLocaleWeeks?o=this.end.reconfigure({locale:r.locale}):o=this.end,o=o.startOf(e,i),Math.floor(o.diff(r,e).get(e))+(o.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:i}={}){return this.isValid?Cr.fromDateTimes(e||this.s,i||this.e):this}splitAt(...e){if(!this.isValid)return[];const i=e.map(Kg).filter(d=>this.contains(d)).sort((d,a)=>d.toMillis()-a.toMillis()),r=[];let{s:o}=this,h=0;for(;o<this.e;){const d=i[h]||this.e,a=+d>+this.e?this.e:d;r.push(Cr.fromDateTimes(o,a)),o=a,h+=1}return r}splitBy(e){const i=xi.fromDurationLike(e);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:r}=this,o=1,h;const d=[];for(;r<this.e;){const a=this.start.plus(i.mapUnits(v=>v*o));h=+a>+this.e?this.e:a,d.push(Cr.fromDateTimes(r,h)),r=h,o+=1}return d}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const i=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return i>=r?null:Cr.fromDateTimes(i,r)}union(e){if(!this.isValid)return this;const i=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return Cr.fromDateTimes(i,r)}static merge(e){const[i,r]=e.sort((o,h)=>o.s-h.s).reduce(([o,h],d)=>h?h.overlaps(d)||h.abutsStart(d)?[o,h.union(d)]:[o.concat([h]),d]:[o,d],[[],null]);return r&&i.push(r),i}static xor(e){let i=null,r=0;const o=[],h=e.map(v=>[{time:v.s,type:"s"},{time:v.e,type:"e"}]),d=Array.prototype.concat(...h),a=d.sort((v,T)=>v.time-T.time);for(const v of a)r+=v.type==="s"?1:-1,r===1?i=v.time:(i&&+i!=+v.time&&o.push(Cr.fromDateTimes(i,v.time)),i=null);return Cr.merge(o)}difference(...e){return Cr.xor([this].concat(e)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:Hp}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=t1,i={}){return this.isValid?Jn.create(this.s.loc.clone(i),e).formatInterval(this):Hp}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Hp}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Hp}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Hp}toFormat(e,{separator:i="  "}={}){return this.isValid?`${this.s.toFormat(e)}${i}${this.e.toFormat(e)}`:Hp}toDuration(e,i){return this.isValid?this.e.diff(this.s,e,i):xi.invalid(this.invalidReason)}mapEndpoints(e){return Cr.fromDateTimes(e(this.s),e(this.e))}}class H_{static hasDST(e=Er.defaultZone){const i=Rt.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(e){return $a.isValidZone(e)}static normalizeZone(e){return Eu(e,Er.defaultZone)}static getStartOfWeek({locale:e=null,locObj:i=null}={}){return(i||Di.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:i=null}={}){return(i||Di.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:i=null}={}){return(i||Di.create(e)).getWeekendDays().slice()}static months(e="long",{locale:i=null,numberingSystem:r=null,locObj:o=null,outputCalendar:h="gregory"}={}){return(o||Di.create(i,r,h)).months(e)}static monthsFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:o=null,outputCalendar:h="gregory"}={}){return(o||Di.create(i,r,h)).months(e,!0)}static weekdays(e="long",{locale:i=null,numberingSystem:r=null,locObj:o=null}={}){return(o||Di.create(i,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:o=null}={}){return(o||Di.create(i,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Di.create(e).meridiems()}static eras(e="short",{locale:i=null}={}){return Di.create(i,null,"gregory").eras(e)}static features(){return{relative:K4(),localeWeek:Q4()}}}function VD(t,e){const i=o=>o.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=i(e)-i(t);return Math.floor(xi.fromMillis(r).as("days"))}function qte(t,e,i){const r=[["years",(v,T)=>T.year-v.year],["quarters",(v,T)=>T.quarter-v.quarter+(T.year-v.year)*4],["months",(v,T)=>T.month-v.month+(T.year-v.year)*12],["weeks",(v,T)=>{const E=VD(v,T);return(E-E%7)/7}],["days",VD]],o={},h=t;let d,a;for(const[v,T]of r)i.indexOf(v)>=0&&(d=v,o[v]=T(t,e),a=h.plus(o),a>e?(o[v]--,t=h.plus(o),t>e&&(a=t,o[v]--,t=h.plus(o))):t=a);return[t,o,a,d]}function Hte(t,e,i,r){let[o,h,d,a]=qte(t,e,i);const v=e-o,T=i.filter(k=>["hours","minutes","seconds","milliseconds"].indexOf(k)>=0);T.length===0&&(d<e&&(d=o.plus({[a]:1})),d!==o&&(h[a]=(h[a]||0)+v/(d-o)));const E=xi.fromObject(h,r);return T.length>0?xi.fromMillis(v,r).shiftTo(...T).plus(E):E}const Zte="missing Intl.DateTimeFormat.formatToParts support";function Ii(t,e=i=>i){return{regex:t,deser:([i])=>e(Lee(i))}}const Wte="",y6=`[ ${Wte}]`,v6=new RegExp(y6,"g");function Yte(t){return t.replace(/\./g,"\\.?").replace(v6,y6)}function GD(t){return t.replace(/\./g,"").replace(v6," ").toLowerCase()}function ha(t,e){return t===null?null:{regex:RegExp(t.map(Yte).join("|")),deser:([i])=>t.findIndex(r=>GD(i)===GD(r))+e}}function qD(t,e){return{regex:t,deser:([,i,r])=>Cw(i,r),groups:e}}function Z_(t){return{regex:t,deser:([e])=>e}}function Xte(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Jte(t,e){const i=ua(e),r=ua(e,"{2}"),o=ua(e,"{3}"),h=ua(e,"{4}"),d=ua(e,"{6}"),a=ua(e,"{1,2}"),v=ua(e,"{1,3}"),T=ua(e,"{1,6}"),E=ua(e,"{1,9}"),k=ua(e,"{2,4}"),L=ua(e,"{4,6}"),O=pe=>({regex:RegExp(Xte(pe.val)),deser:([be])=>be,literal:!0}),ie=(pe=>{if(t.literal)return O(pe);switch(pe.val){case"G":return ha(e.eras("short"),0);case"GG":return ha(e.eras("long"),0);case"y":return Ii(T);case"yy":return Ii(k,iE);case"yyyy":return Ii(h);case"yyyyy":return Ii(L);case"yyyyyy":return Ii(d);case"M":return Ii(a);case"MM":return Ii(r);case"MMM":return ha(e.months("short",!0),1);case"MMMM":return ha(e.months("long",!0),1);case"L":return Ii(a);case"LL":return Ii(r);case"LLL":return ha(e.months("short",!1),1);case"LLLL":return ha(e.months("long",!1),1);case"d":return Ii(a);case"dd":return Ii(r);case"o":return Ii(v);case"ooo":return Ii(o);case"HH":return Ii(r);case"H":return Ii(a);case"hh":return Ii(r);case"h":return Ii(a);case"mm":return Ii(r);case"m":return Ii(a);case"q":return Ii(a);case"qq":return Ii(r);case"s":return Ii(a);case"ss":return Ii(r);case"S":return Ii(v);case"SSS":return Ii(o);case"u":return Z_(E);case"uu":return Z_(a);case"uuu":return Ii(i);case"a":return ha(e.meridiems(),0);case"kkkk":return Ii(h);case"kk":return Ii(k,iE);case"W":return Ii(a);case"WW":return Ii(r);case"E":case"c":return Ii(i);case"EEE":return ha(e.weekdays("short",!1),1);case"EEEE":return ha(e.weekdays("long",!1),1);case"ccc":return ha(e.weekdays("short",!0),1);case"cccc":return ha(e.weekdays("long",!0),1);case"Z":case"ZZ":return qD(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return qD(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return Z_(/[a-z_+-/]{1,256}?/i);case" ":return Z_(/[^\S\n\r]/);default:return O(pe)}})(t)||{invalidReason:Zte};return ie.token=t,ie}const Kte={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function Qte(t,e,i){const{type:r,value:o}=t;if(r==="literal"){const v=/^\s+$/.test(o);return{literal:!v,val:v?" ":o}}const h=e[r];let d=r;r==="hour"&&(e.hour12!=null?d=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?d="hour12":d="hour24":d=i.hour12?"hour12":"hour24");let a=Kte[d];if(typeof a=="object"&&(a=a[h]),a)return{literal:!1,val:a}}function eie(t){return[`^${t.map(i=>i.regex).reduce((i,r)=>`${i}(${r.source})`,"")}$`,t]}function tie(t,e,i){const r=t.match(e);if(r){const o={};let h=1;for(const d in i)if(hm(i,d)){const a=i[d],v=a.groups?a.groups+1:1;!a.literal&&a.token&&(o[a.token.val[0]]=a.deser(r.slice(h,h+v))),h+=v}return[r,o]}else return[r,{}]}function iie(t){const e=h=>{switch(h){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,r;return Zt(t.z)||(i=$a.create(t.z)),Zt(t.Z)||(i||(i=new fs(t.Z)),r=t.Z),Zt(t.q)||(t.M=(t.q-1)*3+1),Zt(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Zt(t.u)||(t.S=eP(t.u)),[Object.keys(t).reduce((h,d)=>{const a=e(d);return a&&(h[a]=t[d]),h},{}),i,r]}let lT=null;function rie(){return lT||(lT=Rt.fromMillis(1555555555555)),lT}function nie(t,e){if(t.literal)return t;const i=Jn.macroTokenToFormatOpts(t.val),r=w6(i,e);return r==null||r.includes(void 0)?t:r}function _6(t,e){return Array.prototype.concat(...t.map(i=>nie(i,e)))}class b6{constructor(e,i){if(this.locale=e,this.format=i,this.tokens=_6(Jn.parseFormat(i),e),this.units=this.tokens.map(r=>Jte(r,e)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){const[r,o]=eie(this.units);this.regex=RegExp(r,"i"),this.handlers=o}}explainFromTokens(e){if(this.isValid){const[i,r]=tie(e,this.regex,this.handlers),[o,h,d]=r?iie(r):[null,null,void 0];if(hm(r,"a")&&hm(r,"H"))throw new _f("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:i,matches:r,result:o,zone:h,specificOffset:d}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function x6(t,e,i){return new b6(t,i).explainFromTokens(e)}function sie(t,e,i){const{result:r,zone:o,specificOffset:h,invalidReason:d}=x6(t,e,i);return[r,o,h,d]}function w6(t,e){if(!t)return null;const r=Jn.create(e,t).dtFormatter(rie()),o=r.formatToParts(),h=r.resolvedOptions();return o.map(d=>Qte(d,t,h))}const cT="Invalid DateTime",HD=864e13;function by(t){return new ba("unsupported zone",`the zone "${t.name}" is not supported`)}function uT(t){return t.weekData===null&&(t.weekData=i1(t.c)),t.weekData}function hT(t){return t.localWeekData===null&&(t.localWeekData=i1(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function Rh(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Rt({...i,...e,old:i})}function S6(t,e,i){let r=t-e*60*1e3;const o=i.offset(r);if(e===o)return[r,e];r-=(o-e)*60*1e3;const h=i.offset(r);return o===h?[r,o]:[t-Math.min(o,h)*60*1e3,Math.max(o,h)]}function W_(t,e){t+=e*60*1e3;const i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function Mb(t,e,i){return S6(Tw(t),e,i)}function ZD(t,e){const i=t.o,r=t.c.year+Math.trunc(e.years),o=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,h={...t.c,year:r,month:o,day:Math.min(t.c.day,r1(r,o))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},d=xi.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=Tw(h);let[v,T]=S6(a,i,t.zone);return d!==0&&(v+=d,T=t.zone.offset(v)),{ts:v,o:T}}function Zp(t,e,i,r,o,h){const{setZone:d,zone:a}=i;if(t&&Object.keys(t).length!==0||e){const v=e||a,T=Rt.fromObject(t,{...i,zone:v,specificOffset:h});return d?T:T.setZone(a)}else return Rt.invalid(new ba("unparsable",`the input "${o}" can't be parsed as ${r}`))}function Y_(t,e,i=!0){return t.isValid?Jn.create(Di.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function dT(t,e,i){const r=t.c.year>9999||t.c.year<0;let o="";if(r&&t.c.year>=0&&(o+="+"),o+=tn(t.c.year,r?6:4),i==="year")return o;if(e){if(o+="-",o+=tn(t.c.month),i==="month")return o;o+="-"}else if(o+=tn(t.c.month),i==="month")return o;return o+=tn(t.c.day),o}function WD(t,e,i,r,o,h,d){let a=!i||t.c.millisecond!==0||t.c.second!==0,v="";switch(d){case"day":case"month":case"year":break;default:if(v+=tn(t.c.hour),d==="hour")break;if(e){if(v+=":",v+=tn(t.c.minute),d==="minute")break;a&&(v+=":",v+=tn(t.c.second))}else{if(v+=tn(t.c.minute),d==="minute")break;a&&(v+=tn(t.c.second))}if(d==="second")break;a&&(!r||t.c.millisecond!==0)&&(v+=".",v+=tn(t.c.millisecond,3))}return o&&(t.isOffsetFixed&&t.offset===0&&!h?v+="Z":t.o<0?(v+="-",v+=tn(Math.trunc(-t.o/60)),v+=":",v+=tn(Math.trunc(-t.o%60))):(v+="+",v+=tn(Math.trunc(t.o/60)),v+=":",v+=tn(Math.trunc(t.o%60)))),h&&(v+="["+t.zone.ianaName+"]"),v}const T6={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},oie={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},aie={ordinal:1,hour:0,minute:0,second:0,millisecond:0},kb=["year","month","day","hour","minute","second","millisecond"],lie=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],cie=["year","ordinal","hour","minute","second","millisecond"];function Ab(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new T4(t);return e}function YD(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return Ab(t)}}function uie(t){if(xy===void 0&&(xy=Er.now()),t.type!=="iana")return t.offset(xy);const e=t.name;let i=rE.get(e);return i===void 0&&(i=t.offset(xy),rE.set(e,i)),i}function XD(t,e){const i=Eu(e.zone,Er.defaultZone);if(!i.isValid)return Rt.invalid(by(i));const r=Di.fromObject(e);let o,h;if(Zt(t.year))o=Er.now();else{for(const v of kb)Zt(t[v])&&(t[v]=T6[v]);const d=X4(t)||J4(t);if(d)return Rt.invalid(d);const a=uie(i);[o,h]=Mb(t,a,i)}return new Rt({ts:o,zone:i,loc:r,o:h})}function JD(t,e,i){const r=Zt(i.round)?!0:i.round,o=Zt(i.rounding)?"trunc":i.rounding,h=(a,v)=>(a=tP(a,r||i.calendary?0:2,i.calendary?"round":o),e.loc.clone(i).relFormatter(i).format(a,v)),d=a=>i.calendary?e.hasSame(t,a)?0:e.startOf(a).diff(t.startOf(a),a).get(a):e.diff(t,a).get(a);if(i.unit)return h(d(i.unit),i.unit);for(const a of i.units){const v=d(a);if(Math.abs(v)>=1)return h(v,a)}return h(t>e?-0:0,i.units[i.units.length-1])}function KD(t){let e={},i;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],i=Array.from(t).slice(0,t.length-1)):i=Array.from(t),[e,i]}let xy;const rE=new Map;class Rt{constructor(e){const i=e.zone||Er.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new ba("invalid input"):null)||(i.isValid?null:by(i));this.ts=Zt(e.ts)?Er.now():e.ts;let o=null,h=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(i))[o,h]=[e.old.c,e.old.o];else{const a=Lu(e.o)&&!e.old?e.o:i.offset(this.ts);o=W_(this.ts,a),r=Number.isNaN(o.year)?new ba("invalid input"):null,o=r?null:o,h=r?null:a}this._zone=i,this.loc=e.loc||Di.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=o,this.o=h,this.isLuxonDateTime=!0}static now(){return new Rt({})}static local(){const[e,i]=KD(arguments),[r,o,h,d,a,v,T]=i;return XD({year:r,month:o,day:h,hour:d,minute:a,second:v,millisecond:T},e)}static utc(){const[e,i]=KD(arguments),[r,o,h,d,a,v,T]=i;return e.zone=fs.utcInstance,XD({year:r,month:o,day:h,hour:d,minute:a,second:v,millisecond:T},e)}static fromJSDate(e,i={}){const r=Uee(e)?e.valueOf():NaN;if(Number.isNaN(r))return Rt.invalid("invalid input");const o=Eu(i.zone,Er.defaultZone);return o.isValid?new Rt({ts:r,zone:o,loc:Di.fromObject(i)}):Rt.invalid(by(o))}static fromMillis(e,i={}){if(Lu(e))return e<-HD||e>HD?Rt.invalid("Timestamp out of range"):new Rt({ts:e,zone:Eu(i.zone,Er.defaultZone),loc:Di.fromObject(i)});throw new Zn(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,i={}){if(Lu(e))return new Rt({ts:e*1e3,zone:Eu(i.zone,Er.defaultZone),loc:Di.fromObject(i)});throw new Zn("fromSeconds requires a numerical input")}static fromObject(e,i={}){e=e||{};const r=Eu(i.zone,Er.defaultZone);if(!r.isValid)return Rt.invalid(by(r));const o=Di.fromObject(i),h=n1(e,YD),{minDaysInFirstWeek:d,startOfWeek:a}=OD(h,o),v=Er.now(),T=Zt(i.specificOffset)?r.offset(v):i.specificOffset,E=!Zt(h.ordinal),k=!Zt(h.year),L=!Zt(h.month)||!Zt(h.day),O=k||L,H=h.weekYear||h.weekNumber;if((O||E)&&H)throw new _f("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(L&&E)throw new _f("Can't mix ordinal dates with month/day");const ie=H||h.weekday&&!O;let pe,be,Ce=W_(v,T);ie?(pe=lie,be=oie,Ce=i1(Ce,d,a)):E?(pe=cie,be=aie,Ce=aT(Ce)):(pe=kb,be=T6);let Pe=!1;for(const et of pe){const We=h[et];Zt(We)?Pe?h[et]=be[et]:h[et]=Ce[et]:Pe=!0}const Ie=ie?Nee(h,d,a):E?Bee(h):X4(h),ke=Ie||J4(h);if(ke)return Rt.invalid(ke);const Ke=ie?DD(h,d,a):E?zD(h):h,[qe,dt]=Mb(Ke,T,r),ft=new Rt({ts:qe,zone:r,o:dt,loc:o});return h.weekday&&O&&e.weekday!==ft.weekday?Rt.invalid("mismatched weekday",`you can't specify both a weekday of ${h.weekday} and a date of ${ft.toISO()}`):ft.isValid?ft:Rt.invalid(ft.invalid)}static fromISO(e,i={}){const[r,o]=kte(e);return Zp(r,o,i,"ISO 8601",e)}static fromRFC2822(e,i={}){const[r,o]=Ate(e);return Zp(r,o,i,"RFC 2822",e)}static fromHTTP(e,i={}){const[r,o]=Dte(e);return Zp(r,o,i,"HTTP",i)}static fromFormat(e,i,r={}){if(Zt(e)||Zt(i))throw new Zn("fromFormat requires an input string and a format");const{locale:o=null,numberingSystem:h=null}=r,d=Di.fromOpts({locale:o,numberingSystem:h,defaultToEN:!0}),[a,v,T,E]=sie(d,e,i);return E?Rt.invalid(E):Zp(a,v,r,`format ${i}`,e,T)}static fromString(e,i,r={}){return Rt.fromFormat(e,i,r)}static fromSQL(e,i={}){const[r,o]=Bte(e);return Zp(r,o,i,"SQL",e)}static invalid(e,i=null){if(!e)throw new Zn("need to specify a reason the DateTime is invalid");const r=e instanceof ba?e:new ba(e,i);if(Er.throwOnInvalid)throw new pee(r);return new Rt({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,i={}){const r=w6(e,Di.fromObject(i));return r?r.map(o=>o?o.val:null).join(""):null}static expandFormat(e,i={}){return _6(Jn.parseFormat(e),Di.fromObject(i)).map(o=>o.val).join("")}static resetCache(){xy=void 0,rE.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?uT(this).weekYear:NaN}get weekNumber(){return this.isValid?uT(this).weekNumber:NaN}get weekday(){return this.isValid?uT(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?hT(this).weekday:NaN}get localWeekNumber(){return this.isValid?hT(this).weekNumber:NaN}get localWeekYear(){return this.isValid?hT(this).weekYear:NaN}get ordinal(){return this.isValid?aT(this.c).ordinal:NaN}get monthShort(){return this.isValid?H_.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?H_.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?H_.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?H_.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,i=6e4,r=Tw(this.c),o=this.zone.offset(r-e),h=this.zone.offset(r+e),d=this.zone.offset(r-o*i),a=this.zone.offset(r-h*i);if(d===a)return[this];const v=r-d*i,T=r-a*i,E=W_(v,d),k=W_(T,a);return E.hour===k.hour&&E.minute===k.minute&&E.second===k.second&&E.millisecond===k.millisecond?[Rh(this,{ts:v}),Rh(this,{ts:T})]:[this]}get isInLeapYear(){return av(this.year)}get daysInMonth(){return r1(this.year,this.month)}get daysInYear(){return this.isValid?Df(this.year):NaN}get weeksInWeekYear(){return this.isValid?I0(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?I0(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:i,numberingSystem:r,calendar:o}=Jn.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:i,numberingSystem:r,outputCalendar:o}}toUTC(e=0,i={}){return this.setZone(fs.instance(e),i)}toLocal(){return this.setZone(Er.defaultZone)}setZone(e,{keepLocalTime:i=!1,keepCalendarTime:r=!1}={}){if(e=Eu(e,Er.defaultZone),e.equals(this.zone))return this;if(e.isValid){let o=this.ts;if(i||r){const h=e.offset(this.ts),d=this.toObject();[o]=Mb(d,h,e)}return Rh(this,{ts:o,zone:e})}else return Rt.invalid(by(e))}reconfigure({locale:e,numberingSystem:i,outputCalendar:r}={}){const o=this.loc.clone({locale:e,numberingSystem:i,outputCalendar:r});return Rh(this,{loc:o})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const i=n1(e,YD),{minDaysInFirstWeek:r,startOfWeek:o}=OD(i,this.loc),h=!Zt(i.weekYear)||!Zt(i.weekNumber)||!Zt(i.weekday),d=!Zt(i.ordinal),a=!Zt(i.year),v=!Zt(i.month)||!Zt(i.day),T=a||v,E=i.weekYear||i.weekNumber;if((T||d)&&E)throw new _f("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(v&&d)throw new _f("Can't mix ordinal dates with month/day");let k;h?k=DD({...i1(this.c,r,o),...i},r,o):Zt(i.ordinal)?(k={...this.toObject(),...i},Zt(i.day)&&(k.day=Math.min(r1(k.year,k.month),k.day))):k=zD({...aT(this.c),...i});const[L,O]=Mb(k,this.o,this.zone);return Rh(this,{ts:L,o:O})}plus(e){if(!this.isValid)return this;const i=xi.fromDurationLike(e);return Rh(this,ZD(this,i))}minus(e){if(!this.isValid)return this;const i=xi.fromDurationLike(e).negate();return Rh(this,ZD(this,i))}startOf(e,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const r={},o=xi.normalizeUnit(e);switch(o){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(o==="weeks")if(i){const h=this.loc.getStartOfWeek(),{weekday:d}=this;d<h&&(r.weekNumber=this.weekNumber-1),r.weekday=h}else r.weekday=1;if(o==="quarters"){const h=Math.ceil(this.month/3);r.month=(h-1)*3+1}return this.set(r)}endOf(e,i){return this.isValid?this.plus({[e]:1}).startOf(e,i).minus(1):this}toFormat(e,i={}){return this.isValid?Jn.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):cT}toLocaleString(e=t1,i={}){return this.isValid?Jn.create(this.loc.clone(i),e).formatDateTime(this):cT}toLocaleParts(e={}){return this.isValid?Jn.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:i=!1,suppressMilliseconds:r=!1,includeOffset:o=!0,extendedZone:h=!1,precision:d="milliseconds"}={}){if(!this.isValid)return null;d=Ab(d);const a=e==="extended";let v=dT(this,a,d);return kb.indexOf(d)>=3&&(v+="T"),v+=WD(this,a,i,r,o,h,d),v}toISODate({format:e="extended",precision:i="day"}={}){return this.isValid?dT(this,e==="extended",Ab(i)):null}toISOWeekDate(){return Y_(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:i=!1,includeOffset:r=!0,includePrefix:o=!1,extendedZone:h=!1,format:d="extended",precision:a="milliseconds"}={}){return this.isValid?(a=Ab(a),(o&&kb.indexOf(a)>=3?"T":"")+WD(this,d==="extended",i,e,r,h,a)):null}toRFC2822(){return Y_(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Y_(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?dT(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:i=!1,includeOffsetSpace:r=!0}={}){let o="HH:mm:ss.SSS";return(i||e)&&(r&&(o+=" "),i?o+="z":e&&(o+="ZZ")),Y_(this,o,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():cT}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const i={...this.c};return e.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,i="milliseconds",r={}){if(!this.isValid||!e.isValid)return xi.invalid("created by diffing an invalid DateTime");const o={locale:this.locale,numberingSystem:this.numberingSystem,...r},h=Vee(i).map(xi.normalizeUnit),d=e.valueOf()>this.valueOf(),a=d?this:e,v=d?e:this,T=Hte(a,v,h,o);return d?T.negate():T}diffNow(e="milliseconds",i={}){return this.diff(Rt.now(),e,i)}until(e){return this.isValid?Cr.fromDateTimes(this,e):this}hasSame(e,i,r){if(!this.isValid)return!1;const o=e.valueOf(),h=this.setZone(e.zone,{keepLocalTime:!0});return h.startOf(i,r)<=o&&o<=h.endOf(i,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const i=e.base||Rt.fromObject({},{zone:this.zone}),r=e.padding?this<i?-e.padding:e.padding:0;let o=["years","months","days","hours","minutes","seconds"],h=e.unit;return Array.isArray(e.unit)&&(o=e.unit,h=void 0),JD(i,this.plus(r),{...e,numeric:"always",units:o,unit:h})}toRelativeCalendar(e={}){return this.isValid?JD(e.base||Rt.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Rt.isDateTime))throw new Zn("min requires all arguments be DateTimes");return RD(e,i=>i.valueOf(),Math.min)}static max(...e){if(!e.every(Rt.isDateTime))throw new Zn("max requires all arguments be DateTimes");return RD(e,i=>i.valueOf(),Math.max)}static fromFormatExplain(e,i,r={}){const{locale:o=null,numberingSystem:h=null}=r,d=Di.fromOpts({locale:o,numberingSystem:h,defaultToEN:!0});return x6(d,e,i)}static fromStringExplain(e,i,r={}){return Rt.fromFormatExplain(e,i,r)}static buildFormatParser(e,i={}){const{locale:r=null,numberingSystem:o=null}=i,h=Di.fromOpts({locale:r,numberingSystem:o,defaultToEN:!0});return new b6(h,e)}static fromFormatParser(e,i,r={}){if(Zt(e)||Zt(i))throw new Zn("fromFormatParser requires an input string and a format parser");const{locale:o=null,numberingSystem:h=null}=r,d=Di.fromOpts({locale:o,numberingSystem:h,defaultToEN:!0});if(!d.equals(i.locale))throw new Zn(`fromFormatParser called with a locale of ${d}, but the format parser was created for ${i.locale}`);const{result:a,zone:v,specificOffset:T,invalidReason:E}=i.explainFromTokens(e);return E?Rt.invalid(E):Zp(a,v,r,`format ${i.format}`,e,T)}static get DATE_SHORT(){return t1}static get DATE_MED(){return C4}static get DATE_MED_WITH_WEEKDAY(){return gee}static get DATE_FULL(){return E4}static get DATE_HUGE(){return I4}static get TIME_SIMPLE(){return $4}static get TIME_WITH_SECONDS(){return P4}static get TIME_WITH_SHORT_OFFSET(){return M4}static get TIME_WITH_LONG_OFFSET(){return k4}static get TIME_24_SIMPLE(){return A4}static get TIME_24_WITH_SECONDS(){return D4}static get TIME_24_WITH_SHORT_OFFSET(){return z4}static get TIME_24_WITH_LONG_OFFSET(){return O4}static get DATETIME_SHORT(){return R4}static get DATETIME_SHORT_WITH_SECONDS(){return L4}static get DATETIME_MED(){return F4}static get DATETIME_MED_WITH_SECONDS(){return N4}static get DATETIME_MED_WITH_WEEKDAY(){return yee}static get DATETIME_FULL(){return B4}static get DATETIME_FULL_WITH_SECONDS(){return j4}static get DATETIME_HUGE(){return U4}static get DATETIME_HUGE_WITH_SECONDS(){return V4}}function Kg(t){if(Rt.isDateTime(t))return t;if(t&&t.valueOf&&Lu(t.valueOf()))return Rt.fromJSDate(t);if(t&&typeof t=="object")return Rt.fromObject(t);throw new Zn(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const hie={dateStyle:void 0,year:void 0,month:void 0,day:void 0,weekday:void 0},die={timeStyle:void 0,hour12:void 0,hourCycle:void 0,hour:void 0,minute:void 0,second:void 0},C6={timeZone:X$},Ka={year:"numeric",month:"numeric",day:"numeric"},Qg={year:"numeric",month:"long",day:"numeric"},ey={year:"numeric",month:"short",day:"numeric"},ty={year:"numeric",month:"long",weekday:"long",day:"numeric"},xu={hour:"numeric",minute:"numeric"},Bh={...xu,second:"numeric"},E6={hourCycle:"h23"},iy={...xu,...E6},ry={...Bh,...E6},I6={"short-date":Ka,"short-date-short-time":{...Ka,...xu},"short-date-short-time-24":{...Ka,...iy},"short-date-long-time":{...Ka,...Bh},"short-date-long-time-24":{...Ka,...ry},"short-date-le":Ka,"short-date-le-short-time":{...Ka,...xu},"short-date-le-short-time-24":{...Ka,...iy},"short-date-le-long-time":{...Ka,...Bh},"short-date-le-long-time-24":{...Ka,...ry},"long-month-day-year":Qg,"long-month-day-year-short-time":{...Qg,...xu},"long-month-day-year-short-time-24":{...Qg,...iy},"long-month-day-year-long-time":{...Qg,...Bh},"long-month-day-year-long-time-24":{...Qg,...ry},"day-short-month-year":ey,"day-short-month-year-short-time":{...ey,...xu},"day-short-month-year-short-time-24":{...ey,...iy},"day-short-month-year-long-time":{...ey,...Bh},"day-short-month-year-long-time-24":{...ey,...ry},"long-date":ty,"long-date-short-time":{...ty,...xu},"long-date-short-time-24":{...ty,...iy},"long-date-long-time":{...ty,...Bh},"long-date-long-time-24":{...ty,...ry},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":xu,"long-time":Bh},pie=_o()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),$6={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},fie=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),mie=fie.find(({type:t})=>t==="month")?.value.toLowerCase();function P6(){const t=W$();return(t&&$6[t])??w4()}mie!=="mart"&&($6.bs="sr-Latn-CS");let nE=new WeakMap;const Iw=I6["short-date-short-time"];function gie(t){let e=nE.get(t);if(!e){const i=P6(),r=sP(t.timeZone??um),o={...t,timeZone:r};e=new Intl.DateTimeFormat(i,o),nE.set(t,e)}return e}function Ife(t){return I6[t]}function $fe(t){const{dateStyle:e,timeStyle:i,hour12:r,year:o,month:h}=t,d={};return e?d.dateStyle=e:o&&(d.year=o,d.month=h||void 0),i&&!d.year&&(d.timeStyle=i,d.hour12=r==="auto"?void 0:r==="always"),d}function Gu(t,e=Iw){return gie(e).format(t)}function Pfe(t,e=Iw){return Gu(new Date(t),{...e,...C6,...die})}function Mfe(t,e=Iw){return Gu(new Date(`1970-01-01T${t}Z`),{...e,...C6,...hie})}function kfe(t,e=Iw){if(e.timeZone)return Gu(new Date(t),e);const i=Rt.fromISO(t,{setZone:!0}),r=i.offset===0?X$:e.timeZone,o={...e,timeZone:r};return i.toLocaleString(o,{locale:P6()})}function sP(t){switch(t){case um:return dee;case hee:return X$;default:return t}}Y$(()=>{nE=new WeakMap});const yie={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let Db=new WeakMap,M6={};function vie(t){const e=t||M6;if(!Db.has(e)){const i=W$(),r=i&&yie[i]||w4();Db.set(e,new Intl.NumberFormat(r,t))}return Db.get(e)}function Afe(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function Dfe(t){const{minimumFractionDigits:e,maximumFractionDigits:i,useGrouping:r}=t;return{minimumFractionDigits:e,maximumFractionDigits:i,useGrouping:r==="auto"?"auto":r==="always"}}function s1(t,e){return Object.is(t,-0)&&(t=0),vie(e).format(t)}Y$(()=>{Db=new WeakMap,M6={}});const k6=()=>ui.getLogger("esri.intl.substitute");function oP(t,e,i={}){const{format:r={}}=i;return U$(t,o=>_ie(o,e,r))}function _ie(t,e,i){let r,o;const h=t.indexOf(":");if(h===-1?r=t.trim():(r=t.slice(0,h).trim(),o=t.slice(h+1).trim()),!r)return"";const d=yw(r,e);if(d==null)return"";const a=(o?i?.[o]:null)??i?.[r];return a?bie(d,a):o?xie(d,o):aP(d)}function bie(t,e){switch(e.type){case"date":return Gu(t,e.intlOptions);case"number":return s1(t,e.intlOptions);default:return k6().warn("missing format descriptor for key {key}"),aP(t)}}function xie(t,e){switch(e.toLowerCase()){case"dateformat":return Gu(t);case"numberformat":return s1(t);default:return k6().warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?Gu(t):/^numberformat/i.test(e)?s1(t):aP(t)}}function aP(t){switch(typeof t){case"string":return t;case"number":return s1(t);case"boolean":return""+t;default:return t instanceof Date?Gu(t):""}}const A6={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function wie(t){return t in A6}function QD(t){if(wie(t)){const e=A6[t];return e===!0?t:e}return null}const wy=[],Of=new Map;function e5(t){for(const e of Of.keys())D6(t.pattern,e)&&Of.delete(e)}function Sie(t){return wy.includes(t)||(e5(t),wy.unshift(t)),hn(()=>{const e=wy.indexOf(t);e>-1&&(wy.splice(e,1),e5(t))})}async function zfe(t){const e=ud();Of.has(t)||Of.set(t,Cie(t,e));const i=Of.get(t);return i&&await Eie.add(i),i}function Tie(t){const e=W$(t);return e?QD(t)??QD(e):null}async function Cie(t,e){const i=[];for(const r of wy)if(D6(r.pattern,t))try{return await r.fetchMessageBundle(t,e)}catch(o){i.push(o)}throw i.length?new Lt("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i}):new Lt("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function D6(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}Y$(()=>{Of.clear()});const Eie=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=lm())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};function o1(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const Iie=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,$ie={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function t5(t){const e=t?.match(Iie);if(!e)return null;const[,i,r,o]=e;if(!i)return null;let h=null,d=null,a=null;const{devext:v,qaext:T,www:E}=$ie;if(r)if(h=i,o)switch(o.toLowerCase()){case"devext":({customBaseUrl:d,portalHostname:a}=v);break;case"qa":({customBaseUrl:d,portalHostname:a}=T);break;default:return null}else({customBaseUrl:d,portalHostname:a}=E);else switch(i.toLowerCase()){case"devext":({customBaseUrl:d,portalHostname:a}=v);break;case"qaext":({customBaseUrl:d,portalHostname:a}=T);break;case"www":({customBaseUrl:d,portalHostname:a}=E);break;default:return null}return{customBaseUrl:d,isPortal:!1,portalHostname:a,urlKey:h}}function z6(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function O6(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,r=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):i.test(t)?t=t.replace(i,"https://devext.arcgis.com"):r.test(t)&&(t=t.replace(r,"https://qaext.arcgis.com")),t}function Pie(t){const e=atob(t),i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i.buffer}function Mie(t){const e=new Uint8Array(t);let i="";for(let r=0;r<e.length;r++)i+=String.fromCharCode(e[r]);return btoa(i)}const kie=()=>ui.getLogger("esri.core.urlUtils"),km=zi.request,i5="esri/config: esriConfig.request.proxyUrl is not set.",R6=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,L6=/^\s*http:/i,Aie=/^\s*https:/i,Die=/^\s*file:/i,F6=/:\d+$/,zie=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Oie=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),Rie=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let Rf=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(Oie);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(Rie),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const X_={},Lie=new Rf(zi.applicationUrl);let Kn=Lie;const Fie=Nie();let lP=Fie;const cP=()=>Kn,Rfe=()=>lP;function Nie(){const t=Kn.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${Kn.scheme}://${Kn.host}${Kn.port!=null?`:${Kn.port}`:""}`}${e}`}function Zo(t){if(!t)return null;const e={path:null,query:null},i=new Rf(t),r=t.indexOf("?");return i.query===null?e.path=t:(e.path=t.slice(0,r),e.query=uP(i.query)),i.fragment&&(e.hash=i.fragment,i.query===null&&(e.path=e.path.slice(0,e.path.length-(i.fragment.length+1)))),e}function uP(t){const e=t.split("&"),i={};for(const r of e){if(!r)continue;const o=r.indexOf("=");let h,d;o<0?(h=decodeURIComponent(r),d=""):(h=decodeURIComponent(r.slice(0,o)),d=decodeURIComponent(r.slice(o+1)));let a=i[h];typeof a=="string"&&(a=i[h]=[a]),Array.isArray(a)?a.push(d):i[h]=d}return i}function $0(t,e){return t?Object.keys(t).map(i=>{const r=t[i];if(r==null)return"";const o=encodeURIComponent(i)+"=",h=e?.[i];return h?o+encodeURIComponent(h(r)):Array.isArray(r)?r.map(d=>o1(d)?o+encodeURIComponent(JSON.stringify(d)):o+encodeURIComponent(d)).join("&"):o1(r)?o+encodeURIComponent(JSON.stringify(r)):o+encodeURIComponent(r)}).filter(i=>i).join("&"):""}function N6(t=!1){let e,i=km.proxyUrl;if(typeof t=="string"){e=qie(t);const r=$w(t);r&&(i=r.proxyUrl)}else e=!!t;if(!i)throw kie().warn(i5),new Lt("urlUtils:proxy-not-set",i5);return e&&sE()&&(i=mP(i)),Zo(i)}function Lfe(t,e=!1){const i=$w(t);let r,o;if(i){const h=hP(i.proxyUrl);r=h.path,o=h.query?uP(h.query):null}else if(e){const h=N6(t);r=h.path,o=h.query}if(r){const h=Zo(t);t=r+"?"+h.path;const d=$0({...o,...h.query});d&&(t=`${t}?${d}`)}return t}const ny={path:"",query:""};function hP(t){const e=t.indexOf("?");return e!==-1?(ny.path=t.slice(0,e),ny.query=t.slice(e+1)):(ny.path=t,ny.query=null),ny}function B6(t){return t=(t=l1(t=Xie(t=hP(t).path),!0)).toLowerCase()}function Bie(t){const e={proxyUrl:t.proxyUrl,urlPrefix:B6(t.urlPrefix)},i=km.proxyRules,r=e.urlPrefix;let o=i.length;for(let h=0;h<i.length;h++){const d=i[h].urlPrefix;if(r.startsWith(d)){if(r.length===d.length)return-1;o=h;break}d.startsWith(r)&&(o=h+1)}return i.splice(o,0,e),o}function $w(t){const e=km.proxyRules,i=B6(t);for(let r=0;r<e.length;r++)if(i.startsWith(e[r].urlPrefix))return e[r]}function Ffe(t,e){if(!t||!e)return!1;t=a1(t),e=a1(e);const i=t5(t),r=t5(e);return i!=null&&r!=null?i.portalHostname===r.portalHostname:i==null&&r==null&&wd(t,e,!0)}function jie(t,e){return t=a1(t),e=a1(e),l1(t)===l1(e)}function a1(t){const e=(t=Fu(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function r5(t,e=km.interceptors){const i=r=>r instanceof RegExp?r.test(t):typeof r=="string"?t.startsWith(r):r==null;if(e){for(const r of e)if(Array.isArray(r.urls)){if(r.urls.some(i))return r}else if(i(r.urls))return r}return null}function wd(t,e,i=!1){if(!t||!e)return!1;const r=aE(t),o=aE(e);return!(!i&&r.scheme!==o.scheme)&&r.host!=null&&o.host!=null&&r.host.toLowerCase()===o.host.toLowerCase()&&r.port===o.port}function dP(t){if(typeof t=="string"){if(!wa(t))return!0;t=aE(t)}if(wd(t,Kn))return!0;const e=km.trustedServers||[];for(let i=0;i<e.length;i++){const r=Uie(e[i]);for(let o=0;o<r.length;o++)if(wd(t,r[o]))return!0}return!1}function Uie(t){return X_[t]||(fP(t)||Zu(t)?X_[t]=[new Rf(uv(t))]:X_[t]=[new Rf(`http://${t}`),new Rf(`https://${t}`)]),X_[t]}function uv(t,e=lP,i){return Zu(t)?i?.preserveProtocolRelative?t:Kn.scheme==="http"&&Kn.authority===mo(t).slice(2)?`http:${t}`:`https:${t}`:fP(t)?t:Pw(t.startsWith("/")?Yie(e):e,t)}function j6(t,e=lP,i){if(t==null||!wa(t))return t;const r=Fu(t),o=r.toLowerCase(),h=Fu(e).toLowerCase().replace(/\/+$/,""),d=i?Fu(i).toLowerCase().replace(/\/+$/,""):null;if(d&&!h.startsWith(d))return t;const a=(k,L,O)=>(O=k.indexOf(L,O))===-1?k.length:O;let v=a(o,"/",o.indexOf("//")+2),T=-1;for(;o.slice(0,v+1)===h.slice(0,v)+"/"&&(T=v+1,v!==o.length);)v=a(o,"/",v+1);if(T===-1||d&&T<d.length)return t;t=r.slice(T);const E=h.slice(T-1).replaceAll(/[^/]+/g,"").length;if(E>0)for(let k=0;k<E;k++)t=`../${t}`;else t=`./${t}`;return t}function Fu(t){return t=Qie(t=Kie(t=Jie(t=uv(t=t.trim()))))}function Pw(...t){const e=t.filter(xb);if(!e?.length)return;const i=[];if(wa(e[0])){const o=e[0],h=o.indexOf("//");h!==-1&&(i.push(o.slice(0,h+1)),Zie(e[0])&&(i[0]+="/"),e[0]=o.slice(h+2))}else e[0].startsWith("/")&&i.push("");const r=e.reduce((o,h)=>h?o.concat(h.split("/")):o,[]);for(let o=0;o<r.length;o++){const h=r[o];h===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!h&&o===r.length-1||h&&(h!=="."||i.length===0))&&i.push(h)}return i.join("/")}function mo(t,e=!1){if(t==null||pP(t)||Am(t))return null;let i=t.indexOf("://");if(i===-1&&Zu(t))i=2;else{if(i===-1)return null;i+=3}const r=t.indexOf("/",i);return r!==-1&&(t=t.slice(0,r)),e&&(t=l1(t,!0)),t}function wa(t){return Zu(t)||fP(t)}function pP(t){return t!=null&&t.startsWith("blob:")}function Am(t){return t!=null&&t.startsWith("data:")}function Vie(t){const e=P0(t);return e?.isBase64?Pie(e.data):null}function Nfe(t){return Mie(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const Gie=/^data:(.*?)(;base64)?,(.*)$/;function P0(t){const e=t.match(Gie);if(!e)return null;const[,i,r,o]=e;return{mediaType:i,isBase64:!!r,data:o}}function U6(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function Bfe(t){return(await fetch(t)).blob()}function jfe(t){const e=Vie(t);if(!e)return null;const i=P0(t);return new Blob([e],{type:i.mediaType})}function Zu(t){return t!=null&&t.startsWith("/")&&t[1]==="/"}function fP(t){return t!=null&&R6.test(t)}function qie(t){return t!=null&&Aie.test(t)||Kn.scheme==="https"&&Zu(t)}function Hie(t){return t!=null&&L6.test(t)||Kn.scheme==="http"&&Zu(t)}function Zie(t){return t!=null&&Die.test(t)}function mP(t){return Zu(t)?`https:${t}`:t.replace(L6,"https:")}function Wie(){return Kn.scheme==="http"}function sE(){return Kn.scheme==="https"}function l1(t,e=!1){return Zu(t)?t.slice(2):(t=t.replace(R6,""),e&&t.length>1&&t.startsWith("/")&&t[1]==="/"&&(t=t.slice(2)),t)}function Yie(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return i===-1?t:t.slice(0,i)}function Ufe(t){let e=0;if(wa(t)){const r=t.indexOf("//");r!==-1&&(e=r+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function Vfe(t,e){if(!t)return"";const i=Zo(t).path.replace(/\/+$/,""),r=i.slice(i.lastIndexOf("/")+1);if(!e?.length)return r;const o=new RegExp(`\\.(${e.join("|")})$`,"i");return r.replace(o,"")}function Xie(t){return t.endsWith("/")?t:`${t}/`}function V6(t){return t.replace(/\/+$/,"")}function Jie(t){if(/^https?:\/\//i.test(t)){const e=hP(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function Kie(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function Qie(t){const e=km.httpsDomains;if(!Hie(t))return t;const i=t.indexOf("/",7);let r;if(r=i===-1?t:t.slice(0,i),r=r.toLowerCase().slice(7),F6.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","")}return Wie()&&r===Kn.authority&&!zie.test(t)||(sE()&&r===Kn.authority||e&&e.some(o=>r===o||r.endsWith(`.${o}`))||sE()&&!$w(t))&&(t=mP(t)),t}function oE(t,e,i){if(!(e&&i&&t&&wa(t)))return t;const r=t.indexOf("//"),o=t.indexOf("/",r+2),h=t.indexOf(":",r+2),d=Math.min(o<0?t.length:o,h<0?t.length:h);return t.slice(r+2,d).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,r+2)}${i}${t.slice(d)}`}function ere(t,e){const i=new URL(t);return i.host=e,i.port&&!F6.test(e)&&(i.port=""),i.toString()}function Gfe(t){return new URL(t).host}function aE(t){return typeof t=="string"?new Rf(uv(t)):(t.scheme||(t.scheme=Kn.scheme),t)}function G6(t,e){const i=Zo(t),r=Object.keys(i.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),i.path}function tre(t,e,i){const r=Zo(t),o=r.query||{};return o[e]=String(i),`${r.path}?${$0(o)}`}function pT(t,e){if(!e)return t;const i=Zo(t),r=i.query||{};for(const[h,d]of Object.entries(e))d!=null&&(r[h]=d);const o=$0(r);return o?`${i.path}?${o}`:i.path}function qfe(t){if(t==null)return null;const e=t.match(q6);return e?e[2]:null}function n5(t){if(t==null)return null;const e=t.match(q6);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function Hfe(t){return typeof t=="string"?P0(t)??{data:t}:new Promise((e,i)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(P0(r.result)),r.onerror=o=>i(o)})}const q6=/([^.]*)\.([^/]*)$/;Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const ire="4.34";let ji,rre=ire;function Zfe(t){ji=t}function Wfe(t){const e=ji?.findCredential(t);return e?.token?tre(t,"token",e.token):t}rre="4.34.8",Ue("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),Ue("host-webworker");function Yfe(t,e){for(const i of t.values())if(e(i))return!0;return!1}function H6(t,e,i){const r=t.get(e);if(r!==void 0)return r;const o=i();return t.set(e,o),o}function Xfe(t){const e=new Map;return i=>(e.has(i)||e.set(i,t(i)),e.get(i))}function hv(t,e){const i=e?.url?.path;if(t&&i&&(t=uv(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const r=j6(t,e.portalItem.itemUrl);r!=null&&r.startsWith(nre)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(r).path)}return(t=lE(t,e?.portal))&&kw.test(t)?W6(t):t}function Mw(t,e,i=0){if((t=t&&kw.test(t)?Y6(t):t)==null)return t;!wa(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let r=uv(t);if(e){const o=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(o){const h=lE(o,e.portal),d=lE(r,e.portal);r=j6(d,h,h),r!=null&&r!==d&&r!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=Z6(r,e?.portal),wa(r)&&(r=Fu(r)),e?.resources&&e?.portalItem&&!wa(r)&&!Am(r)&&i===0&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(r),compress:!1}),r}function gP(t,e,i){return hv(t,i)}function dm(t,e,i,r){const o=Mw(t,r);o!==void 0&&(e[i]=o)}const kw=/\/items\/([^/]+)\/resources\/(.*)/,nre="./resources/";function sre(t){return(t?.match(kw)??null)?.[1]??null}function ore(t){const e=t?.match(kw)??null;if(e==null)return null;const i=e[2],r=i.lastIndexOf("/");if(r===-1){const{path:d,extension:a}=n5(i);return{prefix:null,filename:d,extension:a}}const{path:o,extension:h}=n5(i.slice(r+1));return{prefix:i.slice(0,r),filename:o,extension:h}}function Z6(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?oE(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function lE(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,r=cP();return wd(r,`${r.scheme}://${i}`)?oE(t,e.portalHostname,i):oE(t,i,e.portalHostname)}function W6(t){if(!t)return t||null;let e=t;return e&&ji&&!ji.findCredential(e)&&(e=O6(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function Y6(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&ji&&!ji.findCredential(e)&&(e=O6(e)),e}const Jfe=Object.freeze(Object.defineProperty({__proto__:null,ensureMainOnlineDomain:Z6,fromCDNUrl:Y6,fromJSON:hv,itemIdFromResourceUrl:sre,prefixAndFilenameFromResourceUrl:ore,read:gP,toCDNUrl:W6,toJSON:Mw,write:dm},Symbol.toStringTag,{value:"Module"})),X6={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},J6=Object.values(X6),K6=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${J6.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),are=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${J6.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),lre=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function Kfe(t){return K6.test(t)}function Aw(t){if(t==null)return null;const e=Zo(t),i=e?.path.match(K6)||e?.path.match(are);if(!i)return null;const[,r,o,h,d]=i,a=o.indexOf("/");return{title:Q6(a!==-1?o.slice(a+1):o),serverType:X6[h.toLowerCase()],sublayer:d!=null&&d!==""?parseInt(d,10):null,url:{path:r}}}function cre(t){const e=Zo(t).path.match(lre);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function Q6(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function Qfe(t,e){const i=[];if(t){const r=Aw(t);r!=null&&r.title&&i.push(r.title)}if(e){const r=Q6(e);i.push(r)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function s5(t){let e=mo(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function eme(t,e){return t&&V6(G6(t,e))}function tme(t){let{url:e}=t;if(!e)return{url:e};e=G6(e,t.logger);const i=Zo(e),r=Aw(i.path);let o;if(r!=null)r.sublayer!=null&&t.layer.layerId==null&&(o=r.sublayer),e=r.url.path;else if(t.nonStandardUrlAllowed){const h=cre(i.path);h!=null&&(e=h.serviceUrl,o=h.sublayerId)}return{url:V6(e),layerId:o}}function ime(t,e,i,r,o){dm(e,r,"url",o),r.url&&t.layerId!=null&&(r.url=Pw(r.url,i,t.layerId.toString()))}function rme(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),r=e.includes("/mapserver/wmsserver"),o=e.includes("/imageserver/wmsserver"),h=e.includes("/wmsserver");return i&&(r||o||h)}const ure=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function yP(t){if(!vP(t))return null;const e=r=>r instanceof RegExp?r.test(t):typeof r=="string"&&t.startsWith(r),i=zi.apiKeys;if(Array.isArray(i.scopes)){for(const r of i.scopes)if(Array.isArray(r.urls)){if(r.urls.some(e))return r.token}else if(e(r.urls))return r.token}return i.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?i.basemapStyles:zi.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?zi.apiKey:null}function o5(){return zi.apiKey!=null||zi.apiKeys.basemapStyles!=null}function eF(t,e){return e?vP(t):yP(t)!=null}function vP(t){const e=mo(t,!0);return!!e&&!ure.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function hre(t,e,i=!1,r){return new Promise((o,h)=>{if(Vu(r))return void h(a5());let d=()=>{T(),h(new Error(`Unable to load ${e}`))},a=async()=>{const E=t;try{await E.decode()}catch{}T(),o(E)},v=()=>{if(!t)return;const E=t;T(),E.src="",h(a5())};const T=()=>{t&&(t.removeEventListener("error",d),t.removeEventListener("load",a),d=null,a=null,t=null,r?.removeEventListener("abort",v),v=null,i&&URL.revokeObjectURL(e))};r?.addEventListener("abort",v),t.addEventListener("error",d),t.addEventListener("load",a)})}function a5(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const tF="Timeout exceeded";function dre(){return new Error(tF)}function nme(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===tF}function pre(t){zi.request.crossOriginNoCorsDomains||(zi.request.crossOriginNoCorsDomains={});const e=zi.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[mo(i)??""]=0:(e[mo("http://"+i)??""]=0,e[mo("https://"+i)??""]=0)}function fre(t){const e=zi.request.crossOriginNoCorsDomains;if(e){let i=mo(t);if(i)return i=i.toLowerCase(),!wd(i,cP())&&e[i]<Date.now()-36e5}return!1}async function mre(t){const e=Zo(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const i=zi.request.crossOriginNoCorsDomains,r=mo(t);i&&r&&(i[r.toLowerCase()]=Date.now())}const cE=new Map;function gre(t,e){const i=e?.preferredHost;if(!i||wd(t,`https://${i}`,!0))return;const r=Aw(t);if(!r||r.serverType!=="FeatureServer"||z6(t))return;const o=r.url.path.toLowerCase();cE.has(o)||cE.set(o,i)}function l5(t){const e=Aw(t)?.url.path.toLowerCase();if(!e)return t;const i=cE.get(e);return i?ere(t,i):t}async function wn(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=uP(e.query.toString().replaceAll("+"," ")));const i=Am(t),r=pP(t);r||i||(t=Fu(t));const o={url:t,requestOptions:{...e}},h=O=>({data:O,getAllHeaders:pm,getHeader:pm,httpStatus:200,requestOptions:o.requestOptions,url:o.url}),d=r5(t,Bo.internalInterceptors);if(d){const O=await u5(d,o);if(O!=null)return h(O)}let a=r5(t);if(a){const O=await u5(a,o);if(O!=null)return h(O);a.after||a.error||(a=null)}if(t=o.url,(e=o.requestOptions).responseType==="image"&&(Ue("host-webworker")||Ue("host-node")))throw Sa("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),o);if(e.method==="head"){if(e.body)throw Sa("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),o);if(i||r)throw Sa("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),o)}if(await xre(),c1)return c1.execute(t,e);const v=new AbortController,T=E0(e,()=>v.abort()),E={controller:v,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:o,redoRequest:!1,useIdentity:Bo.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},k=e.useRequestQueue?Ere(E):hE(E),L=await k.finally(()=>T?.remove());return a?.after?.(L),L}let c1,iF=!1;const Bo=zi.request,rF="FormData"in globalThis,yre=new Set([499,498,403,401]),vre=new Set(["COM_0056","COM_0057","SB_0008"]),_re=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],pm=()=>null,u1=Symbol();function bre(t){const e=mo(t);e&&!wn._corsServers.includes(e)&&wn._corsServers.push(e)}function c5(t){const e=mo(t);return!e||e.endsWith(".arcgis.com")||wn._corsServers.includes(e)||dP(e)}function Sa(t,e,i,r){let o;const h={url:i.url,requestOptions:i.requestOptions,getAllHeaders:pm,getHeader:pm,ssl:!1};if(e instanceof Lt)return e.details?(e.details=ht(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=h,e;if(e){const d=r&&(()=>Array.from(r.headers)),a=r&&(E=>r.headers.get(E)),v=r?.status,T=e.message;T&&(o=T),d&&a&&(h.getAllHeaders=d,h.getHeader=a),h.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||v||0,h.subCode=e.subcode,h.messageCode=e.messageCode,typeof e.details=="string"?(h.messages=[e.details],o??=e.details):(h.messages=e.details,o??=h.messages?.[0]),h.raw=u1 in e?e[u1]:e}return o??="Error",zd(e)?zs():new Lt(t,o,h)}async function xre(){Ue("host-webworker")&&(!c1&&globalThis.invokeStaticMessage?c1=await Qn(()=>import("./request-mLwG6ZRo.js"),__vite__mapDeps([0,1,2,3])):iF=!0)}async function uE(){ji||await Qn(()=>import("./IdentityManager-DOYXejDW.js"),__vite__mapDeps([4,1,2,5,6,3]))}async function wre(t){const e=t.params.url,i=t.params.requestOptions,r=t.controller.signal,o=i.body;let h=null,d=null;if(rF&&"HTMLFormElement"in globalThis&&(o instanceof FormData?h=o:o instanceof HTMLFormElement&&(h=new FormData(o))),typeof o=="string"&&(d=o),t.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},keepalive:i.keepAlive??!1,method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:Bo.priority,redirect:"follow",signal:r},(h||d)&&(t.fetchOptions.body=h||d),(iF||i.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||i.query?.token||h?.get("token")),!t.hasToken){const a=yP(e);a&&(i.query??={},i.query.token=a,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!nF(e)&&!Vu(r)){let a;i.authMode==="immediate"?(await uE(),a=await ji.getCredential(e,{signal:r})):i.authMode==="no-prompt"?(await uE(),a=await ji.getCredential(e,{prompt:!1,signal:r}).catch(()=>{})):ji&&(a=ji.findCredential(e)),a&&(t.credential=a,t.credentialToken=a.token,t.useSSL=!!a.ssl)}}function nF(t){return _re.some(e=>e.test(t))}async function Sre(t){let e=t.params.url,i=l5(e);const r=t.params.requestOptions,o=t.fetchOptions??{},h=pP(e)||Am(e),d=r.responseType||"json",a=h?0:r.timeout!=null?r.timeout:Bo.timeout;let v=!1;if(!h){t.useSSL&&(e=mP(e));let O={...r.query};t.credentialToken&&(O.token=t.credentialToken);let H=$0(O);Ue("esri-url-encodes-apostrophe")&&(H=H.replaceAll("'","%27"));const ie=i.length+1+H.length;let pe;v=r.method==="delete"||r.method==="post"||r.method==="put"||!!r.body||ie>Bo.maxUrlLength;const be=r.useProxy||!!$w(e);if(be){const Ce=N6(e);pe=Ce.path,!v&&pe.length+1+ie>Bo.maxUrlLength&&(v=!0),Ce.query&&(O={...Ce.query,...O})}if(o.method==="HEAD"&&(v||be)){if(v)throw ie>Bo.maxUrlLength?Sa("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):Sa("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(be)throw Sa("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}v?(o.method=r.method==="delete"?"DELETE":r.method==="put"?"PUT":"POST",r.body?e=pT(e,O):(o.body=$0(O),o.headers||(o.headers={}),o.headers["Content-Type"]="application/x-www-form-urlencoded")):e=pT(e,O),be&&(t.useProxy=!0,e=`${pe}?${e}`),O.token&&rF&&o.body instanceof FormData&&!z6(e)&&o.body.set("token",O.token),r.hasOwnProperty("withCredentials")?t.withCredentials=r.withCredentials:wd(e,cP())||(dP(e)||ji&&ji.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(o.credentials="include",fre(e)&&await mre(v?pT(e,O):e)),i=l5(e)}let T,E,k=0,L=!1;a>0&&(k=setTimeout(()=>{L=!0,t.controller.abort()},a));try{if(r.responseType==="native-request-init")E=o,E.url=i,r.signal?E.signal=r.signal:delete E.signal;else if(r.responseType!=="image"||o.cache!=="default"||o.keepalive||o.method!=="GET"||v||Tre(r.headers)||!h&&!t.useProxy&&Bo.proxyUrl&&!c5(e)){if(wn._beforeFetch&&await wn._beforeFetch(e,o),T=await fetch(i,o),wn._afterFetch&&await wn._afterFetch(T),t.useProxy||bre(e),r.responseType==="native")E=T;else if(o.method!=="HEAD")if(T.ok){switch(d){case"array-buffer":E=await T.arrayBuffer();break;case"blob":case"image":E=await T.blob();break;default:E=await T.text()}if(k&&(clearTimeout(k),k=0),d==="json"||d==="xml"||d==="document")if(E)switch(d){case"json":E=JSON.parse(E);break;case"xml":E=h5(E,"application/xml");break;case"document":E=h5(E,"text/html")}else E=null;if(E){if(d==="array-buffer"||d==="blob"){const O=T.headers.get("Content-Type");if(O&&/application\/json|text\/plain/i.test(O)&&E[d==="blob"?"size":"byteLength"]<=750)try{const H=await new Response(E).json();H.error&&(E=H)}catch{}}d==="image"&&E instanceof Blob&&(E=await d5(URL.createObjectURL(E),t,!0))}}else{E=await T.text();try{E=JSON.parse(E)}catch{}}}else E=await d5(i,t)}catch(O){if(O.name==="AbortError")throw L?dre():zs("Request canceled");if(!(!T&&O instanceof TypeError&&Bo.proxyUrl)||r.body||r.method==="delete"||r.method==="head"||r.method==="post"||r.method==="put"||t.useProxy||c5(e))throw O;t.redoRequest=!0,Bie({proxyUrl:Bo.proxyUrl,urlPrefix:mo(e)??""})}finally{k&&clearTimeout(k)}return[T,E]}async function u5(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,r;try{r=await t.before(e)}catch(o){i=Sa("request:interceptor",o,e)}if((r instanceof Error||r instanceof Lt)&&(i=Sa("request:interceptor",r,e)),i)throw t.error&&t.error(i),i;return r}}function Tre(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function h5(t,e){let i;try{i=new DOMParser().parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}wn._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],wn._beforeFetch=void 0,wn._afterFetch=void 0;const Cre=new Map;async function Ere(t){const e=$re(t.params.url);if(!e)return hE(t);const{QueueProcessor:i}=await Qn(()=>import("./QueueProcessor-DSvrC_YI.js"),__vite__mapDeps([7,8,9,10,1,2,3]));return H6(Cre,e.origin,()=>{const o=e.isHosted?Ue("request-queue-concurrency-hosted"):Ue("request-queue-concurrency-non-hosted");return new i({concurrency:o,process:h=>{if(Vu(h.params.requestOptions))throw Sa("",zs("Request canceled"),h.params);return hE(h)}})}).push(t)}async function hE(t){let e,i;await wre(t);try{do[e,i]=await Sre(t);while(!await Ire(t,e,i))}catch(h){const d=Sa("request:server",h,t.params,e);throw d.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(d),d}const r=t.params.url;if(i)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!t.hasToken&&!t.credentialToken&&i.user?.username&&!dP(r)){const h=mo(r,!0);h&&Bo.trustedServers.push(h)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&pre(i.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&gre(r,i);const o=t.credential;if(o&&ji){let d=ji.findServerInfo(o.server)?.owningSystemUrl;if(d){d=d.replace(/\/?$/,"/sharing");const a=ji.findCredential(d,o.userId);a&&ji._getIdenticalSvcIdx(d,a)===-1&&a.resources.unshift(d)}}return{data:i,getAllHeaders:e?()=>Array.from(e.headers):pm,getHeader:e?h=>e.headers.get(h):pm,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function Ire(t,e,i){if(t.redoRequest)return t.redoRequest=!1,!1;const r=t.params.requestOptions;if(!e||r.responseType==="native"||r.responseType==="native-request-init")return!0;let o,h;if(i&&(i.error&&typeof i.error=="object"?o=i.error:i.status==="error"&&Array.isArray(i.messages)&&(o={...i},o[u1]=i,o.details=i.messages)),!o&&!e.ok)throw o=new Error(`Unable to load ${e.url} status: ${e.status}`),o[u1]=i,o;let d,a=null;o&&(h=Number(o.code),a=o.hasOwnProperty("subcode")?Number(o.subcode):null,d=o.messageCode,d=d?.toUpperCase());const v=r.authMode;if(h===403&&(a===4||o.message?.toLowerCase().includes("ssl")&&!o.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(v!=="no-prompt"||h===498)&&h!==void 0&&yre.has(h)&&!nF(t.params.url)&&(h!==403||(!d||!vre.has(d))&&(a==null||a===2&&t.credentialToken))){await uE();try{const T=await ji.getCredential(t.params.url,{error:Sa("request:server",o,t.params),credential:t.credential,prompt:v!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=T,t.credentialToken=T.token,t.useSSL=t.useSSL||T.ssl,!1}catch(T){if(v==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;o=T}}if(o)throw o;return!0}function d5(t,e,i=!1){const r=e.controller.signal,o=new Image;return e.withCredentials?o.crossOrigin="use-credentials":o.crossOrigin="anonymous",o.alt="",o.fetchPriority=Bo.priority,o.src=t,hre(o,t,i,r)}function $re(t){let e,i;return typeof t=="string"?(e=mo(t,!0),i=s5(t)):(e=t.origin,i=s5(t.toString())),e==null?null:{origin:e,isHosted:i}}async function Pre(t,e,i,r){const o=e.exec(i);if(!o)throw new Lt("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const h=o[1]?`${o[1]}/`:"",d=o[2],a=Tie(r),v=`${h}${d}.json`,T=a?`${h}${d}_${a}.json`:v;let E;try{E=await p5(t(T))}catch(k){if(T===v)throw new Lt("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:k});try{E=await p5(t(v))}catch(L){throw new Lt("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:L})}}return E}async function p5(t){if(f5.fetchBundleAsset!=null)return f5.fetchBundleAsset(t);const e=await wn(t,{responseType:"text"});return JSON.parse(e.data)}let Mre=class{constructor({base:e="",pattern:i,location:r=new URL(window.location.href)}){let o;o=typeof r=="string"?h=>new URL(h,new URL(r,window.location.href)).href:r instanceof URL?h=>new URL(h,r).href:r,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=o,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,i){return Pre(this.getAssetUrl,this.matcher,e,i)}};function kre(t){return new Mre(t)}const f5={};function _P(t){if(!zi.assetsPath)throw ui.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Lt("assets:path-not-set","config.assetsPath is not set");return Pw(zi.assetsPath,t)}Sie(kre({pattern:"esri/",location:_P}));/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const m5="arcgis-search-result-renderer",g5={base:m5,moreResults:`${m5}__more-results`},Are=Gi`.esri-widget__heading{color:var(--calcite-color-text-2);margin:0 0 .5rem;font-weight:var(--calcite-font-weight-semibold)}h1.esri-widget__heading{font-size:var(--calcite-font-size-xl)}h2.esri-widget__heading{font-size:var(--calcite-font-size-md)}h3.esri-widget__heading,h4.esri-widget__heading,h5.esri-widget__heading,h6.esri-widget__heading{font-size:var(--calcite-font-size)}.esri-widget{--esri-widget-padding-x: 15px;--esri-widget-padding-y: var(--calcite-spacing-md);--esri-widget-padding: var(--esri-widget-padding-y) var(--esri-widget-padding-x);box-sizing:border-box;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget *,.esri-widget :before,.esri-widget :after{box-sizing:inherit}.esri-widget.esri-widget--disabled>*{opacity:.4;pointer-events:none}.esri-widget.esri-widget--compact{--esri-widget-padding-y: 0;--esri-widget-padding-x: 0}.esri-widget__anchor{color:var(--calcite-color-text-2)}.esri-widget__anchor:hover{color:var(--calcite-color-text-3)}.esri-widget__anchor:hover,.esri-widget__anchor:focus{text-decoration:underline}.esri-widget__anchor--disabled{opacity:.4;pointer-events:none}.esri-widget__header{background-color:var(--calcite-color-foreground-1);flex:1 0 100%;justify-content:space-between;align-items:center;width:100%;min-height:48px;padding:12px 0 12px 15px;display:flex}.esri-widget__header .esri-widget__heading{width:calc(100% - 48px);text-align:initial;color:var(--calcite-color-text-1);align-items:center;margin:0;padding:0;display:flex}.esri-widget__header-button{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);border:none;flex:0 0 48px;justify-content:center;align-self:stretch;align-items:center;width:48px;padding:0;display:flex}.esri-widget__footer{background-color:var(--calcite-color-foreground-1);justify-content:center;align-items:center;width:100%;min-height:48px;display:flex}.esri-widget__footer-pagination{color:var(--calcite-color-text-2);justify-content:space-between;align-items:center;display:flex}.esri-widget__footer-pagination-previous-button,.esri-widget__footer-pagination-next-button{cursor:pointer;background-color:var(--calcite-color-foreground-1);border:0;margin:0 7px;padding:12px 15px;transition:background-color .125s ease-in-out}.esri-widget__footer-pagination-previous-button:hover,.esri-widget__footer-pagination-previous-button:focus,.esri-widget__footer-pagination-next-button:hover,.esri-widget__footer-pagination-next-button:focus{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1)}.esri-menu{visibility:hidden;z-index:1;background-clip:padding;background-color:var(--calcite-color-foreground-1);background-clip:padding-box;width:100%;max-height:0;margin:2px 0 0;padding:0;font-size:var(--calcite-font-size);line-height:var(--calcite-spacing-xl);position:absolute;top:100%;left:0;overflow:hidden;box-shadow:0 1px 2px #0000004d}.esri-menu .esri-menu__header{color:var(--calcite-color-text-inverse);background-color:var(--calcite-color-inverse);padding:6px 12px}.esri-menu__list{margin:0;padding:0;list-style:none}.esri-menu__list-item{cursor:pointer;border-top:1px solid #adadad4d;border-left:3px solid #0000;padding:.8em 1em}.esri-menu__list-item [class^=esri-icon-],.esri-menu__list-item [class*=" esri-icon-"]{padding-right:2.8px}.esri-menu__list-item:first-child{border-top:none}.esri-menu__list-item--focus,.esri-menu__list-item:hover,.esri-menu__list-item:focus{background-color:var(--calcite-color-foreground-1)}.esri-menu__list-item:active{background-color:var(--calcite-color-foreground-current)}.esri-menu__list-item--active,.esri-menu__list-item--active:hover,.esri-menu__list-item--active:focus{background-color:var(--calcite-color-foreground-1);border-left-color:var(--calcite-color-brand)}.esri-widget__table{border-collapse:collapse;color:var(--calcite-color-text-1);border:none;width:100%;line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget__table tr:nth-child(odd){background-color:var(--calcite-color-transparent)}.esri-widget__table tr:nth-child(2n){background-color:var(--calcite-color-transparent-press)}.esri-widget__table tr a{color:var(--calcite-color-text-2)}.esri-widget__table tr a:hover,.esri-widget__table tr a:focus{color:var(--calcite-color-text-1)}.esri-widget__table tr td,.esri-widget__table tr th{vertical-align:top;word-break:break-word;padding:.5em .7em;font-size:var(--calcite-font-size-sm);font-weight:var(--calcite-font-weight-regular)}.esri-widget__table tr th{text-align:left;border-right:3px solid #0000000d;width:50%}.esri-widget__table tr td{width:50%}.esri-input{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1);border:1px solid #959595;font-size:var(--calcite-font-size)}.esri-input::-ms-clear{display:none}.esri-input::placeholder{opacity:1;color:var(--calcite-color-text-2)}.esri-input:placeholder-shown{text-overflow:ellipsis}.esri-input[type=text],.esri-input[type=password],.esri-input[type=number]{height:32px;padding:0 .5em}calcite-combobox.esri-input{border:none}.esri-widget__content--empty{text-align:center;color:var(--calcite-color-border-input);flex-flow:column wrap;align-items:center;padding:18px 22px;display:flex}.esri-widget__content--empty h1.esri-widget__heading,.esri-widget__content--empty h2.esri-widget__heading,.esri-widget__content--empty h3.esri-widget__heading,.esri-widget__content--empty h4.esri-widget__heading,.esri-widget__content--empty h5.esri-widget__heading{font-weight:var(--calcite-font-weight-regular)}.esri-widget__content-illustration--empty{width:128px;padding:1rem 0}.esri-widget__content-icon--empty{width:32px;padding:.5rem 0}.esri-select{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background:var(--calcite-color-foreground-1) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='-8 -8 32 32' width='32' height='32'%3E%3Cpath d='M8 11.207l-4-4V5.793l4 4 4-4v1.414z' fill='%23adadad' fillrule='nonzero'/%3E%3C/svg%3E") 100% no-repeat;border:1px solid #959595;border-radius:0;width:100%;height:32px;margin:0;padding:0 .5em;font-family:inherit;font-size:.85em;display:block}.esri-select[disabled]{cursor:auto}.esri-select::-ms-expand{display:none}.esri-disabled a,.esri-disabled [role=menu],.esri-disabled [role=checkbox],.esri-disabled [class^=esri-icon-],.esri-disabled [class*=" esri-icon-"]{color:var(--calcite-color-text-3)}.keynav-mode .esri-widget:focus,.keynav-mode .esri-widget :focus{z-index:1;outline-offset:2px;outline:2px solid #adadad}.esri-widget__loader-animation{border:.15em solid #adadad4d;border-top-color:var(--calcite-color-border-input);border-radius:100%;width:1em;height:1em;font-size:var(--calcite-font-size-md);animation:1.25s linear infinite esri-rotate;display:block;transform:translateZ(0)}:dir(rtl) .esri-widget__table th{text-align:right;border-left:3px solid #0000000d;border-right:none}:dir(rtl) .esri-select{background-position:0}:dir(rtl) .esri-menu__list-item{border-left:none;border-right:3px solid #0000}:dir(rtl) .esri-menu__list-item [class^=esri-icon-],:dir(rtl) .esri-menu__list-item [class*=" esri-icon-"]{padding-left:2px;padding-right:0}:dir(rtl) .esri-menu__list-item--active{border-right-color:var(--calcite-color-brand)}.esri-icon-font-fallback-text{clip:rect(0 0 0 0);width:1px;height:1px;position:absolute;overflow:hidden}.esri-rotating{animation:1.25s linear infinite esri-rotate;transform:translateZ(0)}.esri-clearfix:before,.esri-clearfix:after{content:" ";display:table}.esri-clearfix:after{clear:both}.esri-interactive{cursor:pointer}.esri-hidden{display:none!important}.esri-invisible{visibility:hidden!important}.esri-offscreen{position:absolute;top:-999em;left:-999em}.esri-match-height{flex-direction:column;flex:auto;display:flex;overflow:hidden}.arcgis-search-result-renderer calcite-block,.arcgis-search-result-renderer calcite-block[expanded]{margin-block:0;margin-block-start:var(--calcite-spacing-md);border:0}`;var fd;let Dre=(fd=class extends Vi{constructor(){super(...arguments),this._resultCount=0,this._showMoreResultsOpen=!1,this.autoDestroyDisabled=!1,this.arcgisReady=vt()}async destroy(){await this.manager.destroy()}loaded(){this.manager.onLifecycle(()=>[bl(()=>[this.viewModel?.results,this.viewModel?.resultCount],()=>{this._results=this.viewModel?.results,this._resultCount=this.viewModel?.resultCount??0,this._showMoreResultsOpen=!1},{initial:!0}),bl(()=>this.viewModel?.selectedResult,e=>this._selectedResult=e,{initial:!0})])}_selectResult(e){this._showMoreResultsOpen=!1,this.viewModel?.select(e)}_getSourceName(e,i){return i===-1?this.messages?.all??"":e.name}_toggleShowMoreResults(e){this._showMoreResultsOpen=e;const i=this.viewModel?.view?.popup;i&&"reposition"in i&&i.reposition()}render(){return Fe`<div class=${Le(eR(g5.base,JL.widget))}>${this._selectedResult?.name??""}${this._renderMoreResults()}</div>`}_renderMoreResults(){const{_resultCount:e,_results:i}=this;return!e||e<2||!i?null:Fe`<calcite-block class=${Le(g5.moreResults)} collapsible .expanded=${this._showMoreResultsOpen} .heading=${oP(this.messages?.showMoreResults??"",{count:e-1})} @calciteBlockClose=${()=>this._toggleShowMoreResults(!1)} @calciteBlockOpen=${()=>this._toggleShowMoreResults(!0)}>${i.map(r=>this._renderMoreResultsList(r,i?.length>1))}</calcite-block>`}_renderMoreResultsList(e,i){const{results:r}=e;if(!(r?.length??0)||!r)return null;const o=this._getSourceName(e.source,e.sourceIndex),h=r.filter(d=>d!==this._selectedResult).map(d=>this._renderListItem(d));return Fe`<calcite-list .label=${o}>${i?ai(`group-${e.sourceIndex}`,Fe`<calcite-list-item-group .heading=${o}>${h}</calcite-list-item-group>`):h}</calcite-list>`}_renderListItem(e){return ai(`result-${e.sourceIndex}-${e.key}`,Fe`<calcite-list-item .label=${e.name} @calciteListItemSelect=${()=>this._selectResult(e)}></calcite-list-item>`)}},fd.properties={_results:16,_resultCount:16,_selectedResult:16,_showMoreResultsOpen:16,messages:0,autoDestroyDisabled:5,viewModel:0},fd.styles=Are,fd);XL("arcgis-search-result-renderer",Dre);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const eo={buttonLoader:"calcite-button--loader",content:"content",contentSlotted:"content--slotted",icon:"icon",iconStart:"icon--start",iconEnd:"icon--end",loadingIn:"loading-in",loadingOut:"loading-out",iconStartEmpty:"icon-start-empty",iconEndEmpty:"icon-end-empty",buttonPadding:"button-padding",buttonPaddingShrunk:"button-padding--shrunk"},zre=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block;inline-size:auto;vertical-align:middle;border-radius:var(--calcite-button-corner-radius, var(--calcite-internal-button-corner-radius, 0))}:host a,:host button{--calcite-internal-button-content-margin: .5rem;--calcite-internal-button-padding-x: 7px;--calcite-internal-button-padding-y: 3px;position:relative;box-sizing:border-box;display:flex;block-size:100%;inline-size:100%;cursor:pointer;-webkit-user-select:none;user-select:none;appearance:none;align-items:center;justify-content:center;border-style:none;text-align:center;font-family:inherit;font-weight:var(--calcite-font-weight-normal);text-decoration-line:none;outline-color:transparent;box-shadow:var(--calcite-button-shadow, var(--calcite-shadow-none));background-color:var(--calcite-button-background-color, var(--calcite-internal-button-background-color, var(--calcite-color-transparent)));border-block-start-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-block-start-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-block-end-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-block-end-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-inline-start-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-inline-start-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-inline-end-color:var(--calcite-button-border-color, var(--calcite-internal-button-border-inline-end-color, var(--calcite-internal-button-border-color, var(--calcite-color-transparent))));border-style:solid;border-width:var(--calcite-border-width-sm);border-radius:var(--calcite-button-corner-radius, var(--calcite-internal-button-corner-radius, 0));color:var(--calcite-button-text-color, var(--calcite-internal-button-text-color, currentColor));padding-block:var(--calcite-internal-button-padding-y);padding-inline:var(--calcite-internal-button-padding-x);transition:color var(--calcite-animation-timing) ease-in-out,background-color var(--calcite-animation-timing) ease-in-out,box-shadow var(--calcite-animation-timing) ease-in-out,outline-color var(--calcite-internal-animation-timing-fast) ease-in-out}:host a:hover,:host button:hover{text-decoration-line:none}:host a:focus,:host button:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(var(--calcite-spacing-base) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host a span,:host button span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host a calcite-loader,:host button calcite-loader{color:var(--calcite-button-loader-color, var(--calcite-internal-button-loader-color, var(--calcite-button-text-color, var(--calcite-internal-button-text-color))))}:host([round]){--calcite-internal-button-corner-radius: 50px}.content{margin-inline:var(--calcite-internal-button-content-margin)}.icon-start-empty .content{margin-inline-start:unset}.icon-end-empty .content{margin-inline-end:unset}:host([scale=m]) button,:host([scale=m]) a{--calcite-internal-button-content-margin: .75rem}:host([scale=l]) button,:host([scale=l]) a{--calcite-internal-button-content-margin: 1rem}:host([width=auto]){inline-size:auto}:host([width=half]){inline-size:50%}:host([width=full]){inline-size:100%}:host([alignment=center]:not([width=auto])) a,:host([alignment=center]:not([width=auto])) button{justify-content:center}:host([alignment=start]:not([width=auto])) a,:host([alignment=start]:not([width=auto])) button{justify-content:flex-start}:host([alignment=end]:not([width=auto])) a,:host([alignment=end]:not([width=auto])) button{justify-content:flex-end}:host([alignment*=space-between]:not([width=auto])) a,:host([alignment*=space-between]:not([width=auto])) button{justify-content:space-between}:host([alignment=icon-start-space-between]:not([width=auto])) .icon--start{margin-inline-end:auto}:host([alignment=icon-start-space-between]:not([width=auto])) a,:host([alignment=icon-start-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=icon-end-space-between]:not([width=auto])) .icon--end{margin-inline-start:auto}:host([alignment=icon-end-space-between]:not([width=auto])) a,:host([alignment=icon-end-space-between]:not([width=auto])) button{text-align:unset}:host([alignment=center]) a:not(.content--slotted) .icon--start+.icon--end,:host([alignment=center]) button:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:var(--calcite-internal-button-content-margin)}.icon--start,.icon--end{color:var(--calcite-button-icon-color, var(--calcite-icon-color, var(--calcite-ui-icon-color)))}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}@keyframes loader-in{0%{inline-size:0;opacity:0;transform:scale(.5)}to{inline-size:1em;opacity:1;transform:scale(1)}}@keyframes loader-out{0%{inline-size:1em;opacity:1;transform:scale(1)}to{inline-size:0;opacity:0;transform:scale(.5)}}.calcite-button--loader{display:flex}.calcite-button--loader calcite-loader{margin:0}:host([loading]) button.content--slotted .calcite-button--loader calcite-loader,:host([loading]) a.content--slotted .calcite-button--loader calcite-loader{margin-inline-end:var(--calcite-internal-button-content-margin)}:host([loading]) button:not(.content--slotted) .icon--start,:host([loading]) button:not(.content--slotted) .icon--end,:host([loading]) a:not(.content--slotted) .icon--start,:host([loading]) a:not(.content--slotted) .icon--end{display:none}:host([appearance]) button,:host([appearance]) a{--calcite-internal-button-border-color: var(--calcite-color-transparent);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([kind=brand]) button,:host([kind=brand]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=brand]) button:hover,:host([kind=brand]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-brand-hover)}:host([kind=brand]) button:active,:host([kind=brand]) a:active{--calcite-internal-button-background-color: var(--calcite-color-brand-press)}:host([kind=danger]) button,:host([kind=danger]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=danger]) button:hover,:host([kind=danger]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-status-danger-hover)}:host([kind=danger]) button:active,:host([kind=danger]) a:active{--calcite-internal-button-background-color: var(--calcite-color-status-danger-press)}:host([kind=neutral]) button,:host([kind=neutral]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-background-color: var(--calcite-color-foreground-3);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([kind=neutral]) button:hover,:host([kind=neutral]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-foreground-2)}:host([kind=neutral]) button:active,:host([kind=neutral]) a:active{--calcite-internal-button-background-color: var(--calcite-color-foreground-1)}:host([kind=inverse]) button,:host([kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-inverse);--calcite-internal-button-background-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-inverse)}:host([kind=inverse]) button:hover,:host([kind=inverse]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-inverse-hover)}:host([kind=inverse]) button:active,:host([kind=inverse]) a:active{--calcite-internal-button-background-color: var(--calcite-color-inverse-press)}:host([appearance=outline-fill]) button,:host([appearance=outline-fill]) a{--calcite-internal-button-background-color: var(--calcite-color-foreground-1);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([appearance=outline-fill]) button:hover,:host([appearance=outline-fill]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-foreground-2)}:host([appearance=outline-fill]) button:active,:host([appearance=outline-fill]) a:active{--calcite-internal-button-background-color: var(--calcite-color-foreground-3)}:host([appearance=outline-fill][kind=brand]) button,:host([appearance=outline-fill][kind=brand]) a{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=brand]) button:hover,:host([appearance=outline-fill][kind=brand]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-brand-hover);--calcite-internal-button-text-color: var(--calcite-color-brand-hover)}:host([appearance=outline-fill][kind=brand]) button:focus,:host([appearance=outline-fill][kind=brand]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=brand]) button:active,:host([appearance=outline-fill][kind=brand]) a:active{--calcite-internal-button-border-color: var(--calcite-color-brand-press);--calcite-internal-button-text-color: var(--calcite-color-brand-press)}:host([appearance=outline-fill][kind=brand]) button calcite-loader,:host([appearance=outline-fill][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline-fill][kind=danger]) button,:host([appearance=outline-fill][kind=danger]) a{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=danger]) button:hover,:host([appearance=outline-fill][kind=danger]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover)}:host([appearance=outline-fill][kind=danger]) button:focus,:host([appearance=outline-fill][kind=danger]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=danger]) button:active,:host([appearance=outline-fill][kind=danger]) a:active{--calcite-internal-button-border-color: var(--calcite-color-status-danger-press);--calcite-internal-button-text-color: var(--calcite-color-status-danger-press)}:host([appearance=outline-fill][kind=danger]) button calcite-loader,:host([appearance=outline-fill][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline-fill][kind=neutral]) button,:host([appearance=outline-fill][kind=neutral]) a{--calcite-internal-button-border-color: var(--calcite-color-border-1);--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline-fill][kind=neutral]) button:hover,:host([appearance=outline-fill][kind=neutral]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-border-input)}:host([appearance=outline-fill][kind=neutral]) button:focus,:host([appearance=outline-fill][kind=neutral]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-foreground-3)}:host([appearance=outline-fill][kind=neutral]) button:active,:host([appearance=outline-fill][kind=neutral]) a:active{--calcite-internal-button-border-color: var(--calcite-color-text-3)}:host([appearance=solid][kind=neutral]) button:hover,:host([appearance=solid][kind=neutral]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-border-3)}:host([appearance=solid][kind=neutral]) button:active,:host([appearance=solid][kind=neutral]) a:active{--calcite-internal-button-background-color: var(--calcite-color-border-2)}:host([appearance=outline-fill][kind=inverse]) button,:host([appearance=outline-fill][kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline-fill][kind=inverse]) button:hover,:host([appearance=outline-fill][kind=inverse]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-inverse-hover)}:host([appearance=outline-fill][kind=inverse]) button:focus,:host([appearance=outline-fill][kind=inverse]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-inverse)}:host([appearance=outline-fill][kind=inverse]) button:active,:host([appearance=outline-fill][kind=inverse]) a:active{--calcite-internal-button-border-color: var(--calcite-color-inverse-press)}:host([appearance=outline]) button,:host([appearance=outline]) a{--calcite-internal-button-background-color: var(--calcite-color-transparent);border-style:solid;border-width:var(--calcite-button-border-size, 1px)}:host([appearance=outline]) button:hover,:host([appearance=outline]) a:hover{--calcite-internal-button-background-color: var(--calcite-color-transparent-hover)}:host([appearance=outline]) button:active,:host([appearance=outline]) a:active{--calcite-internal-button-background-color: var(--calcite-color-transparent-press)}:host([appearance=outline][kind=brand]) button,:host([appearance=outline][kind=brand]) a{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline][kind=brand]) button:hover,:host([appearance=outline][kind=brand]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-brand-hover);--calcite-internal-button-text-color: var(--calcite-color-brand-hover)}:host([appearance=outline][kind=brand]) button:focus,:host([appearance=outline][kind=brand]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-brand);--calcite-internal-button-text-color: var(--calcite-color-brand)}:host([appearance=outline][kind=brand]) button:active,:host([appearance=outline][kind=brand]) a:active{--calcite-internal-button-border-color: var(--calcite-color-brand-press);--calcite-internal-button-text-color: var(--calcite-color-brand-press)}:host([appearance=outline][kind=brand]) button calcite-loader,:host([appearance=outline][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=outline][kind=danger]) button,:host([appearance=outline][kind=danger]) a{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=danger]) button:hover,:host([appearance=outline][kind=danger]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-status-danger-hover);--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover)}:host([appearance=outline][kind=danger]) button:focus,:host([appearance=outline][kind=danger]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-status-danger);--calcite-internal-button-text-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=danger]) button:active,:host([appearance=outline][kind=danger]) a:active{--calcite-internal-button-border-color: var(--calcite-color-status-danger-press);--calcite-internal-button-text-color: var(--calcite-color-status-danger-press)}:host([appearance=outline][kind=danger]) button calcite-loader,:host([appearance=outline][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=outline][kind=neutral]) button,:host([appearance=outline][kind=neutral]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-border-1);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline][kind=neutral]) button:hover,:host([appearance=outline][kind=neutral]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-border-input)}:host([appearance=outline][kind=neutral]) button:focus,:host([appearance=outline][kind=neutral]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-foreground-3)}:host([appearance=outline][kind=neutral]) button:active,:host([appearance=outline][kind=neutral]) a:active{--calcite-internal-button-border-color: var(--calcite-color-text-3)}:host([appearance=outline][kind=inverse]) button,:host([appearance=outline][kind=inverse]) a{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-border-color: var(--calcite-color-inverse);--calcite-internal-button-loader-color: var(--calcite-color-text-1)}:host([appearance=outline][kind=inverse]) button:hover,:host([appearance=outline][kind=inverse]) a:hover{--calcite-internal-button-border-color: var(--calcite-color-inverse-hover)}:host([appearance=outline][kind=inverse]) button:focus,:host([appearance=outline][kind=inverse]) a:focus{--calcite-internal-button-border-color: var(--calcite-color-inverse)}:host([appearance=outline][kind=inverse]) button:active,:host([appearance=outline][kind=inverse]) a:active{--calcite-internal-button-border-color: var(--calcite-color-inverse-press)}:host([appearance=outline-fill][split-child=primary]) button,:host([appearance=outline][split-child=primary]) button,:host([appearance=outline-fill][split-child=primary]) a,:host([appearance=outline][split-child=primary]) a{border-inline-end-width:0;border-inline-start-width:1px}:host([appearance=outline-fill][split-child=secondary]) button,:host([appearance=outline][split-child=secondary]) button,:host([appearance=outline-fill][split-child=secondary]) a,:host([appearance=outline][split-child=secondary]) a{border-inline-start-width:0;border-inline-end-width:1px}:host([appearance=transparent]) button,:host([appearance=transparent]) a{--calcite-internal-button-background-color: var(--calcite-color-transparent)}:host([appearance=transparent]) button:hover,:host([appearance=transparent]) button:focus,:host([appearance=transparent]) a:hover,:host([appearance=transparent]) a:focus{--calcite-internal-button-background-color: var(--calcite-color-transparent-hover)}:host([appearance=transparent]) button:active,:host([appearance=transparent]) a:active{--calcite-internal-button-background-color: var(--calcite-color-transparent-press)}:host([appearance=transparent]:not(.enable-editing-button)) button,:host([appearance=transparent]:not(.enable-editing-button)) a{background-color:var(--calcite-color-transparent)}:host([appearance=transparent]:not(.enable-editing-button)) button:hover,:host([appearance=transparent]:not(.enable-editing-button)) a:hover{background-color:var(--calcite-color-transparent-hover)}:host([appearance=transparent]:not(.enable-editing-button)) button:active,:host([appearance=transparent]:not(.enable-editing-button)) a:active{background-color:var(--calcite-color-transparent-press)}:host([appearance=transparent][kind=brand]) button,:host([appearance=transparent][kind=brand]) a{--calcite-internal-button-text-color: var(--calcite-color-brand);--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=brand]) button:hover,:host([appearance=transparent][kind=brand]) a:hover{--calcite-internal-button-text-color: var(--calcite-color-brand-hover)}:host([appearance=transparent][kind=brand]) button:focus,:host([appearance=transparent][kind=brand]) a:focus{--calcite-internal-button-text-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=brand]) button:active,:host([appearance=transparent][kind=brand]) a:active{--calcite-internal-button-text-color: var(--calcite-color-brand-press)}:host([appearance=transparent][kind=brand]) button calcite-loader,:host([appearance=transparent][kind=brand]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-brand)}:host([appearance=transparent][kind=danger]) button,:host([appearance=transparent][kind=danger]) a{--calcite-internal-button-text-color: var(--calcite-color-status-danger);--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=danger]) button:hover,:host([appearance=transparent][kind=danger]) a:hover{--calcite-internal-button-text-color: var(--calcite-color-status-danger-hover)}:host([appearance=transparent][kind=danger]) button:focus,:host([appearance=transparent][kind=danger]) a:focus{--calcite-internal-button-text-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=danger]) button:active,:host([appearance=transparent][kind=danger]) a:active{--calcite-internal-button-text-color: var(--calcite-color-status-danger-press)}:host([appearance=transparent][kind=danger]) button calcite-loader,:host([appearance=transparent][kind=danger]) a calcite-loader{--calcite-internal-button-loader-color: var(--calcite-color-status-danger)}:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) button,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) a,:host([appearance=transparent][kind=neutral]:not(.cancel-editing-button)) calcite-loader{--calcite-internal-button-text-color: var(--calcite-color-text-1)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button{--calcite-internal-button-text-color: var(--calcite-color-text-3)}:host([appearance=transparent][kind=neutral].cancel-editing-button) button:hover{--calcite-internal-button-text-color: var(--calcite-color-text-1);--calcite-internal-button-padding-y: 0}:host(.confirm-changes-button) button:focus,:host(.cancel-editing-button) button:focus,:host(.enable-editing-button) button:focus{outline-offset:-2px}:host([appearance=transparent][kind=inverse]) button:hover,:host([appearance=transparent][kind=inverse]) a:hover{background-color:var(--calcite-color-transparent-inverse-hover)}:host([appearance=transparent][kind=inverse]) button:active,:host([appearance=transparent][kind=inverse]) a:active{background-color:var(--calcite-color-transparent-inverse-press)}:host([appearance=transparent][kind=inverse]) button calcite-loader,:host([appearance=transparent][kind=inverse]) a calcite-loader{--calcite-internal-button-text-color: var(--calcite-color-text-inverse)}:host([scale=s]) button.content--slotted,:host([scale=s]) a.content--slotted{font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s][appearance=transparent]) button.content--slotted,:host([scale=s][appearance=transparent]) a.content--slotted{--calcite-internal-button-padding-x: .5rem}:host([scale=s]) button,:host([scale=s]) a{--calcite-internal-button-padding-y: 3px}:host([scale=m]) button.content--slotted,:host([scale=m]) a.content--slotted{--calcite-internal-button-padding-x: 11px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) button,:host([scale=m]) a{--calcite-internal-button-padding-y: 7px}:host([scale=m][appearance=transparent]) button.content--slotted,:host([scale=m][appearance=transparent]) a.content--slotted{--calcite-internal-button-padding-x: .75rem}:host([scale=l]) button.content--slotted,:host([scale=l]) a.content--slotted{--calcite-internal-button-padding-x: 15px;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .button-padding{--calcite-internal-button-padding-x: 1rem;--calcite-internal-button-padding-y: 11px}:host([scale=l]) .button-padding--shrunk{--calcite-internal-button-padding-y: 9px}:host([scale=s]) button:not(.content--slotted),:host([scale=s]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 3px;inline-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:1.5rem}:host([scale=m]) button:not(.content--slotted),:host([scale=m]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 7px;inline-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2rem}:host([scale=l]) button:not(.content--slotted),:host([scale=l]) a:not(.content--slotted){--calcite-internal-button-padding-x: .125rem;--calcite-internal-button-padding-y: 9px;inline-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem;min-block-size:2.75rem}:host(:is([scale=s],[scale=m],[scale=l])[width=full]) a:not(.content--slotted),:host(:is([scale=s],[scale=m],[scale=l])[width=full]) button:not(.content--slotted){inline-size:var(--calcite-container-size-content-fluid)}:host([scale=l][appearance=transparent]) button:not(.content--slotted),:host([scale=l][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-y: .625rem}:host([scale=s][icon-start][icon-end]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 23px;block-size:1.5rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=s][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=s][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 1.5rem}:host([scale=m][icon-start][icon-end]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 2rem;block-size:2rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=m][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=m][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 33px}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end]) a:not(.content--slotted){--calcite-internal-button-padding-x: 43px;block-size:2.75rem;font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l][icon-start][icon-end]) button:not(.content--slotted) .icon--start+.icon--end,:host([scale=l][icon-start][icon-end]) a:not(.content--slotted) .icon--start+.icon--end{margin-inline-start:1rem}:host([scale=l][icon-start][icon-end][appearance=transparent]) button:not(.content--slotted),:host([scale=l][icon-start][icon-end][appearance=transparent]) a:not(.content--slotted){--calcite-internal-button-padding-x: 2.75rem}:host([hidden]){display:none}[hidden]{display:none}`,N1=class N1 extends Vi{constructor(){super(...arguments),this.attributeWatch=y$(["aria-expanded"],this.handleGlobalAttributesChanged),this.contentRef=Xn(),this.mutationObserver=Ho("mutation",()=>this.updateHasContent()),this.resizeObserver=Ho("resize",()=>this.setTooltipText()),this.focusSetter=Rs()(this),this.messages=go(),this.hasContent=!1,this.alignment="center",this.appearance="solid",this.disabled=!1,this.download=!1,this.kind="brand",this.loading=!1,this.round=!1,this.scale="m",this.splitChild=!1,this.type="button",this.width="auto"}async setFocus(e){return this.focusSetter(()=>this.childEl,e)}connectedCallback(){super.connectedCallback(),this.setupTextContentObserver(),ev(this),this.formEl=$$(this)}async load(){this.updateHasContent()}updated(){yo(this)}loaded(){this.setTooltipText()}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),A$(this),this.resizeObserver?.disconnect(),this.formEl=null}handleGlobalAttributesChanged(){this.requestUpdate()}updateHasContent(){this.hasContent=UW(this.el)}setupTextContentObserver(){this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0})}onLabelClick(){this.handleClick(),this.setFocus()}handleClick(){const{type:e}=this;this.href||(e==="submit"?hw(this):e==="reset"&&UR(this))}setTooltipText(){const{contentRef:{value:e}}=this;e&&(this.tooltipText=e.offsetWidth<e.scrollWidth&&this.el.innerText||null)}setChildEl(e){Tx(this.resizeObserver,this.childEl,e),this.childEl=e}render(){const e=this.href?"a":"button",i=this.href?w0`a`:w0`button`,r=this.loading?Fe`<div class=${Le(eo.buttonLoader)}><calcite-loader class=${Le(this.loading?eo.loadingIn:eo.loadingOut)} inline .label=${this.messages.loading} .scale=${this.scale==="l"?"m":"s"}></calcite-loader></div>`:null,o=!this.iconStart&&!this.iconEnd,h=Fe`<calcite-icon class=${Le({[eo.icon]:!0,[eo.iconStart]:!0})} .flipRtl=${this.iconFlipRtl==="start"||this.iconFlipRtl==="both"} .icon=${this.iconStart} .scale=${Ur(this.scale)}></calcite-icon>`,d=Fe`<calcite-icon class=${Le({[eo.icon]:!0,[eo.iconEnd]:!0})} .flipRtl=${this.iconFlipRtl==="end"||this.iconFlipRtl==="both"} .icon=${this.iconEnd} .scale=${Ur(this.scale)}></calcite-icon>`,a=Fe`<span class=${Le(eo.content)} ${hi(this.contentRef)}><slot></slot></span>`;return vo({disabled:this.disabled,children:M$`<${i} .ariaBusy=${this.loading} .ariaExpanded=${this.el.ariaExpanded?this.el.ariaExpanded:null} .ariaLabel=${this.loading?this.messages.loading:Nx(this)} aria-live=polite class=${Le({[eo.buttonPadding]:o,[eo.buttonPaddingShrunk]:!o,[eo.contentSlotted]:this.hasContent,[eo.iconStartEmpty]:!this.iconStart,[eo.iconEndEmpty]:!this.iconEnd})} .disabled=${e==="button"?this.disabled:null} download=${(e==="a"?this.download===!0||this.download===""?"":this.download||null:null)??ut} href=${(e==="a"&&this.href)??ut} name=${(e==="button"&&this.name)??ut} @click=${this.handleClick} rel=${(e==="a"&&this.rel)??ut} tabindex=${(this.disabled?-1:null)??ut} target=${(e==="a"&&this.target)??ut} title=${this.tooltipText??ut} type=${(e==="button"?this.type:null)??ut} ${hi(this.setChildEl)}>${r}${this.iconStart?h:null}${this.hasContent?a:null}${this.iconEnd?d:null}</${i}>`})}};N1.properties={hasContent:[16,{},{state:!0}],tooltipText:[16,{},{state:!0}],alignment:[3,{},{reflect:!0}],appearance:[3,{},{reflect:!0}],disabled:[7,{},{reflect:!0,type:Boolean}],download:[3,{converter:_d},{reflect:!0}],form:[3,{},{reflect:!0}],href:[3,{},{reflect:!0}],iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],kind:[3,{},{reflect:!0}],label:1,loading:[7,{},{reflect:!0,type:Boolean}],messageOverrides:[0,{},{attribute:!1}],name:[3,{},{reflect:!0}],rel:[3,{},{reflect:!0}],round:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],splitChild:[3,{},{reflect:!0}],target:[3,{},{reflect:!0}],type:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]},N1.styles=zre;let dE=N1;lr("calcite-button",dE);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Ore={textMatch:"text-match"};function y5({text:t,pattern:e}){if(!e||!t)return t;const i=t.split(e);return i.length>1&&(i[1]=Fe`<mark class=${Le(Ore.textMatch)}>${i[1]}</mark>`),i}/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const su={container:"container",containerActive:"container--active",contentCenter:"content-center",description:"description",heading:"heading",iconEnd:"icon-end",iconStart:"icon-start",scale:t=>`scale--${t}`},v5={contentEnd:"content-end",contentStart:"content-start"},Rre="autocomplete-item",Lre={host:t=>`${Rre}-${t}`},Fre=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}.scale--s{font-size:var(--calcite-font-size--2);line-height:1rem;--calcite-internal-autocomplete-item-spacing-unit-l: .5rem;--calcite-internal-autocomplete-item-spacing-unit-s: .25rem;--calcite-internal-autocomplete-item-description-font-size: var(--calcite-font-size-xs)}.scale--m{font-size:var(--calcite-font-size--1);line-height:1rem;--calcite-internal-autocomplete-item-spacing-unit-l: .75rem;--calcite-internal-autocomplete-item-spacing-unit-s: .375rem;--calcite-internal-autocomplete-item-description-font-size: var(--calcite-font-size-sm)}.scale--l{font-size:var(--calcite-font-size-0);line-height:1.25rem;--calcite-internal-autocomplete-item-spacing-unit-l: 1rem;--calcite-internal-autocomplete-item-spacing-unit-s: .625rem;--calcite-internal-autocomplete-item-description-font-size: var(--calcite-font-size)}:host{display:flex}.container{position:relative;box-sizing:border-box;display:flex;inline-size:100%;min-inline-size:100%;cursor:pointer;align-items:center;outline-color:transparent;background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-1));color:var(--calcite-autocomplete-text-color, var(--calcite-color-text-3));gap:var(--calcite-internal-autocomplete-item-spacing-unit-l);padding-inline:var(--calcite-internal-autocomplete-item-spacing-unit-l);padding-block:var(--calcite-internal-autocomplete-item-spacing-unit-s);word-wrap:break-word;word-break:break-word;justify-content:space-around}.description{color:var(--calcite-autocomplete-description-text-color);font-size:var(--calcite-internal-autocomplete-item-description-font-size)}.heading{color:var(--calcite-autocomplete-heading-text-color, var(--calcite-color-text-1))}.heading,.description{line-height:var(--calcite-font-line-height-relative-snug)}:host(:hover:not([disabled])) .container{background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-2))}:host(:hover:not([disabled])) .container .description{color:var(--calcite-autocomplete-description-text-color, var(--calcite-color-text-2))}.container--active{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}.content-center{display:flex;flex-direction:column;flex-grow:1;padding-block:0}.text-match{background-color:transparent;color:inherit;font-weight:var(--calcite-font-weight-bold)}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}`,B1=class B1 extends Vi{constructor(){super(...arguments),this.active=!1,this.disabled=!1,this.guid=Lre.host(Hu()),this.scale="m",this.calciteAutocompleteItemSelect=vt({cancelable:!1})}emitSelectEvent(){this.calciteAutocompleteItemSelect.emit()}updated(){yo(this)}handleClick(e){e.preventDefault(),this.emitSelectEvent()}render(){const{active:e,description:i,heading:r,disabled:o,inputValueMatchPattern:h}=this;return vo({disabled:o,children:Fe`<div class=${Le({[su.container]:!0,[su.containerActive]:e&&!o,[su.scale(this.scale)]:!0})} @click=${this.handleClick}>${this.renderIcon("start")}<slot name=${v5.contentStart}></slot><div class=${Le(su.contentCenter)}><div class=${Le(su.heading)}>${y5({text:r,pattern:h})}</div><div class=${Le(su.description)}>${y5({text:i,pattern:h})}</div></div><slot name=${v5.contentEnd}></slot>${this.renderIcon("end")}</div>`})}renderIcon(e){const{iconFlipRtl:i}=this,r=e==="start"?this.iconStart:this.iconEnd;return r?Fe`<calcite-icon class=${Le(e==="start"?su.iconStart:su.iconEnd)} .flipRtl=${i===e||i==="both"} .icon=${r} .scale=${Ur(this.scale)}></calcite-icon>`:null}};B1.properties={active:[5,{},{type:Boolean}],description:1,disabled:[7,{},{reflect:!0,type:Boolean}],guid:1,heading:1,iconEnd:[3,{},{reflect:!0}],iconFlipRtl:[3,{},{reflect:!0}],iconStart:[3,{},{reflect:!0}],inputValueMatchPattern:[2,{},{reflect:!0,attribute:!1}],label:1,scale:1,value:1},B1.styles=Fre;let pE=B1;lr("calcite-autocomplete-item",pE);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _5=(t,e,i)=>{const r=new Map;for(let o=e;o<=i;o++)r.set(t[o],o);return r},Nre=wm(class extends Sm{constructor(t){if(super(t),t.type!==ll.CHILD)throw Error("repeat() can only be used in text expressions")}dt(t,e,i){let r;i===void 0?i=e:e!==void 0&&(r=e);const o=[],h=[];let d=0;for(const a of t)o[d]=r?r(a,d):d,h[d]=i(a,d),d++;return{values:h,keys:o}}render(t,e,i){return this.dt(t,e,i).values}update(t,[e,i,r]){const o=OZ(t),{values:h,keys:d}=this.dt(e,i,r);if(!Array.isArray(o))return this.ut=d,h;const a=this.ut??=[],v=[];let T,E,k=0,L=o.length-1,O=0,H=h.length-1;for(;k<=L&&O<=H;)if(o[k]===null)k++;else if(o[L]===null)L--;else if(a[k]===d[O])v[O]=kh(o[k],h[O]),k++,O++;else if(a[L]===d[H])v[H]=kh(o[L],h[H]),L--,H--;else if(a[k]===d[H])v[H]=kh(o[k],h[H]),Yg(t,v[H+1],o[k]),k++,H--;else if(a[L]===d[O])v[O]=kh(o[L],h[O]),Yg(t,o[k],o[L]),L--,O++;else if(T===void 0&&(T=_5(d,O,H),E=_5(a,k,L)),T.has(a[k]))if(T.has(a[L])){const ie=E.get(d[O]),pe=ie!==void 0?o[ie]:null;if(pe===null){const be=Yg(t,o[k]);kh(be,h[O]),v[O]=be}else v[O]=kh(pe,h[O]),Yg(t,o[k],pe),o[ie]=null;O++}else ES(o[L]),L--;else ES(o[k]),k++;for(;O<=H;){const ie=Yg(t,v[H+1]);kh(ie,h[O]),v[O++]=ie}for(;k<=L;){const ie=o[k++];ie!==null&&ES(ie)}return this.ut=d,f$(t,v),uo}});/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const Bre=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{position:relative;display:block}.input-container{position:relative;display:flex;flex:1 1 auto;flex-wrap:nowrap}.input{width:100%;--calcite-input-prefix-size: var(--calcite-autocomplete-input-prefix-size);--calcite-input-suffix-size: var(--calcite-autocomplete-input-suffix-size);--calcite-input-background-color: var(--calcite-autocomplete-input-background-color);--calcite-input-border-color: var(--calcite-autocomplete-input-border-color);--calcite-input-corner-radius: var(--calcite-autocomplete-input-corner-radius);--calcite-input-shadow: var(--calcite-autocomplete-input-shadow);--calcite-input-icon-color: var(--calcite-autocomplete-input-icon-color);--calcite-input-text-color: var(--calcite-autocomplete-input-text-color);--calcite-input-placeholder-text-color: var(--calcite-autocomplete-input-placeholder-text-color);--calcite-input-actions-background-color: var(--calcite-autocomplete-input-actions-background-color);--calcite-input-actions-background-color-hover: var(--calcite-autocomplete-input-actions-background-color-hover);--calcite-input-actions-background-color-press: var(--calcite-autocomplete-input-actions-background-color-press);--calcite-input-actions-icon-color: var(--calcite-autocomplete-input-actions-icon-color);--calcite-input-actions-icon-color-hover: var(--calcite-autocomplete-input-actions-icon-color-hover);--calcite-input-actions-icon-color-press: var(--calcite-autocomplete-input-actions-icon-color-press);--calcite-input-loading-background-color: var(--calcite-autocomplete-input-loading-background-color);--calcite-input-loading-fill-color: var(--calcite-autocomplete-input-loading-fill-color);--calcite-input-prefix-background-color: var(--calcite-autocomplete-input-prefix-background-color);--calcite-input-prefix-text-color: var(--calcite-autocomplete-input-prefix-text-color);--calcite-input-suffix-background-color: var(--calcite-autocomplete-input-suffix-background-color);--calcite-input-suffix-text-color: var(--calcite-autocomplete-input-suffix-text-color)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}.content-container{box-sizing:border-box;width:100%}.floating-ui-container{--calcite-floating-ui-z-index: var(--calcite-z-index-dropdown);inline-size:max-content;display:none;max-inline-size:100vw;max-block-size:100vh;inset-block-start:0;left:0;z-index:var(--calcite-floating-ui-z-index)}@starting-style{.floating-ui-container{opacity:0;inset-block-start:0;left:0}}.floating-ui-container .calcite-floating-ui-anim{position:relative;transition-duration:var(--calcite-floating-ui-transition);transition-property:inset-block-start,left,opacity,display;transition-behavior:allow-discrete;opacity:0;box-shadow:0 0 16px #00000029;z-index:var(--calcite-z-index);border-radius:.25rem}.floating-ui-container[data-placement^=bottom] .calcite-floating-ui-anim{inset-block-start:-5px}.floating-ui-container[data-placement^=top] .calcite-floating-ui-anim{inset-block-start:5px}.floating-ui-container[data-placement^=left] .calcite-floating-ui-anim{left:5px}.floating-ui-container[data-placement^=right] .calcite-floating-ui-anim{left:-5px}.floating-ui-container[data-placement] .calcite-floating-ui-anim--active{opacity:1;inset-block-start:0;left:0}@starting-style{.floating-ui-container[data-placement] .calcite-floating-ui-anim--active{opacity:0}}.content-container .calcite-floating-ui-anim{max-height:45vh;width:100%;overflow-y:auto;color:var(--calcite-autocomplete-text-color, var(--calcite-color-text-1));background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-1));border-radius:var(--calcite-autocomplete-corner-radius, var(--calcite-corner-radius-round))}.content--hidden{display:none}@media (forced-colors: active){.floating-ui-container--active{border:1px solid canvasText}}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.internal-label-alignment--center{align-items:center}.internal-label-alignment--end{align-items:end}.internal-label--container{display:flex;justify-content:space-between;color:var(--calcite-color-text-1)}.internal-label-required--indicator{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-status-danger);padding-inline:var(--calcite-spacing-base)}.internal-label-required--indicator:hover{cursor:help}.internal-label--text{line-height:1}:host([scale=s]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-xxs)}:host([scale=s]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=s]) .internal-label--text{font-size:var(--calcite-font-size--2)}:host([scale=m]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-sm)}:host([scale=m]) .internal-label--text{font-size:var(--calcite-font-size--1)}:host([scale=l]) .internal-label-spacing--bottom{margin-block-end:var(--calcite-spacing-sm)}:host([scale=l]) .internal-label-spacing-inline--end{margin-inline-end:var(--calcite-spacing-md)}:host([scale=l]) .internal-label-spacing-inline--start{margin-inline-start:var(--calcite-spacing-md)}:host([scale=l]) .internal-label--text{font-size:var(--calcite-font-size-0)}.validation-container{display:flex;flex-direction:column;align-items:flex-start;align-self:stretch}:host([scale=m]) .validation-container,:host([scale=l]) .validation-container{padding-block-start:.5rem}:host([scale=s]) .validation-container{padding-block-start:.25rem}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}:host([hidden]){display:none}[hidden]{display:none}`,b5={contentBottom:"content-bottom",contentTop:"content-top"},ec={inputContainer:"input-container",input:"input",contentContainer:"content-container",contentAnimation:"content-animation",content:"content",contentHidden:"content--hidden",floatingUIContainer:"floating-ui-container",floatingUIContainerActive:"floating-ui-container--active",screenReadersOnly:"screen-readers-only"},x5="autocomplete",fT={validationMessage:"autocompleteValidationMessage",input:t=>`${x5}-input-${t}`,list:t=>`${x5}-list-${t}`},jre="calcite-autocomplete-item-group",Ure="calcite-autocomplete-item",j1=class j1 extends Vi{constructor(){super(),this.guid=Hu(),this.attributeWatch=y$(["autofocus","enterkeyhint","inputmode"],this.handleGlobalAttributesChanged),this.inputId=fT.input(this.guid),this.listId=fT.list(this.guid),this.messages=go(),this.transitionProp="opacity",this.mutationObserver=Ho("mutation",()=>this.getAllItemsDebounced()),this.focusSetter=Rs()(this),this.resizeObserver=Ho("resize",()=>{this.setFloatingElSize()}),this.cancelable=D$()(this),this.getAllItemsDebounced=lw(this.getAllItems,0),this.activeDescendant="",this.activeIndex=-1,this.hasContentBottom=!1,this.hasContentTop=!1,this.items=[],this.groups=[],this.alignment="start",this.disabled=!1,this.iconFlipRtl=!1,this.loading=!1,this.open=!1,this.overlayPositioning="absolute",this.placement=b0,this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.value="",this.calciteAutocompleteBeforeClose=vt({cancelable:!1}),this.calciteAutocompleteBeforeOpen=vt({cancelable:!1}),this.calciteAutocompleteChange=vt({cancelable:!1}),this.calciteAutocompleteClose=vt({cancelable:!1}),this.calciteAutocompleteOpen=vt({cancelable:!1}),this.calciteAutocompleteTextChange=vt({cancelable:!1}),this.calciteAutocompleteTextInput=vt({cancelable:!1}),this.listenOn(document,"click",this.documentClickHandler),this.listen("calciteAutocompleteItemSelect",this.handleAutocompleteItemSelect)}get isOpen(){return this.open&&(this.hasContentTop||this.hasContentBottom||this.items.length>0)}get enabledItems(){return this.items.filter(e=>!e.disabled)}async reposition(e=!1){const{floatingEl:i,referenceEl:r,placement:o,overlayPositioning:h,flipPlacements:d}=this;return S$(this,{floatingEl:i,referenceEl:r,overlayPositioning:h,placement:o,flipPlacements:d,type:"menu"},e)}async scrollContentTo(e){this.transitionEl?.scrollTo(e)}async selectText(){return this.referenceEl.selectText()}async setFocus(e){return this.focusSetter(()=>this.referenceEl,e)}connectedCallback(){super.connectedCallback(),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0}),ev(this),VR(this),this.defaultInputValue=this.inputValue||"",this.getAllItemsDebounced(),fc(this),this.cancelable.add(this.getAllItemsDebounced)}async load(){this.getAllItemsDebounced()}willUpdate(e){e.has("disabled")&&(this.hasUpdated||this.disabled!==!1)&&this.handleDisabledChange(this.disabled),e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openHandler(),(e.has("flipPlacements")||e.has("overlayPositioning")&&(this.hasUpdated||this.overlayPositioning!=="absolute")||e.has("placement")&&(this.hasUpdated||this.placement!==b0))&&this.reposition(!0);let i=!1;e.has("inputValue")&&(this.hasUpdated||this.inputValue)&&(this.inputValueMatchPattern=this.inputValue&&new RegExp(`(${cL(this.inputValue)})`,"i"),this.updateItems(),this.updateGroups(),i=!0),!i&&e.has("scale")&&(this.hasUpdated||this.scale!=="m")&&(this.updateItems(),this.updateGroups(),i=!0),!i&&e.has("activeIndex")&&(this.hasUpdated||this.activeIndex!==-1)&&this.updateItems()}updated(){yo(this)}loaded(){IX(this,this.value||""),this.defaultInputValue=this.inputValue||"",fc(this)}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.resizeObserver?.disconnect(),A$(this),GR(this),cw(this)}setFloatingElSize(){const{referenceEl:e,floatingEl:i}=this;!e||!i||(i.style.inlineSize=`${e.clientWidth}px`)}handleGlobalAttributesChanged(){this.requestUpdate()}handleDisabledChange(e){e||(this.open=!1)}openHandler(){if(Q0(this),this.open||(this.activeIndex=-1),this.disabled){this.open=!1;return}this.setFloatingElSize(),this.reposition(!0)}async documentClickHandler(e){this.disabled||e.composedPath().includes(this.el)||(this.open=!1)}async handleAutocompleteItemSelect(e){this.value=e.target.value,this.emitChange(),await this.setFocus(),this.open=!1}onLabelClick(){this.setFocus()}onFormReset(){this.inputValue=this.defaultInputValue}onBeforeOpen(){this.calciteAutocompleteBeforeOpen.emit()}onOpen(){this.calciteAutocompleteOpen.emit()}onBeforeClose(){this.calciteAutocompleteBeforeClose.emit()}onClose(){this.calciteAutocompleteClose.emit()}emitChange(){this.calciteAutocompleteChange.emit()}updateGroups(){this.groups.forEach((e,i,r)=>{e.scale=this.scale,i===0&&(e.disableSpacing=!0);const o=r[i+1];o&&(o.disableSpacing=e.children.length===0)})}updateItems(){let e=null;this.items.forEach(i=>{i.scale=this.scale,i.inputValueMatchPattern=this.inputValueMatchPattern}),this.enabledItems.forEach((i,r)=>{const o=r===this.activeIndex;o&&(e=i.guid),i.active=o}),this.activeDescendant=e}handleInputFocus(){this.open=!0}handleContentTopSlotChange(e){this.hasContentTop=$r(e)}handleContentBottomSlotChange(e){this.hasContentBottom=$r(e)}getAllItems(){const{el:e}=this;this.groups=Array.from(e.querySelectorAll(jre)),this.items=Array.from(e.querySelectorAll(Ure)),this.updateItems(),this.updateGroups()}setReferenceEl(e){Tx(this.resizeObserver,this.referenceEl,e),this.referenceEl=e,fc(this)}keyDownHandler(e){const{defaultPrevented:i,key:r}=e;if(i)return;const{open:o,activeIndex:h,enabledItems:d}=this,a=d.length&&h>-1?d[h]:null;switch(r){case"Escape":o&&(this.open=!1,e.preventDefault());break;case"Tab":this.open=!1;break;case"Enter":o&&a?(this.value=a.value,a.emitSelectEvent(),this.open=!1,e.preventDefault()):e.defaultPrevented||hw(this)&&e.preventDefault();break;case"ArrowDown":d.length&&(this.open=!0,this.activeIndex=h!==-1?Math.min(h+1,d.length-1):0,this.scrollToActiveItem(),e.preventDefault());break;case"ArrowUp":d.length&&(this.open=!0,this.activeIndex=h!==-1?Math.max(h-1,0):d.length-1,this.scrollToActiveItem(),e.preventDefault());break;case"Home":d.length&&(this.open=!0,this.activeIndex=0,this.scrollToActiveItem(),e.preventDefault());break;case"End":d.length&&(this.open=!0,this.activeIndex=d.length-1,this.scrollToActiveItem(),e.preventDefault());break}}scrollToActiveItem(){this.enabledItems[this.activeIndex]?.scrollIntoView({block:"nearest"})}changeHandler(e){e.stopPropagation(),this.inputValue=e.target.value,this.calciteAutocompleteTextChange.emit()}inputClickHandler(e){e.defaultPrevented||(this.open=!0)}inputHandler(e){e.stopPropagation(),this.inputValue=e.target.value,this.open=this.inputValue?.length>0,this.calciteAutocompleteTextInput.emit()}setFloatingEl(e){this.floatingEl=e,fc(this)}setTransitionEl(e){e&&(this.transitionEl=e)}render(){const{disabled:e,listId:i,inputId:r,isOpen:o}=this,h=this.el.autofocus,d=this.el.enterKeyHint,a=this.el.inputMode;return vo({disabled:e,children:Fe`${this.labelText&&oL({labelText:this.labelText,onClick:this.onLabelClick,required:this.required,tooltipText:this.messages.required})||""}<div class=${Le(ec.inputContainer)}><calcite-input .alignment=${this.alignment} aria-activedescendant=${this.activeDescendant??ut} aria-controls=${i??ut} aria-label=${Nx(this)??ut} aria-owns=${i??ut} aria-autocomplete=list .ariaExpanded=${o} aria-haspopup=listbox .autocomplete=${this.autocomplete} .autofocus=${h} class=${Le(ec.input)} clearable .disabled=${e} enterkeyhint=${d??ut} .form=${this.form} .icon=${this.icon??!0} .iconFlipRtl=${this.iconFlipRtl} id=${r??ut} inputmode=${a??ut} .label=${this.label} .loading=${this.loading} .maxLength=${this.maxLength} .messageOverrides=${this.messages} .minLength=${this.minLength} .name=${this.name} @click=${this.inputClickHandler} @keydown=${this.keyDownHandler} @calciteInputChange=${this.changeHandler} @calciteInputInput=${this.inputHandler} @calciteInternalInputFocus=${this.handleInputFocus} .pattern=${this.pattern} .placeholder=${this.placeholder} .prefixText=${this.prefixText} .readOnly=${this.readOnly} .required=${this.required} role=combobox .scale=${this.scale} .status=${this.status} .suffixText=${this.suffixText} type=search .value=${this.inputValue} ${hi(this.setReferenceEl)}></calcite-input>${this.renderListBox()}<div class=${Le({[ec.contentContainer]:!0,[ec.floatingUIContainer]:!0,[ec.floatingUIContainerActive]:o})} ${hi(this.setFloatingEl)}><div class=${Le({[ec.contentAnimation]:!0,[nm.animation]:!0,[nm.animationActive]:o})} ${hi(this.setTransitionEl)}><div class=${Le({[ec.content]:!0,[ec.contentHidden]:!o})}><slot name=${b5.contentTop} @slotchange=${this.handleContentTopSlotChange}></slot><slot aria-hidden=true></slot><slot name=${b5.contentBottom} @slotchange=${this.handleContentBottomSlotChange}></slot></div></div></div></div>${HR({component:this})}${this.validationMessage&&this.status==="invalid"?aL({icon:this.validationIcon,id:fT.validationMessage,message:this.validationMessage,scale:this.scale,status:this.status}):null}`})}renderListBox(){return Fe`<ul aria-labelledby=${this.inputId??ut} aria-live=polite class=${Le(ec.screenReadersOnly)} id=${this.listId??ut} role=listbox tabindex=-1>${this.renderListBoxOptions()}</ul>`}renderListBoxOptions(){return Nre(this.items.filter(e=>!!(e.label||e.heading)),e=>e.guid,e=>Fe`<li .ariaDisabled=${e.disabled} .ariaLabel=${e.label} id=${e.guid??ut} role=option tabindex=-1>${e.heading}${e.description}</li>`)}};j1.properties={activeDescendant:[16,{},{state:!0}],activeIndex:[16,{},{state:!0}],hasContentBottom:[16,{},{state:!0}],hasContentTop:[16,{},{state:!0}],items:[16,{},{state:!0}],groups:[16,{},{state:!0}],alignment:[3,{},{reflect:!0}],autocomplete:[0,{},{attribute:!1}],disabled:[7,{},{reflect:!0,type:Boolean}],flipPlacements:[0,{},{attribute:!1}],form:[3,{},{reflect:!0}],icon:[3,{converter:_d},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],inputValue:1,label:1,labelText:1,loading:[7,{},{reflect:!0,type:Boolean}],maxLength:[11,{},{reflect:!0,type:Number}],messageOverrides:[0,{},{attribute:!1}],minLength:[11,{},{reflect:!0,type:Number}],name:[3,{},{reflect:!0}],open:[7,{},{reflect:!0,type:Boolean}],overlayPositioning:[3,{},{reflect:!0}],pattern:1,placeholder:1,placement:[3,{},{reflect:!0}],prefixText:1,readOnly:[7,{},{reflect:!0,type:Boolean}],required:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],status:[3,{},{reflect:!0}],suffixText:1,validationIcon:[3,{converter:_d},{reflect:!0}],validationMessage:1,validity:[0,{},{attribute:!1}],value:1},j1.styles=Bre;let fE=j1;lr("calcite-autocomplete",fE);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const J_={container:"container",containerNoSpacing:"container--no-spacing",heading:"heading",scale:t=>`scale--${t}`},Vre=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}.scale--s{font-size:var(--calcite-font-size--2);line-height:1rem;--calcite-internal-autocomplete-item-group-spacing-unit: .5rem}.scale--m{font-size:var(--calcite-font-size--1);line-height:1rem;--calcite-internal-autocomplete-item-group-spacing-unit: .75rem}.scale--l{font-size:var(--calcite-font-size-0);line-height:1.25rem;--calcite-internal-autocomplete-item-group-spacing-unit: 1rem}:host{margin:0;display:flex;flex-direction:column}.container{display:flex;flex-direction:column;background-color:var(--calcite-autocomplete-background-color, var(--calcite-color-foreground-1));padding-block-start:var(--calcite-internal-autocomplete-item-group-spacing-unit)}.container--no-spacing{padding-block-start:0}.heading{border:0 solid;box-sizing:border-box;inline-size:100%;min-inline-size:0px;max-inline-size:100%;border-block-end-width:1px;font-weight:var(--calcite-font-weight-bold);word-wrap:break-word;word-break:break-word;color:var(--calcite-autocomplete-text-color, var(--calcite-color-text-2));border-block-end-color:var(--calcite-autocomplete-border-color, var(--calcite-color-border-3));padding-block:var(--calcite-internal-autocomplete-item-group-spacing-unit);padding-inline:var(--calcite-internal-autocomplete-item-group-spacing-unit)}:host([hidden]){display:none}[hidden]{display:none}`,U1=class U1 extends Vi{constructor(){super(...arguments),this.disableSpacing=!1,this.scale="m"}render(){const{scale:e}=this;return Fe`<div aria-label=${this.label??this.heading??Ou} class=${Le({[J_.container]:!0,[J_.containerNoSpacing]:this.disableSpacing,[J_.scale(e)]:!0})} role=group><div class=${Le(J_.heading)} role=presentation>${this.heading}</div><slot></slot></div>`}};U1.properties={disableSpacing:[5,{},{type:Boolean}],heading:1,label:1,scale:1},U1.styles=Vre;let mE=U1;lr("calcite-autocomplete-item-group",mE);/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const w5={brand:"lightbulb",danger:"exclamationMarkTriangle",info:"information",success:"checkCircle",warning:"exclamationMarkTriangle"};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.3.3 */const K_={title:"title",message:"message",link:"link",actionsEnd:"actions-end"},sy={actionsEnd:"actions-end",close:"notice-close",container:"container",content:"notice-content",icon:"notice-icon"},Gre=Gi`:host{--calcite-internal-color-focus: var( --calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)) )}:host([scale=s]){--calcite-notice-spacing-token-small: .5rem;--calcite-notice-spacing-token-large: .75rem}:host([scale=s]) .container slot[name=title]::slotted(*),:host([scale=s]) .container *::slotted([slot=title]){margin-block:.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=s]) .container slot[name=message]::slotted(*),:host([scale=s]) .container *::slotted([slot=message]){margin-block:.125rem;font-size:var(--calcite-font-size--2);line-height:1.375}:host([scale=s]) ::slotted(calcite-link){margin-block:.125rem;font-size:var(--calcite-font-size--2);line-height:1.375}:host([scale=s]) .notice-close{padding:.5rem}:host([scale=m]){--calcite-notice-spacing-token-small: .75rem;--calcite-notice-spacing-token-large: 1rem}:host([scale=m]) .container slot[name=title]::slotted(*),:host([scale=m]) .container *::slotted([slot=title]){margin-block:.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([scale=m]) .container slot[name=message]::slotted(*),:host([scale=m]) .container *::slotted([slot=message]){margin-block:.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=m]) ::slotted(calcite-link){margin-block:.125rem;font-size:var(--calcite-font-size--1);line-height:1.375}:host([scale=l]){--calcite-notice-spacing-token-small: 1rem;--calcite-notice-spacing-token-large: 1.25rem}:host([scale=l]) .container slot[name=title]::slotted(*),:host([scale=l]) .container *::slotted([slot=title]){margin-block:.125rem;font-size:var(--calcite-font-size-1);line-height:1.375}:host([scale=l]) .container slot[name=message]::slotted(*),:host([scale=l]) .container *::slotted([slot=message]){margin-block:.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([scale=l]) ::slotted(calcite-link){margin-block:.125rem;font-size:var(--calcite-font-size-0);line-height:1.375}:host([width=auto]){--calcite-notice-width: auto}:host([width=half]){--calcite-notice-width: 50%}:host([width=full]){--calcite-notice-width: 100%}:host{margin-inline:auto;display:none;max-inline-size:100%;align-items:center;inline-size:var(--calcite-notice-width)}.container{pointer-events:none;margin-block:0px;box-sizing:border-box;display:flex;inline-size:100%;opacity:0;overflow:hidden;max-block-size:0;transition-property:opacity,max-block-size;transition-duration:var(--calcite-animation-timing);text-align:start;border-inline-start:var(--calcite-border-width-md) solid;box-shadow:0 0 0 0 transparent;background-color:var(--calcite-notice-background-color, var(--calcite-color-foreground-1))}.notice-close{outline-color:transparent}.notice-close:focus{outline:var(--calcite-border-width-md) solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)));outline:var(--calcite-border-width-md) solid var(--calcite-internal-color-focus);outline-offset:calc(calc(-1 * var(--calcite-spacing-base)) * calc(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}:host{display:flex}:host([open]) .container{pointer-events:auto;max-block-size:100%;align-items:center;opacity:1;--tw-shadow: 0 4px 8px -1px rgba(0, 0, 0, .08), 0 2px 4px -1px rgba(0, 0, 0, .04);--tw-shadow-colored: 0 4px 8px -1px var(--tw-shadow-color), 0 2px 4px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow);overflow:visible}.container slot[name=title]::slotted(*),.container *::slotted([slot=title]){margin:0;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-notice-title-text-color, var(--calcite-color-text-1))}.container slot[name=message]::slotted(*),.container *::slotted([slot=message]){margin:0;display:inline;font-weight:var(--calcite-font-weight-normal);margin-inline-end:var(--calcite-notice-spacing-token-small);color:var(--calcite-notice-content-text-color, var(--calcite-color-text-2))}.notice-content{box-sizing:border-box;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto;display:flex;min-inline-size:0px;flex-direction:column;overflow-wrap:break-word;flex:1 1 0;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:0 var(--calcite-notice-spacing-token-small)}.notice-content:first-of-type:not(:only-child){padding-inline-start:var(--calcite-notice-spacing-token-large)}.notice-content:only-of-type{padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large)}.notice-icon{display:flex;align-items:center;box-sizing:border-box;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto}.notice-close{display:flex;cursor:pointer;align-items:center;align-self:stretch;border-style:none;background-color:transparent;outline:2px solid transparent;outline-offset:2px;box-sizing:border-box;transition-property:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start,inset-size,opacity,outline-color,transform;transition-duration:var(--calcite-animation-timing);transition-timing-function:ease-in-out;padding-block:var(--calcite-notice-spacing-token-small);padding-inline:var(--calcite-notice-spacing-token-large);flex:0 0 auto;-webkit-appearance:none;color:var(--calcite-notice-close-icon-color, var(--calcite-color-text-3))}.notice-close:hover,.notice-close:focus{background-color:var(--calcite-notice-close-background-color-focus, var(--calcite-color-foreground-2));color:var(--calcite-notice-close-icon-color-hover, var(--calcite-color-text-1))}.notice-close:active{background-color:var(--calcite-notice-close-background-color-press, var(--calcite-color-foreground-3))}.actions-end{display:flex;align-self:stretch}:host([kind=brand]) .container{border-color:var(--calcite-color-brand)}:host([kind=brand]) .container .notice-icon{color:var(--calcite-color-brand)}:host([kind=info]) .container{border-color:var(--calcite-color-status-info)}:host([kind=info]) .container .notice-icon{color:var(--calcite-color-status-info)}:host([kind=danger]) .container{border-color:var(--calcite-color-status-danger)}:host([kind=danger]) .container .notice-icon{color:var(--calcite-color-status-danger)}:host([kind=success]) .container{border-color:var(--calcite-color-status-success)}:host([kind=success]) .container .notice-icon{color:var(--calcite-color-status-success)}:host([kind=warning]) .container{border-color:var(--calcite-color-status-warning)}:host([kind=warning]) .container .notice-icon{color:var(--calcite-color-status-warning)}:host([hidden]){display:none}[hidden]{display:none}`,V1=class V1 extends Vi{constructor(){super(...arguments),this.closeButton=Xn(),this.transitionProp="opacity",this.messages=go(),this.focusSetter=Rs()(this),this.hasActionEnd=!1,this.closable=!1,this.iconFlipRtl=!1,this.kind="brand",this.open=!1,this.scale="m",this.width="auto",this.calciteNoticeBeforeClose=vt({cancelable:!1}),this.calciteNoticeBeforeOpen=vt({cancelable:!1}),this.calciteNoticeClose=vt({cancelable:!1}),this.calciteNoticeOpen=vt({cancelable:!1})}async setFocus(e){return this.focusSetter(()=>this.el.querySelector("calcite-link")||this.closeButton.value,e)}async load(){this.requestedIcon=tm(w5,this.icon,this.kind)}willUpdate(e){e.has("open")&&(this.hasUpdated||this.open!==!1)&&Q0(this),(e.has("icon")||e.has("kind")&&(this.hasUpdated||this.kind!=="brand"))&&(this.requestedIcon=tm(w5,this.icon,this.kind))}onBeforeClose(){this.calciteNoticeBeforeClose.emit()}onBeforeOpen(){this.calciteNoticeBeforeOpen.emit()}onClose(){this.calciteNoticeClose.emit()}onOpen(){this.calciteNoticeOpen.emit()}setTransitionEl(e){e&&(this.transitionEl=e)}close(){this.open=!1}handleActionsEndSlotChange(e){this.hasActionEnd=$r(e)}render(){const e=Fe`<button .ariaLabel=${this.messages.close} class=${Le(sy.close)} @click=${this.close} ${hi(this.closeButton)}><calcite-icon icon=x .scale=${Ur(this.scale)}></calcite-icon></button>`;return Fe`<div class=${Le(sy.container)} ${hi(this.setTransitionEl)}>${this.requestedIcon?Fe`<div class=${Le(sy.icon)}><calcite-icon .flipRtl=${this.iconFlipRtl} .icon=${this.requestedIcon} .scale=${Ur(this.scale)}></calcite-icon></div>`:null}<div class=${Le(sy.content)}><slot name=${K_.title}></slot><slot name=${K_.message}></slot><slot name=${K_.link}></slot></div><div class=${Le(sy.actionsEnd)} .hidden=${!this.hasActionEnd}><slot name=${K_.actionsEnd} @slotchange=${this.handleActionsEndSlotChange}></slot></div>${this.closable?e:null}</div>`}};V1.properties={hasActionEnd:[16,{},{state:!0}],closable:[7,{},{reflect:!0,type:Boolean}],icon:[3,{converter:_d},{reflect:!0}],iconFlipRtl:[7,{},{reflect:!0,type:Boolean}],kind:[3,{},{reflect:!0}],messageOverrides:[0,{},{attribute:!1}],open:[7,{},{reflect:!0,type:Boolean}],scale:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]},V1.styles=Gre;let gE=V1;lr("calcite-notice",gE);function P(t,e,i,r){var o=arguments.length,h=o<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,i):r,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(d=t[a])&&(h=(o<3?d(h):o>3?d(e,i,h):d(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h}function ome(t,e,i){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,o;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],i&&(o=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");o&&(r=function(){try{o.call(this)}catch(h){return Promise.reject(h)}}),t.stack.push({value:e,dispose:r,async:i})}else i&&t.stack.push({async:!0});return e}var qre=typeof SuppressedError=="function"?SuppressedError:function(t,e,i){var r=new Error(i);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function ame(t){function e(h){t.error=t.hasError?new qre(h,t.error,"An error was suppressed during disposal."):h,t.hasError=!0}var i,r=0;function o(){for(;i=t.stack.pop();)try{if(!i.async&&r===1)return r=0,t.stack.push(i),Promise.resolve().then(o);if(i.dispose){var h=i.dispose.call(i.value);if(i.async)return r|=2,Promise.resolve(h).then(o,function(d){return e(d),o()})}else r|=1}catch(d){e(d)}if(r===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return o()}const S5=new WeakMap;function Hre(t,e,i=!1){const r=` DEPRECATED - ${e}`;if(!i)return void t.warn(r);let o=S5.get(t);o||(o=new Set,S5.set(t,o)),o.has(e)||(o.add(e),t.warn(r))}function lme(t,e,i={}){Ue("esri-deprecation-warnings")&&fm(t,`Module: ${e}`,i)}function sF(t,e,i={}){if(Ue("esri-deprecation-warnings")){const{moduleName:r}=i;fm(t,`Function: ${(r?r+"::":"")+e+"()"}`,i)}}function T5(t,e,i={}){if(Ue("esri-deprecation-warnings")){const{moduleName:r}=i;fm(t,`Property: ${(r?r+"::":"")+e}`,i)}}function Zre(t,e,i={}){Ue("esri-deprecation-warnings")&&fm(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...i})}function fm(t,e,i={}){if(Ue("esri-deprecation-warnings")){const{replacement:r,version:o,see:h,warnOnce:d}=i;let a=e;if(r&&(a+=`
	 Replacement: ${r}`),o&&(a+=`
	 Version: ${o}`),h)if(Array.isArray(h)){a+=`
	 See for more details:`;for(const v of h)a+=`
		${v}`}else a+=`
	 See ${h} for more details.`;Hre(t,a,d)}}function cme(t){const e=[];return function*(){yield*e;let i,r=e.length;for(;!(i=t.next()).done;)for(e.push(i.value),yield i.value;++r<e.length;)yield e[r]}}function ume(t,e){for(const i of t)if(i!=null&&e(i))return i}function C5(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let bP=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(i=>{e+=i.length}),e}add(e,i){if(C5(e)){const r=this._getOrCreateGroup(i);for(const o of e)I5(o)&&r.push(o)}else I5(e)&&this._getOrCreateGroup(i).push(e);return this}forEach(e,i){if(typeof e=="function")this._groups.forEach(r=>r.forEach(e));else{const r=this._getGroup(e);r&&i&&r.forEach(i)}}has(e){return this._groups.has(Q_(e))}remove(e){if(typeof e!="string"&&C5(e)){for(const i of e)this.remove(i);return this}return this.has(e)?(E5(this._getGroup(e)),this._groups.delete(Q_(e)),this):this}removeAll(){return this._groups.forEach(E5),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const i=[];return this._groups.set(Q_(e),i),i}_getGroup(e){return this._groups.get(Q_(e))}};function Q_(t){return t||"_default_"}function E5(t){for(const e of t)e instanceof bP?e.removeAll():e.remove()}function I5(t){return t!=null&&(!!t.remove||t instanceof bP)}const oF=Symbol("Accessor-beforeDestroy");function Dm(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const r in e)e[r]=ht(e[r]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function Dw(t,e){const i=Dm(t);let r=i[e];return r||(r=i[e]={}),r}function Wre(t,e){return wb(t,e,Xre)}const Yre=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Xre(t){return Yre.test(t)?"replace":"merge"}let $5=class extends HL{constructor(e,i){super(),this.propertyName=e,this.metadata=i,this.trackingTarget=new vw(this),this.flags=0,this.flags=Ki.Dirty|(i.nonNullable?Ki.NonNullable:0)|(i.hasOwnProperty("value")?Ki.HasDefaultValue:0)|(i.get===void 0?Ki.DepTrackingInitialized:0)|(i.dependsOn===void 0?Ki.AutoTracked:0)}destroy(){this.flags&Ki.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&Yt(this);const i=e.store,r=this.propertyName,o=this.flags,h=i.get(r);if(o&Ki.Computing||~o&Ki.Dirty&&i.has(r))return h;this.flags|=Ki.Computing;const d=e.host;let a;o&Ki.AutoTracked?a=bc(this.trackingTarget,this.metadata.get,d):(qL(d,this),a=this.metadata.get.call(d)),this.flags|=Ki.DepTrackingInitialized,i.set(r,a,1);const v=i.get(r);return v===h?this.flags&=-2:mQ(this.commit,this),this.flags&=-5,v}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&Ki.Overridden&&(this.flags|=Ki.Dirty);const e=this._observers;if(e&&e.length>0)for(const i of e)i.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onCommitted()}}};const pme=8;function aF(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"link-chart":return 6;case"user":return 7;default:return null}}function yE(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"link-chart";case 7:return"user"}}function Jre(t){return yE(t)}let Kre=class lF{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new lF;return this._values.forEach((r,o)=>{e&&e.has(o)||i.set(o,ht(r))}),i}get(e){return this._values.get(e)}originOf(){return 7}keys(){return[...this._values.keys()]}set(e,i){this._values.set(e,i)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,i){return this.has(e)}isBelowOrigin(e,i){return!this.has(e)}forEach(e){this._values.forEach(e)}};function Wp(t,e,i){return t!==void 0}function P5(t,e,i,r){return t!==void 0&&(!(i==null&&t.flags&Ki.NonNullable)||(r.lifecycle,!1))}let Qre=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=co.INITIALIZING,this.store=new Kre,this.mutable=!0,this._origin=7;const i=this.host.constructor.__accessorMetadata__;for(const r in i){const o=new $5(r,i[r]);this.propertiesByName.set(r,o)}this.metadata=i}initialize(){this.lifecycle=co.CONSTRUCTING}constructed(){this.lifecycle=co.CONSTRUCTED}destroy(){this.lifecycle=co.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==co.INITIALIZING}get(e){const i=this.propertiesByName.get(e);if(!Wp(i))return;if(i.metadata.get)return i.getComputed(this);this.mutable&&Yt(i);const r=this.store;return r.has(e)?r.get(e):i.metadata.value}originOf(e){const i=this.store.originOf(e);if(i===void 0){const r=this.propertiesByName.get(e);if(r!==void 0&&r.flags&Ki.HasDefaultValue)return"defaults"}return yE(i)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const i=this.propertiesByName.get(e);if(Wp(i))return this.store.has(e)?this.store.get(e):i.metadata.value}internalSet(e,i){const r=this.propertiesByName.get(e);Wp(r)&&this._internalSet(r,i)}getDependsInfo(e,i,r){const o=this.propertiesByName.get(i);if(!Wp(o))return"";const h=new vw,d=bc(h,()=>o.metadata.get?.call(e));let a=`${r}${e.declaredClass.split(".").pop()}.${i}: ${d}
`;const v=h.accessed??new Set;if(v.size===0)return a;r+="  ";for(const T of v)T instanceof $5&&(a+=`${r}${T.propertyName}: undefined
`);return a}setAtOrigin(e,i,r){const o=this.propertiesByName.get(e);if(Wp(o))return this._setAtOrigin(o,i,r)}isOverridden(e){const i=this.propertiesByName.get(e);return i!==void 0&&!!(i.flags&Ki.Overridden)}clearOrigin(e,i){const r=this.store,o=this.propertiesByName.get(e);if(!Wp(o))return;const h=r.isAtOrigin(e,i)&&!(o.flags&Ki.Overridden);r.delete(e,i),h&&o.notifyChange()}clearOverride(e){const i=this.propertiesByName.get(e);i&&i.flags&Ki.Overridden&&(i.flags&=-3,i.notifyChange())}override(e,i){const r=this.propertiesByName.get(e);if(!P5(r,e,i,this))return;const o=r.metadata.cast;if(o){const h=this._cast(o,i),{valid:d,value:a}=h;if(mT.release(h),!d)return;i=a}r.flags|=Ki.Overridden,this._internalSet(r,i)}set(e,i){const r=this.propertiesByName.get(e);if(!P5(r,e,i,this))return;const o=r.metadata.cast;if(o){const d=this._cast(o,i),{valid:a,value:v}=d;if(mT.release(d),!a)return;i=v}const h=r.metadata.set;h?h.call(this.host,i):this._internalSet(r,i)}setDefaultOrigin(e){this._origin=aF(e)}getDefaultOrigin(){return yE(this._origin)}notifyChange(e){const i=this.propertiesByName.get(e);i!==void 0&&i.notifyChange()}invalidate(e){const i=this.propertiesByName.get(e);i!==void 0&&i.invalidate()}commit(e){const i=this.propertiesByName.get(e);i!==void 0&&i.commit()}_internalSet(e,i){const r=this.lifecycle!==co.INITIALIZING?this._origin:0;this._setAtOrigin(e,i,r)}_setAtOrigin(e,i,r){const o=this.store,h=e.propertyName;if(o.isAtOrigin(h,r)&&j$(i,o.get(h))&&~e.flags&Ki.Overridden)return;const d=o.isBelowOrigin(h,r)||o.isAtOrigin(h,r);d&&e.invalidate(),o.set(h,i,r),d&&e.commit(),GL(this.host,e)}_cast(e,i){const r=mT.acquire();return r.valid=!0,r.value=i,e&&(r.value=e.call(this.host,i,r)),r}},ene=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const mT=new xw(()=>new ene);function h1(t,e,i){if(t&&e)if(typeof e=="object")for(const r of Object.getOwnPropertyNames(e))h1(t,r,e[r]);else{if(e.includes(".")){const o=e.split("."),h=o.splice(-1,1)[0];return void h1(cm(t,o),h,i)}const r=t.__accessor__;r!=null&&tne(e,r),t[e]=i}}function tne(t,e){if(Ue("esri-unknown-property-errors")&&!ine(t,e))throw new Lt("set:unknown-property",rne(t,e))}function ine(t,e){return e.metadata[t]!=null}function rne(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let nne;function sne(){return nne}const hd=()=>ui.getLogger("esri.core.accessorSupport.ensureTypes");function one(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(hd().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function ane(t){return t==null?t:!!t}function lne(t){return t==null?t:t.toString()}function zw(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function xP(t){return t==null?t:Math.round(parseFloat(t))}function cne(t){return null}function une(t,e){return i=>{let r=t(i);return e.step!=null&&(r=Math.round(r/e.step)*e.step),e.min!=null&&(r=Math.max(e.min,r)),e.max!=null&&(r=Math.min(e.max,r)),r}}function cF(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function d1(t,e){return e!=null&&t&&!(e instanceof t)}function uF(t){return t&&"isCollection"in t}function M5(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function hne(t,e){if(!e?.constructor||!uF(e.constructor))return vE(t,e)?e:new t(e);const i=M5(t.prototype.itemType),r=M5(e.constructor.prototype.itemType);return i?r?i===r?e:i.prototype.isPrototypeOf(r.prototype)?new t(e):(vE(t,e),e):new t(e):e}function vE(t,e){return!!cF(e)&&(hd().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+Ow(t)+"'"),!0)}function hF(t,e){return e==null?e:uF(t)?hne(t,e):d1(t,e)?vE(t,e)?e:new t(e):e}function Ow(t){return t?.prototype?.declaredClass||"unknown"}const dne=new WeakMap;function pne(t){switch(t){case Number:return e=>zw(e);case Pr:return xP;case Boolean:return ane;case String:return lne;case Date:return one;case wP:return cne;default:return H6(dne,t,()=>hF.bind(null,t))}}function Os(t,e){const i=pne(t);return arguments.length===1?i:i(e)}function M0(t,e,i){return arguments.length===1?M0.bind(null,t):e&&(Array.isArray(e)?e.map(r=>t(r,i)):[t(e,i)])}function fne(t,e){return arguments.length===1?M0(i=>Os(t,i)):M0(i=>Os(t,i),e)}function dF(t,e,i){return e!==0&&Array.isArray(i)?i.map(r=>dF(t,e-1,r)):t(i)}function p1(t,e,i){if(arguments.length===2)return h=>p1(t,e,h);if(!i)return i;i=dF(t,e,i);let r=e,o=i;for(;r>0&&Array.isArray(o);)r--,o=o[0];if(o!==void 0)for(let h=0;h<r;h++)i=[i];return i}function mne(t,e,i){return arguments.length===2?p1(r=>Os(t,r),e):p1(r=>Os(t,r),e,i)}function pF(t){return!!Array.isArray(t)&&!t.some(e=>{const i=typeof e;return!(i==="string"||i==="number"||i==="function"&&t.length>1)})}function _E(t,e){if(arguments.length===2)return _E(t).call(null,e);const i=new Set,r=t.filter(a=>typeof a!="function"),o=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||i.add(a);let h=null,d=null;return(a,v)=>{if(a==null)return a;const T=typeof a,E=T==="string"||T==="number";return E&&(i.has(a)||o.some(k=>T==="string"&&k===String||T==="number"&&k===Number))||T==="object"&&o.some(k=>!d1(k,a))?a:(E&&r.length?(h||(h=r.map(k=>typeof k=="string"?`'${k}'`:`${k}`).join(", ")),hd().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${h}`)):typeof a=="object"&&o.length?(d||(d=o.map(k=>Ow(k)).join(", ")),hd().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${d}`)):hd().error("Accessor#set",`'${a}' is not a valid value for this property`),v&&(v.valid=!1),null)}}function mm(t,e){if(arguments.length===2)return mm(t).call(null,e);const i={},r=[],o=[];for(const v in t.typeMap){const T=t.typeMap[v];i[v]=Os(T),r.push(Ow(T)),o.push(v)}const h=()=>`'${r.join("', '")}'`,d=()=>`'${o.join("', '")}'`,a=typeof t.key=="string"?v=>v[t.key]:t.key;return v=>{if(t.base&&!d1(t.base,v)||v==null)return v;const T=a(v)||t.defaultKeyValue,E=i[T];if(!E)return hd().error("Accessor#set",`Invalid property value, value needs to be one of ${h()}, or a plain object that can autocast (having .type = ${d()})`),null;if(!d1(t.typeMap[T],v))return v;if(typeof t.key=="string"&&!cF(v)){const k={};for(const L in v)L!==t.key&&(k[L]=v[L]);return E(k)}return E(v)}}let Pr=class{},wP=class{};const vme={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function gne(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function fF(t){switch(t.type){case"native":return Os(t.value);case"array":return M0(fF(t.value));case"one-of":return yne(t);default:return null}}function yne(t){let e=null;return(i,r)=>xE(i,t)?i:(e==null&&(e=bE(t)),hd().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),r&&(r.valid=!1),null)}function bE(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Pr:return"integer";case Date:return"date";case wP:return"null";default:return Ow(t.value)}case"array":return`array of ${bE(t.value)}`;case"one-of":{const e=t.values.map(i=>bE(i));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function xE(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case Pr:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case wP:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(i=>!xE(i,e.value));case"one-of":return e.values.some(i=>xE(t,i))}}function R(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,i),o=Dw(e,i);r&&(r.get||r.set?(o.get=r.get||o.get,o.set=r.set||o.set):"value"in r&&("value"in t&&ui.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),o.value=t.value=r.value)),t.readOnly!=null&&(o.readOnly=t.readOnly);const h=t.aliasOf;if(h){const v=typeof h=="string"?h:h.source,T=typeof h=="string"?null:h.overridable===!0;let E;o.dependsOn=[v],o.get=function(){let k=cm(this,v);if(typeof k=="function"){E||(E=v.split(".").slice(0,-1).join("."));const L=cm(this,E);L&&(k=k.bind(L))}return k},o.readOnly||(o.set=T?function(k){this._override(i,k)}:function(k){h1(this,v,k)})}const d=t.type,a=t.types;if(!o.cast){let v;d?v=vne(d):a&&(v=Array.isArray(a)?M0(mm(a[0])):mm(a)),t.cast=_ne(t.cast,v)}Wre(o,t),t.range&&(o.cast=une(o.cast,t.range))}}function mF(t,e,i){const r=Dw(t,i);r.json||(r.json={});let o=r.json;return e!==void 0&&(o.origins||(o.origins={}),o.origins[e]||(o.origins[e]={}),o=o.origins[e]),o}function vne(t){let e=0,i=t;if(gne(t))return fF(t);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],e++;const r=i;if(pF(r))return e===0?_E(r):p1(_E(r),e);if(e===1)return fne(r);if(e>1)return mne(r,e);const o=t;return o.from?o.from:Os(o)}function _ne(t,e){if(t||e)return t?e?(i,r)=>e(t(i,r),r):t:e}function bne(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const r in i)if(e[r]){const o=e[r];i[r].forEach(h=>{e[h]=o}),delete e[r]}}}let k0=class extends i4{constructor(e,i,r){super(e,i,r)}};k0.prototype.type="warning";function gF(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}function xne(t,e){return SP(t,"any",e?.origin)}function f1(t,e){return SP(t,"read",e?.origin)}function yF(t,e){return SP(t,"write",e?.origin)}function SP(t,e,i){let r=t?.json;if(r?.origins&&i){let o;o=i==="link-chart"?r.origins[i]&&(e==="any"||e in r.origins[i])?r.origins[i]:r.origins["web-map"]:r.origins[i],o&&(e==="any"||e in o)&&(r=o)}return r}const wE=()=>ui.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function k5(t,e,i){t&&(!i&&!e.read||e.read?.reader||e.read?.enabled===!1||Tne(t)&&Em("read.reader",vF(t),e))}function vF(t){const e=t.ndimArray??0;if(e>1)return Sne(t);if(e===1)return A5(t);if("type"in t&&bF(t.type)){const i=t.type.prototype?.itemType?.Type,r=A5(typeof i=="function"?{type:i}:{types:i});return(o,h,d)=>{const a=r(o,h,d);return a&&new t.type(a)}}return TP(t)}function TP(t){return"type"in t?wne(t.type):Cne(t.types)}function wne(t){return t.prototype.read?(e,i,r)=>{if(e==null)return e;const o=typeof e;if(o!=="object")return void wE().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${o}'`);const h=new t;return h.read(e,r),h}:t.fromJSON}function _F(t,e,i,r){return r!==0&&Array.isArray(e)?e.map(o=>_F(t,o,i,r-1)):t(e,void 0,i)}function Sne(t){const e=TP(t),i=_F.bind(null,e),r=t.ndimArray??0;return(o,h,d)=>{if(o==null)return o;o=i(o,d,r);let a=r,v=o;for(;a>0&&Array.isArray(v);)a--,v=v[0];if(v!==void 0)for(let T=0;T<a;T++)o=[o];return o}}function A5(t){const e=TP(t);return(i,r,o)=>{if(i==null)return i;if(Array.isArray(i)){const d=[];for(const a of i){const v=e(a,void 0,o);v!==void 0&&d.push(v)}return d}const h=e(i,void 0,o);return h!==void 0?[h]:void 0}}function bF(t){if(!gF(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?CP(e.Type):xF(e.Type))}function Tne(t){return"types"in t?xF(t.types):CP(t.type)}function CP(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||bF(t))}function xF(t){for(const e in t.typeMap)if(!CP(t.typeMap[e]))return!1;return!0}function Cne(t){let e=null;const i=t.errorContext??"type",r=t.validate;return(o,h,d)=>{if(o==null)return o;const a=typeof o;if(a!=="object")return void wE().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=Ine(t));const v=t.key;if(typeof v!="string")return;const T=o[Ene(v,e,d)],E=T?e[T]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!E){const L=`Type '${T||"unknown"}' is not supported`;return d?.messages&&o&&d.messages.push(new k0(`${i}:unsupported`,L,{definition:o,context:d})),void wE().error(L)}const k=new E;return k.read(o,d),r?r(k):k}}function Ene(t,e,i){const r=Object.values(e)[0],o=Dm(r.prototype)[t],h=f1(o,i),d=h?.read?.source;return d&&typeof d=="string"?d:t}function Ine(t){const e={};for(const i in t.typeMap){const r=t.typeMap[i],o=Dm(r.prototype);if(typeof t.key=="function")continue;const h=o[t.key];if(!h)continue;if(h.json?.type&&Array.isArray(h.json.type)&&h.json.type.length===1&&typeof h.json.type[0]=="string"){e[h.json.type[0]]=r;continue}const d=h.json?.write;if(!d?.writer){e[i]=r;continue}const a=d.target,v=typeof a=="string"?a:t.key,T={};d.writer(i,T,v),T[v]&&(e[T[v]]=r)}return e}function $ne(t){if(t.json||(t.json={}),z5(t.json),O5(t.json),D5(t.json),t.json.origins)for(const e in t.json.origins)z5(t.json.origins[e]),O5(t.json.origins[e]),D5(t.json.origins[e]);return!0}function D5(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function z5(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function O5(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function R5(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const i=t?.ndimArray??0;t&&(i===1||"type"in t&&gF(t.type))?e.write.writer=Ane:i>1?e.write.writer=Dne(i):e.types?Array.isArray(e.types)?e.write.writer=Mne(e.types[0]):e.write.writer=Pne(e.types):e.write.writer=A0}function Pne(t){return(e,i,r,o)=>e?wF(e,t,o)?A0(e,i,r,o):void 0:A0(e,i,r,o)}function wF(t,e,i){for(const r in e.typeMap)if(t instanceof e.typeMap[r])return!0;if(i?.messages){const r=e.errorContext??"type",o=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new Lt(`${r}:unsupported`,o,{definition:t,context:i})),ui.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(o)}return!1}function Mne(t){return(e,i,r,o)=>!e||!Array.isArray(e)?A0(e,i,r,o):A0(e.filter(h=>wF(h,t,o)),i,r,o)}function A0(t,e,i,r){Em(i,m1(t,r),e)}function m1(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?kne(t):t}function kne(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function Ane(t,e,i,r){let o;t===null?o=null:t&&typeof t.map=="function"?(o=t.map(h=>m1(h,r)),typeof o.toArray=="function"&&(o=o.toArray())):o=[m1(t,r)],Em(i,o,e)}function SF(t,e,i){return i!==0&&Array.isArray(t)?t.map(r=>SF(r,e,i-1)):m1(t,e)}function Dne(t){return(e,i,r,o)=>{let h;if(e===null)h=null;else{h=SF(e,o,t);let d=t,a=h;for(;d>0&&Array.isArray(a);)d--,a=a[0];if(a!==void 0)for(let v=0;v<d;v++)h=[h]}Em(r,h,i)}}function zne(t){const e=One(t);if(t.json.origins)for(const i in t.json.origins){const r=t.json.origins[i],o=r.types?Rne(r):e;k5(o,r,!1),r.types&&!r.write&&t.json.write?.enabled&&(r.write={...t.json.write}),R5(o,r)}k5(e,t.json,!0),R5(e,t.json)}function One(t){return t.json.types?SE(t.json):t.type?TF(t):SE(t)}function Rne(t){return t.type?TF(t):SE(t)}function TF(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!pF(i);)i=i[0],e++;return{type:i,ndimArray:e}}function SE(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function Lne(t){$ne(t)&&(bne(t),zne(t))}const gT=new Set,yT=new Set;function Ve(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,Nne(e);const i=[],r=[];let o=e.prototype;for(;o;)o.hasOwnProperty("initialize")&&!gT.has(o.initialize)&&(gT.add(o.initialize),i.push(o.initialize)),o.hasOwnProperty("destroy")&&!yT.has(o.destroy)&&(yT.add(o.destroy),r.push(o.destroy)),o=Object.getPrototypeOf(o);gT.clear(),yT.clear();const h=class extends e{constructor(...a){if(super(...a),this.constructor===h&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let v=i.length-1;v>=0;v--)i[v].call(this)}}),r.length){let v=!1;const T=this[oF];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!v){this.__accessor__.lifecycle=co.DESTROYING,v=!0,T.call(this);for(let E=0;E<r.length;E++)r[E].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};h.__accessorMetadata__=Dm(e.prototype),h.prototype.declaredClass=t;const d=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(h,"name",{value:d,configurable:!0}),h}}function Fne(t,e){return e.get==null?function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r===void 0)return;i.mutable&&Yt(r);const o=i.store;return o.has(t)?o.get(t):r.metadata.value}:function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r!==void 0)return r.getComputed(i)}}function Nne(t){const e=t.prototype,i=Dm(e),r={};for(const o of Object.getOwnPropertyNames(i)){const h=i[o];Lne(h),r[o]={enumerable:!0,configurable:!0,get:Fne(o,h),set(d){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&h.readOnly?L5("read-only",o):a.lifecycle===co.CONSTRUCTED&&h.constructOnly?L5("construct-only",o):void a.set(o,d)}else Object.defineProperty(this,o,{enumerable:!0,configurable:!0,writable:!0,value:d})}}}Object.defineProperties(t.prototype,r)}const L5=(t,e)=>{ui.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var F5,N5;function Bne(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const ou=Symbol("Accessor-Handles"),vT=Symbol("Accessor-Initialized");var Bu;let Ln=(Bu=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:r,constructor:o}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const h=this;class d extends h{constructor(...v){super(...v),this.inherited=null,o&&o.apply(this,v)}}Dm(d.prototype);for(const a in e){const v=e[a];d.prototype[a]=typeof v=="function"?function(...T){const E=this.inherited;let k;this.inherited=function(...L){if(h.prototype[a])return h.prototype[a].apply(this,L)};try{k=v.apply(this,T)}catch(L){throw this.inherited=E,L}return this.inherited=E,k}:e[a]}for(const a in i){const v=Bne(i[a]);R(v)(d.prototype,a)}return Ve(r)(d)}static freeze(e){return e instanceof Bu?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof Bu?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[F5]=null,this[N5]=!1,this.constructor===Bu)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new Qre(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),e.length>0&&(i.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,i=e.ctorArgs;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize(),this[vT]=!0}initialize(){}[oF](){this[ou]=Cb(this[ou])}destroy(){this.destroyed||(YQ(this),this.__accessor__.destroy(),sne()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[vT]}get destroyed(){return this.__accessor__?.lifecycle===co.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===co.DESTROYING||!1}commitProperty(e){cm(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,i){return h1(this,e,i),this}watch(e,i,r){return sF(ui.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),tee(this,e,i,r)}addHandles(e,i){if(this.destroyed){const r=Array.isArray(e)?e:[e];for(const o of r)o.remove();return}(this[ou]??=new bP).add(e,i)}removeHandles(e){this[ou]?.remove(e)}removeAllHandles(){this[ou]?.removeAll()}removeHandlesReference(e){this[ou]?.removeReference(e)}hasHandles(e){return this[ou]?.has(e)===!0}_override(e,i){i===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,i){i==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,i){return this.__accessor__.internalSet(e,i),this}},F5=ou,N5=vT,Bu);const jne=Symbol("ClonableMixin"),ys=t=>{var o;var e;const i=t;let r=(o=class extends i{constructor(){super(...arguments),this[e]=!0}clone(h){const d=Uu(this);t4(d,"unable to clone instance of non-accessor class");const a=d.metadata,v=d.store,T={},E=new Map;for(const L in a){const O=a[L],H=v?.originOf(L),ie=O.clonable;if(O.readOnly||ie===!1||H!==7&&H!==0&&H!==5&&H!==4)continue;const pe=this[L];let be=null;if(typeof ie=="function")be=ie(pe,h);else if(ie==="reference")be=pe;else if(be=UC(pe,h),pe!=null&&be==null)continue;H===0?E.set(L,be):T[L]=be}const k=new(Object.getPrototypeOf(this)).constructor(T);if(E.size){const L=Uu(k)?.store;if(L)for(const[O,H]of E)L.set(O,H,0)}return k}},e=jne,o);return r=P([Ve("esri.core.Clonable")],r),r},bme=ys(Ln),EP=t=>{const e=t;class i extends e{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(o,h){let d=this._listenersMap?.get(o);if(!d)return!1;let a=!1;for(const v of d.slice()){const T="deref"in v?v.deref():v;T?T?.call(this,h):a=!0}return a&&(d=d.filter(v=>!("deref"in v)||v.deref()!=null),this._listenersMap.set(o,d)),d.length>0}on(o,h){if(Array.isArray(o)){const a=o.map(v=>this.on(v,h));return V$(a)}if(o.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const d=this._listenersMap.get(o)||[];return d.push(h),this._listenersMap.set(o,d),hn(()=>{const a=this._listenersMap?.get(o),v=a?.indexOf(h)??-1;v>=0&&a.splice(v,1)})}once(o,h){const d=this.on(o,a=>{d.remove(),("deref"in h?h.deref():h)?.call(null,a)});return d}hasEventListener(o){const h=this._listenersMap?.get(o);return h!=null&&h.length>0}}return i},Une=EP(class{}),xme=Une,CF=EP(Ln);function Vne(t){return(e,i)=>{e[i]=t}}var tc;let Gne=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},qne=class{constructor(e,i,r,o,h){this.target=e,this.added=i,this.removed=r,this.start=o,this.deleteCount=h}};const ko=new xw(()=>new Gne,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function B5(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function _T(t){return t?t instanceof wu?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function bT(t){if(t?.length)return t[0]}function Hne(t,e,i,r){const o=Math.min(t.length-i,e.length-r);let h=0;for(;h<o&&t[i+h]===e[r+h];)h++;return h}function EF(t,e,i,r){e&&e.forEach((o,h,d)=>{t.push(o),EF(t,i.call(r,o,h,d),i,r)})}const au=new Set,lu=new Set,cu=new Set,xT=new Map;let Zne=0,wu=tc=class extends CF{static ofType(t){if(!t)return tc;if(xT.has(t))return xT.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const r in t.typeMap){const o=t.typeMap[r].prototype.declaredClass;e?e+=` | ${o}`:e=o}let i=class extends tc{};return P([Vne({Type:t,ensureType:typeof t=="function"?Os(t):mm(t)})],i.prototype,"itemType",void 0),i=P([Ve(`esri.core.Collection<${e}>`)],i),xT.set(t,i),i}static isCollection(t){return t!=null&&t instanceof tc}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new ZL,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Zne++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof tc?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),super.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return Yt(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,_T(t)),this._emitAfterChanges(1))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:super.hasEventListener(t))}on(t,e){if(this.destroyed)return hn();if(t==="change"){const i=this._chgListeners,r={removed:!1,callback:e};return i.push(r),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),hn(()=>{r.removed=!0,i.splice(i.indexOf(r),1)})}return super.on(t,e)}once(t,e){const i="deref"in e?()=>e.deref():()=>e,r=this.on(t,o=>{i()?.call(null,o),r.remove()});return r}add(t,e){if(Yt(this._observable),this._emitBeforeChanges(1))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(Yt(this._observable),!t?.length)return this;if(this._emitBeforeChanges(1))return this;const i=this.getNextIndex(e);return this._splice(i,0,_T(t)),this._emitAfterChanges(1),this}at(t){if(Yt(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(Yt(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._removeAllRaw();return this._emitAfterChanges(2),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return Yt(this._observable),this._createNewInstance({items:this._items.map(ht)})}concat(...t){Yt(this._observable);const e=t.map(_T);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(Yt(this._observable),!this.length||this._emitBeforeChanges(2))return;const i=this._splice(0,this.length),r=i.length;for(let o=0;o<r;o++)t.call(e,i[o],o,i);this._emitAfterChanges(2)}destroyAll(){this.drain(B5)}destroyMany(t){const e=this.removeMany(t);return e.forEach(B5),e}every(t,e){return Yt(this._observable),this._items.every(t,e)}filter(t,e){Yt(this._observable);const i=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:i})}find(t,e){return Yt(this._observable),this._items.find(t,e)}findIndex(t,e){return Yt(this._observable),this._items.findIndex(t,e)}flatten(t,e){Yt(this._observable);const i=[];return EF(i,this,t,e),new tc(i)}forEach(t,e){return Yt(this._observable),this._items.forEach(t,e)}getItemAt(t){return Yt(this._observable),this._items[t]}getNextIndex(t){Yt(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return Yt(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return Yt(this._observable),this._items.indexOf(t,e)}join(t=","){return Yt(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return Yt(this._observable),this._items.lastIndexOf(t,e)}map(t,e){Yt(this._observable);const i=this._items.map(t,e);return new tc({items:i})}reorder(t,e=this.length-1){Yt(this._observable);const i=this.indexOf(t);if(i!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(4))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(4)}return t}}pop(){if(Yt(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=bT(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return Yt(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,t),this._emitAfterChanges(1)),this.length}reduce(t,e){Yt(this._observable);const i=this._items;return arguments.length===2?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){Yt(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return Yt(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(Yt(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=bT(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(Yt(this._observable),!t?.length||this._emitBeforeChanges(2))return[];const e=t instanceof tc?t.toArray():t,i=this._items,r=[],o=e.length;for(let h=0;h<o;h++){const d=e[h],a=i.indexOf(d);if(a>-1){const v=1+Hne(e,i,h+1,a+1),T=this._splice(a,v);T&&T.length>0&&r.push.apply(r,T),h+=v-1}}return this._emitAfterChanges(2),r}reverse(){if(Yt(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(4),this}shift(){if(Yt(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=bT(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return Yt(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return Yt(this._observable),this._items.some(t,e)}sort(t){if(Yt(this._observable),!this.length||this._emitBeforeChanges(4)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(4),this}_requiresSort(t=(e,i)=>e===i?0:e<i?-1:1){const e=this.length-1;for(let i=0;i<e;i++)if(t(this.items[i],this.items[i+1])>0)return!0;return!1}splice(t,e,...i){Yt(this._observable),arguments.length===1&&(e=this.length),e??=0;const r=(e?2:0)|(i.length?1:0);if(this._emitBeforeChanges(r))return[];const o=this._splice(t,e,i)||[];return this._emitAfterChanges(r),o}toArray(){return Yt(this._observable),this._items.slice()}toJSON(t){return Yt(this._observable),this.toArray().map(e=>o1(e)?e.toJSON(t):e)}toLocaleString(){return Yt(this._observable),this._items.toLocaleString()}toString(){return Yt(this._observable),this._items.toString()}unshift(...t){return Yt(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const r=this._items,o=this.itemType;let h,d;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=u4(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(d=r.splice(t,e),this.hasEventListener("before-remove")){const a=ko.acquire();a.target=this,a.cancellable=!0;for(let v=0,T=d.length;v<T;v++)h=d[v],a.reset(h),this.emit("before-remove",a),a.defaultPrevented&&(d.splice(v,1),r.splice(t,0,h),t+=1,v-=1,T-=1);ko.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=ko.acquire();a.target=this,a.cancellable=!1;const v=d.length;for(let T=0;T<v;T++)a.reset(d[T]),this.emit("after-remove",a);ko.release(a)}}if(i?.length){if(o){const E=[];for(const k of i){const L=o.ensureType(k);L==null&&k!=null||E.push(L)}i=E}const a=this.hasEventListener("before-add"),v=this.hasEventListener("after-add"),T=t===this.length;if(a||v){const E=ko.acquire();E.target=this,E.cancellable=!0;const k=ko.acquire();k.target=this,k.cancellable=!1;for(const L of i)a?(E.reset(L),this.emit("before-add",E),E.defaultPrevented||(T?r.push(L):r.splice(t++,0,L),this._set("length",r.length),v&&(k.reset(L),this.emit("after-add",k)))):(T?r.push(L):r.splice(t++,0,L),this._set("length",r.length),k.reset(L),this.emit("after-add",k));ko.release(k),ko.release(E)}else{if(T)for(const E of i)r.push(E);else r.splice(t,0,...i);this._set("length",r.length)}}if((i?.length||d?.length)&&this._notifyChangeEvent(i,d),this.hasEventListener("after-splice")){const a=new qne(this,i,d,t,e);this.emit("after-splice",a)}return d}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=ko.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,ko.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=ko.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),ko.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const i=e.changes;au.clear(),lu.clear(),cu.clear();for(const{added:v,removed:T}of i){if(v)if(cu.size===0&&lu.size===0)for(const E of v)au.add(E);else for(const E of v)lu.has(E)?(cu.add(E),lu.delete(E)):cu.has(E)||au.add(E);if(T)if(cu.size===0&&au.size===0)for(const E of T)lu.add(E);else for(const E of T)au.has(E)?au.delete(E):(cu.delete(E),lu.add(E))}const r=_u.acquire();au.forEach(v=>{r.push(v)});const o=_u.acquire();lu.forEach(v=>{o.push(v)});const h=this._items,d=e.items,a=_u.acquire();if(cu.forEach(v=>{d.indexOf(v)!==h.indexOf(v)&&a.push(v)}),e.listeners&&(r.length||o.length||a.length)){const v={target:this,added:r,removed:o,moved:a},T=e.listeners.length;for(let E=0;E<T;E++){const k=e.listeners[E];k.removed||k.callback.call(this,v)}}_u.release(r),_u.release(o),_u.release(a)}au.clear(),lu.clear(),cu.clear()}};P([R()],wu.prototype,"_updating",void 0),P([R()],wu.prototype,"length",void 0),P([R()],wu.prototype,"items",null),P([R({readOnly:!0})],wu.prototype,"updating",null),wu=tc=P([Ve("esri.core.Collection")],wu);const sr=wu;let Wne=class IF{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new IF;return this._values.forEach((r,o)=>{e&&e.has(o)||i.set(o,ht(r.value),r.origin)}),i}get(e,i){i=this._normalizeOrigin(i);const r=this._values.get(e);return i==null||r?.origin===i?r?.value:void 0}originOf(e){return this._values.get(e)?.origin??7}keys(e){e=this._normalizeOrigin(e);const i=[...this._values.keys()];return e==null?i:i.filter(r=>this._values.get(r)?.origin===e)}set(e,i,r){if((r=this._normalizeOrigin(r))===0){const o=this._values.get(e);if(o?.origin!=null&&o.origin>r)return}this._values.set(e,new Yne(i,r))}delete(e,i){(i=this._normalizeOrigin(i))!=null&&this._values.get(e)?.origin!==i||this._values.delete(e)}has(e,i){return(i=this._normalizeOrigin(i))!=null?this._values.get(e)?.origin===i:this._values.has(e)}isAtOrigin(e,i){return i=this._normalizeOrigin(i),this.has(e,i)&&this.originOf(e)===i}isBelowOrigin(e,i){return i=this._normalizeOrigin(i),!this.has(e)||this.originOf(e)<i}forEach(e){this._values.forEach(({value:i},r)=>e(i,r))}_normalizeOrigin(e){if(e!=null)return e===0?e:7}},Yne=class{constructor(e,i){this.value=e,this.origin=i}};function Xne(t,e,i){e.keys().forEach(o=>{i.set(o,e.get(o),0)});const r=t.metadata;Object.keys(r).forEach(o=>{t.internalGet(o)&&i.set(o,t.internalGet(o),0)})}function Jne(t,e,i){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const r=t.read.source;if(typeof r=="string"){if(r===e||r.includes(".")&&r.startsWith(e)&&_D(r,i))return!0}else for(const o of r)if(o===e||o.includes(".")&&o.startsWith(e)&&_D(o,i))return!0;return!1}function Kne(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function Qne(t,e,i,r,o){let h=f1(e[i],o);Kne(h)&&(t[i]=!0);for(const d of Object.getOwnPropertyNames(e))h=f1(e[d],o),Jne(h,i,r)&&(t[d]=!0)}function ese(t,e,i,r){const o=i.metadata,h=xne(o[e],r),d=h?.default;if(d===void 0)return;const a=typeof d=="function"?d.call(t,e,r):d;a!==void 0&&i.set(e,a)}const $F={origin:"service"};function tse(t,e,i=$F){if(!e||typeof e!="object")return;const r=Uu(t),o=r.metadata,h={};for(const d of Object.getOwnPropertyNames(e))Qne(h,o,d,e,i);r.setDefaultOrigin(i.origin);for(const d of Object.getOwnPropertyNames(h)){const a=f1(o[d],i).read,v=a?.source;let T;T=v&&typeof v=="string"?sv(e,v):e[d],a?.reader&&(T=a.reader.call(t,T,e,i)),T!==void 0&&r.set(d,T)}if(!i||!i.ignoreDefaults){r.setDefaultOrigin("defaults");for(const d of Object.getOwnPropertyNames(o))h[d]||ese(t,d,r,i)}r.setDefaultOrigin("user")}function Cme(t,e,i,r=$F){const o={...r,messages:[]};i(o),o.messages?.forEach(h=>{h.type!=="warning"||t.loaded?r?.messages&&r.messages.push(h):t.loadWarnings.push(h)})}function ise(t,e,i,r,o){const h={};return e.write?.writer?.call(t,r,h,i,o),h}function PF(t,e,i,r,o,h){if(!r?.write)return!1;const d=cm(t,i);if(!o&&r.write.overridePolicy){const a=r.write.overridePolicy.call(t,d,i,h??void 0);a!==void 0&&(o=a)}if(o||(o=r.write),!o||o.enabled===!1||o.layerContainerTypes&&h?.layerContainerType&&!o.layerContainerTypes.includes(h.layerContainerType))return!1;if((d===null&&!o.allowNull&&!o.writerEnsuresNonNull||d===void 0)&&o.isRequired){const a=new Lt("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return a&&h?.messages?h.messages.push(a):a&&!h&&ui.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(d===void 0||d===null&&!o.allowNull&&!o.writerEnsuresNonNull||!o.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===0)&&rse(t,i,h,r,d)||!o.ignoreOrigin&&h?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(i)<aF(h.origin))}function rse(t,e,i,r,o){const h=r.default;if(h===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(o);if(typeof h=="function"){if(Array.isArray(o)){const d=h.call(t,e,i??void 0);return fw(d,o)}return!1}return h===o}function Eme(t,e,i,r){const o=Uu(t),h=o.metadata,d=yF(h[e],r);return!!d&&PF(t,o,e,d,i,r)}function nse(t,e,i){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return wb(e,t.toJSON(i));const r=Uu(t),o=r.metadata;for(const h in o){const d=yF(o[h],i);if(!PF(t,r,h,d,void 0,i))continue;const a=cm(t,h),v=ise(t,d,d.write&&typeof d.write.target=="string"?d.write.target:h,a,i);Object.keys(v).length>0&&(e=wb(e,v),i?.resources?.pendingOperations?.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then(()=>wb(e,v,()=>"replace-arrays"))),i?.writtenProperties&&i.writtenProperties.push({target:t,propName:h,oldOrigin:Jre(r.store.originOf(h)),newOrigin:i.origin}))}return e}const MF=t=>{const e=t;let i=class extends e{constructor(...r){super(...r);const o=Uu(this),h=o.store,d=new Wne;o.store=d,Xne(o,h,d)}read(r,o){tse(this,r,o)}write(r,o){return nse(this,r??{},o)}toJSON(r){return this.write({},r)}static fromJSON(r,o){return sse.call(this,r,o)}};return i=P([Ve("esri.core.JSONSupport")],i),i.prototype.toJSON.isDefaultToJSON=!0,i};function sse(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}const Nt=MF(Ln),ose=Object.prototype.toString;function ase(t){const e="__accessorMetadata__"in t?Os(t):t;return function(...i){if(i.push(e),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return lse.apply(this,i)}}function lse(t,e,i,r){Dw(t,e).cast=r}function cse(t){return(e,i)=>{Dw(e,t).cast=e[i]}}function dv(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&ose.call(t[0])==="[object Function]"?ase(t[0]):t.length===1&&typeof t[0]=="string"?cse(t[0]):void 0}function Br(t,e,i){let r,o;return e===void 0||Array.isArray(e)?(o=t,i=e,r=[void 0]):(o=e,r=Array.isArray(t)?t:[t]),(h,d)=>{const a=h.constructor.prototype;r.forEach(v=>{const T=mF(h,v,o);T.read&&typeof T.read=="object"||(T.read={}),T.read.reader=a[d],i&&(T.read.source=(T.read.source||[]).concat(i))})}}function Ui(t,e,i){let r,o;return e===void 0?(o=t,r=[void 0]):typeof e!="string"?(o=t,r=[void 0],i=e):(o=e,r=Array.isArray(t)?t:[t]),(h,d)=>{const a=h.constructor.prototype;for(const v of r){const T=mF(h,v,o);T.write&&typeof T.write=="object"||(T.write={}),i&&(T.write.target=i),T.write.writer=a[d]}}}let wT;async function use(){return wT==null&&(wT=Qn(()=>import("./WhereClauseCache-BghMSzDu.js"),__vite__mapDeps([11,12,13,14,15,16,1,2,3])).then(t=>new t.WhereClauseCache(500,500))),wT}async function hse(t,e){const i=await use(),r=i.get(t,e);if(r==null)throw i.getError(t,e);return r}function Ime(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function $me(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function Pme(t){return typeof t=="number"}function Mme(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function kme(t){return typeof t=="boolean"}function pv(t){return typeof t=="string"||t instanceof String}function dse(t){return t==null||pv(t)}function Ame(t){return Array.isArray(t)}function Dme(t){return t?.declaredClass==="esri.Graphic"}function zme(t){return t instanceof Date}const pse="HH:mm",fse="HH:mm:ss",mse="HH:mm:ss.SSS",gse=[mse,fse,pse,"TT"],yse="yyyy-MM-dd";function j5(t){if(!t||!pv(t))return null;const e=Rt.fromFormat(t,yse);return e.isValid?e:null}function U5(t){return t&&pv(t)?Xx(gse,e=>{const i=Rt.fromFormat(t,e);return i.isValid?i:null})??null:null}function V5(t){if(!t||!pv(t))return null;const e=Rt.fromISO(t);return e.isValid?e:null}const kF=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function vse(t){return t!=null&&kF.has(t.type)}function AF(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function DF(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function zF(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const _se=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);h4(kF,_se);function Ome(t,e){const i=t?.domain;if(!i||i.type!=="range")return;const r="range"in i?i.range[0]:i.minValue,o="range"in i?i.range[1]:i.maxValue,h=vse(t);return AF(t)||zF(t)||DF(t)?{...bse(t,o,r),isInteger:h}:{min:r!=null&&typeof r=="number"?r:null,max:o!=null&&typeof o=="number"?o:null,rawMin:r,rawMax:o,isInteger:h}}function bse(t,e,i){return AF(t)?{min:j5(i)?.toMillis(),max:j5(e)?.toMillis(),rawMin:i,rawMax:e}:zF(t)?{min:U5(i)?.toMillis(),max:U5(e)?.toMillis(),rawMin:i,rawMax:e}:DF(t)?{min:V5(i)?.toMillis(),max:V5(e)?.toMillis(),rawMin:i,rawMax:e}:{max:null,min:null}}function xse(t){if(!t)return;const e=t.match(wse);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const wse=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-z_][a-z0-9_]*))$/i;function Rme(t){return t.match(Sse)?.[1]?.replaceAll("\\'","'")??null}const Sse=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let ST;function Tse(){return ST||(ST=(async()=>{const[t,e,i]=await Promise.all([Qn(()=>import("./arcadeUtils-3DzgGix_.js").then(r=>r.q),__vite__mapDeps([17,1,2,18,16,14,15,19,20,21,22,23,24,25,26,27,13,28,29,3,5,30,31,32])),Qn(()=>import("./batchExec-Bed1a-vU.js"),__vite__mapDeps([33,7,8,9,10,1,2,3])),Qn(()=>import("./aiServices-DkaQr_nw.js").then(r=>r.ay),__vite__mapDeps([18,16,14,15,19,20,21]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:i,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel,Pixel:t.Pixel}})()),ST}const Cse=/^([0-9_])/,Ese=/[^a-z0-9_\u0080-\uffff]+/gi;function Lme(t){return t==null?null:t.trim().replaceAll(Ese,"_").replace(Cse,"F$1")||null}const Ise=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],$se=["field","normalizationField"];function Fme(t,e){if(t!=null&&e!=null){for(const i of Array.isArray(t)?t:[t])if(G5(Ise,i,e),"visualVariables"in i&&i.visualVariables)for(const r of i.visualVariables)G5($se,r,e)}}function G5(t,e,i){if(t)for(const r of t){const o=yw(r,e),h=o&&typeof o!="function"&&i.get(o);h&&Em(r,h.name,e)}}function Nme(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const i=e.get(t.startField),r=e.get(t.endField);t.startField=i?.name??null,t.endField=r?.name??null}else{const i=e.get(t.startTimeField),r=e.get(t.endTimeField);t.startTimeField=i?.name??null,t.endTimeField=r?.name??null}}const TT=new Set;function OF(t,e){return t&&e?(TT.clear(),IP(TT,t,e),Array.from(TT).sort()):[]}function IP(t,e,i){if(i)if(e?.fields?.length)if(i.includes("*"))for(const{name:r}of e.fields)t.add(r);else for(const r of i)TE(t,e,r);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const r of i)r!=null&&t.add(r)}}function TE(t,e,i){if(typeof i=="string")if(e){const r=e.get(i);r&&t.add(r.name)}else t.add(i)}function Bme(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(i=>i.name):e}async function RF(t,e,i,r){if(!r)return;const o=xse(r);if(o)TE(t,e,o);else{const{arcadeUtils:h}=await Tse(),d=h.extractFieldNames(r,i?.partitions??e?.fields?.map(a=>a.name));for(const a of d)TE(t,i?.index??e,a)}}async function jme(t,e,i){if(i&&i!=="1=1"){const r=await hse(i,e);if(!r.isStandardized)throw new Lt("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});IP(t,e,r.fieldNames)}}function Ume({displayField:t,fields:e}){return t||(e?.length?Pse(e):null)}function Pse(t){return CT(t,"name-or-title")||CT(t,"unique-identifier")||CT(t,"type-or-category")||Mse(t)}function Mse(t){for(const e of t){if(!e?.name)continue;const i=e.name.toLowerCase();if(i.includes("name")||i.includes("title"))return e.name}return null}function CT(t,e){for(const i of t)if(i?.valueType&&i.valueType===e)return i.name;return null}function Vme(t){return t?OF(t.fieldsIndex,LF(t)):[]}function kse(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?OF(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}const Ase=new Set(["oid","global-id","guid"]),Dse=new Set(["oid","global-id"]),zse=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function Ose(t){const e=new Set;FF(t).forEach(r=>e.add(r)),kse(t).forEach(r=>e.add(r.toLowerCase()));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach(r=>e.add(r.toLowerCase())),Object.values(i.transformFieldRoles).forEach(r=>e.add(r.toLowerCase()))),Array.from(e)}function LF(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:r,editDateField:o,editorField:h}=e;return[i,r,o,h].filter(Boolean)}function FF(t){return LF(t).map(e=>e.toLowerCase())}function Gme(t,e){return t.editable&&!Ase.has(t.type)&&!FF(e).includes(t.name?.toLowerCase()??"")}function qme(t,e){const i=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&i===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&i===e.globalIdField.toLowerCase()||Ose(e).includes(i)||Dse.has(t.type)||zse.some(r=>r.test(i)))}function Hme(t){const e=t.defaultValue;return e!==void 0&&BF(t,e)?e:t.nullable?null:void 0}function Zme(t){const e=typeof t=="string"?{type:t}:t;return qse(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function NF(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function Rse(t){return t===null||NF(t)}function Lse(t){return t===null||Number.isInteger(t)}function Fse(){return!0}function BF(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=t.nullable?Lse:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?Rse:NF;break;case"string":case"esriFieldTypeString":i=t.nullable?dse:pv;break;default:i=Fse}return arguments.length===1?i:i(e)}const Nse=["integer","small-integer","big-integer","long"],Bse=["single","double"],jse=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],Use=["esriFieldTypeSingle","esriFieldTypeDouble"],jF=new Set([...Nse,...jse]),Vse=new Set([...Bse,...Use]),Gse=h4(jF,Vse);function Wme(t){return t!=null&&jF.has(t.type)}function UF(t){return t!=null&&Gse.has(t.type)}function qse(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function Hse(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function Zse(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function Wse(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function Yse(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function Yme(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function Xme(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function Jme(t,e){return Xse(t,e)===null}function Kme(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function Xse(t,e){return t==null||t.nullable&&e===null?null:BF(t,e)?UF(t)&&!Jse(t.type,Number(e))?"numeric-range-validation-error::out-of-range":null:"type-validation-error::invalid-type"}function Jse(t,e){const i=typeof t=="string"?VF(t):t;if(!i)return!1;const r=i.min,o=i.max;return i.isInteger?Number.isInteger(e)&&e>=r&&e<=o:e>=r&&e<=o}function VF(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return Kse;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return Qse;case"esriFieldTypeBigInteger":case"big-integer":return eoe;case"esriFieldTypeSingle":case"single":return toe;case"esriFieldTypeDouble":case"double":return ioe}}const Kse={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},Qse={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},eoe={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},eb=(2-2**-23)*2**127,toe={min:-eb,max:eb,isInteger:!1,rawMin:-eb,rawMax:eb},ioe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function Qme(t,e,i){switch(t){case"domain-validation-error::invalid-coded-value":return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"domain-validation-error::value-out-of-range":return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"type-validation-error::invalid-type":return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case"numeric-range-validation-error::out-of-range":{const{min:r,max:o}=VF(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${r} to ${o}`}}}function ege(t,e){return!roe(t,e,null)}function roe(t,e,i){if(!t?.attributes||!e)return!0;const r=new Set(Object.keys(t.attributes));let o=!1;for(const h of e)if(!r.has(h)&&(o=!0,i==null))break;return o}function tge(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function noe(t){const e=t?.match(/{[^}]+}/g);return e?e.map(i=>i.slice(1,-1).split(":")[0].trim()):[]}let zb=class extends Nt{constructor(e){super(e),this.type=null}};P([R({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],zb.prototype,"type",void 0),zb=P([Ve("esri.popup.content.Content")],zb);const wc=zb,tb=new xl({asc:"ascending",desc:"descending"});let Sy=class extends ys(Nt){constructor(e){super(e),this.field=null,this.order="ascending"}};P([R({type:String,json:{write:!0}})],Sy.prototype,"field",void 0),P([R({type:tb.apiValues,json:{type:tb.jsonValues,read:tb.read,write:tb.write}})],Sy.prototype,"order",void 0),Sy=P([Ve("esri.popup.support.AttachmentsOrderByInfo")],Sy);const soe=Sy;let el=class extends ys(wc){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};P([R({type:[String],json:{write:!0}})],el.prototype,"attachmentKeywords",void 0),P([R({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],el.prototype,"attachmentTypes",void 0),P([R({type:String,json:{write:!0}})],el.prototype,"description",void 0),P([R({type:["auto","preview","list"],json:{write:!0}})],el.prototype,"displayType",void 0),P([R({type:[soe],json:{write:!0}})],el.prototype,"orderByFields",void 0),P([R({type:String,json:{write:!0}})],el.prototype,"title",void 0),P([R({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],el.prototype,"type",void 0),el=P([Ve("esri.popup.content.AttachmentsContent")],el);const D0=el;var CE;let jh=CE=class extends wc{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new CE({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?ht(this.outFields):null})}};P([R()],jh.prototype,"creator",void 0),P([R()],jh.prototype,"destroyer",void 0),P([R()],jh.prototype,"outFields",void 0),P([R({type:["custom"],readOnly:!0})],jh.prototype,"type",void 0),jh=CE=P([Ve("esri.popup.content.CustomContent")],jh);const ooe=jh;var EE;let nf=EE=class extends Nt{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new EE({title:this.title,expression:this.expression})}};P([R({type:String,json:{write:!0}})],nf.prototype,"title",void 0),P([R({type:String,json:{write:!0}})],nf.prototype,"expression",void 0),P([R({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],nf.prototype,"returnType",void 0),nf=EE=P([Ve("esri.popup.ElementExpressionInfo")],nf);const aoe=nf;var IE;let Ty=IE=class extends wc{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new IE({expressionInfo:this.expressionInfo?.clone()})}};P([R({type:aoe,json:{write:!0}})],Ty.prototype,"expressionInfo",void 0),P([R({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],Ty.prototype,"type",void 0),Ty=IE=P([Ve("esri.popup.content.ExpressionContent")],Ty);const Rw=Ty;function gi(t,e={}){const i=t instanceof xl?t:new xl(t,e),{alwaysWriteDefaults:r,default:o,ignoreUnknown:h=!0,name:d,nonNullable:a,readOnly:v=!1}=e;return R({type:h?i.apiValues:String,json:{type:i.jsonValues,default:o,name:d,read:!v&&{reader:i.read},write:{writer:i.write,alwaysWriteDefaults:r}},nonNullable:a,readOnly:v})}let Ob=class extends ys(Nt){constructor(e){super(e),this.type=null}};P([R({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Ob.prototype,"type",void 0),Ob=P([Ve("esri.layers.support.FieldFormat")],Ob);const $P=Ob,GF="auto";let ic=class extends $P{constructor(e){super(e),this.dateStyle=null,this.hour12=GF,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};P([R({type:["full","long","medium","short"],json:{write:!0}})],ic.prototype,"dateStyle",void 0),P([R({type:["always","auto","never"],nonNullable:!0,json:{default:GF,write:!0}})],ic.prototype,"hour12",void 0),P([R({type:["long","short"],json:{write:!0}})],ic.prototype,"month",void 0),P([R({type:["full","long","medium","short"],json:{write:!0}})],ic.prototype,"timeStyle",void 0),P([R({type:["date-time"]})],ic.prototype,"type",void 0),P([R({type:["numeric"],json:{write:!0}})],ic.prototype,"year",void 0),ic=P([Ve("esri.layers.support.DateTimeFieldFormat")],ic);const dd=ic,q5={min:0,max:20},qF=2,HF=0,ZF="decimal",WF="auto";let pu=class extends $P{constructor(e){super(e),this.maximumFractionDigits=qF,this.minimumFractionDigits=HF,this.style=ZF,this.type="number",this.useGrouping=WF}};P([R({type:Pr,nonNullable:!0,range:q5,json:{default:qF,write:!0}})],pu.prototype,"maximumFractionDigits",void 0),P([R({type:Pr,nonNullable:!0,range:q5,json:{default:HF,write:!0}})],pu.prototype,"minimumFractionDigits",void 0),P([R({type:["decimal"],nonNullable:!0,json:{default:ZF,write:!0}})],pu.prototype,"style",void 0),P([R({type:["number"]})],pu.prototype,"type",void 0),P([R({type:["always","auto","never"],nonNullable:!0,json:{default:WF,write:!0}})],pu.prototype,"useGrouping",void 0),pu=P([Ve("esri.layers.support.NumberFieldFormat")],pu);const g1=pu;let sf=class extends ys(Nt){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};P([gi(pie)],sf.prototype,"dateFormat",void 0),P([R({type:Boolean,json:{write:!0}})],sf.prototype,"digitSeparator",void 0),P([R({type:Pr,json:{write:!0}})],sf.prototype,"places",void 0),sf=P([Ve("esri.popup.support.FieldInfoFormat")],sf);const zm=sf,loe={base:$P,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":dd,number:g1}};function cge(t,e){const{format:i}=t;return e&&Lw(e)?i?YF(i,e):Rb(e,{hour12:"always",useGrouping:"always"}):null}function YF(t,e){const{dateFormat:i}=t;if(!e)return i?Z5(t):H5(t);if(!Lw(e))return;const r={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return XF(t);case"single":case"double":return H5(t);case"date":case"timestamp-offset":return i?Z5(t):Rb(e,r);case"date-only":return i?coe(t):Rb(e);case"time-only":return i?uoe(t):Rb(e,r)}}function Lw(t){return UF(t)||Hse(t)||Zse(t)||Yse(t)||Wse(t)}function XF(t){return new g1({useGrouping:t.digitSeparator?"always":"never"})}function H5(t){const e=XF(t),{places:i}=t;return e.minimumFractionDigits=i??0,e.maximumFractionDigits=i??2,e}function Z5(t){return new dd({dateStyle:JF(t),year:tN(t),month:QF(t),timeStyle:eN(t),hour12:KF(t)})}function coe(t){return new dd({dateStyle:JF(t),year:tN(t),month:QF(t)})}function uoe(t){return new dd({timeStyle:eN(t),hour12:KF(t)})}function JF(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function KF(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function QF(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function eN(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function tN(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function hoe(t,e){const i=t.type==="number",r=t.type==="date-time";if(!e)return i?W5(t):r?Y5(t):null;if(Lw(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return i?iN(t):null;case"single":case"double":return i?W5(t):null;case"date":case"timestamp-offset":return r?Y5(t):null;case"date-only":return r?doe(t):null;case"time-only":return r?poe(t):null}}function iN(t){return new zm({digitSeparator:t.useGrouping!=="never"})}function W5(t){const e=iN(t);return e.places=t.maximumFractionDigits,e}function Y5(t){let e;const i=rN(t),r=nN(t),o=t.hour12==="never"?"24":null,h=t.year==="numeric"?"year":null,d=sN(t);return i&&r&&o?e=`${i}-${r}-${o}`:i&&r?e=`${i}-${r}`:i?e=i:h&&d?e=`${d}-${h}`:h&&(e=h),e?new zm({dateFormat:e}):null}function doe(t){let e;const i=rN(t),r=t.year==="numeric"?"year":null,o=sN(t);return i?e=i:r&&o?e=`${o}-${r}`:r&&(e=r),e?new zm({dateFormat:e}):null}function poe(t){let e;const i=nN(t),r=t.hour12==="never"?"24":null;return i&&r?e=`short-date-${i}-${r}`:i&&(e=`short-date-${i}`),e?new zm({dateFormat:e}):null}function rN(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function nN(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function sN(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function Rb(t,e){if(!Lw(t))return;const i=e?.useGrouping??"auto",r=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new g1({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:i});case"single":case"double":return new g1({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:i});case"date":case"timestamp-offset":return new dd({dateStyle:"short",timeStyle:"short",hour12:r});case"date-only":return new dd({dateStyle:"short"});case"time-only":return new dd({timeStyle:"short",hour12:r})}}let io=class extends ys(Nt){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?hoe(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?YF(e):null)}readFormat(e,i){if(!i.fieldFormat)return e?zm.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};P([R({value:null,clonable:!1,types:loe,json:{write:{overridePolicy(t,e,i){const{fieldName:r}=this;return{enabled:!!r&&!r.startsWith("expression/")&&!r.startsWith("relationships/")&&!!i?.writeFieldFormat}}}}})],io.prototype,"fieldFormat",null),P([R({type:String,json:{write:!0}})],io.prototype,"fieldName",void 0),P([R({value:null,clonable:!1,type:zm,json:{write:!0}})],io.prototype,"format",null),P([Br("format")],io.prototype,"readFormat",null),P([R({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],io.prototype,"isEditable",void 0),P([R({type:String,json:{write:!0}})],io.prototype,"label",void 0),P([R({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],io.prototype,"statisticType",void 0),P([gi(new xl({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],io.prototype,"stringFieldOption",void 0),P([R({type:String,json:{write:!0}})],io.prototype,"tooltip",void 0),P([R({type:Boolean,json:{write:!0}})],io.prototype,"visible",void 0),io=P([Ve("esri.popup.FieldInfo")],io);const oN=io;var $E;let fu=$E=class extends wc{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new $E(ht({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};P([R({type:Object,json:{write:!0}})],fu.prototype,"attributes",void 0),P([R({type:String,json:{write:!0}})],fu.prototype,"description",void 0),P([R({type:[oN],json:{write:!0}})],fu.prototype,"fieldInfos",void 0),P([R({type:String,json:{write:!0}})],fu.prototype,"title",void 0),P([R({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],fu.prototype,"type",void 0),fu=$E=P([Ve("esri.popup.content.FieldsContent")],fu);const z0=fu;let Uh=class extends Nt{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};P([R({type:String,json:{write:!0}})],Uh.prototype,"altText",void 0),P([R({type:String,json:{write:!0}})],Uh.prototype,"caption",void 0),P([R({type:String,json:{write:!0}})],Uh.prototype,"title",void 0),P([R({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Uh.prototype,"type",void 0),Uh=P([Ve("esri.popup.content.mixins.MediaInfo")],Uh);const PP=Uh,y1={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function foe(t){return!!y1[t]||!!y1[t.toLowerCase()]}function aN(t){return y1[t]??y1[t.toLowerCase()]}function dge(t){return[...aN(t)]}function ET(t,e,i){i<0&&++i,i>1&&--i;const r=6*i;return r<1?t+(e-t)*r:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function moe(t,e,i,r=1){const o=(t%360+360)%360/360,h=i<=.5?i*(e+1):i+e-i*e,d=2*i-h;return[Math.round(255*ET(d,h,o+1/3)),Math.round(255*ET(d,h,o)),Math.round(255*ET(d,h,o-1/3)),r]}function pge(t){const e=t.length>5,i=e?8:4,r=(1<<i)-1,o=e?1:17,h=e?t.length===9:t.length===5;let d=+("0x"+t.slice(1));if(isNaN(d))return null;const a=[0,0,0,1];let v;return h&&(v=d&r,d>>=i,a[3]=o*v/255),v=d&r,d>>=i,a[2]=o*v,v=d&r,d>>=i,a[1]=o*v,v=d&r,d>>=i,a[0]=o*v,a}function lN(t){if(!t.startsWith("#")||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),i=parseInt(t.slice(2,3),16),r=parseInt(t.slice(3,4),16),o=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,i+16*i,r+16*r,(o+16*o)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function cN(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const i=e[2].split(/\s*,\s*/),r=e[1];if(r==="rgb"&&i.length===3||r==="rgba"&&i.length===4){if(i[0].endsWith("%")){const o=i.map(h=>2.56*parseFloat(h));return i.length===4&&(o[3]=parseFloat(i[3])),X5(o)}return X5(i.map(o=>parseFloat(o)))}if(r==="hsl"&&i.length===3||r==="hsla"&&i.length===4)return moe(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100,parseFloat(i[3]??"1"))}return null}function X5(t){return t[0]=Lf(t[0]),t[1]=Lf(t[1]),t[2]=Lf(t[2]),t[3]=t.length===4?hN(t[3]):1,t}function uN(t){let e=foe(t)?aN(t):null;return e??=cN(t),e??=lN(t),e}function fge(t){const e=uN(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function hN(t){return dN(t,0,1)}function Lf(t){return Math.round(dN(t,0,255))}function dN(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}const goe=2.2,yoe=1/goe;function mge(t){return t**yoe}const J5=new Float32Array(1);function gge(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function fv(t,e,i){return Math.min(Math.max(t,e),i)}function voe(t,e,i){return t+(e-t)*i}function yge(t,e,i,r,o){return voe(r,o,(t-e)/(i-e))}function vge(t){return t*Math.PI/180}function _ge(t){return 180*t/Math.PI}function bge(t){return Math.acos(fv(t,-1,1))}function xge(t){return Math.asin(fv(t,-1,1))}function Ta(t,e,i=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=i}function wge(t,e,i=1e-6){return!Ta(t,e,i)&&t>e}function Sge(t,e,i=1e-6){return!Ta(t,e,i)&&t<e}function Tge(t,e,i=1e-6){return Ta(t,e,i)||t>e}const v1=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function PE(t){return v1.setFloat64(0,t),v1.getBigInt64(0)}function _oe(t){return v1.setBigInt64(0,t),v1.getFloat64(0)}const Lb=1000000n,boe=pN(1);function pN(t){const e=PE(t=Math.abs(t)),i=_oe(e<=Lb?Lb:e-Lb);return Math.abs(t-i)}function Cge(t,e,i=boe){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(i!=null&&pN(Math.min(Math.abs(t),Math.abs(e)))<i)return Math.abs(t-e)<=i;const r=PE(t),o=PE(e);return r<0!=o<0?!1:!((r<o?o-r:r-o)>Lb)}function fN(t,e,i=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const r=Math.abs(t-e),o=Math.abs(t),h=Math.abs(e);if(t===0||e===0||o<1e-12&&h<1e-12){if(r>.01*i)return!1}else if(r/(o+h)>i)return!1;return!0}function Ege(t){return mN(Math.max(-K5,Math.min(t,K5)))}function mN(t){return J5[0]=t,J5[0]}function Ige(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],r=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(Ta(e,1)&&Ta(i,1)&&Ta(r,1))}function $ge(t,e){return(t%e+e)%e}const K5=mN(34028234663852886e22);function Pge(t,e,i){if(i===void 0||+i==0)return Math[t](e);if(e=+e,i=+i,isNaN(e)||typeof i!="number"||i%1!=0)return NaN;let r=e.toString().split("e");return r=(e=Math[t](+(r[0]+"e"+(r[1]?+r[1]-i:-i)))).toString().split("e"),+(r[0]+"e"+(r[1]?+r[1]+i:i))}function ib(t){return fv(xP(t),0,255)}function rb(t,e){const i=t.toString(16).padStart(2,"0");return e?i.slice(0,1):i}let ar=class Ao{static blendColors(e,i,r,o=new Ao){return o.r=Math.round(e.r+(i.r-e.r)*r),o.g=Math.round(e.g+(i.g-e.g)*r),o.b=Math.round(e.b+(i.b-e.b)*r),o.a=e.a+(i.a-e.a)*r,o._sanitize()}static fromRgb(e,i){const r=cN(e);return r?Ao.fromArray(r,i):null}static fromHex(e,i=new Ao){const r=lN(e);return r?Ao.fromArray(r,i):null}static fromArray(e,i=new Ao){return i._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(e,i){const r=uN(e);return r?Ao.fromArray(r,i):null}static fromJSON(e){return e!=null?new Ao([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e,i){return e==null?null:(i??=[0,0,0,0],i[0]=e.r/255,i[1]=e.g/255,i[2]=e.b/255,i[3]=e.a!=null?e.a:1,i)}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Ao.fromString(e,this):Array.isArray(e)?Ao.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Ao||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const i=e?.capitalize??!1,r=e?.digits??6,o=r===3||r===4,h=r===4||r===8,d=`#${rb(this.r,o)}${rb(this.g,o)}${rb(this.b,o)}${h?rb(Math.round(255*this.a),o):""}`;return i?d.toUpperCase():d}toCss(e=!1){const i=this.r+", "+this.g+", "+this.b;return e?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const i=ib(this.r),r=ib(this.g),o=ib(this.b);return e===0||this.a!==1?[i,r,o,ib(255*this.a)]:[i,r,o]}clone(){return new Ao(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Lf(this.r),this.g=Lf(this.g),this.b=Lf(this.b),this.a=hN(this.a),this}_set(e,i,r,o){this.r=e,this.g=i,this.b=r,this.a=o}};ar.prototype.declaredClass="esri.Color";var ME;let Vh=ME=class extends Ln{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new ME({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};P([R()],Vh.prototype,"color",void 0),P([R()],Vh.prototype,"fieldName",void 0),P([R()],Vh.prototype,"tooltip",void 0),P([R()],Vh.prototype,"value",void 0),Vh=ME=P([Ve("esri.popup.content.support.ChartMediaInfoValueSeries")],Vh);const xoe=Vh;var kE;let mu=kE=class extends Nt{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new kE({colors:ht(this.colors),fields:ht(this.fields),normalizeField:this.normalizeField,series:ht(this.series),tooltipField:this.tooltipField})}};P([R({type:[ar],json:{type:[[Pr]],write:!0}})],mu.prototype,"colors",void 0),P([R({type:[String],json:{write:{isRequired:!0}}})],mu.prototype,"fields",void 0),P([R({type:String,json:{write:!0}})],mu.prototype,"normalizeField",void 0),P([R({type:[xoe],json:{read:!1}})],mu.prototype,"series",void 0),P([R({type:String,json:{write:!0}})],mu.prototype,"tooltipField",void 0),mu=kE=P([Ve("esri.popup.content.support.ChartMediaInfoValue")],mu);const woe=mu;let Cy=class extends PP{constructor(e){super(e),this.type=null,this.value=void 0}};P([R({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Cy.prototype,"type",void 0),P([R({type:woe,json:{write:{isRequired:!0}}})],Cy.prototype,"value",void 0),Cy=P([Ve("esri.popup.content.mixins.ChartMediaInfo")],Cy);const Fw=Cy,Nw=_o()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var AE;let Fb=AE=class extends Fw{constructor(t){super(t),this.type="bar-chart"}clone(){return new AE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};P([R({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:Nw.write,isRequired:!0}}})],Fb.prototype,"type",void 0),Fb=AE=P([Ve("esri.popup.content.BarChartMediaInfo")],Fb);const gN=Fb;var DE;let Nb=DE=class extends Fw{constructor(t){super(t),this.type="column-chart"}clone(){return new DE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};P([R({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:Nw.write,isRequired:!0}}})],Nb.prototype,"type",void 0),Nb=DE=P([Ve("esri.popup.content.ColumnChartMediaInfo")],Nb);const yN=Nb;var zE;let Ey=zE=class extends Nt{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new zE({linkURL:this.linkURL,sourceURL:this.sourceURL})}};P([R({type:String,json:{write:!0}})],Ey.prototype,"linkURL",void 0),P([R({type:String,json:{write:{isRequired:!0}}})],Ey.prototype,"sourceURL",void 0),Ey=zE=P([Ve("esri.popup.content.support.ImageMediaInfoValue")],Ey);const Soe=Ey;var OE;let of=OE=class extends PP{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new OE({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};P([R({type:Number,json:{write:!0}})],of.prototype,"refreshInterval",void 0),P([R({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],of.prototype,"type",void 0),P([R({type:Soe,json:{write:{isRequired:!0}}})],of.prototype,"value",void 0),of=OE=P([Ve("esri.popup.content.ImageMediaInfo")],of);const vN=of;var RE;let Bb=RE=class extends Fw{constructor(t){super(t),this.type="line-chart"}clone(){return new RE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};P([R({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:Nw.write,isRequired:!0}}})],Bb.prototype,"type",void 0),Bb=RE=P([Ve("esri.popup.content.LineChartMediaInfo")],Bb);const _N=Bb;var LE;let jb=LE=class extends Fw{constructor(t){super(t),this.type="pie-chart"}clone(){return new LE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};P([R({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:Nw.write,isRequired:!0}}})],jb.prototype,"type",void 0),jb=LE=P([Ve("esri.popup.content.PieChartMediaInfo")],jb);const bN=jb,FE={base:PP,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":gN,"column-chart":yN,"line-chart":_N,"pie-chart":bN,image:vN}};var NE;let pa=NE=class extends wc{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?vN.fromJSON(e):e.type==="barchart"?gN.fromJSON(e):e.type==="columnchart"?yN.fromJSON(e):e.type==="linechart"?_N.fromJSON(e):e.type==="piechart"?bN.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(i=>i.toJSON())}clone(){return new NE(ht({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};P([R()],pa.prototype,"activeMediaInfoIndex",void 0),P([R({type:Object,json:{write:!0}})],pa.prototype,"attributes",void 0),P([R({type:String,json:{write:!0}})],pa.prototype,"description",void 0),P([R({types:[FE]})],pa.prototype,"mediaInfos",void 0),P([Br("mediaInfos")],pa.prototype,"readMediaInfos",null),P([Ui("mediaInfos")],pa.prototype,"writeMediaInfos",null),P([R({type:String,json:{write:!0}})],pa.prototype,"title",void 0),P([R({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],pa.prototype,"type",void 0),pa=NE=P([Ve("esri.popup.content.MediaContent")],pa);const O0=pa;var BE;let Iy=BE=class extends Nt{constructor(t){super(t),this.field=null,this.order=null}clone(){return new BE({field:this.field,order:this.order})}};P([R({type:String,json:{write:!0}})],Iy.prototype,"field",void 0),P([R({type:["asc","desc"],json:{write:!0}})],Iy.prototype,"order",void 0),Iy=BE=P([Ve("esri.popup.support.RelatedRecordsInfoFieldOrder")],Iy);const xN=Iy;let tl=class extends ys(wc){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};P([R({type:String,json:{write:!0}})],tl.prototype,"description",void 0),P([R({type:Number,json:{type:Pr,write:!0}})],tl.prototype,"displayCount",void 0),P([R({type:["list"],json:{write:{isRequired:!0}}})],tl.prototype,"displayType",void 0),P([R({type:[xN],json:{write:!0}})],tl.prototype,"orderByFields",void 0),P([R({type:Number,json:{type:Pr,write:{isRequired:!0}}})],tl.prototype,"relationshipId",void 0),P([R({type:String,json:{write:!0}})],tl.prototype,"title",void 0),P([R({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],tl.prototype,"type",void 0),tl=P([Ve("esri.popup.content.RelationshipContent")],tl);const R0=tl;var jE;let $y=jE=class extends wc{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new jE({text:this.text})}};P([R({type:String,json:{write:!0}})],$y.prototype,"text",void 0),P([R({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],$y.prototype,"type",void 0),$y=jE=P([Ve("esri.popup.content.TextContent")],$y);const L0=$y;let rc=class extends ys(Nt){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};P([R({type:String,json:{write:!0}})],rc.prototype,"title",void 0),P([R({type:String,json:{write:!0}})],rc.prototype,"description",void 0),P([R({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],rc.prototype,"type",void 0),P([R({type:Number,json:{type:Pr,write:!0}})],rc.prototype,"associatedNetworkSourceId",void 0),P([R({type:Number,json:{type:Pr,write:!0}})],rc.prototype,"associatedAssetGroup",void 0),P([R({type:Number,json:{type:Pr,write:!0}})],rc.prototype,"associatedAssetType",void 0),rc=P([Ve("esri.popup.support.UtilityNetworkAssociationType")],rc);const Toe=rc;let gu=class extends ys(wc){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};P([R({type:String,json:{write:!0}})],gu.prototype,"description",void 0),P([R({type:Number,json:{type:Pr,write:!0}})],gu.prototype,"displayCount",void 0),P([R({type:String,json:{write:!0}})],gu.prototype,"title",void 0),P([R({type:[Toe],json:{write:!0}})],gu.prototype,"associationTypes",void 0),P([gi({utilityNetworkAssociations:"utility-network-associations"})],gu.prototype,"type",void 0),gu=P([Ve("esri.popup.content.UtilityNetworkAssociationsContent")],gu);const MP=gu,Coe={base:null,key:"type",typeMap:{attachment:D0,media:O0,text:L0,expression:Rw,field:z0,relationship:R0,utilityNetworkAssociations:MP}},Eoe={base:null,key:"type",typeMap:{attachment:D0,media:O0,text:L0,expression:Rw,field:z0,relationship:R0}};var UE;let Gh=UE=class extends Nt{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new UE({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};P([R({type:String,json:{write:!0}})],Gh.prototype,"name",void 0),P([R({type:String,json:{write:!0}})],Gh.prototype,"title",void 0),P([R({type:String,json:{write:!0}})],Gh.prototype,"expression",void 0),P([R({type:["string","number"],json:{write:!0}})],Gh.prototype,"returnType",void 0),Gh=UE=P([Ve("esri.popup.ExpressionInfo")],Gh);const Ioe=Gh;var VE;let Py=VE=class extends Nt{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new VE({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};P([R({type:Boolean,json:{write:!0}})],Py.prototype,"returnTopmostRaster",void 0),P([R({type:Boolean,json:{write:!0}})],Py.prototype,"showNoDataRecords",void 0),Py=VE=P([Ve("esri.popup.LayerOptions")],Py);const $oe=Py;var GE;let My=GE=class extends Nt{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new GE({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?ht(this.orderByFields):null})}};P([R({type:Boolean,json:{write:!0}})],My.prototype,"showRelatedRecords",void 0),P([R({type:[xN],json:{write:!0}})],My.prototype,"orderByFields",void 0),My=GE=P([Ve("esri.popup.RelatedRecordsInfo")],My);const Q5=My;let wN=0;const Bw=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+wN++})}};return i=P([Ve("esri.core.Identifiable")],i),i},zge=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:wN++})}};return i=P([Ve("esri.core.Identifiable.NumericIdentifiable")],i),i};Bw(class{});var qE;let Do=qE=class extends Bw(Ln){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new qE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};P([R()],Do.prototype,"active",void 0),P([R()],Do.prototype,"className",void 0),P([R()],Do.prototype,"disabled",void 0),P([R()],Do.prototype,"icon",void 0),P([R()],Do.prototype,"id",void 0),P([R()],Do.prototype,"indicator",void 0),P([R()],Do.prototype,"title",void 0),P([R()],Do.prototype,"type",void 0),P([R()],Do.prototype,"visible",void 0),Do=qE=P([Ve("esri.support.actions.ActionBase")],Do);const kP=Do;var HE;let Ub=HE=class extends kP{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new HE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};P([R()],Ub.prototype,"image",void 0),Ub=HE=P([Ve("esri.support.actions.ActionButton")],Ub);const Poe=Ub;var ZE;let ky=ZE=class extends kP{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new ZE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};P([R()],ky.prototype,"image",void 0),P([R()],ky.prototype,"value",void 0),ky=ZE=P([Ve("esri.support.actions.ActionToggle")],ky);const Moe=ky,oy="relationships/",ez="expression/",koe=sr.ofType({key:"type",defaultKeyValue:"button",base:kP,typeMap:{button:Poe,toggle:Moe}}),Aoe={base:wc,key:"type",typeMap:{media:O0,custom:ooe,text:L0,attachments:D0,fields:z0,expression:Rw,relationship:R0,utilityNetworkAssociations:MP}},SN=new Set(["attachments","fields","media","text","expression","relationship"]),Doe=new Set([...SN,"utility-network-associations"]);let Kr=class extends ys(Nt){constructor(e){super(e),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(i=>mm(Aoe,i)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||s4(e)?e:(ui.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,i){const{popupElements:r}=i;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,r):this._readPopupInfo(i)}writeWebSceneContent(e,i,r,o){this._writePopupTemplateContent(e,i,o)}writeWebMapContent(e,i,r,o){this._writePopupTemplateContent(e,i,o)}writeFieldInfos(e,i,r,o){const{content:h}=this,d=Array.isArray(h)?h:null,{writeFieldFormat:a,...v}=o||{};if(e){const T=d?d.filter(k=>k.type==="fields"):[],E=T.length&&T.every(k=>k.fieldInfos?.length);i.fieldInfos=e.filter(Boolean).map(k=>{const L=k.toJSON(v);return E&&(L.visible=!1),L})}if(d)for(const T of d)T.type==="fields"&&this._writeFieldsContent(T,i,v)}writeLayerOptions(e,i,r,o){i[r]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(o)}writeTitle(e,i){i.title=e||""}async collectRequiredFields(e,i,r){const o=this.expressionInfos||[];await this._collectExpressionInfoFields(e,i,r,[...o,...this._getContentExpressionInfos(this.content,o)]),IP(e,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e,i){const r=new Set;return await this.collectRequiredFields(r,e,i),[...r].sort()}_writePopupTemplateContent(e,i,r){typeof e!="string"?Array.isArray(e)&&(i.popupElements=e.filter(o=>r?.origin==="web-scene"?SN.has(o.type):Doe.has(o.type)).map(o=>o?.toJSON(r)),i.popupElements.forEach(o=>{o.type==="attachments"?this._writeAttachmentContent(i):o.type==="media"?this._writeMediaContent(o,i):o.type==="text"?this._writeTextContent(o,i):o.type==="relationship"&&this._writeRelationshipContent(o,i)})):i.description=e}_writeFieldsContent(e,i,r){const o=e.fieldInfos;if(!Array.isArray(o)||!o.length)return;const h=i.fieldInfos;if(Array.isArray(h))for(const d of o){const a=h.find(v=>v.fieldName?.toLowerCase()===d.fieldName?.toLowerCase());a?a.visible=!0:h.push(d.toJSON(r))}else i.fieldInfos=o.map(d=>d.toJSON(r))}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,i){const r=e.orderByFields?.map(h=>this._toFieldOrderJSON(h,e.relationshipId))||[],o=[...i.relatedRecordsInfo?.orderByFields||[],...r];i.relatedRecordsInfo={showRelatedRecords:!0,...o?.length&&{orderByFields:o}}}_writeTextContent(e,i){!i.description&&e.text&&(i.description=e.text)}_writeMediaContent(e,i){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=ht(e.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...r]:i.mediaInfos=r}_readPopupInfoElements(e,i,r){const o={description:!1,mediaInfos:!1};return r.map(h=>h.type==="media"?(h.mediaInfos||!i||o.mediaInfos||(h.mediaInfos=i,o.mediaInfos=!0),O0.fromJSON(h)):h.type==="text"?(h.text||!e||o.description||(h.text=e,o.description=!0),L0.fromJSON(h)):h.type==="attachments"?D0.fromJSON(h):h.type==="fields"?z0.fromJSON(h):h.type==="expression"?Rw.fromJSON(h):h.type==="relationship"?R0.fromJSON(h):h.type==="utilityNetworkAssociations"?MP.fromJSON(h):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:i,order:r}=e;if(!i?.startsWith(oy))return null;const o=i.replace(oy,"").split("/");if(o.length!==2)return null;const h=parseInt(o[0],10),d=o[1];return!Number.isNaN(h)&&d?R0.fromJSON({relationshipId:h,orderByFields:[{field:d,order:r}]}):null}_toFieldOrderJSON(e,i){const{order:r,field:o}=e;return{field:`${oy}${i}/${o}`,order:r}}_readPopupInfo({description:e,mediaInfos:i,showAttachments:r,relatedRecordsInfo:o={showRelatedRecords:!1}}){const h=[];e?h.push(new L0({text:e})):h.push(new z0),Array.isArray(i)&&i.length&&h.push(O0.fromJSON({mediaInfos:i})),r&&h.push(D0.fromJSON({displayType:"auto"}));const{showRelatedRecords:d,orderByFields:a}=o;return d&&a?.length&&a.forEach(v=>{const T=this._toRelationshipContent(v);T&&h.push(T)}),h.length?h:e}_getContentElementFields(e){const i=e?.type;if(i==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(i==="custom")return e.outFields||[];if(i==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(i==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((o,h)=>[...o,...this._getMediaInfoFields(h)],[])]}return i==="text"?this._extractFieldNames(e.text):i==="relationship"||i==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:i,title:r,value:o}=e,h=o||{},{fields:d,normalizeField:a,tooltipField:v,sourceURL:T,linkURL:E}=h,k=[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(T),...this._extractFieldNames(E),...d??[]];return a&&k.push(a),v&&k.push(v),k}_getContentExpressionInfos(e,i){return Array.isArray(e)?e.reduce((r,o)=>[...r,...o.type==="expression"&&o.expressionInfo?[o.expressionInfo]:[]],i):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((i,r)=>[...i,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(e,i,r,o){o&&await Promise.all(o.map(h=>RF(e,i,r,h.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:i,visible:r})=>!(r!==void 0&&!r||!i||i.startsWith(oy)||i.startsWith(ez))).map(i=>i.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((i,r)=>[...i,...this._getActionFields(r)],[]):[]}_getActionFields(e){const{className:i,title:r,type:o}=e,h=o==="button"||o==="toggle"?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(h)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return noe(e).filter(i=>!(i.startsWith(oy)||i.startsWith(ez)))}};P([R({type:koe})],Kr.prototype,"actions",void 0),P([R()],Kr.prototype,"content",void 0),P([dv("content")],Kr.prototype,"castContent",null),P([Br("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],Kr.prototype,"readContent",null),P([Ui("web-scene","content",{popupElements:{type:sr.ofType(Eoe)},showAttachments:{type:Boolean},mediaInfos:{type:sr.ofType(FE)},description:{type:String},relatedRecordsInfo:{type:Q5}})],Kr.prototype,"writeWebSceneContent",null),P([Ui("content",{popupElements:{type:sr.ofType(Coe)},showAttachments:{type:Boolean},mediaInfos:{type:sr.ofType(FE)},description:{type:String},relatedRecordsInfo:{type:Q5}})],Kr.prototype,"writeWebMapContent",null),P([R({type:[Ioe],json:{write:!0}})],Kr.prototype,"expressionInfos",void 0),P([R({type:[oN]})],Kr.prototype,"fieldInfos",void 0),P([Ui("fieldInfos")],Kr.prototype,"writeFieldInfos",null),P([R({type:$oe})],Kr.prototype,"layerOptions",void 0),P([Ui("layerOptions")],Kr.prototype,"writeLayerOptions",null),P([R({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],Kr.prototype,"lastEditInfoEnabled",void 0),P([R()],Kr.prototype,"outFields",void 0),P([R()],Kr.prototype,"overwriteActions",void 0),P([R()],Kr.prototype,"returnGeometry",void 0),P([R({json:{type:String}})],Kr.prototype,"title",void 0),P([Ui("title")],Kr.prototype,"writeTitle",null),Kr=P([Ve("esri.PopupTemplate")],Kr);const F0=Kr;let AP=class{constructor(e,i,r,o,h,d){this.semiMajorAxis=e,this.flattening=i,this.outerAtmosphereRimWidth=r,this.atmosphereHeight=o,this.scaleHeight=h;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=d||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Pa=new AP(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),N0=new AP(3396190,1/169.8944472236118,23e4,6e4,.111),jw=new AP(1737400,0,0,0,0);let IT,ve=null;function zoe(){return!!ve}function Ooe(){return!!Ue("esri-wasm")}function Roe(){return IT||(IT=Qn(async()=>{const{default:t}=await import("./pe-wasm-B87Q3u4k.js");return{default:t}},[]).then(({default:t})=>t({locateFile:e=>_P(`esri/geometry/support/${e}`)})).then(t=>{PN(t)}),IT)}const Vb={geogToProj(t,e,i){ve.ensureCache.prepare();const r=Sd(i),o=i===r,h=ve.ensureFloat64(r),d=ve._pe_geog_to_proj(ve.getPointer(t),e,h);return d&&qu(i,e,h,o),d},projGeog(t,e,i,r){switch(r){case gr.PE_TRANSFORM_P_TO_G:return Vb.projToGeog(t,e,i);case gr.PE_TRANSFORM_G_TO_P:return Vb.geogToProj(t,e,i)}return 0},projToGeog:(t,e,i)=>Vb.projToGeogCenter(t,e,i,0),projToGeogCenter(t,e,i,r){ve.ensureCache.prepare();const o=Sd(i),h=i===o,d=ve.ensureFloat64(o),a=ve._pe_proj_to_geog_center(ve.getPointer(t),e,d,r);return a&&qu(i,e,d,h),a}};let gr=class bi{static init(){bi.PE_BUFFER_MAX=ve.PeDefs.prototype.PE_BUFFER_MAX,bi.PE_NAME_MAX=ve.PeDefs.prototype.PE_NAME_MAX,bi.PE_MGRS_MAX=ve.PeDefs.prototype.PE_MGRS_MAX,bi.PE_USNG_MAX=ve.PeDefs.prototype.PE_USNG_MAX,bi.PE_DD_MAX=ve.PeDefs.prototype.PE_DD_MAX,bi.PE_DDM_MAX=ve.PeDefs.prototype.PE_DDM_MAX,bi.PE_DMS_MAX=ve.PeDefs.prototype.PE_DMS_MAX,bi.PE_UTM_MAX=ve.PeDefs.prototype.PE_UTM_MAX,bi.PE_PARM_MAX=ve.PeDefs.prototype.PE_PARM_MAX,bi.PE_TYPE_NONE=ve.PeDefs.prototype.PE_TYPE_NONE,bi.PE_TYPE_GEOGCS=ve.PeDefs.prototype.PE_TYPE_GEOGCS,bi.PE_TYPE_PROJCS=ve.PeDefs.prototype.PE_TYPE_PROJCS,bi.PE_TYPE_GEOGTRAN=ve.PeDefs.prototype.PE_TYPE_GEOGTRAN,bi.PE_TYPE_COORDSYS=ve.PeDefs.prototype.PE_TYPE_COORDSYS,bi.PE_TYPE_UNIT=ve.PeDefs.prototype.PE_TYPE_UNIT,bi.PE_TYPE_LINUNIT=ve.PeDefs.prototype.PE_TYPE_LINUNIT,bi.PE_STR_OPTS_NONE=ve.PeDefs.prototype.PE_STR_OPTS_NONE,bi.PE_STR_AUTH_NONE=ve.PeDefs.prototype.PE_STR_AUTH_NONE,bi.PE_STR_AUTH_TOP=ve.PeDefs.prototype.PE_STR_AUTH_TOP,bi.PE_STR_NAME_CANON=ve.PeDefs.prototype.PE_STR_NAME_CANON,bi.PE_STR_FMT_WKT=ve.PeDefs.prototype.PE_STR_FMT_WKT,bi.PE_STR_FMT_WKT2=ve.PeDefs.prototype.PE_STR_FMT_WKT2,bi.PE_PARM_X0=ve.PeDefs.prototype.PE_PARM_X0,bi.PE_PARM_ND=ve.PeDefs.prototype.PE_PARM_ND,bi.PE_TRANSFORM_1_TO_2=ve.PeDefs.prototype.PE_TRANSFORM_1_TO_2,bi.PE_TRANSFORM_2_TO_1=ve.PeDefs.prototype.PE_TRANSFORM_2_TO_1,bi.PE_TRANSFORM_P_TO_G=ve.PeDefs.prototype.PE_TRANSFORM_P_TO_G,bi.PE_TRANSFORM_G_TO_P=ve.PeDefs.prototype.PE_TRANSFORM_G_TO_P,bi.PE_HORIZON_RECT=ve.PeDefs.prototype.PE_HORIZON_RECT,bi.PE_HORIZON_POLY=ve.PeDefs.prototype.PE_HORIZON_POLY,bi.PE_HORIZON_LINE=ve.PeDefs.prototype.PE_HORIZON_LINE,bi.PE_HORIZON_DELTA=ve.PeDefs.prototype.PE_HORIZON_DELTA}},TN=null;const tz={},iz={},rz=t=>{const e=t.getType();switch(e){case gr.PE_TYPE_GEOGCS:t=ve.castObject(t,ve.PeGeogcs);break;case gr.PE_TYPE_PROJCS:t=ve.castObject(t,ve.PeProjcs);break;case gr.PE_TYPE_GEOGTRAN:t=ve.castObject(t,ve.PeGeogtran);break;default:e&gr.PE_TYPE_UNIT&&(t=ve.castObject(t,ve.PeUnit))}return t},af={initialize(){ve.PeFactory.prototype.initialize(null)},coordsys:t=>af.factoryByType(gr.PE_TYPE_COORDSYS,t),factoryByType(t,e){let i=null,r=tz[t];if(r||(r={},tz[t]=r),r.hasOwnProperty(String(e))&&(i=r[e],ve.compare(i,ve.NULL)&&(i=null)),!i){const o=ve.PeFactory.prototype.factoryByType(t,e);ve.compare(o,ve.NULL)||(i=rz(o),r[e]=i)}return i},fromString(t,e){let i=null,r=iz[t];if(r||(r={},iz[t]=r),r.hasOwnProperty(e)&&(i=r[e],ve.compare(i,ve.NULL)&&(i=null)),!i){const o=ve.PeFactory.prototype.fromString(t,e);ve.compare(o,ve.NULL)||(i=rz(o),r[e]=i)}return i},geogcs:t=>af.factoryByType(gr.PE_TYPE_GEOGCS,t),geogtran:t=>af.factoryByType(gr.PE_TYPE_GEOGTRAN,t),getCode:t=>ve.PeFactory.prototype.getCode(t),projcs:t=>af.factoryByType(gr.PE_TYPE_PROJCS,t),unit:t=>af.factoryByType(gr.PE_TYPE_UNIT,t)};let nz,CN=null;const DP={PE_GTLIST_OPTS_COMMON:0,init(){DP.PE_GTLIST_OPTS_COMMON=ve.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,nz=ve._pe_getPeGTlistExtendedEntrySize()},getGTlist(t,e,i,r,o,h){let d=null;const a=new ve.PeInteger(h);try{const v=ve.PeGTlistExtended.prototype.getGTlist(t,e,i,r,o,a);if((h=a.val)&&(d=[v],h>1)){const T=ve.getPointer(v);for(let E=1;E<h;E++)d.push(ve.wrapPointer(T+nz*E,ve.PeGTlistExtendedEntry))}}finally{ve.destroy(a)}return d}},Loe={destroy(t){if(t?.length){for(const e of t)ga(e),e.getEntries().forEach(i=>{ga(i);const r=i.getGeogtran();ga(r),r.getParameters().forEach(ga),[r.getGeogcs1(),r.getGeogcs2()].forEach(o=>{ga(o);const h=o.getDatum();ga(h),ga(h.getSpheroid()),ga(o.getPrimem()),ga(o.getUnit())})});ve.PeGTlistExtendedEntry.prototype.Delete(t[0])}}},Foe={geogToGeog(t,e,i,r,o){ve.ensureCache.prepare();const h=Sd(i),d=i===h,a=ve.ensureFloat64(h);let v=0;r&&(v=ve.ensureFloat64(r));const T=ve._pe_geog_to_geog(ve.getPointer(t),e,a,v,o);return T&&qu(i,e,a,d),T}},Noe={geodesicCoordinate(t,e,i,r,o,h,d,a){ve.PeLineType.prototype.geodesic_coordinate(t,e,i,r,o,h,d,a)},geodeticCoordinate(t,e,i,r,o,h,d,a,v){ve.PeLineType.prototype.geodetic_coordinate(t,e,i,r,o,h,d,a,v)},geodeticDistance(t,e,i,r,o,h,d,a,v,T){ve.PeLineType.prototype.geodetic_distance(t,e,i,r,o,h,d,a,v,T)},greatEllipticDistance(t,e,i,r,o,h,d,a,v){ve.PeLineType.prototype.great_elliptic_distance(t,e,i,r,o,h,d,a,v)}},Boe={phiToEta:(t,e)=>ve.PeMath.prototype.phi_to_eta(t,e),etaToPhi:(t,e)=>ve.PeMath.prototype.eta_to_phi(t,e),phiToPhig:(t,e)=>ve.PeMath.prototype.phi_to_phig(t,e),q:(t,e,i)=>ve.PeMath.prototype.q(t,e,i),q90:(t,e)=>ve.PeMath.prototype.q90(t,e)},$T=(t,e,i,r,o,h)=>{let d,a;switch(ve.ensureCache.prepare(),t){case"dd":d=ve._pe_geog_to_dd,a=gr.PE_DD_MAX;break;case"ddm":d=ve._pe_geog_to_ddm,a=gr.PE_DDM_MAX;break;case"dms":d=ve._pe_geog_to_dms,a=gr.PE_DMS_MAX}let v=0;e&&(v=ve.getPointer(e));const T=Sd(r),E=ve.ensureFloat64(T),k=Uw(i,a),L=d(v,i,E,o,ve.ensureInt32(k));if(L)for(let O=0;O<i;O++)h[O]=ve.UTF8ToString(k[O]);return L},PT=(t,e,i,r,o)=>{let h;switch(ve.ensureCache.prepare(),t){case"dd":h=ve._pe_dd_to_geog;break;case"ddm":h=ve._pe_ddm_to_geog;break;case"dms":h=ve._pe_dms_to_geog}let d=0;e&&(d=ve.getPointer(e));const a=r.map(k=>ve.ensureString(k)),v=ve.ensureInt32(a),T=ve.ensureFloat64(new Array(2*i)),E=h(d,i,v,T);return E&&qu(o,i,T),E},joe={geogToDms:(t,e,i,r,o)=>$T("dms",t,e,i,r,o),dmsToGeog:(t,e,i,r)=>PT("dms",t,e,i,r),geogToDdm:(t,e,i,r,o)=>$T("ddm",t,e,i,r,o),ddmToGeog:(t,e,i,r)=>PT("ddm",t,e,i,r),geogToDd:(t,e,i,r,o)=>$T("dd",t,e,i,r,o),ddToGeog:(t,e,i,r)=>PT("dd",t,e,i,r)};let EN=class lf{static init(){lf.PE_MGRS_STYLE_NEW=ve.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,lf.PE_MGRS_STYLE_OLD=ve.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,lf.PE_MGRS_STYLE_AUTO=ve.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,lf.PE_MGRS_180_ZONE_1_PLUS=ve.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,lf.PE_MGRS_ADD_SPACES=ve.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,i,r,o,h,d,a){ve.ensureCache.prepare();let v=0;e&&(v=ve.getPointer(e));const T=Sd(r),E=ve.ensureFloat64(T),k=Uw(i,gr.PE_MGRS_MAX),L=ve.ensureInt32(k),O=ve._pe_geog_to_mgrs_extended(v,i,E,o,h,d,L);if(O)for(let H=0;H<i;H++)a[H]=ve.UTF8ToString(k[H]);return O}static mgrsToGeogExtended(e,i,r,o,h){ve.ensureCache.prepare();let d=0;e&&(d=ve.getPointer(e));const a=r.map(k=>ve.ensureString(k)),v=ve.ensureInt32(a),T=ve.ensureFloat64(new Array(2*i)),E=ve._pe_mgrs_to_geog_extended(d,i,v,o,T);return E&&qu(h,i,T),E}};const Uoe={geogToUsng(t,e,i,r,o,h,d){ve.ensureCache.prepare();let a=0;t&&(a=ve.getPointer(t));const v=Sd(i),T=ve.ensureFloat64(v),E=Uw(e,gr.PE_MGRS_MAX),k=ve.ensureInt32(E),L=ve._pe_geog_to_usng(a,e,T,r,o,h,k);if(L)for(let O=0;O<e;O++)d[O]=ve.UTF8ToString(E[O]);return L},usngToGeog(t,e,i,r){ve.ensureCache.prepare();let o=0;t&&(o=ve.getPointer(t));const h=i.map(T=>ve.ensureString(T)),d=ve.ensureInt32(h),a=ve.ensureFloat64(new Array(2*e)),v=ve._pe_usng_to_geog(o,e,d,a);return v&&qu(r,e,a),v}};let IN=class Gb{static init(){Gb.PE_UTM_OPTS_NONE=ve.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,Gb.PE_UTM_OPTS_ADD_SPACES=ve.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,Gb.PE_UTM_OPTS_NS=ve.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,i,r,o,h){ve.ensureCache.prepare();let d=0;e&&(d=ve.getPointer(e));const a=Sd(r),v=ve.ensureFloat64(a),T=Uw(i,gr.PE_UTM_MAX),E=ve.ensureInt32(T),k=ve._pe_geog_to_utm(d,i,v,o,E);if(k)for(let L=0;L<i;L++)h[L]=ve.UTF8ToString(T[L]);return k}static utmToGeog(e,i,r,o,h){ve.ensureCache.prepare();let d=0;e&&(d=ve.getPointer(e));const a=r.map(k=>ve.ensureString(k)),v=ve.ensureInt32(a),T=ve.ensureFloat64(new Array(2*i)),E=ve._pe_utm_to_geog(d,i,v,o,T);return E&&qu(h,i,T),E}};var Ps;let $N=(Ps=class{static init(){Ps.PE_PCSINFO_OPTION_NONE=ve.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,Ps.PE_PCSINFO_OPTION_DOMAIN=ve.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,Ps.PE_POLE_OUTSIDE_BOUNDARY=ve.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,Ps.PE_POLE_POINT=ve.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,i=Ps.PE_PCSINFO_OPTION_DOMAIN){let r=null,o=null;return Ps.cache.has(e)&&(o=Ps.cache.get(e),o[i]&&(r=o[i])),r||(r=ve.PePCSInfo.prototype.generate(e,i),o||(o=[],Ps.cache.set(e,o)),o[i]=r),r}},Ps.cache=new Map,Ps);const Voe={versionString:()=>ve.PeVersion.prototype.version_string()};function PN(t){function e(h,d,a){h[d]=a(h[d])}ve=t,gr.init(),DP.init(),EN.init(),IN.init(),$N.init(),TN=class extends ve.PeDouble{constructor(h=NaN){super(h)}destroy(){ve.destroy(this)}[Symbol.dispose](){this.destroy()}},CN=class extends ve.PeGCSExtent{destroy(){ve.destroy(this)}[Symbol.dispose](){this.destroy()}};const i=[ve.PeAngunit,ve.PeDatum,ve.PeGeogcs,ve.PeGeogtran,ve.PeObject,ve.PeParameter,ve.PePrimem,ve.PeProjcs,ve.PeSpheroid,ve.PeUnit];for(const h of i)e(h.prototype,"getName",d=>function(){return d.call(this,new Array(gr.PE_NAME_MAX))});for(const h of[ve.PeGeogtran,ve.PeProjcs])e(h.prototype,"getParameters",d=>function(){const a=new Array(gr.PE_PARM_MAX);let v=d.call(this);for(let T=0;T<a.length;T++){const E=ve.getValue(v,"*");a[T]=E?ve.wrapPointer(E,ve.PeParameter):null,v+=Int32Array.BYTES_PER_ELEMENT}return a});e(ve.PeHorizon.prototype,"getCoord",h=>function(d=!1){const a=this.getSize();if(!a)return null;const v=[];return qu(v,a,h.call(this),d),v}),e(ve.PeGTlistExtendedEntry.prototype,"getEntries",h=>{const d=ve._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const v=h.call(this);if(!ve.compare(v,ve.NULL)){a=[v];const T=this.getSteps();if(T>1){const E=ve.getPointer(v);for(let k=1;k<T;k++)a.push(ve.wrapPointer(E+d*k,ve.PeGTlistExtendedGTs))}}return a}});const r=ve._pe_getPeHorizonSize(),o=h=>function(){let d=this._cache;if(d||(d=new Map,this._cache=d),d.has(h))return d.get(h);let a=null;const v=h.call(this);if(!ve.compare(v,ve.NULL)){a=[v];const T=v.getNump();if(T>1){const E=ve.getPointer(v);for(let k=1;k<T;k++)a.push(ve.wrapPointer(E+r*k,ve.PeHorizon))}}return d.set(h,a),a};e(ve.PeProjcs.prototype,"horizonGcsGenerate",o),e(ve.PeProjcs.prototype,"horizonPcsGenerate",o),ve.PeObject.prototype.toString=function(h=gr.PE_STR_OPTS_NONE){ve.ensureCache.prepare();const d=ve.getPointer(this),a=ve.ensureInt8(new Array(gr.PE_BUFFER_MAX));return ve.UTF8ToString(ve._pe_object_to_string_ext(d,h,a))},ve.PeGeogcs.prototype.destroy=function(){this.Delete(),ga(this),this.ptr=0},ve.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},ve.PeProjcs.prototype.destroy=function(){this.Delete(),ga(this),this.ptr=0},ve.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function ga(t){if(!t)return;const e=ve.getClass(t);if(!e)return;const i=ve.getCache(e);if(!i)return;const r=ve.getPointer(t);r&&delete i[r]}function Uw(t,e){const i=[],r=new Array(e);for(let o=0;o<t;o++)i.push(ve.ensureInt8(r));return i}function Sd(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function qu(t,e,i,r=!1){if(r)for(let o=0;o<2*e;o++)t[o]=ve.getValue(i+o*Float64Array.BYTES_PER_ELEMENT,"double");else{const o=t.length===0;for(let h=0;h<e;h++)o&&(t[h]=new Array(2)),t[h][0]=ve.getValue(i,"double"),t[h][1]=ve.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}const Lge=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:Vb,PeDefs:gr,get PeDouble(){return TN},PeFactory:af,get PeGCSExtent(){return CN},PeGTTransformations:Foe,PeGTlistExtended:DP,PeGTlistExtendedEntry:Loe,PeLineType:Noe,PeMath:Boe,PeNotationDms:joe,PeNotationMgrs:EN,PeNotationUsng:Uoe,PeNotationUtm:IN,PePCSInfo:$N,PeVersion:Voe,_init:PN,get _pe(){return ve},isLoaded:zoe,isSupported:Ooe,load:Roe},Symbol.toStringTag,{value:"Module"}));let y;const Z={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(y=2e3;y<=2045;y++)Z[y]=0;for(y=2056;y<=2065;y++)Z[y]=0;for(y=2067;y<=2135;y++)Z[y]=0;for(y=2137;y<=2154;y++)Z[y]=0;for(y=2161;y<=2170;y++)Z[y]=0;for(y=2172;y<=2193;y++)Z[y]=0;for(y=2195;y<=2198;y++)Z[y]=0;for(y=2200;y<=2203;y++)Z[y]=0;for(y=2205;y<=2217;y++)Z[y]=0;for(y=2222;y<=2224;y++)Z[y]=1;for(y=2225;y<=2250;y++)Z[y]=2;for(y=2251;y<=2253;y++)Z[y]=1;for(y=2257;y<=2264;y++)Z[y]=2;for(y=2274;y<=2279;y++)Z[y]=2;for(y=2280;y<=2282;y++)Z[y]=1;for(y=2283;y<=2289;y++)Z[y]=2;for(y=2290;y<=2292;y++)Z[y]=0;for(y=2308;y<=2313;y++)Z[y]=0;for(y=2315;y<=2491;y++)Z[y]=0;for(y=2494;y<=2866;y++)Z[y]=0;for(y=2867;y<=2869;y++)Z[y]=1;for(y=2870;y<=2888;y++)Z[y]=2;for(y=2891;y<=2895;y++)Z[y]=2;for(y=2896;y<=2898;y++)Z[y]=1;for(y=2902;y<=2908;y++)Z[y]=2;for(y=2915;y<=2920;y++)Z[y]=2;for(y=2921;y<=2923;y++)Z[y]=1;for(y=2924;y<=2930;y++)Z[y]=2;for(y=2931;y<=2962;y++)Z[y]=0;for(y=2964;y<=2968;y++)Z[y]=2;for(y=2969;y<=2973;y++)Z[y]=0;for(y=2975;y<=2991;y++)Z[y]=0;for(y=2995;y<=3051;y++)Z[y]=0;for(y=3054;y<=3079;y++)Z[y]=0;for(y=3081;y<=3088;y++)Z[y]=0;for(y=3092;y<=3101;y++)Z[y]=0;for(y=3106;y<=3138;y++)Z[y]=0;for(y=3146;y<=3151;y++)Z[y]=0;for(y=3153;y<=3166;y++)Z[y]=0;for(y=3168;y<=3172;y++)Z[y]=0;for(y=3174;y<=3203;y++)Z[y]=0;for(y=3294;y<=3358;y++)Z[y]=0;for(y=3367;y<=3403;y++)Z[y]=0;for(y=3408;y<=3416;y++)Z[y]=0;for(y=3417;y<=3438;y++)Z[y]=2;for(y=3441;y<=3446;y++)Z[y]=2;for(y=3447;y<=3450;y++)Z[y]=0;for(y=3451;y<=3459;y++)Z[y]=2;for(y=3460;y<=3478;y++)Z[y]=0;for(y=3554;y<=3559;y++)Z[y]=0;for(y=3560;y<=3570;y++)Z[y]=2;for(y=3571;y<=3581;y++)Z[y]=0;for(y=3594;y<=3597;y++)Z[y]=0;for(y=3601;y<=3604;y++)Z[y]=0;for(y=3637;y<=3639;y++)Z[y]=0;for(y=3665;y<=3667;y++)Z[y]=0;for(y=3693;y<=3695;y++)Z[y]=0;for(y=3701;y<=3727;y++)Z[y]=0;for(y=3728;y<=3739;y++)Z[y]=2;for(y=3740;y<=3751;y++)Z[y]=0;for(y=3753;y<=3760;y++)Z[y]=2;for(y=3761;y<=3773;y++)Z[y]=0;for(y=3775;y<=3777;y++)Z[y]=0;for(y=3779;y<=3781;y++)Z[y]=0;for(y=3783;y<=3785;y++)Z[y]=0;for(y=3788;y<=3791;y++)Z[y]=0;for(y=3797;y<=3802;y++)Z[y]=0;for(y=3814;y<=3816;y++)Z[y]=0;for(y=3825;y<=3829;y++)Z[y]=0;for(y=3832;y<=3841;y++)Z[y]=0;for(y=3844;y<=3852;y++)Z[y]=0;for(y=3873;y<=3885;y++)Z[y]=0;for(y=3890;y<=3893;y++)Z[y]=0;for(y=3907;y<=3912;y++)Z[y]=0;for(y=3942;y<=3950;y++)Z[y]=0;for(y=3968;y<=3970;y++)Z[y]=0;for(y=3973;y<=3976;y++)Z[y]=0;for(y=3986;y<=3989;y++)Z[y]=0;for(y=3994;y<=3997;y++)Z[y]=0;for(y=4048;y<=4051;y++)Z[y]=0;for(y=4056;y<=4063;y++)Z[y]=0;for(y=4093;y<=4096;y++)Z[y]=0;for(y=4390;y<=4398;y++)Z[y]=0;for(y=4399;y<=4413;y++)Z[y]=2;for(y=4418;y<=4433;y++)Z[y]=2;for(y=4455;y<=4457;y++)Z[y]=2;for(y=4484;y<=4489;y++)Z[y]=0;for(y=4491;y<=4554;y++)Z[y]=0;for(y=4568;y<=4589;y++)Z[y]=0;for(y=4652;y<=4656;y++)Z[y]=0;for(y=4766;y<=4800;y++)Z[y]=0;for(y=5014;y<=5016;y++)Z[y]=0;for(y=5069;y<=5072;y++)Z[y]=0;for(y=5105;y<=5130;y++)Z[y]=0;for(y=5167;y<=5188;y++)Z[y]=0;for(y=5253;y<=5259;y++)Z[y]=0;for(y=5269;y<=5275;y++)Z[y]=0;for(y=5292;y<=5311;y++)Z[y]=0;for(y=5329;y<=5331;y++)Z[y]=0;for(y=5343;y<=5349;y++)Z[y]=0;for(y=5355;y<=5357;y++)Z[y]=0;for(y=5387;y<=5389;y++)Z[y]=0;for(y=5459;y<=5463;y++)Z[y]=0;for(y=5479;y<=5482;y++)Z[y]=0;for(y=5518;y<=5520;y++)Z[y]=0;for(y=5530;y<=5539;y++)Z[y]=0;for(y=5550;y<=5552;y++)Z[y]=0;for(y=5562;y<=5583;y++)Z[y]=0;for(y=5623;y<=5625;y++)Z[y]=2;for(y=5631;y<=5639;y++)Z[y]=0;for(y=5649;y<=5653;y++)Z[y]=0;for(y=5663;y<=5680;y++)Z[y]=0;for(y=5682;y<=5685;y++)Z[y]=0;for(y=5875;y<=5877;y++)Z[y]=0;for(y=5896;y<=5899;y++)Z[y]=0;for(y=5921;y<=5940;y++)Z[y]=0;for(y=6050;y<=6125;y++)Z[y]=0;for(y=6244;y<=6275;y++)Z[y]=0;for(y=6328;y<=6348;y++)Z[y]=0;for(y=6350;y<=6356;y++)Z[y]=0;for(y=6366;y<=6372;y++)Z[y]=0;for(y=6381;y<=6387;y++)Z[y]=0;for(y=6393;y<=6404;y++)Z[y]=0;for(y=6480;y<=6483;y++)Z[y]=0;for(y=6511;y<=6514;y++)Z[y]=0;for(y=6579;y<=6581;y++)Z[y]=0;for(y=6619;y<=6624;y++)Z[y]=0;for(y=6625;y<=6627;y++)Z[y]=2;for(y=6628;y<=6632;y++)Z[y]=0;for(y=6634;y<=6637;y++)Z[y]=0;for(y=6669;y<=6692;y++)Z[y]=0;for(y=6707;y<=6709;y++)Z[y]=0;for(y=6720;y<=6723;y++)Z[y]=0;for(y=6732;y<=6738;y++)Z[y]=0;for(y=6931;y<=6933;y++)Z[y]=0;for(y=6956;y<=6959;y++)Z[y]=0;for(y=7005;y<=7007;y++)Z[y]=0;for(y=7057;y<=7070;y++)Z[y]=2;for(y=7074;y<=7082;y++)Z[y]=0;for(y=7109;y<=7118;y++)Z[y]=0;for(y=7119;y<=7127;y++)Z[y]=1;for(y=7374;y<=7376;y++)Z[y]=0;for(y=7528;y<=7586;y++)Z[y]=0;for(y=7587;y<=7645;y++)Z[y]=2;for(y=7692;y<=7696;y++)Z[y]=0;for(y=7755;y<=7787;y++)Z[y]=0;for(y=7791;y<=7795;y++)Z[y]=0;for(y=7799;y<=7801;y++)Z[y]=0;for(y=7803;y<=7805;y++)Z[y]=0;for(y=7825;y<=7831;y++)Z[y]=0;for(y=7845;y<=7859;y++)Z[y]=0;for(y=8013;y<=8032;y++)Z[y]=0;for(y=8065;y<=8068;y++)Z[y]=1;for(y=8518;y<=8529;y++)Z[y]=2;for(y=8533;y<=8536;y++)Z[y]=2;for(y=8538;y<=8540;y++)Z[y]=2;for(y=8677;y<=8679;y++)Z[y]=0;for(y=8836;y<=8840;y++)Z[y]=0;for(y=8857;y<=8859;y++)Z[y]=0;for(y=8908;y<=8910;y++)Z[y]=0;for(y=9154;y<=9159;y++)Z[y]=0;for(y=9205;y<=9218;y++)Z[y]=0;for(y=9271;y<=9273;y++)Z[y]=0;for(y=9295;y<=9297;y++)Z[y]=0;for(y=9356;y<=9360;y++)Z[y]=0;for(y=9404;y<=9407;y++)Z[y]=0;for(y=9476;y<=9482;y++)Z[y]=0;for(y=9487;y<=9494;y++)Z[y]=0;for(y=9697;y<=9699;y++)Z[y]=0;for(y=9821;y<=9865;y++)Z[y]=0;for(y=10285;y<=10291;y++)Z[y]=0;for(y=10314;y<=10317;y++)Z[y]=0;for(y=10448;y<=10465;y++)Z[y]=0;for(y=10726;y<=10729;y++)Z[y]=0;for(y=10731;y<=10733;y++)Z[y]=0;for(y=11114;y<=11118;y++)Z[y]=0;for(y=20004;y<=20032;y++)Z[y]=0;for(y=20047;y<=20049;y++)Z[y]=0;for(y=20062;y<=20092;y++)Z[y]=0;for(y=20135;y<=20138;y++)Z[y]=0;for(y=20248;y<=20258;y++)Z[y]=0;for(y=20348;y<=20358;y++)Z[y]=0;for(y=20436;y<=20440;y++)Z[y]=0;for(y=20822;y<=20824;y++)Z[y]=0;for(y=20904;y<=20932;y++)Z[y]=0;for(y=20934;y<=20936;y++)Z[y]=0;for(y=21004;y<=21032;y++)Z[y]=0;for(y=21035;y<=21037;y++)Z[y]=0;for(y=21095;y<=21097;y++)Z[y]=0;for(y=21148;y<=21150;y++)Z[y]=0;for(y=21207;y<=21264;y++)Z[y]=0;for(y=21307;y<=21364;y++)Z[y]=0;for(y=21413;y<=21423;y++)Z[y]=0;for(y=21453;y<=21463;y++)Z[y]=0;for(y=21473;y<=21483;y++)Z[y]=0;for(y=21780;y<=21782;y++)Z[y]=0;for(y=21891;y<=21894;y++)Z[y]=0;for(y=21896;y<=21899;y++)Z[y]=0;for(y=22171;y<=22177;y++)Z[y]=0;for(y=22181;y<=22187;y++)Z[y]=0;for(y=22191;y<=22197;y++)Z[y]=0;for(y=22207;y<=22222;y++)Z[y]=0;for(y=22229;y<=22232;y++)Z[y]=0;for(y=22234;y<=22236;y++)Z[y]=0;for(y=22243;y<=22250;y++)Z[y]=0;for(y=22262;y<=22265;y++)Z[y]=0;for(y=22307;y<=22322;y++)Z[y]=0;for(y=22348;y<=22357;y++)Z[y]=0;for(y=22407;y<=22422;y++)Z[y]=0;for(y=22462;y<=22465;y++)Z[y]=0;for(y=22521;y<=22525;y++)Z[y]=0;for(y=22607;y<=22622;y++)Z[y]=0;for(y=22641;y<=22646;y++)Z[y]=0;for(y=22648;y<=22657;y++)Z[y]=0;for(y=22707;y<=22722;y++)Z[y]=0;for(y=22762;y<=22765;y++)Z[y]=0;for(y=22807;y<=22822;y++)Z[y]=0;for(y=22991;y<=22994;y++)Z[y]=0;for(y=23028;y<=23038;y++)Z[y]=0;for(y=23301;y<=23333;y++)Z[y]=2;for(y=23830;y<=23853;y++)Z[y]=0;for(y=23866;y<=23872;y++)Z[y]=0;for(y=23877;y<=23884;y++)Z[y]=0;for(y=23886;y<=23894;y++)Z[y]=0;for(y=23946;y<=23948;y++)Z[y]=0;for(y=24311;y<=24313;y++)Z[y]=0;for(y=24342;y<=24347;y++)Z[y]=0;for(y=24370;y<=24374;y++)Z[y]=10;for(y=24375;y<=24381;y++)Z[y]=0;for(y=24718;y<=24721;y++)Z[y]=0;for(y=24817;y<=24821;y++)Z[y]=0;for(y=24877;y<=24882;y++)Z[y]=0;for(y=24891;y<=24893;y++)Z[y]=0;for(y=25391;y<=25395;y++)Z[y]=0;for(y=25828;y<=25838;y++)Z[y]=0;for(y=26191;y<=26195;y++)Z[y]=0;for(y=26391;y<=26393;y++)Z[y]=0;for(y=26701;y<=26722;y++)Z[y]=0;for(y=26729;y<=26799;y++)Z[y]=2;for(y=26801;y<=26803;y++)Z[y]=2;for(y=26811;y<=26813;y++)Z[y]=2;for(y=26847;y<=26870;y++)Z[y]=2;for(y=26891;y<=26899;y++)Z[y]=0;for(y=26901;y<=26923;y++)Z[y]=0;for(y=26929;y<=26946;y++)Z[y]=0;for(y=26948;y<=26998;y++)Z[y]=0;for(y=27037;y<=27040;y++)Z[y]=0;for(y=27205;y<=27232;y++)Z[y]=0;for(y=27258;y<=27260;y++)Z[y]=0;for(y=27391;y<=27398;y++)Z[y]=0;for(y=27561;y<=27564;y++)Z[y]=0;for(y=27571;y<=27574;y++)Z[y]=0;for(y=27581;y<=27584;y++)Z[y]=0;for(y=27591;y<=27594;y++)Z[y]=0;for(y=27700;y<=27707;y++)Z[y]=0;for(y=28191;y<=28193;y++)Z[y]=0;for(y=28348;y<=28358;y++)Z[y]=0;for(y=28402;y<=28432;y++)Z[y]=0;for(y=28462;y<=28492;y++)Z[y]=0;for(y=29118;y<=29122;y++)Z[y]=0;for(y=29168;y<=29172;y++)Z[y]=0;for(y=29177;y<=29185;y++)Z[y]=0;for(y=29187;y<=29195;y++)Z[y]=0;for(y=29900;y<=29903;y++)Z[y]=0;for(y=30161;y<=30179;y++)Z[y]=0;for(y=30491;y<=30494;y++)Z[y]=0;for(y=30729;y<=30732;y++)Z[y]=0;for(y=31251;y<=31259;y++)Z[y]=0;for(y=31265;y<=31268;y++)Z[y]=0;for(y=31275;y<=31279;y++)Z[y]=0;for(y=31281;y<=31297;y++)Z[y]=0;for(y=31461;y<=31469;y++)Z[y]=0;for(y=31491;y<=31495;y++)Z[y]=0;for(y=31917;y<=31922;y++)Z[y]=0;for(y=31965;y<=32e3;y++)Z[y]=0;for(y=32001;y<=32003;y++)Z[y]=2;for(y=32005;y<=32031;y++)Z[y]=2;for(y=32033;y<=32060;y++)Z[y]=2;for(y=32064;y<=32067;y++)Z[y]=2;for(y=32074;y<=32077;y++)Z[y]=2;for(y=32081;y<=32086;y++)Z[y]=0;for(y=32107;y<=32130;y++)Z[y]=0;for(y=32133;y<=32159;y++)Z[y]=0;for(y=32164;y<=32167;y++)Z[y]=2;for(y=32180;y<=32199;y++)Z[y]=0;for(y=32201;y<=32260;y++)Z[y]=0;for(y=32301;y<=32360;y++)Z[y]=0;for(y=32401;y<=32460;y++)Z[y]=0;for(y=32501;y<=32560;y++)Z[y]=0;for(y=32601;y<=32662;y++)Z[y]=0;for(y=32664;y<=32667;y++)Z[y]=2;for(y=32701;y<=32761;y++)Z[y]=0;for(y=53001;y<=53004;y++)Z[y]=0;for(y=53008;y<=53019;y++)Z[y]=0;for(y=53021;y<=53032;y++)Z[y]=0;for(y=53034;y<=53037;y++)Z[y]=0;for(y=53042;y<=53046;y++)Z[y]=0;for(y=53074;y<=53080;y++)Z[y]=0;for(y=54001;y<=54004;y++)Z[y]=0;for(y=54008;y<=54019;y++)Z[y]=0;for(y=54021;y<=54032;y++)Z[y]=0;for(y=54034;y<=54037;y++)Z[y]=0;for(y=54042;y<=54046;y++)Z[y]=0;for(y=54048;y<=54053;y++)Z[y]=0;for(y=54074;y<=54080;y++)Z[y]=0;for(y=54090;y<=54096;y++)Z[y]=0;for(y=54098;y<=54101;y++)Z[y]=0;for(y=65161;y<=65163;y++)Z[y]=0;for(y=102001;y<=102040;y++)Z[y]=0;for(y=102042;y<=102063;y++)Z[y]=0;for(y=102065;y<=102067;y++)Z[y]=0;for(y=102070;y<=102117;y++)Z[y]=0;for(y=102122;y<=102216;y++)Z[y]=0;for(y=102221;y<=102377;y++)Z[y]=0;for(y=102382;y<=102388;y++)Z[y]=0;for(y=102389;y<=102398;y++)Z[y]=2;for(y=102399;y<=102444;y++)Z[y]=0;for(y=102445;y<=102447;y++)Z[y]=2;for(y=102448;y<=102458;y++)Z[y]=0;for(y=102459;y<=102468;y++)Z[y]=2;for(y=102469;y<=102499;y++)Z[y]=0;for(y=102500;y<=102519;y++)Z[y]=1;for(y=102520;y<=102524;y++)Z[y]=0;for(y=102525;y<=102529;y++)Z[y]=2;for(y=102530;y<=102588;y++)Z[y]=0;for(y=102590;y<=102598;y++)Z[y]=0;for(y=102601;y<=102603;y++)Z[y]=0;for(y=102605;y<=102628;y++)Z[y]=0;for(y=102629;y<=102646;y++)Z[y]=2;for(y=102648;y<=102700;y++)Z[y]=2;for(y=102701;y<=102703;y++)Z[y]=0;for(y=102707;y<=102730;y++)Z[y]=2;for(y=102733;y<=102758;y++)Z[y]=2;for(y=102767;y<=102900;y++)Z[y]=0;for(y=102901;y<=102933;y++)Z[y]=2;for(y=102934;y<=102950;y++)Z[y]=13;for(y=102951;y<=102963;y++)Z[y]=0;for(y=102965;y<=102969;y++)Z[y]=0;for(y=102971;y<=102973;y++)Z[y]=0;for(y=102975;y<=102989;y++)Z[y]=0;for(y=102990;y<=102992;y++)Z[y]=1;for(y=102997;y<=103002;y++)Z[y]=0;for(y=103003;y<=103008;y++)Z[y]=2;for(y=103009;y<=103011;y++)Z[y]=0;for(y=103012;y<=103014;y++)Z[y]=2;for(y=103019;y<=103021;y++)Z[y]=0;for(y=103022;y<=103024;y++)Z[y]=2;for(y=103029;y<=103031;y++)Z[y]=0;for(y=103032;y<=103034;y++)Z[y]=2;for(y=103065;y<=103068;y++)Z[y]=0;for(y=103074;y<=103076;y++)Z[y]=0;for(y=103077;y<=103079;y++)Z[y]=1;for(y=103080;y<=103082;y++)Z[y]=0;for(y=103083;y<=103085;y++)Z[y]=2;for(y=103090;y<=103093;y++)Z[y]=0;for(y=103097;y<=103099;y++)Z[y]=0;for(y=103100;y<=103102;y++)Z[y]=2;for(y=103107;y<=103109;y++)Z[y]=0;for(y=103110;y<=103112;y++)Z[y]=2;for(y=103113;y<=103116;y++)Z[y]=0;for(y=103117;y<=103120;y++)Z[y]=2;for(y=103153;y<=103157;y++)Z[y]=0;for(y=103158;y<=103162;y++)Z[y]=2;for(y=103163;y<=103165;y++)Z[y]=0;for(y=103166;y<=103168;y++)Z[y]=1;for(y=103169;y<=103171;y++)Z[y]=2;for(y=103186;y<=103188;y++)Z[y]=0;for(y=103189;y<=103191;y++)Z[y]=2;for(y=103192;y<=103195;y++)Z[y]=0;for(y=103196;y<=103199;y++)Z[y]=2;for(y=103200;y<=103224;y++)Z[y]=0;for(y=103225;y<=103227;y++)Z[y]=1;for(y=103232;y<=103237;y++)Z[y]=0;for(y=103238;y<=103243;y++)Z[y]=2;for(y=103244;y<=103246;y++)Z[y]=0;for(y=103247;y<=103249;y++)Z[y]=2;for(y=103254;y<=103256;y++)Z[y]=0;for(y=103257;y<=103259;y++)Z[y]=2;for(y=103264;y<=103266;y++)Z[y]=0;for(y=103267;y<=103269;y++)Z[y]=2;for(y=103300;y<=103375;y++)Z[y]=0;for(y=103381;y<=103383;y++)Z[y]=0;for(y=103384;y<=103386;y++)Z[y]=1;for(y=103387;y<=103389;y++)Z[y]=0;for(y=103390;y<=103392;y++)Z[y]=2;for(y=103397;y<=103399;y++)Z[y]=0;for(y=103400;y<=103471;y++)Z[y]=2;for(y=103476;y<=103478;y++)Z[y]=0;for(y=103479;y<=103481;y++)Z[y]=2;for(y=103486;y<=103488;y++)Z[y]=0;for(y=103489;y<=103491;y++)Z[y]=2;for(y=103492;y<=103495;y++)Z[y]=0;for(y=103496;y<=103499;y++)Z[y]=2;for(y=103528;y<=103543;y++)Z[y]=0;for(y=103544;y<=103548;y++)Z[y]=2;for(y=103549;y<=103551;y++)Z[y]=0;for(y=103552;y<=103554;y++)Z[y]=1;for(y=103555;y<=103557;y++)Z[y]=2;for(y=103558;y<=103560;y++)Z[y]=0;for(y=103571;y<=103573;y++)Z[y]=0;for(y=103574;y<=103576;y++)Z[y]=2;for(y=103577;y<=103580;y++)Z[y]=0;for(y=103581;y<=103583;y++)Z[y]=2;for(y=103595;y<=103694;y++)Z[y]=0;for(y=103696;y<=103699;y++)Z[y]=0;for(y=103700;y<=103793;y++)Z[y]=2;for(y=103794;y<=103890;y++)Z[y]=0;for(y=103891;y<=103896;y++)Z[y]=2;for(y=103900;y<=103971;y++)Z[y]=2;for(y=103972;y<=103977;y++)Z[y]=0;for(y=112e3;y<=112101;y++)Z[y]=0;const MN=[102100,102113,3857,3785,900913],Goe=[104905,104971],qoe=[104903],Hoe=[4326,...MN,...Goe,...qoe],B0=[-20037508342788905e-9,20037508342788905e-9],WE=[-20037508342787e-6,20037508342787e-6],MT={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:B0,origin:WE,dx:1e-5},kN={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:B0,origin:WE,dx:1e-5},102100:MT,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:B0,origin:WE,dx:1e-5},3857:MT,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:MT,104903:{wkTemplate:'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400,0,AUTHORITY["ESRI","107903"]],AUTHORITY["ESRI","106903"]],PRIMEM["Reference_Meridian",0,AUTHORITY["ESRI","108900"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["ESRI","104903"]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Td(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const i=t.wkid,r=e.wkid;if(i!=null||r!=null){if(i===r||Cd(t)&&Cd(e))return!0;const d=t.latestWkid;if(d!=null&&r===d)return!0;const a=e.latestWkid;return a!=null&&i===a}let o,h;return t.wkt2&&e.wkt2?(o=t.wkt2,h=e.wkt2):t.wkt&&e.wkt&&(o=t.wkt,h=e.wkt),!(!o||!h)&&o.toUpperCase()===h.toUpperCase()}function qb(t){const e=t?.wkid;return e!=null&&e>=2e3&&kN[e]||null}function sz(t){if(!t)return;const{wkid:e,vcsWkid:i}=t;if(e)return i?JSON.stringify({wkid:e,vcsWkid:i}):String(e);const r=t.wkt||t.wkt2;return JSON.stringify(r?i?{wkt:r,vcsWkid:i}:{wkt:r}:{})}function mv(t){if(!AN(t))return!1;const{wkid:e}=t;if(e)return Z[e]==null;const i=t.wkt2||t.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function Zoe(t){return!(Woe(t)||Yoe(t))}function _1(t){return t?.wkid===4326}function Fge(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function Nge(t){return t?.wkid===4490}function Cd(t){const e=t?.wkid;return e!=null&&e>=2e3&&MN.includes(e)}function Bge(t){return t?.wkid===32662}function Vw(t){return t===104971||t===104905}function Woe(t){return Vw(t?.wkid)}function Gw(t){return t===104903}function Yoe(t){return Gw(t?.wkid)}function Xoe(t){const e=t?.wkid;return e!=null&&e>=2e3&&Hoe.includes(e)}function AN(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const DN={wkid:4326,wkt:U$(kN[4326].wkTemplate,{Central_Meridian:"0.0"})},zN={wkid:102100,latestWkid:3857},Joe={wkid:32662};function zP(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const Koe=zP(Pa),ON=zP(N0),RN=zP(jw),jge={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Pa.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},Qoe=ON.wkt.toUpperCase(),eae=RN.wkt.toUpperCase();function tae(t){if(t!=null&&AN(t)){const e=t.wkid,i=t.wkt2??t.wkt;if(Vw(e))return N0;const r=i?.toUpperCase();if(i&&r===Qoe)return N0;if(Gw(e)||r&&r===eae)return jw}return Pa}function Uge(t){return Vw(t)?N0:Gw(t)?jw:Pa}function iae(t){return Td(t,Koe)}function Vge(t){return iae(t)||Td(t,ON)||Td(t,RN)}const LN=39.37,rae=Pa.radius*Math.PI/200,FN=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,gm=Z,NN=/UNIT\[([^\]]+)]/i,nae=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),sae=_o()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),da=t=>t*t,uu=t=>t*t*t,j0={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:da(.001)},"square-centimeters":{inBaseUnits:da(.01)},"square-decimeters":{inBaseUnits:da(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:da(1e3)},"square-inches":{inBaseUnits:da(.0254)},"square-feet":{inBaseUnits:da(.3048)},"square-yards":{inBaseUnits:da(.9144)},"square-miles":{inBaseUnits:da(1609.344)},"square-nautical-miles":{inBaseUnits:da(1852)},"square-us-feet":{inBaseUnits:da(1200/3937)},acres:{inBaseUnits:.0015625*da(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*uu(.001)},"cubic-centimeters":{inBaseUnits:1e3*uu(.01)},"cubic-decimeters":{inBaseUnits:1e3*uu(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*uu(1e3)},"cubic-inches":{inBaseUnits:1e3*uu(.0254)},"cubic-feet":{inBaseUnits:1e3*uu(.3048)},"cubic-yards":{inBaseUnits:1e3*uu(.9144)},"cubic-miles":{inBaseUnits:1e3*uu(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},oae=(()=>{const t={};for(const e in j0)for(const i in j0[e].units)t[i]=e;return t})();function aae(t,e,i){return t*j0[i].units[e].inBaseUnits}function lae(t,e,i){return t/j0[i].units[e].inBaseUnits}const cae=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function YE(t){const e=oae[t];if(!e)throw new Error("unknown type");return e}function oz(t,e=null){return e=e||YE(t),j0[e].baseUnit===t}function U0(t,e,i){if(e===i)return t;const r=YE(e);if(r!==YE(i))throw new Error("incompatible units");const o=oz(e,r)?t:aae(t,e,r);return oz(i,r)?o:lae(o,i,r)}function Gge(t,e,i,r=!1){if(!r&&mv(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const o=gv(e);return o!==i&&(t=o?U0(t,o,i):U0(t*=Sc(e),"meters",i)),t}function qge(t,e,i,r=!1){if(!r&&mv(i))throw new Error("Unable to convert from a linear unit to an angular unit.");const o=gv(i);return e!==o&&(t=o?U0(t,e,o):U0(t,e,"meters")/Sc(i)),t}function Hge(t,e,i){return U0(t,e,"meters")/(i*Math.PI/180)}function BN(t){return sae.fromJSON(t.toLowerCase())||null}function Zge(t){if(t!=null&&!Zoe(t))return 1;const e=Sc(t);return e>1e5?1:e}function Wge(t){return Sc(t)>=tae(t).metersPerDegree?"meters":gv(t)}function Sc(t,e=Pa.metersPerDegree){return uae(t,!0)??e}function uae(t,e=!1){const i=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let o=null;if(i){if(Vw(i))return N0.metersPerDegree;if(Gw(i))return jw.metersPerDegree;o=gm.values[gm[i]],!o&&e&&nae.has(i)&&(o=rae)}else r&&(VN(r)?o=az(FN.exec(r),o):UN(r)&&(o=az(NN.exec(r),o)));return o}function Yge(t){return mv(t)?1:Sc(t)}function az(t,e){return t?.[1]?jN(t[1]):e}function jN(t){return parseFloat(t.split(",")[1])}function gv(t){const e=t?.wkid??null,i=t?.wkt2??t?.wkt??null;let r=null;if(e)r=gm.units[gm[e]];else if(i){const o=VN(i)?FN:UN(i)?NN:null;if(o){const h=o.exec(i);h?.[1]&&(r=dae(h[1]))}}return r!=null?BN(r):null}function Xge(t){const e=gv(t);return e==null?null:cae.get(e)}function UN(t){return/^GEOCCS/i.test(t)}function VN(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const hae=1e-7;function dae(t){let i=/[\\"']([^\\"']+)/.exec(t)?.[1];if(!i||!BN(i)){const r=jN(t);i=null;const o=gm.values;for(let h=0;h<o.length;++h)if(Math.abs(r-o[h])<hae){i=gm.units[h];break}}return i}const pae={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},fae={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},mae={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},Jge=_o()(pae),Kge=_o()(fae),Qge=_o()(mae);var il,hl;let Ft=(hl=class extends Nt{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return il.WebMercator;if(e?.wkid===4326)return il.WGS84;const i=new il;return i.read(e),i}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return _1(this)}get isWebMercator(){return Cd(this)}get isGeographic(){return mv(this)}get isWrappable(){return Xoe(this)}get metersPerUnit(){return Sc(this)}get unit(){return gv(this)||(this.isGeographic?"degrees":null)}writeWkt(e,i){this.wkid||(i.wkt=e)}clone(){if(this===il.WGS84)return new il(DN);if(this===il.WebMercator)return new il(zN);const e=new il;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=ht(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:i,referenceServiceName:r}=e.imageCoordinateSystem,{geodataXform:o}=e.imageCoordinateSystem,h=this.imageCoordinateSystem;return i==null||o?JSON.stringify(h)===JSON.stringify(e.imageCoordinateSystem):r?h.id===i&&h.referenceServiceName===r:h.id===i}return Td(this,e)}toJSON(e){return this.write(void 0,e)}},il=hl,hl.GCS_NAD_1927=null,hl.WGS84=null,hl.WebMercator=null,hl.PlateCarree=null,hl);P([R({readOnly:!0})],Ft.prototype,"isWGS84",null),P([R({readOnly:!0})],Ft.prototype,"isWebMercator",null),P([R({readOnly:!0})],Ft.prototype,"isGeographic",null),P([R({readOnly:!0})],Ft.prototype,"isWrappable",null),P([R({type:Pr,json:{write:!0}})],Ft.prototype,"latestWkid",void 0),P([R({readOnly:!0})],Ft.prototype,"metersPerUnit",null),P([R({readOnly:!0})],Ft.prototype,"unit",null),P([R({type:Pr,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Ft.prototype,"wkid",void 0),P([R({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Ft.prototype,"wkt",void 0),P([Ui("wkt"),Ui("web-scene","wkt")],Ft.prototype,"writeWkt",null),P([R({type:String,json:{write:!1}})],Ft.prototype,"wkt2",void 0),P([R({type:Pr,json:{write:!0}})],Ft.prototype,"vcsWkid",void 0),P([R({type:Pr,json:{write:!0}})],Ft.prototype,"latestVcsWkid",void 0),P([R()],Ft.prototype,"imageCoordinateSystem",void 0),Ft=il=P([Ve("esri.geometry.SpatialReference")],Ft),Ft.prototype.toJSON.isDefaultToJSON=!0,Ft.GCS_NAD_1927=Ln.freeze(new Ft({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Ft.WGS84=Ln.freeze(new Ft(DN)),Ft.WebMercator=Ln.freeze(new Ft(zN)),Ft.PlateCarree=Ln.freeze(new Ft(Joe));let Hn=class extends Nt{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Ft.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,i){if(e instanceof Ft)return e;if(e!=null){const r=new Ft;return r.read(e,i),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,i){this.cache[e]=i}};P([R()],Hn.prototype,"type",void 0),P([R({readOnly:!0})],Hn.prototype,"cache",null),P([R({readOnly:!0})],Hn.prototype,"extent",null),P([R({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Hn.prototype,"hasM",void 0),P([R({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Hn.prototype,"hasZ",void 0),P([R({type:Ft,json:{write:!0},value:Ft.WGS84})],Hn.prototype,"spatialReference",void 0),P([Br("spatialReference")],Hn.prototype,"readSpatialReference",null),Hn=P([Ve("esri.geometry.Geometry")],Hn);function V0(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new Lt("internal:mesh","Mesh geometries are not supported for this operation")}function tye(t){t.forEach(V0)}const gae=57.29577951308232,yae=.017453292519943;function lz(t){return t*gae}function cz(t){return t*yae}function iye(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Pa.radius))}function XE(t){return t.wkid!=null||t.wkt!=null}const kT=[0,0];function b1(t,e,i,r,o){const h=t,d=o;if(d.spatialReference=i,"x"in h&&"x"in d)[d.x,d.y]=e(h.x,h.y,kT,r);else if("xmin"in h&&"xmin"in d)[d.xmin,d.ymin]=e(h.xmin,h.ymin,kT,r),[d.xmax,d.ymax]=e(h.xmax,h.ymax,kT,r);else if("paths"in h&&"paths"in d||"rings"in h&&"rings"in d){const a="paths"in h?h.paths:h.rings,v=[];let T;for(let E=0;E<a.length;E++){const k=a[E];T=[],v.push(T);for(let L=0;L<k.length;L++)T.push(e(k[L][0],k[L][1],[0,0],r)),k[L].length>2&&T[L].push(k[L][2]),k[L].length>3&&T[L].push(k[L][3])}"paths"in d?d.paths=v:d.rings=v}else if("points"in h&&"points"in d){const a=h.points,v=[];for(let T=0;T<a.length;T++)v[T]=e(a[T][0],a[T][1],[0,0],r),a[T].length>2&&v[T].push(a[T][2]),a[T].length>3&&v[T].push(a[T][3]);d.points=v}return o}function Hb(t,e){const i=t&&(XE(t)?t:t.spatialReference),r=e&&(XE(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!i||!r)&&(!!Td(r,i)||Cd(r)&&_1(i)||Cd(i)&&_1(r))}function GN(t,e){if(t==null)return null;const i=t.spatialReference,r=e&&(XE(e)?e:e.spatialReference);return Hb(i,r)?Td(i,r)?ht(t):Cd(r)?b1(t,bf,Ft.WebMercator,!1,ht(t)):_1(r)?b1(t,qw,Ft.WGS84,!1,ht(t)):null:null}function bf(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const r=cz(e);return i[0]=cz(t)*Pa.radius,i[1]=Pa.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),i}function qw(t,e,i=[0,0],r=!1){if(t===B0[0])i[0]=-180;else if(t===B0[1])i[0]=180;else{const o=lz(t/Pa.radius);i[0]=r?o:o-360*Math.floor((o+180)/360)}return i[1]=lz(Math.PI/2-2*Math.atan(Math.exp(-e/Pa.radius))),i}function Zb(t,e=!1,i=ht(t)){return V0(t),V0(i),b1(t,bf,Ft.WebMercator,e,i)}function nb(t,e=!1,i=ht(t)){return V0(t),V0(i),b1(t,qw,Ft.WGS84,e,i)}function vae(t,e){const i=t.x-e.x,r=t.y-e.y,o=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(i*i+r*r+o*o)}function _ae(t){return qN(t,HN)?.[0]??null}function bae(t){return qN(t,HN)?.[1]??null}function qN({x:t,y:e,spatialReference:i},r=[0,0]){if(i){if(Cd(i))return qw(t,e,r);if(mv(i))return r[0]=t,r[1]=e,r}return null}const HN=[0,0];var Wb;const AT=[0,0];function uz(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let oi=Wb=class extends Hn{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Ln.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,r,o){let h;if(Array.isArray(t))h=t,o=e,t=h[0],e=h[1],i=h[2],r=h[3];else if(t&&typeof t=="object"){if(h=t,t=h.x!=null?h.x:h.longitude,e=h.y!=null?h.y:h.latitude,i=h.z,r=h.m,(o=h.spatialReference)&&o.declaredClass!=="esri.geometry.SpatialReference"&&(o=new Ft(o)),h.longitude!=null||h.latitude!=null){if(h.longitude==null)ui.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(h.latitude==null)ui.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!h.declaredClass&&o?.isWebMercator){const a=bf(h.longitude,h.latitude,AT);t=a[0],e=a[1]}}}else uz(i)?(o=i,i=null):uz(r)&&(o=r,r=null);const d={x:t,y:e};return d.x==null&&d.y!=null?ui.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):d.y==null&&d.x!=null&&ui.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),o!=null&&(d.spatialReference=o),i!=null&&(d.z=i),r!=null&&(d.m=r),d}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return bae(this)}set latitude(t){const{spatialReference:e,x:i}=this;t!=null&&e&&(e.isWebMercator?this._set("y",bf(i,t,AT)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return _ae(this)}set longitude(t){const{y:e,spatialReference:i}=this;t!=null&&i&&(i.isWebMercator?this._set("x",bf(t,e,AT)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new Wb;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return Wb.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:i,z:r,m:o,spatialReference:h}=this,{z:d,m:a}=t;let{x:v,y:T,spatialReference:E}=t;if(!h.equals(E))if(h.isWebMercator&&E.isWGS84)[v,T]=bf(v,T),E=h;else{if(!h.isWGS84||!E.isWebMercator)return!1;[v,T]=qw(v,T),E=h}return e===v&&i===T&&r===d&&o===a&&h.wkid===E.wkid}offset(t,e,i){return this.x+=t,this.y+=e,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=qb(this.spatialReference);if(!t)return this;let e=this.x;const[i,r]=t.valid,o=2*r;let h;return e>r?(h=Math.ceil(Math.abs(e-r)/o),e-=h*o):e<i&&(h=Math.ceil(Math.abs(e-i)/o),e+=h*o),this._set("x",e),this}distance(t){return vae(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};P([R({readOnly:!0})],oi.prototype,"cache",null),P([R({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],oi.prototype,"hasM",null),P([R({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],oi.prototype,"hasZ",null),P([R({type:Number})],oi.prototype,"latitude",null),P([R({type:Number})],oi.prototype,"longitude",null),P([R({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),dv(t=>isNaN(t)?t:zw(t))],oi.prototype,"x",void 0),P([Ui("x")],oi.prototype,"writeX",null),P([Br("x")],oi.prototype,"readX",null),P([R({type:Number,json:{write:!0}})],oi.prototype,"y",void 0),P([R({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],oi.prototype,"z",void 0),P([R({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],oi.prototype,"m",void 0),oi=Wb=P([Ve("esri.geometry.Point")],oi),oi.prototype.toJSON.isDefaultToJSON=!0;const DT=[0,0];function ZN(t,e){return e!=null&&hs(t,e.x,e.y,e.z)}function rye(t,e){if(!e.points?.length)return!1;for(const i of e.points)if(!ym(t,i))return!1;return!0}function xae(t,e){const{xmin:i,ymin:r,zmin:o,xmax:h,ymax:d,zmax:a}=e;return t.hasZ&&e.hasZ?hs(t,i,r,o)&&hs(t,i,d,o)&&hs(t,h,d,o)&&hs(t,h,r,o)&&hs(t,i,r,a)&&hs(t,i,d,a)&&hs(t,h,d,a)&&hs(t,h,r,a):hs(t,i,r)&&hs(t,i,d)&&hs(t,h,d)&&hs(t,h,r)}function ym(t,e){return hs(t,e[0],e[1])}function wae(t,e){return hs(t,e[0],e[1],e[2])}function hs(t,e,i,r){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(r==null||!t.hasZ||r>=t.zmin&&r<=t.zmax)}function Sae(t,e){return DT[1]=e.y,DT[0]=e.x,Tae(t,DT)}function Tae(t,e){return WN(t.rings,e)}function WN(t,e){if(!t||t.length<1)return!1;if(Cae(t))return hz(!1,t,e);let i=!1;for(let r=0,o=t.length;r<o;r++)i=hz(i,t[r],e);return i}function Cae(t){return!Array.isArray(t[0][0])}function hz(t,e,i){const[r,o]=i;let h=t,d=0;for(let a=0,v=e.length;a<v;a++){d++,d===v&&(d=0);const[T,E]=e[a],[k,L]=e[d];(E<o&&L>=o||L<o&&E>=o)&&T+(o-E)/(L-E)*(k-T)<r&&(h=!h)}return h}function Eae(t,e){return ZN(t,e)}function Iae(t,e){const i=t.hasZ&&e.hasZ;let r,o,h;if(t.xmin<=e.xmin){if(r=e.xmin,t.xmax<r)return!1}else if(r=t.xmin,e.xmax<r)return!1;if(t.ymin<=e.ymin){if(o=e.ymin,t.ymax<o)return!1}else if(o=t.ymin,e.ymax<o)return!1;if(i&&e.hasZ){if(t.zmin<=e.zmin){if(h=e.zmin,t.zmax<h)return!1}else if(h=t.zmin,e.zmax<h)return!1}return!0}function $ae(t,e){const{points:i,hasZ:r}=e,o=r?wae:ym;for(const h of i)if(o(t,h))return!0;return!1}const Ed=[0,0],Id=[0,0],$d=[0,0],Pd=[0,0],Pae=[Ed,Id,$d,Pd],YN=[[$d,Ed],[Ed,Id],[Id,Pd],[Pd,$d]];function Mae(t,e){return kae(t,e.rings)}function kae(t,e){Ed[0]=t.xmin,Ed[1]=t.ymax,Id[0]=t.xmax,Id[1]=t.ymax,$d[0]=t.xmin,$d[1]=t.ymin,Pd[0]=t.xmax,Pd[1]=t.ymin;for(const i of Pae)if(WN(e,i))return!0;for(const i of e){if(!i.length)continue;let r=i[0];if(ym(t,r))return!0;for(let o=1;o<i.length;o++){const h=i[o];if(ym(t,h)||XN(r,h,YN))return!0;r=h}}return!1}function Aae(t,e){Ed[0]=t.xmin,Ed[1]=t.ymax,Id[0]=t.xmax,Id[1]=t.ymax,$d[0]=t.xmin,$d[1]=t.ymin,Pd[0]=t.xmax,Pd[1]=t.ymin;const i=e.paths;for(const r of i){if(!i.length)continue;let o=r[0];if(ym(t,o))return!0;for(let h=1;h<r.length;h++){const d=r[h];if(ym(t,d)||XN(o,d,YN))return!0;o=d}}return!1}const vn=[0,0];function Dae(t){for(let e=0;e<t.length;e++){const i=t[e];for(let o=0;o<i.length-1;o++){const h=i[o],d=i[o+1];for(let a=e+1;a<t.length;a++)for(let v=0;v<t[a].length-1;v++){const T=t[a][v],E=t[a][v+1];if(JE(h,d,T,E,vn)&&!(vn[0]===h[0]&&vn[1]===h[1]||vn[0]===T[0]&&vn[1]===T[1]||vn[0]===d[0]&&vn[1]===d[1]||vn[0]===E[0]&&vn[1]===E[1]))return!0}}const r=i.length;if(!(r<=4))for(let o=0;o<r-3;o++){let h=r-1;o===0&&(h=r-2);const d=i[o],a=i[o+1];for(let v=o+2;v<h;v++){const T=i[v],E=i[v+1];if(JE(d,a,T,E,vn)&&!(vn[0]===d[0]&&vn[1]===d[1]||vn[0]===T[0]&&vn[1]===T[1]||vn[0]===a[0]&&vn[1]===a[1]||vn[0]===E[0]&&vn[1]===E[1]))return!0}}}return!1}function XN(t,e,i){for(let r=0;r<i.length;r++)if(JE(t,e,i[r][0],i[r][1]))return!0;return!1}function JE(t,e,i,r,o){const[h,d]=t,[a,v]=e,[T,E]=i,[k,L]=r,O=k-T,H=h-T,ie=a-h,pe=L-E,be=d-E,Ce=v-d,Pe=pe*ie-O*Ce;if(Pe===0)return!1;const Ie=(O*be-pe*H)/Pe,ke=(ie*be-Ce*H)/Pe;return Ie>=0&&Ie<=1&&ke>=0&&ke<=1&&(o&&(o[0]=h+Ie*(a-h),o[1]=d+Ie*(v-d)),!0)}function zae(t){switch(t){case"esriGeometryEnvelope":case"extent":return Iae;case"esriGeometryMultipoint":case"multipoint":return $ae;case"esriGeometryPoint":case"point":return Eae;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return Mae;case"esriGeometryPolyline":case"polyline":return Aae}}var fa;function Oae(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function hu(t,e,i){return e==null?i:i==null?e:t(e,i)}let _i=fa=class extends Hn{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,r,o){return Oae(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Ft.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:r,spatialReference:o??Ft.WGS84}}static fromPoint(t){return new fa({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new oi({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new fa;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Hb(e,i)&&(t=e.isWebMercator?Zb(t):nb(t,!0)),t.type==="point"?ZN(this,t):t.type==="extent"&&xae(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Hb(e,i)&&(t=e.isWebMercator?Zb(t):nb(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,r=this.height*e;if(this.xmin+=i,this.ymin+=r,this.xmax-=i,this.ymax-=r,this.hasZ){const o=(this.zmax-this.zmin)*e;this.zmin+=o,this.zmax-=o}if(this.hasM){const o=(this.mmax-this.mmin)*e;this.mmin+=o,this.mmax-=o}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!Td(e,i)&&Hb(e,i)&&(t=e.isWebMercator?Zb(t):nb(t,!0)),zae(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=hu(Math.min,this.zmin,t.zmin),this.zmax=hu(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=hu(Math.min,this.mmin,t.mmin),this.mmax=hu(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=hu(Math.max,this.zmin,t.zmin),this.zmax=hu(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=hu(Math.max,this.mmin,t.mmin),this.mmax=hu(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=qb(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const r=e.isWebMercator?nb(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(r.x=zT(r.x,t).x),this.spatialReference=new Ft(U$((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(t){let e=null;const[i,r]=t.valid,o=this.xmin,h=this.xmax;return o>=i&&o<=r&&h>=i&&h<=r||(e=this.center),e}_normalize(t,e,i){const r=this.spatialReference;if(!r)return this;const o=i??qb(r);if(o==null)return this;const h=this._getParts(o).map(v=>v.extent);if(h.length<2)return h[0]||this;if(h.length>2)return t?this._shiftCM(o):this.set({xmin:o.valid[0],xmax:o.valid[1]});if(t)return this._shiftCM(o);if(e)return h;let d=!0,a=!0;return h.forEach(v=>{v.hasZ||(d=!1),v.hasM||(a=!1)}),{rings:h.map(v=>{const T=[[v.xmin,v.ymin],[v.xmin,v.ymax],[v.xmax,v.ymax],[v.xmax,v.ymin],[v.xmin,v.ymin]];if(d){const E=(v.zmax-v.zmin)/2;for(let k=0;k<T.length;k++)T[k].push(E)}if(a){const E=(v.mmax-v.mmin)/2;for(let k=0;k<T.length;k++)T[k].push(E)}return T}),hasZ:d,hasM:a,spatialReference:r}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:o,ymax:h,spatialReference:d}=this,a=this.width,v=this.xmin,T=this.xmax;let E;t=t||qb(d);const[k,L]=t.valid;E=zT(this.xmin,t);const O=E.x,H=E.frameId;E=zT(this.xmax,t);const ie=E.x,pe=E.frameId,be=O===ie&&a>0;if(a>2*L){const Ce=new fa(v<T?O:ie,o,L,h,d),Pe=new fa(k,o,v<T?ie:O,h,d),Ie=new fa(0,o,L,h,d),ke=new fa(k,o,0,h,d),Ke=[],qe=[];Ce.contains(Ie)&&Ke.push(H),Ce.contains(ke)&&qe.push(H),Pe.contains(Ie)&&Ke.push(pe),Pe.contains(ke)&&qe.push(pe);for(let dt=H+1;dt<pe;dt++)Ke.push(dt),qe.push(dt);e.push({extent:Ce,frameIds:[H]},{extent:Pe,frameIds:[pe]},{extent:Ie,frameIds:Ke},{extent:ke,frameIds:qe})}else O>ie||be?e.push({extent:new fa(O,o,L,h,d),frameIds:[H]},{extent:new fa(k,o,ie,h,d),frameIds:[pe]}):e.push({extent:new fa(O,o,ie,h,d),frameIds:[H]});this.cache._parts=e}const i=this.hasZ,r=this.hasM;if(i||r){const o={};i&&(o.zmin=this.zmin,o.zmax=this.zmax),r&&(o.mmin=this.mmin,o.mmax=this.mmax);for(let h=0;h<e.length;h++)e[h].extent.set(o)}return e}};function zT(t,e){const[i,r]=e.valid,o=2*r;let h,d=0;return t>r?(h=Math.ceil(Math.abs(t-r)/o),t-=h*o,d=h):t<i&&(h=Math.ceil(Math.abs(t-i)/o),t+=h*o,d=-h),{x:t,frameId:d}}P([R({readOnly:!0})],_i.prototype,"cache",null),P([R({readOnly:!0})],_i.prototype,"center",null),P([R({readOnly:!0})],_i.prototype,"extent",null),P([R({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],_i.prototype,"hasM",null),P([R({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],_i.prototype,"hasZ",null),P([R({readOnly:!0})],_i.prototype,"height",null),P([R({readOnly:!0})],_i.prototype,"width",null),P([R({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],_i.prototype,"xmin",void 0),P([R({type:Number,json:{write:!0}})],_i.prototype,"ymin",void 0),P([R({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],_i.prototype,"mmin",void 0),P([R({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],_i.prototype,"zmin",void 0),P([R({type:Number,json:{write:!0}})],_i.prototype,"xmax",void 0),P([R({type:Number,json:{write:!0}})],_i.prototype,"ymax",void 0),P([R({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],_i.prototype,"mmax",void 0),P([R({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],_i.prototype,"zmax",void 0),_i=fa=P([Ve("esri.geometry.Extent")],_i),_i.prototype.toJSON.isDefaultToJSON=!0;function yv(t=jae){return[t[0],t[1],t[2],t[3]]}function JN(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function Rae(t,e,i,r,o=yv()){return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o}function nye(t,e=yv()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function sye(t,e,i=new _i){return i.xmin=t[0],i.ymin=t[1],i.xmax=t[2],i.ymax=t[3],i.spatialReference=e,i}function jo(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Lae(t,e){e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e)}function Fae(t,e){e<t[1]&&(t[1]=e),e>t[3]&&(t[3]=e)}function oye(t,e,i){if(e!=null)if("length"in e)KE(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else JN(i,t)}function Nae(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function Bae(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function aye(t){return Nae(t)*Bae(t)}function lye(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function dz(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function cye(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function uye(t,e,i){return Math.max(e[0],t[0])-i<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-i<=Math.min(e[3],t[3])}function hye(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function dye(t){return t?JN(t,pz):yv(pz)}function KE(t){return t!=null&&t.length===4}function pye(t,e){return KE(t)&&KE(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const pz=[1/0,1/0,-1/0,-1/0],jae=[0,0,0,0];let OP=1e-6;function Hw(){return OP}function Uae(t){OP=t}const KN=Math.random,Vae=Math.PI/180,Gae=180/Math.PI;function qae(t){return t*Vae}function Hae(t){return t*Gae}function Zae(t,e){return Math.abs(t-e)<=OP*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:KN,equals:Zae,getEpsilon:Hw,setEpsilon:Uae,toDegree:Hae,toRadian:qae},Symbol.toStringTag,{value:"Module"}));function Wae(t,e){return t[0]=e[0],t[1]=e[1],t}function Yae(t,e,i){return t[0]=e,t[1]=i,t}function Xae(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function QN(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function eB(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function tB(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function Jae(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Kae(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Qae(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function ele(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function tle(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function ile(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function rle(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t}function iB(t,e){const i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)}function RP(t,e){const i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r}function rB(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function nB(t){const e=t[0],i=t[1];return e*e+i*i}function nle(t,e){return t[0]=-e[0],t[1]=-e[1],t}function sle(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function ole(t,e){const i=e[0],r=e[1];let o=i*i+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t}function ale(t,e){return t[0]*e[0]+t[1]*e[1]}function lle(t,e,i){const r=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=r,t}function cle(t,e,i,r){const o=e[0],h=e[1];return t[0]=o+r*(i[0]-o),t[1]=h+r*(i[1]-h),t}function ule(t,e=1){const i=2*KN()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function hle(t,e,i){const r=e[0],o=e[1];return t[0]=i[0]*r+i[2]*o,t[1]=i[1]*r+i[3]*o,t}function dle(t,e,i){const r=e[0],o=e[1];return t[0]=i[0]*r+i[2]*o+i[4],t[1]=i[1]*r+i[3]*o+i[5],t}function ple(t,e,i){const r=e[0],o=e[1];return t[0]=i[0]*r+i[3]*o+i[6],t[1]=i[1]*r+i[4]*o+i[7],t}function fle(t,e,i){const r=e[0],o=e[1];return t[0]=i[0]*r+i[4]*o+i[12],t[1]=i[1]*r+i[5]*o+i[13],t}function mle(t,e,i,r){const o=e[0]-i[0],h=e[1]-i[1],d=Math.sin(r),a=Math.cos(r);return t[0]=o*a-h*d+i[0],t[1]=o*d+h*a+i[1],t}function gle(t,e){const i=t[0],r=t[1],o=e[0],h=e[1];let d=i*i+r*r;d>0&&(d=1/Math.sqrt(d));let a=o*o+h*h;a>0&&(a=1/Math.sqrt(a));const v=(i*o+r*h)*d*a;return v>1?0:v<-1?Math.PI:Math.acos(v)}function yle(t){return"vec2("+t[0]+", "+t[1]+")"}function vle(t,e){return t[0]===e[0]&&t[1]===e[1]}function _le(t,e){const i=t[0],r=t[1],o=e[0],h=e[1],d=Hw();return Math.abs(i-o)<=d*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-h)<=d*Math.max(1,Math.abs(r),Math.abs(h))}function ble(t,e,i,r,o){let h=e[0]-i[0],d=e[1]-i[1];const a=(r[0]*h+r[1]*d)*(o-1);return h=r[0]*a,d=r[1]*a,t[0]=e[0]+h,t[1]=e[1]+d,t}const xle=rB,wle=QN,Sle=eB,Tle=tB,Cle=iB,Ele=RP,Ile=nB;Object.freeze(Object.defineProperty({__proto__:null,add:Xae,angle:gle,ceil:Jae,copy:Wae,cross:lle,dist:Cle,distance:iB,div:Tle,divide:tB,dot:ale,equals:_le,exactEquals:vle,floor:Kae,inverse:sle,len:xle,length:rB,lerp:cle,max:ele,min:Qae,mul:Sle,multiply:eB,negate:nle,normalize:ole,projectAndScale:ble,random:ule,rotate:mle,round:tle,scale:ile,scaleAndAdd:rle,set:Yae,sqrDist:Ele,sqrLen:Ile,squaredDistance:RP,squaredLength:nB,str:yle,sub:wle,subtract:QN,transformMat2:hle,transformMat2d:dle,transformMat3:ple,transformMat4:fle},Symbol.toStringTag,{value:"Module"}));function uc(t,e,i,r){return t[0]=e[0]*(1-r)+i[0]*r,t[1]=e[1]*(1-r)+i[1]*r,t}function Go(t,e){return RP(t,e)}function $le(t,e,i,r,o){const[h,d]=e,[a,v]=i,[T,E]=r,[k,L]=o,O=(h-a)*(E-L)-(d-v)*(T-k);if(O===0)return null;const H=(h*v-d*a)*(T-k)-(h-a)*(T*L-E*k),ie=(h*v-d*a)*(E-L)-(d-v)*(T*L-E*k);return t[0]=H/O,t[1]=ie/O,t}const xa=2*Math.PI;function Xy(t,e){const i=Math.atan2(t,e);return i<0?i+xa:i}function sB(t){return Math.abs(t)%xa}function fz(t){const e=sB(t);return e<Math.PI?e:xa-e}function Zw(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function oB(t,e,i,r){if(Ta(sB(t-e),0))return i?[t,t]:[t,r?t-xa:t+xa];const[o,h]=r?[t-xa,t]:[t,t+xa];return[t,vv({min:o,max:h},e)]}function vv({min:t,max:e},i){let r;return r=e-i,r>=xa?(r-=r%xa,i+r):(r=i-t,r>=xa?(r-=r%xa,i-r):i)}function Ple(t,e){const i=vv(t,e);return i>t.min&&i<t.max?i:fz(i-t.min)<fz(i-t.max)?t.min:t.max}function aB(t,e,i,r=10){return e.map(o=>{let h=o;for(let d=0;d<r;d++){const[a,v,T,E,k,L]=i(h),O=t[0]-a,H=t[1]-v,ie=-T,pe=-E;h+=-(2*O*ie+2*H*pe)/(2*ie*ie+2*O*-k+2*pe*pe+2*H*-L||1e-6)}return h})}const Mle=[0,0];function lB(t){const e=1-t,i=e*e,r=t*t;return[i*e,3*t*i,3*r*e,r*t]}function mz(t,e,i,r,o){const[h,d,a,v]=lB(o);return[t[0]*h+e[0]*d+i[0]*a+r[0]*v,t[1]*h+e[1]*d+i[1]*a+r[1]*v]}function gz(t,e,i,r,o){const[h,d,a,v]=lB(o);return t*h+e*d+i*a+r*v}function kle(t,e,i){const r=t,[o,h,d]=e.b,a=uc([0,0],r,h,i),v=uc(Mle,h,d,i),T=uc([0,0],d,o,i),E=uc([0,0],a,v,i),k=uc([0,0],v,T,i);return[{b:[uc([],E,k,i),a,E]},{b:[[...o],k,T]}]}function fye(t,e,i){const r=t,[o,h,d]=e.b,a=aB(i,[.1,.5,.9],k=>{const L=1-k,[O,H]=mz(r,h,d,o,k);return[O,H,3*L*L*(h[0]-r[0])+6*L*k*(d[0]-h[0])+3*k*k*(o[0]-d[0]),3*L*L*(h[1]-r[1])+6*L*k*(d[1]-h[1])+3*k*k*(o[1]-d[1]),6*L*(d[0]-2*h[0]+r[0])+6*k*(o[0]-2*d[0]+h[0]),6*L*(d[1]-2*h[1]+r[1])+6*k*(o[1]-2*d[1]+h[1])]}).map(k=>Math.min(1,Math.max(0,k)));a.push(0,1);let v=1/0;const T=a.map(k=>{const L=mz(r,h,d,o,k),[O,H]=L,ie=i[0]-O,pe=i[1]-H,be=Math.sqrt(ie*ie+pe*pe);return v=Math.min(be,v),{t:k,curvePoint:L,distance:be}}),E=[];for(const k of T){const{t:L,distance:O}=k;fN(O,v)&&!E.some(({t:H})=>Ta(H,L))&&E.push(k)}return E}function Ale(t,e,i){const r=e,[o,h,d]=i.b;if(jo(t,r),jo(t,o),dz(t,h[0],h[1])&&dz(t,d[0],d[1]))return t;for(const a of yz(r[0],h[0],d[0],o[0]))a>0&&a<1&&Lae(t,gz(r[0],h[0],d[0],o[0],a));for(const a of yz(r[1],h[1],d[1],o[1]))a>0&&a<1&&Fae(t,gz(r[1],h[1],d[1],o[1],a));return t}function yz(t,e,i,r){const o=3*(3*(e-i)-t+r),h=6*(t-2*e+i),d=3*(e-t);if(o===0)return h!==0?[-d/h]:[];const a=Math.sqrt(h*h-4*o*d);return[(-h+a)/(2*o),(-h-a)/(2*o)]}function mye(t,e,i){let o=0,h=[e];for(let d=0;d<16;d++){let a=t;const v=[];for(const E of h)v.push(...kle(a,E,.5)),a=E.b[0];h=v,a=t,o=0;let T=0;for(const E of h){const[k,L,O]=E.b,H=Math.sqrt(Go(a,k));o+=(H+(Math.sqrt(Go(a,L))+Math.sqrt(Go(L,O))+Math.sqrt(Go(O,k))))/2,T+=H,a=k}if(o-T<i)return o}return o}function Dle(t,e,i){const[r,o]=t,[h,d]=e,[a,v]=i,[T,E]=[h-r,d-o];let k=T*(a-r)+E*(v-o);k/=T**2+E**2,k=fv(k,0,1);const L=uc([0,0],t,e,k);return{t:k,curvePoint:L,distance:Math.sqrt(Go(L,i))}}let cB=class{constructor(e,i,r,o,h,d){this.cx=e,this.cy=i,this.radius=r,this.thetaStart=o,this.thetaEnd=h,this.isInvalid=d}get startPoint(){const{cx:e,cy:i,radius:r,thetaStart:o}=this;return[e+r*Math.cos(o),i+r*Math.sin(o)]}get endPoint(){const{cx:e,cy:i,radius:r,thetaEnd:o}=this;return[e+r*Math.cos(o),i+r*Math.sin(o)]}};function x1(t,e){const{cx:i,cy:r,radius:o}=t;return[i+o*Math.cos(e),r+o*Math.sin(e)]}function Yb(t,e){if(t.isInvalid)return uc([0,0],t.startPoint,t.endPoint,e);const{thetaStart:i,thetaEnd:r}=t;return x1(t,i*(1-e)+r*e)}function yye(t,e){if(t.isInvalid)return Dle(t.startPoint,t.endPoint,e);const{cx:i,cy:r,thetaStart:o,thetaEnd:h}=t,[d,a]=e,v=Ple(Zw(o,h),Math.atan2(a-r,d-i)),T=x1(t,v);return{t:(v-o)/(h-o),curvePoint:T,distance:Math.sqrt(Go(e,T))}}function vz(t,e){if(e.isInvalid)return jo(t,e.startPoint),jo(t,e.endPoint),t;const{cx:i,cy:r,radius:o,thetaStart:h,thetaEnd:d}=e;jo(t,x1(e,h)),jo(t,x1(e,d));const a=Zw(h,d),v=Math.PI/2;let T=0;for(const E of[[i+o,r],[i,r+o],[i-o,r],[i,r-o]])T=vv(a,T),T>a.min&&T<a.max&&jo(t,E),T+=v;return t}function vye(t){if(t.isInvalid)return 2*t.radius;const{radius:e,thetaStart:i,thetaEnd:r}=t;return e*Math.abs(r-i)}function zle(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Ole(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Xb(t,e,i,r,o,h,d,a,v,T){return t[0]=e,t[1]=i,t[2]=r,t[3]=o,t[4]=h,t[5]=d,t[6]=a,t[7]=v,t[8]=T,t}function Rle(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lle(t,e){if(t===e){const i=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Fle(t,e){const i=e[0],r=e[1],o=e[2],h=e[3],d=e[4],a=e[5],v=e[6],T=e[7],E=e[8],k=E*d-a*T,L=-E*h+a*v,O=T*h-d*v;let H=i*k+r*L+o*O;return H?(H=1/H,t[0]=k*H,t[1]=(-E*r+o*T)*H,t[2]=(a*r-o*d)*H,t[3]=L*H,t[4]=(E*i-o*v)*H,t[5]=(-a*i+o*h)*H,t[6]=O*H,t[7]=(-T*i+r*v)*H,t[8]=(d*i-r*h)*H,t):null}function Nle(t,e){const i=e[0],r=e[1],o=e[2],h=e[3],d=e[4],a=e[5],v=e[6],T=e[7],E=e[8];return t[0]=d*E-a*T,t[1]=o*T-r*E,t[2]=r*a-o*d,t[3]=a*v-h*E,t[4]=i*E-o*v,t[5]=o*h-i*a,t[6]=h*T-d*v,t[7]=r*v-i*T,t[8]=i*d-r*h,t}function Jb(t){const e=t[0],i=t[1],r=t[2],o=t[3],h=t[4],d=t[5],a=t[6],v=t[7],T=t[8];return e*(T*h-d*v)+i*(-T*o+d*a)+r*(v*o-h*a)}function uB(t,e,i){const r=e[0],o=e[1],h=e[2],d=e[3],a=e[4],v=e[5],T=e[6],E=e[7],k=e[8],L=i[0],O=i[1],H=i[2],ie=i[3],pe=i[4],be=i[5],Ce=i[6],Pe=i[7],Ie=i[8];return t[0]=L*r+O*d+H*T,t[1]=L*o+O*a+H*E,t[2]=L*h+O*v+H*k,t[3]=ie*r+pe*d+be*T,t[4]=ie*o+pe*a+be*E,t[5]=ie*h+pe*v+be*k,t[6]=Ce*r+Pe*d+Ie*T,t[7]=Ce*o+Pe*a+Ie*E,t[8]=Ce*h+Pe*v+Ie*k,t}function Ble(t,e,i){const r=e[0],o=e[1],h=e[2],d=e[3],a=e[4],v=e[5],T=e[6],E=e[7],k=e[8],L=i[0],O=i[1];return t[0]=r,t[1]=o,t[2]=h,t[3]=d,t[4]=a,t[5]=v,t[6]=L*r+O*d+T,t[7]=L*o+O*a+E,t[8]=L*h+O*v+k,t}function jle(t,e,i){const r=e[0],o=e[1],h=e[2],d=e[3],a=e[4],v=e[5],T=e[6],E=e[7],k=e[8],L=Math.sin(i),O=Math.cos(i);return t[0]=O*r+L*d,t[1]=O*o+L*a,t[2]=O*h+L*v,t[3]=O*d-L*r,t[4]=O*a-L*o,t[5]=O*v-L*h,t[6]=T,t[7]=E,t[8]=k,t}function Ule(t,e,i){const r=i[0],o=i[1],h=i[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=h*e[6],t[7]=h*e[7],t[8]=h*e[8],t}function Vle(t,e,i){const r=i[0],o=i[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t}function Gle(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function qle(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Hle(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Zle(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Wle(t,e){const i=e[0],r=e[1],o=e[2],h=e[3],d=i+i,a=r+r,v=o+o,T=i*d,E=r*d,k=r*a,L=o*d,O=o*a,H=o*v,ie=h*d,pe=h*a,be=h*v;return t[0]=1-k-H,t[3]=E-be,t[6]=L+pe,t[1]=E+be,t[4]=1-T-H,t[7]=O-ie,t[2]=L-pe,t[5]=O+ie,t[8]=1-T-k,t}function Yle(t,e){const i=e[0],r=e[1],o=e[2],h=e[4],d=e[5],a=e[6],v=e[8],T=e[9],E=e[10],k=E*d-a*T,L=-E*h+a*v,O=T*h-d*v,H=i*k+r*L+o*O;if(!H)return null;const ie=1/H;return t[0]=k*ie,t[1]=(-E*r+o*T)*ie,t[2]=(a*r-o*d)*ie,t[3]=L*ie,t[4]=(E*i-o*v)*ie,t[5]=(-a*i+o*h)*ie,t[6]=O*ie,t[7]=(-T*i+r*v)*ie,t[8]=(d*i-r*h)*ie,t}function Xle(t,e){const i=e[0],r=e[1],o=e[2],h=e[3],d=e[4],a=e[5],v=e[6],T=e[7],E=e[8],k=e[9],L=e[10],O=e[11],H=e[12],ie=e[13],pe=e[14],be=e[15],Ce=i*a-r*d,Pe=i*v-o*d,Ie=i*T-h*d,ke=r*v-o*a,Ke=r*T-h*a,qe=o*T-h*v,dt=E*ie-k*H,ft=E*pe-L*H,et=E*be-O*H,We=k*pe-L*ie,Be=k*be-O*ie,ge=L*be-O*pe;let De=Ce*ge-Pe*Be+Ie*We+ke*et-Ke*ft+qe*dt;return De?(De=1/De,t[0]=(a*ge-v*Be+T*We)*De,t[1]=(v*et-d*ge-T*ft)*De,t[2]=(d*Be-a*et+T*dt)*De,t[3]=(o*Be-r*ge-h*We)*De,t[4]=(i*ge-o*et+h*ft)*De,t[5]=(r*et-i*Be-h*dt)*De,t[6]=(ie*qe-pe*Ke+be*ke)*De,t[7]=(pe*Ie-H*qe-be*Pe)*De,t[8]=(H*Ke-ie*Ie+be*Ce)*De,t):null}function Jle(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Kle(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Qle(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function ece(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function hB(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function tce(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function ice(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t}function rce(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function nce(t,e){const i=t[0],r=t[1],o=t[2],h=t[3],d=t[4],a=t[5],v=t[6],T=t[7],E=t[8],k=e[0],L=e[1],O=e[2],H=e[3],ie=e[4],pe=e[5],be=e[6],Ce=e[7],Pe=e[8],Ie=Hw();return Math.abs(i-k)<=Ie*Math.max(1,Math.abs(i),Math.abs(k))&&Math.abs(r-L)<=Ie*Math.max(1,Math.abs(r),Math.abs(L))&&Math.abs(o-O)<=Ie*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(h-H)<=Ie*Math.max(1,Math.abs(h),Math.abs(H))&&Math.abs(d-ie)<=Ie*Math.max(1,Math.abs(d),Math.abs(ie))&&Math.abs(a-pe)<=Ie*Math.max(1,Math.abs(a),Math.abs(pe))&&Math.abs(v-be)<=Ie*Math.max(1,Math.abs(v),Math.abs(be))&&Math.abs(T-Ce)<=Ie*Math.max(1,Math.abs(T),Math.abs(Ce))&&Math.abs(E-Pe)<=Ie*Math.max(1,Math.abs(E),Math.abs(Pe))}function sce(t){const e=Hw(),i=t[0],r=t[1],o=t[2],h=t[3],d=t[4],a=t[5],v=t[6],T=t[7],E=t[8];return Math.abs(1-(i*i+h*h+v*v))<=e&&Math.abs(1-(r*r+d*d+T*T))<=e&&Math.abs(1-(o*o+a*a+E*E))<=e}const oce=uB,ace=hB;Object.freeze(Object.defineProperty({__proto__:null,add:ece,adjoint:Nle,copy:Ole,determinant:Jb,equals:nce,exactEquals:rce,frob:Qle,fromMat2d:Zle,fromMat4:zle,fromQuat:Wle,fromRotation:qle,fromScaling:Hle,fromTranslation:Gle,identity:Rle,invert:Fle,isOrthoNormal:sce,mul:oce,multiply:uB,multiplyScalar:tce,multiplyScalarAndAdd:ice,normalFromMat4:Xle,normalFromMat4Legacy:Yle,projection:Jle,rotate:jle,scale:Ule,scaleByVec2:Vle,set:Xb,str:Kle,sub:ace,subtract:hB,translate:Ble,transpose:Lle},Symbol.toStringTag,{value:"Module"}));function LP(){return[1,0,0,0,1,0,0,0,1]}function lce(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function cce(t,e,i,r,o,h,d,a,v){return[t,e,i,r,o,h,d,a,v]}const uce=LP();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:uce,clone:lce,create:LP,fromValues:cce},Symbol.toStringTag,{value:"Module"}));const Yp=LP();function hce(t,e,i){const[r,o]=t,[h,d]=e,[a,v]=i;Xb(Yp,r,h,a,o,d,v,1,1,1);const T=Jb(Yp),E=4*T/(Go(t,e)+Go(e,i)+Go(i,t));if(!isFinite(E)||Math.abs(E)<1e-8)return null;const k=r**2+o**2,L=h**2+d**2,O=a**2+v**2;Xb(Yp,k,L,O,o,d,v,1,1,1);const H=Jb(Yp);return Xb(Yp,k,L,O,r,h,a,1,1,1),[H/T*.5,Jb(Yp)/T*-.5]}function dce(t,e){const[i,r]=e.c,o=hce(t,r,i),h=o==null,d=o??uc([],t,i,.5),[a,v]=t,[T,E]=r,[k,L]=i,[O,H]=d,ie=a-O,pe=v-H,be=Math.sqrt(ie*ie+pe*pe),Ce=Xy(v-H,a-O),Pe=Xy(E-H,T-O);let Ie=Xy(L-H,k-O);return(Pe-Ce)*(Ie-Pe)<0&&(Ie+=2*Math.sign(Ce-Ie)*Math.PI),new cB(O,H,be,Ce,Ie,h)}function _ye(t,e,i){const r=Yb(t,i/2),o=Yb(t,i),h=Yb(t,(i+1)/2);return[{c:[o,r]},{c:[[...e.c[0]],h]}]}function FP(t){return"b"in t}function NP(t){return"c"in t}function Ww(t){return Array.isArray(t)}function dB(t){return"a"in t&&t.a.length===4}function pce(t){return"a"in t&&t.a.length===7}function OT(t){return Ww(t)?t:FP(t)?t.b[0]:NP(t)?t.c[0]:t.a[0]}function fce(t){if(FP(t)){const[e,i,r]=t.b;return{b:[[...e],[...i],[...r]]}}if(NP(t)){const[e,i]=t.c;return{c:[[...e],[...i]]}}if(Ww(t))return[...t];if(dB(t)){const[e,i,r,o]=t.a;return{a:[[...e],[...i],r,o]}}if(pce(t)){const[e,i,r,o,h,d,a]=t.a;return{a:[[...e],[...i],r,o,h,d,a]}}return t}function mce(t,e){const[i,r,o,h]=e.a,[d,a]=t,[v,T]=i,[E,k]=r,L=d-E,O=a-k,H=Math.sqrt(L*L+O*O),ie=v-E,pe=T-k,be=Math.sqrt(ie*ie+pe*pe),Ce=H===0||be===0||!fN(H,be),Pe=H,[Ie,ke]=oB(Xy(a-k,d-E),Math.atan2(T-k,v-E),o,h);return new cB(E,k,Pe,Ie,ke,Ce)}function bye(t,e,i){const{cx:r,cy:o,thetaStart:h,thetaEnd:d}=t,[a,v,T,E]=e.a,k=h*(1-i)+d*i;return[{a:[Yb(t,i),[r,o],Math.abs(k-h)<Math.PI?1:0,E]},{a:[[...a],[r,o],Math.abs(d-k)<Math.PI?1:0,E]}]}let gce=class{constructor(e,i,r,o,h,d,a,v,T){this.cx=e,this.cy=i,this.a=r,this.b=o,this.cosR=h,this.sinR=d,this.u1=a,this.u2=v,this.isInvalid=T}};function pB(t,e){const[i,r,o,h,d,a,v]=e.a,[T,E]=t,[k,L]=i,[O,H]=r,ie=a*v,pe=Math.cos(d),be=Math.sin(d),[Ce,Pe]=oB(Xy(1/ie*(E-H)*pe-1/ie*(T-O)*be,1/a*(E-H)*be+1/a*(T-O)*pe),Math.atan2(1/ie*(L-H)*pe-1/ie*(k-O)*be,1/a*(L-H)*be+1/a*(k-O)*pe),o,h);return new gce(O,H,a,ie,pe,be,Ce,Pe,a===0||ie===0)}function G0(t,e){const{a:i,b:r,cosR:o,sinR:h,cx:d,cy:a}=t,v=Math.cos(e),T=Math.sin(e);return[i*v*o-r*T*h+d,i*v*h+r*T*o+a]}function cf(t,e){const{u1:i,u2:r}=t;return G0(t,i*(1-e)+r*e)}function wye(t,e,i){if(i<0||i>1)return[];if(i===0||i===1)return[fce(e)];const[r,[o,h],d,a,v,T,E]=e.a,{u1:k,u2:L}=t,O=k*(1-i)+L*i;return[{a:[[...cf(t,i)],[o,h],Math.abs(O-k)<Math.PI?1:0,a,v,T,E]},{a:[[...r],[o,h],Math.abs(L-O)<Math.PI?1:0,a,v,T,E]}]}function Sye(t,e){const{a:i,b:r,cosR:o,sinR:h,u1:d,u2:a}=t,v=Math.PI/6,T=aB(e,[1*v,2*v,4*v,5*v,7*v,8*v,10*v,11*v],ie=>{const pe=Math.cos(ie),be=Math.sin(ie),[Ce,Pe]=G0(t,ie);return[Ce,Pe,-i*o*be-r*h*pe,-i*h*be+r*o*pe,-i*o*pe+r*h*be,-i*h*pe-r*o*be]}),E=Zw(d,a),k=new Set(T.map(ie=>vv(E,ie)).filter(ie=>ie>E.min&&ie<E.max));k.add(d),k.add(a);let L,O,H=1/0;for(const ie of k){const pe=G0(t,ie),[be,Ce]=pe,Pe=e[0]-be,Ie=e[1]-Ce,ke=Pe*Pe+Ie*Ie;ke<H&&(L=(ie-d)/(a-d),O=pe,H=ke)}return{t:L,curvePoint:O,distance:Math.sqrt(H)}}function yce(t,e,i){const r=pB(e,i),{a:o,b:h,u1:d,u2:a,cosR:v,sinR:T,isInvalid:E}=r,k=i.a[0];if(jo(t,e),jo(t,k),E)return t;const L=Math.atan2(-h*T,o*v),O=L+Math.PI,H=Math.atan2(h*v,o*T),ie=H+Math.PI,pe=Zw(d,a);for(const be of[L,O,H,ie].map(Ce=>vv(pe,Ce)))be>pe.min&&be<pe.max&&jo(t,G0(r,be));return t}function Tye(t,e,i){const[r,o,h,d,a,v,T]=e.a,E=pB(t,e),{u1:k,u2:L,isInvalid:O}=E,H=L-k;if(O)return Math.sqrt(Go(t,r));const ie=14,pe=[0,0];let be=0,Ce=[cf(E,0),cf(E,.25),cf(E,.5),cf(E,.75),cf(E,1)];for(let Pe=0;Pe<ie;Pe++){const Ie=Ce.length-1,ke=H/(2*Ie),Ke=[];for(let dt=0;dt<Ie;dt++)Ke.push(Ce[dt]),Ke.push(G0(E,k+(2*dt+1)*ke));Ke.push(Ce[Ce.length-1]),Ce=Ke,be=0;let qe=0;for(let dt=1;dt<Ce.length;dt++){const ft=Ce[dt-1],et=Ce[dt];if(be+=Math.sqrt(Go(ft,et)),dt>1){const We=Ce[dt-2],Be=$le(pe,We,ft,o,et);qe+=Be?Math.sqrt(Go(ft,Be)):Math.abs(et[0]-ft[0])+Math.abs(et[1]-ft[1])}else qe+=be}if(qe-be<i)return be}return be}function vce(t,e,i){if(Ww(i))return jo(t,e),jo(t,i),t;if(FP(i))return Ale(t,e,i);if(NP(i)){const r=dce(e,i);return vz(t,r)}if(dB(i)){const r=mce(e,i);return vz(t,r)}return yce(t,e,i)}function fB(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function mB(t){return t.points!==void 0}function gB(t){return t.x!==void 0&&t.y!==void 0}function yB(t){return t.paths!==void 0}function vB(t){return t.rings!==void 0}function _B(t){function e(i,r){return i==null?r:r==null?i:t(i,r)}return e}const ku=_B(Math.min),Au=_B(Math.max);function Cye(t,e){return yB(e)?vm(t,e.curvePaths??e.paths,!1,!1)??t:vB(e)?vm(t,e.curveRings??e.rings,!1,!1)??t:mB(e)?BP(t,e.points,!1,!1,!1,!1):fB(e)?bB(t,e):(gB(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Eye(t){let e,i,r,o;for(t.reset(),e=r=1/0,i=o=-1/0;t.nextPath();){const h=_ce(t);e=Math.min(h[0],e),r=Math.min(h[1],r),i=Math.max(h[2],i),o=Math.max(h[3],o)}return yv([e,r,i,o])}function _ce(t){let e,i,r,o;for(e=r=1/0,i=o=-1/0;t.nextPoint();)e=Math.min(t.x,e),r=Math.min(t.y,r),i=Math.max(t.x,i),o=Math.max(t.y,o);return yv([e,r,i,o])}function Iye(t,e){return yB(e)?vm(t,e.curvePaths??e.paths,!0,!1)??t:vB(e)?vm(t,e.curveRings??e.rings,!0,!1)??t:mB(e)?BP(t,e.points,!0,!1,!0,!1):fB(e)?bB(t,e,!0,!1,!0,!1):(gB(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function vm(t,e,i,r){const o=i?3:2;if(!e.length||!e[0].length)return null;let h,d,a,v,[T,E]=OT(e[0][0]),k=T,L=E;for(let O=0;O<e.length;O++){const H=e[O];for(let ie=0;ie<H.length;ie++){const pe=OT(H[ie]),[be,Ce]=pe;if(T=ku(T,be),E=ku(E,Ce),k=Au(k,be),L=Au(L,Ce),i&&pe.length>2){const Ke=pe[2];h=ku(h,Ke),d=Au(d,Ke)}if(r&&pe.length>o){const Ke=pe[o];a=ku(h,Ke),v=Au(d,Ke)}const Pe=H[ie];if(Ww(Pe)||ie<1)continue;const Ie=OT(H[ie-1]),ke=Rae(T,E,k,L);[T,E,k,L]=vce(ke,Ie,Pe)}}return i?r?(t[0]=T,t[1]=E,t[2]=h,t[3]=a,t[4]=k,t[5]=L,t[6]=d,t[7]=v,t.length=8,t):(t[0]=T,t[1]=E,t[2]=h,t[3]=k,t[4]=L,t[5]=d,t.length=6,t):r?(t[0]=T,t[1]=E,t[2]=a,t[3]=k,t[4]=L,t[5]=v,t.length=6,t):(t[0]=T,t[1]=E,t[2]=k,t[3]=L,t.length=4,t)}function bB(t,e,i,r,o,h){const d=e.xmin,a=e.xmax,v=e.ymin,T=e.ymax;let E=e.zmin,k=e.zmax,L=e.mmin,O=e.mmax;return o?(E=E||0,k=k||0,h?(L=L||0,O=O||0,t[0]=d,t[1]=v,t[2]=E,t[3]=L,t[4]=a,t[5]=T,t[6]=k,t[7]=O,t):(t[0]=d,t[1]=v,t[2]=E,t[3]=a,t[4]=T,t[5]=k,t)):h?(L=L||0,O=O||0,t[0]=d,t[1]=v,t[2]=L,t[3]=a,t[4]=T,t[5]=O,t):(t[0]=d,t[1]=v,t[2]=a,t[3]=T,t)}function BP(t,e,i,r,o,h){const d=i?3:2,a=r&&h,v=i&&o;if(!e.length||!e[0].length)return null;let T,E,k,L,[O,H]=e[0],[ie,pe]=e[0];for(let be=0;be<e.length;be++){const Ce=e[be],[Pe,Ie]=Ce;if(O=ku(O,Pe),H=ku(H,Ie),ie=Au(ie,Pe),pe=Au(pe,Ie),v&&Ce.length>2){const ke=Ce[2];T=ku(T,ke),E=Au(E,ke)}if(a&&Ce.length>d){const ke=Ce[d];k=ku(T,ke),L=Au(E,ke)}}return o?(T=T||0,E=E||0,h?(k=k||0,L=L||0,t[0]=O,t[1]=H,t[2]=T,t[3]=k,t[4]=ie,t[5]=pe,t[6]=E,t[7]=L,t):(t[0]=O,t[1]=H,t[2]=T,t[3]=ie,t[4]=pe,t[5]=E,t)):h?(k=k||0,L=L||0,t[0]=O,t[1]=H,t[2]=k,t[3]=ie,t[4]=pe,t[5]=L,t):(t[0]=O,t[1]=H,t[2]=ie,t[3]=pe,t)}function bce(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function xce(t){return t.points!==void 0}function wce(t){return t.x!==void 0&&t.y!==void 0}function Sce(t){return t.paths!==void 0}function Tce(t){return t.rings!==void 0}const jP=[];function xB(t,e,i,r){return{xmin:t,ymin:e,xmax:i,ymax:r}}function wB(t,e,i,r,o,h){return{xmin:t,ymin:e,zmin:i,xmax:r,ymax:o,zmax:h}}function SB(t,e,i,r,o,h){return{xmin:t,ymin:e,mmin:i,xmax:r,ymax:o,mmax:h}}function TB(t,e,i,r,o,h,d,a){return{xmin:t,ymin:e,zmin:i,mmin:r,xmax:o,ymax:h,zmax:d,mmax:a}}function UP(t,e=!1,i=!1){return e?i?TB(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):wB(t[0],t[1],t[2],t[3],t[4],t[5]):i?SB(t[0],t[1],t[2],t[3],t[4],t[5]):xB(t[0],t[1],t[2],t[3])}function $ye(t){return t?bce(t)?t:wce(t)?Cce(t):Tce(t)?EB(t):Sce(t)?IB(t):xce(t)?CB(t):null:null}function CB(t){const{hasZ:e,hasM:i,points:r}=t,o=BP(jP,r,e??!1,i??!1,e??!1,i??!1);return o?UP(o,e,i):null}function Cce(t){const{x:e,y:i,z:r,m:o}=t,h=o!=null;return r!=null?h?TB(e,i,r,o,e,i,r,o):wB(e,i,r,e,i,r):h?SB(e,i,o,e,i,o):xB(e,i,e,i)}function EB(t){const{hasZ:e,hasM:i,rings:r,curveRings:o}=t,h=vm(jP,o??r,e??!1,i??!1);return h?UP(h,e,i):null}function IB(t){const{hasZ:e,hasM:i,paths:r,curvePaths:o}=t,h=vm(jP,o??r,e??!1,i??!1);return h?UP(h,e,i):null}function _m(t,e,i=!1){let{hasM:r,hasZ:o}=t;Array.isArray(e)?e.length!==4||r||o?e.length===3&&i&&!r?(o=!0,r=!1):e.length===3&&r&&o&&(r=!1,o=!1):(r=!0,o=!0):(o=!o&&e.hasZ&&(!r||e.hasM),r=!r&&e.hasM&&(!o||e.hasZ)),t.hasZ=o,t.hasM=r}var QE;function Ece(t){if(!t)return;let{points:e,hasM:i,hasZ:r,spatialReference:o}=t;switch(e??=[],e?.at(0)?.length){case 4:r??=!0,i??=!0;break;case 3:r??=i!==!0,i??=!r;break;default:r??=!1,i??=!1}return o??=Ft.WGS84,{...t,hasM:i,hasZ:r,points:e,spatialReference:o}}let nl=QE=class extends Hn{constructor(t){super(Ece(t)),this.points=[],this.type="multipoint"}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=CB(this);return t?new _i({...t,spatialReference:this.spatialReference}):null}writePoints(t,e){e.points=ht(this.points)}clone(){const{points:t,spatialReference:e,hasM:i,hasZ:r}=this;return new QE({points:ht(t),spatialReference:e.clone(),hasM:i,hasZ:r})}addPoint(t){return _m(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(i.z=e[2],r=3),this.hasM&&(i.m=e[r]),new oi(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new oi(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(_m(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};P([R({readOnly:!0})],nl.prototype,"cache",null),P([R({readOnly:!0})],nl.prototype,"extent",null),P([R({type:[[Number]],json:{write:{isRequired:!0}}})],nl.prototype,"points",void 0),P([Ui("points")],nl.prototype,"writePoints",null),nl=QE=P([Ve("esri.geometry.Multipoint")],nl),nl.prototype.toJSON.isDefaultToJSON=!0;function Pye(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function Ice(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function VP(t,e){const i=e[0]-t[0],r=e[1]-t[1];if(t.length>2&&e.length>2){const o=t[2]-e[2];return Math.sqrt(i*i+r*r+o*o)}return Math.sqrt(i*i+r*r)}function $ce(t,e,i){const r=t[0]+i*(e[0]-t[0]),o=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[r,o,t[2]+i*(e[2]-t[2])]:[r,o]}function Mye(t,e,i,r){const[o,h]=e,[d,a]=i,[v,T]=r,E=v-d,k=T-a,L=E*E+k*k,O=(o-d)*E+(h-a)*k,H=Math.min(1,Math.max(0,O/L));return t[0]=d+E*H,t[1]=a+k*H,t}function kye(t,e,i,r,o,h){let d=i,a=r,v=o-d,T=h-a;if(v!==0||T!==0){const E=((t-d)*v+(e-a)*T)/(v*v+T*T);E>1?(d=o,a=h):E>0&&(d+=v*E,a+=T*E)}return v=t-d,T=e-a,v*v+T*T}function $B(t,e){return $ce(t,e,.5)}function Aye(t){const e=t.length;let i=0;for(let r=0;r<e-1;++r)i+=VP(t[r],t[r+1]);return i}function Pce(t,e=0,i=1){let r=0;const o=t.length;let h=t[0];for(let d=1;d<o;d++){const a=t[d];r+=(a[e]-h[e])*(a[i]+h[i]),h=a}if(PB(t)){const d=t[0];r+=(d[e]-h[e])*(d[i]+h[i])}return r>=0}function PB(t){const e=t.length;return e>0&&!fw(t[0],t[e-1])}function Dye(t){if("rings"in t)for(const e of t.rings)PB(e)&&e.push(e[0].slice())}function zye(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function Mce(t){return kce(t.rings,t.hasZ??!1)}function MB(t){const e=Mce(t);if(!e)return null;const{hasZ:i,spatialReference:r}=t,[o,h,d]=e;return isNaN(o)||isNaN(h)||i&&isNaN(d)?null:{x:o,y:h,z:i?d:void 0,spatialReference:r}}function kce(t,e){if(!t?.length)return null;const i=[],r=[],o=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let h=0,d=t.length;h<d;h++){const a=kB(t[h],e,o);a&&r.push(a)}if(r.sort((h,d)=>{let a=h[2]-d[2];return a===0&&e&&(a=h[4]-d[4]),a}),r.length&&(i[0]=r[0][0],i[1]=r[0][1],e&&(i[2]=r[0][3]),(i[0]<o[0]||i[0]>o[1]||i[1]<o[2]||i[1]>o[3]||e&&(i[2]<o[4]||i[2]>o[5]))&&(i.length=0)),!i.length){const h=t[0]&&t[0].length?Ace(t[0],e):null;if(!h)return null;i[0]=h[0],i[1]=h[1],e&&h.length>2&&(i[2]=h[2])}return i}function kB(t,e,i){let r=0,o=0,h=0,d=0,a=0;const v=t.length?t[0][0]:0,T=t.length?t[0][1]:0,E=t.length&&e?t[0][2]:0;for(let L=0;L<t.length;L++){const O=t[L],H=t[(L+1)%t.length],[ie,pe,be]=O,Ce=ie-v,Pe=pe-T,[Ie,ke,Ke]=H,qe=Ie-v,dt=ke-T,ft=Ce*dt-qe*Pe;if(d+=ft,r+=(Ce+qe)*ft,o+=(Pe+dt)*ft,e&&O.length>2&&H.length>2){const et=be-E,We=Ke-E,Be=Ce*We-qe*et;h+=(et+We)*Be,a+=Be}ie<i[0]&&(i[0]=ie),ie>i[1]&&(i[1]=ie),pe<i[2]&&(i[2]=pe),pe>i[3]&&(i[3]=pe),e&&(be<i[4]&&(i[4]=be),be>i[5]&&(i[5]=be))}if(d>0&&(d*=-1),a>0&&(a*=-1),!d)return null;d*=.5,a*=.5;const k=[r/(6*d)+v,o/(6*d)+T,d];return e&&(i[4]===i[5]||a===0?(k[3]=(i[4]+i[5])/2,k[4]=0):(k[3]=h/(6*a)+E,k[4]=a)),k}function Oye(t,e){let i=0,r=0,o=0;t.nextPoint();const h=t.pathSize?t.x:0,d=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const v=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const T=[t.x,t.y],[E,k]=v,L=E-h,O=k-d,[H,ie]=T,pe=H-h,be=ie-d,Ce=L*be-pe*O;o+=Ce,i+=(L+pe)*Ce,r+=(O+be)*Ce,E<e[0]&&(e[0]=E),E>e[1]&&(e[1]=E),k<e[2]&&(e[2]=k),k>e[3]&&(e[3]=k)}return o>0&&(o*=-1),o?(o*=.5,[i/(6*o)+h,r/(6*o)+d,o]):null}function Ace(t,e){const i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let o=0,h=0,d=0,a=0;for(let v=0,T=t.length;v<T-1;v++){const E=t[v],k=t[v+1];if(E&&k){i[0]=E[0],i[1]=E[1],r[0]=k[0],r[1]=k[1],e&&E.length>2&&k.length>2&&(i[2]=E[2],r[2]=k[2]);const L=VP(i,r);if(L){o+=L;const O=$B(E,k);h+=L*O[0],d+=L*O[1],e&&O.length>2&&(a+=L*O[2])}}}return o>0?e?[h/o,d/o,a/o]:[h/o,d/o]:t.length?t[0]:null}function Dce(t){const{hasZ:e,totalSize:i}=t;if(i===0)return null;const r=[],o=[],h=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const d=kB(Ice(t),t.hasZ,h);d&&o.push(d)}if(o.sort((d,a)=>{let v=d[2]-a[2];return v===0&&e&&(v=d[4]-a[4]),v}),o.length&&(r[0]=o[0][0],r[1]=o[0][1],e&&(r[2]=o[0][3]),(r[0]<h[0]||r[0]>h[1]||r[1]<h[2]||r[1]>h[3]||e&&(r[2]<h[4]||r[2]>h[5]))&&(r.length=0)),!r.length){t.reset(),t.nextPath();const d=t.pathSize?zce(t):null;if(!d)return null;r[0]=d[0],r[1]=d[1],e&&d.length>2&&(r[2]=d[2])}return r}function zce(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let o=0,h=0,d=0,a=0;if(t.nextPoint()){let v=t.x,T=t.y,E=t.z;for(;t.nextPoint();){const k=t.x,L=t.y,O=t.z;i[0]=v,i[1]=T,r[0]=k,r[1]=L,e&&(i[2]=E,r[2]=O);const H=VP(i,r);if(H){o+=H;const ie=$B(i,r);h+=H*ie[0],d+=H*ie[1],e&&ie.length>2&&(a+=H*ie[2])}v=k,T=L,E=O}}return o>0?e?[h/o,d/o,a/o]:[h/o,d/o]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const Oce=1e-6;function Rye(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<Oce){const o=Dce(t);return o?[o[0],o[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)Lce(i,r,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=r[0],i[1]+=r[1],i}const Rce=1/3;function Lce(t,e,i){if(!t||!i||i.pathSize<3)return null;i.nextPoint();const r=i.x,o=i.y;i.nextPoint();let h,d=i.x-r,a=i.y-o,v=0,T=0;for(;i.nextPoint();)v=i.x-r,T=i.y-o,h=.5*Rce*(v*a-T*d),t[0]+=h*(d+v),t[1]+=h*(a+T),d=v,a=T;const E=i.getCurrentRingArea(),k=[r,o];return k[0]-=e[0],k[1]-=e[1],k[0]*=E,k[1]*=E,t[0]+=k[0],t[1]+=k[1],t}var Kb;function _z(t){return!Array.isArray(t[0])}function Fce(t){return typeof t[0]?.[0]=="number"}function Nce(t){if(!t)return;let{rings:e,hasM:i,hasZ:r,spatialReference:o}=t;switch(e??=[],Fce(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,i??=!0;break;case 3:r??=i!==!0,i??=!r;break;default:r??=!1,i??=!1}return o??=Ft.WGS84,{...t,hasM:i,hasZ:r,rings:e,spatialReference:o}}let Rn=Kb=class extends Hn{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:i}=t;let r=!1,o=!1;for(const d of e)d.hasZ&&(r=!0),d.hasM&&(o=!0);const h={rings:e.map(d=>{const a=[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]];if(r&&d.hasZ){const v=d.zmin+.5*(d.zmax-d.zmin);for(let T=0;T<a.length;T++)a[T].push(v)}if(o&&d.hasM){const v=d.mmin+.5*(d.mmax-d.mmin);for(let T=0;T<a.length;T++)a[T].push(v)}return a}),spatialReference:i};return r&&(h.hasZ=!0),o&&(h.hasM=!0),new Kb(h)}constructor(t){super(Nce(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){T5(ui.getLogger(this),"centroid",{replacement:"Please use centroidOperator.execute() instead.",version:"4.34",warnOnce:!0});const t=MB(this);return t?oi.fromJSON(t):null}writeCurveRings(t,e){e.curveRings=ht(t)}get extent(){const t=EB(this),{spatialReference:e}=this;return t?new _i({...t,spatialReference:e}):null}get isSelfIntersecting(){return T5(ui.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),Dae(this.rings)}writeRings(t,e){e.rings=ht(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(_z(t)){const r=[];for(let o=0,h=t.length;o<h;o++)r[o]=t[o].toArray();e[i]=r}else e[i]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new Kb;return t.spatialReference=this.spatialReference,t.rings=ht(this.rings),t.curveRings=ht(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;if(e!=null!=(i!=null)||e!=null&&i!=null&&!e.equals(i)||this.rings.length!==t.rings.length)return!1;const r=([o,h,d,a],[v,T,E,k])=>o===v&&h===T&&(d==null&&E==null||d===E)&&(a==null&&k==null||a===k);for(let o=0;o<this.rings.length;o++){const h=this.rings[o],d=t.rings[o];if(!fw(h,d,r))return!1}return!0}contains(t){if(!t)return!1;const e=GN(t,this.spatialReference);return Sae(this,e??t)}isClockwise(t){const e=_z(t)?t.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):t;return Pce(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],r=this.hasZ,o=this.hasM;return r&&!o?new oi(i[0],i[1],i[2],void 0,this.spatialReference):o&&!r?new oi(i[0],i[1],void 0,i[2],this.spatialReference):r&&o?new oi(i[0],i[1],i[2],i[3],this.spatialReference):new oi(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(_m(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new oi(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,r=e.map(o=>new oi(o,i));return this.notifyChange("rings"),r}setPoint(t,e,i){return this._validateInputs(t,e)?(_m(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const r=this.rings[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};P([R({readOnly:!0})],Rn.prototype,"cache",null),P([R({readOnly:!0})],Rn.prototype,"centroid",null),P([R({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Rn.prototype,"curveRings",void 0),P([Ui("curveRings")],Rn.prototype,"writeCurveRings",null),P([R({readOnly:!0})],Rn.prototype,"extent",null),P([R({readOnly:!0})],Rn.prototype,"isSelfIntersecting",null),P([R({type:[[[Number]]],json:{write:{isRequired:!0}}})],Rn.prototype,"rings",void 0),P([Ui("rings")],Rn.prototype,"writeRings",null),Rn=Kb=P([Ve("esri.geometry.Polygon")],Rn),Rn.prototype.toJSON.isDefaultToJSON=!0;var eI;function Bce(t){return!Array.isArray(t[0])}function jce(t){return typeof t[0]?.[0]=="number"}function Uce(t){if(!t)return;let{paths:e,hasM:i,hasZ:r,spatialReference:o}=t;switch(e??=[],jce(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,i??=!0;break;case 3:r??=i!==!0,i??=!r;break;default:r??=!1,i??=!1}return o??=Ft.WGS84,{...t,hasM:i,hasZ:r,paths:e,spatialReference:o}}let Lo=eI=class extends Hn{constructor(t){super(Uce(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=ht(t)}get extent(){const t=IB(this),{spatialReference:e}=this;return t?new _i({...t,spatialReference:e}):null}writePaths(t,e){e.paths=ht(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(Bce(t)){const r=[];for(let o=0,h=t.length;o<h;o++)r[o]=t[o].toArray();e[i]=r}else e[i]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new eI;return t.spatialReference=this.spatialReference,t.paths=ht(this.paths),t.curvePaths=ht(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],r=this.hasZ,o=this.hasM;return r&&!o?new oi(i[0],i[1],i[2],void 0,this.spatialReference):o&&!r?new oi(i[0],i[1],void 0,i[2],this.spatialReference):r&&o?new oi(i[0],i[1],i[2],i[3],this.spatialReference):new oi(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(_m(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,r=e.map(o=>new oi(o,i));return this.notifyChange("paths"),r}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new oi(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(_m(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const r=this.paths[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};P([R({readOnly:!0})],Lo.prototype,"cache",null),P([R({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],Lo.prototype,"curvePaths",void 0),P([Ui("curvePaths")],Lo.prototype,"writeCurvePaths",null),P([R({readOnly:!0})],Lo.prototype,"extent",null),P([R({type:[[[Number]]],json:{write:{isRequired:!0}}})],Lo.prototype,"paths",void 0),P([Ui("paths")],Lo.prototype,"writePaths",null),Lo=eI=P([Ve("esri.geometry.Polyline")],Lo),Lo.prototype.toJSON.isDefaultToJSON=!0;function AB(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function DB(t){return t.points!==void 0}function zB(t){return t.x!==void 0&&t.y!==void 0}function OB(t){return t.paths!==void 0||t.curvePaths!==void 0}function RB(t){return t.rings!==void 0||t.curveRings!==void 0}function LB(t){return t==null?null:t instanceof Hn?t:zB(t)?oi.fromJSON(t):OB(t)?Lo.fromJSON(t):RB(t)?Rn.fromJSON(t):DB(t)?nl.fromJSON(t):AB(t)?_i.fromJSON(t):null}function GP(t){return t?zB(t)?"esriGeometryPoint":OB(t)?"esriGeometryPolyline":RB(t)?"esriGeometryPolygon":AB(t)?"esriGeometryEnvelope":DB(t)?"esriGeometryMultipoint":null:null}const Vce={esriGeometryPoint:oi,esriGeometryPolyline:Lo,esriGeometryPolygon:Rn,esriGeometryEnvelope:_i,esriGeometryMultipoint:nl,esriGeometryMultiPatch:Rn};function Gce(t){return t&&Vce[t]||null}const Lye=_o()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),Fye=_o()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),qce={base:Hn,key:"type",typeMap:{extent:_i,multipoint:nl,point:oi,polyline:Lo,polygon:Rn}},FB=Symbol("idFieldsProviderSymbol");function Hce(t){return!!t&&FB in t}function bz(t){return Hce(t)?t[FB]:void 0}const NB=Symbol("popupProvider");function Zce(t){return!!t&&NB in t}function Wce(t){return Zce(t)?t[NB]:null}function Nye(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const i=[];for(const r of e.fieldNames)i.push(t.attributes[r]??null);return JSON.stringify(i)}}}function xz(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const i=e.uniqueIdFields.map(r=>t.attributes?.[r]);return JSON.stringify(i)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const wz=new xl({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Yce=0,jr=class extends Nt{constructor(e){super(e),this.id="sym"+Yce++,this.type=null,this.color=new ar([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};P([R({type:wz.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:wz.write,isRequired:!0}}})],jr.prototype,"type",void 0),P([R({type:ar,json:{write:{allowNull:!0}}})],jr.prototype,"color",void 0),P([Br("color")],jr.prototype,"readColor",null),jr=P([Ve("esri.symbols.Symbol")],jr);var tI;let Ms=tI=class extends jr{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const i=this.data.primitiveOverrides;if(i){const r=i.map(o=>{const h=o.valueExpressionInfo;return h?RF(t,e,null,h.expression):null});await Promise.all(r)}}}clone(){return new tI({data:ht(this.data)})}hash(){return NL(JSON.stringify(this.data)).toString()}};P([R({json:{write:!1}})],Ms.prototype,"color",void 0),P([R({json:{write:!0}})],Ms.prototype,"data",void 0),P([Br("data",["symbol"])],Ms.prototype,"readData",null),P([Ui("data",{})],Ms.prototype,"writeData",null),P([gi({CIMSymbolReference:"cim"},{readOnly:!0})],Ms.prototype,"type",void 0),Ms=tI=P([Ve("esri.symbols.CIMSymbol")],Ms);function Xce(t,e,i=sr){return e||(e=new i),e===t||e.destroyed||(e.removeAll(),Kce(t)?e.addMany(t):t&&e.add(t)),e}function Jce(t){return t}function Kce(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let Qce=class{constructor(){this._resolver=lm(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(zs())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=lm(),i=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(i);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},o=>{this.isFulfilled()||this._allPromise!==r||zd(o)||this._resolver.reject(o)}),e.resolve()}};const eue=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),this._promiseProps=new Qce,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(r,o){return this._promiseProps.promise.then(()=>this).then(r,o)}catch(r){return this.when(null,r)}addResolvingPromise(r){r&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in r?r.when():r)}addResolvingTask(r){r&&!this._promiseProps.isFulfilled()&&(this.addHandles(dQ(r)),this._promiseProps.addResolvingPromise(r.promise))}};return i=P([Ve("esri.core.Promise")],i),i},tue=eue(Ln),iue="not-loaded",rue="loading",nue="failed",Sz="loaded",sue=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(o=>{const h=this.load.bind(this);this.load=d=>{const a=new Promise((v,T)=>{const E=AQ(d,T);this.destroyed&&T(new Lt("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(v,T).finally(()=>{E&&E.remove()})});if(this.loadStatus===iue){this._set("loadStatus",rue);const v=this._loadController=new AbortController;h({signal:v.signal})}return o(),a}})),this.when(()=>{this._set("loadStatus",Sz),this._loadController=null},o=>{this.destroyed||(this._set("loadStatus",nue),this._set("loadError",o),this._loadController=null)})}destroy(){this._loadController&&(this._loadController=IQ(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===Sz}get loadWarnings(){return this._get("loadWarnings")}load(r){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new Lt("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return P([R({readOnly:!0})],i.prototype,"loaded",null),P([R({readOnly:!0})],i.prototype,"loadError",void 0),P([R({clonable:!1})],i.prototype,"loadStatus",void 0),P([R({type:[k0],readOnly:!0})],i.prototype,"loadWarnings",null),i=P([Ve("esri.core.Loadable")],i),i},BB=sue(tue);function Uye(t){return!(!t||!t.load)}let sb;function oue(t){return sb&&!sb.destroyed||(sb=t()),sb}var iI;const aue=new xl({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Nr=iI=class extends Ln{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new iI({categories:this.categories?ht(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map(d=>Array.isArray(d)?JSON.stringify(d):d));let r="";if(this.extent){const d=GN(this.extent,Ft.WGS84);d!=null&&(r=`${d.xmin},${d.ymin},${d.xmax},${d.ymax}`)}let o=this.query;!this.disableExtraQuery&&t.extraQuery&&(o="("+o+")"+t.extraQuery);const h={categories:i,bbox:r,q:o,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(h.sortField=this.sortField.split(",").map(d=>aue.toJSON(d.trim())).join(","),h.sortOrder=this.sortOrder),{query:{...e,...h}}}};P([R()],Nr.prototype,"categories",void 0),P([R()],Nr.prototype,"disableExtraQuery",void 0),P([R({type:_i})],Nr.prototype,"extent",void 0),P([R()],Nr.prototype,"filter",void 0),P([R()],Nr.prototype,"num",void 0),P([R()],Nr.prototype,"query",void 0),P([R()],Nr.prototype,"sortField",void 0),P([R()],Nr.prototype,"sortOrder",null),P([R()],Nr.prototype,"start",void 0),Nr=iI=P([Ve("esri.portal.PortalQueryParams")],Nr);var rI;let Tr=rI=class extends Nt{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const i=e.categorySchema||[];return i.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):i})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new Lt("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new rI({sourceJSON:t});return e.read(t),e}queryItems(t,e){let i=Os(Nr,t);const r=this.portal;return parseFloat(r.currentVersion)>5?(i=i||new Nr,r.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new Nr,i.query="group:"+this.id+(i.query?" "+i.query:""),r.queryItems(i,e))}_fetchCategorySchemaSet(t,e){const i=this.portal;return i.fetchSelf(i.authMode,!0,e).then(r=>{const o=r.contentCategorySetsGroupQuery;if(o){const h=new Nr({disableExtraQuery:!0,num:1,query:o});return i.queryGroups(h,e)}throw new Lt("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const o=r.results[0],h=new Nr({num:1,query:`typekeywords:"${t}"`});return o.queryItems(h,e)}throw new Lt("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",e).then(o=>{const h=o?.categorySchema;return h?.length?h:[]}):[])}};P([R()],Tr.prototype,"access",void 0),P([R({type:Date})],Tr.prototype,"created",void 0),P([R()],Tr.prototype,"description",void 0),P([R()],Tr.prototype,"id",void 0),P([R()],Tr.prototype,"isInvitationOnly",void 0),P([R({type:Date})],Tr.prototype,"modified",void 0),P([R()],Tr.prototype,"owner",void 0),P([R()],Tr.prototype,"portal",void 0),P([R()],Tr.prototype,"snippet",void 0),P([R()],Tr.prototype,"sortField",void 0),P([R()],Tr.prototype,"sortOrder",void 0),P([R()],Tr.prototype,"sourceJSON",void 0),P([R()],Tr.prototype,"tags",void 0),P([R()],Tr.prototype,"thumbnail",void 0),P([R({readOnly:!0})],Tr.prototype,"thumbnailUrl",null),P([R()],Tr.prototype,"title",void 0),P([R({readOnly:!0})],Tr.prototype,"url",null),Tr=rI=P([Ve("esri.portal.PortalGroup")],Tr);let qh=class extends Ln{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};P([R()],qh.prototype,"nextQueryParams",void 0),P([R()],qh.prototype,"queryParams",void 0),P([R()],qh.prototype,"results",void 0),P([R()],qh.prototype,"total",void 0),qh=P([Ve("esri.portal.PortalQueryResult")],qh);let nc=class extends Nt{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Lt("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};P([R({type:Date})],nc.prototype,"created",void 0),P([R()],nc.prototype,"id",void 0),P([R()],nc.prototype,"portal",void 0),P([R()],nc.prototype,"title",void 0),P([R({readOnly:!0})],nc.prototype,"url",null),P([R()],nc.prototype,"username",void 0),nc=P([Ve("esri.portal.PortalFolder")],nc);var nI;let Ri=nI=class extends Nt{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,i=t?.data,r=t?.folder,o={method:"post"};e&&(o.query=e.createPostQuery(),i!=null&&(typeof i=="string"?o.query.text=i:typeof i=="object"&&(o.query.text=JSON.stringify(i))));let h=this.userContentUrl;return r&&(h+="/"+(typeof r=="string"?r:r.id)),this.portal.request(h+"/addItem",o).then(d=>(e.id=d.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let i=this.userContentUrl;t.ownerFolder&&(i+="/"+t.ownerFolder);const r=e?{permanentDelete:!0}:{};await this.portal.request(i+`/items/${t.id}/delete`,{method:"post",query:r}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const i=this.userContentUrl+"/deleteItems",r=[],o=t.map(h=>h.id);if(o.length){const h={method:"post",query:{items:o.join(","),permanentDelete:e}},d=await this.portal.request(i,h);for(const a of d.results){const v=t.find(k=>a.itemId===k.id),T=a.success;let E=null;T?(v.id=null,v.portal=null):a.error&&(E=new Lt("portal:delete-item-failed",a.error.message,a.error)),r.push({item:v,success:T,error:E})}}return r}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let i;return i=e&&e.folders?e.folders.map(r=>{const o=nc.fromJSON(r);return o.portal=this.portal,o}):[],i})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(i=>{const r=Tr.fromJSON(i);return r.portal=this.portal,r}):[],e})}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:i}=await Qn(()=>import("./PortalItem-CLnwZtHX.js"),__vite__mapDeps([34,1,2,3])),r={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},o=await this.portal.request(e,{query:r});let h;return o?.items?(h=o.items.map(d=>{const a=i.fromJSON(d);return a.portal=this.portal,a}),await Promise.all(h.map(d=>d.load())),{items:h,nextStart:o.nextStart,total:o.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new Tr({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Lt("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const i=this.userContentUrl,r=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(i+`/items/${t.id}/restore`,{method:"post",query:r})}toJSON(){throw new Lt("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new nI({sourceJSON:t});return e.read(t),e}};P([R()],Ri.prototype,"access",void 0),P([R({type:Date})],Ri.prototype,"created",void 0),P([R()],Ri.prototype,"culture",void 0),P([R()],Ri.prototype,"description",void 0),P([R()],Ri.prototype,"email",void 0),P([R()],Ri.prototype,"favGroupId",void 0),P([R()],Ri.prototype,"fullName",void 0),P([R()],Ri.prototype,"id",void 0),P([R({type:Date})],Ri.prototype,"modified",void 0),P([R()],Ri.prototype,"orgId",void 0),P([R()],Ri.prototype,"portal",void 0),P([R()],Ri.prototype,"preferredView",void 0),P([R()],Ri.prototype,"privileges",void 0),P([R()],Ri.prototype,"region",void 0),P([R()],Ri.prototype,"role",void 0),P([R()],Ri.prototype,"roleId",void 0),P([R()],Ri.prototype,"sourceJSON",void 0),P([R()],Ri.prototype,"thumbnail",void 0),P([R({readOnly:!0})],Ri.prototype,"thumbnailUrl",null),P([R()],Ri.prototype,"units",void 0),P([R({readOnly:!0})],Ri.prototype,"userContentUrl",null),P([R({readOnly:!0})],Ri.prototype,"url",null),P([R()],Ri.prototype,"username",void 0),P([R()],Ri.prototype,"userLicenseTypeId",void 0),P([R()],Ri.prototype,"userType",void 0),Ri=nI=P([Ve("esri.portal.PortalUser")],Ri);var ro;let ay;const Tz={PortalGroup:()=>Promise.resolve({default:Tr}),PortalItem:()=>Qn(()=>import("./PortalItem-CLnwZtHX.js"),__vite__mapDeps([34,1,2,3])),PortalUser:()=>Promise.resolve({default:Ri})};var dl;let nt=(dl=class extends MF(BB){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.g3DTilesGalleryGroupQuery=null,this.g3dTilesEnabled=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=zi.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){Cz.unregister(this),this.defaultBasemap=Cb(this.defaultBasemap),this.defaultDevBasemap=Cb(this.defaultDevBasemap),this.defaultVectorBasemap=Cb(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=nv(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const i of e)zi.request.trustedServers.includes(i)||zi.request.trustedServers.push(i);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,i=!e||this.canSearchPublic;return this.id&&!i?` AND orgid:${this.id}`:null}get hasAPIKey(){return eF(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get loaded(){return super.loaded}get restUrl(){let e=this.url;if(e){const i=e.indexOf("/sharing");e=i>0?e.slice(0,i):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,i=this.thumbnail;return e&&i?this._normalizeSSL(e+"/portals/self/resources/"+i):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let i=null;return e&&(i=Ri.fromJSON(e),i.portal=this),i}load(e){const i=Qn(async()=>{const{default:r}=await import("./Basemap-BNWMJfWA.js");return{default:r}},__vite__mapDeps([35,1,2,36,37,34,3,38,39])).then(({default:r})=>{C0(e),ay=r}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(r=>{if(!this.hasAPIKey&&ji){const o=ji;this.credential=o.findCredential(this.restUrl),this.credential||this.authMode!==ro.AUTH_MODE_AUTO&&this.authMode!==ro.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=o.on("credential-create",lue(new WeakRef(this))),Cz.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(i),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),i=(await Qn(async()=>{const{default:r}=await import("./ElevationLayer-DP8T5POJ.js");return{default:r}},__vite__mapDeps([40,1,2,41,42,43,44,45,46,12,24,47,48,49,37,34,3,50,51,52,8]))).default;return e?e.map(r=>new i({id:r.id,url:r.url})):[]}async fetchBasemaps(e,i){const r=await this._fetchBasemaps(e,i);if(i?.include3d===!0&&this.use3dBasemaps!==!1){const o=await this._fetchBasemaps3D(e,i);r.unshift(...o)}return r}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const i=new Nr;i.query=this.default3DBasemapQuery,i.disableExtraQuery=!0;const r=(await this.queryItems(i,e)).results.find(o=>o.type==="Web Scene");return r?new ay({portalItem:r}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(i=>i.categorySchema):Vu(e)?Promise.reject(zs()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then(i=>i.classificationSchema):null}fetchFeaturedGroups(e){const i=this.featuredGroups,r=new Nr({num:100,sortField:"title"});if(i?.length){const o=[];for(const h of i)o.push(`(title:"${h.title}" AND owner:${h.owner})`);return r.query=o.join(" OR "),this.queryGroups(r,e).then(h=>h.results)}return Vu(e)?Promise.reject(zs()):Promise.resolve([])}fetchRegions(e){const i=this.user?.culture||this.culture||ud();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:i}})}fetchSettings(e){const i=this.user?.culture||this.culture||ud();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:i}})}static getDefault(){return oue(()=>new ro)}queryGroups(e,i){return this.queryPortal("/community/groups",e,"PortalGroup",i)}queryItems(e,i){return this.queryPortal("/search",e,"PortalItem",i)}queryUsers(e,i){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",i)}fetchSelf(e=this.authMode,i=!1,r){const o=this.restUrl+"/portals/self",h={authMode:e,query:{culture:ud().toLowerCase()},withCredentials:!0,...r};return h.authMode==="auto"&&(h.authMode="no-prompt"),i&&(h.query.default=!0),this.request(o,h)}queryPortal(e,i,r,o){const h=Os(Nr,i),d=a=>this.request(this.restUrl+e,{...h.toRequestOptions(this),...o}).then(v=>{const T=h.clone();return T.start=v.nextStart,new qh({nextQueryParams:T,queryParams:h,total:v.total,results:ro._resultsToTypedArray(a,{portal:this},v,o)})}).then(v=>Promise.all(v.results.map(T=>typeof T.when=="function"?T.when():v)).then(()=>v,T=>(kQ(T),v)));return r&&Tz[r]?Tz[r]().then(({default:a})=>(C0(o),d(a))):d()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new Lt("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===ro.AUTH_MODE_ANONYMOUS||this.authMode===ro.AUTH_MODE_NO_PROMPT&&!ji)return Promise.reject(new Lt("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=i=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(i||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=i,this.fetchSelf("immediate"))):this.user&&this.credential===i?null:(this.credential=i,this.fetchSelf("immediate"))).then(r=>{r&&(this.sourceJSON=r,this.read(r))});return ji?ji.getCredential(this.restUrl,{prompt:this.authMode!==ro.AUTH_MODE_NO_PROMPT}).then(i=>e(i)):e(this.credential)}normalizeUrl(e){const i=this.credential?.token;return this._normalizeSSL(i?e+(e.includes("?")?"&":"?")+"token="+i:e)}requestToTypedArray(e,i,r){return this.request(e,i).then(o=>{const h=ro._resultsToTypedArray(r,{portal:this},o);return Promise.all(h.map(d=>typeof d.when=="function"?d.when():o)).then(()=>h,()=>h)})}request(e,i={}){const r={f:"json",...i.query},{authMode:o=this.authMode===ro.AUTH_MODE_ANONYMOUS||this.authMode===ro.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:h=null,cacheBust:d=!1,method:a="auto",responseType:v="json",signal:T}=i,E={authMode:o,body:h,cacheBust:d,method:a,query:r,responseType:v,timeout:0,signal:T};return i.withCredentials&&(E.withCredentials=!0),wn(this._normalizeSSL(e),E).then(k=>k.data)}toJSON(){throw new Lt("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new ro({sourceJSON:e})}_getHelperService(e){const i=this.helperServices?.[e];if(!i)throw new Lt("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return i}async _fetchBasemaps(e,i){const r=new Nr;r.query=e||(o5()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0;const o=await this.queryGroups(r,i);if(!o.total)return[];const h=o.results[0];r.num=100,r.query='type:"Web Map" -type:"Web Application"',r.sortField=h.sortField||"name",r.sortOrder=h.sortOrder||"desc";const d=await h.queryItems(r,i);return d.total?d.results.filter(a=>a.type==="Web Map").map(a=>new ay({portalItem:a})):[]}async _fetchBasemaps3D(e,i){const r=e||this.basemapGalleryGroupQuery3D;if(!r)return[];if(o5())return[];const o=new Nr({query:r,disableExtraQuery:!0}),h=await this.queryGroups(o,i);if(!h.total)return[];const d=h.results[0];o.num=100,o.query='type:"Web Scene"',o.sortField=d.sortField||"name",o.sortOrder=d.sortOrder||"desc";const a=await d.queryItems(o,i);return a.total?a.results.filter(v=>v.type==="Web Scene").map(v=>new ay({portalItem:v})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const i=ay.fromJSON(e);return i.portalItem={portal:this},i}return null}static _resultsToTypedArray(e,i,r,o){let h;if(r){const d=o!=null?o.signal:null;h=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(e||i)&&(h=h.map(a=>{const v=Object.assign(e?e.fromJSON(a):a,i);return typeof v.load=="function"&&v.load(d),v}))}else h=[];return h}},ro=dl,dl.AUTH_MODE_ANONYMOUS="anonymous",dl.AUTH_MODE_AUTO="auto",dl.AUTH_MODE_IMMEDIATE="immediate",dl.AUTH_MODE_NO_PROMPT="no-prompt",dl);P([R()],nt.prototype,"access",void 0),P([R()],nt.prototype,"allSSL",void 0),P([R()],nt.prototype,"authMode",void 0),P([R()],nt.prototype,"authorizedCrossOriginDomains",void 0),P([Br("authorizedCrossOriginDomains")],nt.prototype,"readAuthorizedCrossOriginDomains",null),P([R()],nt.prototype,"basemapGalleryGroupQuery",void 0),P([R({json:{name:"3DBasemapGalleryGroupQuery"}})],nt.prototype,"basemapGalleryGroupQuery3D",void 0),P([R({json:{name:"g3DTilesGalleryGroupQuery"}})],nt.prototype,"g3DTilesGalleryGroupQuery",void 0),P([R({json:{name:"g3dTilesEnabled"}})],nt.prototype,"g3dTilesEnabled",void 0),P([R()],nt.prototype,"bingKey",void 0),P([R()],nt.prototype,"canListApps",void 0),P([R()],nt.prototype,"canListData",void 0),P([R()],nt.prototype,"canListPreProvisionedItems",void 0),P([R()],nt.prototype,"canProvisionDirectPurchase",void 0),P([R()],nt.prototype,"canSearchPublic",void 0),P([R()],nt.prototype,"canShareBingPublic",void 0),P([R()],nt.prototype,"canSharePublic",void 0),P([R()],nt.prototype,"canSignInArcGIS",void 0),P([R()],nt.prototype,"canSignInIDP",void 0),P([R()],nt.prototype,"colorSetsGroupQuery",void 0),P([R()],nt.prototype,"commentsEnabled",void 0),P([R({type:Date})],nt.prototype,"created",void 0),P([R()],nt.prototype,"credential",void 0),P([R()],nt.prototype,"culture",void 0),P([R()],nt.prototype,"currentVersion",void 0),P([R()],nt.prototype,"customBaseUrl",void 0),P([R()],nt.prototype,"default3DBasemapQuery",void 0),P([R()],nt.prototype,"defaultBasemap",void 0),P([Br("defaultBasemap")],nt.prototype,"readDefaultBasemap",null),P([R()],nt.prototype,"defaultDevBasemap",void 0),P([Br("defaultDevBasemap")],nt.prototype,"readDefaultDevBasemap",null),P([R({type:_i})],nt.prototype,"defaultExtent",void 0),P([R()],nt.prototype,"defaultVectorBasemap",void 0),P([Br("defaultVectorBasemap")],nt.prototype,"readDefaultVectorBasemap",null),P([R()],nt.prototype,"description",void 0),P([R()],nt.prototype,"devBasemapGalleryGroupQuery",void 0),P([R()],nt.prototype,"eueiEnabled",void 0),P([R({readOnly:!0})],nt.prototype,"extraQuery",null),P([R()],nt.prototype,"featuredGroups",void 0),P([R()],nt.prototype,"featuredItemsGroupQuery",void 0),P([R()],nt.prototype,"galleryTemplatesGroupQuery",void 0),P([R()],nt.prototype,"layoutGroupQuery",void 0),P([R()],nt.prototype,"livingAtlasGroupQuery",void 0),P([R({readOnly:!0})],nt.prototype,"hasAPIKey",null),P([R()],nt.prototype,"hasCategorySchema",void 0),P([R()],nt.prototype,"hasClassificationSchema",void 0),P([R()],nt.prototype,"helpBase",void 0),P([R()],nt.prototype,"helperServices",void 0),P([R()],nt.prototype,"helpMap",void 0),P([R()],nt.prototype,"homePageFeaturedContent",void 0),P([R()],nt.prototype,"homePageFeaturedContentCount",void 0),P([R()],nt.prototype,"httpPort",void 0),P([R()],nt.prototype,"httpsPort",void 0),P([R()],nt.prototype,"id",void 0),P([R()],nt.prototype,"ipCntryCode",void 0),P([R({readOnly:!0})],nt.prototype,"isOrganization",null),P([R()],nt.prototype,"isPortal",void 0),P([R()],nt.prototype,"isReadOnly",void 0),P([R({readOnly:!0})],nt.prototype,"itemPageUrl",null),P([R()],nt.prototype,"layerTemplatesGroupQuery",void 0),P([R()],nt.prototype,"maxTokenExpirationMinutes",void 0),P([R({type:Date})],nt.prototype,"modified",void 0),P([R()],nt.prototype,"name",void 0),P([R()],nt.prototype,"portalHostname",void 0),P([R()],nt.prototype,"portalMode",void 0),P([R()],nt.prototype,"portalProperties",void 0),P([R()],nt.prototype,"region",void 0),P([R()],nt.prototype,"recycleBinEnabled",void 0),P([R({readOnly:!0})],nt.prototype,"restUrl",null),P([R()],nt.prototype,"rotatorPanels",void 0),P([R()],nt.prototype,"showHomePageDescription",void 0),P([R()],nt.prototype,"sourceJSON",void 0),P([R()],nt.prototype,"staticImagesUrl",void 0),P([R({json:{name:"2DStylesGroupQuery"}})],nt.prototype,"stylesGroupQuery2d",void 0),P([R({json:{name:"stylesGroupQuery"}})],nt.prototype,"stylesGroupQuery3d",void 0),P([R()],nt.prototype,"supportsHostedServices",void 0),P([R()],nt.prototype,"symbolSetsGroupQuery",void 0),P([R()],nt.prototype,"templatesGroupQuery",void 0),P([R()],nt.prototype,"thumbnail",void 0),P([R({readOnly:!0})],nt.prototype,"thumbnailUrl",null),P([R()],nt.prototype,"units",void 0),P([R()],nt.prototype,"url",void 0),P([R()],nt.prototype,"urlKey",void 0),P([Br("urlKey")],nt.prototype,"readUrlKey",null),P([R()],nt.prototype,"user",void 0),P([Br("user")],nt.prototype,"readUser",null),P([R()],nt.prototype,"use3dBasemaps",void 0),P([R()],nt.prototype,"useDefault3dBasemap",void 0),P([R()],nt.prototype,"useStandardizedQuery",void 0),P([R()],nt.prototype,"useVectorBasemaps",void 0),P([R()],nt.prototype,"vectorBasemapGalleryGroupQuery",void 0),nt=ro=P([Ve("esri.portal.Portal")],nt);const Cz=new FinalizationRegistry(t=>{t.remove()});function lue(t){const e=ji;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch(()=>{})}}let ps=class extends Nt{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,i,r){e||(i[r]=e)}};P([R({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],ps.prototype,"enabled",void 0),P([Ui("enabled")],ps.prototype,"writeEnabled",null),P([R({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],ps.prototype,"type",void 0),ps=P([Ve("esri.symbols.Symbol3DLayer")],ps);const cue=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,uue="screenUtils.toPt: input not recognized!",jB=96;function Hye(t){return t?t/72*jB:0}function Md(t){return t?72*t/jB:0}function or(t){if(typeof t=="string"){const e=t.match(cue);if(e){const i=Number(e[1]),r=e[3]&&e[3].toLowerCase(),o=t.startsWith("-"),h=r==="px"?Md(i):i;return o?-h:h}return console.warn(uue),null}return t}function Zye(t=0,e=0){return{x:t,y:e}}function Wye(t=0,e=0){return[t,e]}function Yye(t=0,e=0,i=0){return[t,e,i]}function hue(t){const e=xP(100*(1-t));return Math.max(0,Math.min(e,100))}function due(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}function pue(t,e){const i=e.transparency!=null?due(e.transparency):1,r=e.color;return r&&Array.isArray(r)?new ar([r[0]||0,r[1]||0,r[2]||0,i]):null}function fue(t,e){e.color=t.toJSON().slice(0,3);const i=hue(t.a);i!==0&&(e.transparency=i)}function Wu(t){return{type:ar,nonNullable:t?.nonNullable,json:{type:[Pr],default:null,read:{source:["color","transparency"],reader:pue},write:{target:{color:{type:[Pr],isRequired:t?.colorRequiredOnWrite},transparency:{type:Pr}},writer:fue}}}}const wl={type:Number,cast:or,json:{write:!0}};let Hh=class extends Nt{constructor(e){super(e),this.color=new ar([0,0,0,1]),this.extensionLength=0,this.size=Md(1)}clone(){}cloneProperties(){return{color:ht(this.color),size:this.size,extensionLength:this.extensionLength}}};P([R({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Hh.prototype,"type",void 0),P([R(Wu({colorRequiredOnWrite:!0}))],Hh.prototype,"color",void 0),P([R({...wl,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],Hh.prototype,"extensionLength",void 0),P([R(wl)],Hh.prototype,"size",void 0),Hh=P([Ve("esri.symbols.edges.Edges3D")],Hh);const qP=Hh;var sI;let Qb=sI=class extends qP{constructor(t){super(t),this.type="sketch"}clone(){return new sI(this.cloneProperties())}};P([gi({sketch:"sketch"},{readOnly:!0})],Qb.prototype,"type",void 0),Qb=sI=P([Ve("esri.symbols.edges.SketchEdges3D")],Qb);const mue=Qb;var oI;let ex=oI=class extends qP{constructor(t){super(t),this.type="solid"}clone(){return new oI(this.cloneProperties())}};P([gi({solid:"solid"},{readOnly:!0})],ex.prototype,"type",void 0),ex=oI=P([Ve("esri.symbols.edges.SolidEdges3D")],ex);const gue=ex,UB={types:{key:"type",base:qP,typeMap:{solid:gue,sketch:mue}},json:{write:!0}};var aI;let xf=aI=class extends Nt{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new aI(t)}};P([R({json:{write:!1}})],xf.prototype,"strength",void 0),P([R({json:{write:!1}})],xf.prototype,"source",void 0),xf=aI=P([Ve("esri.symbols.support.Symbol3DEmissive")],xf);var lI;let ho=lI=class extends Nt{constructor(t){super(t),this.color=null,this.emissive=new xf({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new lI(t)}};P([R(Wu())],ho.prototype,"color",void 0),P([R({type:xf,json:{write:!1}})],ho.prototype,"emissive",void 0),ho=lI=P([Ve("esri.symbols.support.Symbol3DMaterial")],ho);var cI,Bf;let sc=(Bf=class extends ps{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new cI({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},cI=Bf,Bf);P([gi({Extrude:"extrude"},{readOnly:!0})],sc.prototype,"type",void 0),P([R({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],sc.prototype,"size",void 0),P([R({type:ho,json:{write:!0}})],sc.prototype,"material",void 0),P([R({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],sc.prototype,"castShadows",void 0),P([R(UB)],sc.prototype,"edges",void 0),sc=cI=P([Ve("esri.symbols.ExtrudeSymbol3DLayer")],sc);let Jy=class extends Nt{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};P([R({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Jy.prototype,"type",void 0),Jy=P([Ve("esri.symbols.patterns.LinePattern3D")],Jy);const yue=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var uI;const vue=_o()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let rd=uI=class extends Jy{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new uI(t)}};P([R({type:["style"],json:{write:{isRequired:!0}}})],rd.prototype,"type",void 0),P([gi(vue),R({type:yue,json:{write:{isRequired:!0}}})],rd.prototype,"style",void 0),rd=uI=P([Ve("esri.symbols.patterns.LineStylePattern3D")],rd);let Ky=class extends Nt{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};P([R({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Ky.prototype,"type",void 0),Ky=P([Ve("esri.symbols.patterns.Pattern3D")],Ky);const _ue=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var hI;let wf=hI=class extends Ky{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new hI({style:this.style})}};P([R({type:["style"],json:{write:{isRequired:!0}}})],wf.prototype,"type",void 0),P([R({type:_ue,json:{read:!0,write:{isRequired:!0}}})],wf.prototype,"style",void 0),wf=hI=P([Ve("esri.symbols.patterns.StylePattern3D")],wf);const bue={types:{key:"type",base:Ky,typeMap:{style:wf}},json:{write:!0}},VB={types:{key:"type",base:Jy,typeMap:{style:rd}},json:{write:!0}},Qy=new ar("white"),xue=new ar([255,255,255,0]);function wue(t){return t.r===0&&t.g===0&&t.b===0}var dI;let e0=dI=class extends ho{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new dI(t)}};P([gi({multiply:"multiply",replace:"replace",tint:"tint"})],e0.prototype,"colorMixMode",void 0),e0=dI=P([Ve("esri.symbols.support.Symbol3DFillMaterial")],e0);function HP(){return[0,0,0]}function Sue(t){return[t[0],t[1],t[2]]}function Om(t,e,i){return[t,e,i]}function Tue(t,e,i){return[t,e,i]}function Cue(t,e=HP()){const i=Math.min(3,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function GB(){return HP()}function qB(){return Om(1,1,1)}function HB(){return Om(1,0,0)}function ZB(){return Om(0,1,0)}function WB(){return Om(0,0,1)}const Eue=GB(),Iue=qB(),$ue=HB(),Pue=ZB(),Mue=WB();Object.freeze(Object.defineProperty({__proto__:null,ONES:Iue,UNIT_X:$ue,UNIT_Y:Pue,UNIT_Z:Mue,ZEROS:Eue,clone:Sue,create:HP,freeze:Tue,fromArray:Cue,fromValues:Om,ones:qB,unitX:HB,unitY:ZB,unitZ:WB,zeros:GB},Symbol.toStringTag,{value:"Module"}));function ZP(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function kue(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function Aue(t,e,i,r,o,h,d,a,v,T,E,k,L,O,H,ie){return[t,e,i,r,o,h,d,a,v,T,E,k,L,O,H,ie]}const Due=ZP();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Due,clone:kue,create:ZP,fromValues:Aue},Symbol.toStringTag,{value:"Module"}));function zue(t){return t<=AL?new Array(t).fill(0):new Float64Array(t)}function Qye(t){return(tQ(t)?t.byteLength/8:t.length)<=AL?Array.from(t):new Float64Array(t)}function e0e(t,e,i){return Array.isArray(t)?t.slice(e,e+i):t.subarray(e,e+i)}function t0e(t){return[...t]}function i0e(t){const e=ZP();for(let i=0;i<16;++i)e[i]=t[i];return e}function _v(t=Bue){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function WP(t,e,i,r,o,h,d=_v()){return d[0]=t,d[1]=e,d[2]=i,d[3]=r,d[4]=o,d[5]=h,d}function r0e(t,e=_v()){return Oue(t,0,t.length/3,e)}function Oue(t,e,i,r=_v()){return YB(r,pI),Rue(r,t,e,i),r}function n0e(t,e=zue(24)){const[i,r,o,h,d,a]=t;return e[0]=i,e[1]=r,e[2]=o,e[3]=i,e[4]=r,e[5]=a,e[6]=i,e[7]=d,e[8]=o,e[9]=i,e[10]=d,e[11]=a,e[12]=h,e[13]=r,e[14]=o,e[15]=h,e[16]=r,e[17]=a,e[18]=h,e[19]=d,e[20]=o,e[21]=h,e[22]=d,e[23]=a,e}function s0e(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new _i(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function o0e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function a0e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function l0e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function Rue(t,e,i=0,r=e.length/3){let o=t[0],h=t[1],d=t[2],a=t[3],v=t[4],T=t[5];for(let E=0;E<r;E++)o=Math.min(o,e[i+3*E]),h=Math.min(h,e[i+3*E+1]),d=Math.min(d,e[i+3*E+2]),a=Math.max(a,e[i+3*E]),v=Math.max(v,e[i+3*E+1]),T=Math.max(T,e[i+3*E+2]);t[0]=o,t[1]=h,t[2]=d,t[3]=a,t[4]=v,t[5]=T}function Lue(t){return t[0]>=t[3]?0:t[3]-t[0]}function Fue(t){return t[1]>=t[4]?0:t[4]-t[1]}function Nue(t){return t[2]>=t[5]?0:t[5]-t[2]}function c0e(t,e=[0,0,0]){return e[0]=Lue(t),e[1]=Fue(t),e[2]=Nue(t),e}function u0e(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function h0e(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function YB(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function d0e(t){return t?YB(t,pI):_v(pI)}function p0e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function f0e(t,e,i,r,o){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=r,t[4]=o,t[5]=Number.POSITIVE_INFINITY,t}function Ez(t){return t.length===6}function m0e(t,e,i){if(t==null||e==null)return t===e;if(!Ez(t)||!Ez(e))return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const pI=[1/0,1/0,1/0,-1/0,-1/0,-1/0],Bue=[0,0,0,0,0,0];_v();function g0e(t,{isPrimitive:e,width:i,depth:r,height:o}){const h=Om(i,r,o);let d;for(let a=0;a<3;a++){const v=h[a];if(v!=null){d=v/t[a];break}}for(let a=0;a<3;a++)h[a]==null&&(h[a]=t[a]*d);return h}const jue=WP(-.5,-.5,-.5,.5,.5,.5),Uue=WP(-.5,-.5,0,.5,.5,1),Vue=WP(-.5,-.5,0,.5,.5,.5);function y0e(t){switch(t){case"sphere":case"cube":case"diamond":return jue;case"cylinder":case"cone":case"inverted-cone":return Uue;case"tetrahedron":return Vue;default:return}}const YP=["butt","square","round"],Gue=[...YP,"none"],XB=["miter","bevel","round"];var fI;let Zh=fI=class extends Nt{constructor(t){super(t),this.color=new ar([0,0,0,1]),this.size=Md(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new fI(t)}};P([R(Wu({colorRequiredOnWrite:!0}))],Zh.prototype,"color",void 0),P([R({...wl,json:{write:{isRequired:!0}}})],Zh.prototype,"size",void 0),P([R(VB)],Zh.prototype,"pattern",void 0),P([R({type:YP,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Zh.prototype,"patternCap",void 0),Zh=fI=P([Ve("esri.symbols.support.Symbol3DOutline")],Zh);var tx,jf;let lo=(jf=class extends ps{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new tx(e)}static fromSimpleFillSymbol(e){const i=e.outline&&e.outline.style&&e.outline.style!=="solid"?new rd({style:e.outline.style}):null,r={size:e.outline?.width??0,color:(e.outline?.color??Qy).clone(),pattern:i};return i&&e.outline?.cap&&(r.patternCap=e.outline.cap),new tx({material:new e0({color:(e.color??xue).clone()}),pattern:e.style&&e.style!=="solid"?new wf({style:e.style}):null,outline:r})}},tx=jf,jf);P([gi({Fill:"fill"},{readOnly:!0})],lo.prototype,"type",void 0),P([R({type:e0,json:{write:!0}})],lo.prototype,"material",void 0),P([R(bue)],lo.prototype,"pattern",void 0),P([R({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],lo.prototype,"castShadows",void 0),P([R({type:Zh,json:{write:!0}})],lo.prototype,"outline",void 0),P([R(UB)],lo.prototype,"edges",void 0),lo=tx=P([Ve("esri.symbols.FillSymbol3DLayer")],lo);var mI;const que=_o()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Wh=mI=class extends Nt{constructor(t){super(t)}readHref(t,e,i){return t?hv(t,i):e.dataURI}writeHref(t,e,i,r){t&&(Am(t)?e.dataURI=t:(e.href=Mw(t,r),wa(e.href)&&(e.href=Fu(e.href))))}clone(){return new mI({href:this.href,primitive:this.primitive})}equals(t){return t.primitive===this.primitive&&t.href===this.href}};P([R({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Wh.prototype,"href",void 0),P([Br("href")],Wh.prototype,"readHref",null),P([Ui("href",{href:{type:String},dataURI:{type:String}})],Wh.prototype,"writeHref",null),P([gi(que)],Wh.prototype,"primitive",void 0),Wh=mI=P([Ve("esri.symbols.support.IconSymbol3DLayerResource")],Wh);const v0e="circle";let ix=class extends ys(Nt){constructor(e){super(e),this.mode="hidden"}equals(e){return this.mode===e.mode}};P([R({type:["adaptive","hidden","visible"],json:{write:{isRequired:!0}}})],ix.prototype,"mode",void 0),ix=P([Ve("esri.symbols.support.OccludedVisibility")],ix);const JB=ix;var gI;let Sf=gI=class extends Ln{constructor(t){super(t),this.x=0,this.y=0}clone(){return new gI({x:this.x,y:this.y})}equals(t){return t.x===this.x&&t.y===this.y}};P([R({type:Number})],Sf.prototype,"x",void 0),P([R({type:Number})],Sf.prototype,"y",void 0),Sf=gI=P([Ve("esri.symbols.support.Symbol3DAnchorPosition2D")],Sf);var yI;let Ay=yI=class extends Nt{constructor(t){super(t),this.color=new ar([0,0,0,1]),this.size=Md(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new yI(t)}equals(t){return t.size===this.size&&(this.color==null?t.color==null:this.color.equals(t.color))}};P([R(Wu({colorRequiredOnWrite:!0}))],Ay.prototype,"color",void 0),P([R({...wl,json:{write:{isRequired:!0}}})],Ay.prototype,"size",void 0),Ay=yI=P([Ve("esri.symbols.support.Symbol3DIconOutline")],Ay);var uf,Uf;let bn=(Uf=class extends ps{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0,this.occludedVisibility=null}clone(){return new uf({anchor:this.anchor,anchorPosition:ht(this.anchorPosition),enabled:this.enabled,material:ht(this.material),outline:ht(this.outline),resource:ht(this.resource),angle:this.angle,size:this.size,occludedVisibility:ht(this.occludedVisibility)})}static fromSimpleMarkerSymbol(e){const i=e.color||Qy,r=Iz(e),o=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||Qy).clone()}:null;return new uf({size:e.size,angle:e.angle,resource:{primitive:Zue(()=>ui.getLogger(this.prototype),e.style)},material:{color:i},outline:o,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(e){const i=!e.color||wue(e.color)?Qy:e.color,r=Iz(e);return new uf({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:i.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(e){return new uf({resource:{href:U6({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},uf=Uf,Uf);function Iz(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,r=$z(t.xoffset),o=$z(t.yoffset);return(r||o)&&e&&i?{x:-r/e,y:o/i}:null}function $z(t){return isFinite(t)?t:0}P([R({type:ho,json:{write:!0}})],bn.prototype,"material",void 0),P([R({type:Wh,json:{write:!0}})],bn.prototype,"resource",void 0),P([gi({Icon:"icon"},{readOnly:!0})],bn.prototype,"type",void 0),P([R({...wl,json:{write:{isRequired:!0}}})],bn.prototype,"size",void 0),P([gi({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],bn.prototype,"anchor",void 0),P([R({type:Sf,json:{type:[Number],read:{reader:t=>new Sf({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],bn.prototype,"anchorPosition",void 0),P([R({type:Ay,json:{write:!0}})],bn.prototype,"outline",void 0),P([R({type:Number,json:{write:!0,default:0}})],bn.prototype,"angle",void 0),P([R({type:JB})],bn.prototype,"occludedVisibility",void 0),bn=uf=P([Ve("esri.symbols.IconSymbol3DLayer")],bn);const Hue={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Zue(t,e){return Hue[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const Wue=["begin","end","begin-end"],KB=["arrow","circle","square","diamond","cross","x"];let hc=class extends ys(Nt){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};P([R({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],hc.prototype,"type",void 0),P([R({type:Wue,json:{default:"begin-end",write:!0}})],hc.prototype,"placement",void 0),P([R({type:KB,json:{default:"arrow",write:!0}})],hc.prototype,"style",void 0),P([R({type:ar,json:{type:[Pr],default:null,write:!0}})],hc.prototype,"color",void 0),hc=P([Ve("esri.symbols.LineStyleMarker3D")],hc);var rx,Vf;let Es=(Vf=class extends ps{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Md(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new rx(e)}static fromSimpleLineSymbol(e){const i={enabled:!0,size:e.width??Md(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new rd({style:e.style}):null,material:new ho({color:(e.color||Qy).clone()}),marker:e.marker?new hc({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new rx(i)}},rx=Vf,Vf);P([R({type:ho,json:{write:!0}})],Es.prototype,"material",void 0),P([gi({Line:"line"},{readOnly:!0})],Es.prototype,"type",void 0),P([R({type:XB,json:{write:!0,default:"miter"}})],Es.prototype,"join",void 0),P([R({type:YP,json:{write:!0,default:"butt"}})],Es.prototype,"cap",void 0),P([R({...wl,json:{write:{isRequired:!0}}})],Es.prototype,"size",void 0),P([R(VB)],Es.prototype,"pattern",void 0),P([R({types:{key:"type",base:hc,typeMap:{style:hc}},json:{write:!0}})],Es.prototype,"marker",void 0),Es=rx=P([Ve("esri.symbols.LineSymbol3DLayer")],Es);var vI;const Yue=_o()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let Dy=vI=class extends Nt{clone(){return new vI({href:this.href,primitive:this.primitive})}};P([R({type:String,json:{read:gP,write:dm}})],Dy.prototype,"href",void 0),P([gi(Yue)],Dy.prototype,"primitive",void 0),Dy=vI=P([Ve("esri.symbols.support.ObjectSymbol3DLayerResource")],Dy);const x0e="sphere";var _I;let Kh=_I=class extends Ln{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new _I({x:this.x,y:this.y,z:this.z})}};P([R({type:Number})],Kh.prototype,"x",void 0),P([R({type:Number})],Kh.prototype,"y",void 0),P([R({type:Number})],Kh.prototype,"z",void 0),Kh=_I=P([Ve("esri.symbols.support.Symbol3DAnchorPosition3D")],Kh);var bI,Gf;let _n=(Gf=class extends ps{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new bI({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},bI=Gf,Gf);P([R({type:ho,json:{write:!0}})],_n.prototype,"material",void 0),P([R({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],_n.prototype,"castShadows",void 0),P([R({type:Dy,json:{write:!0}})],_n.prototype,"resource",void 0),P([gi({Object:"object"},{readOnly:!0})],_n.prototype,"type",void 0),P([R({type:Number,json:{write:!0}})],_n.prototype,"width",void 0),P([R({type:Number,json:{write:!0}})],_n.prototype,"height",void 0),P([R({type:Number,json:{write:!0}})],_n.prototype,"depth",void 0),P([gi({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],_n.prototype,"anchor",void 0),P([R({type:Kh,json:{type:[Number],read:{reader:t=>new Kh({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],_n.prototype,"anchorPosition",void 0),P([R({type:Number,json:{write:!0}})],_n.prototype,"heading",void 0),P([R({type:Number,json:{write:!0}})],_n.prototype,"tilt",void 0),P([R({type:Number,json:{write:!0}})],_n.prototype,"roll",void 0),P([R({readOnly:!0})],_n.prototype,"isPrimitive",null),_n=bI=P([Ve("esri.symbols.ObjectSymbol3DLayer")],_n);var xI,qf;let On=(qf=class extends ps{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,i){return e??(i.height==null&&i.size!=null?i.size:void 0)}readHeight(e,i){return e??(i.width==null&&i.size!=null?i.size:void 0)}clone(){return new xI({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},xI=qf,qf);P([R({type:ho,json:{write:!0}})],On.prototype,"material",void 0),P([R({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],On.prototype,"castShadows",void 0),P([gi({Path:"path"},{readOnly:!0})],On.prototype,"type",void 0),P([R({type:["circle","quad"],nonNullable:!0,json:{write:!0,default:"circle"}})],On.prototype,"profile",void 0),P([R({type:XB,nonNullable:!0,json:{write:!0,default:"miter"}})],On.prototype,"join",void 0),P([R({type:Gue,nonNullable:!0,json:{write:!0,default:"butt"}})],On.prototype,"cap",void 0),P([R({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],On.prototype,"width",void 0),P([Br("width",["width","size","height"])],On.prototype,"readWidth",null),P([R({type:Number,json:{write:!0}})],On.prototype,"height",void 0),P([Br("height",["height","size","width"])],On.prototype,"readHeight",null),P([R({type:["center","bottom","top"],nonNullable:!0,json:{write:!0,default:"center"}})],On.prototype,"anchor",void 0),P([R({type:["heading","all"],nonNullable:!0,json:{write:!0,default:"all"}})],On.prototype,"profileRotation",void 0),On=xI=P([Ve("esri.symbols.PathSymbol3DLayer")],On);const Xue=["none","underline","line-through"],Jue=["normal","italic","oblique"],Kue=["normal","lighter","bold","bolder"],QB={type:Number,cast:t=>{const e=zw(t);return e===0?1:fv(e,.1,4)},nonNullable:!0},Que=["left","right","center"],ehe=["baseline","top","middle","bottom"],e8={type:Que,nonNullable:!0},t8={type:ehe,nonNullable:!0};var wI;let Fo=wI=class extends Nt{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return or(t)}clone(){return new wI({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};P([R({type:Xue,json:{default:"none",write:!0}})],Fo.prototype,"decoration",void 0),P([R({type:String,json:{write:!0}})],Fo.prototype,"family",void 0),P([R({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],Fo.prototype,"size",void 0),P([dv("size")],Fo.prototype,"castSize",null),P([R({type:Jue,json:{default:"normal",write:!0}})],Fo.prototype,"style",void 0),P([R({type:Kue,json:{default:"normal",write:!0}})],Fo.prototype,"weight",void 0),Fo=wI=P([Ve("esri.symbols.Font")],Fo);var SI;let Tf=SI=class extends Nt{constructor(){super(...arguments),this.color=new ar([0,0,0,1]),this.size=0}clone(){const t={color:ht(this.color),size:this.size};return new SI(t)}};P([R(Wu())],Tf.prototype,"color",void 0),P([R(wl)],Tf.prototype,"size",void 0),Tf=SI=P([Ve("esri.symbols.support.Symbol3DHalo")],Tf);let t0=class extends ys(Nt){constructor(e){super(e),this.color=null}};P([R(Wu())],t0.prototype,"color",void 0),t0=P([Ve("esri.symbols.support.Symbol3DTextBackground")],t0);var nx,Hf;let en=(Hf=class extends ps{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline",this.occludedVisibility=null}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,i,r,o){const h={...o,textSymbol3D:!0};i.font=e.write({},h),delete i.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new nx({enabled:this.enabled,font:ht(this.font),halo:ht(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:ht(this.background),occludedVisibility:ht(this.occludedVisibility)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new nx({font:e.font!=null?e.font.clone():new Fo,halo:the(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new ho({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new t0({color:e.backgroundColor.clone()}):null})}},nx=Hf,Hf);function the(t,e){return t&&e!=null&&e>0?new Tf({color:ht(t),size:e}):null}P([R({type:Fo,json:{write:!0}})],en.prototype,"font",null),P([Ui("font")],en.prototype,"writeFont",null),P([R({type:Tf,json:{write:!0}})],en.prototype,"halo",void 0),P([R({...e8,json:{default:"center",write:!0}})],en.prototype,"horizontalAlignment",void 0),P([R({...QB,json:{default:1,write:!0}})],en.prototype,"lineHeight",void 0),P([R({type:ho,json:{write:!0}})],en.prototype,"material",void 0),P([R({type:t0,json:{write:!0}})],en.prototype,"background",void 0),P([R(wl)],en.prototype,"size",null),P([R({type:String,json:{write:!0}})],en.prototype,"text",void 0),P([gi({Text:"text"},{readOnly:!0})],en.prototype,"type",void 0),P([R({...t8,json:{default:"baseline",write:!0}})],en.prototype,"verticalAlignment",void 0),P([R({type:JB})],en.prototype,"occludedVisibility",void 0),en=nx=P([Ve("esri.symbols.TextSymbol3DLayer")],en);var TI,Zf;let oc=(Zf=class extends ps{constructor(e){super(e),this.color=CI.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new TI({color:this.color.clone(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},TI=Zf,Zf);P([R({type:ar,nonNullable:!0,json:{type:[Pr],write:(t,e,i)=>e[i]=t.toArray(1),default:()=>CI.clone(),defaultEquals:t=>t.toCss(!0)===CI.toCss(!0)}})],oc.prototype,"color",void 0),P([gi({Water:"water"},{readOnly:!0})],oc.prototype,"type",void 0),P([R({type:["small","medium","large"],json:{write:!0,default:"medium"}})],oc.prototype,"waterbodySize",void 0),P([R({type:Number,json:{write:!0,default:null}})],oc.prototype,"waveDirection",void 0),P([R({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],oc.prototype,"waveStrength",void 0),oc=TI=P([Ve("esri.symbols.WaterSymbol3DLayer")],oc);const CI=new ar([0,119,190]);var EI;let dc=EI=class extends Ln{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new EI({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};P([R({type:String})],dc.prototype,"name",void 0),P([R({type:String})],dc.prototype,"styleUrl",void 0),P([R({type:String})],dc.prototype,"styleName",void 0),P([R({type:nt})],dc.prototype,"portal",void 0),dc=EI=P([Ve("esri.symbols.support.StyleOrigin")],dc);var II;let i0=II=class extends Ln{constructor(){super(...arguments),this.url=""}clone(){return new II({url:this.url})}};P([R({type:String})],i0.prototype,"url",void 0),i0=II=P([Ve("esri.symbols.support.Thumbnail")],i0);const i8={icon:bn,object:_n,line:Es,path:On,fill:lo,extrude:sc,text:en,water:oc},ihe=sr.ofType({base:ps,key:"type",typeMap:i8,errorContext:"symbol-layer"});let Is=class extends jr{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=i?.type,o=r||sr;this._set("symbolLayers",new o)}get color(){return null}set color(e){this.constructed&&ui.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Xce(e,this._get("symbolLayers"))}readStyleOrigin(e,i,r){if(e.styleUrl&&e.name){const o=hv(e.styleUrl,r);return new dc({styleUrl:o,name:e.name})}if(e.styleName&&e.name)return new dc({portal:r?.portal||nt.getDefault(),styleName:e.styleName,name:e.name});r?.messages&&r.messages.push(new k0("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,i,r,o){if(e.styleUrl&&e.name){let h=Mw(e.styleUrl,o);wa(h)&&(h=Fu(h)),i.styleOrigin={styleUrl:h,name:e.name}}else e.styleName&&e.name&&(e.portal&&o?.portal&&!jie(e.portal.restUrl,o.portal.restUrl)?o?.messages&&o.messages.push(new k0("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof ps||e&&i8[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};P([R({json:{read:!1,write:!1}})],Is.prototype,"color",null),P([R({type:ihe,nonNullable:!0,json:{write:!0}}),dv(Jce)],Is.prototype,"symbolLayers",null),P([R({type:dc})],Is.prototype,"styleOrigin",void 0),P([Br("styleOrigin")],Is.prototype,"readStyleOrigin",null),P([Ui("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Is.prototype,"writeStyleOrigin",null),P([R({type:i0,json:{read:!1}})],Is.prototype,"thumbnail",void 0),P([R({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Is.prototype,"type",void 0),Is=P([Ve("esri.symbols.Symbol3D")],Is);let Cf=class extends Nt{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};P([R({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],Cf.prototype,"type",void 0),P([R({readOnly:!0})],Cf.prototype,"visible",void 0),Cf=P([Ve("esri.symbols.callouts.Callout3D")],Cf);var $I;let sx=$I=class extends Nt{constructor(t){super(t),this.color=new ar("white")}clone(){return new $I({color:ht(this.color)})}};P([R(Wu({colorRequiredOnWrite:!0}))],sx.prototype,"color",void 0),sx=$I=P([Ve("esri.symbols.callouts.LineCallout3DBorder")],sx);const rhe=sx;var PI;let ac=PI=class extends Cf{constructor(t){super(t),this.type="line",this.color=new ar([0,0,0,1]),this.size=Md(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new PI({color:ht(this.color),size:this.size,border:ht(this.border)})}};P([gi({line:"line"})],ac.prototype,"type",void 0),P([R(Wu({colorRequiredOnWrite:!0}))],ac.prototype,"color",void 0),P([R({...wl,json:{write:{isRequired:!0}}})],ac.prototype,"size",void 0),P([R({type:rhe,json:{write:!0}})],ac.prototype,"border",void 0),P([R({readOnly:!0})],ac.prototype,"visible",null),ac=PI=P([Ve("esri.symbols.callouts.LineCallout3D")],ac);function XP(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function r8(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!XP(t)}const n8={types:{key:"type",base:Cf,typeMap:{line:ac}},json:{write:!0}};var MI;let Iu=MI=class extends Nt{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new MI({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};P([R({...wl,json:{write:{isRequired:!0}}})],Iu.prototype,"screenLength",void 0),P([R({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Iu.prototype,"minWorldLength",void 0),P([R({type:Number,json:{write:!0}})],Iu.prototype,"maxWorldLength",void 0),Iu=MI=P([Ve("esri.symbols.support.Symbol3DVerticalOffset")],Iu);var ox;const s8=sr.ofType({base:null,key:"type",typeMap:{text:en}});let sl=ox=class extends Is{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new s8,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return r8(this)}hasVisibleVerticalOffset(){return XP(this)}clone(){return new ox({styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail),callout:ht(this.callout),verticalOffset:ht(this.verticalOffset)})}static fromTextSymbol(t){return new ox({symbolLayers:new sr([en.fromTextSymbol(t)])})}};P([R({type:Iu,json:{write:!0}})],sl.prototype,"verticalOffset",void 0),P([R(n8)],sl.prototype,"callout",void 0),P([R({json:{read:!1,write:!1}})],sl.prototype,"styleOrigin",void 0),P([R({type:s8})],sl.prototype,"symbolLayers",void 0),P([gi({LabelSymbol3D:"label-3d"},{readOnly:!0})],sl.prototype,"type",void 0),sl=ox=P([Ve("esri.symbols.LabelSymbol3D")],sl);var ax;const o8=sr.ofType({base:null,key:"type",typeMap:{line:Es,path:On}}),nhe=sr.ofType({base:null,key:"type",typeMap:{line:Es,path:On}});let Du=ax=class extends Is{constructor(t){super(t),this.symbolLayers=new o8,this.type="line-3d"}clone(){return new ax({styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail)})}static fromSimpleLineSymbol(t){return new ax({symbolLayers:new sr([Es.fromSimpleLineSymbol(t)])})}};P([R({type:o8,json:{type:nhe}})],Du.prototype,"symbolLayers",void 0),P([gi({LineSymbol3D:"line-3d"},{readOnly:!0})],Du.prototype,"type",void 0),Du=ax=P([Ve("esri.symbols.LineSymbol3D")],Du);var lx;const a8=sr.ofType({base:null,key:"type",typeMap:{fill:lo}});let nd=lx=class extends Is{constructor(t){super(t),this.symbolLayers=new a8,this.type="mesh-3d"}clone(){return new lx({styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail)})}static fromSimpleFillSymbol(t){return new lx({symbolLayers:new sr([lo.fromSimpleFillSymbol(t)])})}};P([R({type:a8})],nd.prototype,"symbolLayers",void 0),P([gi({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],nd.prototype,"type",void 0),nd=lx=P([Ve("esri.symbols.MeshSymbol3D")],nd);let zy=class extends jr{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};P([gi({esriSLS:"simple-line"},{readOnly:!0})],zy.prototype,"type",void 0),P([R({type:Number,cast:or,json:{write:!0}})],zy.prototype,"width",void 0),zy=P([Ve("esri.symbols.LineSymbol")],zy);var kI;let rl=kI=class extends Nt{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,r){e[i]=r?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,r){r?.origin==="web-map"||(e[i]=t)}clone(){return new kI({color:ht(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};P([R({type:["begin","end","begin-end"],json:{write:!0}})],rl.prototype,"placement",void 0),P([gi({"line-marker":"line-marker"},{readOnly:!0}),R({json:{origins:{"web-map":{write:!1}}}})],rl.prototype,"type",void 0),P([R({type:KB})],rl.prototype,"style",void 0),P([Ui("style")],rl.prototype,"writeStyle",null),P([R({type:ar,value:null,json:{write:{allowNull:!0}}})],rl.prototype,"color",null),P([Br("color")],rl.prototype,"readColor",null),P([Ui("color")],rl.prototype,"writeColor",null),rl=kI=P([Ve("esri.symbols.LineSymbolMarker")],rl);const she=rl;var AI;const RT=new xl({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Wn=AI=class extends zy{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,r,o,h){if(t&&typeof t!="string")return t;const d={};return t!=null&&(d.style=t),e!=null&&(d.color=e),i!=null&&(d.width=or(i)),r!=null&&(d.cap=r),o!=null&&(d.join=o),h!=null&&(d.miterLimit=or(h)),d}clone(){return new AI({color:ht(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};P([gi({esriSLS:"simple-line"},{readOnly:!0})],Wn.prototype,"type",void 0),P([R({type:RT.apiValues,json:{read:RT.read,write:RT.write}})],Wn.prototype,"style",void 0),P([R({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&i?.origin==null})}}})],Wn.prototype,"cap",void 0),P([R({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&i?.origin==null})}}})],Wn.prototype,"join",void 0),P([R({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":she}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Wn.prototype,"marker",void 0),P([R({type:Number,json:{read:!1,write:!1}})],Wn.prototype,"miterLimit",void 0),Wn=AI=P([Ve("esri.symbols.SimpleLineSymbol")],Wn);let Ef=class extends jr{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};P([R({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Wn}},json:{default:null,write:!0}})],Ef.prototype,"outline",void 0),P([R({type:["simple-fill","picture-fill"],readOnly:!0})],Ef.prototype,"type",void 0),Ef=P([Ve("esri.symbols.FillSymbol")],Ef);function ohe(t,e,i){return e.imageData?U6({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):l8(e.url,i)}function l8(t,e){if(!wa(t)){const i=lhe(e);if(i)return Pw(i,"images",t)}return hv(t,e)}function ahe(t,e,i,r){if(Am(t)){const o=P0(t);if(!o)return;e.contentType=o.mediaType,e.imageData=o.data,i&&i.imageData===e.imageData&&i.url&&dm(i.url,e,"url",r)}else dm(t,e,"url",r)}const c8={json:{read:{source:["imageData","url"],reader:ohe},write:{writer(t,e,i,r){ahe(t,e,this.source,r)}}}},u8={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const r={};return e.imageData&&(r.imageData=e.imageData),e.contentType&&(r.contentType=e.contentType),e.url&&(r.url=l8(e.url,i)),r}}}};function lhe(t){if(!t)return null;const{origin:e,layer:i}=t;if(e!=="service"&&e!=="portal-item")return null;const r=i?.type;return r==="feature"||r==="stream"?i.parsedUrl?.path:r==="map-image"||r==="tile"?t.url?.path:null}var DI;let Ss=DI=class extends Ef{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const o={};return t&&(o.url=t),e&&(o.outline=e),i!=null&&(o.width=or(i)),r!=null&&(o.height=or(r)),o}clone(){const t=new DI({color:ht(this.color),height:this.height,outline:ht(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",ht(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};P([gi({esriPFS:"picture-fill"},{readOnly:!0})],Ss.prototype,"type",void 0),P([R(c8)],Ss.prototype,"url",void 0),P([R({type:Number,json:{write:!0}})],Ss.prototype,"xscale",void 0),P([R({type:Number,json:{write:!0}})],Ss.prototype,"yscale",void 0),P([R({type:Number,cast:or,json:{write:!0}})],Ss.prototype,"width",void 0),P([R({type:Number,cast:or,json:{write:!0}})],Ss.prototype,"height",void 0),P([R({type:Number,cast:or,json:{write:!0}})],Ss.prototype,"xoffset",void 0),P([R({type:Number,cast:or,json:{write:!0}})],Ss.prototype,"yoffset",void 0),P([R(u8)],Ss.prototype,"source",void 0),Ss=DI=P([Ve("esri.symbols.PictureFillSymbol")],Ss);let lc=class extends jr{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};P([R({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],lc.prototype,"angle",void 0),P([R({type:["simple-marker","picture-marker"],readOnly:!0})],lc.prototype,"type",void 0),P([R({type:Number,cast:or,json:{write:!0}})],lc.prototype,"xoffset",void 0),P([R({type:Number,cast:or,json:{write:!0}})],lc.prototype,"yoffset",void 0),P([R({cast:t=>t==="auto"?t:zw(or(t)),json:{write:!0}})],lc.prototype,"size",void 0),lc=P([Ve("esri.symbols.MarkerSymbol")],lc);var zI;let ds=zI=class extends lc{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e!=null&&(r.width=or(e)),i!=null&&(r.height=or(i)),r}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new zI({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",ht(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};P([R({json:{write:!1}})],ds.prototype,"color",void 0),P([gi({esriPMS:"picture-marker"},{readOnly:!0})],ds.prototype,"type",void 0),P([R(c8)],ds.prototype,"url",void 0),P([R(u8)],ds.prototype,"source",void 0),P([R({type:Number,cast:or,json:{write:!0}})],ds.prototype,"height",void 0),P([Br("height",["height","size"])],ds.prototype,"readHeight",null),P([R({type:Number,cast:or,json:{write:!0}})],ds.prototype,"width",void 0),P([R({json:{write:!1}})],ds.prototype,"size",void 0),ds=zI=P([Ve("esri.symbols.PictureMarkerSymbol")],ds);var Yh;const h8=sr.ofType({base:null,key:"type",typeMap:{icon:bn,object:_n,text:en}});let cl=Yh=class extends Is{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new h8,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return r8(this)}hasVisibleVerticalOffset(){return XP(this)}clone(){return new Yh({verticalOffset:ht(this.verticalOffset),callout:ht(this.callout),styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Yh({symbolLayers:new sr([bn.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new Yh({symbolLayers:new sr([bn.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const i=t.data.symbol;return new Yh(i?.callout?{symbolLayers:new sr([bn.fromCIMSymbol(t)]),callout:new ac({size:.5,color:new ar([0,0,0])}),verticalOffset:new Iu({screenLength:40})}:{symbolLayers:new sr([bn.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new Yh({symbolLayers:new sr([en.fromTextSymbol(t)])})}};P([R({type:Iu,json:{write:!0}})],cl.prototype,"verticalOffset",void 0),P([R(n8)],cl.prototype,"callout",void 0),P([R({type:h8,json:{origins:{"web-scene":{write:!0}}}})],cl.prototype,"symbolLayers",void 0),P([gi({PointSymbol3D:"point-3d"},{readOnly:!0})],cl.prototype,"type",void 0),cl=Yh=P([Ve("esri.symbols.PointSymbol3D")],cl);var Oy;const d8=sr.ofType({base:null,key:"type",typeMap:{extrude:sc,fill:lo,icon:bn,line:Es,object:_n,text:en,water:oc}});let zu=Oy=class extends Is{constructor(t){super(t),this.symbolLayers=new d8,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&fm(ui.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&fm(ui.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(v4(()=>this.symbolLayers,"after-add",({item:e})=>t(e),aee))}clone(){return new Oy({styleOrigin:ht(this.styleOrigin),symbolLayers:ht(this.symbolLayers),thumbnail:ht(this.thumbnail)})}static fromJSON(t){const e=new Oy;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const i=e.symbolLayers.at(0),r=e.symbolLayers.at(1);!r.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(i.outline={size:r.size,color:r.material!=null?r.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new Oy({symbolLayers:new sr([lo.fromSimpleFillSymbol(t)])})}};P([R({type:d8,json:{write:!0}})],zu.prototype,"symbolLayers",void 0),P([gi({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],zu.prototype,"type",void 0),zu=Oy=P([Ve("esri.symbols.PolygonSymbol3D")],zu);var OI;const LT=new xl({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let ul=OI=class extends Ef{constructor(...t){super(...t),this.color=new ar([0,0,0,.25]),this.outline=new Wn,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e&&(r.outline=e),i&&(r.color=i),r}clone(){return new OI({color:ht(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};P([R()],ul.prototype,"color",void 0),P([R()],ul.prototype,"outline",void 0),P([gi({esriSFS:"simple-fill"},{readOnly:!0})],ul.prototype,"type",void 0),P([R({type:LT.apiValues,json:{read:LT.read,write:LT.write}})],ul.prototype,"style",void 0),ul=OI=P([Ve("esri.symbols.SimpleFillSymbol")],ul);var RI;const FT=new xl({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let ao=RI=class extends lc{constructor(...t){super(...t),this.color=new ar([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Wn}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string")return t;const o={};return t&&(o.style=t),e!=null&&(o.size=or(e)),i&&(o.outline=i),r&&(o.color=r),o}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new RI({angle:this.angle,color:ht(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};P([R()],ao.prototype,"color",void 0),P([Ui("color")],ao.prototype,"writeColor",null),P([gi({esriSMS:"simple-marker"},{readOnly:!0})],ao.prototype,"type",void 0),P([R()],ao.prototype,"size",void 0),P([R({type:FT.apiValues,json:{read:FT.read,write:FT.write}})],ao.prototype,"style",void 0),P([R({type:String,json:{write:!0}})],ao.prototype,"path",null),P([R({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Wn}},json:{default:null,write:!0}})],ao.prototype,"outline",void 0),ao=RI=P([Ve("esri.symbols.SimpleMarkerSymbol")],ao);var LI;let Fi=LI=class extends jr{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new Fo,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.text=t),e&&(r.font=e),i&&(r.color=i),r}writeLineWidth(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}castLineWidth(t){return or(t)}writeLineHeight(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}clone(){return new LI({angle:this.angle,backgroundColor:ht(this.backgroundColor),borderLineColor:ht(this.borderLineColor),borderLineSize:this.borderLineSize,color:ht(this.color),font:this.font&&this.font.clone(),haloColor:ht(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};P([R({type:ar,json:{write:!0}})],Fi.prototype,"backgroundColor",void 0),P([R({type:ar,json:{write:!0}})],Fi.prototype,"borderLineColor",void 0),P([R({type:Number,json:{write:!0},cast:or})],Fi.prototype,"borderLineSize",void 0),P([R({type:Fo,json:{write:!0}})],Fi.prototype,"font",void 0),P([R({...e8,json:{write:!0}})],Fi.prototype,"horizontalAlignment",void 0),P([R({type:Boolean,json:{write:!0}})],Fi.prototype,"kerning",void 0),P([R({type:ar,json:{write:!0}})],Fi.prototype,"haloColor",void 0),P([R({type:Number,cast:or,json:{write:!0}})],Fi.prototype,"haloSize",void 0),P([R({type:Boolean,json:{write:!0}})],Fi.prototype,"rightToLeft",void 0),P([R({type:Boolean,json:{write:!0}})],Fi.prototype,"rotated",void 0),P([R({type:String,json:{write:!0}})],Fi.prototype,"text",void 0),P([gi({esriTS:"text"},{readOnly:!0})],Fi.prototype,"type",void 0),P([R({...t8,json:{write:!0}})],Fi.prototype,"verticalAlignment",void 0),P([R({type:Number,cast:or,json:{write:!0}})],Fi.prototype,"xoffset",void 0),P([R({type:Number,cast:or,json:{write:!0}})],Fi.prototype,"yoffset",void 0),P([R({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Fi.prototype,"angle",void 0),P([R({type:Number,json:{write:!0}})],Fi.prototype,"width",void 0),P([R({type:Number})],Fi.prototype,"lineWidth",void 0),P([Ui("lineWidth")],Fi.prototype,"writeLineWidth",null),P([dv("lineWidth")],Fi.prototype,"castLineWidth",null),P([R(QB)],Fi.prototype,"lineHeight",void 0),P([Ui("lineHeight")],Fi.prototype,"writeLineHeight",null),Fi=LI=P([Ve("esri.symbols.TextSymbol")],Fi);var FI;let Cs=FI=class extends jr{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:nt.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new FI({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){sF(ui.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new Lt("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,i=e?this._fetchCacheKey:null;if(e!=null){const d=i&&e.get(i);if(d)return d.clone()}const{resolveWebStyleSymbol:r}=await Qn(()=>import("./webStyleSymbolUtils-CxulSo9Z.js"),__vite__mapDeps([53,54,55,56,57,58,1,2,3]));C0(t);const o=r(this,{portal:this.portal},t);o.catch(d=>{ui.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",d)});const h=await o;return e?.set(i,h.clone()),h}};P([R({json:{write:!1}})],Cs.prototype,"color",void 0),P([R({type:String,json:{write:!0}})],Cs.prototype,"styleName",void 0),P([R({type:nt,json:{write:!1}})],Cs.prototype,"portal",void 0),P([R({type:String,json:{read:gP,write:dm}})],Cs.prototype,"styleUrl",void 0),P([R({type:i0,json:{read:!1}})],Cs.prototype,"thumbnail",void 0),P([R({type:String,json:{write:!0}})],Cs.prototype,"name",void 0),P([gi({styleSymbolReference:"web-style"},{readOnly:!0})],Cs.prototype,"type",void 0),P([R()],Cs.prototype,"_fetchCacheKey",null),Cs=FI=P([Ve("esri.symbols.WebStyleSymbol")],Cs);function $0e(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function P0e(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const JP={base:jr,key:"type",typeMap:{"simple-fill":ul,"picture-fill":Ss,"picture-marker":ds,"simple-line":Wn,"simple-marker":ao,text:Fi,"label-3d":sl,"line-3d":Du,"mesh-3d":nd,"point-3d":cl,"polygon-3d":zu,"web-style":Cs,cim:Ms},errorContext:"symbol"},M0e={base:jr,key:"type",typeMap:{"picture-marker":ds,"simple-marker":ao,"point-3d":cl,cim:Ms},errorContext:"symbol"},k0e={base:jr,key:"type",typeMap:{"simple-line":Wn,"line-3d":Du,cim:Ms},errorContext:"symbol"},A0e={base:jr,key:"type",typeMap:{"simple-fill":ul,"picture-fill":Ss,"polygon-3d":zu,cim:Ms},errorContext:"symbol"},D0e={base:jr,key:"type",typeMap:{"picture-marker":ds,"simple-marker":ao,text:Fi,"web-style":Cs,cim:Ms},errorContext:"symbol"},z0e=vF({types:JP}),O0e={base:jr,key:"type",typeMap:{"simple-fill":ul,"picture-fill":Ss,"picture-marker":ds,"simple-line":Wn,"simple-marker":ao,text:Fi,"line-3d":Du,"mesh-3d":nd,"point-3d":cl,"polygon-3d":zu,"web-style":Cs,cim:Ms},errorContext:"symbol"},R0e={base:jr,key:"type",typeMap:{text:Fi,"label-3d":sl},errorContext:"symbol"},L0e={base:jr,key:"type",typeMap:{"line-3d":Du,"mesh-3d":nd,"point-3d":cl,"polygon-3d":zu,"web-style":Cs,cim:Ms},errorContext:"symbol"},F0e={base:jr,key:"type",typeMap:{"label-3d":sl},errorContext:"symbol"},N0e=mm(JP);var NI;function che(t){if(!t)return null;const e={};for(const i in t){const r=LB(t[i]);r&&(e[i]=r)}return Object.keys(e).length!==0?e:null}function uhe(t){if(t==null)return null;const e={};for(const i in t){const r=t[i];r&&(e[i]=r.toJSON())}return Object.keys(e).length!==0?e:null}var Wf;let qn=(Wf=class extends ys(Nt){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:Eb(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&Zre(ui.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const i=this._get("aggregateGeometries");JSON.stringify(i)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const i=this._get("attributes");i!==e&&(this._set("attributes",e),this._notifyLayer("attributes",i,e))}set geometry(e){const i=this._get("geometry");i!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",i,e))}set popupTemplate(e){const i=this._get("popupTemplate");i!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",i,e))}set symbol(e){const i=this._get("symbol");i!==e&&(this._set("symbol",e),this._notifyLayer("symbol",i,e))}get version(){return this._version}set visible(e){const i=this._get("visible");i!==e&&(this._set("visible",e),this._notifyLayer("visible",i,e))}cloneShallow(){return new NI({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const i=Wce(this.origin);if(i)return i.popupTemplate??(e?i.defaultPopupTemplate:null)??null;const r=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const o of[r,this.sourceLayer,this.layer])if(o&&typeof o=="object"){if("popupTemplate"in o&&o.popupTemplate)return o.popupTemplate;if(e&&"defaultPopupTemplate"in o&&o.defaultPopupTemplate!=null)return o.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,i){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=i,this._notifyLayer("attributes",r,i,e)}else this.attributes={[e]:i}}getObjectId(){const e=bz(this.origin);if(e)return xz(this,e);const i=this.sourceLayer??this.layer;return i?xz(this,i):null}getGlobalId(){const e=bz(this.origin);if(e?.globalIdField)return this.getAttribute(e.globalIdField);const i=this.sourceLayer??this.layer;return i&&"globalIdField"in i&&i.globalIdField?this.getAttribute(i.globalIdField):null}toJSON(){return{aggregateGeometries:uhe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:o1(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:i}=this;if(i?.type==="mesh"){const r={origin:i.origin,transform:i.transform};this._notifyLayer("origin-transform",r,r,e.action)}}_notifyLayer(e,i,r,o){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const h={graphic:this,property:e,oldValue:i,newValue:r};e==="origin-transform"&&(h.action=o),e==="attributes"&&(h.attributeName=o),this.layer.graphicChanged(h)}_watchMeshGeometryChanges(){this.addHandles([qC(()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:i})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===i||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=i,this.notifyMeshTransformChanged())}),qC(()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,i)=>e===i,sync:!0})])}},NI=Wf,Wf);P([R({value:null,json:{read:che}})],qn.prototype,"aggregateGeometries",null),P([R({value:null})],qn.prototype,"attributes",null),P([R({value:null,types:qce,json:{read:LB}})],qn.prototype,"geometry",null),P([R({type:Boolean})],qn.prototype,"isAggregate",void 0),P([R({clonable:!1})],qn.prototype,"layer",void 0),P([R({clonable:"reference"})],qn.prototype,"origin",void 0),P([R({type:F0,value:null})],qn.prototype,"popupTemplate",null),P([R({clonable:"reference"})],qn.prototype,"sourceLayer",void 0),P([R({value:null,types:JP})],qn.prototype,"symbol",null),P([R({clonable:!1,json:{read:!1,write:!1}})],qn.prototype,"_version",void 0),P([R({type:Boolean,value:!0})],qn.prototype,"visible",null),qn=NI=P([Ve("esri.Graphic")],qn);const p8=96;function B0e(t,e){const i=t.extent,r=t.width,o=Sc(i?.spatialReference);return i&&r?i.width/r*o*LN*p8:0}function hhe(t,e){return t/(Sc(e)*LN*p8)}function dhe(t,e){const i=t.extent,r=t.width-(t.padding?t.padding.left+t.padding.right:0),o=hhe(e,i.spatialReference);return i.clone().expand(o*r/i.width)}function j0e(t,e,i){return phe(t,e)&&fhe(t,i)}function phe(t,e){return e===0||Ta(t,e)||t<e}function fhe(t,e){return e===0||Ta(t,e)||t>e}function U0e(t,e){return Ta(t,e)?0:(t||Number.POSITIVE_INFINITY)>(e||Number.POSITIVE_INFINITY)?1:-1}function Pz(t){switch(t?.type){case"point":return t;case"extent":return t.center;case"polygon":{const e=MB(t);return e?oi.fromJSON(e):null}case"multipoint":case"polyline":return t.extent?.center;default:return null}}async function mhe(t,e){if(t.hasZ||e.type==="2d")return t;const i=e.map?.ground;return i?.layers.length?(await i.queryElevation(t,{cache:e.basemapTerrain?.elevationQueryCache})).geometry:t}function BI(t,e,i){return f8(t.center,e,i)}function KP(t,e,i){switch(t?.type){case"extent":return t;case"multipoint":case"polygon":case"polyline":return t.extent;case"point":return f8(t,e,i);default:return null}}function f8(t,e,i){const r=t.hasZ?t.z:void 0;if(e?.map)return(i!=null?dhe(e,i):e.extent).clone().centerAt(t).set({zmax:r,zmin:r});const{x:o,y:h,spatialReference:d}=t;return new _i({xmin:o-.25,ymin:h-.25,xmax:o+.25,ymax:h+.25,spatialReference:d,zmin:r,zmax:r})}function Mz(t){const{popupElement:e,popup:i}=t||{};return e??i??null}function ghe(t){return t!=null&&"open"in t&&"declaredClass"in t}function yhe(t){return!!t&&t.tagName.toLowerCase()==="arcgis-popup"&&"open"in t}function vhe(t,e){ghe(t)&&t.close(),e&&yhe(e)&&(e.visible=!1)}function _he(t){return t&&typeof t.highlight=="function"}async function bhe(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await Qn(async()=>{const{fromItem:r}=await import("./portalLayers-lrj1Xg2g.js");return{fromItem:r}},__vite__mapDeps([59,60,34,1,2,3,61,62,63,50,51]));try{return await i(e)}catch(r){const o=e?.portalItem,h=o?.id||"unset",d=o?.portal?.url||zi.portalUrl;throw ui.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+d+"', id: '"+h+"')",r),r}}const kz={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function NT(t,e,i,r=um){const o=new $a(sP(r)),h=Rt.fromJSDate(t,{zone:o}),d=i==="decades"||i==="centuries"?"year":m8(i);return i==="decades"&&(e*=10),i==="centuries"&&(e*=100),h.plus({[d]:e}).toJSDate()}function V0e(t,e,i="milliseconds"){const r=t.getTime(),o=xhe(e,i,"milliseconds");return new Date(r+o)}function Az(t,e,i=um){const r=new $a(sP(i)),o=Rt.fromJSDate(t,{zone:r});if(e==="decades"||e==="centuries"){const d=o.startOf("year"),{year:a}=d,v=a-a%(e==="decades"?10:100);return d.set({year:v}).toJSDate()}const h=m8(e);return o.startOf(h).toJSDate()}function xhe(t,e,i){return t===0?0:t*kz[e]/kz[i]}function m8(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var zo,Yf;let oo=(Yf=class extends Nt{static get allTime(){return Dz}static get empty(){return whe}static fromArray(e){return new zo({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,i){return i.end!=null?new Date(i.end):null}writeEnd(e,i){i.end=e?.getTime()??null}get isAllTime(){return this.equals(zo.allTime)}get isEmpty(){return this.equals(zo.empty)}readStart(e,i){return i.start!=null?new Date(i.start):null}writeStart(e,i){i.start=e?.getTime()??null}clone(){return new zo({end:this.end,start:this.start})}equals(e){if(!e)return!1;const i=this.start?.getTime()??this.start,r=this.end?.getTime()??this.end,o=e.start?.getTime()??e.start,h=e.end?.getTime()??e.end;return i===o&&r===h}expandTo(e,i=um){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=Az(r,e,i));let o=this.end;if(o){const h=Az(o,e,i);o=o.getTime()===h.getTime()?h:NT(h,1,e,i)}return new zo({start:r,end:o})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return zo.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const i=this.start?.getTime()??-1/0,r=this.end?.getTime()??1/0,o=e.start?.getTime()??-1/0,h=e.end?.getTime()??1/0;let d,a;return o>=i&&o<=r?d=o:i>=o&&i<=h&&(d=i),r>=o&&r<=h?a=r:h>=i&&h<=r&&(a=h),d==null||a==null||isNaN(d)||isNaN(a)?zo.empty:new zo({start:d===-1/0?null:new Date(d),end:a===1/0?null:new Date(a)})}offset(e,i,r=um){if(this.isEmpty||this.isAllTime)return this.clone();const o=new zo,{start:h,end:d}=this;return h!=null&&(o.start=NT(h,e,i,r)),d!=null&&(o.end=NT(d,e,i,r)),o}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return Dz.clone();const i=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new zo({start:i,end:r})}},zo=Yf,Yf);P([R({type:Date,json:{write:{allowNull:!0}}})],oo.prototype,"end",void 0),P([Br("end")],oo.prototype,"readEnd",null),P([Ui("end")],oo.prototype,"writeEnd",null),P([R({readOnly:!0,json:{read:!1}})],oo.prototype,"isAllTime",null),P([R({readOnly:!0,json:{read:!1}})],oo.prototype,"isEmpty",null),P([R({type:Date,json:{write:{allowNull:!0}}})],oo.prototype,"start",void 0),P([Br("start")],oo.prototype,"readStart",null),P([Ui("start")],oo.prototype,"writeStart",null),oo=zo=P([Ve("esri.time.TimeExtent")],oo);const Dz=new oo,whe=new oo({start:void 0,end:void 0});let She=0,Rr=class extends EP(Bw(BB)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new _i(-180,-90,180,90,Ft.WGS84),this.id=Date.now().toString(16)+"-layer-"+She++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Ft.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const i=typeof e=="string"?{url:e}:e;return(await Qn(async()=>{const{fromUrl:r}=await import("./arcgisLayers-TaRysD5u.js");return{fromUrl:r}},__vite__mapDeps([64,1,2,60,34,3,61,63]))).fromUrl(i)}static fromPortalItem(e){return bhe(e)}initialize(){this.when().catch(e=>{zd(e)||ui.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return this.attributionDataUrl!=null}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return Zo(this.url)}createLayerView(e,i){return Promise.reject(new Lt("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await wn(e,{query:{f:"json"},responseType:"json"})).data;throw new Lt("layer:no-attribution-data","Layer does not have attribution data")}};P([R({type:String})],Rr.prototype,"attributionDataUrl",void 0),P([R({readOnly:!0})],Rr.prototype,"effectiveVisible",null),P([R({type:_i})],Rr.prototype,"fullExtent",void 0),P([R({readOnly:!0})],Rr.prototype,"hasAttributionData",null),P([R({type:String,clonable:!1})],Rr.prototype,"id",void 0),P([R({type:Boolean,nonNullable:!0})],Rr.prototype,"legendEnabled",void 0),P([R({type:["show","hide","hide-children"]})],Rr.prototype,"listMode",void 0),P([R({type:Number,range:{min:0,max:1},nonNullable:!0})],Rr.prototype,"opacity",void 0),P([R({clonable:!1})],Rr.prototype,"parent",void 0),P([R({readOnly:!0})],Rr.prototype,"parsedUrl",null),P([R({type:Boolean,readOnly:!0})],Rr.prototype,"persistenceEnabled",void 0),P([R({type:Boolean})],Rr.prototype,"popupEnabled",void 0),P([R({type:Boolean})],Rr.prototype,"attributionVisible",void 0),P([R({type:Ft})],Rr.prototype,"spatialReference",void 0),P([R({type:String})],Rr.prototype,"title",void 0),P([R({readOnly:!0,json:{read:!1}})],Rr.prototype,"type",void 0),P([R()],Rr.prototype,"url",void 0),P([R({type:oo})],Rr.prototype,"visibilityTimeExtent",void 0),P([R({type:Boolean,nonNullable:!0})],Rr.prototype,"visible",void 0),Rr=P([Ve("esri.layers.Layer")],Rr);function The(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function q0e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}const H0e={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function Z0e(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function W0e(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function Y0e(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}function Che(t){return t?.type==="feature"&&t.source?.type==="feature-layer"}function Ehe(t){return The(t)&&Che(t)}async function X0e(t,e){const i=ji?.findServerInfo(t);if(i?.currentVersion!=null)return i.owningSystemUrl||null;const r=t.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const o=`${t.slice(0,r)}/rest/info`,h=e!=null?e.signal:null,{data:d}=await wn(o,{query:{f:"json"},responseType:"json",signal:h});return d?.owningSystemUrl||null}function Ihe(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function J0e(t){return Ihe(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function $he(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function K0e(t){return!!$he(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function Phe(t,e){return null}function Q0e(t){return null}function Mhe(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function eve(t,e){!e||!Mhe(t)||Phe(t.url)}let Lr=class extends Bw(Nt){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suffix="",this.suggestionsEnabled=null,this.withinViewEnabled=!1,this.zoomScale=null}};P([R()],Lr.prototype,"autoNavigate",void 0),P([R()],Lr.prototype,"filter",void 0),P([R()],Lr.prototype,"getResults",void 0),P([R()],Lr.prototype,"getSuggestions",void 0),P([R()],Lr.prototype,"maxResults",void 0),P([R()],Lr.prototype,"maxSuggestions",void 0),P([R()],Lr.prototype,"minSuggestCharacters",void 0),P([R()],Lr.prototype,"outFields",void 0),P([R()],Lr.prototype,"placeholder",void 0),P([R()],Lr.prototype,"popupEnabled",void 0),P([R({type:F0})],Lr.prototype,"popupTemplate",void 0),P([R()],Lr.prototype,"prefix",void 0),P([R()],Lr.prototype,"resultGraphicEnabled",void 0),P([R()],Lr.prototype,"resultSymbol",void 0),P([R()],Lr.prototype,"suffix",void 0),P([R()],Lr.prototype,"suggestionsEnabled",void 0),P([R()],Lr.prototype,"withinViewEnabled",void 0),P([R()],Lr.prototype,"zoomScale",void 0),Lr=P([Ve("esri.widgets.Search.SearchSource")],Lr);const QP=Lr;let Xh=class extends ys(Nt){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};P([R({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Xh.prototype,"onFields",void 0),P([R({type:String,json:{write:!0}})],Xh.prototype,"operator",void 0),P([R({type:String,json:{write:!0}})],Xh.prototype,"searchTerm",void 0),P([R({type:String,json:{write:!0}})],Xh.prototype,"searchType",void 0),Xh=P([Ve("esri.rest.support.FullTextSearch")],Xh);const khe=Xh,Ahe=/https?:\/\/services.*\.arcgis\.com/i,Dhe=/(?:\{([^}]+)\})/g,Ff=()=>ui.getLogger("esri.widgets.Search.support.layerSearchUtils");function zhe(t,e){const{exactMatch:i=!1,location:r,maxResults:o,spatialReference:h,source:d,sourceIndex:a,suggestResult:v,view:T}=t,{layer:E,filter:k,zoomScale:L}=d,O=T?.scale,H=g8(d,T),ie=e?.signal;return v8(E).then(()=>{const pe=E.popupTemplate;return pe?pe.getRequiredFields(E.fieldsIndex):null}).then(pe=>{const{objectIdField:be,returnZ:Ce}=E,Pe=T8(d);if(!eM(E,Pe))throw Ff().error("invalid-field: displayField is invalid."),new Lt("getResults():invalid-field","displayField is invalid.");const Ie=pe?.length?pe:[Pe],ke=d.outFields||Ie,Ke=y8(ke);if(ke.includes(be)||Ke||ke.push(be),E.floorInfo?.floorField&&ke.push(E.floorInfo.floorField),!(Ke||w1(E,ke)))throw Ff().error("invalid-field: outField is invalid."),new Lt("getResults():invalid-field","outField is invalid.");const qe=E.createQuery(),{orderByFields:dt}=d;if(dt&&(qe.orderByFields=dt),h){qe.outSpatialReference=h;const We=1/Sc(h);We&&(qe.maxAllowableOffset=We)}const ft=E.geometryType==="mesh"||E.geometryType==="multipatch",et=E.capabilities?.data?.supportsZ&&!ft;if(qe.returnZ=et&&Ce!==!1,qe.returnGeometry=!0,qe.multipatchOption=ft?"xyFootprint":null,ke&&(qe.outFields=ke),r)qe.geometry=r;else if(v.key)qe.objectIds=[v.key];else{const We=d.searchFields||[Pe];if(!w1(E,We))throw Ff().error("invalid-field: search field is invalid."),new Lt("getResults():invalid-field","search field is invalid.");if(S8(E)&&(qe.num=o),H&&(qe.geometry=H),!v.text?.trim())return[];const ge=v.text,{prefix:De="",suffix:Je=""}=d,Qe=C8(`${De}${ge}${Je}`);w8(E)&&b8(E,We)&&!i&&ge&&(qe.fullText=x8({text:ge,searchFields:We}));const yt=E8({searchTerm:Qe,layer:E,searchFields:We,filter:k,exactMatch:i,query:qe,type:"search"});if(qe.where=yt,!_8(qe))return[]}return E.queryFeatures(qe,{signal:ie}).then(We=>Zhe(We,T,d,a,Pe,O,L))})}function Ohe(t,e){const{source:i,spatialReference:r,view:o,suggestTerm:h,maxSuggestions:d,sourceIndex:a,exactMatch:v}=t,{layer:T,filter:E}=i,k=e?.signal,L=g8(i,o);return v8(T).then(()=>{if(!S8(T))return[];const O=T8(i),H=i.searchFields||[O],ie=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(Dhe,(et,We)=>(ie.push(We),et)):ie.push(O);const pe=y8(ie);ie.includes(T.objectIdField)||pe||ie.push(T.objectIdField);const be=eM(T,O),Ce=pe||w1(T,ie),Pe=w1(T,H);if(!be)throw Ff().error("invalid-field: displayField is invalid."),new Lt("getSuggestions():invalid-field","displayField is invalid.");if(!Ce)throw Ff().error("invalid-field: outField is invalid."),new Lt("getSuggestions():invalid-field","outField is invalid.");if(!Pe)throw Ff().error("invalid-field: search field is invalid."),new Lt("getSuggestions():invalid-field","search field is invalid.");const Ie=T.createQuery(),{orderByFields:ke}=i;if(ke&&(Ie.orderByFields=ke),Ie.outSpatialReference=r,Ie.returnGeometry=!1,Ie.num=d,Ie.outFields=ie,L&&(Ie.geometry=L),!h.trim())return[];const{prefix:Ke="",suffix:qe=""}=i,dt=C8(`${Ke}${h}${qe}`);w8(T)&&b8(T,H)&&!v&&h&&(Ie.fullText=x8({text:h,searchFields:H}));const ft=E8({searchTerm:dt,layer:T,searchFields:H,filter:E,exactMatch:v,query:Ie,type:"suggest"});return Ie.where=ft,_8(Ie)?T.queryFeatures(Ie,{signal:k}).then(et=>Ghe(et,i,a,O)):[]})}function g8(t,e){const{filter:i,withinViewEnabled:r}=t,o=e?.extent;return i?.geometry??(r&&o?o:void 0)}function y8(t){return t&&t.includes("*")}async function v8(t){t&&await t.load()}function _8(t){return!(!t.fullText&&!t.where)}function b8(t,e){const i=t?.indexes;return!i||!e?.length?!1:i.filter(r=>r.indexType==="FullText").some(r=>{const o=r.fields?.split(",").map(h=>h.trim().toLowerCase())||[];return e.every(h=>o.includes(h.toLowerCase()))})}function x8({text:t,searchFields:e}){return t.trim().split(" ").filter(i=>!!i.trim()).map(i=>new khe({onFields:e,searchTerm:i,searchType:"prefix"}))}function w8(t){return t?.capabilities?.query?.supportsFullTextSearch??!1}function S8(t){return t?.capabilities?.query?.supportsPagination??!1}function Rhe(t){return t?.fieldsIndex?.fields?.find(e=>e.type==="string")?.name??""}function T8(t){return t.displayField||t.layer.displayField||Rhe(t.layer)}function w1(t,e){return!(!t||!e?.length)&&e.every(i=>eM(t,i))}function eM(t,e){return!!t.getField(e)}function Lhe(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function Fhe({codedValues:t},e,i){return Xx(t??[],r=>{const o=r.name,h=i?o:o.toLowerCase();return(i?e:e.toLowerCase())===h?r.code.toString():null})??null}function C8(t){return t.replaceAll("'","''")}function ly(t,e){const i=e?.where;return i?`(${t}) AND (${i})`:t}function Nhe({currentTerm:t,field:e,filter:i,exactMatch:r,url:o,type:h}){const d=e?.type,a=e?.name;if(d==="string"||d==="date"||d==="global-id"){const v=Ahe.test(o??""),T=v&&Lhe(t)?"N":"";return ly(r&&h==="search"?`${a} = ${T}'${t}'`:v?`${a} LIKE ${T}${`'${t}%'`}`:`${`LOWER(${a})`} LIKE ${T}${`'${t.toLowerCase()}%'`}`,i)}if(d==="oid"||d==="small-integer"||d==="integer"||d==="single"||d==="double"){const v=Number(t);return isNaN(v)?null:ly(`${a} = ${v}`,i)}return ly(`${a} = ${t}`,i)}function Bhe(t,e){return t?` OR (${e})`:`(${e})`}function E8({searchTerm:t,layer:e,searchFields:i,filter:r,exactMatch:o,query:h,type:d}){const{definitionExpression:a,url:v}=e;let T="";return!h.fullText&&t&&i&&i.forEach(E=>{const k=e.getField(E),L=e.getFieldDomain?.(E,{excludeImpliedDomains:Ue("esri-widget-legacy-field-domain-calculation")}),O=(L&&L.type==="coded-value"?Fhe(L,t,o):null)||t||null;if(O!==null){const H=Nhe({currentTerm:O,field:k,filter:r,exactMatch:o,url:v,type:d});H&&(T+=Bhe(T,H))}}),a&&T?`(${a}) AND (${T})`:a||T}function jhe(t,e){let i=null;const{codedValues:r}=t;return r&&r.length&&r.some(o=>o.code===e&&(i=o.name,!0)),i}function Uhe(t,e){return t[e]??t[Object.keys(t).find(i=>i.toLowerCase()===e.toLowerCase())]}function I8(t,e,i){const r=t.sourceLayer,{attributes:o}=t,h=r.getFieldDomain?.(i,{feature:t,excludeImpliedDomains:Ue("esri-widget-legacy-field-domain-calculation")});if(e)return oP(e,o);if(i&&o){const d=r.getField(i),a=Uhe(o,i);return a==null?"":h&&h.type==="coded-value"?jhe(h,a)??"":d?.type==="date"?Gu(new Date(a)):typeof a=="number"?a.toString():typeof a!="string"?"":a.trim()}return""}function Vhe(t,e,i,r){const o=t.sourceLayer,{attributes:h}=t,{objectIdField:d}=o,a=d?h[d]:null;return{text:I8(t,e.suggestionTemplate,r),key:a,sourceIndex:i}}function Ghe(t,e,i,r){return t.features.map(o=>Vhe(o,e,i,r))}function qhe(t){return t!=null&&t.minScale!=null&&t.maxScale!=null}function Hhe(t,e,i,r,o,h,d){const a=t.clone();a.layer=t.layer;const v=t.sourceLayer,T=v?.objectIdField,E=T?t.attributes[T]:null,k=I8(t,i.searchTemplate,o);h!=null&&qhe(v)&&(v.minScale&&v.minScale<h?h=v.minScale:v.maxScale&&v.maxScale>h&&(h=v.maxScale));const L=a.geometry?KP(a.geometry,e??void 0,h??void 0):void 0,O=typeof d=="number"&&L?BI(ht(L),e??void 0,d):L,H=t.clone();return H.layer=t.layer,O!=null&&(H.geometry=Rn.fromExtent(O)),{extent:O,target:H,feature:a,key:E,name:k,sourceIndex:r}}function Zhe(t,e,i,r,o,h,d){return t.features.map(a=>Hhe(a,e,i,r,o,h,d))}var jI;let ma=jI=class extends QP{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,i)=>zhe({source:this,...e},i),this.getSuggestions=(e,i)=>Ohe({source:this,...e},i)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new jI({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?ht(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?ht(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(t=>t.type==="string")?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;if(!t.loaded)return"";const i=e||[this._getDisplayField()],r=Ehe(t);return`: ${i.map(o=>{const h=t.getField(o);return(r?t.getFieldAlias(o):h?.alias)||o}).join(", ")}`}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};P([R({json:{read:{source:"field.name"},write:{target:"field.name"}}})],ma.prototype,"displayField",void 0),P([R({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],ma.prototype,"exactMatch",void 0),P([R({value:null})],ma.prototype,"layer",null),P([R()],ma.prototype,"name",null),P([R({type:[String],json:{write:!0}})],ma.prototype,"orderByFields",void 0),P([R()],ma.prototype,"searchFields",void 0),P([R()],ma.prototype,"searchTemplate",void 0),P([R()],ma.prototype,"suggestionTemplate",void 0),ma=jI=P([Ve("esri.widgets.Search.LayerSearchSource")],ma);const hf=ma;function tM(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function Yw(t){return typeof t=="string"?Zo(t):ht(t)}function iM(t,e,i){const r={};for(const o in t){if(o==="declaredClass")continue;const h=t[o];if(h!=null&&typeof h!="function")if(Array.isArray(h))r[o]=h.map(d=>iM(d));else if(typeof h=="object")if(h.toJSON){const d=h.toJSON(i?.[o]);r[o]=e?d:JSON.stringify(d)}else r[o]=e?h:JSON.stringify(h);else r[o]=h}return r}function Whe(t,e){return t?e&&vP(t)?e:yP(t)??ji?.findCredential(t)?.token:null}async function rve(t,e,i){const r=Whe(t,e);return r||(!ji&&zi.request.useIdentity&&await Qn(()=>import("./IdentityManager-DOYXejDW.js"),__vite__mapDeps([4,1,2,5,6,3])),(await ji.getCredential(t,i))?.token)}function Yhe(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function Xhe(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let yu=class extends Nt{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};P([R({type:String,json:{write:!0}})],yu.prototype,"address",void 0),P([R({type:Object,json:{write:!0}})],yu.prototype,"attributes",void 0),P([R({type:_i,json:{write:!0}})],yu.prototype,"extent",void 0),P([R({type:oi,json:{write:!0}})],yu.prototype,"location",void 0),P([R({type:Number,json:{write:!0}})],yu.prototype,"score",void 0),yu=P([Ve("esri.rest.support.AddressCandidate")],yu);const $8=yu,rM={type:String,json:{read:{source:"token"},write:{target:"token"}}};let An=class extends Nt{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};P([R({type:Object,json:{write:!0}})],An.prototype,"address",void 0),P([R(rM)],An.prototype,"apiKey",void 0),P([R({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],An.prototype,"categories",void 0),P([R({type:String,json:{write:!0}})],An.prototype,"countryCode",void 0),P([R({type:Boolean,json:{write:!0}})],An.prototype,"forStorage",void 0),P([R({type:oi,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],An.prototype,"location",void 0),P([R({type:["rooftop","street"],json:{write:!0}})],An.prototype,"locationType",void 0),P([R({type:String,json:{write:!0}})],An.prototype,"magicKey",void 0),P([R({type:Number,json:{write:!0}})],An.prototype,"maxLocations",void 0),P([R({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],An.prototype,"outFields",void 0),P([R({type:Ft,json:{read:{source:"outSR"},write:{target:"outSR"}}})],An.prototype,"outSpatialReference",void 0),P([R({type:_i,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=i}}}})],An.prototype,"searchExtent",void 0),An=P([Ve("esri.rest.support.AddressToLocationsParameters")],An),An.from=Os(An);const P8=An;async function Jhe(t,e,i){e=P8.from(e);const r=Yw(t),{address:o,...h}=e.toJSON(),d={...o,...h,f:"json"},a=iM({...r.query,...d}),v=tM(a,i),T=`${r.path}/findAddressCandidates`;return wn(T,v).then(Khe)}function Khe({data:t}){if(!t)return[];const{candidates:e,spatialReference:i}=t;return e?e.map(r=>{if(!r)return;const{extent:o,location:h}=r,d=!o||Xhe(o);return Yhe(h)&&d?(o&&(o.spatialReference=i),h&&(h.spatialReference=i),$8.fromJSON(r)):void 0}):[]}const Qhe=_o()({DistanceMarker:"distance-marker",Locality:"locality",POI:"poi",PointAddress:"point-address",Postal:"postal",StreetAddress:"street-address",StreetInt:"street-intersection",StreetName:"street-name",Subaddress:"sub-address"}),ede=_o()({localCity:"local-city",postalCity:"postal-city"});var UI;let cs=UI=class extends Nt{constructor(t){super(t),this.apiKey=null,this.featureTypes=null,this.forStorage=null,this.language=null,this.location=null,this.locationType=null,this.outFields=null,this.outSpatialReference=null,this.preferredLabelValues=null,this.returnInputLocation=null}writeFeatureTypes(t,e){t?.length&&(e.featureTypes=t.map(i=>Qhe.toJSON(i)))}writeLocation(t,e){e.location=t?.clone().normalize().toJSON()}static from(t){return hF(UI,t)}};P([R(rM)],cs.prototype,"apiKey",void 0),P([R({type:[["distance-marker","locality","poi","point-address","postal","street-address","street-intersection","street-name","sub-address"]],json:{write:!0}})],cs.prototype,"featureTypes",void 0),P([Ui("featureTypes")],cs.prototype,"writeFeatureTypes",null),P([R({type:Boolean,json:{write:!0}})],cs.prototype,"forStorage",void 0),P([R({type:String,json:{name:"langCode",write:!0}})],cs.prototype,"language",void 0),P([R({type:oi,json:{write:!0}})],cs.prototype,"location",void 0),P([Ui("location")],cs.prototype,"writeLocation",null),P([R({type:["street","rooftop"],json:{write:!0}})],cs.prototype,"locationType",void 0),P([R({type:[String],json:{write:!0}})],cs.prototype,"outFields",void 0),P([R({type:Ft,json:{name:"outSR",write:!0}})],cs.prototype,"outSpatialReference",void 0),P([gi(ede)],cs.prototype,"preferredLabelValues",void 0),P([R({type:Boolean,json:{write:!0}})],cs.prototype,"returnInputLocation",void 0),cs=UI=P([Ve("esri.rest.support.LocationToAddressParameters")],cs);const M8=cs;async function tde(t,e,i){const r=Yw(t),{path:o,query:h}=r,d=M8.from(e);if(!d.location)throw new Lt("location-to-address:location-required","The location parameter is required");const a={...i,query:{...h,...ide(d),f:"json"}},v=`${o}/reverseGeocode`,{data:T}=await wn(v,a),{address:E,location:k}=T;return $8.fromJSON({address:E?.Match_addr??"",attributes:E,location:k,score:100})}function ide(t){const e=t.toJSON(),{featureTypes:i,forStorage:r,langCode:o,location:h,locationType:d,outFields:a,outSR:v,preferredLabelValues:T,returnInputLocation:E,token:k}=e;return{featureTypes:i?.join(","),forStorage:r,langCode:o,location:JSON.stringify(h),locationType:d,outFields:a?.join(","),outSR:v?.wkid??void 0,preferredLabelValues:T,returnInputLocation:E,token:k}}let df=class extends Nt{constructor(e){super(e),this.isCollection=null,this.magicKey=null,this.text=null}};P([R({type:Boolean,json:{write:!0}})],df.prototype,"isCollection",void 0),P([R({type:String,json:{write:!0}})],df.prototype,"magicKey",void 0),P([R({type:String,json:{write:!0}})],df.prototype,"text",void 0),df=P([Ve("esri.rest.support.SuggestionCandidate")],df);const rde=df;let no=class extends Nt{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};P([R(rM)],no.prototype,"apiKey",void 0),P([R({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],no.prototype,"categories",void 0),P([R({type:String,json:{write:!0}})],no.prototype,"countryCode",void 0),P([R({type:oi,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],no.prototype,"location",void 0),P([R({type:Number,json:{write:!0}})],no.prototype,"maxSuggestions",void 0),P([R({type:Ft,json:{read:{source:"outSR"},write:{target:"outSR"}}})],no.prototype,"outSpatialReference",void 0),P([R({type:_i,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(i)}}}})],no.prototype,"searchExtent",void 0),P([R({type:String,json:{write:!0}})],no.prototype,"text",void 0),no=P([Ve("esri.rest.support.SuggestLocationsParameters")],no),no.from=Os(no);const k8=no;async function nde(t,e,i){const r=Yw(t),o={...(e=k8.from(e)).toJSON(),f:"json"},h=iM({...r.query,...o}),d=tM(h,i),a=`${r.path}/suggest`;return wn(a,d).then(sde)}function sde(t){const{data:e}=t;if(!e)return[];const{suggestions:i}=e;return i?i.map(r=>new rde(r)):[]}const ode="Single Line Input",ade=3e5;function lde(t,e){return t.location?pde(t,e):fde(t,e)}function A8(t,e){if(e.localSearchDisabled)return null;const i=t?.scale;return typeof i=="number"&&i<=ade?t?.extent?.center:null}async function cde(t,e){const{source:i,spatialReference:r,view:o,suggestTerm:h,maxSuggestions:d,sourceIndex:a}=t,v=new k8,{apiKey:T,url:E}=i,k=D8(i,o),L=e?.signal;if(!E)return null;T&&(v.apiKey=T),i.categories&&(v.categories=i.categories),r&&(v.outSpatialReference=r);const O=A8(o,i);if(O&&(v.location=O),!h.trim())return null;const{prefix:H="",suffix:ie=""}=i,pe=`${H}${h}${ie}`;return v.text=pe,k&&(v.searchExtent=k),v.maxSuggestions=d,i.countryCode&&(v.countryCode=i.countryCode),nde(E,v,{signal:L}).then(be=>gde(be,a))}function ude(t){return!!t&&/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function hde(t){return!!t&&/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function zz(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const dde="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function pde(t,e){const{location:i,source:r,sourceIndex:o,spatialReference:h,view:d}=t,{apiKey:a,defaultZoomScale:v,language:T,url:E,zoomScale:k}=r;if(E==null)return[];const L=d?.scale,O=e?.signal,H=new M8({language:T,location:i,apiKey:a,outSpatialReference:h});try{return z8([await tde(E,H,{signal:O})],{defaultZoomScale:v,scale:L,sourceIndex:o,view:d,zoomScale:k})}catch{return[]}}function D8(t,e){const{filter:i,withinViewEnabled:r}=t,o=e?.scale,h=e?.extent,d=i?.geometry;return(d?KP(d,e??void 0,o):void 0)||(r&&h?h:void 0)}async function fde(t,e){const{source:i,suggestResult:r,spatialReference:o,view:h,maxResults:d,sourceIndex:a}=t,v=i?.zoomScale,T=i?.defaultZoomScale;if(!r.text?.trim())return null;const k=!r.key&&i.prefix?i.prefix:"",L=!r.key&&i.suffix?i.suffix:"",O=`${k}${r.text}${L}`,H=new P8,{apiKey:ie,url:pe}=i,be=h?.scale,Ce=D8(i,h),Pe=e?.signal;if(ie&&(H.apiKey=ie),!pe)return null;i.categories&&(H.categories=i.categories),i.locationType&&(H.locationType=i.locationType),o&&(H.outSpatialReference=o);const Ie=A8(h,i);Ie&&(H.location=Ie),H.maxLocations=d,Ce&&(H.searchExtent=Ce),i.countryCode&&(H.countryCode=i.countryCode);const{key:ke}=r,Ke=`${ke}`;return ke&&(H.magicKey=Ke),H.address={},H.address[i.singleLineFieldName||ode]=O,i.outFields&&(H.outFields=i.outFields),Jhe(pe,H,{signal:Pe}).then(qe=>z8(qe,{key:Ke,scale:be,sourceIndex:a,view:h,zoomScale:v,defaultZoomScale:T}))}function mde(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function gde(t,e){return t.map(i=>mde(i,e))}function yde(t,e){const{key:i,scale:r,sourceIndex:o,view:h,zoomScale:d,defaultZoomScale:a}=e,{attributes:v,extent:T,location:E,address:k}=t,L=new qn({geometry:E,attributes:v}),O=T||E,H=O?KP(O,h??void 0,r??void 0):void 0,ie=H?typeof d=="number"?BI(H,h??void 0,d):typeof a=="number"&&O?.type==="point"?BI(H,h??void 0,a):H:null,pe=E?`${E.x},${E.y}`:"",be=k||pe,Ce=L.clone();return ie!=null&&(Ce.geometry=Rn.fromExtent(ie)),{extent:ie,feature:L,target:Ce,key:i,name:be,sourceIndex:o}}function z8(t,e){return t.filter(Boolean).map(i=>yde(i,e))}var VI;let Dn=VI=class extends QP{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.language=null,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,i)=>lde({source:this,...e},i),this.getSuggestions=(e,i)=>cde({source:this,...e},i)}clone(){return new VI({apiKey:this.apiKey,autoNavigate:this.autoNavigate,categories:this.categories?ht(this.categories):null,countryCode:this.countryCode,filter:this.filter,language:this.language,locationType:this.locationType,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?ht(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?.clone()??null,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,suffix:this.suffix,suggestionsEnabled:this.suggestionsEnabled,url:this.url,withinViewEnabled:this.withinViewEnabled,zoomScale:this.zoomScale})}};P([R()],Dn.prototype,"apiKey",void 0),P([R()],Dn.prototype,"categories",void 0),P([R()],Dn.prototype,"countryCode",void 0),P([R({json:{write:!0}})],Dn.prototype,"defaultZoomScale",void 0),P([R()],Dn.prototype,"localSearchDisabled",void 0),P([R()],Dn.prototype,"language",void 0),P([R()],Dn.prototype,"locationType",void 0),P([R({json:{write:!0}})],Dn.prototype,"name",void 0),P([R({json:{write:!0}})],Dn.prototype,"placeholder",void 0),P([R()],Dn.prototype,"searchTemplate",void 0),P([R({json:{write:!0}})],Dn.prototype,"singleLineFieldName",void 0),P([R({json:{read:{source:"suggest"},write:{target:"suggest"}}})],Dn.prototype,"suggestionsEnabled",void 0),P([R({json:{write:!0}})],Dn.prototype,"url",void 0),P([R({json:{write:!0}})],Dn.prototype,"zoomScale",void 0),Dn=VI=P([Ve("esri.widgets.Search.LocatorSearchSource")],Dn);const O8=Dn;function lve(t){return{geometryType:GP(t[0]),geometries:t.map(e=>e.toJSON())}}function vde(t,e,i){const r=Gce(e);return t.map(o=>{const h=r.fromJSON(o);return h.spatialReference=i,h})}let Su=class extends Nt{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(o=>o.toJSON()),i=this.geometries[0],r={};return r.outSR=sz(this.outSpatialReference),r.inSR=sz(i.spatialReference),r.geometries=JSON.stringify({geometryType:GP(i),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(r.transformForward=this.transformForward),r}};P([R()],Su.prototype,"geometries",void 0),P([R({type:Ft,json:{read:{source:"outSR"}}})],Su.prototype,"outSpatialReference",void 0),P([R()],Su.prototype,"transformation",void 0),P([R()],Su.prototype,"transformForward",void 0),Su=P([Ve("esri.rest.support.ProjectParameters")],Su);const _de=Os(Su);async function bde(t,e,i){e=_de(e);const r=Yw(t),o={...r.query,f:"json",...e.toJSON()},h=e.outSpatialReference,d=GP(e.geometries[0]),a=tM(o,i);return wn(r.path+"/project",a).then(({data:{geometries:v}})=>vde(v,d,h))}const R8=()=>ui.getLogger("esri.widgets.support.geolocationUtils"),xde={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function wde(){const t=!!Ue("esri-geolocation");return t||R8().warn("geolocation-unsupported","Geolocation unsupported."),t}function Sde(){const t=window.isSecureContext;return t||R8().warnOnce("insecure-context","Geolocation requires a secure origin."),t}function Oz(){return wde()&&Sde()}function Tde(t){return t??=xde,new Promise((i,r)=>{setTimeout(()=>r(new Lt("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(i,r,t??void 0)})}function Cde(t,e){const{position:i,view:r}=t,o=Ede(i),h=o?.coords;if(!h)throw new Lt("geometry-service:no-coords","Geolocation has no coordinates");return $de(Ide(h),r,e)}function Ede(t){const e=t&&t.coords||{},i={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed,toJSON:()=>({})};return t&&{coords:i,timestamp:t.timestamp,toJSON:()=>({})}}function Ide({longitude:t,latitude:e,altitude:i}){return new oi({longitude:t,latitude:e,z:i||void 0,spatialReference:{wkid:4326}})}function $de(t,e,i){if(!e)return Promise.resolve(t);const r=e.spatialReference;return r.isWGS84?Promise.resolve(t):r.isWebMercator?Promise.resolve(Zb(t)):Pde(i).then(o=>{if(!o)throw new Lt("geometry-service:missing-url","Geometry service URL is missing");const h=new Su({geometries:[t],outSpatialReference:r});return bde(o,h,i).then(d=>d[0])})}function Pde(t){if(zi.geometryServiceUrl)return Promise.resolve(zi.geometryServiceUrl);const e=nt.getDefault();return e.load(t).catch(()=>{}).then(()=>e.helperServices?.geometry?.url)}function Mde(t,e,i){return t.goTo(e,i)}const kde=t=>{const e=t;let i=class extends e{constructor(...r){super(...r),this.goToOverride=null,this.view=null}callGoTo(r){const{view:o}=this;return t4(o),this.goToOverride?this.goToOverride(o,r):Mde(o,r.target,r.options)}};return P([R()],i.prototype,"goToOverride",void 0),P([R()],i.prototype,"view",void 0),i=P([Ve("esri.widgets.support.GoTo")],i),i};function Gn(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const Rz="highlight",cx=sr.ofType({key:t=>t.layer?"layer":"locator",base:QP,typeMap:{layer:hf,locator:O8}}),Lz=Ft.WGS84,Ade="esri/images/search/search-symbol-32.png",Dde=/<[\s\S]*?>/g,Xp=-1;var Xf;let ri=(Xf=class extends kde(CF){constructor(e){super(e),this._defaultPopupTemplate=new F0({content:"{Match_addr}"}),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultSources=new cx,this.defaultSymbols={point:new ds({url:_P(Ade),size:24,width:24,height:24}),polyline:new Wn({color:[130,130,130,1],width:2}),polygon:new ul({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=nt.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new cx,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){this.addHandles([bl(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),bD),bl(()=>this.messages,()=>{this._defaultPopupTemplate.title=this.messages?.searchResult??"",this._update()},bD)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:Xp}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:i,includeDefaultSources:r}=this,o=typeof r=="function"?r.call(null,{sources:e,defaultSources:i}):r?i.concat(e):e,h=this._get("allSources")||new cx;return h.removeAll(),h.addMany(o.filter(Boolean)),h}get defaultPopupTemplate(){return this._defaultPopupTemplate}set defaultPopupTemplate(e){this._overrideIfSome("defaultPopupTemplate",e)}get locationEnabled(){return this._get("locationEnabled")||Oz()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const i=Oz();if(e&&!i){const r=new Lt("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});ui.getLogger(this).error(r)}this._override("locationEnabled",!!e&&i)}get placeholder(){const{allSources:e,activeSourceIndex:i,allPlaceholder:r}=this;return i===Xp?r??"":e.at(i)?.placeholder??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:i}=this;e&&i&&e.graphics.remove(i),this._set("resultGraphic",null)}search(e,i){this.emit("search-start"),this.clearGraphics();const r=this._createSuggestionForSearch(e),o=(async()=>{try{await this.when();const h=await this._getResultsFromSources(r,i);if(i?.signal?.aborted)return null;const d={activeSourceIndex:this.activeSourceIndex,searchTerm:r.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(d,h,r);const a=this._getFirstResult(d.results),v=r.location&&a?a.name:r.text,T=v?.replaceAll(Dde,"");return this._set("searchTerm",T),(r.key&&typeof r.sourceIndex=="number"||r.location)&&this._set("selectedSuggestion",r),this._set("results",d.results),this._set("resultCount",d.results.reduce((E,k)=>E+(k.results?.length??0),0)),this.emit("search-complete",d),await this._selectFirstResult(a),d}finally{this._clearSearching()}})();return this._searching=o,o}async searchNearby(e){if(!this.locationEnabled){const r=new Lt("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw ui.getLogger(this).error(r),r}const i=(async()=>{try{const r=await Tde(),o=await Cde({position:r,view:this.view},e);return await this.search(o,e)}finally{this._clearSearching()}})();return this._searching=i,i}async select(e){if(this.clearGraphics(),!e){const et=new Lt("select:missing-parameter","Cannot select without a searchResult.",{value:e});throw ui.getLogger(this).error(et),et}const{view:i}=this,r=Gn(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),o=r!=null?this.allSources.at(r):null;if(!o){const et=new Lt("select:missing-source","Cannot select without a source.",{source:o});throw ui.getLogger(this).error(et),et}const h=o instanceof hf?this._getLayerSourcePopupTemplate(o):o.popupTemplate,d=o.resultSymbol||this._getDefaultSymbol(e),a=Gn(o,"resultGraphicEnabled")?o.resultGraphicEnabled:this.resultGraphicEnabled,v=Gn(o,"autoNavigate")?o.autoNavigate:this.autoNavigate,T=Gn(o,"popupEnabled")?o.popupEnabled:this.popupEnabled,E=T?h||this.popupTemplate||this.defaultPopupTemplate:null,{feature:k}=e;if(!k){const et=new Lt("select:missing-feature","Cannot select without a feature.",{feature:k});throw ui.getLogger(this).error(et),et}const{attributes:L,geometry:O,layer:H,sourceLayer:ie}=k,pe=O?Pz(O):null,be={layerViewQuery:this._getLayerView(k),elevationQuery:i&&pe!=null?mhe(pe,i):Promise.resolve(pe)},Ce=await vy(be),Pe=Ce.layerViewQuery.value,Ie=Ce.elevationQuery.value;d instanceof Fi&&(d.text=e.name);const ke=i&&v?e.target||e.extent:null;await(ke!=null?this._goToSearchResult(ke):Promise.resolve());const qe=Pe?k:new qn({geometry:O,symbol:d,attributes:L,layer:H,sourceLayer:ie,popupTemplate:E}),dt=Mz(i),ft=dt&&T&&qe.getEffectivePopupTemplate(dt.defaultPopupTemplateEnabled);return ft&&await i?.openPopup({features:[qe],location:Ie}),Pe&&_he(Pe)&&!ft&&this._highlightFeature({graphic:qe,layerView:Pe}),!Pe&&a&&i&&i.graphics.push(qe),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",qe),this.emit("select-result",{result:e,source:o,sourceIndex:r}),e}async suggest(e,i,r){const o=e||this.searchTerm;this.emit("suggest-start",{searchTerm:o}),await this._suggestTimer(i,r);const h=await this._suggestImmediate(o,r);return this._set("suggestions",h?.results),this._set("suggestionCount",h?.results.reduce((d,a)=>d+(a.results?.length??0),0)??null),this.emit("suggest-complete",h),h}async when(e,i){await see(()=>!this.updating)}async _update(){const{portal:e,view:i}=this;if(this.includeDefaultSources){const r=this._updatingPromise=vy([e?.load(),i?.when()]);if(this.destroyed||(await r,r!==this._updatingPromise))return}this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const e=this.portal?.helperServices?.geocode;return e?e.map(i=>{if(i.placefinding===!1)return;const r=zz(i.url)&&eF(i.url)?{url:dde}:null,o=O8.fromJSON({...i,...r}),h=o.url;if(zz(h)||hde(h)||ude(h)){const d=o.outFields??["Addr_type","Match_addr","StAddr","City"],a=(o.placeholder||this.messages?.placeholder)??"",v=typeof o.defaultZoomScale=="number"?o.defaultZoomScale:2500;o.singleLineFieldName="SingleLine",o.outFields=d,o.placeholder=a,o.defaultZoomScale=v}return o.singleLineFieldName?o:void 0}).filter(xb):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e?.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,i){const r=this.view?.map;return e.map(o=>{const h=r.findLayerById(o.id);if(!h)return;const d=this._getLayerJSON(o),a=hf.fromJSON(d);return a.placeholder=i,this._getLayer(h,d).then(v=>{a.layer=v}),a}).filter(xb).toArray()}_getTableSources(e,i){const r=this.view?.map;return e.map(o=>{if(!o.id)return;const h=r.findTableById(o.id);if(!h)return;const d=this._getLayerJSON(o),a=hf.fromJSON(d);return a.placeholder=i,this._getLayer(h,d).then(v=>{a.layer=v}),a}).filter(xb).toArray()}_convertApplicationProperties(){const e=this.view?.map,i=e?.applicationProperties?.viewing?.search;if(!i)return[];const{enabled:r,hintText:o,layers:h,tables:d}=i;return r?[...this._getLayerSources(h,o),...this._getTableSources(d,o)]:[]}async _getSubLayer(e,i){if(await e.load(),!e.allSublayers)throw new Error;const r=e.allSublayers.find(h=>h.id===i.subLayer);if(!r)throw new Error;const o=await r.createFeatureLayer?.();if(!o)throw new Error;return this._createdFeatureLayers.push(o),o}async _getBuildingSubLayer(e,i){await e.load();const r=e.allSublayers.find(o=>o.id===i.subLayer);if(r?.type!=="building-component")throw new Error;if(await r.load(),r.associatedLayer==null)throw new Error;return await r.associatedLayer.load(),r}async _getLayer(e,i){if(e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature")return e;if(e.type==="map-image")try{return await this._getSubLayer(e,i)}catch{const o=new Lt("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return ui.getLogger(this).error(o),null}return e.type==="building-scene"?this._getBuildingSubLayer(e,i):null}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:i}=this;this._destroyFeatureLayers(),e.removeAll(),i&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){const e=Mz(this.view),{resultGraphic:i}=this;if(!e||!i)return;const r="selectedFeature"in e,o=r?e.selectedFeature:null;r&&o&&o===i&&vhe(this.view?.popup,this.view?.popupElement)}_suggestTimer(e,i){const r=e??this.suggestionDelay;return n4(r,null,i?.signal)}_createLocationForSearch(e){return e instanceof qn&&e.geometry?Pz(e.geometry):e instanceof oi?e:Array.isArray(e)&&e.length===2?new oi({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&Gn(e,"key")&&Gn(e,"text")&&Gn(e,"sourceIndex"))return e;const i=this._createLocationForSearch(e),r=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:o,selectedResult:h}=this,d=!e&&o&&h,a=d&&o.key===h.key&&o.sourceIndex===h.sourceIndex,v=d&&o.location;return a||v?o:{location:i,text:i?"":r,sourceIndex:null,key:null}}_getFirstResult(e){return Xx(e,({results:i})=>i?.[0])??null}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,i){await this.when();const r=await this._getSuggestionsFromSources(e,i);if(i?.signal?.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(o,r),o}_formatSourceResponse(e,i,r){const o=i?.value||[],h=i?.error,d=this.allSources.at(r);if(h){const a={sourceIndex:r,source:d,error:h};e.errors.push(a),ui.getLogger(this).error(h),e.numErrors++}else{const a={sourceIndex:r,source:d,results:o};e.results.push(a),e.numResults+=o.length}}_formatResponse(e,i,r){if(i)if(e.activeSourceIndex===Xp){const o=r&&Gn(r,"sourceIndex")&&r.sourceIndex!==-1?r.sourceIndex:void 0;i.forEach((h,d)=>{const a=o!==void 0?o:d;this._formatSourceResponse(e,h,a)})}else this._formatSourceResponse(e,i[0],e.activeSourceIndex)}async _getResultsFromSources(e,i){const{allSources:r}=this,o=!e.location&&Gn(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,h=[];if(!r.length){const d=new Lt("search:no-sources-defined","At least one source is required.",{allSources:r});throw ui.getLogger(this).error(d),d}return o===Xp?r.forEach((d,a)=>{h.push(this._getResultsFromSource(e,a,i))}):h.push(this._getResultsFromSource(e,o,i)),vy(h)}async _getSuggestionsFromSources(e,i){const{allSources:r,activeSourceIndex:o}=this,h=[];if(!r.length){const d=new Lt("suggest:no-sources-defined","At least one source is required.",{allSources:r});throw ui.getLogger(this).error(d),d}return o===Xp?r.forEach((d,a)=>{h.push(this._getSuggestionsFromSource(e,a,i))}):h.push(this._getSuggestionsFromSource(e,o,i)),vy(h)}async _getResultsFromSource(e,i,r){const o=i!=null?this.allSources.at(i):null;if(!o)return null;const{location:h=null}=e,d=this.view?.spatialReference??Lz,a=Gn(o,"maxResults")?o.maxResults:this.maxResults,v=!!(o instanceof hf&&Gn(o,"exactMatch"))&&o.exactMatch,{view:T}=this;return o.getResults?.({exactMatch:v,location:h,maxResults:a,sourceIndex:i,spatialReference:d,suggestResult:e,view:T},r)}async _getSuggestionsFromSource(e,i,r){const o=this.allSources.at(i);if(!o)return null;e??="";const h=Gn(o,"suggestionsEnabled")?o.suggestionsEnabled:this.suggestionsEnabled,d=e?.length,a=Gn(o,"minSuggestCharacters")?o.minSuggestCharacters:this.minSuggestCharacters;if(h&&e.trim()&&d>=a){const v=this.view?.spatialReference||Lz,T=Gn(o,"maxSuggestions")?o.maxSuggestions:this.maxSuggestions,{view:E}=this,k=!!(o instanceof hf&&Gn(o,"exactMatch"))&&o.exactMatch;return o.getSuggestions?.({view:E,sourceIndex:i,suggestTerm:e,spatialReference:v,maxSuggestions:T,exactMatch:k},r)}return null}_getLayerSourcePopupTemplate(e){const{layer:i}=e;if(i)return Gn(e,"popupTemplate")?e.popupTemplate:i.popupTemplate}_getSourceIndexOfResult(e){return Xx(this.results??[],({results:i,sourceIndex:r})=>i?.includes(e)?r:null)??null}async _goToSearchResult(e){this._abortGoTo();const i=new AbortController;this._gotoController=i;const r={target:{target:e},options:{signal:i.signal}};e||(r.options.animate=!1),await this.callGoTo(r),this._gotoController=null}_getDefaultSymbol(e){const{defaultSymbols:i}=this,r=e.feature?.geometry;if(r==null)return null;switch(r.type){case"point":case"multipoint":return i.point;case"polyline":return i.polyline;case"extent":case"polygon":return i.polygon;default:return null}}_removeHighlight(){this.removeHandles(Rz)}async _getLayerView(e){const{view:i}=this;if(!e||!i)return null;const{layer:r,sourceLayer:o}=e,h=r??o;return h&&h.type!=="building-component"&&h.type!=="subtype-sublayer"?(await i.when(),i.whenLayerView(h)):null}_highlightFeature(e){const{graphic:i,layerView:r}=e,{attributes:o,layer:h,sourceLayer:d}=i,a=h??d,{objectIdField:v}=a,T=(v&&o?.[v])??null,E=r.highlight(T??i);this.addHandles(E,Rz)}_setResultFloor(e){const{view:i}=this,r=e.feature?.attributes,o=e.feature?.sourceLayer;if(o&&"floorInfo"in o&&o?.floorInfo?.floorField&&r){const h=r[o.floorInfo.floorField];i?.emit("select-result-floor",h)}}},Xf.ALL_INDEX=Xp,Xf);P([R()],ri.prototype,"_searching",void 0),P([R()],ri.prototype,"_updatingPromise",void 0),P([R({readOnly:!0,value:null})],ri.prototype,"activeSource",null),P([R()],ri.prototype,"activeSourceIndex",null),P([R()],ri.prototype,"allPlaceholder",null),P([R({readOnly:!0})],ri.prototype,"allSources",null),P([R()],ri.prototype,"autoNavigate",void 0),P([R()],ri.prototype,"autoSelect",void 0),P([R({type:F0})],ri.prototype,"defaultPopupTemplate",null),P([R({readOnly:!0})],ri.prototype,"defaultSources",void 0),P([R()],ri.prototype,"defaultSymbols",void 0),P([R()],ri.prototype,"includeDefaultSources",void 0),P([R()],ri.prototype,"locationEnabled",null),P([R()],ri.prototype,"maxInputLength",void 0),P([R()],ri.prototype,"maxResults",void 0),P([R()],ri.prototype,"maxSuggestions",void 0),P([R()],ri.prototype,"messages",void 0),P([R()],ri.prototype,"minSuggestCharacters",void 0),P([R({readOnly:!0})],ri.prototype,"placeholder",null),P([R()],ri.prototype,"popupEnabled",void 0),P([R({type:F0})],ri.prototype,"popupTemplate",void 0),P([R({type:nt})],ri.prototype,"portal",void 0),P([R()],ri.prototype,"resultCount",void 0),P([R()],ri.prototype,"resultGraphicEnabled",void 0),P([R({readOnly:!0})],ri.prototype,"resultGraphic",void 0),P([R({readOnly:!0})],ri.prototype,"results",void 0),P([R({readOnly:!0})],ri.prototype,"selectedSuggestion",void 0),P([R()],ri.prototype,"searchAllEnabled",void 0),P([R({readOnly:!0})],ri.prototype,"selectedResult",void 0),P([R()],ri.prototype,"searchTerm",null),P([R({type:cx})],ri.prototype,"sources",void 0),P([R({readOnly:!0})],ri.prototype,"state",null),P([R()],ri.prototype,"suggestionDelay",void 0),P([R()],ri.prototype,"suggestionCount",void 0),P([R({readOnly:!0})],ri.prototype,"suggestions",void 0),P([R()],ri.prototype,"suggestionsEnabled",void 0),P([R({readOnly:!0})],ri.prototype,"updating",null),P([R()],ri.prototype,"view",void 0),P([R()],ri.prototype,"clear",null),ri=P([Ve("esri.widgets.Search.SearchViewModel")],ri);const zde=ri,Jp=(t,e)=>{const r=xm().manager;r.onLoaded(()=>r.onLifecycle(()=>v4(t,e,o.emit)));const o=h$();return o};class Ode extends p${constructor(e,i){super(e),this.Y=new Map,this.A=void 0,this.#t=WL();const r=this;r.#i=i,r.Z(),r.setProvisionalExports(Rde(e,new WeakRef(r),e.M.length-1,r.instance,r.Y),!1),BO(e,o=>{if(o){const h=bl(()=>e[o],d=>{if(d===r.instance)return;const a=r.instance;r.exports=d,r.instance=d,r.Y.forEach((v,T)=>e.requestUpdate(v,a[T])),r.#e&&a.destroy(),r.#e=!1},{sync:!0});r.onDestroy(h.remove)}},r.exports)}#e;#t;#i;get exports(){return YL(this.#t),super.exports}set exports(e){super.exports=e,this.#t.notify()}Z(){const e=this;e.instance="prototype"in e.#i&&"declaredClass"in e.#i.prototype?new e.#i:e.#i(),e.#e=!0}hostConnected(){this.exports=this.instance}hostDestroy(){this.#e&&this.instance.destroy?.()}}const Rde=(t,e,i,r,o)=>new Proxy(r,{get:(h,d)=>{const a=h[d];if(typeof d=="symbol"||o.has(d))return a;const v=t.M[i];return v.A=d,u$(t,T=>{if(v.A=void 0,T!==void 0){const E=T.key;o.set(d,E);const k=t.constructor.getPropertyOptions(E),L=d!==E&&E.toLowerCase().includes("disable");Lde(e,k,d,E,L),k.i===void 0&&Fde(k,i,d,L)}},a)}}),Lde=(t,e,i,r,o,h)=>h=bl(()=>{const d=t.deref();return d===void 0||d.component.manager.destroyed?h=h.remove():d.exports[i]},(d,a)=>{if(!h)return;t.deref().component?.requestUpdate(r,o?!a:a),e.c=!1},{sync:!0}),Fde=(t,e,i,r)=>{t.d.get=function(){const o=this.M[e]?.exports[i];return r?!o:o},t.d.set=function(o){const h=this.M[e];h.A!==i&&(h.exports[i]=r?!o:o)}};/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */function Fz(t){t?.abort()}/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const Nde={"top-left":"top-left","top-right":"top-right","bottom-left":"bottom-left","bottom-right":"bottom-right","bottom-leading":"bottom-start","bottom-trailing":"bottom-end","top-leading":"top-start","top-trailing":"top-end"},Bde=["manual"];function ob(t){t.el.childElem&&(t.el.childElem.ownedBy=t.el),t.position&&Bde.includes(t.position)?t.el.removeAttribute("slot"):t.position&&(t.el.slot=Nde[t.position]);const e=jde(t);if(!e){const i=qde(t);if(!i){L8(t);return}return Bz(i,t,!0),i}return Ude(e,t.el.parent)||(t.el.parent=e,e.localName==="arcgis-expand"?Vde(e,t):e.localName==="arcgis-placement"?Gde(e,t):Bz(e,t,!1)),e}function jde({el:t}){for(let e=t.parentElement;e;e=e?.parentElement??null){if(Nz.has(e.localName))return e;if("ownedBy"in e&&e.ownedBy instanceof HTMLElement&&Nz.has(e.ownedBy.localName))return e.ownedBy}}const Nz=new Set(["arcgis-map","arcgis-scene","arcgis-link-chart","arcgis-expand","arcgis-placement"]);function Ude(t,e){if(t!==e)return!1;const i=t.localName;return i==="arcgis-expand"||i==="arcgis-placement"}function Xw(t,e,i="arcgisReady"){const r=t;if(r.view)e(r.view);else{let o=function(h){h.target===t&&(Xw(t,e,i),t.removeEventListener(i,o))};t.addEventListener(i,o)}}const Vde=(t,e)=>Xw(t,i=>{const r=nM(e);e.el.shadowRoot?t.content=e.el:e.el.childElem&&t.content!=null&&r.append(e.el.childElem),e.el.view=i}),Gde=(t,e)=>Xw(t,i=>{const r=nM(e);e.el.childElem&&r.append(e.el.childElem),e.el.view=i}),Bz=(t,e,i)=>Xw(t,r=>{i&&L8(e),e.el.view=r,e.referenceElement=t},"arcgisViewReadyChange");function L8(t){t.el.childElem&&nM(t).append(t.el.childElem)}function nM(t){return t.el.shadowRoot??t.el}function qde(t,e){const i=t.referenceElement;if(typeof i!="string")return i??void 0;const r=i.includes("#")||i.includes(".")||i.includes("["),o=t.el.getRootNode();return(r?void 0:o.querySelector(`#${i}`))??o.querySelector(i)??void 0}let Hde=class extends p${#e;constructor(e){super(e),this.setProvisionalExports(void 0)}hostConnected(){this.component.manager.loadedCalled&&ob(this.component)}hostLoad(){this.component.manager.destroyed}hostLoaded(){const{el:e}=this.component,i=e.shadowRoot?.firstElementChild??e.firstElementChild??void 0;e.childElem??=i,this.#e=qC(()=>this.component.view!=null,()=>{this.component.arcgisReady.emit()},{once:!0,initial:!0,sync:!0}),e.isConnected&&ob(this.component)}hostDisconnected(){typeof this.component.el.childElem=="object"&&this.component.view?.ui?.remove(this.component.el.childElem),this.#e?.remove()}hostUpdate(e){e.has("position")&&this.component.el.childElem!=null&&typeof this.component.position=="string"&&ob(this.component),e.has("referenceElement")&&ob(this.component)}};/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const Zde=(t,e)=>i=>Yde(i,t);class Wde extends Ode{#e=void 0;constructor(e,i){super(e,i),new Hde(this.component)}hostLoad(){this.#e=bl(()=>this.component.el.view,e=>{this.instance.view=e,this.instance.map=e?.map},{sync:!0,initial:!0})}hostDestroy(){this.#e?.remove(),super.hostDestroy()}}const Yde=QO(Wde);/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const Xde=oR(TQ);/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
v4.34.9 */const Kp="arcgis-search",Qp={base:Kp,autocomplete:`${Kp}__autocomplete`,dropdown:`${Kp}__dropdown`,container:`${Kp}__container`,form:`${Kp}__form`,submitButton:`${Kp}__submit-button`},Jde=Gi`.esri-widget__heading{color:var(--calcite-color-text-2);margin:0 0 .5rem;font-weight:var(--calcite-font-weight-semibold)}h1.esri-widget__heading{font-size:var(--calcite-font-size-xl)}h2.esri-widget__heading{font-size:var(--calcite-font-size-md)}h3.esri-widget__heading,h4.esri-widget__heading,h5.esri-widget__heading,h6.esri-widget__heading{font-size:var(--calcite-font-size)}.esri-widget{--esri-widget-padding-x: 15px;--esri-widget-padding-y: var(--calcite-spacing-md);--esri-widget-padding: var(--esri-widget-padding-y) var(--esri-widget-padding-x);box-sizing:border-box;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget *,.esri-widget :before,.esri-widget :after{box-sizing:inherit}.esri-widget.esri-widget--disabled>*{opacity:.4;pointer-events:none}.esri-widget.esri-widget--compact{--esri-widget-padding-y: 0;--esri-widget-padding-x: 0}.esri-widget__anchor{color:var(--calcite-color-text-2)}.esri-widget__anchor:hover{color:var(--calcite-color-text-3)}.esri-widget__anchor:hover,.esri-widget__anchor:focus{text-decoration:underline}.esri-widget__anchor--disabled{opacity:.4;pointer-events:none}.esri-widget__header{background-color:var(--calcite-color-foreground-1);flex:1 0 100%;justify-content:space-between;align-items:center;width:100%;min-height:48px;padding:12px 0 12px 15px;display:flex}.esri-widget__header .esri-widget__heading{width:calc(100% - 48px);text-align:initial;color:var(--calcite-color-text-1);align-items:center;margin:0;padding:0;display:flex}.esri-widget__header-button{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);border:none;flex:0 0 48px;justify-content:center;align-self:stretch;align-items:center;width:48px;padding:0;display:flex}.esri-widget__footer{background-color:var(--calcite-color-foreground-1);justify-content:center;align-items:center;width:100%;min-height:48px;display:flex}.esri-widget__footer-pagination{color:var(--calcite-color-text-2);justify-content:space-between;align-items:center;display:flex}.esri-widget__footer-pagination-previous-button,.esri-widget__footer-pagination-next-button{cursor:pointer;background-color:var(--calcite-color-foreground-1);border:0;margin:0 7px;padding:12px 15px;transition:background-color .125s ease-in-out}.esri-widget__footer-pagination-previous-button:hover,.esri-widget__footer-pagination-previous-button:focus,.esri-widget__footer-pagination-next-button:hover,.esri-widget__footer-pagination-next-button:focus{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1)}.esri-menu{visibility:hidden;z-index:1;background-clip:padding;background-color:var(--calcite-color-foreground-1);background-clip:padding-box;width:100%;max-height:0;margin:2px 0 0;padding:0;font-size:var(--calcite-font-size);line-height:var(--calcite-spacing-xl);position:absolute;top:100%;left:0;overflow:hidden;box-shadow:0 1px 2px #0000004d}.esri-menu .esri-menu__header{color:var(--calcite-color-text-inverse);background-color:var(--calcite-color-inverse);padding:6px 12px}.esri-menu__list{margin:0;padding:0;list-style:none}.esri-menu__list-item{cursor:pointer;border-top:1px solid #adadad4d;border-left:3px solid #0000;padding:.8em 1em}.esri-menu__list-item [class^=esri-icon-],.esri-menu__list-item [class*=" esri-icon-"]{padding-right:2.8px}.esri-menu__list-item:first-child{border-top:none}.esri-menu__list-item--focus,.esri-menu__list-item:hover,.esri-menu__list-item:focus{background-color:var(--calcite-color-foreground-1)}.esri-menu__list-item:active{background-color:var(--calcite-color-foreground-current)}.esri-menu__list-item--active,.esri-menu__list-item--active:hover,.esri-menu__list-item--active:focus{background-color:var(--calcite-color-foreground-1);border-left-color:var(--calcite-color-brand)}.esri-widget__table{border-collapse:collapse;color:var(--calcite-color-text-1);border:none;width:100%;line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget__table tr:nth-child(odd){background-color:var(--calcite-color-transparent)}.esri-widget__table tr:nth-child(2n){background-color:var(--calcite-color-transparent-press)}.esri-widget__table tr a{color:var(--calcite-color-text-2)}.esri-widget__table tr a:hover,.esri-widget__table tr a:focus{color:var(--calcite-color-text-1)}.esri-widget__table tr td,.esri-widget__table tr th{vertical-align:top;word-break:break-word;padding:.5em .7em;font-size:var(--calcite-font-size-sm);font-weight:var(--calcite-font-weight-regular)}.esri-widget__table tr th{text-align:left;border-right:3px solid #0000000d;width:50%}.esri-widget__table tr td{width:50%}.esri-input{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1);border:1px solid #959595;font-size:var(--calcite-font-size)}.esri-input::-ms-clear{display:none}.esri-input::placeholder{opacity:1;color:var(--calcite-color-text-2)}.esri-input:placeholder-shown{text-overflow:ellipsis}.esri-input[type=text],.esri-input[type=password],.esri-input[type=number]{height:32px;padding:0 .5em}calcite-combobox.esri-input{border:none}.esri-widget__content--empty{text-align:center;color:var(--calcite-color-border-input);flex-flow:column wrap;align-items:center;padding:18px 22px;display:flex}.esri-widget__content--empty h1.esri-widget__heading,.esri-widget__content--empty h2.esri-widget__heading,.esri-widget__content--empty h3.esri-widget__heading,.esri-widget__content--empty h4.esri-widget__heading,.esri-widget__content--empty h5.esri-widget__heading{font-weight:var(--calcite-font-weight-regular)}.esri-widget__content-illustration--empty{width:128px;padding:1rem 0}.esri-widget__content-icon--empty{width:32px;padding:.5rem 0}.esri-select{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background:var(--calcite-color-foreground-1) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='-8 -8 32 32' width='32' height='32'%3E%3Cpath d='M8 11.207l-4-4V5.793l4 4 4-4v1.414z' fill='%23adadad' fillrule='nonzero'/%3E%3C/svg%3E") 100% no-repeat;border:1px solid #959595;border-radius:0;width:100%;height:32px;margin:0;padding:0 .5em;font-family:inherit;font-size:.85em;display:block}.esri-select[disabled]{cursor:auto}.esri-select::-ms-expand{display:none}.esri-disabled a,.esri-disabled [role=menu],.esri-disabled [role=checkbox],.esri-disabled [class^=esri-icon-],.esri-disabled [class*=" esri-icon-"]{color:var(--calcite-color-text-3)}.keynav-mode .esri-widget:focus,.keynav-mode .esri-widget :focus{z-index:1;outline-offset:2px;outline:2px solid #adadad}.esri-widget__loader-animation{border:.15em solid #adadad4d;border-top-color:var(--calcite-color-border-input);border-radius:100%;width:1em;height:1em;font-size:var(--calcite-font-size-md);animation:1.25s linear infinite esri-rotate;display:block;transform:translateZ(0)}:dir(rtl) .esri-widget__table th{text-align:right;border-left:3px solid #0000000d;border-right:none}:dir(rtl) .esri-select{background-position:0}:dir(rtl) .esri-menu__list-item{border-left:none;border-right:3px solid #0000}:dir(rtl) .esri-menu__list-item [class^=esri-icon-],:dir(rtl) .esri-menu__list-item [class*=" esri-icon-"]{padding-left:2px;padding-right:0}:dir(rtl) .esri-menu__list-item--active{border-right-color:var(--calcite-color-brand)}.esri-icon-font-fallback-text{clip:rect(0 0 0 0);width:1px;height:1px;position:absolute;overflow:hidden}.esri-rotating{animation:1.25s linear infinite esri-rotate;transform:translateZ(0)}.esri-clearfix:before,.esri-clearfix:after{content:" ";display:table}.esri-clearfix:after{clear:both}.esri-interactive{cursor:pointer}.esri-invisible{visibility:hidden!important}.esri-offscreen{position:absolute;top:-999em;left:-999em}.esri-match-height{flex-direction:column;flex:auto;display:flex;overflow:hidden}.esri-hidden{display:none!important}:host{width:240px}.arcgis-search{--arcgis-internal-search-width: 240px;display:flex;flex-flow:row nowrap;align-items:center;justify-content:center;width:100%}.arcgis-search__dropdown{--calcite-color-border-1: var(--calcite-color-border-input);--calcite-dropdown-width: var(--arcgis-internal-search-width);width:31px}.arcgis-search__autocomplete{flex:1}.arcgis-search__container{display:flex;position:relative;flex:1 0 100%;flex-flow:row nowrap;align-items:stretch}.arcgis-search__form{display:flex;flex:1 0;flex-flow:row nowrap;align-items:stretch;margin:0;padding:0}.arcgis-search__submit-button{position:absolute;margin:-1px;border-width:0;padding:0;width:1px;height:1px;overflow:hidden;white-space:nowrap;clip:rect(0,0,0,0)}`,Kde=Zde(zde),G1=class G1 extends Vi{constructor(){super(...arguments),this.viewModel=Kde(this),this._currentLocationValue="search-use-current-location",this._autocompleteEl=void 0,this._searchResultRendererEl=void 0,this._suggestController=void 0,this._searchController=void 0,this._lastSearchTerm="",this.messages=Xde({blocking:!0}),this._locateFailed=!1,this._showNoResults=!1,this.view=this.viewModel.view,this.goToOverride=this.viewModel.goToOverride,this.icon="search",this.activeMenu="none",this.activeSourceIndex=this.viewModel.activeSourceIndex,this.allPlaceholder=this.viewModel.allPlaceholder,this.allSources=this.viewModel.allSources,this.autoNavigateDisabled=this.viewModel.autoNavigate,this.autoSelectDisabled=this.viewModel.autoSelect,this.defaultSources=this.viewModel.defaultSources,this.disabled=!1,this.includeDefaultSourcesDisabled=this.viewModel.includeDefaultSources,this.locationDisabled=this.viewModel.locationEnabled,this.maxResults=this.viewModel.maxResults,this.maxSuggestions=this.viewModel.maxSuggestions,this.minSuggestCharacters=this.viewModel.minSuggestCharacters,this.popupDisabled=this.viewModel.popupEnabled,this.popupTemplate=this.viewModel.popupTemplate,this.portal=this.viewModel.portal,this.resultGraphic=this.viewModel.resultGraphic,this.resultGraphicDisabled=this.viewModel.resultGraphicEnabled,this.results=this.viewModel.results,this.searchAllDisabled=this.viewModel.searchAllEnabled,this.searchTerm=this.viewModel.searchTerm,this.selectedResult=this.viewModel.selectedResult,this.sources=this.viewModel.sources,this.suggestions=this.viewModel.suggestions,this.suggestionsDisabled=this.viewModel.suggestionsEnabled,this.autoDestroyDisabled=!1,this.state=this.viewModel.state,this.arcgisPropertyChange=pW()("state"),this.arcgisReady=vt(),this.arcgisSearchClear=Jp(()=>this.viewModel,"search-clear"),this.arcgisSearchComplete=Jp(()=>this.viewModel,"search-complete"),this.arcgisSearchStart=Jp(()=>this.viewModel,"search-start"),this.arcgisSelectResult=Jp(()=>this.viewModel,"select-result"),this.arcgisSuggestComplete=Jp(()=>this.viewModel,"suggest-complete"),this.arcgisSuggestStart=Jp(()=>this.viewModel,"suggest-start")}get _isDisabled(){const{state:e}=this.viewModel;return e==="disabled"||e==="loading"||this.disabled}get _showCurrentLocation(){return!this.locationDisabled&&!this.searchTerm?.trim()}get _effectiveActiveMenu(){return this._isDisabled?"none":this.activeMenu}get activeSource(){return this.viewModel?.activeSource}clear(){this._locateFailed=!1,this.viewModel.clear()}async destroy(){await this.manager.destroy(),await this._searchResultRendererEl?.destroy(),this._cancelQueries()}async search(e){this._cancelQueries();const i=new AbortController,{signal:r}=i;this._searchController=i;try{const o=await this.viewModel.search(e,{signal:r});return this._searchController!==i?void 0:(o?.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=void 0,o)}catch{if(this._searchController!==i)return;this._searchController=void 0;return}}async suggest(e){this._cancelSuggest();const i=new AbortController,{signal:r}=i;this._suggestController=i;try{const o=await this.viewModel.suggest(e,null,{signal:r});return this._suggestController!==i?void 0:(this._suggestController=void 0,o?.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),o)}catch{return this._suggestController!==i||(this._suggestController=void 0),null}}async setFocus(){await this._autocompleteEl?.setFocus()}loaded(){this.manager.onLifecycle(()=>[bl(()=>[this._searchResultRendererEl,this.viewModel?.defaultPopupTemplate],()=>{const e=this.viewModel?.defaultPopupTemplate,{_searchResultRendererEl:i}=this;if(e&&i){const r=document.createElement("div");r.appendChild(i),e.content=r}},{initial:!0}),bl(()=>this.messages,e=>this.viewModel.messages=e,{initial:!0})])}_addSearchResultRenderer(){this._searchResultRendererEl=VZ(Fe`<arcgis-search-result-renderer auto-destroy-disabled .messages=${this.messages} .viewModel=${this.viewModel}></arcgis-search-result-renderer>`)}_handleInputKeydown(e){e.key==="Tab"&&this._cancelSuggest()}_handleAutocompleteCreate(e){this._autocompleteEl=e}_handleCalciteAutocompleteTextInput(e){const i=e.target.inputValue;i!==this.viewModel.searchTerm&&(this.viewModel.searchTerm=i,i||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){this.activeMenu==="suggestion"&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(e){const i=e.target.value;if(i===this._currentLocationValue){this._useCurrentLocation();return}const r=JSON.parse(i),o=this.viewModel.suggestions?.find(({sourceIndex:h})=>h===r.sourceIndex)?.results?.find(({key:h})=>`${h}`==`${r.key}`);o&&this.search(o)}async _useCurrentLocation(){this._cancelQueries();const e=new AbortController,{signal:i}=e;this._searchController=e;try{await this.viewModel.searchNearby({signal:i})}catch(r){zd(r)||(this._locateFailed=!0,this.activeMenu="suggestion")}finally{this._searchController=void 0}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){this.activeMenu==="source"&&(this.activeMenu="none")}_handleSourceSelect(e){const i=e.target.selectedItems[0].getAttribute("data-source-index");i&&(this.viewModel.activeSourceIndex=Number.parseInt(i,10))}_cancelSuggest(){this.activeMenu="none",this._locateFailed=!1,this._showNoResults=!1,this._suggestController=Fz(this._suggestController)}_cancelQueries(){this._cancelSuggest(),this._searchController=Fz(this._searchController)}_scrollToTopSuggestion(){this._autocompleteEl?.scrollContentTo({top:0})}_formSubmit(e){e.preventDefault(),this.activeMenu="none",this._lastSearchTerm=this.searchTerm,this.searchTerm&&this.search()}_getSourceName(e){const{messages:i}=this,{allSources:r}=this.viewModel,o=r.at(e);return(e===-1?i.all:o?.name||i.untitledSource)||""}render(){return this._addSearchResultRenderer(),Fe`<div class=${Le(eR(Qp.base,JL.widget))}><div class=${Le(Qp.container)}>${this._renderSourcesMenu()}${this._renderForm()}</div></div>`}_renderSourcesMenu(){const{messages:e,_isDisabled:i,_effectiveActiveMenu:r}=this,{allSources:o,searchAllEnabled:h}=this.viewModel;return o.length>1?Fe`<calcite-dropdown class=${Le(Qp.dropdown)} .disabled=${i} .open=${r==="source"} overlay-positioning=fixed @calciteDropdownClose=${this._handleSourceClose} @calciteDropdownOpen=${this._handleSourceOpen} @calciteDropdownSelect=${this._handleSourceSelect}><calcite-button appearance=outline-fill icon-start=caret-down kind=neutral .label=${e.searchIn} slot=trigger></calcite-button><calcite-dropdown-group .groupTitle=${e.searchIn}>${h?this._renderSource(-1):null}${o.map((d,a)=>this._renderSource(a)).toArray()}</calcite-dropdown-group></calcite-dropdown>`:null}_renderUseCurrentLocation(){const{_currentLocationValue:e}=this;return Fe`<calcite-autocomplete-item .heading=${this.messages.useCurrentLocation??""} icon-start=gps-on .value=${e}></calcite-autocomplete-item>`}_renderAutocomplete(){const{_effectiveActiveMenu:e,messages:i,_isDisabled:r}=this,{maxInputLength:o,placeholder:h,searchTerm:d,state:a}=this.viewModel,v=this.label??i.searchButtonTitle??"";return Fe`<calcite-autocomplete .autocomplete=${"off"} class=${Le(Qp.autocomplete)} .disabled=${r} .icon=${this.icon||!1} .inputValue=${d} .label=${v} .loading=${a==="searching"} .maxLength=${o} .name=${this.el.id} @keydown=${this._handleInputKeydown} .open=${e==="suggestion"} overlay-positioning=fixed .placeholder=${h} title=${(d?"":h)??Ou} @calciteAutocompleteChange=${this._handleCalciteAutocompleteChange} @calciteAutocompleteClose=${this._handleAutocompleteClose} @calciteAutocompleteOpen=${this._handleAutocompleteOpen} @calciteAutocompleteTextChange=${this._handleCalciteAutocompleteTextInput} @calciteAutocompleteTextInput=${this._handleCalciteAutocompleteTextInput} ${hi(this._handleAutocompleteCreate)}>${this._renderSuggestions()}${this._renderNotices()}</calcite-autocomplete>`}_renderForm(){return Fe`<form class=${Le(Qp.form)} @submit=${this._formSubmit} role=search>${this._renderAutocomplete()}<button class=${Le(Qp.submitButton)} type=submit>${this.label??this.messages.searchButtonTitle??""}</button></form>`}_renderSuggestGroup(e){return e.results?.map(i=>this._renderSuggestion(i))}_renderSuggestions(){const{suggestions:e}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():e?.map(i=>this._renderSuggestResults(i))}_renderSuggestResults(e){const{allSources:i,activeSourceIndex:r}=this.viewModel,{sourceIndex:o}=e,h=e.results?.length,d=i.length>1&&r===-1,a=this._getSourceName(o);return h&&d?Fe`<calcite-autocomplete-item-group .heading=${a}>${this._renderSuggestGroup(e)}</calcite-autocomplete-item-group>`:this._renderSuggestGroup(e)}_renderSuggestion({key:e,sourceIndex:i,text:r}){const o={key:e,sourceIndex:i};return Fe`<calcite-autocomplete-item .heading=${r??this.messages.untitledResult??""} .value=${JSON.stringify(o)}></calcite-autocomplete-item>`}_renderSource(e){const i=this._getSourceName(e);return Fe`<calcite-dropdown-item data-source-index=${`${e}`} .selected=${e===this.viewModel.activeSourceIndex}>${i}</calcite-dropdown-item>`}_renderNoResultsWarning(e){const{messages:i}=this,r=e?oP(i.noResultsFoundForValue??"",{value:`"${e}"`}):i.noResultsFound;return Fe`<calcite-notice icon=exclamation-mark-triangle kind=warning open slot=content-bottom><div slot=title>${i.noResults}</div><div slot=message>${r}</div></calcite-notice>`}_renderLocateError(){return Fe`<calcite-notice icon=exclamation-mark-circle kind=danger open slot=content-bottom><div slot=message>${this.messages.locateError}</div></calcite-notice>`}_renderNotices(){return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(this._lastSearchTerm??this.viewModel.searchTerm):null}};G1.properties={_locateFailed:16,_showNoResults:16,_isDisabled:16,_showCurrentLocation:16,_effectiveActiveMenu:16,view:0,referenceElement:1,position:3,goToOverride:0,icon:1,activeMenu:1,activeSource:32,activeSourceIndex:9,allPlaceholder:1,allSources:0,autoNavigateDisabled:5,autoSelectDisabled:5,defaultSources:0,disabled:5,includeDefaultSourcesDisabled:5,locationDisabled:5,maxResults:9,maxSuggestions:9,minSuggestCharacters:9,popupDisabled:5,popupTemplate:0,portal:0,resultGraphic:0,resultGraphicDisabled:5,results:0,searchAllDisabled:5,searchTerm:1,selectedResult:0,sources:0,suggestions:0,suggestionsDisabled:5,autoDestroyDisabled:5,messageOverrides:0,label:1,state:3},G1.styles=Jde;let GI=G1;XL("arcgis-search",GI);const Qde={class:"location-search-container"},epe=kd({__name:"LocationSearch",setup(t){const e=qo("mitt");return q1(()=>{const i=document.getElementById("search-component");i?.addEventListener("arcgisSelectResult",r=>{const o=r.detail.result.feature.geometry.latitude,h=r.detail.result.feature.geometry.longitude;e.emit("location-selected",{coordinates:[h,o],text:r.detail.result.feature.text})}),i?.addEventListener("arcgisSelectCancel",()=>{e.emit("location-cleared")})}),(i,r)=>{const o=mr("arcgis-search");return di(),qi("div",Qde,[$i(o,{id:"search-component"})])}}}),tpe=Ad(epe,[["__scopeId","data-v-41b9752b"]]),ipe={name:"Map",components:{ComparisonMap:BH,LocationSearch:tpe},data(){return{arrasBrandingColors:qo("arrasBranding").colors}},watch:{},async beforeRouteEnter(t,e,i){if(console.log("beforeRouteEnter"),document.getElementById("loading").style.display="flex",!await If().setCurrentTheme(t.query.theme)){i(!1);return}i(!0)},async beforeRouteLeave(t,e,i){console.log("beforeRouteLeave"),await If().setCurrentTheme(),i()},mounted(){},computed:{invertedIconPath(){return this.currentThemeConfig?.icon?this.currentThemeConfig?.icon?.replace(/_[^/]*\.png$/i,"_white.png"):null},arrasBrandingColor(){const t=this.currentThemeConfig.style.colors.icon;return this.arrasBrandingColors[t]},currentThemeConfig(){return If().getMainConfigForCurrentTheme()}},methods:{}};function rpe(t,e,i,r,o,h){const d=mr("v-img"),a=mr("v-card-title"),v=mr("v-card"),T=mr("LocationSearch"),E=mr("ComparisonMap"),k=mr("v-container"),L=mr("v-main");return di(),al(L,{class:"d-flex align-center justify-center",style:{"padding-top":"0px"}},{default:As(()=>[$i(k,{style:{"padding-top":"0px",height:"100%"}},{default:As(()=>[$i(v,{style:pl({"background-color":h.arrasBrandingColor}),class:"theme-title mt-2",elevation:"2",rounded:"lg"},{default:As(()=>[h.currentThemeConfig?(di(),al(a,{key:0,class:"text-center pa-0 ma-0 theme-title__text",style:pl({"background-color":h.arrasBrandingColor})},{default:As(()=>[$i(d,{inline:"",src:h.invertedIconPath,width:"36",height:"36",class:"mr-2 title-theme-icon"},null,8,["src"]),ms(" "+Qi(h.currentThemeConfig.title),1)]),_:1},8,["style"])):Ir("",!0)]),_:1},8,["style"]),$i(T),$i(E,{_center:[-80.17,34.652],_zoom:8.57,_type:"sideBySide"})]),_:1})]),_:1})}const npe=Ad(ipe,[["render",rpe]]),hve=Object.freeze(Object.defineProperty({__proto__:null,default:npe},Symbol.toStringTag,{value:"Module"}));export{lm as $,Ve as A,Nt as B,_o as C,cfe as D,BN as E,Lge as F,Wge as G,wn as H,Zo as I,k0 as J,Phe as K,Ape as L,nt as M,Ui as N,sr as O,Br as P,Q0e as Q,Mhe as R,Ft as S,eme as T,ui as U,Cb as V,eve as W,C0 as X,zd as Y,zi as Z,P as _,ji as a,xb as a$,X0e as a0,Ffe as a1,jie as a2,Fu as a3,Ri as a4,ufe as a5,nb as a6,tQ as a7,ZL as a8,Yt as a9,fs as aA,Yse as aB,o1 as aC,Lme as aD,xl as aE,Pw as aF,qfe as aG,Tse as aH,Xoe as aI,qb as aJ,oi as aK,kz as aL,Hye as aM,Md as aN,$fe as aO,Ife as aP,Gu as aQ,kfe as aR,Mfe as aS,Pfe as aT,Zse as aU,Wse as aV,gi as aW,Hw as aX,KN as aY,HP as aZ,xme as a_,AQ as aa,u4 as ab,s4 as ac,iQ as ad,ao as ae,Wn as af,ul as ag,Fi as ah,$a as ai,ov as aj,zB as ak,RB as al,OB as am,DB as an,t4 as ao,Nye as ap,Ez as aq,f0e as ar,Rae as as,Hse as at,UF as au,Yme as av,Xme as aw,Hme as ax,X$ as ay,hee as az,LB as b,mP as b$,p0e as b0,yv as b1,_v as b2,dye as b3,c4 as b4,jC as b5,Epe as b6,EL as b7,fv as b8,Lo as b9,Uu as bA,Cd as bB,AB as bC,Cye as bD,Dye as bE,U$ as bF,wge as bG,Sge as bH,$me as bI,Ta as bJ,Tge as bK,uv as bL,pT as bM,GN as bN,LP as bO,Om as bP,YK as bQ,$ge as bR,ar as bS,Dpe as bT,KK as bU,Pme as bV,ume as bW,Kfe as bX,cme as bY,qie as bZ,wd as b_,gge as ba,AL as bb,jge as bc,ON as bd,RN as be,Koe as bf,Vw as bg,Gw as bh,goe as bi,bl as bj,qC as bk,hn as bl,v4 as bm,aee as bn,xw as bo,DN as bp,Zme as bq,Td as br,GP as bs,_1 as bt,Xse as bu,Qme as bv,AN as bw,Kme as bx,qse as by,Ege as bz,Ue as c,Mw as c$,Lye as c0,_i as c1,vF as c2,vge as c3,Vi as c4,vt as c5,k$ as c6,Tpe as c7,PC as c8,Le as c9,Zge as cA,ime as cB,tme as cC,Su as cD,bde as cE,zme as cF,Zb as cG,nl as cH,Rn as cI,ome as cJ,ame as cK,Sfe as cL,afe as cM,fw as cN,K0e as cO,J0e as cP,P0 as cQ,Jme as cR,mv as cS,Rr as cT,_ge as cU,jr as cV,ds as cW,hv as cX,mF as cY,Jfe as cZ,Dw as c_,Fe as ca,Gi as cb,lr as cc,Dme as cd,kme as ce,pv as cf,Hn as cg,Ame as ch,ys as ci,oo as cj,Nme as ck,OF as cl,ege as cm,noe as cn,s5 as co,qn as cp,qce as cq,F0 as cr,oN as cs,qme as ct,Gme as cu,Ume as cv,z0 as cw,D0 as cx,zm as cy,tge as cz,W0e as d,lfe as d$,aF as d0,wa as d1,sre as d2,pP as d3,gP as d4,ore as d5,Bfe as d6,yE as d7,bme as d8,Pie as d9,bf as dA,Nr as dB,um as dC,Rt as dD,Xle as dE,Ige as dF,zle as dG,iye as dH,Nge as dI,Woe as dJ,Yoe as dK,ZP as dL,Cge as dM,Due as dN,Yge as dO,Zoe as dP,kye as dQ,zpe as dR,o4 as dS,Pr as dT,_P as dU,YB as dV,a0e as dW,o0e as dX,jme as dY,pI as dZ,Em as d_,e4 as da,$0 as db,dv as dc,Gge as dd,qge as de,U0 as df,Mpe as dg,Y0e as dh,Os as di,Ehe as dj,Dfe as dk,Afe as dl,s1 as dm,cge as dn,Yw as dp,tM as dq,iM as dr,hF as ds,sz as dt,c0e as du,y0e as dv,Ufe as dw,P0e as dx,i0 as dy,dc as dz,H6 as e,t0e as e$,sfe as e0,uae as e1,nae as e2,VN as e3,lme as e4,Qfe as e5,Q6 as e6,Hfe as e7,BB as e8,QK as e9,bD as eA,GQ as eB,Vu as eC,cl as eD,Du as eE,zu as eF,nd as eG,lo as eH,gue as eI,Es as eJ,sl as eK,Cs as eL,z0e as eM,Z0e as eN,Z as eO,lve as eP,vde as eQ,Cpe as eR,Eb as eS,cce as eT,Eue as eU,Tue as eV,Wle as eW,Ule as eX,Bge as eY,tae as eZ,i0e as e_,n4 as ea,$ue as eb,Pue as ec,Mue as ed,Cue as ee,Sue as ef,MF as eg,Bw as eh,MB as ei,Rf as ej,Xie as ek,Zu as el,Sc as em,zfe as en,Tie as eo,Xce as ep,DL as eq,j6 as er,W6 as es,Am as et,Bpe as eu,pme as ev,Xne as ew,tse as ex,nse as ey,cm as ez,kQ as f,hi as f$,Bae as f0,dz as f1,Nae as f2,U0e as f3,xhe as f4,Vme as f5,$0e as f6,ho as f7,Iue as f8,Jce as f9,dm as fA,nfe as fB,Fme as fC,WP as fD,l0e as fE,s0e as fF,Fye as fG,V$ as fH,rme as fI,Eme as fJ,CF as fK,bge as fL,xge as fM,Xn as fN,Ho as fO,go as fP,Rs as fQ,nX as fR,yo as fS,$r as fT,gR as fU,Tx as fV,Ur as fW,ZR as fX,ai as fY,ut as fZ,GA as f_,Vne as fa,Ime as fb,j0e as fc,B0e as fd,LN as fe,oye as ff,sye as fg,pye as fh,pz as fi,tfe as fj,zw as fk,Tfe as fl,Lfe as fm,Wfe as fn,Rpe as fo,Lpe as fp,Ope as fq,Vie as fr,$L as fs,efe as ft,N$ as fu,Fpe as fv,B$ as fw,Npe as fx,NB as fy,FB as fz,ht as g,Yae as g$,vo as g0,g$ as g1,_J as g2,Q0 as g3,bpe as g4,Spe as g5,mX as g6,Jge as g7,Kge as g8,Gfe as g9,bfe as gA,wfe as gB,_fe as gC,cye as gD,aye as gE,Pa as gF,N0 as gG,jw as gH,iae as gI,Vge as gJ,tye as gK,V0 as gL,sue as gM,eue as gN,loe as gO,Lw as gP,Rb as gQ,hoe as gR,JP as gS,hue as gT,D0e as gU,T5 as gV,Mme as gW,xP as gX,jpe as gY,kue as gZ,ofe as g_,ere as ga,Yfe as gb,O6 as gc,or as gd,Iye as ge,m0e as gf,EP as gg,see as gh,Gpe as gi,Uge as gj,aN as gk,pge as gl,foe as gm,dge as gn,moe as go,$pe as gp,hye as gq,nye as gr,hse as gs,O0e as gt,Wme as gu,F0e as gv,R0e as gw,NL as gx,h4 as gy,xfe as gz,cre as h,zue as h$,Pge as h0,Hb as h1,qw as h2,$ye as h3,gv as h4,mm as h5,khe as h6,Ioe as h7,Bme as h8,fm as h9,cle as hA,mle as hB,yge as hC,qae as hD,zge as hE,jfe as hF,$w as hG,Mae as hH,EB as hI,Mce as hJ,zye as hK,Iae as hL,zae as hM,ZN as hN,rye as hO,gD as hP,bw as hQ,hre as hR,Qpe as hS,d0e as hT,mge as hU,Hge as hV,Cme as hW,wP as hX,fge as hY,e0e as hZ,Qye as h_,dQ as ha,rfe as hb,due as hc,nme as hd,uB as he,Lle as hf,Ms as hg,PL as hh,Rfe as hi,V6 as hj,zN as hk,t5 as hl,Z6 as hm,RF as hn,lne as ho,TE as hp,XK as hq,W$ as hr,Fge as hs,rre as ht,QL as hu,r5 as hv,Nle as hw,Xb as hx,Zye as hy,Fle as hz,Ln as i,_ye as i$,Pce as i0,n0e as i1,r0e as i2,Bue as i3,_u as i4,UB as i5,q0e as i6,xpe as i7,gfe as i8,_w as i9,N0e as iA,M0e as iB,k0e as iC,A0e as iD,rM as iE,xN as iF,Toe as iG,IP as iH,vfe as iI,vD as iJ,Ww as iK,Dle as iL,FP as iM,fye as iN,NP as iO,dce as iP,yye as iQ,dB as iR,mce as iS,pB as iT,Sye as iU,mye as iV,vye as iW,Go as iX,Tye as iY,fce as iZ,kle as i_,bc as ia,Efe as ib,q$ as ic,wpe as id,oP as ie,Une as ig,uP as ih,Nfe as ii,z6 as ij,Zfe as ik,vme as il,Hae as im,voe as io,V0e as ip,K5 as iq,Pye as ir,Eye as is,_ce as it,Oye as iu,Mye as iv,JE as iw,Rme as ix,L0e as iy,oQ as iz,vy as j,bye as j0,wye as j1,OT as j2,Qge as j3,une as j4,sF as j5,af as j6,gr as j7,$N as j8,Vb as j9,Ome as jA,uye as jB,jo as jC,cD as jD,ire as jE,rve as jF,Xge as jG,MC as jH,dE as jI,gE as jJ,bn as jK,_n as jL,lye as jM,v0e as jN,x0e as jO,g0e as jP,qQ as jQ,qpe as jR,hve as jS,Foe as ja,Upe as jb,eQ as jc,ML as jd,Ppe as je,u0e as jf,h0e as jg,Ipe as jh,uce as ji,Wae as jj,vle as jk,Wye as jl,Yye as jm,_le as jn,yfe as jo,iB as jp,Ice as jq,Aye as jr,Dce as js,Rye as jt,dle as ju,Xfe as jv,wle as jw,ole as jx,Xae as jy,ile as jz,IQ as k,ud as l,Uye as m,Roe as n,Vpe as o,Aw as p,Vfe as q,zoe as r,Lt as s,yw as t,zs as u,E0 as v,H0e as w,nv as x,kne as y,R as z};
